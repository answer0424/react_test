var Dae=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var nKe=Dae((wKe,WE)=>{function Pae(t,e){for(var r=0;r<e.length;r++){const n=e[r];if(typeof n!="string"&&!Array.isArray(n)){for(const i in n)if(i!=="default"&&!(i in t)){const s=Object.getOwnPropertyDescriptor(n,i);s&&Object.defineProperty(t,i,s.get?s:{enumerable:!0,get:()=>n[i]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function r(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=r(i);fetch(i.href,s)}})();var xW=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function qq(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var KA={exports:{}},uw={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var EW;function Iae(){if(EW)return uw;EW=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function r(n,i,s){var a=null;if(s!==void 0&&(a=""+s),i.key!==void 0&&(a=""+i.key),"key"in i){s={};for(var o in i)o!=="key"&&(s[o]=i[o])}else s=i;return i=s.ref,{$$typeof:t,type:n,key:a,ref:i!==void 0?i:null,props:s}}return uw.Fragment=e,uw.jsx=r,uw.jsxs=r,uw}var _W;function Nae(){return _W||(_W=1,KA.exports=Iae()),KA.exports}var Y=Nae(),XA={exports:{}},Ft={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var RW;function Hae(){if(RW)return Ft;RW=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),s=Symbol.for("react.consumer"),a=Symbol.for("react.context"),o=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),c=Symbol.for("react.memo"),f=Symbol.for("react.lazy"),g=Symbol.iterator;function m(K){return K===null||typeof K!="object"?null:(K=g&&K[g]||K["@@iterator"],typeof K=="function"?K:null)}var v={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},w=Object.assign,y={};function b(K,Se,B){this.props=K,this.context=Se,this.refs=y,this.updater=B||v}b.prototype.isReactComponent={},b.prototype.setState=function(K,Se){if(typeof K!="object"&&typeof K!="function"&&K!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,K,Se,"setState")},b.prototype.forceUpdate=function(K){this.updater.enqueueForceUpdate(this,K,"forceUpdate")};function x(){}x.prototype=b.prototype;function _(K,Se,B){this.props=K,this.context=Se,this.refs=y,this.updater=B||v}var T=_.prototype=new x;T.constructor=_,w(T,b.prototype),T.isPureReactComponent=!0;var D=Array.isArray,P={H:null,A:null,T:null,S:null,V:null},O=Object.prototype.hasOwnProperty;function A(K,Se,B,E,R,M){return B=M.ref,{$$typeof:t,type:K,key:Se,ref:B!==void 0?B:null,props:M}}function W(K,Se){return A(K.type,Se,void 0,void 0,void 0,K.props)}function L(K){return typeof K=="object"&&K!==null&&K.$$typeof===t}function H(K){var Se={"=":"=0",":":"=2"};return"$"+K.replace(/[=:]/g,function(B){return Se[B]})}var J=/\/+/g;function G(K,Se){return typeof K=="object"&&K!==null&&K.key!=null?H(""+K.key):Se.toString(36)}function ve(){}function be(K){switch(K.status){case"fulfilled":return K.value;case"rejected":throw K.reason;default:switch(typeof K.status=="string"?K.then(ve,ve):(K.status="pending",K.then(function(Se){K.status==="pending"&&(K.status="fulfilled",K.value=Se)},function(Se){K.status==="pending"&&(K.status="rejected",K.reason=Se)})),K.status){case"fulfilled":return K.value;case"rejected":throw K.reason}}throw K}function we(K,Se,B,E,R){var M=typeof K;(M==="undefined"||M==="boolean")&&(K=null);var F=!1;if(K===null)F=!0;else switch(M){case"bigint":case"string":case"number":F=!0;break;case"object":switch(K.$$typeof){case t:case e:F=!0;break;case f:return F=K._init,we(F(K._payload),Se,B,E,R)}}if(F)return R=R(K),F=E===""?"."+G(K,0):E,D(R)?(B="",F!=null&&(B=F.replace(J,"$&/")+"/"),we(R,Se,B,"",function(fe){return fe})):R!=null&&(L(R)&&(R=W(R,B+(R.key==null||K&&K.key===R.key?"":(""+R.key).replace(J,"$&/")+"/")+F)),Se.push(R)),1;F=0;var Z=E===""?".":E+":";if(D(K))for(var te=0;te<K.length;te++)E=K[te],M=Z+G(E,te),F+=we(E,Se,B,M,R);else if(te=m(K),typeof te=="function")for(K=te.call(K),te=0;!(E=K.next()).done;)E=E.value,M=Z+G(E,te++),F+=we(E,Se,B,M,R);else if(M==="object"){if(typeof K.then=="function")return we(be(K),Se,B,E,R);throw Se=String(K),Error("Objects are not valid as a React child (found: "+(Se==="[object Object]"?"object with keys {"+Object.keys(K).join(", ")+"}":Se)+"). If you meant to render a collection of children, use an array instead.")}return F}function ae(K,Se,B){if(K==null)return K;var E=[],R=0;return we(K,E,"","",function(M){return Se.call(B,M,R++)}),E}function le(K){if(K._status===-1){var Se=K._result;Se=Se(),Se.then(function(B){(K._status===0||K._status===-1)&&(K._status=1,K._result=B)},function(B){(K._status===0||K._status===-1)&&(K._status=2,K._result=B)}),K._status===-1&&(K._status=0,K._result=Se)}if(K._status===1)return K._result.default;throw K._result}var Te=typeof reportError=="function"?reportError:function(K){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var Se=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof K=="object"&&K!==null&&typeof K.message=="string"?String(K.message):String(K),error:K});if(!window.dispatchEvent(Se))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",K);return}console.error(K)};function ce(){}return Ft.Children={map:ae,forEach:function(K,Se,B){ae(K,function(){Se.apply(this,arguments)},B)},count:function(K){var Se=0;return ae(K,function(){Se++}),Se},toArray:function(K){return ae(K,function(Se){return Se})||[]},only:function(K){if(!L(K))throw Error("React.Children.only expected to receive a single React element child.");return K}},Ft.Component=b,Ft.Fragment=r,Ft.Profiler=i,Ft.PureComponent=_,Ft.StrictMode=n,Ft.Suspense=u,Ft.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=P,Ft.__COMPILER_RUNTIME={__proto__:null,c:function(K){return P.H.useMemoCache(K)}},Ft.cache=function(K){return function(){return K.apply(null,arguments)}},Ft.cloneElement=function(K,Se,B){if(K==null)throw Error("The argument must be a React element, but you passed "+K+".");var E=w({},K.props),R=K.key,M=void 0;if(Se!=null)for(F in Se.ref!==void 0&&(M=void 0),Se.key!==void 0&&(R=""+Se.key),Se)!O.call(Se,F)||F==="key"||F==="__self"||F==="__source"||F==="ref"&&Se.ref===void 0||(E[F]=Se[F]);var F=arguments.length-2;if(F===1)E.children=B;else if(1<F){for(var Z=Array(F),te=0;te<F;te++)Z[te]=arguments[te+2];E.children=Z}return A(K.type,R,void 0,void 0,M,E)},Ft.createContext=function(K){return K={$$typeof:a,_currentValue:K,_currentValue2:K,_threadCount:0,Provider:null,Consumer:null},K.Provider=K,K.Consumer={$$typeof:s,_context:K},K},Ft.createElement=function(K,Se,B){var E,R={},M=null;if(Se!=null)for(E in Se.key!==void 0&&(M=""+Se.key),Se)O.call(Se,E)&&E!=="key"&&E!=="__self"&&E!=="__source"&&(R[E]=Se[E]);var F=arguments.length-2;if(F===1)R.children=B;else if(1<F){for(var Z=Array(F),te=0;te<F;te++)Z[te]=arguments[te+2];R.children=Z}if(K&&K.defaultProps)for(E in F=K.defaultProps,F)R[E]===void 0&&(R[E]=F[E]);return A(K,M,void 0,void 0,null,R)},Ft.createRef=function(){return{current:null}},Ft.forwardRef=function(K){return{$$typeof:o,render:K}},Ft.isValidElement=L,Ft.lazy=function(K){return{$$typeof:f,_payload:{_status:-1,_result:K},_init:le}},Ft.memo=function(K,Se){return{$$typeof:c,type:K,compare:Se===void 0?null:Se}},Ft.startTransition=function(K){var Se=P.T,B={};P.T=B;try{var E=K(),R=P.S;R!==null&&R(B,E),typeof E=="object"&&E!==null&&typeof E.then=="function"&&E.then(ce,Te)}catch(M){Te(M)}finally{P.T=Se}},Ft.unstable_useCacheRefresh=function(){return P.H.useCacheRefresh()},Ft.use=function(K){return P.H.use(K)},Ft.useActionState=function(K,Se,B){return P.H.useActionState(K,Se,B)},Ft.useCallback=function(K,Se){return P.H.useCallback(K,Se)},Ft.useContext=function(K){return P.H.useContext(K)},Ft.useDebugValue=function(){},Ft.useDeferredValue=function(K,Se){return P.H.useDeferredValue(K,Se)},Ft.useEffect=function(K,Se,B){var E=P.H;if(typeof B=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return E.useEffect(K,Se)},Ft.useId=function(){return P.H.useId()},Ft.useImperativeHandle=function(K,Se,B){return P.H.useImperativeHandle(K,Se,B)},Ft.useInsertionEffect=function(K,Se){return P.H.useInsertionEffect(K,Se)},Ft.useLayoutEffect=function(K,Se){return P.H.useLayoutEffect(K,Se)},Ft.useMemo=function(K,Se){return P.H.useMemo(K,Se)},Ft.useOptimistic=function(K,Se){return P.H.useOptimistic(K,Se)},Ft.useReducer=function(K,Se,B){return P.H.useReducer(K,Se,B)},Ft.useRef=function(K){return P.H.useRef(K)},Ft.useState=function(K){return P.H.useState(K)},Ft.useSyncExternalStore=function(K,Se,B){return P.H.useSyncExternalStore(K,Se,B)},Ft.useTransition=function(){return P.H.useTransition()},Ft.version="19.1.1",Ft}var TW;function wH(){return TW||(TW=1,XA.exports=Hae()),XA.exports}var ie=wH();const Ie=qq(ie),$E=Pae({__proto__:null,default:Ie},[ie]);var QA={exports:{}},cw={},ZA={exports:{}},JA={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var MW;function Fae(){return MW||(MW=1,function(t){function e(ae,le){var Te=ae.length;ae.push(le);e:for(;0<Te;){var ce=Te-1>>>1,K=ae[ce];if(0<i(K,le))ae[ce]=le,ae[Te]=K,Te=ce;else break e}}function r(ae){return ae.length===0?null:ae[0]}function n(ae){if(ae.length===0)return null;var le=ae[0],Te=ae.pop();if(Te!==le){ae[0]=Te;e:for(var ce=0,K=ae.length,Se=K>>>1;ce<Se;){var B=2*(ce+1)-1,E=ae[B],R=B+1,M=ae[R];if(0>i(E,Te))R<K&&0>i(M,E)?(ae[ce]=M,ae[R]=Te,ce=R):(ae[ce]=E,ae[B]=Te,ce=B);else if(R<K&&0>i(M,Te))ae[ce]=M,ae[R]=Te,ce=R;else break e}}return le}function i(ae,le){var Te=ae.sortIndex-le.sortIndex;return Te!==0?Te:ae.id-le.id}if(t.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var a=Date,o=a.now();t.unstable_now=function(){return a.now()-o}}var u=[],c=[],f=1,g=null,m=3,v=!1,w=!1,y=!1,b=!1,x=typeof setTimeout=="function"?setTimeout:null,_=typeof clearTimeout=="function"?clearTimeout:null,T=typeof setImmediate<"u"?setImmediate:null;function D(ae){for(var le=r(c);le!==null;){if(le.callback===null)n(c);else if(le.startTime<=ae)n(c),le.sortIndex=le.expirationTime,e(u,le);else break;le=r(c)}}function P(ae){if(y=!1,D(ae),!w)if(r(u)!==null)w=!0,O||(O=!0,G());else{var le=r(c);le!==null&&we(P,le.startTime-ae)}}var O=!1,A=-1,W=5,L=-1;function H(){return b?!0:!(t.unstable_now()-L<W)}function J(){if(b=!1,O){var ae=t.unstable_now();L=ae;var le=!0;try{e:{w=!1,y&&(y=!1,_(A),A=-1),v=!0;var Te=m;try{t:{for(D(ae),g=r(u);g!==null&&!(g.expirationTime>ae&&H());){var ce=g.callback;if(typeof ce=="function"){g.callback=null,m=g.priorityLevel;var K=ce(g.expirationTime<=ae);if(ae=t.unstable_now(),typeof K=="function"){g.callback=K,D(ae),le=!0;break t}g===r(u)&&n(u),D(ae)}else n(u);g=r(u)}if(g!==null)le=!0;else{var Se=r(c);Se!==null&&we(P,Se.startTime-ae),le=!1}}break e}finally{g=null,m=Te,v=!1}le=void 0}}finally{le?G():O=!1}}}var G;if(typeof T=="function")G=function(){T(J)};else if(typeof MessageChannel<"u"){var ve=new MessageChannel,be=ve.port2;ve.port1.onmessage=J,G=function(){be.postMessage(null)}}else G=function(){x(J,0)};function we(ae,le){A=x(function(){ae(t.unstable_now())},le)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(ae){ae.callback=null},t.unstable_forceFrameRate=function(ae){0>ae||125<ae?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):W=0<ae?Math.floor(1e3/ae):5},t.unstable_getCurrentPriorityLevel=function(){return m},t.unstable_next=function(ae){switch(m){case 1:case 2:case 3:var le=3;break;default:le=m}var Te=m;m=le;try{return ae()}finally{m=Te}},t.unstable_requestPaint=function(){b=!0},t.unstable_runWithPriority=function(ae,le){switch(ae){case 1:case 2:case 3:case 4:case 5:break;default:ae=3}var Te=m;m=ae;try{return le()}finally{m=Te}},t.unstable_scheduleCallback=function(ae,le,Te){var ce=t.unstable_now();switch(typeof Te=="object"&&Te!==null?(Te=Te.delay,Te=typeof Te=="number"&&0<Te?ce+Te:ce):Te=ce,ae){case 1:var K=-1;break;case 2:K=250;break;case 5:K=1073741823;break;case 4:K=1e4;break;default:K=5e3}return K=Te+K,ae={id:f++,callback:le,priorityLevel:ae,startTime:Te,expirationTime:K,sortIndex:-1},Te>ce?(ae.sortIndex=Te,e(c,ae),r(u)===null&&ae===r(c)&&(y?(_(A),A=-1):y=!0,we(P,Te-ce))):(ae.sortIndex=K,e(u,ae),w||v||(w=!0,O||(O=!0,G()))),ae},t.unstable_shouldYield=H,t.unstable_wrapCallback=function(ae){var le=m;return function(){var Te=m;m=le;try{return ae.apply(this,arguments)}finally{m=Te}}}}(JA)),JA}var AW;function Lae(){return AW||(AW=1,ZA.exports=Fae()),ZA.exports}var eO={exports:{}},ls={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var OW;function Bae(){if(OW)return ls;OW=1;var t=wH();function e(u){var c="https://react.dev/errors/"+u;if(1<arguments.length){c+="?args[]="+encodeURIComponent(arguments[1]);for(var f=2;f<arguments.length;f++)c+="&args[]="+encodeURIComponent(arguments[f])}return"Minified React error #"+u+"; visit "+c+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(){}var n={d:{f:r,r:function(){throw Error(e(522))},D:r,C:r,L:r,m:r,X:r,S:r,M:r},p:0,findDOMNode:null},i=Symbol.for("react.portal");function s(u,c,f){var g=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:i,key:g==null?null:""+g,children:u,containerInfo:c,implementation:f}}var a=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function o(u,c){if(u==="font")return"";if(typeof c=="string")return c==="use-credentials"?c:""}return ls.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=n,ls.createPortal=function(u,c){var f=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!c||c.nodeType!==1&&c.nodeType!==9&&c.nodeType!==11)throw Error(e(299));return s(u,c,null,f)},ls.flushSync=function(u){var c=a.T,f=n.p;try{if(a.T=null,n.p=2,u)return u()}finally{a.T=c,n.p=f,n.d.f()}},ls.preconnect=function(u,c){typeof u=="string"&&(c?(c=c.crossOrigin,c=typeof c=="string"?c==="use-credentials"?c:"":void 0):c=null,n.d.C(u,c))},ls.prefetchDNS=function(u){typeof u=="string"&&n.d.D(u)},ls.preinit=function(u,c){if(typeof u=="string"&&c&&typeof c.as=="string"){var f=c.as,g=o(f,c.crossOrigin),m=typeof c.integrity=="string"?c.integrity:void 0,v=typeof c.fetchPriority=="string"?c.fetchPriority:void 0;f==="style"?n.d.S(u,typeof c.precedence=="string"?c.precedence:void 0,{crossOrigin:g,integrity:m,fetchPriority:v}):f==="script"&&n.d.X(u,{crossOrigin:g,integrity:m,fetchPriority:v,nonce:typeof c.nonce=="string"?c.nonce:void 0})}},ls.preinitModule=function(u,c){if(typeof u=="string")if(typeof c=="object"&&c!==null){if(c.as==null||c.as==="script"){var f=o(c.as,c.crossOrigin);n.d.M(u,{crossOrigin:f,integrity:typeof c.integrity=="string"?c.integrity:void 0,nonce:typeof c.nonce=="string"?c.nonce:void 0})}}else c==null&&n.d.M(u)},ls.preload=function(u,c){if(typeof u=="string"&&typeof c=="object"&&c!==null&&typeof c.as=="string"){var f=c.as,g=o(f,c.crossOrigin);n.d.L(u,f,{crossOrigin:g,integrity:typeof c.integrity=="string"?c.integrity:void 0,nonce:typeof c.nonce=="string"?c.nonce:void 0,type:typeof c.type=="string"?c.type:void 0,fetchPriority:typeof c.fetchPriority=="string"?c.fetchPriority:void 0,referrerPolicy:typeof c.referrerPolicy=="string"?c.referrerPolicy:void 0,imageSrcSet:typeof c.imageSrcSet=="string"?c.imageSrcSet:void 0,imageSizes:typeof c.imageSizes=="string"?c.imageSizes:void 0,media:typeof c.media=="string"?c.media:void 0})}},ls.preloadModule=function(u,c){if(typeof u=="string")if(c){var f=o(c.as,c.crossOrigin);n.d.m(u,{as:typeof c.as=="string"&&c.as!=="script"?c.as:void 0,crossOrigin:f,integrity:typeof c.integrity=="string"?c.integrity:void 0})}else n.d.m(u)},ls.requestFormReset=function(u){n.d.r(u)},ls.unstable_batchedUpdates=function(u,c){return u(c)},ls.useFormState=function(u,c,f){return a.H.useFormState(u,c,f)},ls.useFormStatus=function(){return a.H.useHostTransitionStatus()},ls.version="19.1.1",ls}var kW;function Kq(){if(kW)return eO.exports;kW=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),eO.exports=Bae(),eO.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var DW;function Vae(){if(DW)return cw;DW=1;var t=Lae(),e=wH(),r=Kq();function n(l){var h="https://react.dev/errors/"+l;if(1<arguments.length){h+="?args[]="+encodeURIComponent(arguments[1]);for(var d=2;d<arguments.length;d++)h+="&args[]="+encodeURIComponent(arguments[d])}return"Minified React error #"+l+"; visit "+h+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function i(l){return!(!l||l.nodeType!==1&&l.nodeType!==9&&l.nodeType!==11)}function s(l){var h=l,d=l;if(l.alternate)for(;h.return;)h=h.return;else{l=h;do h=l,(h.flags&4098)!==0&&(d=h.return),l=h.return;while(l)}return h.tag===3?d:null}function a(l){if(l.tag===13){var h=l.memoizedState;if(h===null&&(l=l.alternate,l!==null&&(h=l.memoizedState)),h!==null)return h.dehydrated}return null}function o(l){if(s(l)!==l)throw Error(n(188))}function u(l){var h=l.alternate;if(!h){if(h=s(l),h===null)throw Error(n(188));return h!==l?null:l}for(var d=l,p=h;;){var S=d.return;if(S===null)break;var C=S.alternate;if(C===null){if(p=S.return,p!==null){d=p;continue}break}if(S.child===C.child){for(C=S.child;C;){if(C===d)return o(S),l;if(C===p)return o(S),h;C=C.sibling}throw Error(n(188))}if(d.return!==p.return)d=S,p=C;else{for(var N=!1,j=S.child;j;){if(j===d){N=!0,d=S,p=C;break}if(j===p){N=!0,p=S,d=C;break}j=j.sibling}if(!N){for(j=C.child;j;){if(j===d){N=!0,d=C,p=S;break}if(j===p){N=!0,p=C,d=S;break}j=j.sibling}if(!N)throw Error(n(189))}}if(d.alternate!==p)throw Error(n(190))}if(d.tag!==3)throw Error(n(188));return d.stateNode.current===d?l:h}function c(l){var h=l.tag;if(h===5||h===26||h===27||h===6)return l;for(l=l.child;l!==null;){if(h=c(l),h!==null)return h;l=l.sibling}return null}var f=Object.assign,g=Symbol.for("react.element"),m=Symbol.for("react.transitional.element"),v=Symbol.for("react.portal"),w=Symbol.for("react.fragment"),y=Symbol.for("react.strict_mode"),b=Symbol.for("react.profiler"),x=Symbol.for("react.provider"),_=Symbol.for("react.consumer"),T=Symbol.for("react.context"),D=Symbol.for("react.forward_ref"),P=Symbol.for("react.suspense"),O=Symbol.for("react.suspense_list"),A=Symbol.for("react.memo"),W=Symbol.for("react.lazy"),L=Symbol.for("react.activity"),H=Symbol.for("react.memo_cache_sentinel"),J=Symbol.iterator;function G(l){return l===null||typeof l!="object"?null:(l=J&&l[J]||l["@@iterator"],typeof l=="function"?l:null)}var ve=Symbol.for("react.client.reference");function be(l){if(l==null)return null;if(typeof l=="function")return l.$$typeof===ve?null:l.displayName||l.name||null;if(typeof l=="string")return l;switch(l){case w:return"Fragment";case b:return"Profiler";case y:return"StrictMode";case P:return"Suspense";case O:return"SuspenseList";case L:return"Activity"}if(typeof l=="object")switch(l.$$typeof){case v:return"Portal";case T:return(l.displayName||"Context")+".Provider";case _:return(l._context.displayName||"Context")+".Consumer";case D:var h=l.render;return l=l.displayName,l||(l=h.displayName||h.name||"",l=l!==""?"ForwardRef("+l+")":"ForwardRef"),l;case A:return h=l.displayName||null,h!==null?h:be(l.type)||"Memo";case W:h=l._payload,l=l._init;try{return be(l(h))}catch{}}return null}var we=Array.isArray,ae=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,le=r.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Te={pending:!1,data:null,method:null,action:null},ce=[],K=-1;function Se(l){return{current:l}}function B(l){0>K||(l.current=ce[K],ce[K]=null,K--)}function E(l,h){K++,ce[K]=l.current,l.current=h}var R=Se(null),M=Se(null),F=Se(null),Z=Se(null);function te(l,h){switch(E(F,h),E(M,l),E(R,null),h.nodeType){case 9:case 11:l=(l=h.documentElement)&&(l=l.namespaceURI)?Q8(l):0;break;default:if(l=h.tagName,h=h.namespaceURI)h=Q8(h),l=Z8(h,l);else switch(l){case"svg":l=1;break;case"math":l=2;break;default:l=0}}B(R),E(R,l)}function fe(){B(R),B(M),B(F)}function I(l){l.memoizedState!==null&&E(Z,l);var h=R.current,d=Z8(h,l.type);h!==d&&(E(M,l),E(R,d))}function U(l){M.current===l&&(B(R),B(M)),Z.current===l&&(B(Z),iw._currentValue=Te)}var k=Object.prototype.hasOwnProperty,ee=t.unstable_scheduleCallback,oe=t.unstable_cancelCallback,de=t.unstable_shouldYield,pe=t.unstable_requestPaint,Q=t.unstable_now,ge=t.unstable_getCurrentPriorityLevel,xe=t.unstable_ImmediatePriority,_e=t.unstable_UserBlockingPriority,Ne=t.unstable_NormalPriority,Xe=t.unstable_LowPriority,Qe=t.unstable_IdlePriority,ht=t.log,Mt=t.unstable_setDisableYieldValue,Et=null,at=null;function nt(l){if(typeof ht=="function"&&Mt(l),at&&typeof at.setStrictMode=="function")try{at.setStrictMode(Et,l)}catch{}}var pt=Math.clz32?Math.clz32:sn,yt=Math.log,pr=Math.LN2;function sn(l){return l>>>=0,l===0?32:31-(yt(l)/pr|0)|0}var Dt=256,Kt=4194304;function or(l){var h=l&42;if(h!==0)return h;switch(l&-l){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return l&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return l&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return l}}function vr(l,h,d){var p=l.pendingLanes;if(p===0)return 0;var S=0,C=l.suspendedLanes,N=l.pingedLanes;l=l.warmLanes;var j=p&134217727;return j!==0?(p=j&~C,p!==0?S=or(p):(N&=j,N!==0?S=or(N):d||(d=j&~l,d!==0&&(S=or(d))))):(j=p&~C,j!==0?S=or(j):N!==0?S=or(N):d||(d=p&~l,d!==0&&(S=or(d)))),S===0?0:h!==0&&h!==S&&(h&C)===0&&(C=S&-S,d=h&-h,C>=d||C===32&&(d&4194048)!==0)?h:S}function $t(l,h){return(l.pendingLanes&~(l.suspendedLanes&~l.pingedLanes)&h)===0}function qi(l,h){switch(l){case 1:case 2:case 4:case 8:case 64:return h+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return h+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Kn(){var l=Dt;return Dt<<=1,(Dt&4194048)===0&&(Dt=256),l}function xa(){var l=Kt;return Kt<<=1,(Kt&62914560)===0&&(Kt=4194304),l}function Bl(l){for(var h=[],d=0;31>d;d++)h.push(l);return h}function Ea(l,h){l.pendingLanes|=h,h!==268435456&&(l.suspendedLanes=0,l.pingedLanes=0,l.warmLanes=0)}function vh(l,h,d,p,S,C){var N=l.pendingLanes;l.pendingLanes=d,l.suspendedLanes=0,l.pingedLanes=0,l.warmLanes=0,l.expiredLanes&=d,l.entangledLanes&=d,l.errorRecoveryDisabledLanes&=d,l.shellSuspendCounter=0;var j=l.entanglements,ue=l.expirationTimes,Oe=l.hiddenUpdates;for(d=N&~d;0<d;){var Le=31-pt(d),We=1<<Le;j[Le]=0,ue[Le]=-1;var ke=Oe[Le];if(ke!==null)for(Oe[Le]=null,Le=0;Le<ke.length;Le++){var De=ke[Le];De!==null&&(De.lane&=-536870913)}d&=~We}p!==0&&wm(l,p,0),C!==0&&S===0&&l.tag!==0&&(l.suspendedLanes|=C&~(N&~h))}function wm(l,h,d){l.pendingLanes|=h,l.suspendedLanes&=~h;var p=31-pt(h);l.entangledLanes|=h,l.entanglements[p]=l.entanglements[p]|1073741824|d&4194090}function Cn(l,h){var d=l.entangledLanes|=h;for(l=l.entanglements;d;){var p=31-pt(d),S=1<<p;S&h|l[p]&h&&(l[p]|=h),d&=~S}}function to(l){switch(l){case 2:l=1;break;case 8:l=4;break;case 32:l=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:l=128;break;case 268435456:l=134217728;break;default:l=0}return l}function id(l){return l&=-l,2<l?8<l?(l&134217727)!==0?32:268435456:8:2}function sd(){var l=le.p;return l!==0?l:(l=window.event,l===void 0?32:vW(l.type))}function ad(l,h){var d=le.p;try{return le.p=l,h()}finally{le.p=d}}var _a=Math.random().toString(36).slice(2),Xn="__reactFiber$"+_a,fi="__reactProps$"+_a,Ti="__reactContainer$"+_a,ro="__reactEvents$"+_a,ym="__reactListeners$"+_a,V="__reactHandles$"+_a,re="__reactResources$"+_a,q="__reactMarker$"+_a;function X(l){delete l[Xn],delete l[fi],delete l[ro],delete l[ym],delete l[V]}function ne(l){var h=l[Xn];if(h)return h;for(var d=l.parentNode;d;){if(h=d[Ti]||d[Xn]){if(d=h.alternate,h.child!==null||d!==null&&d.child!==null)for(l=rW(l);l!==null;){if(d=l[Xn])return d;l=rW(l)}return h}l=d,d=l.parentNode}return null}function se(l){if(l=l[Xn]||l[Ti]){var h=l.tag;if(h===5||h===6||h===13||h===26||h===27||h===3)return l}return null}function Ae(l){var h=l.tag;if(h===5||h===26||h===27||h===6)return l.stateNode;throw Error(n(33))}function He(l){var h=l[re];return h||(h=l[re]={hoistableStyles:new Map,hoistableScripts:new Map}),h}function Re(l){l[q]=!0}var me=new Set,z={};function Ce(l,h){Pe(l,h),Pe(l+"Capture",h)}function Pe(l,h){for(z[l]=h,l=0;l<h.length;l++)me.add(h[l])}var Ye=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),$e={},ze={};function dt(l){return k.call(ze,l)?!0:k.call($e,l)?!1:Ye.test(l)?ze[l]=!0:($e[l]=!0,!1)}function Xt(l,h,d){if(dt(h))if(d===null)l.removeAttribute(h);else{switch(typeof d){case"undefined":case"function":case"symbol":l.removeAttribute(h);return;case"boolean":var p=h.toLowerCase().slice(0,5);if(p!=="data-"&&p!=="aria-"){l.removeAttribute(h);return}}l.setAttribute(h,""+d)}}function cr(l,h,d){if(d===null)l.removeAttribute(h);else{switch(typeof d){case"undefined":case"function":case"symbol":case"boolean":l.removeAttribute(h);return}l.setAttribute(h,""+d)}}function Ir(l,h,d,p){if(p===null)l.removeAttribute(d);else{switch(typeof p){case"undefined":case"function":case"symbol":case"boolean":l.removeAttribute(d);return}l.setAttributeNS(h,d,""+p)}}var an,tl;function Ds(l){if(an===void 0)try{throw Error()}catch(d){var h=d.stack.trim().match(/\n( *(at )?)/);an=h&&h[1]||"",tl=-1<d.stack.indexOf(`
    at`)?" (<anonymous>)":-1<d.stack.indexOf("@")?"@unknown:0:0":""}return`
`+an+l+tl}var rl=!1;function od(l,h){if(!l||rl)return"";rl=!0;var d=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var p={DetermineComponentFrameRoot:function(){try{if(h){var We=function(){throw Error()};if(Object.defineProperty(We.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(We,[])}catch(De){var ke=De}Reflect.construct(l,[],We)}else{try{We.call()}catch(De){ke=De}l.call(We.prototype)}}else{try{throw Error()}catch(De){ke=De}(We=l())&&typeof We.catch=="function"&&We.catch(function(){})}}catch(De){if(De&&ke&&typeof De.stack=="string")return[De.stack,ke.stack]}return[null,null]}};p.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var S=Object.getOwnPropertyDescriptor(p.DetermineComponentFrameRoot,"name");S&&S.configurable&&Object.defineProperty(p.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var C=p.DetermineComponentFrameRoot(),N=C[0],j=C[1];if(N&&j){var ue=N.split(`
`),Oe=j.split(`
`);for(S=p=0;p<ue.length&&!ue[p].includes("DetermineComponentFrameRoot");)p++;for(;S<Oe.length&&!Oe[S].includes("DetermineComponentFrameRoot");)S++;if(p===ue.length||S===Oe.length)for(p=ue.length-1,S=Oe.length-1;1<=p&&0<=S&&ue[p]!==Oe[S];)S--;for(;1<=p&&0<=S;p--,S--)if(ue[p]!==Oe[S]){if(p!==1||S!==1)do if(p--,S--,0>S||ue[p]!==Oe[S]){var Le=`
`+ue[p].replace(" at new "," at ");return l.displayName&&Le.includes("<anonymous>")&&(Le=Le.replace("<anonymous>",l.displayName)),Le}while(1<=p&&0<=S);break}}}finally{rl=!1,Error.prepareStackTrace=d}return(d=l?l.displayName||l.name:"")?Ds(d):""}function nl(l){switch(l.tag){case 26:case 27:case 5:return Ds(l.type);case 16:return Ds("Lazy");case 13:return Ds("Suspense");case 19:return Ds("SuspenseList");case 0:case 15:return od(l.type,!1);case 11:return od(l.type.render,!1);case 1:return od(l.type,!0);case 31:return Ds("Activity");default:return""}}function YB(l){try{var h="";do h+=nl(l),l=l.return;while(l);return h}catch(d){return`
Error generating stack: `+d.message+`
`+d.stack}}function no(l){switch(typeof l){case"bigint":case"boolean":case"number":case"string":case"undefined":return l;case"object":return l;default:return""}}function zB(l){var h=l.type;return(l=l.nodeName)&&l.toLowerCase()==="input"&&(h==="checkbox"||h==="radio")}function Tie(l){var h=zB(l)?"checked":"value",d=Object.getOwnPropertyDescriptor(l.constructor.prototype,h),p=""+l[h];if(!l.hasOwnProperty(h)&&typeof d<"u"&&typeof d.get=="function"&&typeof d.set=="function"){var S=d.get,C=d.set;return Object.defineProperty(l,h,{configurable:!0,get:function(){return S.call(this)},set:function(N){p=""+N,C.call(this,N)}}),Object.defineProperty(l,h,{enumerable:d.enumerable}),{getValue:function(){return p},setValue:function(N){p=""+N},stopTracking:function(){l._valueTracker=null,delete l[h]}}}}function QS(l){l._valueTracker||(l._valueTracker=Tie(l))}function GB(l){if(!l)return!1;var h=l._valueTracker;if(!h)return!0;var d=h.getValue(),p="";return l&&(p=zB(l)?l.checked?"true":"false":l.value),l=p,l!==d?(h.setValue(l),!0):!1}function ZS(l){if(l=l||(typeof document<"u"?document:void 0),typeof l>"u")return null;try{return l.activeElement||l.body}catch{return l.body}}var Mie=/[\n"\\]/g;function io(l){return l.replace(Mie,function(h){return"\\"+h.charCodeAt(0).toString(16)+" "})}function zT(l,h,d,p,S,C,N,j){l.name="",N!=null&&typeof N!="function"&&typeof N!="symbol"&&typeof N!="boolean"?l.type=N:l.removeAttribute("type"),h!=null?N==="number"?(h===0&&l.value===""||l.value!=h)&&(l.value=""+no(h)):l.value!==""+no(h)&&(l.value=""+no(h)):N!=="submit"&&N!=="reset"||l.removeAttribute("value"),h!=null?GT(l,N,no(h)):d!=null?GT(l,N,no(d)):p!=null&&l.removeAttribute("value"),S==null&&C!=null&&(l.defaultChecked=!!C),S!=null&&(l.checked=S&&typeof S!="function"&&typeof S!="symbol"),j!=null&&typeof j!="function"&&typeof j!="symbol"&&typeof j!="boolean"?l.name=""+no(j):l.removeAttribute("name")}function qB(l,h,d,p,S,C,N,j){if(C!=null&&typeof C!="function"&&typeof C!="symbol"&&typeof C!="boolean"&&(l.type=C),h!=null||d!=null){if(!(C!=="submit"&&C!=="reset"||h!=null))return;d=d!=null?""+no(d):"",h=h!=null?""+no(h):d,j||h===l.value||(l.value=h),l.defaultValue=h}p=p??S,p=typeof p!="function"&&typeof p!="symbol"&&!!p,l.checked=j?l.checked:!!p,l.defaultChecked=!!p,N!=null&&typeof N!="function"&&typeof N!="symbol"&&typeof N!="boolean"&&(l.name=N)}function GT(l,h,d){h==="number"&&ZS(l.ownerDocument)===l||l.defaultValue===""+d||(l.defaultValue=""+d)}function Sm(l,h,d,p){if(l=l.options,h){h={};for(var S=0;S<d.length;S++)h["$"+d[S]]=!0;for(d=0;d<l.length;d++)S=h.hasOwnProperty("$"+l[d].value),l[d].selected!==S&&(l[d].selected=S),S&&p&&(l[d].defaultSelected=!0)}else{for(d=""+no(d),h=null,S=0;S<l.length;S++){if(l[S].value===d){l[S].selected=!0,p&&(l[S].defaultSelected=!0);return}h!==null||l[S].disabled||(h=l[S])}h!==null&&(h.selected=!0)}}function KB(l,h,d){if(h!=null&&(h=""+no(h),h!==l.value&&(l.value=h),d==null)){l.defaultValue!==h&&(l.defaultValue=h);return}l.defaultValue=d!=null?""+no(d):""}function XB(l,h,d,p){if(h==null){if(p!=null){if(d!=null)throw Error(n(92));if(we(p)){if(1<p.length)throw Error(n(93));p=p[0]}d=p}d==null&&(d=""),h=d}d=no(h),l.defaultValue=d,p=l.textContent,p===d&&p!==""&&p!==null&&(l.value=p)}function bm(l,h){if(h){var d=l.firstChild;if(d&&d===l.lastChild&&d.nodeType===3){d.nodeValue=h;return}}l.textContent=h}var Aie=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function QB(l,h,d){var p=h.indexOf("--")===0;d==null||typeof d=="boolean"||d===""?p?l.setProperty(h,""):h==="float"?l.cssFloat="":l[h]="":p?l.setProperty(h,d):typeof d!="number"||d===0||Aie.has(h)?h==="float"?l.cssFloat=d:l[h]=(""+d).trim():l[h]=d+"px"}function ZB(l,h,d){if(h!=null&&typeof h!="object")throw Error(n(62));if(l=l.style,d!=null){for(var p in d)!d.hasOwnProperty(p)||h!=null&&h.hasOwnProperty(p)||(p.indexOf("--")===0?l.setProperty(p,""):p==="float"?l.cssFloat="":l[p]="");for(var S in h)p=h[S],h.hasOwnProperty(S)&&d[S]!==p&&QB(l,S,p)}else for(var C in h)h.hasOwnProperty(C)&&QB(l,C,h[C])}function qT(l){if(l.indexOf("-")===-1)return!1;switch(l){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Oie=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),kie=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function JS(l){return kie.test(""+l)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":l}var KT=null;function XT(l){return l=l.target||l.srcElement||window,l.correspondingUseElement&&(l=l.correspondingUseElement),l.nodeType===3?l.parentNode:l}var Cm=null,xm=null;function JB(l){var h=se(l);if(h&&(l=h.stateNode)){var d=l[fi]||null;e:switch(l=h.stateNode,h.type){case"input":if(zT(l,d.value,d.defaultValue,d.defaultValue,d.checked,d.defaultChecked,d.type,d.name),h=d.name,d.type==="radio"&&h!=null){for(d=l;d.parentNode;)d=d.parentNode;for(d=d.querySelectorAll('input[name="'+io(""+h)+'"][type="radio"]'),h=0;h<d.length;h++){var p=d[h];if(p!==l&&p.form===l.form){var S=p[fi]||null;if(!S)throw Error(n(90));zT(p,S.value,S.defaultValue,S.defaultValue,S.checked,S.defaultChecked,S.type,S.name)}}for(h=0;h<d.length;h++)p=d[h],p.form===l.form&&GB(p)}break e;case"textarea":KB(l,d.value,d.defaultValue);break e;case"select":h=d.value,h!=null&&Sm(l,!!d.multiple,h,!1)}}}var QT=!1;function eV(l,h,d){if(QT)return l(h,d);QT=!0;try{var p=l(h);return p}finally{if(QT=!1,(Cm!==null||xm!==null)&&(Lb(),Cm&&(h=Cm,l=xm,xm=Cm=null,JB(h),l)))for(h=0;h<l.length;h++)JB(l[h])}}function vv(l,h){var d=l.stateNode;if(d===null)return null;var p=d[fi]||null;if(p===null)return null;d=p[h];e:switch(h){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(p=!p.disabled)||(l=l.type,p=!(l==="button"||l==="input"||l==="select"||l==="textarea")),l=!p;break e;default:l=!1}if(l)return null;if(d&&typeof d!="function")throw Error(n(231,h,typeof d));return d}var Ju=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ZT=!1;if(Ju)try{var wv={};Object.defineProperty(wv,"passive",{get:function(){ZT=!0}}),window.addEventListener("test",wv,wv),window.removeEventListener("test",wv,wv)}catch{ZT=!1}var wh=null,JT=null,eb=null;function tV(){if(eb)return eb;var l,h=JT,d=h.length,p,S="value"in wh?wh.value:wh.textContent,C=S.length;for(l=0;l<d&&h[l]===S[l];l++);var N=d-l;for(p=1;p<=N&&h[d-p]===S[C-p];p++);return eb=S.slice(l,1<p?1-p:void 0)}function tb(l){var h=l.keyCode;return"charCode"in l?(l=l.charCode,l===0&&h===13&&(l=13)):l=h,l===10&&(l=13),32<=l||l===13?l:0}function rb(){return!0}function rV(){return!1}function Qs(l){function h(d,p,S,C,N){this._reactName=d,this._targetInst=S,this.type=p,this.nativeEvent=C,this.target=N,this.currentTarget=null;for(var j in l)l.hasOwnProperty(j)&&(d=l[j],this[j]=d?d(C):C[j]);return this.isDefaultPrevented=(C.defaultPrevented!=null?C.defaultPrevented:C.returnValue===!1)?rb:rV,this.isPropagationStopped=rV,this}return f(h.prototype,{preventDefault:function(){this.defaultPrevented=!0;var d=this.nativeEvent;d&&(d.preventDefault?d.preventDefault():typeof d.returnValue!="unknown"&&(d.returnValue=!1),this.isDefaultPrevented=rb)},stopPropagation:function(){var d=this.nativeEvent;d&&(d.stopPropagation?d.stopPropagation():typeof d.cancelBubble!="unknown"&&(d.cancelBubble=!0),this.isPropagationStopped=rb)},persist:function(){},isPersistent:rb}),h}var ld={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(l){return l.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},nb=Qs(ld),yv=f({},ld,{view:0,detail:0}),Die=Qs(yv),eM,tM,Sv,ib=f({},yv,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:nM,button:0,buttons:0,relatedTarget:function(l){return l.relatedTarget===void 0?l.fromElement===l.srcElement?l.toElement:l.fromElement:l.relatedTarget},movementX:function(l){return"movementX"in l?l.movementX:(l!==Sv&&(Sv&&l.type==="mousemove"?(eM=l.screenX-Sv.screenX,tM=l.screenY-Sv.screenY):tM=eM=0,Sv=l),eM)},movementY:function(l){return"movementY"in l?l.movementY:tM}}),nV=Qs(ib),Pie=f({},ib,{dataTransfer:0}),Iie=Qs(Pie),Nie=f({},yv,{relatedTarget:0}),rM=Qs(Nie),Hie=f({},ld,{animationName:0,elapsedTime:0,pseudoElement:0}),Fie=Qs(Hie),Lie=f({},ld,{clipboardData:function(l){return"clipboardData"in l?l.clipboardData:window.clipboardData}}),Bie=Qs(Lie),Vie=f({},ld,{data:0}),iV=Qs(Vie),Wie={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},$ie={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Uie={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function jie(l){var h=this.nativeEvent;return h.getModifierState?h.getModifierState(l):(l=Uie[l])?!!h[l]:!1}function nM(){return jie}var Yie=f({},yv,{key:function(l){if(l.key){var h=Wie[l.key]||l.key;if(h!=="Unidentified")return h}return l.type==="keypress"?(l=tb(l),l===13?"Enter":String.fromCharCode(l)):l.type==="keydown"||l.type==="keyup"?$ie[l.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:nM,charCode:function(l){return l.type==="keypress"?tb(l):0},keyCode:function(l){return l.type==="keydown"||l.type==="keyup"?l.keyCode:0},which:function(l){return l.type==="keypress"?tb(l):l.type==="keydown"||l.type==="keyup"?l.keyCode:0}}),zie=Qs(Yie),Gie=f({},ib,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),sV=Qs(Gie),qie=f({},yv,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:nM}),Kie=Qs(qie),Xie=f({},ld,{propertyName:0,elapsedTime:0,pseudoElement:0}),Qie=Qs(Xie),Zie=f({},ib,{deltaX:function(l){return"deltaX"in l?l.deltaX:"wheelDeltaX"in l?-l.wheelDeltaX:0},deltaY:function(l){return"deltaY"in l?l.deltaY:"wheelDeltaY"in l?-l.wheelDeltaY:"wheelDelta"in l?-l.wheelDelta:0},deltaZ:0,deltaMode:0}),Jie=Qs(Zie),ese=f({},ld,{newState:0,oldState:0}),tse=Qs(ese),rse=[9,13,27,32],iM=Ju&&"CompositionEvent"in window,bv=null;Ju&&"documentMode"in document&&(bv=document.documentMode);var nse=Ju&&"TextEvent"in window&&!bv,aV=Ju&&(!iM||bv&&8<bv&&11>=bv),oV=" ",lV=!1;function uV(l,h){switch(l){case"keyup":return rse.indexOf(h.keyCode)!==-1;case"keydown":return h.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function cV(l){return l=l.detail,typeof l=="object"&&"data"in l?l.data:null}var Em=!1;function ise(l,h){switch(l){case"compositionend":return cV(h);case"keypress":return h.which!==32?null:(lV=!0,oV);case"textInput":return l=h.data,l===oV&&lV?null:l;default:return null}}function sse(l,h){if(Em)return l==="compositionend"||!iM&&uV(l,h)?(l=tV(),eb=JT=wh=null,Em=!1,l):null;switch(l){case"paste":return null;case"keypress":if(!(h.ctrlKey||h.altKey||h.metaKey)||h.ctrlKey&&h.altKey){if(h.char&&1<h.char.length)return h.char;if(h.which)return String.fromCharCode(h.which)}return null;case"compositionend":return aV&&h.locale!=="ko"?null:h.data;default:return null}}var ase={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function hV(l){var h=l&&l.nodeName&&l.nodeName.toLowerCase();return h==="input"?!!ase[l.type]:h==="textarea"}function fV(l,h,d,p){Cm?xm?xm.push(p):xm=[p]:Cm=p,h=jb(h,"onChange"),0<h.length&&(d=new nb("onChange","change",null,d,p),l.push({event:d,listeners:h}))}var Cv=null,xv=null;function ose(l){z8(l,0)}function sb(l){var h=Ae(l);if(GB(h))return l}function dV(l,h){if(l==="change")return h}var gV=!1;if(Ju){var sM;if(Ju){var aM="oninput"in document;if(!aM){var mV=document.createElement("div");mV.setAttribute("oninput","return;"),aM=typeof mV.oninput=="function"}sM=aM}else sM=!1;gV=sM&&(!document.documentMode||9<document.documentMode)}function pV(){Cv&&(Cv.detachEvent("onpropertychange",vV),xv=Cv=null)}function vV(l){if(l.propertyName==="value"&&sb(xv)){var h=[];fV(h,xv,l,XT(l)),eV(ose,h)}}function lse(l,h,d){l==="focusin"?(pV(),Cv=h,xv=d,Cv.attachEvent("onpropertychange",vV)):l==="focusout"&&pV()}function use(l){if(l==="selectionchange"||l==="keyup"||l==="keydown")return sb(xv)}function cse(l,h){if(l==="click")return sb(h)}function hse(l,h){if(l==="input"||l==="change")return sb(h)}function fse(l,h){return l===h&&(l!==0||1/l===1/h)||l!==l&&h!==h}var Ra=typeof Object.is=="function"?Object.is:fse;function Ev(l,h){if(Ra(l,h))return!0;if(typeof l!="object"||l===null||typeof h!="object"||h===null)return!1;var d=Object.keys(l),p=Object.keys(h);if(d.length!==p.length)return!1;for(p=0;p<d.length;p++){var S=d[p];if(!k.call(h,S)||!Ra(l[S],h[S]))return!1}return!0}function wV(l){for(;l&&l.firstChild;)l=l.firstChild;return l}function yV(l,h){var d=wV(l);l=0;for(var p;d;){if(d.nodeType===3){if(p=l+d.textContent.length,l<=h&&p>=h)return{node:d,offset:h-l};l=p}e:{for(;d;){if(d.nextSibling){d=d.nextSibling;break e}d=d.parentNode}d=void 0}d=wV(d)}}function SV(l,h){return l&&h?l===h?!0:l&&l.nodeType===3?!1:h&&h.nodeType===3?SV(l,h.parentNode):"contains"in l?l.contains(h):l.compareDocumentPosition?!!(l.compareDocumentPosition(h)&16):!1:!1}function bV(l){l=l!=null&&l.ownerDocument!=null&&l.ownerDocument.defaultView!=null?l.ownerDocument.defaultView:window;for(var h=ZS(l.document);h instanceof l.HTMLIFrameElement;){try{var d=typeof h.contentWindow.location.href=="string"}catch{d=!1}if(d)l=h.contentWindow;else break;h=ZS(l.document)}return h}function oM(l){var h=l&&l.nodeName&&l.nodeName.toLowerCase();return h&&(h==="input"&&(l.type==="text"||l.type==="search"||l.type==="tel"||l.type==="url"||l.type==="password")||h==="textarea"||l.contentEditable==="true")}var dse=Ju&&"documentMode"in document&&11>=document.documentMode,_m=null,lM=null,_v=null,uM=!1;function CV(l,h,d){var p=d.window===d?d.document:d.nodeType===9?d:d.ownerDocument;uM||_m==null||_m!==ZS(p)||(p=_m,"selectionStart"in p&&oM(p)?p={start:p.selectionStart,end:p.selectionEnd}:(p=(p.ownerDocument&&p.ownerDocument.defaultView||window).getSelection(),p={anchorNode:p.anchorNode,anchorOffset:p.anchorOffset,focusNode:p.focusNode,focusOffset:p.focusOffset}),_v&&Ev(_v,p)||(_v=p,p=jb(lM,"onSelect"),0<p.length&&(h=new nb("onSelect","select",null,h,d),l.push({event:h,listeners:p}),h.target=_m)))}function ud(l,h){var d={};return d[l.toLowerCase()]=h.toLowerCase(),d["Webkit"+l]="webkit"+h,d["Moz"+l]="moz"+h,d}var Rm={animationend:ud("Animation","AnimationEnd"),animationiteration:ud("Animation","AnimationIteration"),animationstart:ud("Animation","AnimationStart"),transitionrun:ud("Transition","TransitionRun"),transitionstart:ud("Transition","TransitionStart"),transitioncancel:ud("Transition","TransitionCancel"),transitionend:ud("Transition","TransitionEnd")},cM={},xV={};Ju&&(xV=document.createElement("div").style,"AnimationEvent"in window||(delete Rm.animationend.animation,delete Rm.animationiteration.animation,delete Rm.animationstart.animation),"TransitionEvent"in window||delete Rm.transitionend.transition);function cd(l){if(cM[l])return cM[l];if(!Rm[l])return l;var h=Rm[l],d;for(d in h)if(h.hasOwnProperty(d)&&d in xV)return cM[l]=h[d];return l}var EV=cd("animationend"),_V=cd("animationiteration"),RV=cd("animationstart"),gse=cd("transitionrun"),mse=cd("transitionstart"),pse=cd("transitioncancel"),TV=cd("transitionend"),MV=new Map,hM="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");hM.push("scrollEnd");function il(l,h){MV.set(l,h),Ce(h,[l])}var AV=new WeakMap;function so(l,h){if(typeof l=="object"&&l!==null){var d=AV.get(l);return d!==void 0?d:(h={value:l,source:h,stack:YB(h)},AV.set(l,h),h)}return{value:l,source:h,stack:YB(h)}}var ao=[],Tm=0,fM=0;function ab(){for(var l=Tm,h=fM=Tm=0;h<l;){var d=ao[h];ao[h++]=null;var p=ao[h];ao[h++]=null;var S=ao[h];ao[h++]=null;var C=ao[h];if(ao[h++]=null,p!==null&&S!==null){var N=p.pending;N===null?S.next=S:(S.next=N.next,N.next=S),p.pending=S}C!==0&&OV(d,S,C)}}function ob(l,h,d,p){ao[Tm++]=l,ao[Tm++]=h,ao[Tm++]=d,ao[Tm++]=p,fM|=p,l.lanes|=p,l=l.alternate,l!==null&&(l.lanes|=p)}function dM(l,h,d,p){return ob(l,h,d,p),lb(l)}function Mm(l,h){return ob(l,null,null,h),lb(l)}function OV(l,h,d){l.lanes|=d;var p=l.alternate;p!==null&&(p.lanes|=d);for(var S=!1,C=l.return;C!==null;)C.childLanes|=d,p=C.alternate,p!==null&&(p.childLanes|=d),C.tag===22&&(l=C.stateNode,l===null||l._visibility&1||(S=!0)),l=C,C=C.return;return l.tag===3?(C=l.stateNode,S&&h!==null&&(S=31-pt(d),l=C.hiddenUpdates,p=l[S],p===null?l[S]=[h]:p.push(h),h.lane=d|536870912),C):null}function lb(l){if(50<Xv)throw Xv=0,yA=null,Error(n(185));for(var h=l.return;h!==null;)l=h,h=l.return;return l.tag===3?l.stateNode:null}var Am={};function vse(l,h,d,p){this.tag=l,this.key=d,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=h,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=p,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ta(l,h,d,p){return new vse(l,h,d,p)}function gM(l){return l=l.prototype,!(!l||!l.isReactComponent)}function ec(l,h){var d=l.alternate;return d===null?(d=Ta(l.tag,h,l.key,l.mode),d.elementType=l.elementType,d.type=l.type,d.stateNode=l.stateNode,d.alternate=l,l.alternate=d):(d.pendingProps=h,d.type=l.type,d.flags=0,d.subtreeFlags=0,d.deletions=null),d.flags=l.flags&65011712,d.childLanes=l.childLanes,d.lanes=l.lanes,d.child=l.child,d.memoizedProps=l.memoizedProps,d.memoizedState=l.memoizedState,d.updateQueue=l.updateQueue,h=l.dependencies,d.dependencies=h===null?null:{lanes:h.lanes,firstContext:h.firstContext},d.sibling=l.sibling,d.index=l.index,d.ref=l.ref,d.refCleanup=l.refCleanup,d}function kV(l,h){l.flags&=65011714;var d=l.alternate;return d===null?(l.childLanes=0,l.lanes=h,l.child=null,l.subtreeFlags=0,l.memoizedProps=null,l.memoizedState=null,l.updateQueue=null,l.dependencies=null,l.stateNode=null):(l.childLanes=d.childLanes,l.lanes=d.lanes,l.child=d.child,l.subtreeFlags=0,l.deletions=null,l.memoizedProps=d.memoizedProps,l.memoizedState=d.memoizedState,l.updateQueue=d.updateQueue,l.type=d.type,h=d.dependencies,l.dependencies=h===null?null:{lanes:h.lanes,firstContext:h.firstContext}),l}function ub(l,h,d,p,S,C){var N=0;if(p=l,typeof l=="function")gM(l)&&(N=1);else if(typeof l=="string")N=yae(l,d,R.current)?26:l==="html"||l==="head"||l==="body"?27:5;else e:switch(l){case L:return l=Ta(31,d,h,S),l.elementType=L,l.lanes=C,l;case w:return hd(d.children,S,C,h);case y:N=8,S|=24;break;case b:return l=Ta(12,d,h,S|2),l.elementType=b,l.lanes=C,l;case P:return l=Ta(13,d,h,S),l.elementType=P,l.lanes=C,l;case O:return l=Ta(19,d,h,S),l.elementType=O,l.lanes=C,l;default:if(typeof l=="object"&&l!==null)switch(l.$$typeof){case x:case T:N=10;break e;case _:N=9;break e;case D:N=11;break e;case A:N=14;break e;case W:N=16,p=null;break e}N=29,d=Error(n(130,l===null?"null":typeof l,"")),p=null}return h=Ta(N,d,h,S),h.elementType=l,h.type=p,h.lanes=C,h}function hd(l,h,d,p){return l=Ta(7,l,p,h),l.lanes=d,l}function mM(l,h,d){return l=Ta(6,l,null,h),l.lanes=d,l}function pM(l,h,d){return h=Ta(4,l.children!==null?l.children:[],l.key,h),h.lanes=d,h.stateNode={containerInfo:l.containerInfo,pendingChildren:null,implementation:l.implementation},h}var Om=[],km=0,cb=null,hb=0,oo=[],lo=0,fd=null,tc=1,rc="";function dd(l,h){Om[km++]=hb,Om[km++]=cb,cb=l,hb=h}function DV(l,h,d){oo[lo++]=tc,oo[lo++]=rc,oo[lo++]=fd,fd=l;var p=tc;l=rc;var S=32-pt(p)-1;p&=~(1<<S),d+=1;var C=32-pt(h)+S;if(30<C){var N=S-S%5;C=(p&(1<<N)-1).toString(32),p>>=N,S-=N,tc=1<<32-pt(h)+S|d<<S|p,rc=C+l}else tc=1<<C|d<<S|p,rc=l}function vM(l){l.return!==null&&(dd(l,1),DV(l,1,0))}function wM(l){for(;l===cb;)cb=Om[--km],Om[km]=null,hb=Om[--km],Om[km]=null;for(;l===fd;)fd=oo[--lo],oo[lo]=null,rc=oo[--lo],oo[lo]=null,tc=oo[--lo],oo[lo]=null}var Ps=null,Hn=null,Tr=!1,gd=null,Vl=!1,yM=Error(n(519));function md(l){var h=Error(n(418,""));throw Mv(so(h,l)),yM}function PV(l){var h=l.stateNode,d=l.type,p=l.memoizedProps;switch(h[Xn]=l,h[fi]=p,d){case"dialog":er("cancel",h),er("close",h);break;case"iframe":case"object":case"embed":er("load",h);break;case"video":case"audio":for(d=0;d<Zv.length;d++)er(Zv[d],h);break;case"source":er("error",h);break;case"img":case"image":case"link":er("error",h),er("load",h);break;case"details":er("toggle",h);break;case"input":er("invalid",h),qB(h,p.value,p.defaultValue,p.checked,p.defaultChecked,p.type,p.name,!0),QS(h);break;case"select":er("invalid",h);break;case"textarea":er("invalid",h),XB(h,p.value,p.defaultValue,p.children),QS(h)}d=p.children,typeof d!="string"&&typeof d!="number"&&typeof d!="bigint"||h.textContent===""+d||p.suppressHydrationWarning===!0||X8(h.textContent,d)?(p.popover!=null&&(er("beforetoggle",h),er("toggle",h)),p.onScroll!=null&&er("scroll",h),p.onScrollEnd!=null&&er("scrollend",h),p.onClick!=null&&(h.onclick=Yb),h=!0):h=!1,h||md(l)}function IV(l){for(Ps=l.return;Ps;)switch(Ps.tag){case 5:case 13:Vl=!1;return;case 27:case 3:Vl=!0;return;default:Ps=Ps.return}}function Rv(l){if(l!==Ps)return!1;if(!Tr)return IV(l),Tr=!0,!1;var h=l.tag,d;if((d=h!==3&&h!==27)&&((d=h===5)&&(d=l.type,d=!(d!=="form"&&d!=="button")||NA(l.type,l.memoizedProps)),d=!d),d&&Hn&&md(l),IV(l),h===13){if(l=l.memoizedState,l=l!==null?l.dehydrated:null,!l)throw Error(n(317));e:{for(l=l.nextSibling,h=0;l;){if(l.nodeType===8)if(d=l.data,d==="/$"){if(h===0){Hn=al(l.nextSibling);break e}h--}else d!=="$"&&d!=="$!"&&d!=="$?"||h++;l=l.nextSibling}Hn=null}}else h===27?(h=Hn,Ih(l.type)?(l=BA,BA=null,Hn=l):Hn=h):Hn=Ps?al(l.stateNode.nextSibling):null;return!0}function Tv(){Hn=Ps=null,Tr=!1}function NV(){var l=gd;return l!==null&&(ea===null?ea=l:ea.push.apply(ea,l),gd=null),l}function Mv(l){gd===null?gd=[l]:gd.push(l)}var SM=Se(null),pd=null,nc=null;function yh(l,h,d){E(SM,h._currentValue),h._currentValue=d}function ic(l){l._currentValue=SM.current,B(SM)}function bM(l,h,d){for(;l!==null;){var p=l.alternate;if((l.childLanes&h)!==h?(l.childLanes|=h,p!==null&&(p.childLanes|=h)):p!==null&&(p.childLanes&h)!==h&&(p.childLanes|=h),l===d)break;l=l.return}}function CM(l,h,d,p){var S=l.child;for(S!==null&&(S.return=l);S!==null;){var C=S.dependencies;if(C!==null){var N=S.child;C=C.firstContext;e:for(;C!==null;){var j=C;C=S;for(var ue=0;ue<h.length;ue++)if(j.context===h[ue]){C.lanes|=d,j=C.alternate,j!==null&&(j.lanes|=d),bM(C.return,d,l),p||(N=null);break e}C=j.next}}else if(S.tag===18){if(N=S.return,N===null)throw Error(n(341));N.lanes|=d,C=N.alternate,C!==null&&(C.lanes|=d),bM(N,d,l),N=null}else N=S.child;if(N!==null)N.return=S;else for(N=S;N!==null;){if(N===l){N=null;break}if(S=N.sibling,S!==null){S.return=N.return,N=S;break}N=N.return}S=N}}function Av(l,h,d,p){l=null;for(var S=h,C=!1;S!==null;){if(!C){if((S.flags&524288)!==0)C=!0;else if((S.flags&262144)!==0)break}if(S.tag===10){var N=S.alternate;if(N===null)throw Error(n(387));if(N=N.memoizedProps,N!==null){var j=S.type;Ra(S.pendingProps.value,N.value)||(l!==null?l.push(j):l=[j])}}else if(S===Z.current){if(N=S.alternate,N===null)throw Error(n(387));N.memoizedState.memoizedState!==S.memoizedState.memoizedState&&(l!==null?l.push(iw):l=[iw])}S=S.return}l!==null&&CM(h,l,d,p),h.flags|=262144}function fb(l){for(l=l.firstContext;l!==null;){if(!Ra(l.context._currentValue,l.memoizedValue))return!0;l=l.next}return!1}function vd(l){pd=l,nc=null,l=l.dependencies,l!==null&&(l.firstContext=null)}function os(l){return HV(pd,l)}function db(l,h){return pd===null&&vd(l),HV(l,h)}function HV(l,h){var d=h._currentValue;if(h={context:h,memoizedValue:d,next:null},nc===null){if(l===null)throw Error(n(308));nc=h,l.dependencies={lanes:0,firstContext:h},l.flags|=524288}else nc=nc.next=h;return d}var wse=typeof AbortController<"u"?AbortController:function(){var l=[],h=this.signal={aborted:!1,addEventListener:function(d,p){l.push(p)}};this.abort=function(){h.aborted=!0,l.forEach(function(d){return d()})}},yse=t.unstable_scheduleCallback,Sse=t.unstable_NormalPriority,Mi={$$typeof:T,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function xM(){return{controller:new wse,data:new Map,refCount:0}}function Ov(l){l.refCount--,l.refCount===0&&yse(Sse,function(){l.controller.abort()})}var kv=null,EM=0,Dm=0,Pm=null;function bse(l,h){if(kv===null){var d=kv=[];EM=0,Dm=RA(),Pm={status:"pending",value:void 0,then:function(p){d.push(p)}}}return EM++,h.then(FV,FV),h}function FV(){if(--EM===0&&kv!==null){Pm!==null&&(Pm.status="fulfilled");var l=kv;kv=null,Dm=0,Pm=null;for(var h=0;h<l.length;h++)(0,l[h])()}}function Cse(l,h){var d=[],p={status:"pending",value:null,reason:null,then:function(S){d.push(S)}};return l.then(function(){p.status="fulfilled",p.value=h;for(var S=0;S<d.length;S++)(0,d[S])(h)},function(S){for(p.status="rejected",p.reason=S,S=0;S<d.length;S++)(0,d[S])(void 0)}),p}var LV=ae.S;ae.S=function(l,h){typeof h=="object"&&h!==null&&typeof h.then=="function"&&bse(l,h),LV!==null&&LV(l,h)};var wd=Se(null);function _M(){var l=wd.current;return l!==null?l:on.pooledCache}function gb(l,h){h===null?E(wd,wd.current):E(wd,h.pool)}function BV(){var l=_M();return l===null?null:{parent:Mi._currentValue,pool:l}}var Dv=Error(n(460)),VV=Error(n(474)),mb=Error(n(542)),RM={then:function(){}};function WV(l){return l=l.status,l==="fulfilled"||l==="rejected"}function pb(){}function $V(l,h,d){switch(d=l[d],d===void 0?l.push(h):d!==h&&(h.then(pb,pb),h=d),h.status){case"fulfilled":return h.value;case"rejected":throw l=h.reason,jV(l),l;default:if(typeof h.status=="string")h.then(pb,pb);else{if(l=on,l!==null&&100<l.shellSuspendCounter)throw Error(n(482));l=h,l.status="pending",l.then(function(p){if(h.status==="pending"){var S=h;S.status="fulfilled",S.value=p}},function(p){if(h.status==="pending"){var S=h;S.status="rejected",S.reason=p}})}switch(h.status){case"fulfilled":return h.value;case"rejected":throw l=h.reason,jV(l),l}throw Pv=h,Dv}}var Pv=null;function UV(){if(Pv===null)throw Error(n(459));var l=Pv;return Pv=null,l}function jV(l){if(l===Dv||l===mb)throw Error(n(483))}var Sh=!1;function TM(l){l.updateQueue={baseState:l.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function MM(l,h){l=l.updateQueue,h.updateQueue===l&&(h.updateQueue={baseState:l.baseState,firstBaseUpdate:l.firstBaseUpdate,lastBaseUpdate:l.lastBaseUpdate,shared:l.shared,callbacks:null})}function bh(l){return{lane:l,tag:0,payload:null,callback:null,next:null}}function Ch(l,h,d){var p=l.updateQueue;if(p===null)return null;if(p=p.shared,(Br&2)!==0){var S=p.pending;return S===null?h.next=h:(h.next=S.next,S.next=h),p.pending=h,h=lb(l),OV(l,null,d),h}return ob(l,p,h,d),lb(l)}function Iv(l,h,d){if(h=h.updateQueue,h!==null&&(h=h.shared,(d&4194048)!==0)){var p=h.lanes;p&=l.pendingLanes,d|=p,h.lanes=d,Cn(l,d)}}function AM(l,h){var d=l.updateQueue,p=l.alternate;if(p!==null&&(p=p.updateQueue,d===p)){var S=null,C=null;if(d=d.firstBaseUpdate,d!==null){do{var N={lane:d.lane,tag:d.tag,payload:d.payload,callback:null,next:null};C===null?S=C=N:C=C.next=N,d=d.next}while(d!==null);C===null?S=C=h:C=C.next=h}else S=C=h;d={baseState:p.baseState,firstBaseUpdate:S,lastBaseUpdate:C,shared:p.shared,callbacks:p.callbacks},l.updateQueue=d;return}l=d.lastBaseUpdate,l===null?d.firstBaseUpdate=h:l.next=h,d.lastBaseUpdate=h}var OM=!1;function Nv(){if(OM){var l=Pm;if(l!==null)throw l}}function Hv(l,h,d,p){OM=!1;var S=l.updateQueue;Sh=!1;var C=S.firstBaseUpdate,N=S.lastBaseUpdate,j=S.shared.pending;if(j!==null){S.shared.pending=null;var ue=j,Oe=ue.next;ue.next=null,N===null?C=Oe:N.next=Oe,N=ue;var Le=l.alternate;Le!==null&&(Le=Le.updateQueue,j=Le.lastBaseUpdate,j!==N&&(j===null?Le.firstBaseUpdate=Oe:j.next=Oe,Le.lastBaseUpdate=ue))}if(C!==null){var We=S.baseState;N=0,Le=Oe=ue=null,j=C;do{var ke=j.lane&-536870913,De=ke!==j.lane;if(De?(hr&ke)===ke:(p&ke)===ke){ke!==0&&ke===Dm&&(OM=!0),Le!==null&&(Le=Le.next={lane:0,tag:j.tag,payload:j.payload,callback:null,next:null});e:{var At=l,_t=j;ke=h;var Qr=d;switch(_t.tag){case 1:if(At=_t.payload,typeof At=="function"){We=At.call(Qr,We,ke);break e}We=At;break e;case 3:At.flags=At.flags&-65537|128;case 0:if(At=_t.payload,ke=typeof At=="function"?At.call(Qr,We,ke):At,ke==null)break e;We=f({},We,ke);break e;case 2:Sh=!0}}ke=j.callback,ke!==null&&(l.flags|=64,De&&(l.flags|=8192),De=S.callbacks,De===null?S.callbacks=[ke]:De.push(ke))}else De={lane:ke,tag:j.tag,payload:j.payload,callback:j.callback,next:null},Le===null?(Oe=Le=De,ue=We):Le=Le.next=De,N|=ke;if(j=j.next,j===null){if(j=S.shared.pending,j===null)break;De=j,j=De.next,De.next=null,S.lastBaseUpdate=De,S.shared.pending=null}}while(!0);Le===null&&(ue=We),S.baseState=ue,S.firstBaseUpdate=Oe,S.lastBaseUpdate=Le,C===null&&(S.shared.lanes=0),Oh|=N,l.lanes=N,l.memoizedState=We}}function YV(l,h){if(typeof l!="function")throw Error(n(191,l));l.call(h)}function zV(l,h){var d=l.callbacks;if(d!==null)for(l.callbacks=null,l=0;l<d.length;l++)YV(d[l],h)}var Im=Se(null),vb=Se(0);function GV(l,h){l=hc,E(vb,l),E(Im,h),hc=l|h.baseLanes}function kM(){E(vb,hc),E(Im,Im.current)}function DM(){hc=vb.current,B(Im),B(vb)}var xh=0,zt=null,Kr=null,di=null,wb=!1,Nm=!1,yd=!1,yb=0,Fv=0,Hm=null,xse=0;function Qn(){throw Error(n(321))}function PM(l,h){if(h===null)return!1;for(var d=0;d<h.length&&d<l.length;d++)if(!Ra(l[d],h[d]))return!1;return!0}function IM(l,h,d,p,S,C){return xh=C,zt=h,h.memoizedState=null,h.updateQueue=null,h.lanes=0,ae.H=l===null||l.memoizedState===null?O6:k6,yd=!1,C=d(p,S),yd=!1,Nm&&(C=KV(h,d,p,S)),qV(l),C}function qV(l){ae.H=_b;var h=Kr!==null&&Kr.next!==null;if(xh=0,di=Kr=zt=null,wb=!1,Fv=0,Hm=null,h)throw Error(n(300));l===null||Fi||(l=l.dependencies,l!==null&&fb(l)&&(Fi=!0))}function KV(l,h,d,p){zt=l;var S=0;do{if(Nm&&(Hm=null),Fv=0,Nm=!1,25<=S)throw Error(n(301));if(S+=1,di=Kr=null,l.updateQueue!=null){var C=l.updateQueue;C.lastEffect=null,C.events=null,C.stores=null,C.memoCache!=null&&(C.memoCache.index=0)}ae.H=Ose,C=h(d,p)}while(Nm);return C}function Ese(){var l=ae.H,h=l.useState()[0];return h=typeof h.then=="function"?Lv(h):h,l=l.useState()[0],(Kr!==null?Kr.memoizedState:null)!==l&&(zt.flags|=1024),h}function NM(){var l=yb!==0;return yb=0,l}function HM(l,h,d){h.updateQueue=l.updateQueue,h.flags&=-2053,l.lanes&=~d}function FM(l){if(wb){for(l=l.memoizedState;l!==null;){var h=l.queue;h!==null&&(h.pending=null),l=l.next}wb=!1}xh=0,di=Kr=zt=null,Nm=!1,Fv=yb=0,Hm=null}function Zs(){var l={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return di===null?zt.memoizedState=di=l:di=di.next=l,di}function gi(){if(Kr===null){var l=zt.alternate;l=l!==null?l.memoizedState:null}else l=Kr.next;var h=di===null?zt.memoizedState:di.next;if(h!==null)di=h,Kr=l;else{if(l===null)throw zt.alternate===null?Error(n(467)):Error(n(310));Kr=l,l={memoizedState:Kr.memoizedState,baseState:Kr.baseState,baseQueue:Kr.baseQueue,queue:Kr.queue,next:null},di===null?zt.memoizedState=di=l:di=di.next=l}return di}function LM(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Lv(l){var h=Fv;return Fv+=1,Hm===null&&(Hm=[]),l=$V(Hm,l,h),h=zt,(di===null?h.memoizedState:di.next)===null&&(h=h.alternate,ae.H=h===null||h.memoizedState===null?O6:k6),l}function Sb(l){if(l!==null&&typeof l=="object"){if(typeof l.then=="function")return Lv(l);if(l.$$typeof===T)return os(l)}throw Error(n(438,String(l)))}function BM(l){var h=null,d=zt.updateQueue;if(d!==null&&(h=d.memoCache),h==null){var p=zt.alternate;p!==null&&(p=p.updateQueue,p!==null&&(p=p.memoCache,p!=null&&(h={data:p.data.map(function(S){return S.slice()}),index:0})))}if(h==null&&(h={data:[],index:0}),d===null&&(d=LM(),zt.updateQueue=d),d.memoCache=h,d=h.data[h.index],d===void 0)for(d=h.data[h.index]=Array(l),p=0;p<l;p++)d[p]=H;return h.index++,d}function sc(l,h){return typeof h=="function"?h(l):h}function bb(l){var h=gi();return VM(h,Kr,l)}function VM(l,h,d){var p=l.queue;if(p===null)throw Error(n(311));p.lastRenderedReducer=d;var S=l.baseQueue,C=p.pending;if(C!==null){if(S!==null){var N=S.next;S.next=C.next,C.next=N}h.baseQueue=S=C,p.pending=null}if(C=l.baseState,S===null)l.memoizedState=C;else{h=S.next;var j=N=null,ue=null,Oe=h,Le=!1;do{var We=Oe.lane&-536870913;if(We!==Oe.lane?(hr&We)===We:(xh&We)===We){var ke=Oe.revertLane;if(ke===0)ue!==null&&(ue=ue.next={lane:0,revertLane:0,action:Oe.action,hasEagerState:Oe.hasEagerState,eagerState:Oe.eagerState,next:null}),We===Dm&&(Le=!0);else if((xh&ke)===ke){Oe=Oe.next,ke===Dm&&(Le=!0);continue}else We={lane:0,revertLane:Oe.revertLane,action:Oe.action,hasEagerState:Oe.hasEagerState,eagerState:Oe.eagerState,next:null},ue===null?(j=ue=We,N=C):ue=ue.next=We,zt.lanes|=ke,Oh|=ke;We=Oe.action,yd&&d(C,We),C=Oe.hasEagerState?Oe.eagerState:d(C,We)}else ke={lane:We,revertLane:Oe.revertLane,action:Oe.action,hasEagerState:Oe.hasEagerState,eagerState:Oe.eagerState,next:null},ue===null?(j=ue=ke,N=C):ue=ue.next=ke,zt.lanes|=We,Oh|=We;Oe=Oe.next}while(Oe!==null&&Oe!==h);if(ue===null?N=C:ue.next=j,!Ra(C,l.memoizedState)&&(Fi=!0,Le&&(d=Pm,d!==null)))throw d;l.memoizedState=C,l.baseState=N,l.baseQueue=ue,p.lastRenderedState=C}return S===null&&(p.lanes=0),[l.memoizedState,p.dispatch]}function WM(l){var h=gi(),d=h.queue;if(d===null)throw Error(n(311));d.lastRenderedReducer=l;var p=d.dispatch,S=d.pending,C=h.memoizedState;if(S!==null){d.pending=null;var N=S=S.next;do C=l(C,N.action),N=N.next;while(N!==S);Ra(C,h.memoizedState)||(Fi=!0),h.memoizedState=C,h.baseQueue===null&&(h.baseState=C),d.lastRenderedState=C}return[C,p]}function XV(l,h,d){var p=zt,S=gi(),C=Tr;if(C){if(d===void 0)throw Error(n(407));d=d()}else d=h();var N=!Ra((Kr||S).memoizedState,d);N&&(S.memoizedState=d,Fi=!0),S=S.queue;var j=JV.bind(null,p,S,l);if(Bv(2048,8,j,[l]),S.getSnapshot!==h||N||di!==null&&di.memoizedState.tag&1){if(p.flags|=2048,Fm(9,Cb(),ZV.bind(null,p,S,d,h),null),on===null)throw Error(n(349));C||(xh&124)!==0||QV(p,h,d)}return d}function QV(l,h,d){l.flags|=16384,l={getSnapshot:h,value:d},h=zt.updateQueue,h===null?(h=LM(),zt.updateQueue=h,h.stores=[l]):(d=h.stores,d===null?h.stores=[l]:d.push(l))}function ZV(l,h,d,p){h.value=d,h.getSnapshot=p,e6(h)&&t6(l)}function JV(l,h,d){return d(function(){e6(h)&&t6(l)})}function e6(l){var h=l.getSnapshot;l=l.value;try{var d=h();return!Ra(l,d)}catch{return!0}}function t6(l){var h=Mm(l,2);h!==null&&Da(h,l,2)}function $M(l){var h=Zs();if(typeof l=="function"){var d=l;if(l=d(),yd){nt(!0);try{d()}finally{nt(!1)}}}return h.memoizedState=h.baseState=l,h.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:sc,lastRenderedState:l},h}function r6(l,h,d,p){return l.baseState=d,VM(l,Kr,typeof p=="function"?p:sc)}function _se(l,h,d,p,S){if(Eb(l))throw Error(n(485));if(l=h.action,l!==null){var C={payload:S,action:l,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(N){C.listeners.push(N)}};ae.T!==null?d(!0):C.isTransition=!1,p(C),d=h.pending,d===null?(C.next=h.pending=C,n6(h,C)):(C.next=d.next,h.pending=d.next=C)}}function n6(l,h){var d=h.action,p=h.payload,S=l.state;if(h.isTransition){var C=ae.T,N={};ae.T=N;try{var j=d(S,p),ue=ae.S;ue!==null&&ue(N,j),i6(l,h,j)}catch(Oe){UM(l,h,Oe)}finally{ae.T=C}}else try{C=d(S,p),i6(l,h,C)}catch(Oe){UM(l,h,Oe)}}function i6(l,h,d){d!==null&&typeof d=="object"&&typeof d.then=="function"?d.then(function(p){s6(l,h,p)},function(p){return UM(l,h,p)}):s6(l,h,d)}function s6(l,h,d){h.status="fulfilled",h.value=d,a6(h),l.state=d,h=l.pending,h!==null&&(d=h.next,d===h?l.pending=null:(d=d.next,h.next=d,n6(l,d)))}function UM(l,h,d){var p=l.pending;if(l.pending=null,p!==null){p=p.next;do h.status="rejected",h.reason=d,a6(h),h=h.next;while(h!==p)}l.action=null}function a6(l){l=l.listeners;for(var h=0;h<l.length;h++)(0,l[h])()}function o6(l,h){return h}function l6(l,h){if(Tr){var d=on.formState;if(d!==null){e:{var p=zt;if(Tr){if(Hn){t:{for(var S=Hn,C=Vl;S.nodeType!==8;){if(!C){S=null;break t}if(S=al(S.nextSibling),S===null){S=null;break t}}C=S.data,S=C==="F!"||C==="F"?S:null}if(S){Hn=al(S.nextSibling),p=S.data==="F!";break e}}md(p)}p=!1}p&&(h=d[0])}}return d=Zs(),d.memoizedState=d.baseState=h,p={pending:null,lanes:0,dispatch:null,lastRenderedReducer:o6,lastRenderedState:h},d.queue=p,d=T6.bind(null,zt,p),p.dispatch=d,p=$M(!1),C=qM.bind(null,zt,!1,p.queue),p=Zs(),S={state:h,dispatch:null,action:l,pending:null},p.queue=S,d=_se.bind(null,zt,S,C,d),S.dispatch=d,p.memoizedState=l,[h,d,!1]}function u6(l){var h=gi();return c6(h,Kr,l)}function c6(l,h,d){if(h=VM(l,h,o6)[0],l=bb(sc)[0],typeof h=="object"&&h!==null&&typeof h.then=="function")try{var p=Lv(h)}catch(N){throw N===Dv?mb:N}else p=h;h=gi();var S=h.queue,C=S.dispatch;return d!==h.memoizedState&&(zt.flags|=2048,Fm(9,Cb(),Rse.bind(null,S,d),null)),[p,C,l]}function Rse(l,h){l.action=h}function h6(l){var h=gi(),d=Kr;if(d!==null)return c6(h,d,l);gi(),h=h.memoizedState,d=gi();var p=d.queue.dispatch;return d.memoizedState=l,[h,p,!1]}function Fm(l,h,d,p){return l={tag:l,create:d,deps:p,inst:h,next:null},h=zt.updateQueue,h===null&&(h=LM(),zt.updateQueue=h),d=h.lastEffect,d===null?h.lastEffect=l.next=l:(p=d.next,d.next=l,l.next=p,h.lastEffect=l),l}function Cb(){return{destroy:void 0,resource:void 0}}function f6(){return gi().memoizedState}function xb(l,h,d,p){var S=Zs();p=p===void 0?null:p,zt.flags|=l,S.memoizedState=Fm(1|h,Cb(),d,p)}function Bv(l,h,d,p){var S=gi();p=p===void 0?null:p;var C=S.memoizedState.inst;Kr!==null&&p!==null&&PM(p,Kr.memoizedState.deps)?S.memoizedState=Fm(h,C,d,p):(zt.flags|=l,S.memoizedState=Fm(1|h,C,d,p))}function d6(l,h){xb(8390656,8,l,h)}function g6(l,h){Bv(2048,8,l,h)}function m6(l,h){return Bv(4,2,l,h)}function p6(l,h){return Bv(4,4,l,h)}function v6(l,h){if(typeof h=="function"){l=l();var d=h(l);return function(){typeof d=="function"?d():h(null)}}if(h!=null)return l=l(),h.current=l,function(){h.current=null}}function w6(l,h,d){d=d!=null?d.concat([l]):null,Bv(4,4,v6.bind(null,h,l),d)}function jM(){}function y6(l,h){var d=gi();h=h===void 0?null:h;var p=d.memoizedState;return h!==null&&PM(h,p[1])?p[0]:(d.memoizedState=[l,h],l)}function S6(l,h){var d=gi();h=h===void 0?null:h;var p=d.memoizedState;if(h!==null&&PM(h,p[1]))return p[0];if(p=l(),yd){nt(!0);try{l()}finally{nt(!1)}}return d.memoizedState=[p,h],p}function YM(l,h,d){return d===void 0||(xh&1073741824)!==0?l.memoizedState=h:(l.memoizedState=d,l=x8(),zt.lanes|=l,Oh|=l,d)}function b6(l,h,d,p){return Ra(d,h)?d:Im.current!==null?(l=YM(l,d,p),Ra(l,h)||(Fi=!0),l):(xh&42)===0?(Fi=!0,l.memoizedState=d):(l=x8(),zt.lanes|=l,Oh|=l,h)}function C6(l,h,d,p,S){var C=le.p;le.p=C!==0&&8>C?C:8;var N=ae.T,j={};ae.T=j,qM(l,!1,h,d);try{var ue=S(),Oe=ae.S;if(Oe!==null&&Oe(j,ue),ue!==null&&typeof ue=="object"&&typeof ue.then=="function"){var Le=Cse(ue,p);Vv(l,h,Le,ka(l))}else Vv(l,h,p,ka(l))}catch(We){Vv(l,h,{then:function(){},status:"rejected",reason:We},ka())}finally{le.p=C,ae.T=N}}function Tse(){}function zM(l,h,d,p){if(l.tag!==5)throw Error(n(476));var S=x6(l).queue;C6(l,S,h,Te,d===null?Tse:function(){return E6(l),d(p)})}function x6(l){var h=l.memoizedState;if(h!==null)return h;h={memoizedState:Te,baseState:Te,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:sc,lastRenderedState:Te},next:null};var d={};return h.next={memoizedState:d,baseState:d,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:sc,lastRenderedState:d},next:null},l.memoizedState=h,l=l.alternate,l!==null&&(l.memoizedState=h),h}function E6(l){var h=x6(l).next.queue;Vv(l,h,{},ka())}function GM(){return os(iw)}function _6(){return gi().memoizedState}function R6(){return gi().memoizedState}function Mse(l){for(var h=l.return;h!==null;){switch(h.tag){case 24:case 3:var d=ka();l=bh(d);var p=Ch(h,l,d);p!==null&&(Da(p,h,d),Iv(p,h,d)),h={cache:xM()},l.payload=h;return}h=h.return}}function Ase(l,h,d){var p=ka();d={lane:p,revertLane:0,action:d,hasEagerState:!1,eagerState:null,next:null},Eb(l)?M6(h,d):(d=dM(l,h,d,p),d!==null&&(Da(d,l,p),A6(d,h,p)))}function T6(l,h,d){var p=ka();Vv(l,h,d,p)}function Vv(l,h,d,p){var S={lane:p,revertLane:0,action:d,hasEagerState:!1,eagerState:null,next:null};if(Eb(l))M6(h,S);else{var C=l.alternate;if(l.lanes===0&&(C===null||C.lanes===0)&&(C=h.lastRenderedReducer,C!==null))try{var N=h.lastRenderedState,j=C(N,d);if(S.hasEagerState=!0,S.eagerState=j,Ra(j,N))return ob(l,h,S,0),on===null&&ab(),!1}catch{}finally{}if(d=dM(l,h,S,p),d!==null)return Da(d,l,p),A6(d,h,p),!0}return!1}function qM(l,h,d,p){if(p={lane:2,revertLane:RA(),action:p,hasEagerState:!1,eagerState:null,next:null},Eb(l)){if(h)throw Error(n(479))}else h=dM(l,d,p,2),h!==null&&Da(h,l,2)}function Eb(l){var h=l.alternate;return l===zt||h!==null&&h===zt}function M6(l,h){Nm=wb=!0;var d=l.pending;d===null?h.next=h:(h.next=d.next,d.next=h),l.pending=h}function A6(l,h,d){if((d&4194048)!==0){var p=h.lanes;p&=l.pendingLanes,d|=p,h.lanes=d,Cn(l,d)}}var _b={readContext:os,use:Sb,useCallback:Qn,useContext:Qn,useEffect:Qn,useImperativeHandle:Qn,useLayoutEffect:Qn,useInsertionEffect:Qn,useMemo:Qn,useReducer:Qn,useRef:Qn,useState:Qn,useDebugValue:Qn,useDeferredValue:Qn,useTransition:Qn,useSyncExternalStore:Qn,useId:Qn,useHostTransitionStatus:Qn,useFormState:Qn,useActionState:Qn,useOptimistic:Qn,useMemoCache:Qn,useCacheRefresh:Qn},O6={readContext:os,use:Sb,useCallback:function(l,h){return Zs().memoizedState=[l,h===void 0?null:h],l},useContext:os,useEffect:d6,useImperativeHandle:function(l,h,d){d=d!=null?d.concat([l]):null,xb(4194308,4,v6.bind(null,h,l),d)},useLayoutEffect:function(l,h){return xb(4194308,4,l,h)},useInsertionEffect:function(l,h){xb(4,2,l,h)},useMemo:function(l,h){var d=Zs();h=h===void 0?null:h;var p=l();if(yd){nt(!0);try{l()}finally{nt(!1)}}return d.memoizedState=[p,h],p},useReducer:function(l,h,d){var p=Zs();if(d!==void 0){var S=d(h);if(yd){nt(!0);try{d(h)}finally{nt(!1)}}}else S=h;return p.memoizedState=p.baseState=S,l={pending:null,lanes:0,dispatch:null,lastRenderedReducer:l,lastRenderedState:S},p.queue=l,l=l.dispatch=Ase.bind(null,zt,l),[p.memoizedState,l]},useRef:function(l){var h=Zs();return l={current:l},h.memoizedState=l},useState:function(l){l=$M(l);var h=l.queue,d=T6.bind(null,zt,h);return h.dispatch=d,[l.memoizedState,d]},useDebugValue:jM,useDeferredValue:function(l,h){var d=Zs();return YM(d,l,h)},useTransition:function(){var l=$M(!1);return l=C6.bind(null,zt,l.queue,!0,!1),Zs().memoizedState=l,[!1,l]},useSyncExternalStore:function(l,h,d){var p=zt,S=Zs();if(Tr){if(d===void 0)throw Error(n(407));d=d()}else{if(d=h(),on===null)throw Error(n(349));(hr&124)!==0||QV(p,h,d)}S.memoizedState=d;var C={value:d,getSnapshot:h};return S.queue=C,d6(JV.bind(null,p,C,l),[l]),p.flags|=2048,Fm(9,Cb(),ZV.bind(null,p,C,d,h),null),d},useId:function(){var l=Zs(),h=on.identifierPrefix;if(Tr){var d=rc,p=tc;d=(p&~(1<<32-pt(p)-1)).toString(32)+d,h="«"+h+"R"+d,d=yb++,0<d&&(h+="H"+d.toString(32)),h+="»"}else d=xse++,h="«"+h+"r"+d.toString(32)+"»";return l.memoizedState=h},useHostTransitionStatus:GM,useFormState:l6,useActionState:l6,useOptimistic:function(l){var h=Zs();h.memoizedState=h.baseState=l;var d={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return h.queue=d,h=qM.bind(null,zt,!0,d),d.dispatch=h,[l,h]},useMemoCache:BM,useCacheRefresh:function(){return Zs().memoizedState=Mse.bind(null,zt)}},k6={readContext:os,use:Sb,useCallback:y6,useContext:os,useEffect:g6,useImperativeHandle:w6,useInsertionEffect:m6,useLayoutEffect:p6,useMemo:S6,useReducer:bb,useRef:f6,useState:function(){return bb(sc)},useDebugValue:jM,useDeferredValue:function(l,h){var d=gi();return b6(d,Kr.memoizedState,l,h)},useTransition:function(){var l=bb(sc)[0],h=gi().memoizedState;return[typeof l=="boolean"?l:Lv(l),h]},useSyncExternalStore:XV,useId:_6,useHostTransitionStatus:GM,useFormState:u6,useActionState:u6,useOptimistic:function(l,h){var d=gi();return r6(d,Kr,l,h)},useMemoCache:BM,useCacheRefresh:R6},Ose={readContext:os,use:Sb,useCallback:y6,useContext:os,useEffect:g6,useImperativeHandle:w6,useInsertionEffect:m6,useLayoutEffect:p6,useMemo:S6,useReducer:WM,useRef:f6,useState:function(){return WM(sc)},useDebugValue:jM,useDeferredValue:function(l,h){var d=gi();return Kr===null?YM(d,l,h):b6(d,Kr.memoizedState,l,h)},useTransition:function(){var l=WM(sc)[0],h=gi().memoizedState;return[typeof l=="boolean"?l:Lv(l),h]},useSyncExternalStore:XV,useId:_6,useHostTransitionStatus:GM,useFormState:h6,useActionState:h6,useOptimistic:function(l,h){var d=gi();return Kr!==null?r6(d,Kr,l,h):(d.baseState=l,[l,d.queue.dispatch])},useMemoCache:BM,useCacheRefresh:R6},Lm=null,Wv=0;function Rb(l){var h=Wv;return Wv+=1,Lm===null&&(Lm=[]),$V(Lm,l,h)}function $v(l,h){h=h.props.ref,l.ref=h!==void 0?h:null}function Tb(l,h){throw h.$$typeof===g?Error(n(525)):(l=Object.prototype.toString.call(h),Error(n(31,l==="[object Object]"?"object with keys {"+Object.keys(h).join(", ")+"}":l)))}function D6(l){var h=l._init;return h(l._payload)}function P6(l){function h(Ee,ye){if(l){var Me=Ee.deletions;Me===null?(Ee.deletions=[ye],Ee.flags|=16):Me.push(ye)}}function d(Ee,ye){if(!l)return null;for(;ye!==null;)h(Ee,ye),ye=ye.sibling;return null}function p(Ee){for(var ye=new Map;Ee!==null;)Ee.key!==null?ye.set(Ee.key,Ee):ye.set(Ee.index,Ee),Ee=Ee.sibling;return ye}function S(Ee,ye){return Ee=ec(Ee,ye),Ee.index=0,Ee.sibling=null,Ee}function C(Ee,ye,Me){return Ee.index=Me,l?(Me=Ee.alternate,Me!==null?(Me=Me.index,Me<ye?(Ee.flags|=67108866,ye):Me):(Ee.flags|=67108866,ye)):(Ee.flags|=1048576,ye)}function N(Ee){return l&&Ee.alternate===null&&(Ee.flags|=67108866),Ee}function j(Ee,ye,Me,Be){return ye===null||ye.tag!==6?(ye=mM(Me,Ee.mode,Be),ye.return=Ee,ye):(ye=S(ye,Me),ye.return=Ee,ye)}function ue(Ee,ye,Me,Be){var lt=Me.type;return lt===w?Le(Ee,ye,Me.props.children,Be,Me.key):ye!==null&&(ye.elementType===lt||typeof lt=="object"&&lt!==null&&lt.$$typeof===W&&D6(lt)===ye.type)?(ye=S(ye,Me.props),$v(ye,Me),ye.return=Ee,ye):(ye=ub(Me.type,Me.key,Me.props,null,Ee.mode,Be),$v(ye,Me),ye.return=Ee,ye)}function Oe(Ee,ye,Me,Be){return ye===null||ye.tag!==4||ye.stateNode.containerInfo!==Me.containerInfo||ye.stateNode.implementation!==Me.implementation?(ye=pM(Me,Ee.mode,Be),ye.return=Ee,ye):(ye=S(ye,Me.children||[]),ye.return=Ee,ye)}function Le(Ee,ye,Me,Be,lt){return ye===null||ye.tag!==7?(ye=hd(Me,Ee.mode,Be,lt),ye.return=Ee,ye):(ye=S(ye,Me),ye.return=Ee,ye)}function We(Ee,ye,Me){if(typeof ye=="string"&&ye!==""||typeof ye=="number"||typeof ye=="bigint")return ye=mM(""+ye,Ee.mode,Me),ye.return=Ee,ye;if(typeof ye=="object"&&ye!==null){switch(ye.$$typeof){case m:return Me=ub(ye.type,ye.key,ye.props,null,Ee.mode,Me),$v(Me,ye),Me.return=Ee,Me;case v:return ye=pM(ye,Ee.mode,Me),ye.return=Ee,ye;case W:var Be=ye._init;return ye=Be(ye._payload),We(Ee,ye,Me)}if(we(ye)||G(ye))return ye=hd(ye,Ee.mode,Me,null),ye.return=Ee,ye;if(typeof ye.then=="function")return We(Ee,Rb(ye),Me);if(ye.$$typeof===T)return We(Ee,db(Ee,ye),Me);Tb(Ee,ye)}return null}function ke(Ee,ye,Me,Be){var lt=ye!==null?ye.key:null;if(typeof Me=="string"&&Me!==""||typeof Me=="number"||typeof Me=="bigint")return lt!==null?null:j(Ee,ye,""+Me,Be);if(typeof Me=="object"&&Me!==null){switch(Me.$$typeof){case m:return Me.key===lt?ue(Ee,ye,Me,Be):null;case v:return Me.key===lt?Oe(Ee,ye,Me,Be):null;case W:return lt=Me._init,Me=lt(Me._payload),ke(Ee,ye,Me,Be)}if(we(Me)||G(Me))return lt!==null?null:Le(Ee,ye,Me,Be,null);if(typeof Me.then=="function")return ke(Ee,ye,Rb(Me),Be);if(Me.$$typeof===T)return ke(Ee,ye,db(Ee,Me),Be);Tb(Ee,Me)}return null}function De(Ee,ye,Me,Be,lt){if(typeof Be=="string"&&Be!==""||typeof Be=="number"||typeof Be=="bigint")return Ee=Ee.get(Me)||null,j(ye,Ee,""+Be,lt);if(typeof Be=="object"&&Be!==null){switch(Be.$$typeof){case m:return Ee=Ee.get(Be.key===null?Me:Be.key)||null,ue(ye,Ee,Be,lt);case v:return Ee=Ee.get(Be.key===null?Me:Be.key)||null,Oe(ye,Ee,Be,lt);case W:var Qt=Be._init;return Be=Qt(Be._payload),De(Ee,ye,Me,Be,lt)}if(we(Be)||G(Be))return Ee=Ee.get(Me)||null,Le(ye,Ee,Be,lt,null);if(typeof Be.then=="function")return De(Ee,ye,Me,Rb(Be),lt);if(Be.$$typeof===T)return De(Ee,ye,Me,db(ye,Be),lt);Tb(ye,Be)}return null}function At(Ee,ye,Me,Be){for(var lt=null,Qt=null,mt=ye,Rt=ye=0,Bi=null;mt!==null&&Rt<Me.length;Rt++){mt.index>Rt?(Bi=mt,mt=null):Bi=mt.sibling;var xr=ke(Ee,mt,Me[Rt],Be);if(xr===null){mt===null&&(mt=Bi);break}l&&mt&&xr.alternate===null&&h(Ee,mt),ye=C(xr,ye,Rt),Qt===null?lt=xr:Qt.sibling=xr,Qt=xr,mt=Bi}if(Rt===Me.length)return d(Ee,mt),Tr&&dd(Ee,Rt),lt;if(mt===null){for(;Rt<Me.length;Rt++)mt=We(Ee,Me[Rt],Be),mt!==null&&(ye=C(mt,ye,Rt),Qt===null?lt=mt:Qt.sibling=mt,Qt=mt);return Tr&&dd(Ee,Rt),lt}for(mt=p(mt);Rt<Me.length;Rt++)Bi=De(mt,Ee,Rt,Me[Rt],Be),Bi!==null&&(l&&Bi.alternate!==null&&mt.delete(Bi.key===null?Rt:Bi.key),ye=C(Bi,ye,Rt),Qt===null?lt=Bi:Qt.sibling=Bi,Qt=Bi);return l&&mt.forEach(function(Bh){return h(Ee,Bh)}),Tr&&dd(Ee,Rt),lt}function _t(Ee,ye,Me,Be){if(Me==null)throw Error(n(151));for(var lt=null,Qt=null,mt=ye,Rt=ye=0,Bi=null,xr=Me.next();mt!==null&&!xr.done;Rt++,xr=Me.next()){mt.index>Rt?(Bi=mt,mt=null):Bi=mt.sibling;var Bh=ke(Ee,mt,xr.value,Be);if(Bh===null){mt===null&&(mt=Bi);break}l&&mt&&Bh.alternate===null&&h(Ee,mt),ye=C(Bh,ye,Rt),Qt===null?lt=Bh:Qt.sibling=Bh,Qt=Bh,mt=Bi}if(xr.done)return d(Ee,mt),Tr&&dd(Ee,Rt),lt;if(mt===null){for(;!xr.done;Rt++,xr=Me.next())xr=We(Ee,xr.value,Be),xr!==null&&(ye=C(xr,ye,Rt),Qt===null?lt=xr:Qt.sibling=xr,Qt=xr);return Tr&&dd(Ee,Rt),lt}for(mt=p(mt);!xr.done;Rt++,xr=Me.next())xr=De(mt,Ee,Rt,xr.value,Be),xr!==null&&(l&&xr.alternate!==null&&mt.delete(xr.key===null?Rt:xr.key),ye=C(xr,ye,Rt),Qt===null?lt=xr:Qt.sibling=xr,Qt=xr);return l&&mt.forEach(function(kae){return h(Ee,kae)}),Tr&&dd(Ee,Rt),lt}function Qr(Ee,ye,Me,Be){if(typeof Me=="object"&&Me!==null&&Me.type===w&&Me.key===null&&(Me=Me.props.children),typeof Me=="object"&&Me!==null){switch(Me.$$typeof){case m:e:{for(var lt=Me.key;ye!==null;){if(ye.key===lt){if(lt=Me.type,lt===w){if(ye.tag===7){d(Ee,ye.sibling),Be=S(ye,Me.props.children),Be.return=Ee,Ee=Be;break e}}else if(ye.elementType===lt||typeof lt=="object"&&lt!==null&&lt.$$typeof===W&&D6(lt)===ye.type){d(Ee,ye.sibling),Be=S(ye,Me.props),$v(Be,Me),Be.return=Ee,Ee=Be;break e}d(Ee,ye);break}else h(Ee,ye);ye=ye.sibling}Me.type===w?(Be=hd(Me.props.children,Ee.mode,Be,Me.key),Be.return=Ee,Ee=Be):(Be=ub(Me.type,Me.key,Me.props,null,Ee.mode,Be),$v(Be,Me),Be.return=Ee,Ee=Be)}return N(Ee);case v:e:{for(lt=Me.key;ye!==null;){if(ye.key===lt)if(ye.tag===4&&ye.stateNode.containerInfo===Me.containerInfo&&ye.stateNode.implementation===Me.implementation){d(Ee,ye.sibling),Be=S(ye,Me.children||[]),Be.return=Ee,Ee=Be;break e}else{d(Ee,ye);break}else h(Ee,ye);ye=ye.sibling}Be=pM(Me,Ee.mode,Be),Be.return=Ee,Ee=Be}return N(Ee);case W:return lt=Me._init,Me=lt(Me._payload),Qr(Ee,ye,Me,Be)}if(we(Me))return At(Ee,ye,Me,Be);if(G(Me)){if(lt=G(Me),typeof lt!="function")throw Error(n(150));return Me=lt.call(Me),_t(Ee,ye,Me,Be)}if(typeof Me.then=="function")return Qr(Ee,ye,Rb(Me),Be);if(Me.$$typeof===T)return Qr(Ee,ye,db(Ee,Me),Be);Tb(Ee,Me)}return typeof Me=="string"&&Me!==""||typeof Me=="number"||typeof Me=="bigint"?(Me=""+Me,ye!==null&&ye.tag===6?(d(Ee,ye.sibling),Be=S(ye,Me),Be.return=Ee,Ee=Be):(d(Ee,ye),Be=mM(Me,Ee.mode,Be),Be.return=Ee,Ee=Be),N(Ee)):d(Ee,ye)}return function(Ee,ye,Me,Be){try{Wv=0;var lt=Qr(Ee,ye,Me,Be);return Lm=null,lt}catch(mt){if(mt===Dv||mt===mb)throw mt;var Qt=Ta(29,mt,null,Ee.mode);return Qt.lanes=Be,Qt.return=Ee,Qt}finally{}}}var Bm=P6(!0),I6=P6(!1),uo=Se(null),Wl=null;function Eh(l){var h=l.alternate;E(Ai,Ai.current&1),E(uo,l),Wl===null&&(h===null||Im.current!==null||h.memoizedState!==null)&&(Wl=l)}function N6(l){if(l.tag===22){if(E(Ai,Ai.current),E(uo,l),Wl===null){var h=l.alternate;h!==null&&h.memoizedState!==null&&(Wl=l)}}else _h()}function _h(){E(Ai,Ai.current),E(uo,uo.current)}function ac(l){B(uo),Wl===l&&(Wl=null),B(Ai)}var Ai=Se(0);function Mb(l){for(var h=l;h!==null;){if(h.tag===13){var d=h.memoizedState;if(d!==null&&(d=d.dehydrated,d===null||d.data==="$?"||LA(d)))return h}else if(h.tag===19&&h.memoizedProps.revealOrder!==void 0){if((h.flags&128)!==0)return h}else if(h.child!==null){h.child.return=h,h=h.child;continue}if(h===l)break;for(;h.sibling===null;){if(h.return===null||h.return===l)return null;h=h.return}h.sibling.return=h.return,h=h.sibling}return null}function KM(l,h,d,p){h=l.memoizedState,d=d(p,h),d=d==null?h:f({},h,d),l.memoizedState=d,l.lanes===0&&(l.updateQueue.baseState=d)}var XM={enqueueSetState:function(l,h,d){l=l._reactInternals;var p=ka(),S=bh(p);S.payload=h,d!=null&&(S.callback=d),h=Ch(l,S,p),h!==null&&(Da(h,l,p),Iv(h,l,p))},enqueueReplaceState:function(l,h,d){l=l._reactInternals;var p=ka(),S=bh(p);S.tag=1,S.payload=h,d!=null&&(S.callback=d),h=Ch(l,S,p),h!==null&&(Da(h,l,p),Iv(h,l,p))},enqueueForceUpdate:function(l,h){l=l._reactInternals;var d=ka(),p=bh(d);p.tag=2,h!=null&&(p.callback=h),h=Ch(l,p,d),h!==null&&(Da(h,l,d),Iv(h,l,d))}};function H6(l,h,d,p,S,C,N){return l=l.stateNode,typeof l.shouldComponentUpdate=="function"?l.shouldComponentUpdate(p,C,N):h.prototype&&h.prototype.isPureReactComponent?!Ev(d,p)||!Ev(S,C):!0}function F6(l,h,d,p){l=h.state,typeof h.componentWillReceiveProps=="function"&&h.componentWillReceiveProps(d,p),typeof h.UNSAFE_componentWillReceiveProps=="function"&&h.UNSAFE_componentWillReceiveProps(d,p),h.state!==l&&XM.enqueueReplaceState(h,h.state,null)}function Sd(l,h){var d=h;if("ref"in h){d={};for(var p in h)p!=="ref"&&(d[p]=h[p])}if(l=l.defaultProps){d===h&&(d=f({},d));for(var S in l)d[S]===void 0&&(d[S]=l[S])}return d}var Ab=typeof reportError=="function"?reportError:function(l){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var h=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof l=="object"&&l!==null&&typeof l.message=="string"?String(l.message):String(l),error:l});if(!window.dispatchEvent(h))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",l);return}console.error(l)};function L6(l){Ab(l)}function B6(l){console.error(l)}function V6(l){Ab(l)}function Ob(l,h){try{var d=l.onUncaughtError;d(h.value,{componentStack:h.stack})}catch(p){setTimeout(function(){throw p})}}function W6(l,h,d){try{var p=l.onCaughtError;p(d.value,{componentStack:d.stack,errorBoundary:h.tag===1?h.stateNode:null})}catch(S){setTimeout(function(){throw S})}}function QM(l,h,d){return d=bh(d),d.tag=3,d.payload={element:null},d.callback=function(){Ob(l,h)},d}function $6(l){return l=bh(l),l.tag=3,l}function U6(l,h,d,p){var S=d.type.getDerivedStateFromError;if(typeof S=="function"){var C=p.value;l.payload=function(){return S(C)},l.callback=function(){W6(h,d,p)}}var N=d.stateNode;N!==null&&typeof N.componentDidCatch=="function"&&(l.callback=function(){W6(h,d,p),typeof S!="function"&&(kh===null?kh=new Set([this]):kh.add(this));var j=p.stack;this.componentDidCatch(p.value,{componentStack:j!==null?j:""})})}function kse(l,h,d,p,S){if(d.flags|=32768,p!==null&&typeof p=="object"&&typeof p.then=="function"){if(h=d.alternate,h!==null&&Av(h,d,S,!0),d=uo.current,d!==null){switch(d.tag){case 13:return Wl===null?bA():d.alternate===null&&Fn===0&&(Fn=3),d.flags&=-257,d.flags|=65536,d.lanes=S,p===RM?d.flags|=16384:(h=d.updateQueue,h===null?d.updateQueue=new Set([p]):h.add(p),xA(l,p,S)),!1;case 22:return d.flags|=65536,p===RM?d.flags|=16384:(h=d.updateQueue,h===null?(h={transitions:null,markerInstances:null,retryQueue:new Set([p])},d.updateQueue=h):(d=h.retryQueue,d===null?h.retryQueue=new Set([p]):d.add(p)),xA(l,p,S)),!1}throw Error(n(435,d.tag))}return xA(l,p,S),bA(),!1}if(Tr)return h=uo.current,h!==null?((h.flags&65536)===0&&(h.flags|=256),h.flags|=65536,h.lanes=S,p!==yM&&(l=Error(n(422),{cause:p}),Mv(so(l,d)))):(p!==yM&&(h=Error(n(423),{cause:p}),Mv(so(h,d))),l=l.current.alternate,l.flags|=65536,S&=-S,l.lanes|=S,p=so(p,d),S=QM(l.stateNode,p,S),AM(l,S),Fn!==4&&(Fn=2)),!1;var C=Error(n(520),{cause:p});if(C=so(C,d),Kv===null?Kv=[C]:Kv.push(C),Fn!==4&&(Fn=2),h===null)return!0;p=so(p,d),d=h;do{switch(d.tag){case 3:return d.flags|=65536,l=S&-S,d.lanes|=l,l=QM(d.stateNode,p,l),AM(d,l),!1;case 1:if(h=d.type,C=d.stateNode,(d.flags&128)===0&&(typeof h.getDerivedStateFromError=="function"||C!==null&&typeof C.componentDidCatch=="function"&&(kh===null||!kh.has(C))))return d.flags|=65536,S&=-S,d.lanes|=S,S=$6(S),U6(S,l,d,p),AM(d,S),!1}d=d.return}while(d!==null);return!1}var j6=Error(n(461)),Fi=!1;function Ki(l,h,d,p){h.child=l===null?I6(h,null,d,p):Bm(h,l.child,d,p)}function Y6(l,h,d,p,S){d=d.render;var C=h.ref;if("ref"in p){var N={};for(var j in p)j!=="ref"&&(N[j]=p[j])}else N=p;return vd(h),p=IM(l,h,d,N,C,S),j=NM(),l!==null&&!Fi?(HM(l,h,S),oc(l,h,S)):(Tr&&j&&vM(h),h.flags|=1,Ki(l,h,p,S),h.child)}function z6(l,h,d,p,S){if(l===null){var C=d.type;return typeof C=="function"&&!gM(C)&&C.defaultProps===void 0&&d.compare===null?(h.tag=15,h.type=C,G6(l,h,C,p,S)):(l=ub(d.type,null,p,h,h.mode,S),l.ref=h.ref,l.return=h,h.child=l)}if(C=l.child,!sA(l,S)){var N=C.memoizedProps;if(d=d.compare,d=d!==null?d:Ev,d(N,p)&&l.ref===h.ref)return oc(l,h,S)}return h.flags|=1,l=ec(C,p),l.ref=h.ref,l.return=h,h.child=l}function G6(l,h,d,p,S){if(l!==null){var C=l.memoizedProps;if(Ev(C,p)&&l.ref===h.ref)if(Fi=!1,h.pendingProps=p=C,sA(l,S))(l.flags&131072)!==0&&(Fi=!0);else return h.lanes=l.lanes,oc(l,h,S)}return ZM(l,h,d,p,S)}function q6(l,h,d){var p=h.pendingProps,S=p.children,C=l!==null?l.memoizedState:null;if(p.mode==="hidden"){if((h.flags&128)!==0){if(p=C!==null?C.baseLanes|d:d,l!==null){for(S=h.child=l.child,C=0;S!==null;)C=C|S.lanes|S.childLanes,S=S.sibling;h.childLanes=C&~p}else h.childLanes=0,h.child=null;return K6(l,h,p,d)}if((d&536870912)!==0)h.memoizedState={baseLanes:0,cachePool:null},l!==null&&gb(h,C!==null?C.cachePool:null),C!==null?GV(h,C):kM(),N6(h);else return h.lanes=h.childLanes=536870912,K6(l,h,C!==null?C.baseLanes|d:d,d)}else C!==null?(gb(h,C.cachePool),GV(h,C),_h(),h.memoizedState=null):(l!==null&&gb(h,null),kM(),_h());return Ki(l,h,S,d),h.child}function K6(l,h,d,p){var S=_M();return S=S===null?null:{parent:Mi._currentValue,pool:S},h.memoizedState={baseLanes:d,cachePool:S},l!==null&&gb(h,null),kM(),N6(h),l!==null&&Av(l,h,p,!0),null}function kb(l,h){var d=h.ref;if(d===null)l!==null&&l.ref!==null&&(h.flags|=4194816);else{if(typeof d!="function"&&typeof d!="object")throw Error(n(284));(l===null||l.ref!==d)&&(h.flags|=4194816)}}function ZM(l,h,d,p,S){return vd(h),d=IM(l,h,d,p,void 0,S),p=NM(),l!==null&&!Fi?(HM(l,h,S),oc(l,h,S)):(Tr&&p&&vM(h),h.flags|=1,Ki(l,h,d,S),h.child)}function X6(l,h,d,p,S,C){return vd(h),h.updateQueue=null,d=KV(h,p,d,S),qV(l),p=NM(),l!==null&&!Fi?(HM(l,h,C),oc(l,h,C)):(Tr&&p&&vM(h),h.flags|=1,Ki(l,h,d,C),h.child)}function Q6(l,h,d,p,S){if(vd(h),h.stateNode===null){var C=Am,N=d.contextType;typeof N=="object"&&N!==null&&(C=os(N)),C=new d(p,C),h.memoizedState=C.state!==null&&C.state!==void 0?C.state:null,C.updater=XM,h.stateNode=C,C._reactInternals=h,C=h.stateNode,C.props=p,C.state=h.memoizedState,C.refs={},TM(h),N=d.contextType,C.context=typeof N=="object"&&N!==null?os(N):Am,C.state=h.memoizedState,N=d.getDerivedStateFromProps,typeof N=="function"&&(KM(h,d,N,p),C.state=h.memoizedState),typeof d.getDerivedStateFromProps=="function"||typeof C.getSnapshotBeforeUpdate=="function"||typeof C.UNSAFE_componentWillMount!="function"&&typeof C.componentWillMount!="function"||(N=C.state,typeof C.componentWillMount=="function"&&C.componentWillMount(),typeof C.UNSAFE_componentWillMount=="function"&&C.UNSAFE_componentWillMount(),N!==C.state&&XM.enqueueReplaceState(C,C.state,null),Hv(h,p,C,S),Nv(),C.state=h.memoizedState),typeof C.componentDidMount=="function"&&(h.flags|=4194308),p=!0}else if(l===null){C=h.stateNode;var j=h.memoizedProps,ue=Sd(d,j);C.props=ue;var Oe=C.context,Le=d.contextType;N=Am,typeof Le=="object"&&Le!==null&&(N=os(Le));var We=d.getDerivedStateFromProps;Le=typeof We=="function"||typeof C.getSnapshotBeforeUpdate=="function",j=h.pendingProps!==j,Le||typeof C.UNSAFE_componentWillReceiveProps!="function"&&typeof C.componentWillReceiveProps!="function"||(j||Oe!==N)&&F6(h,C,p,N),Sh=!1;var ke=h.memoizedState;C.state=ke,Hv(h,p,C,S),Nv(),Oe=h.memoizedState,j||ke!==Oe||Sh?(typeof We=="function"&&(KM(h,d,We,p),Oe=h.memoizedState),(ue=Sh||H6(h,d,ue,p,ke,Oe,N))?(Le||typeof C.UNSAFE_componentWillMount!="function"&&typeof C.componentWillMount!="function"||(typeof C.componentWillMount=="function"&&C.componentWillMount(),typeof C.UNSAFE_componentWillMount=="function"&&C.UNSAFE_componentWillMount()),typeof C.componentDidMount=="function"&&(h.flags|=4194308)):(typeof C.componentDidMount=="function"&&(h.flags|=4194308),h.memoizedProps=p,h.memoizedState=Oe),C.props=p,C.state=Oe,C.context=N,p=ue):(typeof C.componentDidMount=="function"&&(h.flags|=4194308),p=!1)}else{C=h.stateNode,MM(l,h),N=h.memoizedProps,Le=Sd(d,N),C.props=Le,We=h.pendingProps,ke=C.context,Oe=d.contextType,ue=Am,typeof Oe=="object"&&Oe!==null&&(ue=os(Oe)),j=d.getDerivedStateFromProps,(Oe=typeof j=="function"||typeof C.getSnapshotBeforeUpdate=="function")||typeof C.UNSAFE_componentWillReceiveProps!="function"&&typeof C.componentWillReceiveProps!="function"||(N!==We||ke!==ue)&&F6(h,C,p,ue),Sh=!1,ke=h.memoizedState,C.state=ke,Hv(h,p,C,S),Nv();var De=h.memoizedState;N!==We||ke!==De||Sh||l!==null&&l.dependencies!==null&&fb(l.dependencies)?(typeof j=="function"&&(KM(h,d,j,p),De=h.memoizedState),(Le=Sh||H6(h,d,Le,p,ke,De,ue)||l!==null&&l.dependencies!==null&&fb(l.dependencies))?(Oe||typeof C.UNSAFE_componentWillUpdate!="function"&&typeof C.componentWillUpdate!="function"||(typeof C.componentWillUpdate=="function"&&C.componentWillUpdate(p,De,ue),typeof C.UNSAFE_componentWillUpdate=="function"&&C.UNSAFE_componentWillUpdate(p,De,ue)),typeof C.componentDidUpdate=="function"&&(h.flags|=4),typeof C.getSnapshotBeforeUpdate=="function"&&(h.flags|=1024)):(typeof C.componentDidUpdate!="function"||N===l.memoizedProps&&ke===l.memoizedState||(h.flags|=4),typeof C.getSnapshotBeforeUpdate!="function"||N===l.memoizedProps&&ke===l.memoizedState||(h.flags|=1024),h.memoizedProps=p,h.memoizedState=De),C.props=p,C.state=De,C.context=ue,p=Le):(typeof C.componentDidUpdate!="function"||N===l.memoizedProps&&ke===l.memoizedState||(h.flags|=4),typeof C.getSnapshotBeforeUpdate!="function"||N===l.memoizedProps&&ke===l.memoizedState||(h.flags|=1024),p=!1)}return C=p,kb(l,h),p=(h.flags&128)!==0,C||p?(C=h.stateNode,d=p&&typeof d.getDerivedStateFromError!="function"?null:C.render(),h.flags|=1,l!==null&&p?(h.child=Bm(h,l.child,null,S),h.child=Bm(h,null,d,S)):Ki(l,h,d,S),h.memoizedState=C.state,l=h.child):l=oc(l,h,S),l}function Z6(l,h,d,p){return Tv(),h.flags|=256,Ki(l,h,d,p),h.child}var JM={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function eA(l){return{baseLanes:l,cachePool:BV()}}function tA(l,h,d){return l=l!==null?l.childLanes&~d:0,h&&(l|=co),l}function J6(l,h,d){var p=h.pendingProps,S=!1,C=(h.flags&128)!==0,N;if((N=C)||(N=l!==null&&l.memoizedState===null?!1:(Ai.current&2)!==0),N&&(S=!0,h.flags&=-129),N=(h.flags&32)!==0,h.flags&=-33,l===null){if(Tr){if(S?Eh(h):_h(),Tr){var j=Hn,ue;if(ue=j){e:{for(ue=j,j=Vl;ue.nodeType!==8;){if(!j){j=null;break e}if(ue=al(ue.nextSibling),ue===null){j=null;break e}}j=ue}j!==null?(h.memoizedState={dehydrated:j,treeContext:fd!==null?{id:tc,overflow:rc}:null,retryLane:536870912,hydrationErrors:null},ue=Ta(18,null,null,0),ue.stateNode=j,ue.return=h,h.child=ue,Ps=h,Hn=null,ue=!0):ue=!1}ue||md(h)}if(j=h.memoizedState,j!==null&&(j=j.dehydrated,j!==null))return LA(j)?h.lanes=32:h.lanes=536870912,null;ac(h)}return j=p.children,p=p.fallback,S?(_h(),S=h.mode,j=Db({mode:"hidden",children:j},S),p=hd(p,S,d,null),j.return=h,p.return=h,j.sibling=p,h.child=j,S=h.child,S.memoizedState=eA(d),S.childLanes=tA(l,N,d),h.memoizedState=JM,p):(Eh(h),rA(h,j))}if(ue=l.memoizedState,ue!==null&&(j=ue.dehydrated,j!==null)){if(C)h.flags&256?(Eh(h),h.flags&=-257,h=nA(l,h,d)):h.memoizedState!==null?(_h(),h.child=l.child,h.flags|=128,h=null):(_h(),S=p.fallback,j=h.mode,p=Db({mode:"visible",children:p.children},j),S=hd(S,j,d,null),S.flags|=2,p.return=h,S.return=h,p.sibling=S,h.child=p,Bm(h,l.child,null,d),p=h.child,p.memoizedState=eA(d),p.childLanes=tA(l,N,d),h.memoizedState=JM,h=S);else if(Eh(h),LA(j)){if(N=j.nextSibling&&j.nextSibling.dataset,N)var Oe=N.dgst;N=Oe,p=Error(n(419)),p.stack="",p.digest=N,Mv({value:p,source:null,stack:null}),h=nA(l,h,d)}else if(Fi||Av(l,h,d,!1),N=(d&l.childLanes)!==0,Fi||N){if(N=on,N!==null&&(p=d&-d,p=(p&42)!==0?1:to(p),p=(p&(N.suspendedLanes|d))!==0?0:p,p!==0&&p!==ue.retryLane))throw ue.retryLane=p,Mm(l,p),Da(N,l,p),j6;j.data==="$?"||bA(),h=nA(l,h,d)}else j.data==="$?"?(h.flags|=192,h.child=l.child,h=null):(l=ue.treeContext,Hn=al(j.nextSibling),Ps=h,Tr=!0,gd=null,Vl=!1,l!==null&&(oo[lo++]=tc,oo[lo++]=rc,oo[lo++]=fd,tc=l.id,rc=l.overflow,fd=h),h=rA(h,p.children),h.flags|=4096);return h}return S?(_h(),S=p.fallback,j=h.mode,ue=l.child,Oe=ue.sibling,p=ec(ue,{mode:"hidden",children:p.children}),p.subtreeFlags=ue.subtreeFlags&65011712,Oe!==null?S=ec(Oe,S):(S=hd(S,j,d,null),S.flags|=2),S.return=h,p.return=h,p.sibling=S,h.child=p,p=S,S=h.child,j=l.child.memoizedState,j===null?j=eA(d):(ue=j.cachePool,ue!==null?(Oe=Mi._currentValue,ue=ue.parent!==Oe?{parent:Oe,pool:Oe}:ue):ue=BV(),j={baseLanes:j.baseLanes|d,cachePool:ue}),S.memoizedState=j,S.childLanes=tA(l,N,d),h.memoizedState=JM,p):(Eh(h),d=l.child,l=d.sibling,d=ec(d,{mode:"visible",children:p.children}),d.return=h,d.sibling=null,l!==null&&(N=h.deletions,N===null?(h.deletions=[l],h.flags|=16):N.push(l)),h.child=d,h.memoizedState=null,d)}function rA(l,h){return h=Db({mode:"visible",children:h},l.mode),h.return=l,l.child=h}function Db(l,h){return l=Ta(22,l,null,h),l.lanes=0,l.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},l}function nA(l,h,d){return Bm(h,l.child,null,d),l=rA(h,h.pendingProps.children),l.flags|=2,h.memoizedState=null,l}function e8(l,h,d){l.lanes|=h;var p=l.alternate;p!==null&&(p.lanes|=h),bM(l.return,h,d)}function iA(l,h,d,p,S){var C=l.memoizedState;C===null?l.memoizedState={isBackwards:h,rendering:null,renderingStartTime:0,last:p,tail:d,tailMode:S}:(C.isBackwards=h,C.rendering=null,C.renderingStartTime=0,C.last=p,C.tail=d,C.tailMode=S)}function t8(l,h,d){var p=h.pendingProps,S=p.revealOrder,C=p.tail;if(Ki(l,h,p.children,d),p=Ai.current,(p&2)!==0)p=p&1|2,h.flags|=128;else{if(l!==null&&(l.flags&128)!==0)e:for(l=h.child;l!==null;){if(l.tag===13)l.memoizedState!==null&&e8(l,d,h);else if(l.tag===19)e8(l,d,h);else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===h)break e;for(;l.sibling===null;){if(l.return===null||l.return===h)break e;l=l.return}l.sibling.return=l.return,l=l.sibling}p&=1}switch(E(Ai,p),S){case"forwards":for(d=h.child,S=null;d!==null;)l=d.alternate,l!==null&&Mb(l)===null&&(S=d),d=d.sibling;d=S,d===null?(S=h.child,h.child=null):(S=d.sibling,d.sibling=null),iA(h,!1,S,d,C);break;case"backwards":for(d=null,S=h.child,h.child=null;S!==null;){if(l=S.alternate,l!==null&&Mb(l)===null){h.child=S;break}l=S.sibling,S.sibling=d,d=S,S=l}iA(h,!0,d,null,C);break;case"together":iA(h,!1,null,null,void 0);break;default:h.memoizedState=null}return h.child}function oc(l,h,d){if(l!==null&&(h.dependencies=l.dependencies),Oh|=h.lanes,(d&h.childLanes)===0)if(l!==null){if(Av(l,h,d,!1),(d&h.childLanes)===0)return null}else return null;if(l!==null&&h.child!==l.child)throw Error(n(153));if(h.child!==null){for(l=h.child,d=ec(l,l.pendingProps),h.child=d,d.return=h;l.sibling!==null;)l=l.sibling,d=d.sibling=ec(l,l.pendingProps),d.return=h;d.sibling=null}return h.child}function sA(l,h){return(l.lanes&h)!==0?!0:(l=l.dependencies,!!(l!==null&&fb(l)))}function Dse(l,h,d){switch(h.tag){case 3:te(h,h.stateNode.containerInfo),yh(h,Mi,l.memoizedState.cache),Tv();break;case 27:case 5:I(h);break;case 4:te(h,h.stateNode.containerInfo);break;case 10:yh(h,h.type,h.memoizedProps.value);break;case 13:var p=h.memoizedState;if(p!==null)return p.dehydrated!==null?(Eh(h),h.flags|=128,null):(d&h.child.childLanes)!==0?J6(l,h,d):(Eh(h),l=oc(l,h,d),l!==null?l.sibling:null);Eh(h);break;case 19:var S=(l.flags&128)!==0;if(p=(d&h.childLanes)!==0,p||(Av(l,h,d,!1),p=(d&h.childLanes)!==0),S){if(p)return t8(l,h,d);h.flags|=128}if(S=h.memoizedState,S!==null&&(S.rendering=null,S.tail=null,S.lastEffect=null),E(Ai,Ai.current),p)break;return null;case 22:case 23:return h.lanes=0,q6(l,h,d);case 24:yh(h,Mi,l.memoizedState.cache)}return oc(l,h,d)}function r8(l,h,d){if(l!==null)if(l.memoizedProps!==h.pendingProps)Fi=!0;else{if(!sA(l,d)&&(h.flags&128)===0)return Fi=!1,Dse(l,h,d);Fi=(l.flags&131072)!==0}else Fi=!1,Tr&&(h.flags&1048576)!==0&&DV(h,hb,h.index);switch(h.lanes=0,h.tag){case 16:e:{l=h.pendingProps;var p=h.elementType,S=p._init;if(p=S(p._payload),h.type=p,typeof p=="function")gM(p)?(l=Sd(p,l),h.tag=1,h=Q6(null,h,p,l,d)):(h.tag=0,h=ZM(null,h,p,l,d));else{if(p!=null){if(S=p.$$typeof,S===D){h.tag=11,h=Y6(null,h,p,l,d);break e}else if(S===A){h.tag=14,h=z6(null,h,p,l,d);break e}}throw h=be(p)||p,Error(n(306,h,""))}}return h;case 0:return ZM(l,h,h.type,h.pendingProps,d);case 1:return p=h.type,S=Sd(p,h.pendingProps),Q6(l,h,p,S,d);case 3:e:{if(te(h,h.stateNode.containerInfo),l===null)throw Error(n(387));p=h.pendingProps;var C=h.memoizedState;S=C.element,MM(l,h),Hv(h,p,null,d);var N=h.memoizedState;if(p=N.cache,yh(h,Mi,p),p!==C.cache&&CM(h,[Mi],d,!0),Nv(),p=N.element,C.isDehydrated)if(C={element:p,isDehydrated:!1,cache:N.cache},h.updateQueue.baseState=C,h.memoizedState=C,h.flags&256){h=Z6(l,h,p,d);break e}else if(p!==S){S=so(Error(n(424)),h),Mv(S),h=Z6(l,h,p,d);break e}else{switch(l=h.stateNode.containerInfo,l.nodeType){case 9:l=l.body;break;default:l=l.nodeName==="HTML"?l.ownerDocument.body:l}for(Hn=al(l.firstChild),Ps=h,Tr=!0,gd=null,Vl=!0,d=I6(h,null,p,d),h.child=d;d;)d.flags=d.flags&-3|4096,d=d.sibling}else{if(Tv(),p===S){h=oc(l,h,d);break e}Ki(l,h,p,d)}h=h.child}return h;case 26:return kb(l,h),l===null?(d=aW(h.type,null,h.pendingProps,null))?h.memoizedState=d:Tr||(d=h.type,l=h.pendingProps,p=zb(F.current).createElement(d),p[Xn]=h,p[fi]=l,Qi(p,d,l),Re(p),h.stateNode=p):h.memoizedState=aW(h.type,l.memoizedProps,h.pendingProps,l.memoizedState),null;case 27:return I(h),l===null&&Tr&&(p=h.stateNode=nW(h.type,h.pendingProps,F.current),Ps=h,Vl=!0,S=Hn,Ih(h.type)?(BA=S,Hn=al(p.firstChild)):Hn=S),Ki(l,h,h.pendingProps.children,d),kb(l,h),l===null&&(h.flags|=4194304),h.child;case 5:return l===null&&Tr&&((S=p=Hn)&&(p=aae(p,h.type,h.pendingProps,Vl),p!==null?(h.stateNode=p,Ps=h,Hn=al(p.firstChild),Vl=!1,S=!0):S=!1),S||md(h)),I(h),S=h.type,C=h.pendingProps,N=l!==null?l.memoizedProps:null,p=C.children,NA(S,C)?p=null:N!==null&&NA(S,N)&&(h.flags|=32),h.memoizedState!==null&&(S=IM(l,h,Ese,null,null,d),iw._currentValue=S),kb(l,h),Ki(l,h,p,d),h.child;case 6:return l===null&&Tr&&((l=d=Hn)&&(d=oae(d,h.pendingProps,Vl),d!==null?(h.stateNode=d,Ps=h,Hn=null,l=!0):l=!1),l||md(h)),null;case 13:return J6(l,h,d);case 4:return te(h,h.stateNode.containerInfo),p=h.pendingProps,l===null?h.child=Bm(h,null,p,d):Ki(l,h,p,d),h.child;case 11:return Y6(l,h,h.type,h.pendingProps,d);case 7:return Ki(l,h,h.pendingProps,d),h.child;case 8:return Ki(l,h,h.pendingProps.children,d),h.child;case 12:return Ki(l,h,h.pendingProps.children,d),h.child;case 10:return p=h.pendingProps,yh(h,h.type,p.value),Ki(l,h,p.children,d),h.child;case 9:return S=h.type._context,p=h.pendingProps.children,vd(h),S=os(S),p=p(S),h.flags|=1,Ki(l,h,p,d),h.child;case 14:return z6(l,h,h.type,h.pendingProps,d);case 15:return G6(l,h,h.type,h.pendingProps,d);case 19:return t8(l,h,d);case 31:return p=h.pendingProps,d=h.mode,p={mode:p.mode,children:p.children},l===null?(d=Db(p,d),d.ref=h.ref,h.child=d,d.return=h,h=d):(d=ec(l.child,p),d.ref=h.ref,h.child=d,d.return=h,h=d),h;case 22:return q6(l,h,d);case 24:return vd(h),p=os(Mi),l===null?(S=_M(),S===null&&(S=on,C=xM(),S.pooledCache=C,C.refCount++,C!==null&&(S.pooledCacheLanes|=d),S=C),h.memoizedState={parent:p,cache:S},TM(h),yh(h,Mi,S)):((l.lanes&d)!==0&&(MM(l,h),Hv(h,null,null,d),Nv()),S=l.memoizedState,C=h.memoizedState,S.parent!==p?(S={parent:p,cache:p},h.memoizedState=S,h.lanes===0&&(h.memoizedState=h.updateQueue.baseState=S),yh(h,Mi,p)):(p=C.cache,yh(h,Mi,p),p!==S.cache&&CM(h,[Mi],d,!0))),Ki(l,h,h.pendingProps.children,d),h.child;case 29:throw h.pendingProps}throw Error(n(156,h.tag))}function lc(l){l.flags|=4}function n8(l,h){if(h.type!=="stylesheet"||(h.state.loading&4)!==0)l.flags&=-16777217;else if(l.flags|=16777216,!hW(h)){if(h=uo.current,h!==null&&((hr&4194048)===hr?Wl!==null:(hr&62914560)!==hr&&(hr&536870912)===0||h!==Wl))throw Pv=RM,VV;l.flags|=8192}}function Pb(l,h){h!==null&&(l.flags|=4),l.flags&16384&&(h=l.tag!==22?xa():536870912,l.lanes|=h,Um|=h)}function Uv(l,h){if(!Tr)switch(l.tailMode){case"hidden":h=l.tail;for(var d=null;h!==null;)h.alternate!==null&&(d=h),h=h.sibling;d===null?l.tail=null:d.sibling=null;break;case"collapsed":d=l.tail;for(var p=null;d!==null;)d.alternate!==null&&(p=d),d=d.sibling;p===null?h||l.tail===null?l.tail=null:l.tail.sibling=null:p.sibling=null}}function xn(l){var h=l.alternate!==null&&l.alternate.child===l.child,d=0,p=0;if(h)for(var S=l.child;S!==null;)d|=S.lanes|S.childLanes,p|=S.subtreeFlags&65011712,p|=S.flags&65011712,S.return=l,S=S.sibling;else for(S=l.child;S!==null;)d|=S.lanes|S.childLanes,p|=S.subtreeFlags,p|=S.flags,S.return=l,S=S.sibling;return l.subtreeFlags|=p,l.childLanes=d,h}function Pse(l,h,d){var p=h.pendingProps;switch(wM(h),h.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return xn(h),null;case 1:return xn(h),null;case 3:return d=h.stateNode,p=null,l!==null&&(p=l.memoizedState.cache),h.memoizedState.cache!==p&&(h.flags|=2048),ic(Mi),fe(),d.pendingContext&&(d.context=d.pendingContext,d.pendingContext=null),(l===null||l.child===null)&&(Rv(h)?lc(h):l===null||l.memoizedState.isDehydrated&&(h.flags&256)===0||(h.flags|=1024,NV())),xn(h),null;case 26:return d=h.memoizedState,l===null?(lc(h),d!==null?(xn(h),n8(h,d)):(xn(h),h.flags&=-16777217)):d?d!==l.memoizedState?(lc(h),xn(h),n8(h,d)):(xn(h),h.flags&=-16777217):(l.memoizedProps!==p&&lc(h),xn(h),h.flags&=-16777217),null;case 27:U(h),d=F.current;var S=h.type;if(l!==null&&h.stateNode!=null)l.memoizedProps!==p&&lc(h);else{if(!p){if(h.stateNode===null)throw Error(n(166));return xn(h),null}l=R.current,Rv(h)?PV(h):(l=nW(S,p,d),h.stateNode=l,lc(h))}return xn(h),null;case 5:if(U(h),d=h.type,l!==null&&h.stateNode!=null)l.memoizedProps!==p&&lc(h);else{if(!p){if(h.stateNode===null)throw Error(n(166));return xn(h),null}if(l=R.current,Rv(h))PV(h);else{switch(S=zb(F.current),l){case 1:l=S.createElementNS("http://www.w3.org/2000/svg",d);break;case 2:l=S.createElementNS("http://www.w3.org/1998/Math/MathML",d);break;default:switch(d){case"svg":l=S.createElementNS("http://www.w3.org/2000/svg",d);break;case"math":l=S.createElementNS("http://www.w3.org/1998/Math/MathML",d);break;case"script":l=S.createElement("div"),l.innerHTML="<script><\/script>",l=l.removeChild(l.firstChild);break;case"select":l=typeof p.is=="string"?S.createElement("select",{is:p.is}):S.createElement("select"),p.multiple?l.multiple=!0:p.size&&(l.size=p.size);break;default:l=typeof p.is=="string"?S.createElement(d,{is:p.is}):S.createElement(d)}}l[Xn]=h,l[fi]=p;e:for(S=h.child;S!==null;){if(S.tag===5||S.tag===6)l.appendChild(S.stateNode);else if(S.tag!==4&&S.tag!==27&&S.child!==null){S.child.return=S,S=S.child;continue}if(S===h)break e;for(;S.sibling===null;){if(S.return===null||S.return===h)break e;S=S.return}S.sibling.return=S.return,S=S.sibling}h.stateNode=l;e:switch(Qi(l,d,p),d){case"button":case"input":case"select":case"textarea":l=!!p.autoFocus;break e;case"img":l=!0;break e;default:l=!1}l&&lc(h)}}return xn(h),h.flags&=-16777217,null;case 6:if(l&&h.stateNode!=null)l.memoizedProps!==p&&lc(h);else{if(typeof p!="string"&&h.stateNode===null)throw Error(n(166));if(l=F.current,Rv(h)){if(l=h.stateNode,d=h.memoizedProps,p=null,S=Ps,S!==null)switch(S.tag){case 27:case 5:p=S.memoizedProps}l[Xn]=h,l=!!(l.nodeValue===d||p!==null&&p.suppressHydrationWarning===!0||X8(l.nodeValue,d)),l||md(h)}else l=zb(l).createTextNode(p),l[Xn]=h,h.stateNode=l}return xn(h),null;case 13:if(p=h.memoizedState,l===null||l.memoizedState!==null&&l.memoizedState.dehydrated!==null){if(S=Rv(h),p!==null&&p.dehydrated!==null){if(l===null){if(!S)throw Error(n(318));if(S=h.memoizedState,S=S!==null?S.dehydrated:null,!S)throw Error(n(317));S[Xn]=h}else Tv(),(h.flags&128)===0&&(h.memoizedState=null),h.flags|=4;xn(h),S=!1}else S=NV(),l!==null&&l.memoizedState!==null&&(l.memoizedState.hydrationErrors=S),S=!0;if(!S)return h.flags&256?(ac(h),h):(ac(h),null)}if(ac(h),(h.flags&128)!==0)return h.lanes=d,h;if(d=p!==null,l=l!==null&&l.memoizedState!==null,d){p=h.child,S=null,p.alternate!==null&&p.alternate.memoizedState!==null&&p.alternate.memoizedState.cachePool!==null&&(S=p.alternate.memoizedState.cachePool.pool);var C=null;p.memoizedState!==null&&p.memoizedState.cachePool!==null&&(C=p.memoizedState.cachePool.pool),C!==S&&(p.flags|=2048)}return d!==l&&d&&(h.child.flags|=8192),Pb(h,h.updateQueue),xn(h),null;case 4:return fe(),l===null&&OA(h.stateNode.containerInfo),xn(h),null;case 10:return ic(h.type),xn(h),null;case 19:if(B(Ai),S=h.memoizedState,S===null)return xn(h),null;if(p=(h.flags&128)!==0,C=S.rendering,C===null)if(p)Uv(S,!1);else{if(Fn!==0||l!==null&&(l.flags&128)!==0)for(l=h.child;l!==null;){if(C=Mb(l),C!==null){for(h.flags|=128,Uv(S,!1),l=C.updateQueue,h.updateQueue=l,Pb(h,l),h.subtreeFlags=0,l=d,d=h.child;d!==null;)kV(d,l),d=d.sibling;return E(Ai,Ai.current&1|2),h.child}l=l.sibling}S.tail!==null&&Q()>Hb&&(h.flags|=128,p=!0,Uv(S,!1),h.lanes=4194304)}else{if(!p)if(l=Mb(C),l!==null){if(h.flags|=128,p=!0,l=l.updateQueue,h.updateQueue=l,Pb(h,l),Uv(S,!0),S.tail===null&&S.tailMode==="hidden"&&!C.alternate&&!Tr)return xn(h),null}else 2*Q()-S.renderingStartTime>Hb&&d!==536870912&&(h.flags|=128,p=!0,Uv(S,!1),h.lanes=4194304);S.isBackwards?(C.sibling=h.child,h.child=C):(l=S.last,l!==null?l.sibling=C:h.child=C,S.last=C)}return S.tail!==null?(h=S.tail,S.rendering=h,S.tail=h.sibling,S.renderingStartTime=Q(),h.sibling=null,l=Ai.current,E(Ai,p?l&1|2:l&1),h):(xn(h),null);case 22:case 23:return ac(h),DM(),p=h.memoizedState!==null,l!==null?l.memoizedState!==null!==p&&(h.flags|=8192):p&&(h.flags|=8192),p?(d&536870912)!==0&&(h.flags&128)===0&&(xn(h),h.subtreeFlags&6&&(h.flags|=8192)):xn(h),d=h.updateQueue,d!==null&&Pb(h,d.retryQueue),d=null,l!==null&&l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(d=l.memoizedState.cachePool.pool),p=null,h.memoizedState!==null&&h.memoizedState.cachePool!==null&&(p=h.memoizedState.cachePool.pool),p!==d&&(h.flags|=2048),l!==null&&B(wd),null;case 24:return d=null,l!==null&&(d=l.memoizedState.cache),h.memoizedState.cache!==d&&(h.flags|=2048),ic(Mi),xn(h),null;case 25:return null;case 30:return null}throw Error(n(156,h.tag))}function Ise(l,h){switch(wM(h),h.tag){case 1:return l=h.flags,l&65536?(h.flags=l&-65537|128,h):null;case 3:return ic(Mi),fe(),l=h.flags,(l&65536)!==0&&(l&128)===0?(h.flags=l&-65537|128,h):null;case 26:case 27:case 5:return U(h),null;case 13:if(ac(h),l=h.memoizedState,l!==null&&l.dehydrated!==null){if(h.alternate===null)throw Error(n(340));Tv()}return l=h.flags,l&65536?(h.flags=l&-65537|128,h):null;case 19:return B(Ai),null;case 4:return fe(),null;case 10:return ic(h.type),null;case 22:case 23:return ac(h),DM(),l!==null&&B(wd),l=h.flags,l&65536?(h.flags=l&-65537|128,h):null;case 24:return ic(Mi),null;case 25:return null;default:return null}}function i8(l,h){switch(wM(h),h.tag){case 3:ic(Mi),fe();break;case 26:case 27:case 5:U(h);break;case 4:fe();break;case 13:ac(h);break;case 19:B(Ai);break;case 10:ic(h.type);break;case 22:case 23:ac(h),DM(),l!==null&&B(wd);break;case 24:ic(Mi)}}function jv(l,h){try{var d=h.updateQueue,p=d!==null?d.lastEffect:null;if(p!==null){var S=p.next;d=S;do{if((d.tag&l)===l){p=void 0;var C=d.create,N=d.inst;p=C(),N.destroy=p}d=d.next}while(d!==S)}}catch(j){en(h,h.return,j)}}function Rh(l,h,d){try{var p=h.updateQueue,S=p!==null?p.lastEffect:null;if(S!==null){var C=S.next;p=C;do{if((p.tag&l)===l){var N=p.inst,j=N.destroy;if(j!==void 0){N.destroy=void 0,S=h;var ue=d,Oe=j;try{Oe()}catch(Le){en(S,ue,Le)}}}p=p.next}while(p!==C)}}catch(Le){en(h,h.return,Le)}}function s8(l){var h=l.updateQueue;if(h!==null){var d=l.stateNode;try{zV(h,d)}catch(p){en(l,l.return,p)}}}function a8(l,h,d){d.props=Sd(l.type,l.memoizedProps),d.state=l.memoizedState;try{d.componentWillUnmount()}catch(p){en(l,h,p)}}function Yv(l,h){try{var d=l.ref;if(d!==null){switch(l.tag){case 26:case 27:case 5:var p=l.stateNode;break;case 30:p=l.stateNode;break;default:p=l.stateNode}typeof d=="function"?l.refCleanup=d(p):d.current=p}}catch(S){en(l,h,S)}}function $l(l,h){var d=l.ref,p=l.refCleanup;if(d!==null)if(typeof p=="function")try{p()}catch(S){en(l,h,S)}finally{l.refCleanup=null,l=l.alternate,l!=null&&(l.refCleanup=null)}else if(typeof d=="function")try{d(null)}catch(S){en(l,h,S)}else d.current=null}function o8(l){var h=l.type,d=l.memoizedProps,p=l.stateNode;try{e:switch(h){case"button":case"input":case"select":case"textarea":d.autoFocus&&p.focus();break e;case"img":d.src?p.src=d.src:d.srcSet&&(p.srcset=d.srcSet)}}catch(S){en(l,l.return,S)}}function aA(l,h,d){try{var p=l.stateNode;tae(p,l.type,d,h),p[fi]=h}catch(S){en(l,l.return,S)}}function l8(l){return l.tag===5||l.tag===3||l.tag===26||l.tag===27&&Ih(l.type)||l.tag===4}function oA(l){e:for(;;){for(;l.sibling===null;){if(l.return===null||l8(l.return))return null;l=l.return}for(l.sibling.return=l.return,l=l.sibling;l.tag!==5&&l.tag!==6&&l.tag!==18;){if(l.tag===27&&Ih(l.type)||l.flags&2||l.child===null||l.tag===4)continue e;l.child.return=l,l=l.child}if(!(l.flags&2))return l.stateNode}}function lA(l,h,d){var p=l.tag;if(p===5||p===6)l=l.stateNode,h?(d.nodeType===9?d.body:d.nodeName==="HTML"?d.ownerDocument.body:d).insertBefore(l,h):(h=d.nodeType===9?d.body:d.nodeName==="HTML"?d.ownerDocument.body:d,h.appendChild(l),d=d._reactRootContainer,d!=null||h.onclick!==null||(h.onclick=Yb));else if(p!==4&&(p===27&&Ih(l.type)&&(d=l.stateNode,h=null),l=l.child,l!==null))for(lA(l,h,d),l=l.sibling;l!==null;)lA(l,h,d),l=l.sibling}function Ib(l,h,d){var p=l.tag;if(p===5||p===6)l=l.stateNode,h?d.insertBefore(l,h):d.appendChild(l);else if(p!==4&&(p===27&&Ih(l.type)&&(d=l.stateNode),l=l.child,l!==null))for(Ib(l,h,d),l=l.sibling;l!==null;)Ib(l,h,d),l=l.sibling}function u8(l){var h=l.stateNode,d=l.memoizedProps;try{for(var p=l.type,S=h.attributes;S.length;)h.removeAttributeNode(S[0]);Qi(h,p,d),h[Xn]=l,h[fi]=d}catch(C){en(l,l.return,C)}}var uc=!1,Zn=!1,uA=!1,c8=typeof WeakSet=="function"?WeakSet:Set,Li=null;function Nse(l,h){if(l=l.containerInfo,PA=Zb,l=bV(l),oM(l)){if("selectionStart"in l)var d={start:l.selectionStart,end:l.selectionEnd};else e:{d=(d=l.ownerDocument)&&d.defaultView||window;var p=d.getSelection&&d.getSelection();if(p&&p.rangeCount!==0){d=p.anchorNode;var S=p.anchorOffset,C=p.focusNode;p=p.focusOffset;try{d.nodeType,C.nodeType}catch{d=null;break e}var N=0,j=-1,ue=-1,Oe=0,Le=0,We=l,ke=null;t:for(;;){for(var De;We!==d||S!==0&&We.nodeType!==3||(j=N+S),We!==C||p!==0&&We.nodeType!==3||(ue=N+p),We.nodeType===3&&(N+=We.nodeValue.length),(De=We.firstChild)!==null;)ke=We,We=De;for(;;){if(We===l)break t;if(ke===d&&++Oe===S&&(j=N),ke===C&&++Le===p&&(ue=N),(De=We.nextSibling)!==null)break;We=ke,ke=We.parentNode}We=De}d=j===-1||ue===-1?null:{start:j,end:ue}}else d=null}d=d||{start:0,end:0}}else d=null;for(IA={focusedElem:l,selectionRange:d},Zb=!1,Li=h;Li!==null;)if(h=Li,l=h.child,(h.subtreeFlags&1024)!==0&&l!==null)l.return=h,Li=l;else for(;Li!==null;){switch(h=Li,C=h.alternate,l=h.flags,h.tag){case 0:break;case 11:case 15:break;case 1:if((l&1024)!==0&&C!==null){l=void 0,d=h,S=C.memoizedProps,C=C.memoizedState,p=d.stateNode;try{var At=Sd(d.type,S,d.elementType===d.type);l=p.getSnapshotBeforeUpdate(At,C),p.__reactInternalSnapshotBeforeUpdate=l}catch(_t){en(d,d.return,_t)}}break;case 3:if((l&1024)!==0){if(l=h.stateNode.containerInfo,d=l.nodeType,d===9)FA(l);else if(d===1)switch(l.nodeName){case"HEAD":case"HTML":case"BODY":FA(l);break;default:l.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((l&1024)!==0)throw Error(n(163))}if(l=h.sibling,l!==null){l.return=h.return,Li=l;break}Li=h.return}}function h8(l,h,d){var p=d.flags;switch(d.tag){case 0:case 11:case 15:Th(l,d),p&4&&jv(5,d);break;case 1:if(Th(l,d),p&4)if(l=d.stateNode,h===null)try{l.componentDidMount()}catch(N){en(d,d.return,N)}else{var S=Sd(d.type,h.memoizedProps);h=h.memoizedState;try{l.componentDidUpdate(S,h,l.__reactInternalSnapshotBeforeUpdate)}catch(N){en(d,d.return,N)}}p&64&&s8(d),p&512&&Yv(d,d.return);break;case 3:if(Th(l,d),p&64&&(l=d.updateQueue,l!==null)){if(h=null,d.child!==null)switch(d.child.tag){case 27:case 5:h=d.child.stateNode;break;case 1:h=d.child.stateNode}try{zV(l,h)}catch(N){en(d,d.return,N)}}break;case 27:h===null&&p&4&&u8(d);case 26:case 5:Th(l,d),h===null&&p&4&&o8(d),p&512&&Yv(d,d.return);break;case 12:Th(l,d);break;case 13:Th(l,d),p&4&&g8(l,d),p&64&&(l=d.memoizedState,l!==null&&(l=l.dehydrated,l!==null&&(d=jse.bind(null,d),lae(l,d))));break;case 22:if(p=d.memoizedState!==null||uc,!p){h=h!==null&&h.memoizedState!==null||Zn,S=uc;var C=Zn;uc=p,(Zn=h)&&!C?Mh(l,d,(d.subtreeFlags&8772)!==0):Th(l,d),uc=S,Zn=C}break;case 30:break;default:Th(l,d)}}function f8(l){var h=l.alternate;h!==null&&(l.alternate=null,f8(h)),l.child=null,l.deletions=null,l.sibling=null,l.tag===5&&(h=l.stateNode,h!==null&&X(h)),l.stateNode=null,l.return=null,l.dependencies=null,l.memoizedProps=null,l.memoizedState=null,l.pendingProps=null,l.stateNode=null,l.updateQueue=null}var yn=null,Js=!1;function cc(l,h,d){for(d=d.child;d!==null;)d8(l,h,d),d=d.sibling}function d8(l,h,d){if(at&&typeof at.onCommitFiberUnmount=="function")try{at.onCommitFiberUnmount(Et,d)}catch{}switch(d.tag){case 26:Zn||$l(d,h),cc(l,h,d),d.memoizedState?d.memoizedState.count--:d.stateNode&&(d=d.stateNode,d.parentNode.removeChild(d));break;case 27:Zn||$l(d,h);var p=yn,S=Js;Ih(d.type)&&(yn=d.stateNode,Js=!1),cc(l,h,d),ew(d.stateNode),yn=p,Js=S;break;case 5:Zn||$l(d,h);case 6:if(p=yn,S=Js,yn=null,cc(l,h,d),yn=p,Js=S,yn!==null)if(Js)try{(yn.nodeType===9?yn.body:yn.nodeName==="HTML"?yn.ownerDocument.body:yn).removeChild(d.stateNode)}catch(C){en(d,h,C)}else try{yn.removeChild(d.stateNode)}catch(C){en(d,h,C)}break;case 18:yn!==null&&(Js?(l=yn,tW(l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l,d.stateNode),lw(l)):tW(yn,d.stateNode));break;case 4:p=yn,S=Js,yn=d.stateNode.containerInfo,Js=!0,cc(l,h,d),yn=p,Js=S;break;case 0:case 11:case 14:case 15:Zn||Rh(2,d,h),Zn||Rh(4,d,h),cc(l,h,d);break;case 1:Zn||($l(d,h),p=d.stateNode,typeof p.componentWillUnmount=="function"&&a8(d,h,p)),cc(l,h,d);break;case 21:cc(l,h,d);break;case 22:Zn=(p=Zn)||d.memoizedState!==null,cc(l,h,d),Zn=p;break;default:cc(l,h,d)}}function g8(l,h){if(h.memoizedState===null&&(l=h.alternate,l!==null&&(l=l.memoizedState,l!==null&&(l=l.dehydrated,l!==null))))try{lw(l)}catch(d){en(h,h.return,d)}}function Hse(l){switch(l.tag){case 13:case 19:var h=l.stateNode;return h===null&&(h=l.stateNode=new c8),h;case 22:return l=l.stateNode,h=l._retryCache,h===null&&(h=l._retryCache=new c8),h;default:throw Error(n(435,l.tag))}}function cA(l,h){var d=Hse(l);h.forEach(function(p){var S=Yse.bind(null,l,p);d.has(p)||(d.add(p),p.then(S,S))})}function Ma(l,h){var d=h.deletions;if(d!==null)for(var p=0;p<d.length;p++){var S=d[p],C=l,N=h,j=N;e:for(;j!==null;){switch(j.tag){case 27:if(Ih(j.type)){yn=j.stateNode,Js=!1;break e}break;case 5:yn=j.stateNode,Js=!1;break e;case 3:case 4:yn=j.stateNode.containerInfo,Js=!0;break e}j=j.return}if(yn===null)throw Error(n(160));d8(C,N,S),yn=null,Js=!1,C=S.alternate,C!==null&&(C.return=null),S.return=null}if(h.subtreeFlags&13878)for(h=h.child;h!==null;)m8(h,l),h=h.sibling}var sl=null;function m8(l,h){var d=l.alternate,p=l.flags;switch(l.tag){case 0:case 11:case 14:case 15:Ma(h,l),Aa(l),p&4&&(Rh(3,l,l.return),jv(3,l),Rh(5,l,l.return));break;case 1:Ma(h,l),Aa(l),p&512&&(Zn||d===null||$l(d,d.return)),p&64&&uc&&(l=l.updateQueue,l!==null&&(p=l.callbacks,p!==null&&(d=l.shared.hiddenCallbacks,l.shared.hiddenCallbacks=d===null?p:d.concat(p))));break;case 26:var S=sl;if(Ma(h,l),Aa(l),p&512&&(Zn||d===null||$l(d,d.return)),p&4){var C=d!==null?d.memoizedState:null;if(p=l.memoizedState,d===null)if(p===null)if(l.stateNode===null){e:{p=l.type,d=l.memoizedProps,S=S.ownerDocument||S;t:switch(p){case"title":C=S.getElementsByTagName("title")[0],(!C||C[q]||C[Xn]||C.namespaceURI==="http://www.w3.org/2000/svg"||C.hasAttribute("itemprop"))&&(C=S.createElement(p),S.head.insertBefore(C,S.querySelector("head > title"))),Qi(C,p,d),C[Xn]=l,Re(C),p=C;break e;case"link":var N=uW("link","href",S).get(p+(d.href||""));if(N){for(var j=0;j<N.length;j++)if(C=N[j],C.getAttribute("href")===(d.href==null||d.href===""?null:d.href)&&C.getAttribute("rel")===(d.rel==null?null:d.rel)&&C.getAttribute("title")===(d.title==null?null:d.title)&&C.getAttribute("crossorigin")===(d.crossOrigin==null?null:d.crossOrigin)){N.splice(j,1);break t}}C=S.createElement(p),Qi(C,p,d),S.head.appendChild(C);break;case"meta":if(N=uW("meta","content",S).get(p+(d.content||""))){for(j=0;j<N.length;j++)if(C=N[j],C.getAttribute("content")===(d.content==null?null:""+d.content)&&C.getAttribute("name")===(d.name==null?null:d.name)&&C.getAttribute("property")===(d.property==null?null:d.property)&&C.getAttribute("http-equiv")===(d.httpEquiv==null?null:d.httpEquiv)&&C.getAttribute("charset")===(d.charSet==null?null:d.charSet)){N.splice(j,1);break t}}C=S.createElement(p),Qi(C,p,d),S.head.appendChild(C);break;default:throw Error(n(468,p))}C[Xn]=l,Re(C),p=C}l.stateNode=p}else cW(S,l.type,l.stateNode);else l.stateNode=lW(S,p,l.memoizedProps);else C!==p?(C===null?d.stateNode!==null&&(d=d.stateNode,d.parentNode.removeChild(d)):C.count--,p===null?cW(S,l.type,l.stateNode):lW(S,p,l.memoizedProps)):p===null&&l.stateNode!==null&&aA(l,l.memoizedProps,d.memoizedProps)}break;case 27:Ma(h,l),Aa(l),p&512&&(Zn||d===null||$l(d,d.return)),d!==null&&p&4&&aA(l,l.memoizedProps,d.memoizedProps);break;case 5:if(Ma(h,l),Aa(l),p&512&&(Zn||d===null||$l(d,d.return)),l.flags&32){S=l.stateNode;try{bm(S,"")}catch(De){en(l,l.return,De)}}p&4&&l.stateNode!=null&&(S=l.memoizedProps,aA(l,S,d!==null?d.memoizedProps:S)),p&1024&&(uA=!0);break;case 6:if(Ma(h,l),Aa(l),p&4){if(l.stateNode===null)throw Error(n(162));p=l.memoizedProps,d=l.stateNode;try{d.nodeValue=p}catch(De){en(l,l.return,De)}}break;case 3:if(Kb=null,S=sl,sl=Gb(h.containerInfo),Ma(h,l),sl=S,Aa(l),p&4&&d!==null&&d.memoizedState.isDehydrated)try{lw(h.containerInfo)}catch(De){en(l,l.return,De)}uA&&(uA=!1,p8(l));break;case 4:p=sl,sl=Gb(l.stateNode.containerInfo),Ma(h,l),Aa(l),sl=p;break;case 12:Ma(h,l),Aa(l);break;case 13:Ma(h,l),Aa(l),l.child.flags&8192&&l.memoizedState!==null!=(d!==null&&d.memoizedState!==null)&&(pA=Q()),p&4&&(p=l.updateQueue,p!==null&&(l.updateQueue=null,cA(l,p)));break;case 22:S=l.memoizedState!==null;var ue=d!==null&&d.memoizedState!==null,Oe=uc,Le=Zn;if(uc=Oe||S,Zn=Le||ue,Ma(h,l),Zn=Le,uc=Oe,Aa(l),p&8192)e:for(h=l.stateNode,h._visibility=S?h._visibility&-2:h._visibility|1,S&&(d===null||ue||uc||Zn||bd(l)),d=null,h=l;;){if(h.tag===5||h.tag===26){if(d===null){ue=d=h;try{if(C=ue.stateNode,S)N=C.style,typeof N.setProperty=="function"?N.setProperty("display","none","important"):N.display="none";else{j=ue.stateNode;var We=ue.memoizedProps.style,ke=We!=null&&We.hasOwnProperty("display")?We.display:null;j.style.display=ke==null||typeof ke=="boolean"?"":(""+ke).trim()}}catch(De){en(ue,ue.return,De)}}}else if(h.tag===6){if(d===null){ue=h;try{ue.stateNode.nodeValue=S?"":ue.memoizedProps}catch(De){en(ue,ue.return,De)}}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===l)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===l)break e;for(;h.sibling===null;){if(h.return===null||h.return===l)break e;d===h&&(d=null),h=h.return}d===h&&(d=null),h.sibling.return=h.return,h=h.sibling}p&4&&(p=l.updateQueue,p!==null&&(d=p.retryQueue,d!==null&&(p.retryQueue=null,cA(l,d))));break;case 19:Ma(h,l),Aa(l),p&4&&(p=l.updateQueue,p!==null&&(l.updateQueue=null,cA(l,p)));break;case 30:break;case 21:break;default:Ma(h,l),Aa(l)}}function Aa(l){var h=l.flags;if(h&2){try{for(var d,p=l.return;p!==null;){if(l8(p)){d=p;break}p=p.return}if(d==null)throw Error(n(160));switch(d.tag){case 27:var S=d.stateNode,C=oA(l);Ib(l,C,S);break;case 5:var N=d.stateNode;d.flags&32&&(bm(N,""),d.flags&=-33);var j=oA(l);Ib(l,j,N);break;case 3:case 4:var ue=d.stateNode.containerInfo,Oe=oA(l);lA(l,Oe,ue);break;default:throw Error(n(161))}}catch(Le){en(l,l.return,Le)}l.flags&=-3}h&4096&&(l.flags&=-4097)}function p8(l){if(l.subtreeFlags&1024)for(l=l.child;l!==null;){var h=l;p8(h),h.tag===5&&h.flags&1024&&h.stateNode.reset(),l=l.sibling}}function Th(l,h){if(h.subtreeFlags&8772)for(h=h.child;h!==null;)h8(l,h.alternate,h),h=h.sibling}function bd(l){for(l=l.child;l!==null;){var h=l;switch(h.tag){case 0:case 11:case 14:case 15:Rh(4,h,h.return),bd(h);break;case 1:$l(h,h.return);var d=h.stateNode;typeof d.componentWillUnmount=="function"&&a8(h,h.return,d),bd(h);break;case 27:ew(h.stateNode);case 26:case 5:$l(h,h.return),bd(h);break;case 22:h.memoizedState===null&&bd(h);break;case 30:bd(h);break;default:bd(h)}l=l.sibling}}function Mh(l,h,d){for(d=d&&(h.subtreeFlags&8772)!==0,h=h.child;h!==null;){var p=h.alternate,S=l,C=h,N=C.flags;switch(C.tag){case 0:case 11:case 15:Mh(S,C,d),jv(4,C);break;case 1:if(Mh(S,C,d),p=C,S=p.stateNode,typeof S.componentDidMount=="function")try{S.componentDidMount()}catch(Oe){en(p,p.return,Oe)}if(p=C,S=p.updateQueue,S!==null){var j=p.stateNode;try{var ue=S.shared.hiddenCallbacks;if(ue!==null)for(S.shared.hiddenCallbacks=null,S=0;S<ue.length;S++)YV(ue[S],j)}catch(Oe){en(p,p.return,Oe)}}d&&N&64&&s8(C),Yv(C,C.return);break;case 27:u8(C);case 26:case 5:Mh(S,C,d),d&&p===null&&N&4&&o8(C),Yv(C,C.return);break;case 12:Mh(S,C,d);break;case 13:Mh(S,C,d),d&&N&4&&g8(S,C);break;case 22:C.memoizedState===null&&Mh(S,C,d),Yv(C,C.return);break;case 30:break;default:Mh(S,C,d)}h=h.sibling}}function hA(l,h){var d=null;l!==null&&l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(d=l.memoizedState.cachePool.pool),l=null,h.memoizedState!==null&&h.memoizedState.cachePool!==null&&(l=h.memoizedState.cachePool.pool),l!==d&&(l!=null&&l.refCount++,d!=null&&Ov(d))}function fA(l,h){l=null,h.alternate!==null&&(l=h.alternate.memoizedState.cache),h=h.memoizedState.cache,h!==l&&(h.refCount++,l!=null&&Ov(l))}function Ul(l,h,d,p){if(h.subtreeFlags&10256)for(h=h.child;h!==null;)v8(l,h,d,p),h=h.sibling}function v8(l,h,d,p){var S=h.flags;switch(h.tag){case 0:case 11:case 15:Ul(l,h,d,p),S&2048&&jv(9,h);break;case 1:Ul(l,h,d,p);break;case 3:Ul(l,h,d,p),S&2048&&(l=null,h.alternate!==null&&(l=h.alternate.memoizedState.cache),h=h.memoizedState.cache,h!==l&&(h.refCount++,l!=null&&Ov(l)));break;case 12:if(S&2048){Ul(l,h,d,p),l=h.stateNode;try{var C=h.memoizedProps,N=C.id,j=C.onPostCommit;typeof j=="function"&&j(N,h.alternate===null?"mount":"update",l.passiveEffectDuration,-0)}catch(ue){en(h,h.return,ue)}}else Ul(l,h,d,p);break;case 13:Ul(l,h,d,p);break;case 23:break;case 22:C=h.stateNode,N=h.alternate,h.memoizedState!==null?C._visibility&2?Ul(l,h,d,p):zv(l,h):C._visibility&2?Ul(l,h,d,p):(C._visibility|=2,Vm(l,h,d,p,(h.subtreeFlags&10256)!==0)),S&2048&&hA(N,h);break;case 24:Ul(l,h,d,p),S&2048&&fA(h.alternate,h);break;default:Ul(l,h,d,p)}}function Vm(l,h,d,p,S){for(S=S&&(h.subtreeFlags&10256)!==0,h=h.child;h!==null;){var C=l,N=h,j=d,ue=p,Oe=N.flags;switch(N.tag){case 0:case 11:case 15:Vm(C,N,j,ue,S),jv(8,N);break;case 23:break;case 22:var Le=N.stateNode;N.memoizedState!==null?Le._visibility&2?Vm(C,N,j,ue,S):zv(C,N):(Le._visibility|=2,Vm(C,N,j,ue,S)),S&&Oe&2048&&hA(N.alternate,N);break;case 24:Vm(C,N,j,ue,S),S&&Oe&2048&&fA(N.alternate,N);break;default:Vm(C,N,j,ue,S)}h=h.sibling}}function zv(l,h){if(h.subtreeFlags&10256)for(h=h.child;h!==null;){var d=l,p=h,S=p.flags;switch(p.tag){case 22:zv(d,p),S&2048&&hA(p.alternate,p);break;case 24:zv(d,p),S&2048&&fA(p.alternate,p);break;default:zv(d,p)}h=h.sibling}}var Gv=8192;function Wm(l){if(l.subtreeFlags&Gv)for(l=l.child;l!==null;)w8(l),l=l.sibling}function w8(l){switch(l.tag){case 26:Wm(l),l.flags&Gv&&l.memoizedState!==null&&bae(sl,l.memoizedState,l.memoizedProps);break;case 5:Wm(l);break;case 3:case 4:var h=sl;sl=Gb(l.stateNode.containerInfo),Wm(l),sl=h;break;case 22:l.memoizedState===null&&(h=l.alternate,h!==null&&h.memoizedState!==null?(h=Gv,Gv=16777216,Wm(l),Gv=h):Wm(l));break;default:Wm(l)}}function y8(l){var h=l.alternate;if(h!==null&&(l=h.child,l!==null)){h.child=null;do h=l.sibling,l.sibling=null,l=h;while(l!==null)}}function qv(l){var h=l.deletions;if((l.flags&16)!==0){if(h!==null)for(var d=0;d<h.length;d++){var p=h[d];Li=p,b8(p,l)}y8(l)}if(l.subtreeFlags&10256)for(l=l.child;l!==null;)S8(l),l=l.sibling}function S8(l){switch(l.tag){case 0:case 11:case 15:qv(l),l.flags&2048&&Rh(9,l,l.return);break;case 3:qv(l);break;case 12:qv(l);break;case 22:var h=l.stateNode;l.memoizedState!==null&&h._visibility&2&&(l.return===null||l.return.tag!==13)?(h._visibility&=-3,Nb(l)):qv(l);break;default:qv(l)}}function Nb(l){var h=l.deletions;if((l.flags&16)!==0){if(h!==null)for(var d=0;d<h.length;d++){var p=h[d];Li=p,b8(p,l)}y8(l)}for(l=l.child;l!==null;){switch(h=l,h.tag){case 0:case 11:case 15:Rh(8,h,h.return),Nb(h);break;case 22:d=h.stateNode,d._visibility&2&&(d._visibility&=-3,Nb(h));break;default:Nb(h)}l=l.sibling}}function b8(l,h){for(;Li!==null;){var d=Li;switch(d.tag){case 0:case 11:case 15:Rh(8,d,h);break;case 23:case 22:if(d.memoizedState!==null&&d.memoizedState.cachePool!==null){var p=d.memoizedState.cachePool.pool;p!=null&&p.refCount++}break;case 24:Ov(d.memoizedState.cache)}if(p=d.child,p!==null)p.return=d,Li=p;else e:for(d=l;Li!==null;){p=Li;var S=p.sibling,C=p.return;if(f8(p),p===d){Li=null;break e}if(S!==null){S.return=C,Li=S;break e}Li=C}}}var Fse={getCacheForType:function(l){var h=os(Mi),d=h.data.get(l);return d===void 0&&(d=l(),h.data.set(l,d)),d}},Lse=typeof WeakMap=="function"?WeakMap:Map,Br=0,on=null,Jt=null,hr=0,Vr=0,Oa=null,Ah=!1,$m=!1,dA=!1,hc=0,Fn=0,Oh=0,Cd=0,gA=0,co=0,Um=0,Kv=null,ea=null,mA=!1,pA=0,Hb=1/0,Fb=null,kh=null,Xi=0,Dh=null,jm=null,Ym=0,vA=0,wA=null,C8=null,Xv=0,yA=null;function ka(){if((Br&2)!==0&&hr!==0)return hr&-hr;if(ae.T!==null){var l=Dm;return l!==0?l:RA()}return sd()}function x8(){co===0&&(co=(hr&536870912)===0||Tr?Kn():536870912);var l=uo.current;return l!==null&&(l.flags|=32),co}function Da(l,h,d){(l===on&&(Vr===2||Vr===9)||l.cancelPendingCommit!==null)&&(zm(l,0),Ph(l,hr,co,!1)),Ea(l,d),((Br&2)===0||l!==on)&&(l===on&&((Br&2)===0&&(Cd|=d),Fn===4&&Ph(l,hr,co,!1)),jl(l))}function E8(l,h,d){if((Br&6)!==0)throw Error(n(327));var p=!d&&(h&124)===0&&(h&l.expiredLanes)===0||$t(l,h),S=p?Wse(l,h):CA(l,h,!0),C=p;do{if(S===0){$m&&!p&&Ph(l,h,0,!1);break}else{if(d=l.current.alternate,C&&!Bse(d)){S=CA(l,h,!1),C=!1;continue}if(S===2){if(C=h,l.errorRecoveryDisabledLanes&C)var N=0;else N=l.pendingLanes&-536870913,N=N!==0?N:N&536870912?536870912:0;if(N!==0){h=N;e:{var j=l;S=Kv;var ue=j.current.memoizedState.isDehydrated;if(ue&&(zm(j,N).flags|=256),N=CA(j,N,!1),N!==2){if(dA&&!ue){j.errorRecoveryDisabledLanes|=C,Cd|=C,S=4;break e}C=ea,ea=S,C!==null&&(ea===null?ea=C:ea.push.apply(ea,C))}S=N}if(C=!1,S!==2)continue}}if(S===1){zm(l,0),Ph(l,h,0,!0);break}e:{switch(p=l,C=S,C){case 0:case 1:throw Error(n(345));case 4:if((h&4194048)!==h)break;case 6:Ph(p,h,co,!Ah);break e;case 2:ea=null;break;case 3:case 5:break;default:throw Error(n(329))}if((h&62914560)===h&&(S=pA+300-Q(),10<S)){if(Ph(p,h,co,!Ah),vr(p,0,!0)!==0)break e;p.timeoutHandle=J8(_8.bind(null,p,d,ea,Fb,mA,h,co,Cd,Um,Ah,C,2,-0,0),S);break e}_8(p,d,ea,Fb,mA,h,co,Cd,Um,Ah,C,0,-0,0)}}break}while(!0);jl(l)}function _8(l,h,d,p,S,C,N,j,ue,Oe,Le,We,ke,De){if(l.timeoutHandle=-1,We=h.subtreeFlags,(We&8192||(We&16785408)===16785408)&&(nw={stylesheets:null,count:0,unsuspend:Sae},w8(h),We=Cae(),We!==null)){l.cancelPendingCommit=We(D8.bind(null,l,h,C,d,p,S,N,j,ue,Le,1,ke,De)),Ph(l,C,N,!Oe);return}D8(l,h,C,d,p,S,N,j,ue)}function Bse(l){for(var h=l;;){var d=h.tag;if((d===0||d===11||d===15)&&h.flags&16384&&(d=h.updateQueue,d!==null&&(d=d.stores,d!==null)))for(var p=0;p<d.length;p++){var S=d[p],C=S.getSnapshot;S=S.value;try{if(!Ra(C(),S))return!1}catch{return!1}}if(d=h.child,h.subtreeFlags&16384&&d!==null)d.return=h,h=d;else{if(h===l)break;for(;h.sibling===null;){if(h.return===null||h.return===l)return!0;h=h.return}h.sibling.return=h.return,h=h.sibling}}return!0}function Ph(l,h,d,p){h&=~gA,h&=~Cd,l.suspendedLanes|=h,l.pingedLanes&=~h,p&&(l.warmLanes|=h),p=l.expirationTimes;for(var S=h;0<S;){var C=31-pt(S),N=1<<C;p[C]=-1,S&=~N}d!==0&&wm(l,d,h)}function Lb(){return(Br&6)===0?(Qv(0),!1):!0}function SA(){if(Jt!==null){if(Vr===0)var l=Jt.return;else l=Jt,nc=pd=null,FM(l),Lm=null,Wv=0,l=Jt;for(;l!==null;)i8(l.alternate,l),l=l.return;Jt=null}}function zm(l,h){var d=l.timeoutHandle;d!==-1&&(l.timeoutHandle=-1,nae(d)),d=l.cancelPendingCommit,d!==null&&(l.cancelPendingCommit=null,d()),SA(),on=l,Jt=d=ec(l.current,null),hr=h,Vr=0,Oa=null,Ah=!1,$m=$t(l,h),dA=!1,Um=co=gA=Cd=Oh=Fn=0,ea=Kv=null,mA=!1,(h&8)!==0&&(h|=h&32);var p=l.entangledLanes;if(p!==0)for(l=l.entanglements,p&=h;0<p;){var S=31-pt(p),C=1<<S;h|=l[S],p&=~C}return hc=h,ab(),d}function R8(l,h){zt=null,ae.H=_b,h===Dv||h===mb?(h=UV(),Vr=3):h===VV?(h=UV(),Vr=4):Vr=h===j6?8:h!==null&&typeof h=="object"&&typeof h.then=="function"?6:1,Oa=h,Jt===null&&(Fn=1,Ob(l,so(h,l.current)))}function T8(){var l=ae.H;return ae.H=_b,l===null?_b:l}function M8(){var l=ae.A;return ae.A=Fse,l}function bA(){Fn=4,Ah||(hr&4194048)!==hr&&uo.current!==null||($m=!0),(Oh&134217727)===0&&(Cd&134217727)===0||on===null||Ph(on,hr,co,!1)}function CA(l,h,d){var p=Br;Br|=2;var S=T8(),C=M8();(on!==l||hr!==h)&&(Fb=null,zm(l,h)),h=!1;var N=Fn;e:do try{if(Vr!==0&&Jt!==null){var j=Jt,ue=Oa;switch(Vr){case 8:SA(),N=6;break e;case 3:case 2:case 9:case 6:uo.current===null&&(h=!0);var Oe=Vr;if(Vr=0,Oa=null,Gm(l,j,ue,Oe),d&&$m){N=0;break e}break;default:Oe=Vr,Vr=0,Oa=null,Gm(l,j,ue,Oe)}}Vse(),N=Fn;break}catch(Le){R8(l,Le)}while(!0);return h&&l.shellSuspendCounter++,nc=pd=null,Br=p,ae.H=S,ae.A=C,Jt===null&&(on=null,hr=0,ab()),N}function Vse(){for(;Jt!==null;)A8(Jt)}function Wse(l,h){var d=Br;Br|=2;var p=T8(),S=M8();on!==l||hr!==h?(Fb=null,Hb=Q()+500,zm(l,h)):$m=$t(l,h);e:do try{if(Vr!==0&&Jt!==null){h=Jt;var C=Oa;t:switch(Vr){case 1:Vr=0,Oa=null,Gm(l,h,C,1);break;case 2:case 9:if(WV(C)){Vr=0,Oa=null,O8(h);break}h=function(){Vr!==2&&Vr!==9||on!==l||(Vr=7),jl(l)},C.then(h,h);break e;case 3:Vr=7;break e;case 4:Vr=5;break e;case 7:WV(C)?(Vr=0,Oa=null,O8(h)):(Vr=0,Oa=null,Gm(l,h,C,7));break;case 5:var N=null;switch(Jt.tag){case 26:N=Jt.memoizedState;case 5:case 27:var j=Jt;if(!N||hW(N)){Vr=0,Oa=null;var ue=j.sibling;if(ue!==null)Jt=ue;else{var Oe=j.return;Oe!==null?(Jt=Oe,Bb(Oe)):Jt=null}break t}}Vr=0,Oa=null,Gm(l,h,C,5);break;case 6:Vr=0,Oa=null,Gm(l,h,C,6);break;case 8:SA(),Fn=6;break e;default:throw Error(n(462))}}$se();break}catch(Le){R8(l,Le)}while(!0);return nc=pd=null,ae.H=p,ae.A=S,Br=d,Jt!==null?0:(on=null,hr=0,ab(),Fn)}function $se(){for(;Jt!==null&&!de();)A8(Jt)}function A8(l){var h=r8(l.alternate,l,hc);l.memoizedProps=l.pendingProps,h===null?Bb(l):Jt=h}function O8(l){var h=l,d=h.alternate;switch(h.tag){case 15:case 0:h=X6(d,h,h.pendingProps,h.type,void 0,hr);break;case 11:h=X6(d,h,h.pendingProps,h.type.render,h.ref,hr);break;case 5:FM(h);default:i8(d,h),h=Jt=kV(h,hc),h=r8(d,h,hc)}l.memoizedProps=l.pendingProps,h===null?Bb(l):Jt=h}function Gm(l,h,d,p){nc=pd=null,FM(h),Lm=null,Wv=0;var S=h.return;try{if(kse(l,S,h,d,hr)){Fn=1,Ob(l,so(d,l.current)),Jt=null;return}}catch(C){if(S!==null)throw Jt=S,C;Fn=1,Ob(l,so(d,l.current)),Jt=null;return}h.flags&32768?(Tr||p===1?l=!0:$m||(hr&536870912)!==0?l=!1:(Ah=l=!0,(p===2||p===9||p===3||p===6)&&(p=uo.current,p!==null&&p.tag===13&&(p.flags|=16384))),k8(h,l)):Bb(h)}function Bb(l){var h=l;do{if((h.flags&32768)!==0){k8(h,Ah);return}l=h.return;var d=Pse(h.alternate,h,hc);if(d!==null){Jt=d;return}if(h=h.sibling,h!==null){Jt=h;return}Jt=h=l}while(h!==null);Fn===0&&(Fn=5)}function k8(l,h){do{var d=Ise(l.alternate,l);if(d!==null){d.flags&=32767,Jt=d;return}if(d=l.return,d!==null&&(d.flags|=32768,d.subtreeFlags=0,d.deletions=null),!h&&(l=l.sibling,l!==null)){Jt=l;return}Jt=l=d}while(l!==null);Fn=6,Jt=null}function D8(l,h,d,p,S,C,N,j,ue){l.cancelPendingCommit=null;do Vb();while(Xi!==0);if((Br&6)!==0)throw Error(n(327));if(h!==null){if(h===l.current)throw Error(n(177));if(C=h.lanes|h.childLanes,C|=fM,vh(l,d,C,N,j,ue),l===on&&(Jt=on=null,hr=0),jm=h,Dh=l,Ym=d,vA=C,wA=S,C8=p,(h.subtreeFlags&10256)!==0||(h.flags&10256)!==0?(l.callbackNode=null,l.callbackPriority=0,zse(Ne,function(){return F8(),null})):(l.callbackNode=null,l.callbackPriority=0),p=(h.flags&13878)!==0,(h.subtreeFlags&13878)!==0||p){p=ae.T,ae.T=null,S=le.p,le.p=2,N=Br,Br|=4;try{Nse(l,h,d)}finally{Br=N,le.p=S,ae.T=p}}Xi=1,P8(),I8(),N8()}}function P8(){if(Xi===1){Xi=0;var l=Dh,h=jm,d=(h.flags&13878)!==0;if((h.subtreeFlags&13878)!==0||d){d=ae.T,ae.T=null;var p=le.p;le.p=2;var S=Br;Br|=4;try{m8(h,l);var C=IA,N=bV(l.containerInfo),j=C.focusedElem,ue=C.selectionRange;if(N!==j&&j&&j.ownerDocument&&SV(j.ownerDocument.documentElement,j)){if(ue!==null&&oM(j)){var Oe=ue.start,Le=ue.end;if(Le===void 0&&(Le=Oe),"selectionStart"in j)j.selectionStart=Oe,j.selectionEnd=Math.min(Le,j.value.length);else{var We=j.ownerDocument||document,ke=We&&We.defaultView||window;if(ke.getSelection){var De=ke.getSelection(),At=j.textContent.length,_t=Math.min(ue.start,At),Qr=ue.end===void 0?_t:Math.min(ue.end,At);!De.extend&&_t>Qr&&(N=Qr,Qr=_t,_t=N);var Ee=yV(j,_t),ye=yV(j,Qr);if(Ee&&ye&&(De.rangeCount!==1||De.anchorNode!==Ee.node||De.anchorOffset!==Ee.offset||De.focusNode!==ye.node||De.focusOffset!==ye.offset)){var Me=We.createRange();Me.setStart(Ee.node,Ee.offset),De.removeAllRanges(),_t>Qr?(De.addRange(Me),De.extend(ye.node,ye.offset)):(Me.setEnd(ye.node,ye.offset),De.addRange(Me))}}}}for(We=[],De=j;De=De.parentNode;)De.nodeType===1&&We.push({element:De,left:De.scrollLeft,top:De.scrollTop});for(typeof j.focus=="function"&&j.focus(),j=0;j<We.length;j++){var Be=We[j];Be.element.scrollLeft=Be.left,Be.element.scrollTop=Be.top}}Zb=!!PA,IA=PA=null}finally{Br=S,le.p=p,ae.T=d}}l.current=h,Xi=2}}function I8(){if(Xi===2){Xi=0;var l=Dh,h=jm,d=(h.flags&8772)!==0;if((h.subtreeFlags&8772)!==0||d){d=ae.T,ae.T=null;var p=le.p;le.p=2;var S=Br;Br|=4;try{h8(l,h.alternate,h)}finally{Br=S,le.p=p,ae.T=d}}Xi=3}}function N8(){if(Xi===4||Xi===3){Xi=0,pe();var l=Dh,h=jm,d=Ym,p=C8;(h.subtreeFlags&10256)!==0||(h.flags&10256)!==0?Xi=5:(Xi=0,jm=Dh=null,H8(l,l.pendingLanes));var S=l.pendingLanes;if(S===0&&(kh=null),id(d),h=h.stateNode,at&&typeof at.onCommitFiberRoot=="function")try{at.onCommitFiberRoot(Et,h,void 0,(h.current.flags&128)===128)}catch{}if(p!==null){h=ae.T,S=le.p,le.p=2,ae.T=null;try{for(var C=l.onRecoverableError,N=0;N<p.length;N++){var j=p[N];C(j.value,{componentStack:j.stack})}}finally{ae.T=h,le.p=S}}(Ym&3)!==0&&Vb(),jl(l),S=l.pendingLanes,(d&4194090)!==0&&(S&42)!==0?l===yA?Xv++:(Xv=0,yA=l):Xv=0,Qv(0)}}function H8(l,h){(l.pooledCacheLanes&=h)===0&&(h=l.pooledCache,h!=null&&(l.pooledCache=null,Ov(h)))}function Vb(l){return P8(),I8(),N8(),F8()}function F8(){if(Xi!==5)return!1;var l=Dh,h=vA;vA=0;var d=id(Ym),p=ae.T,S=le.p;try{le.p=32>d?32:d,ae.T=null,d=wA,wA=null;var C=Dh,N=Ym;if(Xi=0,jm=Dh=null,Ym=0,(Br&6)!==0)throw Error(n(331));var j=Br;if(Br|=4,S8(C.current),v8(C,C.current,N,d),Br=j,Qv(0,!1),at&&typeof at.onPostCommitFiberRoot=="function")try{at.onPostCommitFiberRoot(Et,C)}catch{}return!0}finally{le.p=S,ae.T=p,H8(l,h)}}function L8(l,h,d){h=so(d,h),h=QM(l.stateNode,h,2),l=Ch(l,h,2),l!==null&&(Ea(l,2),jl(l))}function en(l,h,d){if(l.tag===3)L8(l,l,d);else for(;h!==null;){if(h.tag===3){L8(h,l,d);break}else if(h.tag===1){var p=h.stateNode;if(typeof h.type.getDerivedStateFromError=="function"||typeof p.componentDidCatch=="function"&&(kh===null||!kh.has(p))){l=so(d,l),d=$6(2),p=Ch(h,d,2),p!==null&&(U6(d,p,h,l),Ea(p,2),jl(p));break}}h=h.return}}function xA(l,h,d){var p=l.pingCache;if(p===null){p=l.pingCache=new Lse;var S=new Set;p.set(h,S)}else S=p.get(h),S===void 0&&(S=new Set,p.set(h,S));S.has(d)||(dA=!0,S.add(d),l=Use.bind(null,l,h,d),h.then(l,l))}function Use(l,h,d){var p=l.pingCache;p!==null&&p.delete(h),l.pingedLanes|=l.suspendedLanes&d,l.warmLanes&=~d,on===l&&(hr&d)===d&&(Fn===4||Fn===3&&(hr&62914560)===hr&&300>Q()-pA?(Br&2)===0&&zm(l,0):gA|=d,Um===hr&&(Um=0)),jl(l)}function B8(l,h){h===0&&(h=xa()),l=Mm(l,h),l!==null&&(Ea(l,h),jl(l))}function jse(l){var h=l.memoizedState,d=0;h!==null&&(d=h.retryLane),B8(l,d)}function Yse(l,h){var d=0;switch(l.tag){case 13:var p=l.stateNode,S=l.memoizedState;S!==null&&(d=S.retryLane);break;case 19:p=l.stateNode;break;case 22:p=l.stateNode._retryCache;break;default:throw Error(n(314))}p!==null&&p.delete(h),B8(l,d)}function zse(l,h){return ee(l,h)}var Wb=null,qm=null,EA=!1,$b=!1,_A=!1,xd=0;function jl(l){l!==qm&&l.next===null&&(qm===null?Wb=qm=l:qm=qm.next=l),$b=!0,EA||(EA=!0,qse())}function Qv(l,h){if(!_A&&$b){_A=!0;do for(var d=!1,p=Wb;p!==null;){if(l!==0){var S=p.pendingLanes;if(S===0)var C=0;else{var N=p.suspendedLanes,j=p.pingedLanes;C=(1<<31-pt(42|l)+1)-1,C&=S&~(N&~j),C=C&201326741?C&201326741|1:C?C|2:0}C!==0&&(d=!0,U8(p,C))}else C=hr,C=vr(p,p===on?C:0,p.cancelPendingCommit!==null||p.timeoutHandle!==-1),(C&3)===0||$t(p,C)||(d=!0,U8(p,C));p=p.next}while(d);_A=!1}}function Gse(){V8()}function V8(){$b=EA=!1;var l=0;xd!==0&&(rae()&&(l=xd),xd=0);for(var h=Q(),d=null,p=Wb;p!==null;){var S=p.next,C=W8(p,h);C===0?(p.next=null,d===null?Wb=S:d.next=S,S===null&&(qm=d)):(d=p,(l!==0||(C&3)!==0)&&($b=!0)),p=S}Qv(l)}function W8(l,h){for(var d=l.suspendedLanes,p=l.pingedLanes,S=l.expirationTimes,C=l.pendingLanes&-62914561;0<C;){var N=31-pt(C),j=1<<N,ue=S[N];ue===-1?((j&d)===0||(j&p)!==0)&&(S[N]=qi(j,h)):ue<=h&&(l.expiredLanes|=j),C&=~j}if(h=on,d=hr,d=vr(l,l===h?d:0,l.cancelPendingCommit!==null||l.timeoutHandle!==-1),p=l.callbackNode,d===0||l===h&&(Vr===2||Vr===9)||l.cancelPendingCommit!==null)return p!==null&&p!==null&&oe(p),l.callbackNode=null,l.callbackPriority=0;if((d&3)===0||$t(l,d)){if(h=d&-d,h===l.callbackPriority)return h;switch(p!==null&&oe(p),id(d)){case 2:case 8:d=_e;break;case 32:d=Ne;break;case 268435456:d=Qe;break;default:d=Ne}return p=$8.bind(null,l),d=ee(d,p),l.callbackPriority=h,l.callbackNode=d,h}return p!==null&&p!==null&&oe(p),l.callbackPriority=2,l.callbackNode=null,2}function $8(l,h){if(Xi!==0&&Xi!==5)return l.callbackNode=null,l.callbackPriority=0,null;var d=l.callbackNode;if(Vb()&&l.callbackNode!==d)return null;var p=hr;return p=vr(l,l===on?p:0,l.cancelPendingCommit!==null||l.timeoutHandle!==-1),p===0?null:(E8(l,p,h),W8(l,Q()),l.callbackNode!=null&&l.callbackNode===d?$8.bind(null,l):null)}function U8(l,h){if(Vb())return null;E8(l,h,!0)}function qse(){iae(function(){(Br&6)!==0?ee(xe,Gse):V8()})}function RA(){return xd===0&&(xd=Kn()),xd}function j8(l){return l==null||typeof l=="symbol"||typeof l=="boolean"?null:typeof l=="function"?l:JS(""+l)}function Y8(l,h){var d=h.ownerDocument.createElement("input");return d.name=h.name,d.value=h.value,l.id&&d.setAttribute("form",l.id),h.parentNode.insertBefore(d,h),l=new FormData(l),d.parentNode.removeChild(d),l}function Kse(l,h,d,p,S){if(h==="submit"&&d&&d.stateNode===S){var C=j8((S[fi]||null).action),N=p.submitter;N&&(h=(h=N[fi]||null)?j8(h.formAction):N.getAttribute("formAction"),h!==null&&(C=h,N=null));var j=new nb("action","action",null,p,S);l.push({event:j,listeners:[{instance:null,listener:function(){if(p.defaultPrevented){if(xd!==0){var ue=N?Y8(S,N):new FormData(S);zM(d,{pending:!0,data:ue,method:S.method,action:C},null,ue)}}else typeof C=="function"&&(j.preventDefault(),ue=N?Y8(S,N):new FormData(S),zM(d,{pending:!0,data:ue,method:S.method,action:C},C,ue))},currentTarget:S}]})}}for(var TA=0;TA<hM.length;TA++){var MA=hM[TA],Xse=MA.toLowerCase(),Qse=MA[0].toUpperCase()+MA.slice(1);il(Xse,"on"+Qse)}il(EV,"onAnimationEnd"),il(_V,"onAnimationIteration"),il(RV,"onAnimationStart"),il("dblclick","onDoubleClick"),il("focusin","onFocus"),il("focusout","onBlur"),il(gse,"onTransitionRun"),il(mse,"onTransitionStart"),il(pse,"onTransitionCancel"),il(TV,"onTransitionEnd"),Pe("onMouseEnter",["mouseout","mouseover"]),Pe("onMouseLeave",["mouseout","mouseover"]),Pe("onPointerEnter",["pointerout","pointerover"]),Pe("onPointerLeave",["pointerout","pointerover"]),Ce("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Ce("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Ce("onBeforeInput",["compositionend","keypress","textInput","paste"]),Ce("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Ce("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Ce("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Zv="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Zse=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Zv));function z8(l,h){h=(h&4)!==0;for(var d=0;d<l.length;d++){var p=l[d],S=p.event;p=p.listeners;e:{var C=void 0;if(h)for(var N=p.length-1;0<=N;N--){var j=p[N],ue=j.instance,Oe=j.currentTarget;if(j=j.listener,ue!==C&&S.isPropagationStopped())break e;C=j,S.currentTarget=Oe;try{C(S)}catch(Le){Ab(Le)}S.currentTarget=null,C=ue}else for(N=0;N<p.length;N++){if(j=p[N],ue=j.instance,Oe=j.currentTarget,j=j.listener,ue!==C&&S.isPropagationStopped())break e;C=j,S.currentTarget=Oe;try{C(S)}catch(Le){Ab(Le)}S.currentTarget=null,C=ue}}}}function er(l,h){var d=h[ro];d===void 0&&(d=h[ro]=new Set);var p=l+"__bubble";d.has(p)||(G8(h,l,2,!1),d.add(p))}function AA(l,h,d){var p=0;h&&(p|=4),G8(d,l,p,h)}var Ub="_reactListening"+Math.random().toString(36).slice(2);function OA(l){if(!l[Ub]){l[Ub]=!0,me.forEach(function(d){d!=="selectionchange"&&(Zse.has(d)||AA(d,!1,l),AA(d,!0,l))});var h=l.nodeType===9?l:l.ownerDocument;h===null||h[Ub]||(h[Ub]=!0,AA("selectionchange",!1,h))}}function G8(l,h,d,p){switch(vW(h)){case 2:var S=_ae;break;case 8:S=Rae;break;default:S=jA}d=S.bind(null,h,d,l),S=void 0,!ZT||h!=="touchstart"&&h!=="touchmove"&&h!=="wheel"||(S=!0),p?S!==void 0?l.addEventListener(h,d,{capture:!0,passive:S}):l.addEventListener(h,d,!0):S!==void 0?l.addEventListener(h,d,{passive:S}):l.addEventListener(h,d,!1)}function kA(l,h,d,p,S){var C=p;if((h&1)===0&&(h&2)===0&&p!==null)e:for(;;){if(p===null)return;var N=p.tag;if(N===3||N===4){var j=p.stateNode.containerInfo;if(j===S)break;if(N===4)for(N=p.return;N!==null;){var ue=N.tag;if((ue===3||ue===4)&&N.stateNode.containerInfo===S)return;N=N.return}for(;j!==null;){if(N=ne(j),N===null)return;if(ue=N.tag,ue===5||ue===6||ue===26||ue===27){p=C=N;continue e}j=j.parentNode}}p=p.return}eV(function(){var Oe=C,Le=XT(d),We=[];e:{var ke=MV.get(l);if(ke!==void 0){var De=nb,At=l;switch(l){case"keypress":if(tb(d)===0)break e;case"keydown":case"keyup":De=zie;break;case"focusin":At="focus",De=rM;break;case"focusout":At="blur",De=rM;break;case"beforeblur":case"afterblur":De=rM;break;case"click":if(d.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":De=nV;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":De=Iie;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":De=Kie;break;case EV:case _V:case RV:De=Fie;break;case TV:De=Qie;break;case"scroll":case"scrollend":De=Die;break;case"wheel":De=Jie;break;case"copy":case"cut":case"paste":De=Bie;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":De=sV;break;case"toggle":case"beforetoggle":De=tse}var _t=(h&4)!==0,Qr=!_t&&(l==="scroll"||l==="scrollend"),Ee=_t?ke!==null?ke+"Capture":null:ke;_t=[];for(var ye=Oe,Me;ye!==null;){var Be=ye;if(Me=Be.stateNode,Be=Be.tag,Be!==5&&Be!==26&&Be!==27||Me===null||Ee===null||(Be=vv(ye,Ee),Be!=null&&_t.push(Jv(ye,Be,Me))),Qr)break;ye=ye.return}0<_t.length&&(ke=new De(ke,At,null,d,Le),We.push({event:ke,listeners:_t}))}}if((h&7)===0){e:{if(ke=l==="mouseover"||l==="pointerover",De=l==="mouseout"||l==="pointerout",ke&&d!==KT&&(At=d.relatedTarget||d.fromElement)&&(ne(At)||At[Ti]))break e;if((De||ke)&&(ke=Le.window===Le?Le:(ke=Le.ownerDocument)?ke.defaultView||ke.parentWindow:window,De?(At=d.relatedTarget||d.toElement,De=Oe,At=At?ne(At):null,At!==null&&(Qr=s(At),_t=At.tag,At!==Qr||_t!==5&&_t!==27&&_t!==6)&&(At=null)):(De=null,At=Oe),De!==At)){if(_t=nV,Be="onMouseLeave",Ee="onMouseEnter",ye="mouse",(l==="pointerout"||l==="pointerover")&&(_t=sV,Be="onPointerLeave",Ee="onPointerEnter",ye="pointer"),Qr=De==null?ke:Ae(De),Me=At==null?ke:Ae(At),ke=new _t(Be,ye+"leave",De,d,Le),ke.target=Qr,ke.relatedTarget=Me,Be=null,ne(Le)===Oe&&(_t=new _t(Ee,ye+"enter",At,d,Le),_t.target=Me,_t.relatedTarget=Qr,Be=_t),Qr=Be,De&&At)t:{for(_t=De,Ee=At,ye=0,Me=_t;Me;Me=Km(Me))ye++;for(Me=0,Be=Ee;Be;Be=Km(Be))Me++;for(;0<ye-Me;)_t=Km(_t),ye--;for(;0<Me-ye;)Ee=Km(Ee),Me--;for(;ye--;){if(_t===Ee||Ee!==null&&_t===Ee.alternate)break t;_t=Km(_t),Ee=Km(Ee)}_t=null}else _t=null;De!==null&&q8(We,ke,De,_t,!1),At!==null&&Qr!==null&&q8(We,Qr,At,_t,!0)}}e:{if(ke=Oe?Ae(Oe):window,De=ke.nodeName&&ke.nodeName.toLowerCase(),De==="select"||De==="input"&&ke.type==="file")var lt=dV;else if(hV(ke))if(gV)lt=hse;else{lt=use;var Qt=lse}else De=ke.nodeName,!De||De.toLowerCase()!=="input"||ke.type!=="checkbox"&&ke.type!=="radio"?Oe&&qT(Oe.elementType)&&(lt=dV):lt=cse;if(lt&&(lt=lt(l,Oe))){fV(We,lt,d,Le);break e}Qt&&Qt(l,ke,Oe),l==="focusout"&&Oe&&ke.type==="number"&&Oe.memoizedProps.value!=null&&GT(ke,"number",ke.value)}switch(Qt=Oe?Ae(Oe):window,l){case"focusin":(hV(Qt)||Qt.contentEditable==="true")&&(_m=Qt,lM=Oe,_v=null);break;case"focusout":_v=lM=_m=null;break;case"mousedown":uM=!0;break;case"contextmenu":case"mouseup":case"dragend":uM=!1,CV(We,d,Le);break;case"selectionchange":if(dse)break;case"keydown":case"keyup":CV(We,d,Le)}var mt;if(iM)e:{switch(l){case"compositionstart":var Rt="onCompositionStart";break e;case"compositionend":Rt="onCompositionEnd";break e;case"compositionupdate":Rt="onCompositionUpdate";break e}Rt=void 0}else Em?uV(l,d)&&(Rt="onCompositionEnd"):l==="keydown"&&d.keyCode===229&&(Rt="onCompositionStart");Rt&&(aV&&d.locale!=="ko"&&(Em||Rt!=="onCompositionStart"?Rt==="onCompositionEnd"&&Em&&(mt=tV()):(wh=Le,JT="value"in wh?wh.value:wh.textContent,Em=!0)),Qt=jb(Oe,Rt),0<Qt.length&&(Rt=new iV(Rt,l,null,d,Le),We.push({event:Rt,listeners:Qt}),mt?Rt.data=mt:(mt=cV(d),mt!==null&&(Rt.data=mt)))),(mt=nse?ise(l,d):sse(l,d))&&(Rt=jb(Oe,"onBeforeInput"),0<Rt.length&&(Qt=new iV("onBeforeInput","beforeinput",null,d,Le),We.push({event:Qt,listeners:Rt}),Qt.data=mt)),Kse(We,l,Oe,d,Le)}z8(We,h)})}function Jv(l,h,d){return{instance:l,listener:h,currentTarget:d}}function jb(l,h){for(var d=h+"Capture",p=[];l!==null;){var S=l,C=S.stateNode;if(S=S.tag,S!==5&&S!==26&&S!==27||C===null||(S=vv(l,d),S!=null&&p.unshift(Jv(l,S,C)),S=vv(l,h),S!=null&&p.push(Jv(l,S,C))),l.tag===3)return p;l=l.return}return[]}function Km(l){if(l===null)return null;do l=l.return;while(l&&l.tag!==5&&l.tag!==27);return l||null}function q8(l,h,d,p,S){for(var C=h._reactName,N=[];d!==null&&d!==p;){var j=d,ue=j.alternate,Oe=j.stateNode;if(j=j.tag,ue!==null&&ue===p)break;j!==5&&j!==26&&j!==27||Oe===null||(ue=Oe,S?(Oe=vv(d,C),Oe!=null&&N.unshift(Jv(d,Oe,ue))):S||(Oe=vv(d,C),Oe!=null&&N.push(Jv(d,Oe,ue)))),d=d.return}N.length!==0&&l.push({event:h,listeners:N})}var Jse=/\r\n?/g,eae=/\u0000|\uFFFD/g;function K8(l){return(typeof l=="string"?l:""+l).replace(Jse,`
`).replace(eae,"")}function X8(l,h){return h=K8(h),K8(l)===h}function Yb(){}function Xr(l,h,d,p,S,C){switch(d){case"children":typeof p=="string"?h==="body"||h==="textarea"&&p===""||bm(l,p):(typeof p=="number"||typeof p=="bigint")&&h!=="body"&&bm(l,""+p);break;case"className":cr(l,"class",p);break;case"tabIndex":cr(l,"tabindex",p);break;case"dir":case"role":case"viewBox":case"width":case"height":cr(l,d,p);break;case"style":ZB(l,p,C);break;case"data":if(h!=="object"){cr(l,"data",p);break}case"src":case"href":if(p===""&&(h!=="a"||d!=="href")){l.removeAttribute(d);break}if(p==null||typeof p=="function"||typeof p=="symbol"||typeof p=="boolean"){l.removeAttribute(d);break}p=JS(""+p),l.setAttribute(d,p);break;case"action":case"formAction":if(typeof p=="function"){l.setAttribute(d,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof C=="function"&&(d==="formAction"?(h!=="input"&&Xr(l,h,"name",S.name,S,null),Xr(l,h,"formEncType",S.formEncType,S,null),Xr(l,h,"formMethod",S.formMethod,S,null),Xr(l,h,"formTarget",S.formTarget,S,null)):(Xr(l,h,"encType",S.encType,S,null),Xr(l,h,"method",S.method,S,null),Xr(l,h,"target",S.target,S,null)));if(p==null||typeof p=="symbol"||typeof p=="boolean"){l.removeAttribute(d);break}p=JS(""+p),l.setAttribute(d,p);break;case"onClick":p!=null&&(l.onclick=Yb);break;case"onScroll":p!=null&&er("scroll",l);break;case"onScrollEnd":p!=null&&er("scrollend",l);break;case"dangerouslySetInnerHTML":if(p!=null){if(typeof p!="object"||!("__html"in p))throw Error(n(61));if(d=p.__html,d!=null){if(S.children!=null)throw Error(n(60));l.innerHTML=d}}break;case"multiple":l.multiple=p&&typeof p!="function"&&typeof p!="symbol";break;case"muted":l.muted=p&&typeof p!="function"&&typeof p!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(p==null||typeof p=="function"||typeof p=="boolean"||typeof p=="symbol"){l.removeAttribute("xlink:href");break}d=JS(""+p),l.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",d);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":p!=null&&typeof p!="function"&&typeof p!="symbol"?l.setAttribute(d,""+p):l.removeAttribute(d);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":p&&typeof p!="function"&&typeof p!="symbol"?l.setAttribute(d,""):l.removeAttribute(d);break;case"capture":case"download":p===!0?l.setAttribute(d,""):p!==!1&&p!=null&&typeof p!="function"&&typeof p!="symbol"?l.setAttribute(d,p):l.removeAttribute(d);break;case"cols":case"rows":case"size":case"span":p!=null&&typeof p!="function"&&typeof p!="symbol"&&!isNaN(p)&&1<=p?l.setAttribute(d,p):l.removeAttribute(d);break;case"rowSpan":case"start":p==null||typeof p=="function"||typeof p=="symbol"||isNaN(p)?l.removeAttribute(d):l.setAttribute(d,p);break;case"popover":er("beforetoggle",l),er("toggle",l),Xt(l,"popover",p);break;case"xlinkActuate":Ir(l,"http://www.w3.org/1999/xlink","xlink:actuate",p);break;case"xlinkArcrole":Ir(l,"http://www.w3.org/1999/xlink","xlink:arcrole",p);break;case"xlinkRole":Ir(l,"http://www.w3.org/1999/xlink","xlink:role",p);break;case"xlinkShow":Ir(l,"http://www.w3.org/1999/xlink","xlink:show",p);break;case"xlinkTitle":Ir(l,"http://www.w3.org/1999/xlink","xlink:title",p);break;case"xlinkType":Ir(l,"http://www.w3.org/1999/xlink","xlink:type",p);break;case"xmlBase":Ir(l,"http://www.w3.org/XML/1998/namespace","xml:base",p);break;case"xmlLang":Ir(l,"http://www.w3.org/XML/1998/namespace","xml:lang",p);break;case"xmlSpace":Ir(l,"http://www.w3.org/XML/1998/namespace","xml:space",p);break;case"is":Xt(l,"is",p);break;case"innerText":case"textContent":break;default:(!(2<d.length)||d[0]!=="o"&&d[0]!=="O"||d[1]!=="n"&&d[1]!=="N")&&(d=Oie.get(d)||d,Xt(l,d,p))}}function DA(l,h,d,p,S,C){switch(d){case"style":ZB(l,p,C);break;case"dangerouslySetInnerHTML":if(p!=null){if(typeof p!="object"||!("__html"in p))throw Error(n(61));if(d=p.__html,d!=null){if(S.children!=null)throw Error(n(60));l.innerHTML=d}}break;case"children":typeof p=="string"?bm(l,p):(typeof p=="number"||typeof p=="bigint")&&bm(l,""+p);break;case"onScroll":p!=null&&er("scroll",l);break;case"onScrollEnd":p!=null&&er("scrollend",l);break;case"onClick":p!=null&&(l.onclick=Yb);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!z.hasOwnProperty(d))e:{if(d[0]==="o"&&d[1]==="n"&&(S=d.endsWith("Capture"),h=d.slice(2,S?d.length-7:void 0),C=l[fi]||null,C=C!=null?C[d]:null,typeof C=="function"&&l.removeEventListener(h,C,S),typeof p=="function")){typeof C!="function"&&C!==null&&(d in l?l[d]=null:l.hasAttribute(d)&&l.removeAttribute(d)),l.addEventListener(h,p,S);break e}d in l?l[d]=p:p===!0?l.setAttribute(d,""):Xt(l,d,p)}}}function Qi(l,h,d){switch(h){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":er("error",l),er("load",l);var p=!1,S=!1,C;for(C in d)if(d.hasOwnProperty(C)){var N=d[C];if(N!=null)switch(C){case"src":p=!0;break;case"srcSet":S=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(n(137,h));default:Xr(l,h,C,N,d,null)}}S&&Xr(l,h,"srcSet",d.srcSet,d,null),p&&Xr(l,h,"src",d.src,d,null);return;case"input":er("invalid",l);var j=C=N=S=null,ue=null,Oe=null;for(p in d)if(d.hasOwnProperty(p)){var Le=d[p];if(Le!=null)switch(p){case"name":S=Le;break;case"type":N=Le;break;case"checked":ue=Le;break;case"defaultChecked":Oe=Le;break;case"value":C=Le;break;case"defaultValue":j=Le;break;case"children":case"dangerouslySetInnerHTML":if(Le!=null)throw Error(n(137,h));break;default:Xr(l,h,p,Le,d,null)}}qB(l,C,j,ue,Oe,N,S,!1),QS(l);return;case"select":er("invalid",l),p=N=C=null;for(S in d)if(d.hasOwnProperty(S)&&(j=d[S],j!=null))switch(S){case"value":C=j;break;case"defaultValue":N=j;break;case"multiple":p=j;default:Xr(l,h,S,j,d,null)}h=C,d=N,l.multiple=!!p,h!=null?Sm(l,!!p,h,!1):d!=null&&Sm(l,!!p,d,!0);return;case"textarea":er("invalid",l),C=S=p=null;for(N in d)if(d.hasOwnProperty(N)&&(j=d[N],j!=null))switch(N){case"value":p=j;break;case"defaultValue":S=j;break;case"children":C=j;break;case"dangerouslySetInnerHTML":if(j!=null)throw Error(n(91));break;default:Xr(l,h,N,j,d,null)}XB(l,p,S,C),QS(l);return;case"option":for(ue in d)if(d.hasOwnProperty(ue)&&(p=d[ue],p!=null))switch(ue){case"selected":l.selected=p&&typeof p!="function"&&typeof p!="symbol";break;default:Xr(l,h,ue,p,d,null)}return;case"dialog":er("beforetoggle",l),er("toggle",l),er("cancel",l),er("close",l);break;case"iframe":case"object":er("load",l);break;case"video":case"audio":for(p=0;p<Zv.length;p++)er(Zv[p],l);break;case"image":er("error",l),er("load",l);break;case"details":er("toggle",l);break;case"embed":case"source":case"link":er("error",l),er("load",l);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Oe in d)if(d.hasOwnProperty(Oe)&&(p=d[Oe],p!=null))switch(Oe){case"children":case"dangerouslySetInnerHTML":throw Error(n(137,h));default:Xr(l,h,Oe,p,d,null)}return;default:if(qT(h)){for(Le in d)d.hasOwnProperty(Le)&&(p=d[Le],p!==void 0&&DA(l,h,Le,p,d,void 0));return}}for(j in d)d.hasOwnProperty(j)&&(p=d[j],p!=null&&Xr(l,h,j,p,d,null))}function tae(l,h,d,p){switch(h){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var S=null,C=null,N=null,j=null,ue=null,Oe=null,Le=null;for(De in d){var We=d[De];if(d.hasOwnProperty(De)&&We!=null)switch(De){case"checked":break;case"value":break;case"defaultValue":ue=We;default:p.hasOwnProperty(De)||Xr(l,h,De,null,p,We)}}for(var ke in p){var De=p[ke];if(We=d[ke],p.hasOwnProperty(ke)&&(De!=null||We!=null))switch(ke){case"type":C=De;break;case"name":S=De;break;case"checked":Oe=De;break;case"defaultChecked":Le=De;break;case"value":N=De;break;case"defaultValue":j=De;break;case"children":case"dangerouslySetInnerHTML":if(De!=null)throw Error(n(137,h));break;default:De!==We&&Xr(l,h,ke,De,p,We)}}zT(l,N,j,ue,Oe,Le,C,S);return;case"select":De=N=j=ke=null;for(C in d)if(ue=d[C],d.hasOwnProperty(C)&&ue!=null)switch(C){case"value":break;case"multiple":De=ue;default:p.hasOwnProperty(C)||Xr(l,h,C,null,p,ue)}for(S in p)if(C=p[S],ue=d[S],p.hasOwnProperty(S)&&(C!=null||ue!=null))switch(S){case"value":ke=C;break;case"defaultValue":j=C;break;case"multiple":N=C;default:C!==ue&&Xr(l,h,S,C,p,ue)}h=j,d=N,p=De,ke!=null?Sm(l,!!d,ke,!1):!!p!=!!d&&(h!=null?Sm(l,!!d,h,!0):Sm(l,!!d,d?[]:"",!1));return;case"textarea":De=ke=null;for(j in d)if(S=d[j],d.hasOwnProperty(j)&&S!=null&&!p.hasOwnProperty(j))switch(j){case"value":break;case"children":break;default:Xr(l,h,j,null,p,S)}for(N in p)if(S=p[N],C=d[N],p.hasOwnProperty(N)&&(S!=null||C!=null))switch(N){case"value":ke=S;break;case"defaultValue":De=S;break;case"children":break;case"dangerouslySetInnerHTML":if(S!=null)throw Error(n(91));break;default:S!==C&&Xr(l,h,N,S,p,C)}KB(l,ke,De);return;case"option":for(var At in d)if(ke=d[At],d.hasOwnProperty(At)&&ke!=null&&!p.hasOwnProperty(At))switch(At){case"selected":l.selected=!1;break;default:Xr(l,h,At,null,p,ke)}for(ue in p)if(ke=p[ue],De=d[ue],p.hasOwnProperty(ue)&&ke!==De&&(ke!=null||De!=null))switch(ue){case"selected":l.selected=ke&&typeof ke!="function"&&typeof ke!="symbol";break;default:Xr(l,h,ue,ke,p,De)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var _t in d)ke=d[_t],d.hasOwnProperty(_t)&&ke!=null&&!p.hasOwnProperty(_t)&&Xr(l,h,_t,null,p,ke);for(Oe in p)if(ke=p[Oe],De=d[Oe],p.hasOwnProperty(Oe)&&ke!==De&&(ke!=null||De!=null))switch(Oe){case"children":case"dangerouslySetInnerHTML":if(ke!=null)throw Error(n(137,h));break;default:Xr(l,h,Oe,ke,p,De)}return;default:if(qT(h)){for(var Qr in d)ke=d[Qr],d.hasOwnProperty(Qr)&&ke!==void 0&&!p.hasOwnProperty(Qr)&&DA(l,h,Qr,void 0,p,ke);for(Le in p)ke=p[Le],De=d[Le],!p.hasOwnProperty(Le)||ke===De||ke===void 0&&De===void 0||DA(l,h,Le,ke,p,De);return}}for(var Ee in d)ke=d[Ee],d.hasOwnProperty(Ee)&&ke!=null&&!p.hasOwnProperty(Ee)&&Xr(l,h,Ee,null,p,ke);for(We in p)ke=p[We],De=d[We],!p.hasOwnProperty(We)||ke===De||ke==null&&De==null||Xr(l,h,We,ke,p,De)}var PA=null,IA=null;function zb(l){return l.nodeType===9?l:l.ownerDocument}function Q8(l){switch(l){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Z8(l,h){if(l===0)switch(h){case"svg":return 1;case"math":return 2;default:return 0}return l===1&&h==="foreignObject"?0:l}function NA(l,h){return l==="textarea"||l==="noscript"||typeof h.children=="string"||typeof h.children=="number"||typeof h.children=="bigint"||typeof h.dangerouslySetInnerHTML=="object"&&h.dangerouslySetInnerHTML!==null&&h.dangerouslySetInnerHTML.__html!=null}var HA=null;function rae(){var l=window.event;return l&&l.type==="popstate"?l===HA?!1:(HA=l,!0):(HA=null,!1)}var J8=typeof setTimeout=="function"?setTimeout:void 0,nae=typeof clearTimeout=="function"?clearTimeout:void 0,eW=typeof Promise=="function"?Promise:void 0,iae=typeof queueMicrotask=="function"?queueMicrotask:typeof eW<"u"?function(l){return eW.resolve(null).then(l).catch(sae)}:J8;function sae(l){setTimeout(function(){throw l})}function Ih(l){return l==="head"}function tW(l,h){var d=h,p=0,S=0;do{var C=d.nextSibling;if(l.removeChild(d),C&&C.nodeType===8)if(d=C.data,d==="/$"){if(0<p&&8>p){d=p;var N=l.ownerDocument;if(d&1&&ew(N.documentElement),d&2&&ew(N.body),d&4)for(d=N.head,ew(d),N=d.firstChild;N;){var j=N.nextSibling,ue=N.nodeName;N[q]||ue==="SCRIPT"||ue==="STYLE"||ue==="LINK"&&N.rel.toLowerCase()==="stylesheet"||d.removeChild(N),N=j}}if(S===0){l.removeChild(C),lw(h);return}S--}else d==="$"||d==="$?"||d==="$!"?S++:p=d.charCodeAt(0)-48;else p=0;d=C}while(d);lw(h)}function FA(l){var h=l.firstChild;for(h&&h.nodeType===10&&(h=h.nextSibling);h;){var d=h;switch(h=h.nextSibling,d.nodeName){case"HTML":case"HEAD":case"BODY":FA(d),X(d);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(d.rel.toLowerCase()==="stylesheet")continue}l.removeChild(d)}}function aae(l,h,d,p){for(;l.nodeType===1;){var S=d;if(l.nodeName.toLowerCase()!==h.toLowerCase()){if(!p&&(l.nodeName!=="INPUT"||l.type!=="hidden"))break}else if(p){if(!l[q])switch(h){case"meta":if(!l.hasAttribute("itemprop"))break;return l;case"link":if(C=l.getAttribute("rel"),C==="stylesheet"&&l.hasAttribute("data-precedence"))break;if(C!==S.rel||l.getAttribute("href")!==(S.href==null||S.href===""?null:S.href)||l.getAttribute("crossorigin")!==(S.crossOrigin==null?null:S.crossOrigin)||l.getAttribute("title")!==(S.title==null?null:S.title))break;return l;case"style":if(l.hasAttribute("data-precedence"))break;return l;case"script":if(C=l.getAttribute("src"),(C!==(S.src==null?null:S.src)||l.getAttribute("type")!==(S.type==null?null:S.type)||l.getAttribute("crossorigin")!==(S.crossOrigin==null?null:S.crossOrigin))&&C&&l.hasAttribute("async")&&!l.hasAttribute("itemprop"))break;return l;default:return l}}else if(h==="input"&&l.type==="hidden"){var C=S.name==null?null:""+S.name;if(S.type==="hidden"&&l.getAttribute("name")===C)return l}else return l;if(l=al(l.nextSibling),l===null)break}return null}function oae(l,h,d){if(h==="")return null;for(;l.nodeType!==3;)if((l.nodeType!==1||l.nodeName!=="INPUT"||l.type!=="hidden")&&!d||(l=al(l.nextSibling),l===null))return null;return l}function LA(l){return l.data==="$!"||l.data==="$?"&&l.ownerDocument.readyState==="complete"}function lae(l,h){var d=l.ownerDocument;if(l.data!=="$?"||d.readyState==="complete")h();else{var p=function(){h(),d.removeEventListener("DOMContentLoaded",p)};d.addEventListener("DOMContentLoaded",p),l._reactRetry=p}}function al(l){for(;l!=null;l=l.nextSibling){var h=l.nodeType;if(h===1||h===3)break;if(h===8){if(h=l.data,h==="$"||h==="$!"||h==="$?"||h==="F!"||h==="F")break;if(h==="/$")return null}}return l}var BA=null;function rW(l){l=l.previousSibling;for(var h=0;l;){if(l.nodeType===8){var d=l.data;if(d==="$"||d==="$!"||d==="$?"){if(h===0)return l;h--}else d==="/$"&&h++}l=l.previousSibling}return null}function nW(l,h,d){switch(h=zb(d),l){case"html":if(l=h.documentElement,!l)throw Error(n(452));return l;case"head":if(l=h.head,!l)throw Error(n(453));return l;case"body":if(l=h.body,!l)throw Error(n(454));return l;default:throw Error(n(451))}}function ew(l){for(var h=l.attributes;h.length;)l.removeAttributeNode(h[0]);X(l)}var ho=new Map,iW=new Set;function Gb(l){return typeof l.getRootNode=="function"?l.getRootNode():l.nodeType===9?l:l.ownerDocument}var fc=le.d;le.d={f:uae,r:cae,D:hae,C:fae,L:dae,m:gae,X:pae,S:mae,M:vae};function uae(){var l=fc.f(),h=Lb();return l||h}function cae(l){var h=se(l);h!==null&&h.tag===5&&h.type==="form"?E6(h):fc.r(l)}var Xm=typeof document>"u"?null:document;function sW(l,h,d){var p=Xm;if(p&&typeof h=="string"&&h){var S=io(h);S='link[rel="'+l+'"][href="'+S+'"]',typeof d=="string"&&(S+='[crossorigin="'+d+'"]'),iW.has(S)||(iW.add(S),l={rel:l,crossOrigin:d,href:h},p.querySelector(S)===null&&(h=p.createElement("link"),Qi(h,"link",l),Re(h),p.head.appendChild(h)))}}function hae(l){fc.D(l),sW("dns-prefetch",l,null)}function fae(l,h){fc.C(l,h),sW("preconnect",l,h)}function dae(l,h,d){fc.L(l,h,d);var p=Xm;if(p&&l&&h){var S='link[rel="preload"][as="'+io(h)+'"]';h==="image"&&d&&d.imageSrcSet?(S+='[imagesrcset="'+io(d.imageSrcSet)+'"]',typeof d.imageSizes=="string"&&(S+='[imagesizes="'+io(d.imageSizes)+'"]')):S+='[href="'+io(l)+'"]';var C=S;switch(h){case"style":C=Qm(l);break;case"script":C=Zm(l)}ho.has(C)||(l=f({rel:"preload",href:h==="image"&&d&&d.imageSrcSet?void 0:l,as:h},d),ho.set(C,l),p.querySelector(S)!==null||h==="style"&&p.querySelector(tw(C))||h==="script"&&p.querySelector(rw(C))||(h=p.createElement("link"),Qi(h,"link",l),Re(h),p.head.appendChild(h)))}}function gae(l,h){fc.m(l,h);var d=Xm;if(d&&l){var p=h&&typeof h.as=="string"?h.as:"script",S='link[rel="modulepreload"][as="'+io(p)+'"][href="'+io(l)+'"]',C=S;switch(p){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":C=Zm(l)}if(!ho.has(C)&&(l=f({rel:"modulepreload",href:l},h),ho.set(C,l),d.querySelector(S)===null)){switch(p){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(d.querySelector(rw(C)))return}p=d.createElement("link"),Qi(p,"link",l),Re(p),d.head.appendChild(p)}}}function mae(l,h,d){fc.S(l,h,d);var p=Xm;if(p&&l){var S=He(p).hoistableStyles,C=Qm(l);h=h||"default";var N=S.get(C);if(!N){var j={loading:0,preload:null};if(N=p.querySelector(tw(C)))j.loading=5;else{l=f({rel:"stylesheet",href:l,"data-precedence":h},d),(d=ho.get(C))&&VA(l,d);var ue=N=p.createElement("link");Re(ue),Qi(ue,"link",l),ue._p=new Promise(function(Oe,Le){ue.onload=Oe,ue.onerror=Le}),ue.addEventListener("load",function(){j.loading|=1}),ue.addEventListener("error",function(){j.loading|=2}),j.loading|=4,qb(N,h,p)}N={type:"stylesheet",instance:N,count:1,state:j},S.set(C,N)}}}function pae(l,h){fc.X(l,h);var d=Xm;if(d&&l){var p=He(d).hoistableScripts,S=Zm(l),C=p.get(S);C||(C=d.querySelector(rw(S)),C||(l=f({src:l,async:!0},h),(h=ho.get(S))&&WA(l,h),C=d.createElement("script"),Re(C),Qi(C,"link",l),d.head.appendChild(C)),C={type:"script",instance:C,count:1,state:null},p.set(S,C))}}function vae(l,h){fc.M(l,h);var d=Xm;if(d&&l){var p=He(d).hoistableScripts,S=Zm(l),C=p.get(S);C||(C=d.querySelector(rw(S)),C||(l=f({src:l,async:!0,type:"module"},h),(h=ho.get(S))&&WA(l,h),C=d.createElement("script"),Re(C),Qi(C,"link",l),d.head.appendChild(C)),C={type:"script",instance:C,count:1,state:null},p.set(S,C))}}function aW(l,h,d,p){var S=(S=F.current)?Gb(S):null;if(!S)throw Error(n(446));switch(l){case"meta":case"title":return null;case"style":return typeof d.precedence=="string"&&typeof d.href=="string"?(h=Qm(d.href),d=He(S).hoistableStyles,p=d.get(h),p||(p={type:"style",instance:null,count:0,state:null},d.set(h,p)),p):{type:"void",instance:null,count:0,state:null};case"link":if(d.rel==="stylesheet"&&typeof d.href=="string"&&typeof d.precedence=="string"){l=Qm(d.href);var C=He(S).hoistableStyles,N=C.get(l);if(N||(S=S.ownerDocument||S,N={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},C.set(l,N),(C=S.querySelector(tw(l)))&&!C._p&&(N.instance=C,N.state.loading=5),ho.has(l)||(d={rel:"preload",as:"style",href:d.href,crossOrigin:d.crossOrigin,integrity:d.integrity,media:d.media,hrefLang:d.hrefLang,referrerPolicy:d.referrerPolicy},ho.set(l,d),C||wae(S,l,d,N.state))),h&&p===null)throw Error(n(528,""));return N}if(h&&p!==null)throw Error(n(529,""));return null;case"script":return h=d.async,d=d.src,typeof d=="string"&&h&&typeof h!="function"&&typeof h!="symbol"?(h=Zm(d),d=He(S).hoistableScripts,p=d.get(h),p||(p={type:"script",instance:null,count:0,state:null},d.set(h,p)),p):{type:"void",instance:null,count:0,state:null};default:throw Error(n(444,l))}}function Qm(l){return'href="'+io(l)+'"'}function tw(l){return'link[rel="stylesheet"]['+l+"]"}function oW(l){return f({},l,{"data-precedence":l.precedence,precedence:null})}function wae(l,h,d,p){l.querySelector('link[rel="preload"][as="style"]['+h+"]")?p.loading=1:(h=l.createElement("link"),p.preload=h,h.addEventListener("load",function(){return p.loading|=1}),h.addEventListener("error",function(){return p.loading|=2}),Qi(h,"link",d),Re(h),l.head.appendChild(h))}function Zm(l){return'[src="'+io(l)+'"]'}function rw(l){return"script[async]"+l}function lW(l,h,d){if(h.count++,h.instance===null)switch(h.type){case"style":var p=l.querySelector('style[data-href~="'+io(d.href)+'"]');if(p)return h.instance=p,Re(p),p;var S=f({},d,{"data-href":d.href,"data-precedence":d.precedence,href:null,precedence:null});return p=(l.ownerDocument||l).createElement("style"),Re(p),Qi(p,"style",S),qb(p,d.precedence,l),h.instance=p;case"stylesheet":S=Qm(d.href);var C=l.querySelector(tw(S));if(C)return h.state.loading|=4,h.instance=C,Re(C),C;p=oW(d),(S=ho.get(S))&&VA(p,S),C=(l.ownerDocument||l).createElement("link"),Re(C);var N=C;return N._p=new Promise(function(j,ue){N.onload=j,N.onerror=ue}),Qi(C,"link",p),h.state.loading|=4,qb(C,d.precedence,l),h.instance=C;case"script":return C=Zm(d.src),(S=l.querySelector(rw(C)))?(h.instance=S,Re(S),S):(p=d,(S=ho.get(C))&&(p=f({},d),WA(p,S)),l=l.ownerDocument||l,S=l.createElement("script"),Re(S),Qi(S,"link",p),l.head.appendChild(S),h.instance=S);case"void":return null;default:throw Error(n(443,h.type))}else h.type==="stylesheet"&&(h.state.loading&4)===0&&(p=h.instance,h.state.loading|=4,qb(p,d.precedence,l));return h.instance}function qb(l,h,d){for(var p=d.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),S=p.length?p[p.length-1]:null,C=S,N=0;N<p.length;N++){var j=p[N];if(j.dataset.precedence===h)C=j;else if(C!==S)break}C?C.parentNode.insertBefore(l,C.nextSibling):(h=d.nodeType===9?d.head:d,h.insertBefore(l,h.firstChild))}function VA(l,h){l.crossOrigin==null&&(l.crossOrigin=h.crossOrigin),l.referrerPolicy==null&&(l.referrerPolicy=h.referrerPolicy),l.title==null&&(l.title=h.title)}function WA(l,h){l.crossOrigin==null&&(l.crossOrigin=h.crossOrigin),l.referrerPolicy==null&&(l.referrerPolicy=h.referrerPolicy),l.integrity==null&&(l.integrity=h.integrity)}var Kb=null;function uW(l,h,d){if(Kb===null){var p=new Map,S=Kb=new Map;S.set(d,p)}else S=Kb,p=S.get(d),p||(p=new Map,S.set(d,p));if(p.has(l))return p;for(p.set(l,null),d=d.getElementsByTagName(l),S=0;S<d.length;S++){var C=d[S];if(!(C[q]||C[Xn]||l==="link"&&C.getAttribute("rel")==="stylesheet")&&C.namespaceURI!=="http://www.w3.org/2000/svg"){var N=C.getAttribute(h)||"";N=l+N;var j=p.get(N);j?j.push(C):p.set(N,[C])}}return p}function cW(l,h,d){l=l.ownerDocument||l,l.head.insertBefore(d,h==="title"?l.querySelector("head > title"):null)}function yae(l,h,d){if(d===1||h.itemProp!=null)return!1;switch(l){case"meta":case"title":return!0;case"style":if(typeof h.precedence!="string"||typeof h.href!="string"||h.href==="")break;return!0;case"link":if(typeof h.rel!="string"||typeof h.href!="string"||h.href===""||h.onLoad||h.onError)break;switch(h.rel){case"stylesheet":return l=h.disabled,typeof h.precedence=="string"&&l==null;default:return!0}case"script":if(h.async&&typeof h.async!="function"&&typeof h.async!="symbol"&&!h.onLoad&&!h.onError&&h.src&&typeof h.src=="string")return!0}return!1}function hW(l){return!(l.type==="stylesheet"&&(l.state.loading&3)===0)}var nw=null;function Sae(){}function bae(l,h,d){if(nw===null)throw Error(n(475));var p=nw;if(h.type==="stylesheet"&&(typeof d.media!="string"||matchMedia(d.media).matches!==!1)&&(h.state.loading&4)===0){if(h.instance===null){var S=Qm(d.href),C=l.querySelector(tw(S));if(C){l=C._p,l!==null&&typeof l=="object"&&typeof l.then=="function"&&(p.count++,p=Xb.bind(p),l.then(p,p)),h.state.loading|=4,h.instance=C,Re(C);return}C=l.ownerDocument||l,d=oW(d),(S=ho.get(S))&&VA(d,S),C=C.createElement("link"),Re(C);var N=C;N._p=new Promise(function(j,ue){N.onload=j,N.onerror=ue}),Qi(C,"link",d),h.instance=C}p.stylesheets===null&&(p.stylesheets=new Map),p.stylesheets.set(h,l),(l=h.state.preload)&&(h.state.loading&3)===0&&(p.count++,h=Xb.bind(p),l.addEventListener("load",h),l.addEventListener("error",h))}}function Cae(){if(nw===null)throw Error(n(475));var l=nw;return l.stylesheets&&l.count===0&&$A(l,l.stylesheets),0<l.count?function(h){var d=setTimeout(function(){if(l.stylesheets&&$A(l,l.stylesheets),l.unsuspend){var p=l.unsuspend;l.unsuspend=null,p()}},6e4);return l.unsuspend=h,function(){l.unsuspend=null,clearTimeout(d)}}:null}function Xb(){if(this.count--,this.count===0){if(this.stylesheets)$A(this,this.stylesheets);else if(this.unsuspend){var l=this.unsuspend;this.unsuspend=null,l()}}}var Qb=null;function $A(l,h){l.stylesheets=null,l.unsuspend!==null&&(l.count++,Qb=new Map,h.forEach(xae,l),Qb=null,Xb.call(l))}function xae(l,h){if(!(h.state.loading&4)){var d=Qb.get(l);if(d)var p=d.get(null);else{d=new Map,Qb.set(l,d);for(var S=l.querySelectorAll("link[data-precedence],style[data-precedence]"),C=0;C<S.length;C++){var N=S[C];(N.nodeName==="LINK"||N.getAttribute("media")!=="not all")&&(d.set(N.dataset.precedence,N),p=N)}p&&d.set(null,p)}S=h.instance,N=S.getAttribute("data-precedence"),C=d.get(N)||p,C===p&&d.set(null,S),d.set(N,S),this.count++,p=Xb.bind(this),S.addEventListener("load",p),S.addEventListener("error",p),C?C.parentNode.insertBefore(S,C.nextSibling):(l=l.nodeType===9?l.head:l,l.insertBefore(S,l.firstChild)),h.state.loading|=4}}var iw={$$typeof:T,Provider:null,Consumer:null,_currentValue:Te,_currentValue2:Te,_threadCount:0};function Eae(l,h,d,p,S,C,N,j){this.tag=1,this.containerInfo=l,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Bl(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Bl(0),this.hiddenUpdates=Bl(null),this.identifierPrefix=p,this.onUncaughtError=S,this.onCaughtError=C,this.onRecoverableError=N,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=j,this.incompleteTransitions=new Map}function fW(l,h,d,p,S,C,N,j,ue,Oe,Le,We){return l=new Eae(l,h,d,N,j,ue,Oe,We),h=1,C===!0&&(h|=24),C=Ta(3,null,null,h),l.current=C,C.stateNode=l,h=xM(),h.refCount++,l.pooledCache=h,h.refCount++,C.memoizedState={element:p,isDehydrated:d,cache:h},TM(C),l}function dW(l){return l?(l=Am,l):Am}function gW(l,h,d,p,S,C){S=dW(S),p.context===null?p.context=S:p.pendingContext=S,p=bh(h),p.payload={element:d},C=C===void 0?null:C,C!==null&&(p.callback=C),d=Ch(l,p,h),d!==null&&(Da(d,l,h),Iv(d,l,h))}function mW(l,h){if(l=l.memoizedState,l!==null&&l.dehydrated!==null){var d=l.retryLane;l.retryLane=d!==0&&d<h?d:h}}function UA(l,h){mW(l,h),(l=l.alternate)&&mW(l,h)}function pW(l){if(l.tag===13){var h=Mm(l,67108864);h!==null&&Da(h,l,67108864),UA(l,67108864)}}var Zb=!0;function _ae(l,h,d,p){var S=ae.T;ae.T=null;var C=le.p;try{le.p=2,jA(l,h,d,p)}finally{le.p=C,ae.T=S}}function Rae(l,h,d,p){var S=ae.T;ae.T=null;var C=le.p;try{le.p=8,jA(l,h,d,p)}finally{le.p=C,ae.T=S}}function jA(l,h,d,p){if(Zb){var S=YA(p);if(S===null)kA(l,h,p,Jb,d),wW(l,p);else if(Mae(S,l,h,d,p))p.stopPropagation();else if(wW(l,p),h&4&&-1<Tae.indexOf(l)){for(;S!==null;){var C=se(S);if(C!==null)switch(C.tag){case 3:if(C=C.stateNode,C.current.memoizedState.isDehydrated){var N=or(C.pendingLanes);if(N!==0){var j=C;for(j.pendingLanes|=2,j.entangledLanes|=2;N;){var ue=1<<31-pt(N);j.entanglements[1]|=ue,N&=~ue}jl(C),(Br&6)===0&&(Hb=Q()+500,Qv(0))}}break;case 13:j=Mm(C,2),j!==null&&Da(j,C,2),Lb(),UA(C,2)}if(C=YA(p),C===null&&kA(l,h,p,Jb,d),C===S)break;S=C}S!==null&&p.stopPropagation()}else kA(l,h,p,null,d)}}function YA(l){return l=XT(l),zA(l)}var Jb=null;function zA(l){if(Jb=null,l=ne(l),l!==null){var h=s(l);if(h===null)l=null;else{var d=h.tag;if(d===13){if(l=a(h),l!==null)return l;l=null}else if(d===3){if(h.stateNode.current.memoizedState.isDehydrated)return h.tag===3?h.stateNode.containerInfo:null;l=null}else h!==l&&(l=null)}}return Jb=l,null}function vW(l){switch(l){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(ge()){case xe:return 2;case _e:return 8;case Ne:case Xe:return 32;case Qe:return 268435456;default:return 32}default:return 32}}var GA=!1,Nh=null,Hh=null,Fh=null,sw=new Map,aw=new Map,Lh=[],Tae="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function wW(l,h){switch(l){case"focusin":case"focusout":Nh=null;break;case"dragenter":case"dragleave":Hh=null;break;case"mouseover":case"mouseout":Fh=null;break;case"pointerover":case"pointerout":sw.delete(h.pointerId);break;case"gotpointercapture":case"lostpointercapture":aw.delete(h.pointerId)}}function ow(l,h,d,p,S,C){return l===null||l.nativeEvent!==C?(l={blockedOn:h,domEventName:d,eventSystemFlags:p,nativeEvent:C,targetContainers:[S]},h!==null&&(h=se(h),h!==null&&pW(h)),l):(l.eventSystemFlags|=p,h=l.targetContainers,S!==null&&h.indexOf(S)===-1&&h.push(S),l)}function Mae(l,h,d,p,S){switch(h){case"focusin":return Nh=ow(Nh,l,h,d,p,S),!0;case"dragenter":return Hh=ow(Hh,l,h,d,p,S),!0;case"mouseover":return Fh=ow(Fh,l,h,d,p,S),!0;case"pointerover":var C=S.pointerId;return sw.set(C,ow(sw.get(C)||null,l,h,d,p,S)),!0;case"gotpointercapture":return C=S.pointerId,aw.set(C,ow(aw.get(C)||null,l,h,d,p,S)),!0}return!1}function yW(l){var h=ne(l.target);if(h!==null){var d=s(h);if(d!==null){if(h=d.tag,h===13){if(h=a(d),h!==null){l.blockedOn=h,ad(l.priority,function(){if(d.tag===13){var p=ka();p=to(p);var S=Mm(d,p);S!==null&&Da(S,d,p),UA(d,p)}});return}}else if(h===3&&d.stateNode.current.memoizedState.isDehydrated){l.blockedOn=d.tag===3?d.stateNode.containerInfo:null;return}}}l.blockedOn=null}function eC(l){if(l.blockedOn!==null)return!1;for(var h=l.targetContainers;0<h.length;){var d=YA(l.nativeEvent);if(d===null){d=l.nativeEvent;var p=new d.constructor(d.type,d);KT=p,d.target.dispatchEvent(p),KT=null}else return h=se(d),h!==null&&pW(h),l.blockedOn=d,!1;h.shift()}return!0}function SW(l,h,d){eC(l)&&d.delete(h)}function Aae(){GA=!1,Nh!==null&&eC(Nh)&&(Nh=null),Hh!==null&&eC(Hh)&&(Hh=null),Fh!==null&&eC(Fh)&&(Fh=null),sw.forEach(SW),aw.forEach(SW)}function tC(l,h){l.blockedOn===h&&(l.blockedOn=null,GA||(GA=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,Aae)))}var rC=null;function bW(l){rC!==l&&(rC=l,t.unstable_scheduleCallback(t.unstable_NormalPriority,function(){rC===l&&(rC=null);for(var h=0;h<l.length;h+=3){var d=l[h],p=l[h+1],S=l[h+2];if(typeof p!="function"){if(zA(p||d)===null)continue;break}var C=se(d);C!==null&&(l.splice(h,3),h-=3,zM(C,{pending:!0,data:S,method:d.method,action:p},p,S))}}))}function lw(l){function h(ue){return tC(ue,l)}Nh!==null&&tC(Nh,l),Hh!==null&&tC(Hh,l),Fh!==null&&tC(Fh,l),sw.forEach(h),aw.forEach(h);for(var d=0;d<Lh.length;d++){var p=Lh[d];p.blockedOn===l&&(p.blockedOn=null)}for(;0<Lh.length&&(d=Lh[0],d.blockedOn===null);)yW(d),d.blockedOn===null&&Lh.shift();if(d=(l.ownerDocument||l).$$reactFormReplay,d!=null)for(p=0;p<d.length;p+=3){var S=d[p],C=d[p+1],N=S[fi]||null;if(typeof C=="function")N||bW(d);else if(N){var j=null;if(C&&C.hasAttribute("formAction")){if(S=C,N=C[fi]||null)j=N.formAction;else if(zA(S)!==null)continue}else j=N.action;typeof j=="function"?d[p+1]=j:(d.splice(p,3),p-=3),bW(d)}}}function qA(l){this._internalRoot=l}nC.prototype.render=qA.prototype.render=function(l){var h=this._internalRoot;if(h===null)throw Error(n(409));var d=h.current,p=ka();gW(d,p,l,h,null,null)},nC.prototype.unmount=qA.prototype.unmount=function(){var l=this._internalRoot;if(l!==null){this._internalRoot=null;var h=l.containerInfo;gW(l.current,2,null,l,null,null),Lb(),h[Ti]=null}};function nC(l){this._internalRoot=l}nC.prototype.unstable_scheduleHydration=function(l){if(l){var h=sd();l={blockedOn:null,target:l,priority:h};for(var d=0;d<Lh.length&&h!==0&&h<Lh[d].priority;d++);Lh.splice(d,0,l),d===0&&yW(l)}};var CW=e.version;if(CW!=="19.1.1")throw Error(n(527,CW,"19.1.1"));le.findDOMNode=function(l){var h=l._reactInternals;if(h===void 0)throw typeof l.render=="function"?Error(n(188)):(l=Object.keys(l).join(","),Error(n(268,l)));return l=u(h),l=l!==null?c(l):null,l=l===null?null:l.stateNode,l};var Oae={bundleType:0,version:"19.1.1",rendererPackageName:"react-dom",currentDispatcherRef:ae,reconcilerVersion:"19.1.1"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var iC=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!iC.isDisabled&&iC.supportsFiber)try{Et=iC.inject(Oae),at=iC}catch{}}return cw.createRoot=function(l,h){if(!i(l))throw Error(n(299));var d=!1,p="",S=L6,C=B6,N=V6,j=null;return h!=null&&(h.unstable_strictMode===!0&&(d=!0),h.identifierPrefix!==void 0&&(p=h.identifierPrefix),h.onUncaughtError!==void 0&&(S=h.onUncaughtError),h.onCaughtError!==void 0&&(C=h.onCaughtError),h.onRecoverableError!==void 0&&(N=h.onRecoverableError),h.unstable_transitionCallbacks!==void 0&&(j=h.unstable_transitionCallbacks)),h=fW(l,1,!1,null,null,d,p,S,C,N,j,null),l[Ti]=h.current,OA(l),new qA(h)},cw.hydrateRoot=function(l,h,d){if(!i(l))throw Error(n(299));var p=!1,S="",C=L6,N=B6,j=V6,ue=null,Oe=null;return d!=null&&(d.unstable_strictMode===!0&&(p=!0),d.identifierPrefix!==void 0&&(S=d.identifierPrefix),d.onUncaughtError!==void 0&&(C=d.onUncaughtError),d.onCaughtError!==void 0&&(N=d.onCaughtError),d.onRecoverableError!==void 0&&(j=d.onRecoverableError),d.unstable_transitionCallbacks!==void 0&&(ue=d.unstable_transitionCallbacks),d.formState!==void 0&&(Oe=d.formState)),h=fW(l,1,!0,h,d??null,p,S,C,N,j,ue,Oe),h.context=dW(null),d=h.current,p=ka(),p=to(p),S=bh(p),S.callback=null,Ch(d,S,p),d=p,h.current.lanes=d,Ea(h,d),jl(h),l[Ti]=h.current,OA(l),new nC(h)},cw.version="19.1.1",cw}var PW;function Wae(){if(PW)return QA.exports;PW=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),QA.exports=Vae(),QA.exports}var $ae=Wae();const Uae="/react_test/assets/react-CHdo91hT.svg",jae="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20aria-hidden='true'%20role='img'%20class='iconify%20iconify--logos'%20width='31.88'%20height='32'%20preserveAspectRatio='xMidYMid%20meet'%20viewBox='0%200%20256%20257'%3e%3cdefs%3e%3clinearGradient%20id='IconifyId1813088fe1fbc01fb466'%20x1='-.828%25'%20x2='57.636%25'%20y1='7.652%25'%20y2='78.411%25'%3e%3cstop%20offset='0%25'%20stop-color='%2341D1FF'%3e%3c/stop%3e%3cstop%20offset='100%25'%20stop-color='%23BD34FE'%3e%3c/stop%3e%3c/linearGradient%3e%3clinearGradient%20id='IconifyId1813088fe1fbc01fb467'%20x1='43.376%25'%20x2='50.316%25'%20y1='2.242%25'%20y2='89.03%25'%3e%3cstop%20offset='0%25'%20stop-color='%23FFEA83'%3e%3c/stop%3e%3cstop%20offset='8.333%25'%20stop-color='%23FFDD35'%3e%3c/stop%3e%3cstop%20offset='100%25'%20stop-color='%23FFA800'%3e%3c/stop%3e%3c/linearGradient%3e%3c/defs%3e%3cpath%20fill='url(%23IconifyId1813088fe1fbc01fb466)'%20d='M255.153%2037.938L134.897%20252.976c-2.483%204.44-8.862%204.466-11.382.048L.875%2037.958c-2.746-4.814%201.371-10.646%206.827-9.67l120.385%2021.517a6.537%206.537%200%200%200%202.322-.004l117.867-21.483c5.438-.991%209.574%204.796%206.877%209.62Z'%3e%3c/path%3e%3cpath%20fill='url(%23IconifyId1813088fe1fbc01fb467)'%20d='M185.432.063L96.44%2017.501a3.268%203.268%200%200%200-2.634%203.014l-5.474%2092.456a3.268%203.268%200%200%200%203.997%203.378l24.777-5.718c2.318-.535%204.413%201.507%203.936%203.838l-7.361%2036.047c-.495%202.426%201.782%204.5%204.151%203.78l15.304-4.649c2.372-.72%204.652%201.36%204.15%203.788l-11.698%2056.621c-.732%203.542%203.979%205.473%205.943%202.437l1.313-2.028l72.516-144.72c1.215-2.423-.88-5.186-3.54-4.672l-25.505%204.922c-2.396.462-4.435-1.77-3.759-4.114l16.646-57.705c.677-2.35-1.37-4.583-3.769-4.113Z'%3e%3c/path%3e%3c/svg%3e";/**
 * react-router v7.7.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var IW="popstate";function Yae(t={}){function e(i,s){let{pathname:a="/",search:o="",hash:u=""}=Qg(i.location.hash.substring(1));return!a.startsWith("/")&&!a.startsWith(".")&&(a="/"+a),HI("",{pathname:a,search:o,hash:u},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function r(i,s){let a=i.document.querySelector("base"),o="";if(a&&a.getAttribute("href")){let u=i.location.href,c=u.indexOf("#");o=c===-1?u:u.slice(0,c)}return o+"#"+(typeof s=="string"?s:h1(s))}function n(i,s){Dl(i.pathname.charAt(0)==="/",`relative pathnames are not supported in hash history.push(${JSON.stringify(s)})`)}return Gae(e,r,n,t)}function Pn(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function Dl(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function zae(){return Math.random().toString(36).substring(2,10)}function NW(t,e){return{usr:t.state,key:t.key,idx:e}}function HI(t,e,r=null,n){return{pathname:typeof t=="string"?t:t.pathname,search:"",hash:"",...typeof e=="string"?Qg(e):e,state:r,key:e&&e.key||n||zae()}}function h1({pathname:t="/",search:e="",hash:r=""}){return e&&e!=="?"&&(t+=e.charAt(0)==="?"?e:"?"+e),r&&r!=="#"&&(t+=r.charAt(0)==="#"?r:"#"+r),t}function Qg(t){let e={};if(t){let r=t.indexOf("#");r>=0&&(e.hash=t.substring(r),t=t.substring(0,r));let n=t.indexOf("?");n>=0&&(e.search=t.substring(n),t=t.substring(0,n)),t&&(e.pathname=t)}return e}function Gae(t,e,r,n={}){let{window:i=document.defaultView,v5Compat:s=!1}=n,a=i.history,o="POP",u=null,c=f();c==null&&(c=0,a.replaceState({...a.state,idx:c},""));function f(){return(a.state||{idx:null}).idx}function g(){o="POP";let b=f(),x=b==null?null:b-c;c=b,u&&u({action:o,location:y.location,delta:x})}function m(b,x){o="PUSH";let _=HI(y.location,b,x);r&&r(_,b),c=f()+1;let T=NW(_,c),D=y.createHref(_);try{a.pushState(T,"",D)}catch(P){if(P instanceof DOMException&&P.name==="DataCloneError")throw P;i.location.assign(D)}s&&u&&u({action:o,location:y.location,delta:1})}function v(b,x){o="REPLACE";let _=HI(y.location,b,x);r&&r(_,b),c=f();let T=NW(_,c),D=y.createHref(_);a.replaceState(T,"",D),s&&u&&u({action:o,location:y.location,delta:0})}function w(b){return qae(b)}let y={get action(){return o},get location(){return t(i,a)},listen(b){if(u)throw new Error("A history only accepts one active listener");return i.addEventListener(IW,g),u=b,()=>{i.removeEventListener(IW,g),u=null}},createHref(b){return e(i,b)},createURL:w,encodeLocation(b){let x=w(b);return{pathname:x.pathname,search:x.search,hash:x.hash}},push:m,replace:v,go(b){return a.go(b)}};return y}function qae(t,e=!1){let r="http://localhost";typeof window<"u"&&(r=window.location.origin!=="null"?window.location.origin:window.location.href),Pn(r,"No window.location.(origin|href) available to create URL");let n=typeof t=="string"?t:h1(t);return n=n.replace(/ $/,"%20"),!e&&n.startsWith("//")&&(n=r+n),new URL(n,r)}function Xq(t,e,r="/"){return Kae(t,e,r,!1)}function Kae(t,e,r,n){let i=typeof e=="string"?Qg(e):e,s=eh(i.pathname||"/",r);if(s==null)return null;let a=Qq(t);Xae(a);let o=null;for(let u=0;o==null&&u<a.length;++u){let c=ooe(s);o=soe(a[u],c,n)}return o}function Qq(t,e=[],r=[],n=""){let i=(s,a,o)=>{let u={relativePath:o===void 0?s.path||"":o,caseSensitive:s.caseSensitive===!0,childrenIndex:a,route:s};u.relativePath.startsWith("/")&&(Pn(u.relativePath.startsWith(n),`Absolute route path "${u.relativePath}" nested under path "${n}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),u.relativePath=u.relativePath.slice(n.length));let c=jc([n,u.relativePath]),f=r.concat(u);s.children&&s.children.length>0&&(Pn(s.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${c}".`),Qq(s.children,e,f,c)),!(s.path==null&&!s.index)&&e.push({path:c,score:noe(c,s.index),routesMeta:f})};return t.forEach((s,a)=>{if(s.path===""||!s.path?.includes("?"))i(s,a);else for(let o of Zq(s.path))i(s,a,o)}),e}function Zq(t){let e=t.split("/");if(e.length===0)return[];let[r,...n]=e,i=r.endsWith("?"),s=r.replace(/\?$/,"");if(n.length===0)return i?[s,""]:[s];let a=Zq(n.join("/")),o=[];return o.push(...a.map(u=>u===""?s:[s,u].join("/"))),i&&o.push(...a),o.map(u=>t.startsWith("/")&&u===""?"/":u)}function Xae(t){t.sort((e,r)=>e.score!==r.score?r.score-e.score:ioe(e.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}var Qae=/^:[\w-]+$/,Zae=3,Jae=2,eoe=1,toe=10,roe=-2,HW=t=>t==="*";function noe(t,e){let r=t.split("/"),n=r.length;return r.some(HW)&&(n+=roe),e&&(n+=Jae),r.filter(i=>!HW(i)).reduce((i,s)=>i+(Qae.test(s)?Zae:s===""?eoe:toe),n)}function ioe(t,e){return t.length===e.length&&t.slice(0,-1).every((n,i)=>n===e[i])?t[t.length-1]-e[e.length-1]:0}function soe(t,e,r=!1){let{routesMeta:n}=t,i={},s="/",a=[];for(let o=0;o<n.length;++o){let u=n[o],c=o===n.length-1,f=s==="/"?e:e.slice(s.length)||"/",g=UE({path:u.relativePath,caseSensitive:u.caseSensitive,end:c},f),m=u.route;if(!g&&c&&r&&!n[n.length-1].route.index&&(g=UE({path:u.relativePath,caseSensitive:u.caseSensitive,end:!1},f)),!g)return null;Object.assign(i,g.params),a.push({params:i,pathname:jc([s,g.pathname]),pathnameBase:hoe(jc([s,g.pathnameBase])),route:m}),g.pathnameBase!=="/"&&(s=jc([s,g.pathnameBase]))}return a}function UE(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[r,n]=aoe(t.path,t.caseSensitive,t.end),i=e.match(r);if(!i)return null;let s=i[0],a=s.replace(/(.)\/+$/,"$1"),o=i.slice(1);return{params:n.reduce((c,{paramName:f,isOptional:g},m)=>{if(f==="*"){let w=o[m]||"";a=s.slice(0,s.length-w.length).replace(/(.)\/+$/,"$1")}const v=o[m];return g&&!v?c[f]=void 0:c[f]=(v||"").replace(/%2F/g,"/"),c},{}),pathname:s,pathnameBase:a,pattern:t}}function aoe(t,e=!1,r=!0){Dl(t==="*"||!t.endsWith("*")||t.endsWith("/*"),`Route path "${t}" will be treated as if it were "${t.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${t.replace(/\*$/,"/*")}".`);let n=[],i="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(a,o,u)=>(n.push({paramName:o,isOptional:u!=null}),u?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(n.push({paramName:"*"}),i+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?i+="\\/*$":t!==""&&t!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),n]}function ooe(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Dl(!1,`The URL path "${t}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),t}}function eh(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let r=e.endsWith("/")?e.length-1:e.length,n=t.charAt(r);return n&&n!=="/"?null:t.slice(r)||"/"}function loe(t,e="/"){let{pathname:r,search:n="",hash:i=""}=typeof t=="string"?Qg(t):t;return{pathname:r?r.startsWith("/")?r:uoe(r,e):e,search:foe(n),hash:doe(i)}}function uoe(t,e){let r=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(i=>{i===".."?r.length>1&&r.pop():i!=="."&&r.push(i)}),r.length>1?r.join("/"):"/"}function tO(t,e,r,n){return`Cannot include a '${t}' character in a manually specified \`to.${e}\` field [${JSON.stringify(n)}].  Please separate it out to the \`to.${r}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function coe(t){return t.filter((e,r)=>r===0||e.route.path&&e.route.path.length>0)}function Jq(t){let e=coe(t);return e.map((r,n)=>n===e.length-1?r.pathname:r.pathnameBase)}function eK(t,e,r,n=!1){let i;typeof t=="string"?i=Qg(t):(i={...t},Pn(!i.pathname||!i.pathname.includes("?"),tO("?","pathname","search",i)),Pn(!i.pathname||!i.pathname.includes("#"),tO("#","pathname","hash",i)),Pn(!i.search||!i.search.includes("#"),tO("#","search","hash",i)));let s=t===""||i.pathname==="",a=s?"/":i.pathname,o;if(a==null)o=r;else{let g=e.length-1;if(!n&&a.startsWith("..")){let m=a.split("/");for(;m[0]==="..";)m.shift(),g-=1;i.pathname=m.join("/")}o=g>=0?e[g]:"/"}let u=loe(i,o),c=a&&a!=="/"&&a.endsWith("/"),f=(s||a===".")&&r.endsWith("/");return!u.pathname.endsWith("/")&&(c||f)&&(u.pathname+="/"),u}var jc=t=>t.join("/").replace(/\/\/+/g,"/"),hoe=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),foe=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,doe=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function goe(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}var tK=["POST","PUT","PATCH","DELETE"];new Set(tK);var moe=["GET",...tK];new Set(moe);var qp=ie.createContext(null);qp.displayName="DataRouter";var vR=ie.createContext(null);vR.displayName="DataRouterState";ie.createContext(!1);var rK=ie.createContext({isTransitioning:!1});rK.displayName="ViewTransition";var poe=ie.createContext(new Map);poe.displayName="Fetchers";var voe=ie.createContext(null);voe.displayName="Await";var $u=ie.createContext(null);$u.displayName="Navigation";var nS=ie.createContext(null);nS.displayName="Location";var ah=ie.createContext({outlet:null,matches:[],isDataRoute:!1});ah.displayName="Route";var yH=ie.createContext(null);yH.displayName="RouteError";function woe(t,{relative:e}={}){Pn(iS(),"useHref() may be used only in the context of a <Router> component.");let{basename:r,navigator:n}=ie.useContext($u),{hash:i,pathname:s,search:a}=sS(t,{relative:e}),o=s;return r!=="/"&&(o=s==="/"?r:jc([r,s])),n.createHref({pathname:o,search:a,hash:i})}function iS(){return ie.useContext(nS)!=null}function Uu(){return Pn(iS(),"useLocation() may be used only in the context of a <Router> component."),ie.useContext(nS).location}var nK="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function iK(t){ie.useContext($u).static||ie.useLayoutEffect(t)}function Yo(){let{isDataRoute:t}=ie.useContext(ah);return t?koe():yoe()}function yoe(){Pn(iS(),"useNavigate() may be used only in the context of a <Router> component.");let t=ie.useContext(qp),{basename:e,navigator:r}=ie.useContext($u),{matches:n}=ie.useContext(ah),{pathname:i}=Uu(),s=JSON.stringify(Jq(n)),a=ie.useRef(!1);return iK(()=>{a.current=!0}),ie.useCallback((u,c={})=>{if(Dl(a.current,nK),!a.current)return;if(typeof u=="number"){r.go(u);return}let f=eK(u,JSON.parse(s),i,c.relative==="path");t==null&&e!=="/"&&(f.pathname=f.pathname==="/"?e:jc([e,f.pathname])),(c.replace?r.replace:r.push)(f,c.state,c)},[e,r,s,i,t])}ie.createContext(null);function sS(t,{relative:e}={}){let{matches:r}=ie.useContext(ah),{pathname:n}=Uu(),i=JSON.stringify(Jq(r));return ie.useMemo(()=>eK(t,JSON.parse(i),n,e==="path"),[t,i,n,e])}function Soe(t,e){return sK(t,e)}function sK(t,e,r,n){Pn(iS(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:i}=ie.useContext($u),{matches:s}=ie.useContext(ah),a=s[s.length-1],o=a?a.params:{},u=a?a.pathname:"/",c=a?a.pathnameBase:"/",f=a&&a.route;{let x=f&&f.path||"";aK(u,!f||x.endsWith("*")||x.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${u}" (under <Route path="${x}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${x}"> to <Route path="${x==="/"?"*":`${x}/*`}">.`)}let g=Uu(),m;if(e){let x=typeof e=="string"?Qg(e):e;Pn(c==="/"||x.pathname?.startsWith(c),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${c}" but pathname "${x.pathname}" was given in the \`location\` prop.`),m=x}else m=g;let v=m.pathname||"/",w=v;if(c!=="/"){let x=c.replace(/^\//,"").split("/");w="/"+v.replace(/^\//,"").split("/").slice(x.length).join("/")}let y=Xq(t,{pathname:w});Dl(f||y!=null,`No routes matched location "${m.pathname}${m.search}${m.hash}" `),Dl(y==null||y[y.length-1].route.element!==void 0||y[y.length-1].route.Component!==void 0||y[y.length-1].route.lazy!==void 0,`Matched leaf route at location "${m.pathname}${m.search}${m.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let b=_oe(y&&y.map(x=>Object.assign({},x,{params:Object.assign({},o,x.params),pathname:jc([c,i.encodeLocation?i.encodeLocation(x.pathname).pathname:x.pathname]),pathnameBase:x.pathnameBase==="/"?c:jc([c,i.encodeLocation?i.encodeLocation(x.pathnameBase).pathname:x.pathnameBase])})),s,r,n);return e&&b?ie.createElement(nS.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...m},navigationType:"POP"}},b):b}function boe(){let t=Ooe(),e=goe(t)?`${t.status} ${t.statusText}`:t instanceof Error?t.message:JSON.stringify(t),r=t instanceof Error?t.stack:null,n="rgba(200,200,200, 0.5)",i={padding:"0.5rem",backgroundColor:n},s={padding:"2px 4px",backgroundColor:n},a=null;return console.error("Error handled by React Router default ErrorBoundary:",t),a=ie.createElement(ie.Fragment,null,ie.createElement("p",null,"💿 Hey developer 👋"),ie.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",ie.createElement("code",{style:s},"ErrorBoundary")," or"," ",ie.createElement("code",{style:s},"errorElement")," prop on your route.")),ie.createElement(ie.Fragment,null,ie.createElement("h2",null,"Unexpected Application Error!"),ie.createElement("h3",{style:{fontStyle:"italic"}},e),r?ie.createElement("pre",{style:i},r):null,a)}var Coe=ie.createElement(boe,null),xoe=class extends ie.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,e){return e.location!==t.location||e.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:e.error,location:e.location,revalidation:t.revalidation||e.revalidation}}componentDidCatch(t,e){console.error("React Router caught the following error during render",t,e)}render(){return this.state.error!==void 0?ie.createElement(ah.Provider,{value:this.props.routeContext},ie.createElement(yH.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function Eoe({routeContext:t,match:e,children:r}){let n=ie.useContext(qp);return n&&n.static&&n.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=e.route.id),ie.createElement(ah.Provider,{value:t},r)}function _oe(t,e=[],r=null,n=null){if(t==null){if(!r)return null;if(r.errors)t=r.matches;else if(e.length===0&&!r.initialized&&r.matches.length>0)t=r.matches;else return null}let i=t,s=r?.errors;if(s!=null){let u=i.findIndex(c=>c.route.id&&s?.[c.route.id]!==void 0);Pn(u>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(s).join(",")}`),i=i.slice(0,Math.min(i.length,u+1))}let a=!1,o=-1;if(r)for(let u=0;u<i.length;u++){let c=i[u];if((c.route.HydrateFallback||c.route.hydrateFallbackElement)&&(o=u),c.route.id){let{loaderData:f,errors:g}=r,m=c.route.loader&&!f.hasOwnProperty(c.route.id)&&(!g||g[c.route.id]===void 0);if(c.route.lazy||m){a=!0,o>=0?i=i.slice(0,o+1):i=[i[0]];break}}}return i.reduceRight((u,c,f)=>{let g,m=!1,v=null,w=null;r&&(g=s&&c.route.id?s[c.route.id]:void 0,v=c.route.errorElement||Coe,a&&(o<0&&f===0?(aK("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),m=!0,w=null):o===f&&(m=!0,w=c.route.hydrateFallbackElement||null)));let y=e.concat(i.slice(0,f+1)),b=()=>{let x;return g?x=v:m?x=w:c.route.Component?x=ie.createElement(c.route.Component,null):c.route.element?x=c.route.element:x=u,ie.createElement(Eoe,{match:c,routeContext:{outlet:u,matches:y,isDataRoute:r!=null},children:x})};return r&&(c.route.ErrorBoundary||c.route.errorElement||f===0)?ie.createElement(xoe,{location:r.location,revalidation:r.revalidation,component:v,error:g,children:b(),routeContext:{outlet:null,matches:y,isDataRoute:!0}}):b()},null)}function SH(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Roe(t){let e=ie.useContext(qp);return Pn(e,SH(t)),e}function Toe(t){let e=ie.useContext(vR);return Pn(e,SH(t)),e}function Moe(t){let e=ie.useContext(ah);return Pn(e,SH(t)),e}function bH(t){let e=Moe(t),r=e.matches[e.matches.length-1];return Pn(r.route.id,`${t} can only be used on routes that contain a unique "id"`),r.route.id}function Aoe(){return bH("useRouteId")}function Ooe(){let t=ie.useContext(yH),e=Toe("useRouteError"),r=bH("useRouteError");return t!==void 0?t:e.errors?.[r]}function koe(){let{router:t}=Roe("useNavigate"),e=bH("useNavigate"),r=ie.useRef(!1);return iK(()=>{r.current=!0}),ie.useCallback(async(i,s={})=>{Dl(r.current,nK),r.current&&(typeof i=="number"?t.navigate(i):await t.navigate(i,{fromRouteId:e,...s}))},[t,e])}var FW={};function aK(t,e,r){!e&&!FW[t]&&(FW[t]=!0,Dl(!1,r))}ie.memo(Doe);function Doe({routes:t,future:e,state:r}){return sK(t,void 0,r,e)}function lu(t){Pn(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function Poe({basename:t="/",children:e=null,location:r,navigationType:n="POP",navigator:i,static:s=!1}){Pn(!iS(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let a=t.replace(/^\/*/,"/"),o=ie.useMemo(()=>({basename:a,navigator:i,static:s,future:{}}),[a,i,s]);typeof r=="string"&&(r=Qg(r));let{pathname:u="/",search:c="",hash:f="",state:g=null,key:m="default"}=r,v=ie.useMemo(()=>{let w=eh(u,a);return w==null?null:{location:{pathname:w,search:c,hash:f,state:g,key:m},navigationType:n}},[a,u,c,f,g,m,n]);return Dl(v!=null,`<Router basename="${a}"> is not able to match the URL "${u}${c}${f}" because it does not start with the basename, so the <Router> won't render anything.`),v==null?null:ie.createElement($u.Provider,{value:o},ie.createElement(nS.Provider,{children:e,value:v}))}function Ioe({children:t,location:e}){return Soe(FI(t),e)}function FI(t,e=[]){let r=[];return ie.Children.forEach(t,(n,i)=>{if(!ie.isValidElement(n))return;let s=[...e,i];if(n.type===ie.Fragment){r.push.apply(r,FI(n.props.children,s));return}Pn(n.type===lu,`[${typeof n.type=="string"?n.type:n.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Pn(!n.props.index||!n.props.children,"An index route cannot have child routes.");let a={id:n.props.id||s.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,hydrateFallbackElement:n.props.hydrateFallbackElement,HydrateFallback:n.props.HydrateFallback,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.hasErrorBoundary===!0||n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(a.children=FI(n.props.children,s)),r.push(a)}),r}var oE="get",lE="application/x-www-form-urlencoded";function wR(t){return t!=null&&typeof t.tagName=="string"}function Noe(t){return wR(t)&&t.tagName.toLowerCase()==="button"}function Hoe(t){return wR(t)&&t.tagName.toLowerCase()==="form"}function Foe(t){return wR(t)&&t.tagName.toLowerCase()==="input"}function Loe(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function Boe(t,e){return t.button===0&&(!e||e==="_self")&&!Loe(t)}var sC=null;function Voe(){if(sC===null)try{new FormData(document.createElement("form"),0),sC=!1}catch{sC=!0}return sC}var Woe=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function rO(t){return t!=null&&!Woe.has(t)?(Dl(!1,`"${t}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${lE}"`),null):t}function $oe(t,e){let r,n,i,s,a;if(Hoe(t)){let o=t.getAttribute("action");n=o?eh(o,e):null,r=t.getAttribute("method")||oE,i=rO(t.getAttribute("enctype"))||lE,s=new FormData(t)}else if(Noe(t)||Foe(t)&&(t.type==="submit"||t.type==="image")){let o=t.form;if(o==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let u=t.getAttribute("formaction")||o.getAttribute("action");if(n=u?eh(u,e):null,r=t.getAttribute("formmethod")||o.getAttribute("method")||oE,i=rO(t.getAttribute("formenctype"))||rO(o.getAttribute("enctype"))||lE,s=new FormData(o,t),!Voe()){let{name:c,type:f,value:g}=t;if(f==="image"){let m=c?`${c}.`:"";s.append(`${m}x`,"0"),s.append(`${m}y`,"0")}else c&&s.append(c,g)}}else{if(wR(t))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');r=oE,n=null,i=lE,a=t}return s&&i==="text/plain"&&(a=s,s=void 0),{action:n,method:r.toLowerCase(),encType:i,formData:s,body:a}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function CH(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function Uoe(t,e,r){let n=typeof t=="string"?new URL(t,typeof window>"u"?"server://singlefetch/":window.location.origin):t;return n.pathname==="/"?n.pathname=`_root.${r}`:e&&eh(n.pathname,e)==="/"?n.pathname=`${e.replace(/\/$/,"")}/_root.${r}`:n.pathname=`${n.pathname.replace(/\/$/,"")}.${r}`,n}async function joe(t,e){if(t.id in e)return e[t.id];try{let r=await import(t.module);return e[t.id]=r,r}catch(r){return console.error(`Error loading route module \`${t.module}\`, reloading page...`),console.error(r),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function Yoe(t){return t==null?!1:t.href==null?t.rel==="preload"&&typeof t.imageSrcSet=="string"&&typeof t.imageSizes=="string":typeof t.rel=="string"&&typeof t.href=="string"}async function zoe(t,e,r){let n=await Promise.all(t.map(async i=>{let s=e.routes[i.route.id];if(s){let a=await joe(s,r);return a.links?a.links():[]}return[]}));return Xoe(n.flat(1).filter(Yoe).filter(i=>i.rel==="stylesheet"||i.rel==="preload").map(i=>i.rel==="stylesheet"?{...i,rel:"prefetch",as:"style"}:{...i,rel:"prefetch"}))}function LW(t,e,r,n,i,s){let a=(u,c)=>r[c]?u.route.id!==r[c].route.id:!0,o=(u,c)=>r[c].pathname!==u.pathname||r[c].route.path?.endsWith("*")&&r[c].params["*"]!==u.params["*"];return s==="assets"?e.filter((u,c)=>a(u,c)||o(u,c)):s==="data"?e.filter((u,c)=>{let f=n.routes[u.route.id];if(!f||!f.hasLoader)return!1;if(a(u,c)||o(u,c))return!0;if(u.route.shouldRevalidate){let g=u.route.shouldRevalidate({currentUrl:new URL(i.pathname+i.search+i.hash,window.origin),currentParams:r[0]?.params||{},nextUrl:new URL(t,window.origin),nextParams:u.params,defaultShouldRevalidate:!0});if(typeof g=="boolean")return g}return!0}):[]}function Goe(t,e,{includeHydrateFallback:r}={}){return qoe(t.map(n=>{let i=e.routes[n.route.id];if(!i)return[];let s=[i.module];return i.clientActionModule&&(s=s.concat(i.clientActionModule)),i.clientLoaderModule&&(s=s.concat(i.clientLoaderModule)),r&&i.hydrateFallbackModule&&(s=s.concat(i.hydrateFallbackModule)),i.imports&&(s=s.concat(i.imports)),s}).flat(1))}function qoe(t){return[...new Set(t)]}function Koe(t){let e={},r=Object.keys(t).sort();for(let n of r)e[n]=t[n];return e}function Xoe(t,e){let r=new Set;return new Set(e),t.reduce((n,i)=>{let s=JSON.stringify(Koe(i));return r.has(s)||(r.add(s),n.push({key:s,link:i})),n},[])}function oK(){let t=ie.useContext(qp);return CH(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function Qoe(){let t=ie.useContext(vR);return CH(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var xH=ie.createContext(void 0);xH.displayName="FrameworkContext";function lK(){let t=ie.useContext(xH);return CH(t,"You must render this element inside a <HydratedRouter> element"),t}function Zoe(t,e){let r=ie.useContext(xH),[n,i]=ie.useState(!1),[s,a]=ie.useState(!1),{onFocus:o,onBlur:u,onMouseEnter:c,onMouseLeave:f,onTouchStart:g}=e,m=ie.useRef(null);ie.useEffect(()=>{if(t==="render"&&a(!0),t==="viewport"){let y=x=>{x.forEach(_=>{a(_.isIntersecting)})},b=new IntersectionObserver(y,{threshold:.5});return m.current&&b.observe(m.current),()=>{b.disconnect()}}},[t]),ie.useEffect(()=>{if(n){let y=setTimeout(()=>{a(!0)},100);return()=>{clearTimeout(y)}}},[n]);let v=()=>{i(!0)},w=()=>{i(!1),a(!1)};return r?t!=="intent"?[s,m,{}]:[s,m,{onFocus:hw(o,v),onBlur:hw(u,w),onMouseEnter:hw(c,v),onMouseLeave:hw(f,w),onTouchStart:hw(g,v)}]:[!1,m,{}]}function hw(t,e){return r=>{t&&t(r),r.defaultPrevented||e(r)}}function Joe({page:t,...e}){let{router:r}=oK(),n=ie.useMemo(()=>Xq(r.routes,t,r.basename),[r.routes,t,r.basename]);return n?ie.createElement(tle,{page:t,matches:n,...e}):null}function ele(t){let{manifest:e,routeModules:r}=lK(),[n,i]=ie.useState([]);return ie.useEffect(()=>{let s=!1;return zoe(t,e,r).then(a=>{s||i(a)}),()=>{s=!0}},[t,e,r]),n}function tle({page:t,matches:e,...r}){let n=Uu(),{manifest:i,routeModules:s}=lK(),{basename:a}=oK(),{loaderData:o,matches:u}=Qoe(),c=ie.useMemo(()=>LW(t,e,u,i,n,"data"),[t,e,u,i,n]),f=ie.useMemo(()=>LW(t,e,u,i,n,"assets"),[t,e,u,i,n]),g=ie.useMemo(()=>{if(t===n.pathname+n.search+n.hash)return[];let w=new Set,y=!1;if(e.forEach(x=>{let _=i.routes[x.route.id];!_||!_.hasLoader||(!c.some(T=>T.route.id===x.route.id)&&x.route.id in o&&s[x.route.id]?.shouldRevalidate||_.hasClientLoader?y=!0:w.add(x.route.id))}),w.size===0)return[];let b=Uoe(t,a,"data");return y&&w.size>0&&b.searchParams.set("_routes",e.filter(x=>w.has(x.route.id)).map(x=>x.route.id).join(",")),[b.pathname+b.search]},[a,o,n,i,c,e,t,s]),m=ie.useMemo(()=>Goe(f,i),[f,i]),v=ele(f);return ie.createElement(ie.Fragment,null,g.map(w=>ie.createElement("link",{key:w,rel:"prefetch",as:"fetch",href:w,...r})),m.map(w=>ie.createElement("link",{key:w,rel:"modulepreload",href:w,...r})),v.map(({key:w,link:y})=>ie.createElement("link",{key:w,...y})))}function rle(...t){return e=>{t.forEach(r=>{typeof r=="function"?r(e):r!=null&&(r.current=e)})}}var uK=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{uK&&(window.__reactRouterVersion="7.7.1")}catch{}function nle({basename:t,children:e,window:r}){let n=ie.useRef();n.current==null&&(n.current=Yae({window:r,v5Compat:!0}));let i=n.current,[s,a]=ie.useState({action:i.action,location:i.location}),o=ie.useCallback(u=>{ie.startTransition(()=>a(u))},[a]);return ie.useLayoutEffect(()=>i.listen(o),[i,o]),ie.createElement(Poe,{basename:t,children:e,location:s.location,navigationType:s.action,navigator:i})}var cK=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,EH=ie.forwardRef(function({onClick:e,discover:r="render",prefetch:n="none",relative:i,reloadDocument:s,replace:a,state:o,target:u,to:c,preventScrollReset:f,viewTransition:g,...m},v){let{basename:w}=ie.useContext($u),y=typeof c=="string"&&cK.test(c),b,x=!1;if(typeof c=="string"&&y&&(b=c,uK))try{let L=new URL(window.location.href),H=c.startsWith("//")?new URL(L.protocol+c):new URL(c),J=eh(H.pathname,w);H.origin===L.origin&&J!=null?c=J+H.search+H.hash:x=!0}catch{Dl(!1,`<Link to="${c}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let _=woe(c,{relative:i}),[T,D,P]=Zoe(n,m),O=ole(c,{replace:a,state:o,target:u,preventScrollReset:f,relative:i,viewTransition:g});function A(L){e&&e(L),L.defaultPrevented||O(L)}let W=ie.createElement("a",{...m,...P,href:b||_,onClick:x||s?e:A,ref:rle(v,D),target:u,"data-discover":!y&&r==="render"?"true":void 0});return T&&!y?ie.createElement(ie.Fragment,null,W,ie.createElement(Joe,{page:_})):W});EH.displayName="Link";var ile=ie.forwardRef(function({"aria-current":e="page",caseSensitive:r=!1,className:n="",end:i=!1,style:s,to:a,viewTransition:o,children:u,...c},f){let g=sS(a,{relative:c.relative}),m=Uu(),v=ie.useContext(vR),{navigator:w,basename:y}=ie.useContext($u),b=v!=null&&fle(g)&&o===!0,x=w.encodeLocation?w.encodeLocation(g).pathname:g.pathname,_=m.pathname,T=v&&v.navigation&&v.navigation.location?v.navigation.location.pathname:null;r||(_=_.toLowerCase(),T=T?T.toLowerCase():null,x=x.toLowerCase()),T&&y&&(T=eh(T,y)||T);const D=x!=="/"&&x.endsWith("/")?x.length-1:x.length;let P=_===x||!i&&_.startsWith(x)&&_.charAt(D)==="/",O=T!=null&&(T===x||!i&&T.startsWith(x)&&T.charAt(x.length)==="/"),A={isActive:P,isPending:O,isTransitioning:b},W=P?e:void 0,L;typeof n=="function"?L=n(A):L=[n,P?"active":null,O?"pending":null,b?"transitioning":null].filter(Boolean).join(" ");let H=typeof s=="function"?s(A):s;return ie.createElement(EH,{...c,"aria-current":W,className:L,ref:f,style:H,to:a,viewTransition:o},typeof u=="function"?u(A):u)});ile.displayName="NavLink";var sle=ie.forwardRef(({discover:t="render",fetcherKey:e,navigate:r,reloadDocument:n,replace:i,state:s,method:a=oE,action:o,onSubmit:u,relative:c,preventScrollReset:f,viewTransition:g,...m},v)=>{let w=cle(),y=hle(o,{relative:c}),b=a.toLowerCase()==="get"?"get":"post",x=typeof o=="string"&&cK.test(o),_=T=>{if(u&&u(T),T.defaultPrevented)return;T.preventDefault();let D=T.nativeEvent.submitter,P=D?.getAttribute("formmethod")||a;w(D||T.currentTarget,{fetcherKey:e,method:P,navigate:r,replace:i,state:s,relative:c,preventScrollReset:f,viewTransition:g})};return ie.createElement("form",{ref:v,method:b,action:y,onSubmit:n?u:_,...m,"data-discover":!x&&t==="render"?"true":void 0})});sle.displayName="Form";function ale(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function hK(t){let e=ie.useContext(qp);return Pn(e,ale(t)),e}function ole(t,{target:e,replace:r,state:n,preventScrollReset:i,relative:s,viewTransition:a}={}){let o=Yo(),u=Uu(),c=sS(t,{relative:s});return ie.useCallback(f=>{if(Boe(f,e)){f.preventDefault();let g=r!==void 0?r:h1(u)===h1(c);o(t,{replace:g,state:n,preventScrollReset:i,relative:s,viewTransition:a})}},[u,o,c,r,n,e,t,i,s,a])}var lle=0,ule=()=>`__${String(++lle)}__`;function cle(){let{router:t}=hK("useSubmit"),{basename:e}=ie.useContext($u),r=Aoe();return ie.useCallback(async(n,i={})=>{let{action:s,method:a,encType:o,formData:u,body:c}=$oe(n,e);if(i.navigate===!1){let f=i.fetcherKey||ule();await t.fetch(f,r,i.action||s,{preventScrollReset:i.preventScrollReset,formData:u,body:c,formMethod:i.method||a,formEncType:i.encType||o,flushSync:i.flushSync})}else await t.navigate(i.action||s,{preventScrollReset:i.preventScrollReset,formData:u,body:c,formMethod:i.method||a,formEncType:i.encType||o,replace:i.replace,state:i.state,fromRouteId:r,flushSync:i.flushSync,viewTransition:i.viewTransition})},[t,e,r])}function hle(t,{relative:e}={}){let{basename:r}=ie.useContext($u),n=ie.useContext(ah);Pn(n,"useFormAction must be used inside a RouteContext");let[i]=n.matches.slice(-1),s={...sS(t||".",{relative:e})},a=Uu();if(t==null){s.search=a.search;let o=new URLSearchParams(s.search),u=o.getAll("index");if(u.some(f=>f==="")){o.delete("index"),u.filter(g=>g).forEach(g=>o.append("index",g));let f=o.toString();s.search=f?`?${f}`:""}}return(!t||t===".")&&i.route.index&&(s.search=s.search?s.search.replace(/^\?/,"?index&"):"?index"),r!=="/"&&(s.pathname=s.pathname==="/"?r:jc([r,s.pathname])),h1(s)}function fle(t,{relative:e}={}){let r=ie.useContext(rK);Pn(r!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:n}=hK("useViewTransitionState"),i=sS(t,{relative:e});if(!r.isTransitioning)return!1;let s=eh(r.currentLocation.pathname,n)||r.currentLocation.pathname,a=eh(r.nextLocation.pathname,n)||r.nextLocation.pathname;return UE(i.pathname,a)!=null||UE(i.pathname,s)!=null}var fK=Kq();const _H=qq(fK);function dle(){const t=Yo();function e(){t("/login")}return Y.jsxs(Y.Fragment,{children:[Y.jsxs("div",{children:[Y.jsx("a",{href:"https://vite.dev",target:"_blank",className:"vite",children:Y.jsx("img",{src:jae,className:"logo",alt:"Vite logo"})}),Y.jsx("a",{href:"https://react.dev",target:"_blank",className:"react",children:Y.jsx("img",{src:Uae,className:"logo react",alt:"React logo"})})]}),Y.jsx("h1",{children:"Vite + React"}),Y.jsx("div",{className:"card",children:Y.jsx("button",{onClick:()=>e(),className:"viteLogin",children:"로그인"})}),Y.jsx("p",{className:"read-the-docs",children:"Click on the Vite and React logos to learn more"})]})}function gle({open:t,onClose:e}){return t?Y.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.45)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},children:Y.jsxs("div",{style:{background:"#23262f",borderRadius:12,padding:"32px 28px",boxShadow:"0 2px 12px rgba(0,0,0,0.18)",minWidth:320,textAlign:"center"},children:[Y.jsx("h2",{style:{color:"#00bcd4",marginBottom:18},children:"접근 거부"}),Y.jsxs("div",{style:{color:"#fff",marginBottom:24},children:["아이디 또는 비밀번호가 일치하지 않습니다.",Y.jsx("br",{}),"다시 시도해 주세요."]}),Y.jsx("button",{onClick:e,style:{padding:"10px 28px",borderRadius:6,background:"#00bcd4",color:"#181a20",border:"none",fontWeight:"bold",fontSize:16,cursor:"pointer"},children:"닫기"})]})}):null}const dK="fallback-key",jE=t=>new TextEncoder().encode(t),mle=t=>new TextDecoder().decode(t),ple=t=>{try{const e=jE(t),r=jE(dK),n=e.map((s,a)=>s^r[a%r.length]),i=String.fromCharCode(...n);return btoa(i)}catch(e){return console.error("Encryption failed:",e),""}},vle=t=>{try{const e=atob(t),r=jE(e),n=jE(dK),i=r.map((s,a)=>s^n[a%n.length]);return mle(Uint8Array.from(i))}catch(e){return console.error("Decryption failed:",e),null}},gK=ie.createContext(null);function wle({children:t}){const[e,r]=ie.useState(!1),[n,i]=ie.useState(null),s=()=>{i(null),sessionStorage.removeItem("user"),localStorage.removeItem("user")};return ie.useEffect(()=>{const a=sessionStorage.getItem("user");if(a)try{const o=vle(a);console.log(o);const u=JSON.parse(o);i(u)}catch(o){console.error("Failed to decode user data:",o)}r(!0)},[]),ie.useEffect(()=>{if(n&&e){const a=ple(JSON.stringify(n));sessionStorage.setItem("user",a),localStorage.setItem("user",a)}},[n,e]),e?Y.jsx(gK.Provider,{value:{user:n,setUser:i,logout:s},children:t}):null}function oh(){return ie.useContext(gK)}function Zg({open:t}){if(!t)return null;const e=Yo(),r=Uu(),n=()=>{e("/login",{state:{from:r.pathname}})};return Y.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},children:Y.jsxs("div",{style:{background:"#23262f",padding:32,borderRadius:12,minWidth:320,boxShadow:"0 2px 12px rgba(0,0,0,0.18)",color:"#fff",textAlign:"center"},children:[Y.jsx("h2",{style:{color:"#00bcd4",marginBottom:18},children:"로그인이 필요합니다"}),Y.jsx("div",{style:{marginBottom:24},children:"이 페이지는 로그인이 필요합니다."}),Y.jsx("button",{onClick:n,style:{width:"100%",padding:"12px 0",borderRadius:6,background:"#00bcd4",color:"#181a20",border:"none",fontWeight:"bold",fontSize:16,cursor:"pointer"},children:"로그인 페이지로 이동"})]})})}function yle({plates:t}){return t.length===0?Y.jsx("div",{id:"plate-empty-message",children:"등록된 차량번호가 없습니다."}):Y.jsx("ul",{id:"plate-list",children:t.map(e=>Y.jsx("li",{className:"plate-item",children:Y.jsx("span",{children:e.number})},e.id))})}function Sle(){const[t,e]=ie.useState(""),r=Yo(),{user:n}=oh(),[i,s]=ie.useState(!1);if(ie.useEffect(()=>{n||s(!0)},[n,r]),!n||!n.username)return Y.jsx(Zg,{open:i});const a=f=>{e(f.target.value)},o=()=>{r("/autoplus/plate/add")},c=[{id:1,number:"12가 3456"},{id:2,number:"34나 5678"},{id:3,number:"56다 9012"},{id:4,number:"78라 3456"},{id:5,number:"90마 7890"}].filter(f=>f.number.includes(t));return Y.jsx("div",{id:"plate-list-container",children:Y.jsxs("div",{id:"plate-list-content",children:[Y.jsx("h1",{id:"plate-list-title",children:"차량번호 목록"}),Y.jsxs("div",{id:"plate-list-actions",children:[Y.jsx("input",{type:"text",placeholder:"차량번호 검색...",value:t,onChange:a,id:"plate-search-input"}),Y.jsx("button",{onClick:o,id:"plate-add-button",children:"신규 차량번호 등록"})]}),Y.jsx(yle,{plates:c})]})})}const ble="modulepreload",Cle=function(t){return"/react_test/"+t},BW={},RH=function(e,r,n){let i=Promise.resolve();if(r&&r.length>0){let c=function(f){return Promise.all(f.map(g=>Promise.resolve(g).then(m=>({status:"fulfilled",value:m}),m=>({status:"rejected",reason:m}))))};var a=c;document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),u=o?.nonce||o?.getAttribute("nonce");i=c(r.map(f=>{if(f=Cle(f),f in BW)return;BW[f]=!0;const g=f.endsWith(".css"),m=g?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${f}"]${m}`))return;const v=document.createElement("link");if(v.rel=g?"stylesheet":ble,g||(v.as="script"),v.crossOrigin="",v.href=f,u&&v.setAttribute("nonce",u),document.head.appendChild(v),g)return new Promise((w,y)=>{v.addEventListener("load",w),v.addEventListener("error",()=>y(new Error(`Unable to preload CSS for ${f}`)))})}))}function s(o){const u=new Event("vite:preloadError",{cancelable:!0});if(u.payload=o,window.dispatchEvent(u),!u.defaultPrevented)throw o}return i.then(o=>{for(const u of o||[])u.status==="rejected"&&s(u.reason);return e().catch(s)})};function mK({isOpen:t,onClose:e,children:r}){return t?Y.jsx("div",{className:"register-success-modal-overlay",onClick:e,children:Y.jsxs("div",{className:"register-success-modal-content",onClick:n=>n.stopPropagation(),children:[r,Y.jsx("button",{className:"register-success-modal-close",onClick:e,children:"확인"})]})}):null}function pK({isOpen:t,onClose:e,errors:r}){return t?Y.jsx("div",{className:"modal-overlay",children:Y.jsxs("div",{className:"modal-content error-modal",children:[Y.jsx("h2",{children:"데이터 검증 실패"}),Y.jsx("div",{className:"error-list",children:r.map((n,i)=>Y.jsx("p",{className:"error-item",children:n},i))}),Y.jsx("button",{onClick:e,className:"close-button",children:"확인"})]})}):null}function LI(){return LI=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},LI.apply(null,arguments)}function xle(t){if(t.sheet)return t.sheet;for(var e=0;e<document.styleSheets.length;e++)if(document.styleSheets[e].ownerNode===t)return document.styleSheets[e]}function Ele(t){var e=document.createElement("style");return e.setAttribute("data-emotion",t.key),t.nonce!==void 0&&e.setAttribute("nonce",t.nonce),e.appendChild(document.createTextNode("")),e.setAttribute("data-s",""),e}var _le=function(){function t(r){var n=this;this._insertTag=function(i){var s;n.tags.length===0?n.insertionPoint?s=n.insertionPoint.nextSibling:n.prepend?s=n.container.firstChild:s=n.before:s=n.tags[n.tags.length-1].nextSibling,n.container.insertBefore(i,s),n.tags.push(i)},this.isSpeedy=r.speedy===void 0?!0:r.speedy,this.tags=[],this.ctr=0,this.nonce=r.nonce,this.key=r.key,this.container=r.container,this.prepend=r.prepend,this.insertionPoint=r.insertionPoint,this.before=null}var e=t.prototype;return e.hydrate=function(n){n.forEach(this._insertTag)},e.insert=function(n){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(Ele(this));var i=this.tags[this.tags.length-1];if(this.isSpeedy){var s=xle(i);try{s.insertRule(n,s.cssRules.length)}catch{}}else i.appendChild(document.createTextNode(n));this.ctr++},e.flush=function(){this.tags.forEach(function(n){var i;return(i=n.parentNode)==null?void 0:i.removeChild(n)}),this.tags=[],this.ctr=0},t}(),ds="-ms-",YE="-moz-",Ar="-webkit-",vK="comm",TH="rule",MH="decl",Rle="@import",wK="@keyframes",Tle="@layer",Mle=Math.abs,yR=String.fromCharCode,Ale=Object.assign;function Ole(t,e){return ts(t,0)^45?(((e<<2^ts(t,0))<<2^ts(t,1))<<2^ts(t,2))<<2^ts(t,3):0}function yK(t){return t.trim()}function kle(t,e){return(t=e.exec(t))?t[0]:t}function Or(t,e,r){return t.replace(e,r)}function BI(t,e){return t.indexOf(e)}function ts(t,e){return t.charCodeAt(e)|0}function f1(t,e,r){return t.slice(e,r)}function Su(t){return t.length}function AH(t){return t.length}function aC(t,e){return e.push(t),t}function Dle(t,e){return t.map(e).join("")}var SR=1,_p=1,SK=0,Sa=0,bi=0,Kp="";function bR(t,e,r,n,i,s,a){return{value:t,root:e,parent:r,type:n,props:i,children:s,line:SR,column:_p,length:a,return:""}}function fw(t,e){return Ale(bR("",null,null,"",null,null,0),t,{length:-t.length},e)}function Ple(){return bi}function Ile(){return bi=Sa>0?ts(Kp,--Sa):0,_p--,bi===10&&(_p=1,SR--),bi}function Ka(){return bi=Sa<SK?ts(Kp,Sa++):0,_p++,bi===10&&(_p=1,SR++),bi}function Pu(){return ts(Kp,Sa)}function uE(){return Sa}function aS(t,e){return f1(Kp,t,e)}function d1(t){switch(t){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function bK(t){return SR=_p=1,SK=Su(Kp=t),Sa=0,[]}function CK(t){return Kp="",t}function cE(t){return yK(aS(Sa-1,VI(t===91?t+2:t===40?t+1:t)))}function Nle(t){for(;(bi=Pu())&&bi<33;)Ka();return d1(t)>2||d1(bi)>3?"":" "}function Hle(t,e){for(;--e&&Ka()&&!(bi<48||bi>102||bi>57&&bi<65||bi>70&&bi<97););return aS(t,uE()+(e<6&&Pu()==32&&Ka()==32))}function VI(t){for(;Ka();)switch(bi){case t:return Sa;case 34:case 39:t!==34&&t!==39&&VI(bi);break;case 40:t===41&&VI(t);break;case 92:Ka();break}return Sa}function Fle(t,e){for(;Ka()&&t+bi!==57;)if(t+bi===84&&Pu()===47)break;return"/*"+aS(e,Sa-1)+"*"+yR(t===47?t:Ka())}function Lle(t){for(;!d1(Pu());)Ka();return aS(t,Sa)}function Ble(t){return CK(hE("",null,null,null,[""],t=bK(t),0,[0],t))}function hE(t,e,r,n,i,s,a,o,u){for(var c=0,f=0,g=a,m=0,v=0,w=0,y=1,b=1,x=1,_=0,T="",D=i,P=s,O=n,A=T;b;)switch(w=_,_=Ka()){case 40:if(w!=108&&ts(A,g-1)==58){BI(A+=Or(cE(_),"&","&\f"),"&\f")!=-1&&(x=-1);break}case 34:case 39:case 91:A+=cE(_);break;case 9:case 10:case 13:case 32:A+=Nle(w);break;case 92:A+=Hle(uE()-1,7);continue;case 47:switch(Pu()){case 42:case 47:aC(Vle(Fle(Ka(),uE()),e,r),u);break;default:A+="/"}break;case 123*y:o[c++]=Su(A)*x;case 125*y:case 59:case 0:switch(_){case 0:case 125:b=0;case 59+f:x==-1&&(A=Or(A,/\f/g,"")),v>0&&Su(A)-g&&aC(v>32?WW(A+";",n,r,g-1):WW(Or(A," ","")+";",n,r,g-2),u);break;case 59:A+=";";default:if(aC(O=VW(A,e,r,c,f,i,o,T,D=[],P=[],g),s),_===123)if(f===0)hE(A,e,O,O,D,s,g,o,P);else switch(m===99&&ts(A,3)===110?100:m){case 100:case 108:case 109:case 115:hE(t,O,O,n&&aC(VW(t,O,O,0,0,i,o,T,i,D=[],g),P),i,P,g,o,n?D:P);break;default:hE(A,O,O,O,[""],P,0,o,P)}}c=f=v=0,y=x=1,T=A="",g=a;break;case 58:g=1+Su(A),v=w;default:if(y<1){if(_==123)--y;else if(_==125&&y++==0&&Ile()==125)continue}switch(A+=yR(_),_*y){case 38:x=f>0?1:(A+="\f",-1);break;case 44:o[c++]=(Su(A)-1)*x,x=1;break;case 64:Pu()===45&&(A+=cE(Ka())),m=Pu(),f=g=Su(T=A+=Lle(uE())),_++;break;case 45:w===45&&Su(A)==2&&(y=0)}}return s}function VW(t,e,r,n,i,s,a,o,u,c,f){for(var g=i-1,m=i===0?s:[""],v=AH(m),w=0,y=0,b=0;w<n;++w)for(var x=0,_=f1(t,g+1,g=Mle(y=a[w])),T=t;x<v;++x)(T=yK(y>0?m[x]+" "+_:Or(_,/&\f/g,m[x])))&&(u[b++]=T);return bR(t,e,r,i===0?TH:o,u,c,f)}function Vle(t,e,r){return bR(t,e,r,vK,yR(Ple()),f1(t,2,-2),0)}function WW(t,e,r,n){return bR(t,e,r,MH,f1(t,0,n),f1(t,n+1,-1),n)}function lp(t,e){for(var r="",n=AH(t),i=0;i<n;i++)r+=e(t[i],i,t,e)||"";return r}function Wle(t,e,r,n){switch(t.type){case Tle:if(t.children.length)break;case Rle:case MH:return t.return=t.return||t.value;case vK:return"";case wK:return t.return=t.value+"{"+lp(t.children,n)+"}";case TH:t.value=t.props.join(",")}return Su(r=lp(t.children,n))?t.return=t.value+"{"+r+"}":""}function $le(t){var e=AH(t);return function(r,n,i,s){for(var a="",o=0;o<e;o++)a+=t[o](r,n,i,s)||"";return a}}function Ule(t){return function(e){e.root||(e=e.return)&&t(e)}}function xK(t){var e=Object.create(null);return function(r){return e[r]===void 0&&(e[r]=t(r)),e[r]}}var jle=function(e,r,n){for(var i=0,s=0;i=s,s=Pu(),i===38&&s===12&&(r[n]=1),!d1(s);)Ka();return aS(e,Sa)},Yle=function(e,r){var n=-1,i=44;do switch(d1(i)){case 0:i===38&&Pu()===12&&(r[n]=1),e[n]+=jle(Sa-1,r,n);break;case 2:e[n]+=cE(i);break;case 4:if(i===44){e[++n]=Pu()===58?"&\f":"",r[n]=e[n].length;break}default:e[n]+=yR(i)}while(i=Ka());return e},zle=function(e,r){return CK(Yle(bK(e),r))},$W=new WeakMap,Gle=function(e){if(!(e.type!=="rule"||!e.parent||e.length<1)){for(var r=e.value,n=e.parent,i=e.column===n.column&&e.line===n.line;n.type!=="rule";)if(n=n.parent,!n)return;if(!(e.props.length===1&&r.charCodeAt(0)!==58&&!$W.get(n))&&!i){$W.set(e,!0);for(var s=[],a=zle(r,s),o=n.props,u=0,c=0;u<a.length;u++)for(var f=0;f<o.length;f++,c++)e.props[c]=s[u]?a[u].replace(/&\f/g,o[f]):o[f]+" "+a[u]}}},qle=function(e){if(e.type==="decl"){var r=e.value;r.charCodeAt(0)===108&&r.charCodeAt(2)===98&&(e.return="",e.value="")}};function EK(t,e){switch(Ole(t,e)){case 5103:return Ar+"print-"+t+t;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return Ar+t+t;case 5349:case 4246:case 4810:case 6968:case 2756:return Ar+t+YE+t+ds+t+t;case 6828:case 4268:return Ar+t+ds+t+t;case 6165:return Ar+t+ds+"flex-"+t+t;case 5187:return Ar+t+Or(t,/(\w+).+(:[^]+)/,Ar+"box-$1$2"+ds+"flex-$1$2")+t;case 5443:return Ar+t+ds+"flex-item-"+Or(t,/flex-|-self/,"")+t;case 4675:return Ar+t+ds+"flex-line-pack"+Or(t,/align-content|flex-|-self/,"")+t;case 5548:return Ar+t+ds+Or(t,"shrink","negative")+t;case 5292:return Ar+t+ds+Or(t,"basis","preferred-size")+t;case 6060:return Ar+"box-"+Or(t,"-grow","")+Ar+t+ds+Or(t,"grow","positive")+t;case 4554:return Ar+Or(t,/([^-])(transform)/g,"$1"+Ar+"$2")+t;case 6187:return Or(Or(Or(t,/(zoom-|grab)/,Ar+"$1"),/(image-set)/,Ar+"$1"),t,"")+t;case 5495:case 3959:return Or(t,/(image-set\([^]*)/,Ar+"$1$`$1");case 4968:return Or(Or(t,/(.+:)(flex-)?(.*)/,Ar+"box-pack:$3"+ds+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+Ar+t+t;case 4095:case 3583:case 4068:case 2532:return Or(t,/(.+)-inline(.+)/,Ar+"$1$2")+t;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(Su(t)-1-e>6)switch(ts(t,e+1)){case 109:if(ts(t,e+4)!==45)break;case 102:return Or(t,/(.+:)(.+)-([^]+)/,"$1"+Ar+"$2-$3$1"+YE+(ts(t,e+3)==108?"$3":"$2-$3"))+t;case 115:return~BI(t,"stretch")?EK(Or(t,"stretch","fill-available"),e)+t:t}break;case 4949:if(ts(t,e+1)!==115)break;case 6444:switch(ts(t,Su(t)-3-(~BI(t,"!important")&&10))){case 107:return Or(t,":",":"+Ar)+t;case 101:return Or(t,/(.+:)([^;!]+)(;|!.+)?/,"$1"+Ar+(ts(t,14)===45?"inline-":"")+"box$3$1"+Ar+"$2$3$1"+ds+"$2box$3")+t}break;case 5936:switch(ts(t,e+11)){case 114:return Ar+t+ds+Or(t,/[svh]\w+-[tblr]{2}/,"tb")+t;case 108:return Ar+t+ds+Or(t,/[svh]\w+-[tblr]{2}/,"tb-rl")+t;case 45:return Ar+t+ds+Or(t,/[svh]\w+-[tblr]{2}/,"lr")+t}return Ar+t+ds+t+t}return t}var Kle=function(e,r,n,i){if(e.length>-1&&!e.return)switch(e.type){case MH:e.return=EK(e.value,e.length);break;case wK:return lp([fw(e,{value:Or(e.value,"@","@"+Ar)})],i);case TH:if(e.length)return Dle(e.props,function(s){switch(kle(s,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return lp([fw(e,{props:[Or(s,/:(read-\w+)/,":"+YE+"$1")]})],i);case"::placeholder":return lp([fw(e,{props:[Or(s,/:(plac\w+)/,":"+Ar+"input-$1")]}),fw(e,{props:[Or(s,/:(plac\w+)/,":"+YE+"$1")]}),fw(e,{props:[Or(s,/:(plac\w+)/,ds+"input-$1")]})],i)}return""})}},Xle=[Kle],Qle=function(e){var r=e.key;if(r==="css"){var n=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(n,function(y){var b=y.getAttribute("data-emotion");b.indexOf(" ")!==-1&&(document.head.appendChild(y),y.setAttribute("data-s",""))})}var i=e.stylisPlugins||Xle,s={},a,o=[];a=e.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+r+' "]'),function(y){for(var b=y.getAttribute("data-emotion").split(" "),x=1;x<b.length;x++)s[b[x]]=!0;o.push(y)});var u,c=[Gle,qle];{var f,g=[Wle,Ule(function(y){f.insert(y)})],m=$le(c.concat(i,g)),v=function(b){return lp(Ble(b),m)};u=function(b,x,_,T){f=_,v(b?b+"{"+x.styles+"}":x.styles),T&&(w.inserted[x.name]=!0)}}var w={key:r,sheet:new _le({key:r,container:a,nonce:e.nonce,speedy:e.speedy,prepend:e.prepend,insertionPoint:e.insertionPoint}),nonce:e.nonce,inserted:s,registered:{},insert:u};return w.sheet.hydrate(o),w},Zle=!0;function Jle(t,e,r){var n="";return r.split(" ").forEach(function(i){t[i]!==void 0?e.push(t[i]+";"):i&&(n+=i+" ")}),n}var _K=function(e,r,n){var i=e.key+"-"+r.name;(n===!1||Zle===!1)&&e.registered[i]===void 0&&(e.registered[i]=r.styles)},eue=function(e,r,n){_K(e,r,n);var i=e.key+"-"+r.name;if(e.inserted[r.name]===void 0){var s=r;do e.insert(r===s?"."+i:"",s,e.sheet,!0),s=s.next;while(s!==void 0)}};function tue(t){for(var e=0,r,n=0,i=t.length;i>=4;++n,i-=4)r=t.charCodeAt(n)&255|(t.charCodeAt(++n)&255)<<8|(t.charCodeAt(++n)&255)<<16|(t.charCodeAt(++n)&255)<<24,r=(r&65535)*1540483477+((r>>>16)*59797<<16),r^=r>>>24,e=(r&65535)*1540483477+((r>>>16)*59797<<16)^(e&65535)*1540483477+((e>>>16)*59797<<16);switch(i){case 3:e^=(t.charCodeAt(n+2)&255)<<16;case 2:e^=(t.charCodeAt(n+1)&255)<<8;case 1:e^=t.charCodeAt(n)&255,e=(e&65535)*1540483477+((e>>>16)*59797<<16)}return e^=e>>>13,e=(e&65535)*1540483477+((e>>>16)*59797<<16),((e^e>>>15)>>>0).toString(36)}var rue={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,scale:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},nue=/[A-Z]|^ms/g,iue=/_EMO_([^_]+?)_([^]*?)_EMO_/g,RK=function(e){return e.charCodeAt(1)===45},UW=function(e){return e!=null&&typeof e!="boolean"},nO=xK(function(t){return RK(t)?t:t.replace(nue,"-$&").toLowerCase()}),jW=function(e,r){switch(e){case"animation":case"animationName":if(typeof r=="string")return r.replace(iue,function(n,i,s){return bu={name:i,styles:s,next:bu},i})}return rue[e]!==1&&!RK(e)&&typeof r=="number"&&r!==0?r+"px":r};function g1(t,e,r){if(r==null)return"";var n=r;if(n.__emotion_styles!==void 0)return n;switch(typeof r){case"boolean":return"";case"object":{var i=r;if(i.anim===1)return bu={name:i.name,styles:i.styles,next:bu},i.name;var s=r;if(s.styles!==void 0){var a=s.next;if(a!==void 0)for(;a!==void 0;)bu={name:a.name,styles:a.styles,next:bu},a=a.next;var o=s.styles+";";return o}return sue(t,e,r)}case"function":{if(t!==void 0){var u=bu,c=r(t);return bu=u,g1(t,e,c)}break}}var f=r;if(e==null)return f;var g=e[f];return g!==void 0?g:f}function sue(t,e,r){var n="";if(Array.isArray(r))for(var i=0;i<r.length;i++)n+=g1(t,e,r[i])+";";else for(var s in r){var a=r[s];if(typeof a!="object"){var o=a;e!=null&&e[o]!==void 0?n+=s+"{"+e[o]+"}":UW(o)&&(n+=nO(s)+":"+jW(s,o)+";")}else if(Array.isArray(a)&&typeof a[0]=="string"&&(e==null||e[a[0]]===void 0))for(var u=0;u<a.length;u++)UW(a[u])&&(n+=nO(s)+":"+jW(s,a[u])+";");else{var c=g1(t,e,a);switch(s){case"animation":case"animationName":{n+=nO(s)+":"+c+";";break}default:n+=s+"{"+c+"}"}}}return n}var YW=/label:\s*([^\s;{]+)\s*(;|$)/g,bu;function aue(t,e,r){if(t.length===1&&typeof t[0]=="object"&&t[0]!==null&&t[0].styles!==void 0)return t[0];var n=!0,i="";bu=void 0;var s=t[0];if(s==null||s.raw===void 0)n=!1,i+=g1(r,e,s);else{var a=s;i+=a[0]}for(var o=1;o<t.length;o++)if(i+=g1(r,e,t[o]),n){var u=s;i+=u[o]}YW.lastIndex=0;for(var c="",f;(f=YW.exec(i))!==null;)c+="-"+f[1];var g=tue(i)+c;return{name:g,styles:i,next:bu}}var oue=function(e){return e()},lue=$E.useInsertionEffect?$E.useInsertionEffect:!1,uue=lue||oue,TK=ie.createContext(typeof HTMLElement<"u"?Qle({key:"css"}):null);TK.Provider;var cue=function(e){return ie.forwardRef(function(r,n){var i=ie.useContext(TK);return e(r,i,n)})},hue=ie.createContext({}),fue=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|disableRemotePlayback|download|draggable|encType|enterKeyHint|fetchpriority|fetchPriority|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,due=xK(function(t){return fue.test(t)||t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&t.charCodeAt(2)<91}),gue=due,mue=function(e){return e!=="theme"},zW=function(e){return typeof e=="string"&&e.charCodeAt(0)>96?gue:mue},GW=function(e,r,n){var i;if(r){var s=r.shouldForwardProp;i=e.__emotion_forwardProp&&s?function(a){return e.__emotion_forwardProp(a)&&s(a)}:s}return typeof i!="function"&&n&&(i=e.__emotion_forwardProp),i},pue=function(e){var r=e.cache,n=e.serialized,i=e.isStringTag;return _K(r,n,i),uue(function(){return eue(r,n,i)}),null},vue=function t(e,r){var n=e.__emotion_real===e,i=n&&e.__emotion_base||e,s,a;r!==void 0&&(s=r.label,a=r.target);var o=GW(e,r,n),u=o||zW(i),c=!u("as");return function(){var f=arguments,g=n&&e.__emotion_styles!==void 0?e.__emotion_styles.slice(0):[];if(s!==void 0&&g.push("label:"+s+";"),f[0]==null||f[0].raw===void 0)g.push.apply(g,f);else{var m=f[0];g.push(m[0]);for(var v=f.length,w=1;w<v;w++)g.push(f[w],m[w])}var y=cue(function(b,x,_){var T=c&&b.as||i,D="",P=[],O=b;if(b.theme==null){O={};for(var A in b)O[A]=b[A];O.theme=ie.useContext(hue)}typeof b.className=="string"?D=Jle(x.registered,P,b.className):b.className!=null&&(D=b.className+" ");var W=aue(g.concat(P),x.registered,O);D+=x.key+"-"+W.name,a!==void 0&&(D+=" "+a);var L=c&&o===void 0?zW(T):u,H={};for(var J in b)c&&J==="as"||L(J)&&(H[J]=b[J]);return H.className=D,_&&(H.ref=_),ie.createElement(ie.Fragment,null,ie.createElement(pue,{cache:x,serialized:W,isStringTag:typeof T=="string"}),ie.createElement(T,H))});return y.displayName=s!==void 0?s:"Styled("+(typeof i=="string"?i:i.displayName||i.name||"Component")+")",y.defaultProps=e.defaultProps,y.__emotion_real=y,y.__emotion_base=i,y.__emotion_styles=g,y.__emotion_forwardProp=o,Object.defineProperty(y,"toString",{value:function(){return"."+a}}),y.withComponent=function(b,x){var _=t(b,LI({},r,x,{shouldForwardProp:GW(y,x,!0)}));return _.apply(void 0,g)},y}},wue=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"],m1=vue.bind(null);wue.forEach(function(t){m1[t]=m1(t)});const yue=m1.div`
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-color: rgba(0, 0, 0, 0.5);
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 1000;
`,Sue=m1.div`
    background-color: white;
    border-radius: 8px;
    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    max-height: 90vh;
    overflow-y: auto;
    position: relative;
    overflow-x: hidden;
`,bue=m1.button`
    position: absolute;
    top: 10px;
    right: 10px;
    background: none;
    border: none;
    font-size: 20px;
    cursor: pointer;
    padding: 5px;
    color: #666;
    max-width: 30px;
    
    &:hover {
        color: #000;
    }
`;function MK({isOpen:t,onClose:e,children:r}){return t?Y.jsx(yue,{onClick:e,children:Y.jsxs(Sue,{onClick:n=>n.stopPropagation(),children:[Y.jsx(bue,{onClick:e,children:"×"}),r]})}):null}function WI({isOpen:t,onClose:e,onSelect:r,plates:n,selectedPlateNumbers:i=[]}){const[s,a]=ie.useState(""),[o,u]=ie.useState([]);return ie.useEffect(()=>{u(n.filter(c=>!i.includes(c.number)).filter(c=>c.number.toLowerCase().includes(s.toLowerCase())))},[s,n,i]),Y.jsx(MK,{isOpen:t,onClose:e,children:Y.jsxs("div",{className:"plate-search-modal",children:[Y.jsx("h2",{children:"차량번호 검색"}),Y.jsx("div",{className:"plate-search-box",children:Y.jsx("input",{type:"text",placeholder:"차량번호를 입력하세요",value:s,onChange:c=>a(c.target.value)})}),Y.jsx("div",{className:"plates-list",children:o.map(c=>Y.jsx("div",{className:"plate-item",onClick:()=>{r(c),e()},children:c.number},c.id))})]})})}var qW={},dw,KW;function li(){if(KW)return dw;KW=1;var t=function(e){return e&&e.Math===Math&&e};return dw=t(typeof globalThis=="object"&&globalThis)||t(typeof window=="object"&&window)||t(typeof self=="object"&&self)||t(typeof xW=="object"&&xW)||t(typeof dw=="object"&&dw)||function(){return this}()||Function("return this")(),dw}var iO={},sO,XW;function Ci(){return XW||(XW=1,sO=function(t){try{return!!t()}catch{return!0}}),sO}var aO,QW;function zo(){if(QW)return aO;QW=1;var t=Ci();return aO=!t(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7}),aO}var oO,ZW;function CR(){if(ZW)return oO;ZW=1;var t=Ci();return oO=!t(function(){var e=(function(){}).bind();return typeof e!="function"||e.hasOwnProperty("prototype")}),oO}var lO,JW;function xi(){if(JW)return lO;JW=1;var t=CR(),e=Function.prototype.call;return lO=t?e.bind(e):function(){return e.apply(e,arguments)},lO}var uO={},e$;function Cue(){if(e$)return uO;e$=1;var t={}.propertyIsEnumerable,e=Object.getOwnPropertyDescriptor,r=e&&!t.call({1:2},1);return uO.f=r?function(i){var s=e(this,i);return!!s&&s.enumerable}:t,uO}var cO,t$;function xR(){return t$||(t$=1,cO=function(t,e){return{enumerable:!(t&1),configurable:!(t&2),writable:!(t&4),value:e}}),cO}var hO,r$;function ui(){if(r$)return hO;r$=1;var t=CR(),e=Function.prototype,r=e.call,n=t&&e.bind.bind(r,r);return hO=t?n:function(i){return function(){return r.apply(i,arguments)}},hO}var fO,n$;function Jg(){if(n$)return fO;n$=1;var t=ui(),e=t({}.toString),r=t("".slice);return fO=function(n){return r(e(n),8,-1)},fO}var dO,i$;function xue(){if(i$)return dO;i$=1;var t=ui(),e=Ci(),r=Jg(),n=Object,i=t("".split);return dO=e(function(){return!n("z").propertyIsEnumerable(0)})?function(s){return r(s)==="String"?i(s,""):n(s)}:n,dO}var gO,s$;function OH(){return s$||(s$=1,gO=function(t){return t==null}),gO}var mO,a$;function oS(){if(a$)return mO;a$=1;var t=OH(),e=TypeError;return mO=function(r){if(t(r))throw new e("Can't call method on "+r);return r},mO}var pO,o$;function lS(){if(o$)return pO;o$=1;var t=xue(),e=oS();return pO=function(r){return t(e(r))},pO}var vO,l$;function Ei(){if(l$)return vO;l$=1;var t=typeof document=="object"&&document.all;return vO=typeof t>"u"&&t!==void 0?function(e){return typeof e=="function"||e===t}:function(e){return typeof e=="function"},vO}var wO,u$;function Go(){if(u$)return wO;u$=1;var t=Ei();return wO=function(e){return typeof e=="object"?e!==null:t(e)},wO}var yO,c$;function Xp(){if(c$)return yO;c$=1;var t=li(),e=Ei(),r=function(n){return e(n)?n:void 0};return yO=function(n,i){return arguments.length<2?r(t[n]):t[n]&&t[n][i]},yO}var SO,h$;function uS(){if(h$)return SO;h$=1;var t=ui();return SO=t({}.isPrototypeOf),SO}var bO,f$;function ER(){if(f$)return bO;f$=1;var t=li(),e=t.navigator,r=e&&e.userAgent;return bO=r?String(r):"",bO}var CO,d$;function Eue(){if(d$)return CO;d$=1;var t=li(),e=ER(),r=t.process,n=t.Deno,i=r&&r.versions||n&&n.version,s=i&&i.v8,a,o;return s&&(a=s.split("."),o=a[0]>0&&a[0]<4?1:+(a[0]+a[1])),!o&&e&&(a=e.match(/Edge\/(\d+)/),(!a||a[1]>=74)&&(a=e.match(/Chrome\/(\d+)/),a&&(o=+a[1]))),CO=o,CO}var xO,g$;function kH(){if(g$)return xO;g$=1;var t=Eue(),e=Ci(),r=li(),n=r.String;return xO=!!Object.getOwnPropertySymbols&&!e(function(){var i=Symbol("symbol detection");return!n(i)||!(Object(i)instanceof Symbol)||!Symbol.sham&&t&&t<41}),xO}var EO,m$;function AK(){if(m$)return EO;m$=1;var t=kH();return EO=t&&!Symbol.sham&&typeof Symbol.iterator=="symbol",EO}var _O,p$;function DH(){if(p$)return _O;p$=1;var t=Xp(),e=Ei(),r=uS(),n=AK(),i=Object;return _O=n?function(s){return typeof s=="symbol"}:function(s){var a=t("Symbol");return e(a)&&r(a.prototype,i(s))},_O}var RO,v$;function _R(){if(v$)return RO;v$=1;var t=String;return RO=function(e){try{return t(e)}catch{return"Object"}},RO}var TO,w$;function ba(){if(w$)return TO;w$=1;var t=Ei(),e=_R(),r=TypeError;return TO=function(n){if(t(n))return n;throw new r(e(n)+" is not a function")},TO}var MO,y$;function cS(){if(y$)return MO;y$=1;var t=ba(),e=OH();return MO=function(r,n){var i=r[n];return e(i)?void 0:t(i)},MO}var AO,S$;function _ue(){if(S$)return AO;S$=1;var t=xi(),e=Ei(),r=Go(),n=TypeError;return AO=function(i,s){var a,o;if(s==="string"&&e(a=i.toString)&&!r(o=t(a,i))||e(a=i.valueOf)&&!r(o=t(a,i))||s!=="string"&&e(a=i.toString)&&!r(o=t(a,i)))return o;throw new n("Can't convert object to primitive value")},AO}var OO={exports:{}},kO,b$;function Kf(){return b$||(b$=1,kO=!1),kO}var DO,C$;function PH(){if(C$)return DO;C$=1;var t=li(),e=Object.defineProperty;return DO=function(r,n){try{e(t,r,{value:n,configurable:!0,writable:!0})}catch{t[r]=n}return n},DO}var x$;function IH(){if(x$)return OO.exports;x$=1;var t=Kf(),e=li(),r=PH(),n="__core-js_shared__",i=OO.exports=e[n]||r(n,{});return(i.versions||(i.versions=[])).push({version:"3.45.0",mode:t?"pure":"global",copyright:"© 2014-2025 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.45.0/LICENSE",source:"https://github.com/zloirock/core-js"}),OO.exports}var PO,E$;function OK(){if(E$)return PO;E$=1;var t=IH();return PO=function(e,r){return t[e]||(t[e]=r||{})},PO}var IO,_$;function Qp(){if(_$)return IO;_$=1;var t=oS(),e=Object;return IO=function(r){return e(t(r))},IO}var NO,R$;function qo(){if(R$)return NO;R$=1;var t=ui(),e=Qp(),r=t({}.hasOwnProperty);return NO=Object.hasOwn||function(i,s){return r(e(i),s)},NO}var HO,T$;function kK(){if(T$)return HO;T$=1;var t=ui(),e=0,r=Math.random(),n=t(1.1.toString);return HO=function(i){return"Symbol("+(i===void 0?"":i)+")_"+n(++e+r,36)},HO}var FO,M$;function Fl(){if(M$)return FO;M$=1;var t=li(),e=OK(),r=qo(),n=kK(),i=kH(),s=AK(),a=t.Symbol,o=e("wks"),u=s?a.for||a:a&&a.withoutSetter||n;return FO=function(c){return r(o,c)||(o[c]=i&&r(a,c)?a[c]:u("Symbol."+c)),o[c]},FO}var LO,A$;function Rue(){if(A$)return LO;A$=1;var t=xi(),e=Go(),r=DH(),n=cS(),i=_ue(),s=Fl(),a=TypeError,o=s("toPrimitive");return LO=function(u,c){if(!e(u)||r(u))return u;var f=n(u,o),g;if(f){if(c===void 0&&(c="default"),g=t(f,u,c),!e(g)||r(g))return g;throw new a("Can't convert object to primitive value")}return c===void 0&&(c="number"),i(u,c)},LO}var BO,O$;function DK(){if(O$)return BO;O$=1;var t=Rue(),e=DH();return BO=function(r){var n=t(r,"string");return e(n)?n:n+""},BO}var VO,k$;function NH(){if(k$)return VO;k$=1;var t=li(),e=Go(),r=t.document,n=e(r)&&e(r.createElement);return VO=function(i){return n?r.createElement(i):{}},VO}var WO,D$;function PK(){if(D$)return WO;D$=1;var t=zo(),e=Ci(),r=NH();return WO=!t&&!e(function(){return Object.defineProperty(r("div"),"a",{get:function(){return 7}}).a!==7}),WO}var P$;function IK(){if(P$)return iO;P$=1;var t=zo(),e=xi(),r=Cue(),n=xR(),i=lS(),s=DK(),a=qo(),o=PK(),u=Object.getOwnPropertyDescriptor;return iO.f=t?u:function(f,g){if(f=i(f),g=s(g),o)try{return u(f,g)}catch{}if(a(f,g))return n(!e(r.f,f,g),f[g])},iO}var $O={},UO,I$;function NK(){if(I$)return UO;I$=1;var t=zo(),e=Ci();return UO=t&&e(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42}),UO}var jO,N$;function _i(){if(N$)return jO;N$=1;var t=Go(),e=String,r=TypeError;return jO=function(n){if(t(n))return n;throw new r(e(n)+" is not an object")},jO}var H$;function Xf(){if(H$)return $O;H$=1;var t=zo(),e=PK(),r=NK(),n=_i(),i=DK(),s=TypeError,a=Object.defineProperty,o=Object.getOwnPropertyDescriptor,u="enumerable",c="configurable",f="writable";return $O.f=t?r?function(m,v,w){if(n(m),v=i(v),n(w),typeof m=="function"&&v==="prototype"&&"value"in w&&f in w&&!w[f]){var y=o(m,v);y&&y[f]&&(m[v]=w.value,w={configurable:c in w?w[c]:y[c],enumerable:u in w?w[u]:y[u],writable:!1})}return a(m,v,w)}:a:function(m,v,w){if(n(m),v=i(v),n(w),e)try{return a(m,v,w)}catch{}if("get"in w||"set"in w)throw new s("Accessors not supported");return"value"in w&&(m[v]=w.value),m},$O}var YO,F$;function Zp(){if(F$)return YO;F$=1;var t=zo(),e=Xf(),r=xR();return YO=t?function(n,i,s){return e.f(n,i,r(1,s))}:function(n,i,s){return n[i]=s,n},YO}var zO={exports:{}},GO,L$;function Tue(){if(L$)return GO;L$=1;var t=zo(),e=qo(),r=Function.prototype,n=t&&Object.getOwnPropertyDescriptor,i=e(r,"name"),s=i&&(function(){}).name==="something",a=i&&(!t||t&&n(r,"name").configurable);return GO={EXISTS:i,PROPER:s,CONFIGURABLE:a},GO}var qO,B$;function Mue(){if(B$)return qO;B$=1;var t=ui(),e=Ei(),r=IH(),n=t(Function.toString);return e(r.inspectSource)||(r.inspectSource=function(i){return n(i)}),qO=r.inspectSource,qO}var KO,V$;function Aue(){if(V$)return KO;V$=1;var t=li(),e=Ei(),r=t.WeakMap;return KO=e(r)&&/native code/.test(String(r)),KO}var XO,W$;function HH(){if(W$)return XO;W$=1;var t=OK(),e=kK(),r=t("keys");return XO=function(n){return r[n]||(r[n]=e(n))},XO}var QO,$$;function FH(){return $$||($$=1,QO={}),QO}var ZO,U$;function HK(){if(U$)return ZO;U$=1;var t=Aue(),e=li(),r=Go(),n=Zp(),i=qo(),s=IH(),a=HH(),o=FH(),u="Object already initialized",c=e.TypeError,f=e.WeakMap,g,m,v,w=function(_){return v(_)?m(_):g(_,{})},y=function(_){return function(T){var D;if(!r(T)||(D=m(T)).type!==_)throw new c("Incompatible receiver, "+_+" required");return D}};if(t||s.state){var b=s.state||(s.state=new f);b.get=b.get,b.has=b.has,b.set=b.set,g=function(_,T){if(b.has(_))throw new c(u);return T.facade=_,b.set(_,T),T},m=function(_){return b.get(_)||{}},v=function(_){return b.has(_)}}else{var x=a("state");o[x]=!0,g=function(_,T){if(i(_,x))throw new c(u);return T.facade=_,n(_,x,T),T},m=function(_){return i(_,x)?_[x]:{}},v=function(_){return i(_,x)}}return ZO={set:g,get:m,has:v,enforce:w,getterFor:y},ZO}var j$;function FK(){if(j$)return zO.exports;j$=1;var t=ui(),e=Ci(),r=Ei(),n=qo(),i=zo(),s=Tue().CONFIGURABLE,a=Mue(),o=HK(),u=o.enforce,c=o.get,f=String,g=Object.defineProperty,m=t("".slice),v=t("".replace),w=t([].join),y=i&&!e(function(){return g(function(){},"length",{value:8}).length!==8}),b=String(String).split("String"),x=zO.exports=function(_,T,D){m(f(T),0,7)==="Symbol("&&(T="["+v(f(T),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),D&&D.getter&&(T="get "+T),D&&D.setter&&(T="set "+T),(!n(_,"name")||s&&_.name!==T)&&(i?g(_,"name",{value:T,configurable:!0}):_.name=T),y&&D&&n(D,"arity")&&_.length!==D.arity&&g(_,"length",{value:D.arity});try{D&&n(D,"constructor")&&D.constructor?i&&g(_,"prototype",{writable:!1}):_.prototype&&(_.prototype=void 0)}catch{}var P=u(_);return n(P,"source")||(P.source=w(b,typeof T=="string"?T:"")),_};return Function.prototype.toString=x(function(){return r(this)&&c(this).source||a(this)},"toString"),zO.exports}var JO,Y$;function LH(){if(Y$)return JO;Y$=1;var t=Ei(),e=Xf(),r=FK(),n=PH();return JO=function(i,s,a,o){o||(o={});var u=o.enumerable,c=o.name!==void 0?o.name:s;if(t(a)&&r(a,c,o),o.global)u?i[s]=a:n(s,a);else{try{o.unsafe?i[s]&&(u=!0):delete i[s]}catch{}u?i[s]=a:e.f(i,s,{value:a,enumerable:!1,configurable:!o.nonConfigurable,writable:!o.nonWritable})}return i},JO}var ek={},tk,z$;function Oue(){if(z$)return tk;z$=1;var t=Math.ceil,e=Math.floor;return tk=Math.trunc||function(n){var i=+n;return(i>0?e:t)(i)},tk}var rk,G$;function hS(){if(G$)return rk;G$=1;var t=Oue();return rk=function(e){var r=+e;return r!==r||r===0?0:t(r)},rk}var nk,q$;function kue(){if(q$)return nk;q$=1;var t=hS(),e=Math.max,r=Math.min;return nk=function(n,i){var s=t(n);return s<0?e(s+i,0):r(s,i)},nk}var ik,K$;function Due(){if(K$)return ik;K$=1;var t=hS(),e=Math.min;return ik=function(r){var n=t(r);return n>0?e(n,9007199254740991):0},ik}var sk,X$;function Jp(){if(X$)return sk;X$=1;var t=Due();return sk=function(e){return t(e.length)},sk}var ak,Q$;function Pue(){if(Q$)return ak;Q$=1;var t=lS(),e=kue(),r=Jp(),n=function(i){return function(s,a,o){var u=t(s),c=r(u);if(c===0)return!i&&-1;var f=e(o,c),g;if(i&&a!==a){for(;c>f;)if(g=u[f++],g!==g)return!0}else for(;c>f;f++)if((i||f in u)&&u[f]===a)return i||f||0;return!i&&-1}};return ak={includes:n(!0),indexOf:n(!1)},ak}var ok,Z$;function LK(){if(Z$)return ok;Z$=1;var t=ui(),e=qo(),r=lS(),n=Pue().indexOf,i=FH(),s=t([].push);return ok=function(a,o){var u=r(a),c=0,f=[],g;for(g in u)!e(i,g)&&e(u,g)&&s(f,g);for(;o.length>c;)e(u,g=o[c++])&&(~n(f,g)||s(f,g));return f},ok}var lk,J$;function BH(){return J$||(J$=1,lk=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]),lk}var eU;function Iue(){if(eU)return ek;eU=1;var t=LK(),e=BH(),r=e.concat("length","prototype");return ek.f=Object.getOwnPropertyNames||function(i){return t(i,r)},ek}var uk={},tU;function Nue(){return tU||(tU=1,uk.f=Object.getOwnPropertySymbols),uk}var ck,rU;function Hue(){if(rU)return ck;rU=1;var t=Xp(),e=ui(),r=Iue(),n=Nue(),i=_i(),s=e([].concat);return ck=t("Reflect","ownKeys")||function(o){var u=r.f(i(o)),c=n.f;return c?s(u,c(o)):u},ck}var hk,nU;function BK(){if(nU)return hk;nU=1;var t=qo(),e=Hue(),r=IK(),n=Xf();return hk=function(i,s,a){for(var o=e(s),u=n.f,c=r.f,f=0;f<o.length;f++){var g=o[f];!t(i,g)&&!(a&&t(a,g))&&u(i,g,c(s,g))}},hk}var fk,iU;function Fue(){if(iU)return fk;iU=1;var t=Ci(),e=Ei(),r=/#|\.prototype\./,n=function(u,c){var f=s[i(u)];return f===o?!0:f===a?!1:e(c)?t(c):!!c},i=n.normalize=function(u){return String(u).replace(r,".").toLowerCase()},s=n.data={},a=n.NATIVE="N",o=n.POLYFILL="P";return fk=n,fk}var dk,sU;function nn(){if(sU)return dk;sU=1;var t=li(),e=IK().f,r=Zp(),n=LH(),i=PH(),s=BK(),a=Fue();return dk=function(o,u){var c=o.target,f=o.global,g=o.stat,m,v,w,y,b,x;if(f?v=t:g?v=t[c]||i(c,{}):v=t[c]&&t[c].prototype,v)for(w in u){if(b=u[w],o.dontCallGetSet?(x=e(v,w),y=x&&x.value):y=v[w],m=a(f?w:c+(g?".":"#")+w,o.forced),!m&&y!==void 0){if(typeof b==typeof y)continue;s(b,y)}(o.sham||y&&y.sham)&&r(b,"sham",!0),n(v,w,b,o)}},dk}var gk,aU;function fS(){if(aU)return gk;aU=1;var t=CR(),e=Function.prototype,r=e.apply,n=e.call;return gk=typeof Reflect=="object"&&Reflect.apply||(t?n.bind(r):function(){return n.apply(r,arguments)}),gk}var mk,oU;function VK(){if(oU)return mk;oU=1;var t=ui(),e=ba();return mk=function(r,n,i){try{return t(e(Object.getOwnPropertyDescriptor(r,n)[i]))}catch{}},mk}var pk,lU;function Lue(){if(lU)return pk;lU=1;var t=Go();return pk=function(e){return t(e)||e===null},pk}var vk,uU;function Bue(){if(uU)return vk;uU=1;var t=Lue(),e=String,r=TypeError;return vk=function(n){if(t(n))return n;throw new r("Can't set "+e(n)+" as a prototype")},vk}var wk,cU;function WK(){if(cU)return wk;cU=1;var t=VK(),e=Go(),r=oS(),n=Bue();return wk=Object.setPrototypeOf||("__proto__"in{}?function(){var i=!1,s={},a;try{a=t(Object.prototype,"__proto__","set"),a(s,[]),i=s instanceof Array}catch{}return function(u,c){return r(u),n(c),e(u)&&(i?a(u,c):u.__proto__=c),u}}():void 0),wk}var yk,hU;function Vue(){if(hU)return yk;hU=1;var t=Xf().f;return yk=function(e,r,n){n in e||t(e,n,{configurable:!0,get:function(){return r[n]},set:function(i){r[n]=i}})},yk}var Sk,fU;function Wue(){if(fU)return Sk;fU=1;var t=Ei(),e=Go(),r=WK();return Sk=function(n,i,s){var a,o;return r&&t(a=i.constructor)&&a!==s&&e(o=a.prototype)&&o!==s.prototype&&r(n,o),n},Sk}var bk,dU;function $ue(){if(dU)return bk;dU=1;var t=Fl(),e=t("toStringTag"),r={};return r[e]="z",bk=String(r)==="[object z]",bk}var Ck,gU;function $K(){if(gU)return Ck;gU=1;var t=$ue(),e=Ei(),r=Jg(),n=Fl(),i=n("toStringTag"),s=Object,a=r(function(){return arguments}())==="Arguments",o=function(u,c){try{return u[c]}catch{}};return Ck=t?r:function(u){var c,f,g;return u===void 0?"Undefined":u===null?"Null":typeof(f=o(c=s(u),i))=="string"?f:a?r(c):(g=r(c))==="Object"&&e(c.callee)?"Arguments":g},Ck}var xk,mU;function RR(){if(mU)return xk;mU=1;var t=$K(),e=String;return xk=function(r){if(t(r)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return e(r)},xk}var Ek,pU;function Uue(){if(pU)return Ek;pU=1;var t=RR();return Ek=function(e,r){return e===void 0?arguments.length<2?"":r:t(e)},Ek}var _k,vU;function jue(){if(vU)return _k;vU=1;var t=Go(),e=Zp();return _k=function(r,n){t(n)&&"cause"in n&&e(r,"cause",n.cause)},_k}var Rk,wU;function Yue(){if(wU)return Rk;wU=1;var t=ui(),e=Error,r=t("".replace),n=function(a){return String(new e(a).stack)}("zxcasd"),i=/\n\s*at [^:]*:[^\n]*/,s=i.test(n);return Rk=function(a,o){if(s&&typeof a=="string"&&!e.prepareStackTrace)for(;o--;)a=r(a,i,"");return a},Rk}var Tk,yU;function zue(){if(yU)return Tk;yU=1;var t=Ci(),e=xR();return Tk=!t(function(){var r=new Error("a");return"stack"in r?(Object.defineProperty(r,"stack",e(1,7)),r.stack!==7):!0}),Tk}var Mk,SU;function Gue(){if(SU)return Mk;SU=1;var t=Zp(),e=Yue(),r=zue(),n=Error.captureStackTrace;return Mk=function(i,s,a,o){r&&(n?n(i,s):t(i,"stack",e(a,o)))},Mk}var Ak,bU;function que(){if(bU)return Ak;bU=1;var t=Xp(),e=qo(),r=Zp(),n=uS(),i=WK(),s=BK(),a=Vue(),o=Wue(),u=Uue(),c=jue(),f=Gue(),g=zo(),m=Kf();return Ak=function(v,w,y,b){var x="stackTraceLimit",_=b?2:1,T=v.split("."),D=T[T.length-1],P=t.apply(null,T);if(P){var O=P.prototype;if(!m&&e(O,"cause")&&delete O.cause,!y)return P;var A=t("Error"),W=w(function(L,H){var J=u(b?H:L,void 0),G=b?new P(L):new P;return J!==void 0&&r(G,"message",J),f(G,W,G.stack,2),this&&n(O,this)&&o(G,this,W),arguments.length>_&&c(G,arguments[_]),G});if(W.prototype=O,D!=="Error"?i?i(W,A):s(W,A,{name:!0}):g&&x in P&&(a(W,P,x),a(W,P,"prepareStackTrace")),s(W,P),!m)try{O.name!==D&&r(O,"name",D),O.constructor=W}catch{}return W}},Ak}var CU;function Kue(){if(CU)return qW;CU=1;var t=nn(),e=li(),r=fS(),n=que(),i="WebAssembly",s=e[i],a=new Error("e",{cause:7}).cause!==7,o=function(c,f){var g={};g[c]=n(c,f,a),t({global:!0,constructor:!0,arity:1,forced:a},g)},u=function(c,f){if(s&&s[c]){var g={};g[c]=n(i+"."+c,f,a),t({target:i,stat:!0,constructor:!0,arity:1,forced:a},g)}};return o("Error",function(c){return function(g){return r(c,this,arguments)}}),o("EvalError",function(c){return function(g){return r(c,this,arguments)}}),o("RangeError",function(c){return function(g){return r(c,this,arguments)}}),o("ReferenceError",function(c){return function(g){return r(c,this,arguments)}}),o("SyntaxError",function(c){return function(g){return r(c,this,arguments)}}),o("TypeError",function(c){return function(g){return r(c,this,arguments)}}),o("URIError",function(c){return function(g){return r(c,this,arguments)}}),u("CompileError",function(c){return function(g){return r(c,this,arguments)}}),u("LinkError",function(c){return function(g){return r(c,this,arguments)}}),u("RuntimeError",function(c){return function(g){return r(c,this,arguments)}}),qW}Kue();var xU={},Ok,EU;function UK(){if(EU)return Ok;EU=1;var t=Jg();return Ok=Array.isArray||function(r){return t(r)==="Array"},Ok}var kk,_U;function jK(){if(_U)return kk;_U=1;var t=zo(),e=UK(),r=TypeError,n=Object.getOwnPropertyDescriptor,i=t&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(s){return s instanceof TypeError}}();return kk=i?function(s,a){if(e(s)&&!n(s,"length").writable)throw new r("Cannot set read only .length");return s.length=a}:function(s,a){return s.length=a},kk}var Dk,RU;function YK(){if(RU)return Dk;RU=1;var t=TypeError,e=9007199254740991;return Dk=function(r){if(r>e)throw t("Maximum allowed index exceeded");return r},Dk}var TU;function Xue(){if(TU)return xU;TU=1;var t=nn(),e=Qp(),r=Jp(),n=jK(),i=YK(),s=Ci(),a=s(function(){return[].push.call({length:4294967296},1)!==4294967297}),o=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(c){return c instanceof TypeError}},u=a||!o();return t({target:"Array",proto:!0,arity:1,forced:u},{push:function(f){var g=e(this),m=r(g),v=arguments.length;i(m+v);for(var w=0;w<v;w++)g[m]=arguments[w],m++;return n(g,m),m}}),xU}Xue();var MU={},Pk,AU;function Que(){if(AU)return Pk;AU=1;var t=Jg(),e=ui();return Pk=function(r){if(t(r)==="Function")return e(r)},Pk}var Ik,OU;function zK(){if(OU)return Ik;OU=1;var t=Que(),e=ba(),r=CR(),n=t(t.bind);return Ik=function(i,s){return e(i),s===void 0?i:r?n(i,s):function(){return i.apply(s,arguments)}},Ik}var Nk,kU;function GK(){return kU||(kU=1,Nk={}),Nk}var Hk,DU;function Zue(){if(DU)return Hk;DU=1;var t=Fl(),e=GK(),r=t("iterator"),n=Array.prototype;return Hk=function(i){return i!==void 0&&(e.Array===i||n[r]===i)},Hk}var Fk,PU;function VH(){if(PU)return Fk;PU=1;var t=$K(),e=cS(),r=OH(),n=GK(),i=Fl(),s=i("iterator");return Fk=function(a){if(!r(a))return e(a,s)||e(a,"@@iterator")||n[t(a)]},Fk}var Lk,IU;function Jue(){if(IU)return Lk;IU=1;var t=xi(),e=ba(),r=_i(),n=_R(),i=VH(),s=TypeError;return Lk=function(a,o){var u=arguments.length<2?i(a):o;if(e(u))return r(t(u,a));throw new s(n(a)+" is not iterable")},Lk}var Bk,NU;function Ca(){if(NU)return Bk;NU=1;var t=xi(),e=_i(),r=cS();return Bk=function(n,i,s){var a,o;e(n);try{if(a=r(n,"return"),!a){if(i==="throw")throw s;return s}a=t(a,n)}catch(u){o=!0,a=u}if(i==="throw")throw s;if(o)throw a;return e(a),s},Bk}var Vk,HU;function ev(){if(HU)return Vk;HU=1;var t=zK(),e=xi(),r=_i(),n=_R(),i=Zue(),s=Jp(),a=uS(),o=Jue(),u=VH(),c=Ca(),f=TypeError,g=function(v,w){this.stopped=v,this.result=w},m=g.prototype;return Vk=function(v,w,y){var b=y&&y.that,x=!!(y&&y.AS_ENTRIES),_=!!(y&&y.IS_RECORD),T=!!(y&&y.IS_ITERATOR),D=!!(y&&y.INTERRUPTED),P=t(w,b),O,A,W,L,H,J,G,ve=function(we){return O&&c(O,"normal"),new g(!0,we)},be=function(we){return x?(r(we),D?P(we[0],we[1],ve):P(we[0],we[1])):D?P(we,ve):P(we)};if(_)O=v.iterator;else if(T)O=v;else{if(A=u(v),!A)throw new f(n(v)+" is not iterable");if(i(A)){for(W=0,L=s(v);L>W;W++)if(H=be(v[W]),H&&a(m,H))return H;return new g(!1)}O=o(v,A)}for(J=_?v.next:O.next;!(G=e(J,O)).done;){try{H=be(G.value)}catch(we){c(O,"throw",we)}if(typeof H=="object"&&H&&a(m,H))return H}return new g(!1)},Vk}var Wk,FU;function qK(){if(FU)return Wk;FU=1;var t=zo(),e=Xf(),r=xR();return Wk=function(n,i,s){t?e.f(n,i,r(0,s)):n[i]=s},Wk}var LU;function ece(){if(LU)return MU;LU=1;var t=nn(),e=ev(),r=qK();return t({target:"Object",stat:!0},{fromEntries:function(i){var s={};return e(i,function(a,o){r(s,a,o)},{AS_ENTRIES:!0}),s}}),MU}ece();var BU={},$k,VU;function ju(){if(VU)return $k;VU=1;var t=ui(),e=Set.prototype;return $k={Set,add:t(e.add),has:t(e.has),remove:t(e.delete),proto:e},$k}var Uk,WU;function em(){if(WU)return Uk;WU=1;var t=ju().has;return Uk=function(e){return t(e),e},Uk}var jk,$U;function tm(){if($U)return jk;$U=1;var t=xi();return jk=function(e,r,n){for(var i=n?e:e.iterator,s=e.next,a,o;!(a=t(s,i)).done;)if(o=r(a.value),o!==void 0)return o},jk}var Yk,UU;function dS(){if(UU)return Yk;UU=1;var t=ui(),e=tm(),r=ju(),n=r.Set,i=r.proto,s=t(i.forEach),a=t(i.keys),o=a(new n).next;return Yk=function(u,c,f){return f?e({iterator:a(u),next:o},c):s(u,c)},Yk}var zk,jU;function WH(){if(jU)return zk;jU=1;var t=ju(),e=dS(),r=t.Set,n=t.add;return zk=function(i){var s=new r;return e(i,function(a){n(s,a)}),s},zk}var Gk,YU;function gS(){if(YU)return Gk;YU=1;var t=VK(),e=ju();return Gk=t(e.proto,"size","get")||function(r){return r.size},Gk}var qk,zU;function Yu(){return zU||(zU=1,qk=function(t){return{iterator:t,next:t.next,done:!1}}),qk}var Kk,GU;function rm(){if(GU)return Kk;GU=1;var t=ba(),e=_i(),r=xi(),n=hS(),i=Yu(),s="Invalid size",a=RangeError,o=TypeError,u=Math.max,c=function(f,g){this.set=f,this.size=u(g,0),this.has=t(f.has),this.keys=t(f.keys)};return c.prototype={getIterator:function(){return i(e(r(this.keys,this.set)))},includes:function(f){return r(this.has,this.set,f)}},Kk=function(f){e(f);var g=+f.size;if(g!==g)throw new o(s);var m=n(g);if(m<0)throw new a(s);return new c(f,m)},Kk}var Xk,qU;function tce(){if(qU)return Xk;qU=1;var t=em(),e=ju(),r=WH(),n=gS(),i=rm(),s=dS(),a=tm(),o=e.has,u=e.remove;return Xk=function(f){var g=t(this),m=i(f),v=r(g);return n(g)<=m.size?s(g,function(w){m.includes(w)&&u(v,w)}):a(m.getIterator(),function(w){o(v,w)&&u(v,w)}),v},Xk}var Qk,KU;function nm(){if(KU)return Qk;KU=1;var t=Xp(),e=function(n){return{size:n,has:function(){return!1},keys:function(){return{next:function(){return{done:!0}}}}}},r=function(n){return{size:n,has:function(){return!0},keys:function(){throw new Error("e")}}};return Qk=function(n,i){var s=t("Set");try{new s()[n](e(0));try{return new s()[n](e(-1)),!1}catch{if(!i)return!0;try{return new s()[n](r(-1/0)),!1}catch{var a=new s;return a.add(1),a.add(2),i(a[n](r(1/0)))}}}catch{return!1}},Qk}var XU;function rce(){if(XU)return BU;XU=1;var t=nn(),e=tce(),r=Ci(),n=nm(),i=!n("difference",function(a){return a.size===0}),s=i||r(function(){var a={size:1,has:function(){return!0},keys:function(){var u=0;return{next:function(){var c=u++>1;return o.has(1)&&o.clear(),{done:c,value:2}}}}},o=new Set([1,2,3,4]);return o.difference(a).size!==3});return t({target:"Set",proto:!0,real:!0,forced:s},{difference:e}),BU}rce();var QU={},Zk,ZU;function nce(){if(ZU)return Zk;ZU=1;var t=em(),e=ju(),r=gS(),n=rm(),i=dS(),s=tm(),a=e.Set,o=e.add,u=e.has;return Zk=function(f){var g=t(this),m=n(f),v=new a;return r(g)>m.size?s(m.getIterator(),function(w){u(g,w)&&o(v,w)}):i(g,function(w){m.includes(w)&&o(v,w)}),v},Zk}var JU;function ice(){if(JU)return QU;JU=1;var t=nn(),e=Ci(),r=nce(),n=nm(),i=!n("intersection",function(s){return s.size===2&&s.has(1)&&s.has(2)})||e(function(){return String(Array.from(new Set([1,2,3]).intersection(new Set([3,2]))))!=="3,2"});return t({target:"Set",proto:!0,real:!0,forced:i},{intersection:r}),QU}ice();var e5={},Jk,t5;function sce(){if(t5)return Jk;t5=1;var t=em(),e=ju().has,r=gS(),n=rm(),i=dS(),s=tm(),a=Ca();return Jk=function(u){var c=t(this),f=n(u);if(r(c)<=f.size)return i(c,function(m){if(f.includes(m))return!1},!0)!==!1;var g=f.getIterator();return s(g,function(m){if(e(c,m))return a(g,"normal",!1)})!==!1},Jk}var r5;function ace(){if(r5)return e5;r5=1;var t=nn(),e=sce(),r=nm(),n=!r("isDisjointFrom",function(i){return!i});return t({target:"Set",proto:!0,real:!0,forced:n},{isDisjointFrom:e}),e5}ace();var n5={},eD,i5;function oce(){if(i5)return eD;i5=1;var t=em(),e=gS(),r=dS(),n=rm();return eD=function(s){var a=t(this),o=n(s);return e(a)>o.size?!1:r(a,function(u){if(!o.includes(u))return!1},!0)!==!1},eD}var s5;function lce(){if(s5)return n5;s5=1;var t=nn(),e=oce(),r=nm(),n=!r("isSubsetOf",function(i){return i});return t({target:"Set",proto:!0,real:!0,forced:n},{isSubsetOf:e}),n5}lce();var a5={},tD,o5;function uce(){if(o5)return tD;o5=1;var t=em(),e=ju().has,r=gS(),n=rm(),i=tm(),s=Ca();return tD=function(o){var u=t(this),c=n(o);if(r(u)<c.size)return!1;var f=c.getIterator();return i(f,function(g){if(!e(u,g))return s(f,"normal",!1)})!==!1},tD}var l5;function cce(){if(l5)return a5;l5=1;var t=nn(),e=uce(),r=nm(),n=!r("isSupersetOf",function(i){return!i});return t({target:"Set",proto:!0,real:!0,forced:n},{isSupersetOf:e}),a5}cce();var u5={},rD,c5;function hce(){if(c5)return rD;c5=1;var t=em(),e=ju(),r=WH(),n=rm(),i=tm(),s=e.add,a=e.has,o=e.remove;return rD=function(c){var f=t(this),g=n(c).getIterator(),m=r(f);return i(g,function(v){a(f,v)?o(m,v):s(m,v)}),m},rD}var nD,h5;function KK(){return h5||(h5=1,nD=function(t){try{var e=new Set,r={size:0,has:function(){return!0},keys:function(){return Object.defineProperty({},"next",{get:function(){return e.clear(),e.add(4),function(){return{done:!0}}}})}},n=e[t](r);return n.size===1&&n.values().next().value===4}catch{return!1}}),nD}var f5;function fce(){if(f5)return u5;f5=1;var t=nn(),e=hce(),r=KK(),n=nm(),i=!n("symmetricDifference")||!r("symmetricDifference");return t({target:"Set",proto:!0,real:!0,forced:i},{symmetricDifference:e}),u5}fce();var d5={},iD,g5;function dce(){if(g5)return iD;g5=1;var t=em(),e=ju().add,r=WH(),n=rm(),i=tm();return iD=function(a){var o=t(this),u=n(a).getIterator(),c=r(o);return i(u,function(f){e(c,f)}),c},iD}var m5;function gce(){if(m5)return d5;m5=1;var t=nn(),e=dce(),r=KK(),n=nm(),i=!n("union")||!r("union");return t({target:"Set",proto:!0,real:!0,forced:i},{union:e}),d5}gce();var p5={},v5={},sD,w5;function mce(){if(w5)return sD;w5=1;var t=uS(),e=TypeError;return sD=function(r,n){if(t(n,r))return r;throw new e("Incorrect invocation")},sD}var aD,y5;function pce(){if(y5)return aD;y5=1;var t=Ci();return aD=!t(function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}),aD}var oD,S5;function XK(){if(S5)return oD;S5=1;var t=qo(),e=Ei(),r=Qp(),n=HH(),i=pce(),s=n("IE_PROTO"),a=Object,o=a.prototype;return oD=i?a.getPrototypeOf:function(u){var c=r(u);if(t(c,s))return c[s];var f=c.constructor;return e(f)&&c instanceof f?f.prototype:c instanceof a?o:null},oD}var lD,b5;function vce(){if(b5)return lD;b5=1;var t=FK(),e=Xf();return lD=function(r,n,i){return i.get&&t(i.get,n,{getter:!0}),i.set&&t(i.set,n,{setter:!0}),e.f(r,n,i)},lD}var uD={},cD,C5;function wce(){if(C5)return cD;C5=1;var t=LK(),e=BH();return cD=Object.keys||function(n){return t(n,e)},cD}var x5;function yce(){if(x5)return uD;x5=1;var t=zo(),e=NK(),r=Xf(),n=_i(),i=lS(),s=wce();return uD.f=t&&!e?Object.defineProperties:function(o,u){n(o);for(var c=i(u),f=s(u),g=f.length,m=0,v;g>m;)r.f(o,v=f[m++],c[v]);return o},uD}var hD,E5;function QK(){if(E5)return hD;E5=1;var t=Xp();return hD=t("document","documentElement"),hD}var fD,_5;function $H(){if(_5)return fD;_5=1;var t=_i(),e=yce(),r=BH(),n=FH(),i=QK(),s=NH(),a=HH(),o=">",u="<",c="prototype",f="script",g=a("IE_PROTO"),m=function(){},v=function(_){return u+f+o+_+u+"/"+f+o},w=function(_){_.write(v("")),_.close();var T=_.parentWindow.Object;return _=null,T},y=function(){var _=s("iframe"),T="java"+f+":",D;return _.style.display="none",i.appendChild(_),_.src=String(T),D=_.contentWindow.document,D.open(),D.write(v("document.F=Object")),D.close(),D.F},b,x=function(){try{b=new ActiveXObject("htmlfile")}catch{}x=typeof document<"u"?document.domain&&b?w(b):y():w(b);for(var _=r.length;_--;)delete x[c][r[_]];return x()};return n[g]=!0,fD=Object.create||function(T,D){var P;return T!==null?(m[c]=t(T),P=new m,m[c]=null,P[g]=T):P=x(),D===void 0?P:e.f(P,D)},fD}var dD,R5;function ZK(){if(R5)return dD;R5=1;var t=Ci(),e=Ei(),r=Go(),n=$H(),i=XK(),s=LH(),a=Fl(),o=Kf(),u=a("iterator"),c=!1,f,g,m;[].keys&&(m=[].keys(),"next"in m?(g=i(i(m)),g!==Object.prototype&&(f=g)):c=!0);var v=!r(f)||t(function(){var w={};return f[u].call(w)!==w});return v?f={}:o&&(f=n(f)),e(f[u])||s(f,u,function(){return this}),dD={IteratorPrototype:f,BUGGY_SAFARI_ITERATORS:c},dD}var T5;function Sce(){if(T5)return v5;T5=1;var t=nn(),e=li(),r=mce(),n=_i(),i=Ei(),s=XK(),a=vce(),o=qK(),u=Ci(),c=qo(),f=Fl(),g=ZK().IteratorPrototype,m=zo(),v=Kf(),w="constructor",y="Iterator",b=f("toStringTag"),x=TypeError,_=e[y],T=v||!i(_)||_.prototype!==g||!u(function(){_({})}),D=function(){if(r(this,g),s(this)===g)throw new x("Abstract class Iterator not directly constructable")},P=function(O,A){m?a(g,O,{configurable:!0,get:function(){return A},set:function(W){if(n(this),this===g)throw new x("You can't redefine this property");c(this,O)?this[O]=W:o(this,O,W)}}):g[O]=A};return c(g,b)||P(b,y),(T||!c(g,w)||g[w]===Object)&&P(w,D),D.prototype=g,t({global:!0,constructor:!0,forced:T},{Iterator:D}),v5}var M5;function bce(){return M5||(M5=1,Sce()),p5}bce();var A5={},O5={},gD,k5;function Cce(){if(k5)return gD;k5=1;var t=LH();return gD=function(e,r,n){for(var i in r)t(e,i,r[i],n);return e},gD}var mD,D5;function xce(){return D5||(D5=1,mD=function(t,e){return{value:t,done:e}}),mD}var pD,P5;function Ece(){if(P5)return pD;P5=1;var t=Ca();return pD=function(e,r,n){for(var i=e.length-1;i>=0;i--)if(e[i]!==void 0)try{n=t(e[i].iterator,r,n)}catch(s){r="throw",n=s}if(r==="throw")throw n;return n},pD}var vD,I5;function UH(){if(I5)return vD;I5=1;var t=xi(),e=$H(),r=Zp(),n=Cce(),i=Fl(),s=HK(),a=cS(),o=ZK().IteratorPrototype,u=xce(),c=Ca(),f=Ece(),g=i("toStringTag"),m="IteratorHelper",v="WrapForValidIterator",w="normal",y="throw",b=s.set,x=function(D){var P=s.getterFor(D?v:m);return n(e(o),{next:function(){var A=P(this);if(D)return A.nextHandler();if(A.done)return u(void 0,!0);try{var W=A.nextHandler();return A.returnHandlerResult?W:u(W,A.done)}catch(L){throw A.done=!0,L}},return:function(){var O=P(this),A=O.iterator;if(O.done=!0,D){var W=a(A,"return");return W?t(W,A):u(void 0,!0)}if(O.inner)try{c(O.inner.iterator,w)}catch(L){return c(A,y,L)}if(O.openIters)try{f(O.openIters,w)}catch(L){return c(A,y,L)}return A&&c(A,w),u(void 0,!0)}})},_=x(!0),T=x(!1);return r(T,g,"Iterator Helper"),vD=function(D,P,O){var A=function(L,H){H?(H.iterator=L.iterator,H.next=L.next):H=L,H.type=P?v:m,H.returnHandlerResult=!!O,H.nextHandler=D,H.counter=0,H.done=!1,b(this,H)};return A.prototype=P?_:T,A},vD}var wD,N5;function JK(){if(N5)return wD;N5=1;var t=_i(),e=Ca();return wD=function(r,n,i,s){try{return s?n(t(i)[0],i[1]):n(i)}catch(a){e(r,"throw",a)}},wD}var yD,H5;function jH(){return H5||(H5=1,yD=function(t,e){var r=typeof Iterator=="function"&&Iterator.prototype[t];if(r)try{r.call({next:null},e).next()}catch{return!0}}),yD}var SD,F5;function Qf(){if(F5)return SD;F5=1;var t=li();return SD=function(e,r){var n=t.Iterator,i=n&&n.prototype,s=i&&i[e],a=!1;if(s)try{s.call({next:function(){return{done:!0}},return:function(){a=!0}},-1)}catch(o){o instanceof r||(a=!1)}if(!a)return s},SD}var L5;function _ce(){if(L5)return O5;L5=1;var t=nn(),e=xi(),r=ba(),n=_i(),i=Yu(),s=UH(),a=JK(),o=Kf(),u=Ca(),c=jH(),f=Qf(),g=!o&&!c("filter",function(){}),m=!o&&!g&&f("filter",TypeError),v=o||g||m,w=s(function(){for(var y=this.iterator,b=this.predicate,x=this.next,_,T,D;;){if(_=n(e(x,y)),T=this.done=!!_.done,T)return;if(D=_.value,a(y,b,[D,this.counter++],!0))return D}});return t({target:"Iterator",proto:!0,real:!0,forced:v},{filter:function(b){n(this);try{r(b)}catch(x){u(this,"throw",x)}return m?e(m,this,b):new w(i(this),{predicate:b})}}),O5}var B5;function Rce(){return B5||(B5=1,_ce()),A5}Rce();var V5={},W5={},$5;function Tce(){if($5)return W5;$5=1;var t=nn(),e=xi(),r=ev(),n=ba(),i=_i(),s=Yu(),a=Ca(),o=Qf(),u=o("forEach",TypeError);return t({target:"Iterator",proto:!0,real:!0,forced:u},{forEach:function(f){i(this);try{n(f)}catch(v){a(this,"throw",v)}if(u)return e(u,this,f);var g=s(this),m=0;r(g,function(v){f(v,m++)},{IS_RECORD:!0})}}),W5}var U5;function Mce(){return U5||(U5=1,Tce()),V5}Mce();var j5={},Y5={},z5;function Ace(){if(z5)return Y5;z5=1;var t=nn(),e=xi(),r=ba(),n=_i(),i=Yu(),s=UH(),a=JK(),o=Ca(),u=jH(),c=Qf(),f=Kf(),g=!f&&!u("map",function(){}),m=!f&&!g&&c("map",TypeError),v=f||g||m,w=s(function(){var y=this.iterator,b=n(e(this.next,y)),x=this.done=!!b.done;if(!x)return a(y,this.mapper,[b.value,this.counter++],!0)});return t({target:"Iterator",proto:!0,real:!0,forced:v},{map:function(b){n(this);try{r(b)}catch(x){o(this,"throw",x)}return m?e(m,this,b):new w(i(this),{mapper:b})}}),Y5}var G5;function Oce(){return G5||(G5=1,Ace()),j5}Oce();var q5={},K5={},bD,X5;function YH(){if(X5)return bD;X5=1;var t=ui();return bD=t([].slice),bD}var CD,Q5;function eX(){if(Q5)return CD;Q5=1;var t=TypeError;return CD=function(e,r){if(e<r)throw new t("Not enough arguments");return e},CD}var xD,Z5;function kce(){if(Z5)return xD;Z5=1;var t=ER();return xD=/(?:ipad|iphone|ipod).*applewebkit/i.test(t),xD}var ED,J5;function tX(){if(J5)return ED;J5=1;var t=li(),e=ER(),r=Jg(),n=function(i){return e.slice(0,i.length)===i};return ED=function(){return n("Bun/")?"BUN":n("Cloudflare-Workers")?"CLOUDFLARE":n("Deno/")?"DENO":n("Node.js/")?"NODE":t.Bun&&typeof Bun.version=="string"?"BUN":t.Deno&&typeof Deno.version=="object"?"DENO":r(t.process)==="process"?"NODE":t.window&&t.document?"BROWSER":"REST"}(),ED}var _D,ej;function Dce(){if(ej)return _D;ej=1;var t=tX();return _D=t==="NODE",_D}var RD,tj;function rX(){if(tj)return RD;tj=1;var t=li(),e=fS(),r=zK(),n=Ei(),i=qo(),s=Ci(),a=QK(),o=YH(),u=NH(),c=eX(),f=kce(),g=Dce(),m=t.setImmediate,v=t.clearImmediate,w=t.process,y=t.Dispatch,b=t.Function,x=t.MessageChannel,_=t.String,T=0,D={},P="onreadystatechange",O,A,W,L;s(function(){O=t.location});var H=function(be){if(i(D,be)){var we=D[be];delete D[be],we()}},J=function(be){return function(){H(be)}},G=function(be){H(be.data)},ve=function(be){t.postMessage(_(be),O.protocol+"//"+O.host)};return(!m||!v)&&(m=function(we){c(arguments.length,1);var ae=n(we)?we:b(we),le=o(arguments,1);return D[++T]=function(){e(ae,void 0,le)},A(T),T},v=function(we){delete D[we]},g?A=function(be){w.nextTick(J(be))}:y&&y.now?A=function(be){y.now(J(be))}:x&&!f?(W=new x,L=W.port2,W.port1.onmessage=G,A=r(L.postMessage,L)):t.addEventListener&&n(t.postMessage)&&!t.importScripts&&O&&O.protocol!=="file:"&&!s(ve)?(A=ve,t.addEventListener("message",G,!1)):P in u("script")?A=function(be){a.appendChild(u("script"))[P]=function(){a.removeChild(this),H(be)}}:A=function(be){setTimeout(J(be),0)}),RD={set:m,clear:v},RD}var rj;function Pce(){if(rj)return K5;rj=1;var t=nn(),e=li(),r=rX().clear;return t({global:!0,bind:!0,enumerable:!0,forced:e.clearImmediate!==r},{clearImmediate:r}),K5}var nj={},TD,ij;function Ice(){if(ij)return TD;ij=1;var t=li(),e=fS(),r=Ei(),n=tX(),i=ER(),s=YH(),a=eX(),o=t.Function,u=/MSIE .\./.test(i)||n==="BUN"&&function(){var c=t.Bun.version.split(".");return c.length<3||c[0]==="0"&&(c[1]<3||c[1]==="3"&&c[2]==="0")}();return TD=function(c,f){var g=f?2:1;return u?function(m,v){var w=a(arguments.length,1)>g,y=r(m)?m:o(m),b=w?s(arguments,g):[],x=w?function(){e(y,this,b)}:y;return f?c(x,v):c(x)}:c},TD}var sj;function Nce(){if(sj)return nj;sj=1;var t=nn(),e=li(),r=rX().set,n=Ice(),i=e.setImmediate?n(r,!1):r;return t({global:!0,bind:!0,enumerable:!0,forced:e.setImmediate!==i},{setImmediate:i}),nj}var aj;function Hce(){return aj||(aj=1,Pce(),Nce()),q5}Hce();/*! @license DOMPurify 3.2.6 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.2.6/LICENSE */const{entries:nX,setPrototypeOf:oj,isFrozen:Fce,getPrototypeOf:Lce,getOwnPropertyDescriptor:Bce}=Object;let{freeze:Gs,seal:$o,create:iX}=Object,{apply:$I,construct:UI}=typeof Reflect<"u"&&Reflect;Gs||(Gs=function(e){return e});$o||($o=function(e){return e});$I||($I=function(e,r,n){return e.apply(r,n)});UI||(UI=function(e,r){return new e(...r)});const oC=qs(Array.prototype.forEach),Vce=qs(Array.prototype.lastIndexOf),lj=qs(Array.prototype.pop),gw=qs(Array.prototype.push),Wce=qs(Array.prototype.splice),fE=qs(String.prototype.toLowerCase),MD=qs(String.prototype.toString),uj=qs(String.prototype.match),mw=qs(String.prototype.replace),$ce=qs(String.prototype.indexOf),Uce=qs(String.prototype.trim),vl=qs(Object.prototype.hasOwnProperty),Is=qs(RegExp.prototype.test),pw=jce(TypeError);function qs(t){return function(e){e instanceof RegExp&&(e.lastIndex=0);for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];return $I(t,e,n)}}function jce(t){return function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return UI(t,r)}}function tr(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:fE;oj&&oj(t,null);let n=e.length;for(;n--;){let i=e[n];if(typeof i=="string"){const s=r(i);s!==i&&(Fce(e)||(e[n]=s),i=s)}t[i]=!0}return t}function Yce(t){for(let e=0;e<t.length;e++)vl(t,e)||(t[e]=null);return t}function Rc(t){const e=iX(null);for(const[r,n]of nX(t))vl(t,r)&&(Array.isArray(n)?e[r]=Yce(n):n&&typeof n=="object"&&n.constructor===Object?e[r]=Rc(n):e[r]=n);return e}function vw(t,e){for(;t!==null;){const n=Bce(t,e);if(n){if(n.get)return qs(n.get);if(typeof n.value=="function")return qs(n.value)}t=Lce(t)}function r(){return null}return r}const cj=Gs(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),AD=Gs(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),OD=Gs(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),zce=Gs(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),kD=Gs(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),Gce=Gs(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),hj=Gs(["#text"]),fj=Gs(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),DD=Gs(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),dj=Gs(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),lC=Gs(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),qce=$o(/\{\{[\w\W]*|[\w\W]*\}\}/gm),Kce=$o(/<%[\w\W]*|[\w\W]*%>/gm),Xce=$o(/\$\{[\w\W]*/gm),Qce=$o(/^data-[\-\w.\u00B7-\uFFFF]+$/),Zce=$o(/^aria-[\-\w]+$/),sX=$o(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),Jce=$o(/^(?:\w+script|data):/i),ehe=$o(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),aX=$o(/^html$/i),the=$o(/^[a-z][.\w]*(-[.\w]+)+$/i);var gj=Object.freeze({__proto__:null,ARIA_ATTR:Zce,ATTR_WHITESPACE:ehe,CUSTOM_ELEMENT:the,DATA_ATTR:Qce,DOCTYPE_NAME:aX,ERB_EXPR:Kce,IS_ALLOWED_URI:sX,IS_SCRIPT_OR_DATA:Jce,MUSTACHE_EXPR:qce,TMPLIT_EXPR:Xce});const ww={element:1,text:3,progressingInstruction:7,comment:8,document:9},rhe=function(){return typeof window>"u"?null:window},nhe=function(e,r){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let n=null;const i="data-tt-policy-suffix";r&&r.hasAttribute(i)&&(n=r.getAttribute(i));const s="dompurify"+(n?"#"+n:"");try{return e.createPolicy(s,{createHTML(a){return a},createScriptURL(a){return a}})}catch{return console.warn("TrustedTypes policy "+s+" could not be created."),null}},mj=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function oX(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:rhe();const e=me=>oX(me);if(e.version="3.2.6",e.removed=[],!t||!t.document||t.document.nodeType!==ww.document||!t.Element)return e.isSupported=!1,e;let{document:r}=t;const n=r,i=n.currentScript,{DocumentFragment:s,HTMLTemplateElement:a,Node:o,Element:u,NodeFilter:c,NamedNodeMap:f=t.NamedNodeMap||t.MozNamedAttrMap,HTMLFormElement:g,DOMParser:m,trustedTypes:v}=t,w=u.prototype,y=vw(w,"cloneNode"),b=vw(w,"remove"),x=vw(w,"nextSibling"),_=vw(w,"childNodes"),T=vw(w,"parentNode");if(typeof a=="function"){const me=r.createElement("template");me.content&&me.content.ownerDocument&&(r=me.content.ownerDocument)}let D,P="";const{implementation:O,createNodeIterator:A,createDocumentFragment:W,getElementsByTagName:L}=r,{importNode:H}=n;let J=mj();e.isSupported=typeof nX=="function"&&typeof T=="function"&&O&&O.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:G,ERB_EXPR:ve,TMPLIT_EXPR:be,DATA_ATTR:we,ARIA_ATTR:ae,IS_SCRIPT_OR_DATA:le,ATTR_WHITESPACE:Te,CUSTOM_ELEMENT:ce}=gj;let{IS_ALLOWED_URI:K}=gj,Se=null;const B=tr({},[...cj,...AD,...OD,...kD,...hj]);let E=null;const R=tr({},[...fj,...DD,...dj,...lC]);let M=Object.seal(iX(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),F=null,Z=null,te=!0,fe=!0,I=!1,U=!0,k=!1,ee=!0,oe=!1,de=!1,pe=!1,Q=!1,ge=!1,xe=!1,_e=!0,Ne=!1;const Xe="user-content-";let Qe=!0,ht=!1,Mt={},Et=null;const at=tr({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let nt=null;const pt=tr({},["audio","video","img","source","image","track"]);let yt=null;const pr=tr({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),sn="http://www.w3.org/1998/Math/MathML",Dt="http://www.w3.org/2000/svg",Kt="http://www.w3.org/1999/xhtml";let or=Kt,vr=!1,$t=null;const qi=tr({},[sn,Dt,Kt],MD);let Kn=tr({},["mi","mo","mn","ms","mtext"]),xa=tr({},["annotation-xml"]);const Bl=tr({},["title","style","font","a","script"]);let Ea=null;const vh=["application/xhtml+xml","text/html"],wm="text/html";let Cn=null,to=null;const id=r.createElement("form"),sd=function(z){return z instanceof RegExp||z instanceof Function},ad=function(){let z=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(to&&to===z)){if((!z||typeof z!="object")&&(z={}),z=Rc(z),Ea=vh.indexOf(z.PARSER_MEDIA_TYPE)===-1?wm:z.PARSER_MEDIA_TYPE,Cn=Ea==="application/xhtml+xml"?MD:fE,Se=vl(z,"ALLOWED_TAGS")?tr({},z.ALLOWED_TAGS,Cn):B,E=vl(z,"ALLOWED_ATTR")?tr({},z.ALLOWED_ATTR,Cn):R,$t=vl(z,"ALLOWED_NAMESPACES")?tr({},z.ALLOWED_NAMESPACES,MD):qi,yt=vl(z,"ADD_URI_SAFE_ATTR")?tr(Rc(pr),z.ADD_URI_SAFE_ATTR,Cn):pr,nt=vl(z,"ADD_DATA_URI_TAGS")?tr(Rc(pt),z.ADD_DATA_URI_TAGS,Cn):pt,Et=vl(z,"FORBID_CONTENTS")?tr({},z.FORBID_CONTENTS,Cn):at,F=vl(z,"FORBID_TAGS")?tr({},z.FORBID_TAGS,Cn):Rc({}),Z=vl(z,"FORBID_ATTR")?tr({},z.FORBID_ATTR,Cn):Rc({}),Mt=vl(z,"USE_PROFILES")?z.USE_PROFILES:!1,te=z.ALLOW_ARIA_ATTR!==!1,fe=z.ALLOW_DATA_ATTR!==!1,I=z.ALLOW_UNKNOWN_PROTOCOLS||!1,U=z.ALLOW_SELF_CLOSE_IN_ATTR!==!1,k=z.SAFE_FOR_TEMPLATES||!1,ee=z.SAFE_FOR_XML!==!1,oe=z.WHOLE_DOCUMENT||!1,Q=z.RETURN_DOM||!1,ge=z.RETURN_DOM_FRAGMENT||!1,xe=z.RETURN_TRUSTED_TYPE||!1,pe=z.FORCE_BODY||!1,_e=z.SANITIZE_DOM!==!1,Ne=z.SANITIZE_NAMED_PROPS||!1,Qe=z.KEEP_CONTENT!==!1,ht=z.IN_PLACE||!1,K=z.ALLOWED_URI_REGEXP||sX,or=z.NAMESPACE||Kt,Kn=z.MATHML_TEXT_INTEGRATION_POINTS||Kn,xa=z.HTML_INTEGRATION_POINTS||xa,M=z.CUSTOM_ELEMENT_HANDLING||{},z.CUSTOM_ELEMENT_HANDLING&&sd(z.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(M.tagNameCheck=z.CUSTOM_ELEMENT_HANDLING.tagNameCheck),z.CUSTOM_ELEMENT_HANDLING&&sd(z.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(M.attributeNameCheck=z.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),z.CUSTOM_ELEMENT_HANDLING&&typeof z.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(M.allowCustomizedBuiltInElements=z.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),k&&(fe=!1),ge&&(Q=!0),Mt&&(Se=tr({},hj),E=[],Mt.html===!0&&(tr(Se,cj),tr(E,fj)),Mt.svg===!0&&(tr(Se,AD),tr(E,DD),tr(E,lC)),Mt.svgFilters===!0&&(tr(Se,OD),tr(E,DD),tr(E,lC)),Mt.mathMl===!0&&(tr(Se,kD),tr(E,dj),tr(E,lC))),z.ADD_TAGS&&(Se===B&&(Se=Rc(Se)),tr(Se,z.ADD_TAGS,Cn)),z.ADD_ATTR&&(E===R&&(E=Rc(E)),tr(E,z.ADD_ATTR,Cn)),z.ADD_URI_SAFE_ATTR&&tr(yt,z.ADD_URI_SAFE_ATTR,Cn),z.FORBID_CONTENTS&&(Et===at&&(Et=Rc(Et)),tr(Et,z.FORBID_CONTENTS,Cn)),Qe&&(Se["#text"]=!0),oe&&tr(Se,["html","head","body"]),Se.table&&(tr(Se,["tbody"]),delete F.tbody),z.TRUSTED_TYPES_POLICY){if(typeof z.TRUSTED_TYPES_POLICY.createHTML!="function")throw pw('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof z.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw pw('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');D=z.TRUSTED_TYPES_POLICY,P=D.createHTML("")}else D===void 0&&(D=nhe(v,i)),D!==null&&typeof P=="string"&&(P=D.createHTML(""));Gs&&Gs(z),to=z}},_a=tr({},[...AD,...OD,...zce]),Xn=tr({},[...kD,...Gce]),fi=function(z){let Ce=T(z);(!Ce||!Ce.tagName)&&(Ce={namespaceURI:or,tagName:"template"});const Pe=fE(z.tagName),Ye=fE(Ce.tagName);return $t[z.namespaceURI]?z.namespaceURI===Dt?Ce.namespaceURI===Kt?Pe==="svg":Ce.namespaceURI===sn?Pe==="svg"&&(Ye==="annotation-xml"||Kn[Ye]):!!_a[Pe]:z.namespaceURI===sn?Ce.namespaceURI===Kt?Pe==="math":Ce.namespaceURI===Dt?Pe==="math"&&xa[Ye]:!!Xn[Pe]:z.namespaceURI===Kt?Ce.namespaceURI===Dt&&!xa[Ye]||Ce.namespaceURI===sn&&!Kn[Ye]?!1:!Xn[Pe]&&(Bl[Pe]||!_a[Pe]):!!(Ea==="application/xhtml+xml"&&$t[z.namespaceURI]):!1},Ti=function(z){gw(e.removed,{element:z});try{T(z).removeChild(z)}catch{b(z)}},ro=function(z,Ce){try{gw(e.removed,{attribute:Ce.getAttributeNode(z),from:Ce})}catch{gw(e.removed,{attribute:null,from:Ce})}if(Ce.removeAttribute(z),z==="is")if(Q||ge)try{Ti(Ce)}catch{}else try{Ce.setAttribute(z,"")}catch{}},ym=function(z){let Ce=null,Pe=null;if(pe)z="<remove></remove>"+z;else{const ze=uj(z,/^[\r\n\t ]+/);Pe=ze&&ze[0]}Ea==="application/xhtml+xml"&&or===Kt&&(z='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+z+"</body></html>");const Ye=D?D.createHTML(z):z;if(or===Kt)try{Ce=new m().parseFromString(Ye,Ea)}catch{}if(!Ce||!Ce.documentElement){Ce=O.createDocument(or,"template",null);try{Ce.documentElement.innerHTML=vr?P:Ye}catch{}}const $e=Ce.body||Ce.documentElement;return z&&Pe&&$e.insertBefore(r.createTextNode(Pe),$e.childNodes[0]||null),or===Kt?L.call(Ce,oe?"html":"body")[0]:oe?Ce.documentElement:$e},V=function(z){return A.call(z.ownerDocument||z,z,c.SHOW_ELEMENT|c.SHOW_COMMENT|c.SHOW_TEXT|c.SHOW_PROCESSING_INSTRUCTION|c.SHOW_CDATA_SECTION,null)},re=function(z){return z instanceof g&&(typeof z.nodeName!="string"||typeof z.textContent!="string"||typeof z.removeChild!="function"||!(z.attributes instanceof f)||typeof z.removeAttribute!="function"||typeof z.setAttribute!="function"||typeof z.namespaceURI!="string"||typeof z.insertBefore!="function"||typeof z.hasChildNodes!="function")},q=function(z){return typeof o=="function"&&z instanceof o};function X(me,z,Ce){oC(me,Pe=>{Pe.call(e,z,Ce,to)})}const ne=function(z){let Ce=null;if(X(J.beforeSanitizeElements,z,null),re(z))return Ti(z),!0;const Pe=Cn(z.nodeName);if(X(J.uponSanitizeElement,z,{tagName:Pe,allowedTags:Se}),ee&&z.hasChildNodes()&&!q(z.firstElementChild)&&Is(/<[/\w!]/g,z.innerHTML)&&Is(/<[/\w!]/g,z.textContent)||z.nodeType===ww.progressingInstruction||ee&&z.nodeType===ww.comment&&Is(/<[/\w]/g,z.data))return Ti(z),!0;if(!Se[Pe]||F[Pe]){if(!F[Pe]&&Ae(Pe)&&(M.tagNameCheck instanceof RegExp&&Is(M.tagNameCheck,Pe)||M.tagNameCheck instanceof Function&&M.tagNameCheck(Pe)))return!1;if(Qe&&!Et[Pe]){const Ye=T(z)||z.parentNode,$e=_(z)||z.childNodes;if($e&&Ye){const ze=$e.length;for(let dt=ze-1;dt>=0;--dt){const Xt=y($e[dt],!0);Xt.__removalCount=(z.__removalCount||0)+1,Ye.insertBefore(Xt,x(z))}}}return Ti(z),!0}return z instanceof u&&!fi(z)||(Pe==="noscript"||Pe==="noembed"||Pe==="noframes")&&Is(/<\/no(script|embed|frames)/i,z.innerHTML)?(Ti(z),!0):(k&&z.nodeType===ww.text&&(Ce=z.textContent,oC([G,ve,be],Ye=>{Ce=mw(Ce,Ye," ")}),z.textContent!==Ce&&(gw(e.removed,{element:z.cloneNode()}),z.textContent=Ce)),X(J.afterSanitizeElements,z,null),!1)},se=function(z,Ce,Pe){if(_e&&(Ce==="id"||Ce==="name")&&(Pe in r||Pe in id))return!1;if(!(fe&&!Z[Ce]&&Is(we,Ce))){if(!(te&&Is(ae,Ce))){if(!E[Ce]||Z[Ce]){if(!(Ae(z)&&(M.tagNameCheck instanceof RegExp&&Is(M.tagNameCheck,z)||M.tagNameCheck instanceof Function&&M.tagNameCheck(z))&&(M.attributeNameCheck instanceof RegExp&&Is(M.attributeNameCheck,Ce)||M.attributeNameCheck instanceof Function&&M.attributeNameCheck(Ce))||Ce==="is"&&M.allowCustomizedBuiltInElements&&(M.tagNameCheck instanceof RegExp&&Is(M.tagNameCheck,Pe)||M.tagNameCheck instanceof Function&&M.tagNameCheck(Pe))))return!1}else if(!yt[Ce]){if(!Is(K,mw(Pe,Te,""))){if(!((Ce==="src"||Ce==="xlink:href"||Ce==="href")&&z!=="script"&&$ce(Pe,"data:")===0&&nt[z])){if(!(I&&!Is(le,mw(Pe,Te,"")))){if(Pe)return!1}}}}}}return!0},Ae=function(z){return z!=="annotation-xml"&&uj(z,ce)},He=function(z){X(J.beforeSanitizeAttributes,z,null);const{attributes:Ce}=z;if(!Ce||re(z))return;const Pe={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:E,forceKeepAttr:void 0};let Ye=Ce.length;for(;Ye--;){const $e=Ce[Ye],{name:ze,namespaceURI:dt,value:Xt}=$e,cr=Cn(ze),Ir=Xt;let an=ze==="value"?Ir:Uce(Ir);if(Pe.attrName=cr,Pe.attrValue=an,Pe.keepAttr=!0,Pe.forceKeepAttr=void 0,X(J.uponSanitizeAttribute,z,Pe),an=Pe.attrValue,Ne&&(cr==="id"||cr==="name")&&(ro(ze,z),an=Xe+an),ee&&Is(/((--!?|])>)|<\/(style|title)/i,an)){ro(ze,z);continue}if(Pe.forceKeepAttr)continue;if(!Pe.keepAttr){ro(ze,z);continue}if(!U&&Is(/\/>/i,an)){ro(ze,z);continue}k&&oC([G,ve,be],Ds=>{an=mw(an,Ds," ")});const tl=Cn(z.nodeName);if(!se(tl,cr,an)){ro(ze,z);continue}if(D&&typeof v=="object"&&typeof v.getAttributeType=="function"&&!dt)switch(v.getAttributeType(tl,cr)){case"TrustedHTML":{an=D.createHTML(an);break}case"TrustedScriptURL":{an=D.createScriptURL(an);break}}if(an!==Ir)try{dt?z.setAttributeNS(dt,ze,an):z.setAttribute(ze,an),re(z)?Ti(z):lj(e.removed)}catch{ro(ze,z)}}X(J.afterSanitizeAttributes,z,null)},Re=function me(z){let Ce=null;const Pe=V(z);for(X(J.beforeSanitizeShadowDOM,z,null);Ce=Pe.nextNode();)X(J.uponSanitizeShadowNode,Ce,null),ne(Ce),He(Ce),Ce.content instanceof s&&me(Ce.content);X(J.afterSanitizeShadowDOM,z,null)};return e.sanitize=function(me){let z=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},Ce=null,Pe=null,Ye=null,$e=null;if(vr=!me,vr&&(me="<!-->"),typeof me!="string"&&!q(me))if(typeof me.toString=="function"){if(me=me.toString(),typeof me!="string")throw pw("dirty is not a string, aborting")}else throw pw("toString is not a function");if(!e.isSupported)return me;if(de||ad(z),e.removed=[],typeof me=="string"&&(ht=!1),ht){if(me.nodeName){const Xt=Cn(me.nodeName);if(!Se[Xt]||F[Xt])throw pw("root node is forbidden and cannot be sanitized in-place")}}else if(me instanceof o)Ce=ym("<!---->"),Pe=Ce.ownerDocument.importNode(me,!0),Pe.nodeType===ww.element&&Pe.nodeName==="BODY"||Pe.nodeName==="HTML"?Ce=Pe:Ce.appendChild(Pe);else{if(!Q&&!k&&!oe&&me.indexOf("<")===-1)return D&&xe?D.createHTML(me):me;if(Ce=ym(me),!Ce)return Q?null:xe?P:""}Ce&&pe&&Ti(Ce.firstChild);const ze=V(ht?me:Ce);for(;Ye=ze.nextNode();)ne(Ye),He(Ye),Ye.content instanceof s&&Re(Ye.content);if(ht)return me;if(Q){if(ge)for($e=W.call(Ce.ownerDocument);Ce.firstChild;)$e.appendChild(Ce.firstChild);else $e=Ce;return(E.shadowroot||E.shadowrootmode)&&($e=H.call(n,$e,!0)),$e}let dt=oe?Ce.outerHTML:Ce.innerHTML;return oe&&Se["!doctype"]&&Ce.ownerDocument&&Ce.ownerDocument.doctype&&Ce.ownerDocument.doctype.name&&Is(aX,Ce.ownerDocument.doctype.name)&&(dt="<!DOCTYPE "+Ce.ownerDocument.doctype.name+`>
`+dt),k&&oC([G,ve,be],Xt=>{dt=mw(dt,Xt," ")}),D&&xe?D.createHTML(dt):dt},e.setConfig=function(){let me=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};ad(me),de=!0},e.clearConfig=function(){to=null,de=!1},e.isValidAttribute=function(me,z,Ce){to||ad({});const Pe=Cn(me),Ye=Cn(z);return se(Pe,Ye,Ce)},e.addHook=function(me,z){typeof z=="function"&&gw(J[me],z)},e.removeHook=function(me,z){if(z!==void 0){const Ce=Vce(J[me],z);return Ce===-1?void 0:Wce(J[me],Ce,1)[0]}return lj(J[me])},e.removeHooks=function(me){J[me]=[]},e.removeAllHooks=function(){J=mj()},e}var ihe=oX();//! moment.js
//! version : 2.30.1
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
var lX;function je(){return lX.apply(null,arguments)}function she(t){lX=t}function Pl(t){return t instanceof Array||Object.prototype.toString.call(t)==="[object Array]"}function Eg(t){return t!=null&&Object.prototype.toString.call(t)==="[object Object]"}function _r(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function zH(t){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(t).length===0;var e;for(e in t)if(_r(t,e))return!1;return!0}function ua(t){return t===void 0}function th(t){return typeof t=="number"||Object.prototype.toString.call(t)==="[object Number]"}function mS(t){return t instanceof Date||Object.prototype.toString.call(t)==="[object Date]"}function uX(t,e){var r=[],n,i=t.length;for(n=0;n<i;++n)r.push(e(t[n],n));return r}function wf(t,e){for(var r in e)_r(e,r)&&(t[r]=e[r]);return _r(e,"toString")&&(t.toString=e.toString),_r(e,"valueOf")&&(t.valueOf=e.valueOf),t}function zu(t,e,r,n){return DX(t,e,r,n,!0).utc()}function ahe(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function Bt(t){return t._pf==null&&(t._pf=ahe()),t._pf}var jI;Array.prototype.some?jI=Array.prototype.some:jI=function(t){var e=Object(this),r=e.length>>>0,n;for(n=0;n<r;n++)if(n in e&&t.call(this,e[n],n,e))return!0;return!1};function GH(t){var e=null,r=!1,n=t._d&&!isNaN(t._d.getTime());if(n&&(e=Bt(t),r=jI.call(e.parsedDateParts,function(i){return i!=null}),n=e.overflow<0&&!e.empty&&!e.invalidEra&&!e.invalidMonth&&!e.invalidWeekday&&!e.weekdayMismatch&&!e.nullInput&&!e.invalidFormat&&!e.userInvalidated&&(!e.meridiem||e.meridiem&&r),t._strict&&(n=n&&e.charsLeftOver===0&&e.unusedTokens.length===0&&e.bigHour===void 0)),Object.isFrozen==null||!Object.isFrozen(t))t._isValid=n;else return n;return t._isValid}function TR(t){var e=zu(NaN);return t!=null?wf(Bt(e),t):Bt(e).userInvalidated=!0,e}var pj=je.momentProperties=[],PD=!1;function qH(t,e){var r,n,i,s=pj.length;if(ua(e._isAMomentObject)||(t._isAMomentObject=e._isAMomentObject),ua(e._i)||(t._i=e._i),ua(e._f)||(t._f=e._f),ua(e._l)||(t._l=e._l),ua(e._strict)||(t._strict=e._strict),ua(e._tzm)||(t._tzm=e._tzm),ua(e._isUTC)||(t._isUTC=e._isUTC),ua(e._offset)||(t._offset=e._offset),ua(e._pf)||(t._pf=Bt(e)),ua(e._locale)||(t._locale=e._locale),s>0)for(r=0;r<s;r++)n=pj[r],i=e[n],ua(i)||(t[n]=i);return t}function pS(t){qH(this,t),this._d=new Date(t._d!=null?t._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),PD===!1&&(PD=!0,je.updateOffset(this),PD=!1)}function Il(t){return t instanceof pS||t!=null&&t._isAMomentObject!=null}function cX(t){je.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+t)}function Ko(t,e){var r=!0;return wf(function(){if(je.deprecationHandler!=null&&je.deprecationHandler(null,t),r){var n=[],i,s,a,o=arguments.length;for(s=0;s<o;s++){if(i="",typeof arguments[s]=="object"){i+=`
[`+s+"] ";for(a in arguments[0])_r(arguments[0],a)&&(i+=a+": "+arguments[0][a]+", ");i=i.slice(0,-2)}else i=arguments[s];n.push(i)}cX(t+`
Arguments: `+Array.prototype.slice.call(n).join("")+`
`+new Error().stack),r=!1}return e.apply(this,arguments)},e)}var vj={};function hX(t,e){je.deprecationHandler!=null&&je.deprecationHandler(t,e),vj[t]||(cX(e),vj[t]=!0)}je.suppressDeprecationWarnings=!1;je.deprecationHandler=null;function Gu(t){return typeof Function<"u"&&t instanceof Function||Object.prototype.toString.call(t)==="[object Function]"}function ohe(t){var e,r;for(r in t)_r(t,r)&&(e=t[r],Gu(e)?this[r]=e:this["_"+r]=e);this._config=t,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function YI(t,e){var r=wf({},t),n;for(n in e)_r(e,n)&&(Eg(t[n])&&Eg(e[n])?(r[n]={},wf(r[n],t[n]),wf(r[n],e[n])):e[n]!=null?r[n]=e[n]:delete r[n]);for(n in t)_r(t,n)&&!_r(e,n)&&Eg(t[n])&&(r[n]=wf({},r[n]));return r}function KH(t){t!=null&&this.set(t)}var zI;Object.keys?zI=Object.keys:zI=function(t){var e,r=[];for(e in t)_r(t,e)&&r.push(e);return r};var lhe={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function uhe(t,e,r){var n=this._calendar[t]||this._calendar.sameElse;return Gu(n)?n.call(e,r):n}function Lu(t,e,r){var n=""+Math.abs(t),i=e-n.length,s=t>=0;return(s?r?"+":"":"-")+Math.pow(10,Math.max(0,i)).toString().substr(1)+n}var XH=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,uC=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,ID={},up={};function St(t,e,r,n){var i=n;typeof n=="string"&&(i=function(){return this[n]()}),t&&(up[t]=i),e&&(up[e[0]]=function(){return Lu(i.apply(this,arguments),e[1],e[2])}),r&&(up[r]=function(){return this.localeData().ordinal(i.apply(this,arguments),t)})}function che(t){return t.match(/\[[\s\S]/)?t.replace(/^\[|\]$/g,""):t.replace(/\\/g,"")}function hhe(t){var e=t.match(XH),r,n;for(r=0,n=e.length;r<n;r++)up[e[r]]?e[r]=up[e[r]]:e[r]=che(e[r]);return function(i){var s="",a;for(a=0;a<n;a++)s+=Gu(e[a])?e[a].call(i,t):e[a];return s}}function dE(t,e){return t.isValid()?(e=fX(e,t.localeData()),ID[e]=ID[e]||hhe(e),ID[e](t)):t.localeData().invalidDate()}function fX(t,e){var r=5;function n(i){return e.longDateFormat(i)||i}for(uC.lastIndex=0;r>=0&&uC.test(t);)t=t.replace(uC,n),uC.lastIndex=0,r-=1;return t}var fhe={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function dhe(t){var e=this._longDateFormat[t],r=this._longDateFormat[t.toUpperCase()];return e||!r?e:(this._longDateFormat[t]=r.match(XH).map(function(n){return n==="MMMM"||n==="MM"||n==="DD"||n==="dddd"?n.slice(1):n}).join(""),this._longDateFormat[t])}var ghe="Invalid date";function mhe(){return this._invalidDate}var phe="%d",vhe=/\d{1,2}/;function whe(t){return this._ordinal.replace("%d",t)}var yhe={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function She(t,e,r,n){var i=this._relativeTime[r];return Gu(i)?i(t,e,r,n):i.replace(/%d/i,t)}function bhe(t,e){var r=this._relativeTime[t>0?"future":"past"];return Gu(r)?r(e):r.replace(/%s/i,e)}var wj={D:"date",dates:"date",date:"date",d:"day",days:"day",day:"day",e:"weekday",weekdays:"weekday",weekday:"weekday",E:"isoWeekday",isoweekdays:"isoWeekday",isoweekday:"isoWeekday",DDD:"dayOfYear",dayofyears:"dayOfYear",dayofyear:"dayOfYear",h:"hour",hours:"hour",hour:"hour",ms:"millisecond",milliseconds:"millisecond",millisecond:"millisecond",m:"minute",minutes:"minute",minute:"minute",M:"month",months:"month",month:"month",Q:"quarter",quarters:"quarter",quarter:"quarter",s:"second",seconds:"second",second:"second",gg:"weekYear",weekyears:"weekYear",weekyear:"weekYear",GG:"isoWeekYear",isoweekyears:"isoWeekYear",isoweekyear:"isoWeekYear",w:"week",weeks:"week",week:"week",W:"isoWeek",isoweeks:"isoWeek",isoweek:"isoWeek",y:"year",years:"year",year:"year"};function Xo(t){return typeof t=="string"?wj[t]||wj[t.toLowerCase()]:void 0}function QH(t){var e={},r,n;for(n in t)_r(t,n)&&(r=Xo(n),r&&(e[r]=t[n]));return e}var Che={date:9,day:11,weekday:11,isoWeekday:11,dayOfYear:4,hour:13,millisecond:16,minute:14,month:8,quarter:7,second:15,weekYear:1,isoWeekYear:1,week:5,isoWeek:5,year:1};function xhe(t){var e=[],r;for(r in t)_r(t,r)&&e.push({unit:r,priority:Che[r]});return e.sort(function(n,i){return n.priority-i.priority}),e}var dX=/\d/,eo=/\d\d/,gX=/\d{3}/,ZH=/\d{4}/,MR=/[+-]?\d{6}/,wn=/\d\d?/,mX=/\d\d\d\d?/,pX=/\d\d\d\d\d\d?/,AR=/\d{1,3}/,JH=/\d{1,4}/,OR=/[+-]?\d{1,6}/,tv=/\d+/,kR=/[+-]?\d+/,Ehe=/Z|[+-]\d\d:?\d\d/gi,DR=/Z|[+-]\d\d(?::?\d\d)?/gi,_he=/[+-]?\d+(\.\d{1,3})?/,vS=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,rv=/^[1-9]\d?/,eF=/^([1-9]\d|\d)/,zE;zE={};function st(t,e,r){zE[t]=Gu(e)?e:function(n,i){return n&&r?r:e}}function Rhe(t,e){return _r(zE,t)?zE[t](e._strict,e._locale):new RegExp(The(t))}function The(t){return Yc(t.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,r,n,i,s){return r||n||i||s}))}function Yc(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function No(t){return t<0?Math.ceil(t)||0:Math.floor(t)}function sr(t){var e=+t,r=0;return e!==0&&isFinite(e)&&(r=No(e)),r}var GI={};function Jr(t,e){var r,n=e,i;for(typeof t=="string"&&(t=[t]),th(e)&&(n=function(s,a){a[e]=sr(s)}),i=t.length,r=0;r<i;r++)GI[t[r]]=n}function wS(t,e){Jr(t,function(r,n,i,s){i._w=i._w||{},e(r,i._w,i,s)})}function Mhe(t,e,r){e!=null&&_r(GI,t)&&GI[t](e,r._a,r,t)}function PR(t){return t%4===0&&t%100!==0||t%400===0}var _s=0,Hc=1,xu=2,Ii=3,El=4,Fc=5,mg=6,Ahe=7,Ohe=8;St("Y",0,0,function(){var t=this.year();return t<=9999?Lu(t,4):"+"+t});St(0,["YY",2],0,function(){return this.year()%100});St(0,["YYYY",4],0,"year");St(0,["YYYYY",5],0,"year");St(0,["YYYYYY",6,!0],0,"year");st("Y",kR);st("YY",wn,eo);st("YYYY",JH,ZH);st("YYYYY",OR,MR);st("YYYYYY",OR,MR);Jr(["YYYYY","YYYYYY"],_s);Jr("YYYY",function(t,e){e[_s]=t.length===2?je.parseTwoDigitYear(t):sr(t)});Jr("YY",function(t,e){e[_s]=je.parseTwoDigitYear(t)});Jr("Y",function(t,e){e[_s]=parseInt(t,10)});function Dy(t){return PR(t)?366:365}je.parseTwoDigitYear=function(t){return sr(t)+(sr(t)>68?1900:2e3)};var vX=nv("FullYear",!0);function khe(){return PR(this.year())}function nv(t,e){return function(r){return r!=null?(wX(this,t,r),je.updateOffset(this,e),this):p1(this,t)}}function p1(t,e){if(!t.isValid())return NaN;var r=t._d,n=t._isUTC;switch(e){case"Milliseconds":return n?r.getUTCMilliseconds():r.getMilliseconds();case"Seconds":return n?r.getUTCSeconds():r.getSeconds();case"Minutes":return n?r.getUTCMinutes():r.getMinutes();case"Hours":return n?r.getUTCHours():r.getHours();case"Date":return n?r.getUTCDate():r.getDate();case"Day":return n?r.getUTCDay():r.getDay();case"Month":return n?r.getUTCMonth():r.getMonth();case"FullYear":return n?r.getUTCFullYear():r.getFullYear();default:return NaN}}function wX(t,e,r){var n,i,s,a,o;if(!(!t.isValid()||isNaN(r))){switch(n=t._d,i=t._isUTC,e){case"Milliseconds":return void(i?n.setUTCMilliseconds(r):n.setMilliseconds(r));case"Seconds":return void(i?n.setUTCSeconds(r):n.setSeconds(r));case"Minutes":return void(i?n.setUTCMinutes(r):n.setMinutes(r));case"Hours":return void(i?n.setUTCHours(r):n.setHours(r));case"Date":return void(i?n.setUTCDate(r):n.setDate(r));case"FullYear":break;default:return}s=r,a=t.month(),o=t.date(),o=o===29&&a===1&&!PR(s)?28:o,i?n.setUTCFullYear(s,a,o):n.setFullYear(s,a,o)}}function Dhe(t){return t=Xo(t),Gu(this[t])?this[t]():this}function Phe(t,e){if(typeof t=="object"){t=QH(t);var r=xhe(t),n,i=r.length;for(n=0;n<i;n++)this[r[n].unit](t[r[n].unit])}else if(t=Xo(t),Gu(this[t]))return this[t](e);return this}function Ihe(t,e){return(t%e+e)%e}var ri;Array.prototype.indexOf?ri=Array.prototype.indexOf:ri=function(t){var e;for(e=0;e<this.length;++e)if(this[e]===t)return e;return-1};function tF(t,e){if(isNaN(t)||isNaN(e))return NaN;var r=Ihe(e,12);return t+=(e-r)/12,r===1?PR(t)?29:28:31-r%7%2}St("M",["MM",2],"Mo",function(){return this.month()+1});St("MMM",0,0,function(t){return this.localeData().monthsShort(this,t)});St("MMMM",0,0,function(t){return this.localeData().months(this,t)});st("M",wn,rv);st("MM",wn,eo);st("MMM",function(t,e){return e.monthsShortRegex(t)});st("MMMM",function(t,e){return e.monthsRegex(t)});Jr(["M","MM"],function(t,e){e[Hc]=sr(t)-1});Jr(["MMM","MMMM"],function(t,e,r,n){var i=r._locale.monthsParse(t,n,r._strict);i!=null?e[Hc]=i:Bt(r).invalidMonth=t});var Nhe="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),yX="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),SX=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,Hhe=vS,Fhe=vS;function Lhe(t,e){return t?Pl(this._months)?this._months[t.month()]:this._months[(this._months.isFormat||SX).test(e)?"format":"standalone"][t.month()]:Pl(this._months)?this._months:this._months.standalone}function Bhe(t,e){return t?Pl(this._monthsShort)?this._monthsShort[t.month()]:this._monthsShort[SX.test(e)?"format":"standalone"][t.month()]:Pl(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function Vhe(t,e,r){var n,i,s,a=t.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],n=0;n<12;++n)s=zu([2e3,n]),this._shortMonthsParse[n]=this.monthsShort(s,"").toLocaleLowerCase(),this._longMonthsParse[n]=this.months(s,"").toLocaleLowerCase();return r?e==="MMM"?(i=ri.call(this._shortMonthsParse,a),i!==-1?i:null):(i=ri.call(this._longMonthsParse,a),i!==-1?i:null):e==="MMM"?(i=ri.call(this._shortMonthsParse,a),i!==-1?i:(i=ri.call(this._longMonthsParse,a),i!==-1?i:null)):(i=ri.call(this._longMonthsParse,a),i!==-1?i:(i=ri.call(this._shortMonthsParse,a),i!==-1?i:null))}function Whe(t,e,r){var n,i,s;if(this._monthsParseExact)return Vhe.call(this,t,e,r);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),n=0;n<12;n++){if(i=zu([2e3,n]),r&&!this._longMonthsParse[n]&&(this._longMonthsParse[n]=new RegExp("^"+this.months(i,"").replace(".","")+"$","i"),this._shortMonthsParse[n]=new RegExp("^"+this.monthsShort(i,"").replace(".","")+"$","i")),!r&&!this._monthsParse[n]&&(s="^"+this.months(i,"")+"|^"+this.monthsShort(i,""),this._monthsParse[n]=new RegExp(s.replace(".",""),"i")),r&&e==="MMMM"&&this._longMonthsParse[n].test(t))return n;if(r&&e==="MMM"&&this._shortMonthsParse[n].test(t))return n;if(!r&&this._monthsParse[n].test(t))return n}}function bX(t,e){if(!t.isValid())return t;if(typeof e=="string"){if(/^\d+$/.test(e))e=sr(e);else if(e=t.localeData().monthsParse(e),!th(e))return t}var r=e,n=t.date();return n=n<29?n:Math.min(n,tF(t.year(),r)),t._isUTC?t._d.setUTCMonth(r,n):t._d.setMonth(r,n),t}function CX(t){return t!=null?(bX(this,t),je.updateOffset(this,!0),this):p1(this,"Month")}function $he(){return tF(this.year(),this.month())}function Uhe(t){return this._monthsParseExact?(_r(this,"_monthsRegex")||xX.call(this),t?this._monthsShortStrictRegex:this._monthsShortRegex):(_r(this,"_monthsShortRegex")||(this._monthsShortRegex=Hhe),this._monthsShortStrictRegex&&t?this._monthsShortStrictRegex:this._monthsShortRegex)}function jhe(t){return this._monthsParseExact?(_r(this,"_monthsRegex")||xX.call(this),t?this._monthsStrictRegex:this._monthsRegex):(_r(this,"_monthsRegex")||(this._monthsRegex=Fhe),this._monthsStrictRegex&&t?this._monthsStrictRegex:this._monthsRegex)}function xX(){function t(u,c){return c.length-u.length}var e=[],r=[],n=[],i,s,a,o;for(i=0;i<12;i++)s=zu([2e3,i]),a=Yc(this.monthsShort(s,"")),o=Yc(this.months(s,"")),e.push(a),r.push(o),n.push(o),n.push(a);e.sort(t),r.sort(t),n.sort(t),this._monthsRegex=new RegExp("^("+n.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+e.join("|")+")","i")}function Yhe(t,e,r,n,i,s,a){var o;return t<100&&t>=0?(o=new Date(t+400,e,r,n,i,s,a),isFinite(o.getFullYear())&&o.setFullYear(t)):o=new Date(t,e,r,n,i,s,a),o}function v1(t){var e,r;return t<100&&t>=0?(r=Array.prototype.slice.call(arguments),r[0]=t+400,e=new Date(Date.UTC.apply(null,r)),isFinite(e.getUTCFullYear())&&e.setUTCFullYear(t)):e=new Date(Date.UTC.apply(null,arguments)),e}function GE(t,e,r){var n=7+e-r,i=(7+v1(t,0,n).getUTCDay()-e)%7;return-i+n-1}function EX(t,e,r,n,i){var s=(7+r-n)%7,a=GE(t,n,i),o=1+7*(e-1)+s+a,u,c;return o<=0?(u=t-1,c=Dy(u)+o):o>Dy(t)?(u=t+1,c=o-Dy(t)):(u=t,c=o),{year:u,dayOfYear:c}}function w1(t,e,r){var n=GE(t.year(),e,r),i=Math.floor((t.dayOfYear()-n-1)/7)+1,s,a;return i<1?(a=t.year()-1,s=i+zc(a,e,r)):i>zc(t.year(),e,r)?(s=i-zc(t.year(),e,r),a=t.year()+1):(a=t.year(),s=i),{week:s,year:a}}function zc(t,e,r){var n=GE(t,e,r),i=GE(t+1,e,r);return(Dy(t)-n+i)/7}St("w",["ww",2],"wo","week");St("W",["WW",2],"Wo","isoWeek");st("w",wn,rv);st("ww",wn,eo);st("W",wn,rv);st("WW",wn,eo);wS(["w","ww","W","WW"],function(t,e,r,n){e[n.substr(0,1)]=sr(t)});function zhe(t){return w1(t,this._week.dow,this._week.doy).week}var Ghe={dow:0,doy:6};function qhe(){return this._week.dow}function Khe(){return this._week.doy}function Xhe(t){var e=this.localeData().week(this);return t==null?e:this.add((t-e)*7,"d")}function Qhe(t){var e=w1(this,1,4).week;return t==null?e:this.add((t-e)*7,"d")}St("d",0,"do","day");St("dd",0,0,function(t){return this.localeData().weekdaysMin(this,t)});St("ddd",0,0,function(t){return this.localeData().weekdaysShort(this,t)});St("dddd",0,0,function(t){return this.localeData().weekdays(this,t)});St("e",0,0,"weekday");St("E",0,0,"isoWeekday");st("d",wn);st("e",wn);st("E",wn);st("dd",function(t,e){return e.weekdaysMinRegex(t)});st("ddd",function(t,e){return e.weekdaysShortRegex(t)});st("dddd",function(t,e){return e.weekdaysRegex(t)});wS(["dd","ddd","dddd"],function(t,e,r,n){var i=r._locale.weekdaysParse(t,n,r._strict);i!=null?e.d=i:Bt(r).invalidWeekday=t});wS(["d","e","E"],function(t,e,r,n){e[n]=sr(t)});function Zhe(t,e){return typeof t!="string"?t:isNaN(t)?(t=e.weekdaysParse(t),typeof t=="number"?t:null):parseInt(t,10)}function Jhe(t,e){return typeof t=="string"?e.weekdaysParse(t)%7||7:isNaN(t)?null:t}function rF(t,e){return t.slice(e,7).concat(t.slice(0,e))}var efe="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),_X="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),tfe="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),rfe=vS,nfe=vS,ife=vS;function sfe(t,e){var r=Pl(this._weekdays)?this._weekdays:this._weekdays[t&&t!==!0&&this._weekdays.isFormat.test(e)?"format":"standalone"];return t===!0?rF(r,this._week.dow):t?r[t.day()]:r}function afe(t){return t===!0?rF(this._weekdaysShort,this._week.dow):t?this._weekdaysShort[t.day()]:this._weekdaysShort}function ofe(t){return t===!0?rF(this._weekdaysMin,this._week.dow):t?this._weekdaysMin[t.day()]:this._weekdaysMin}function lfe(t,e,r){var n,i,s,a=t.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],n=0;n<7;++n)s=zu([2e3,1]).day(n),this._minWeekdaysParse[n]=this.weekdaysMin(s,"").toLocaleLowerCase(),this._shortWeekdaysParse[n]=this.weekdaysShort(s,"").toLocaleLowerCase(),this._weekdaysParse[n]=this.weekdays(s,"").toLocaleLowerCase();return r?e==="dddd"?(i=ri.call(this._weekdaysParse,a),i!==-1?i:null):e==="ddd"?(i=ri.call(this._shortWeekdaysParse,a),i!==-1?i:null):(i=ri.call(this._minWeekdaysParse,a),i!==-1?i:null):e==="dddd"?(i=ri.call(this._weekdaysParse,a),i!==-1||(i=ri.call(this._shortWeekdaysParse,a),i!==-1)?i:(i=ri.call(this._minWeekdaysParse,a),i!==-1?i:null)):e==="ddd"?(i=ri.call(this._shortWeekdaysParse,a),i!==-1||(i=ri.call(this._weekdaysParse,a),i!==-1)?i:(i=ri.call(this._minWeekdaysParse,a),i!==-1?i:null)):(i=ri.call(this._minWeekdaysParse,a),i!==-1||(i=ri.call(this._weekdaysParse,a),i!==-1)?i:(i=ri.call(this._shortWeekdaysParse,a),i!==-1?i:null))}function ufe(t,e,r){var n,i,s;if(this._weekdaysParseExact)return lfe.call(this,t,e,r);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),n=0;n<7;n++){if(i=zu([2e3,1]).day(n),r&&!this._fullWeekdaysParse[n]&&(this._fullWeekdaysParse[n]=new RegExp("^"+this.weekdays(i,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[n]=new RegExp("^"+this.weekdaysShort(i,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[n]=new RegExp("^"+this.weekdaysMin(i,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[n]||(s="^"+this.weekdays(i,"")+"|^"+this.weekdaysShort(i,"")+"|^"+this.weekdaysMin(i,""),this._weekdaysParse[n]=new RegExp(s.replace(".",""),"i")),r&&e==="dddd"&&this._fullWeekdaysParse[n].test(t))return n;if(r&&e==="ddd"&&this._shortWeekdaysParse[n].test(t))return n;if(r&&e==="dd"&&this._minWeekdaysParse[n].test(t))return n;if(!r&&this._weekdaysParse[n].test(t))return n}}function cfe(t){if(!this.isValid())return t!=null?this:NaN;var e=p1(this,"Day");return t!=null?(t=Zhe(t,this.localeData()),this.add(t-e,"d")):e}function hfe(t){if(!this.isValid())return t!=null?this:NaN;var e=(this.day()+7-this.localeData()._week.dow)%7;return t==null?e:this.add(t-e,"d")}function ffe(t){if(!this.isValid())return t!=null?this:NaN;if(t!=null){var e=Jhe(t,this.localeData());return this.day(this.day()%7?e:e-7)}else return this.day()||7}function dfe(t){return this._weekdaysParseExact?(_r(this,"_weekdaysRegex")||nF.call(this),t?this._weekdaysStrictRegex:this._weekdaysRegex):(_r(this,"_weekdaysRegex")||(this._weekdaysRegex=rfe),this._weekdaysStrictRegex&&t?this._weekdaysStrictRegex:this._weekdaysRegex)}function gfe(t){return this._weekdaysParseExact?(_r(this,"_weekdaysRegex")||nF.call(this),t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(_r(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=nfe),this._weekdaysShortStrictRegex&&t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function mfe(t){return this._weekdaysParseExact?(_r(this,"_weekdaysRegex")||nF.call(this),t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(_r(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=ife),this._weekdaysMinStrictRegex&&t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function nF(){function t(f,g){return g.length-f.length}var e=[],r=[],n=[],i=[],s,a,o,u,c;for(s=0;s<7;s++)a=zu([2e3,1]).day(s),o=Yc(this.weekdaysMin(a,"")),u=Yc(this.weekdaysShort(a,"")),c=Yc(this.weekdays(a,"")),e.push(o),r.push(u),n.push(c),i.push(o),i.push(u),i.push(c);e.sort(t),r.sort(t),n.sort(t),i.sort(t),this._weekdaysRegex=new RegExp("^("+i.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+e.join("|")+")","i")}function iF(){return this.hours()%12||12}function pfe(){return this.hours()||24}St("H",["HH",2],0,"hour");St("h",["hh",2],0,iF);St("k",["kk",2],0,pfe);St("hmm",0,0,function(){return""+iF.apply(this)+Lu(this.minutes(),2)});St("hmmss",0,0,function(){return""+iF.apply(this)+Lu(this.minutes(),2)+Lu(this.seconds(),2)});St("Hmm",0,0,function(){return""+this.hours()+Lu(this.minutes(),2)});St("Hmmss",0,0,function(){return""+this.hours()+Lu(this.minutes(),2)+Lu(this.seconds(),2)});function RX(t,e){St(t,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),e)})}RX("a",!0);RX("A",!1);function TX(t,e){return e._meridiemParse}st("a",TX);st("A",TX);st("H",wn,eF);st("h",wn,rv);st("k",wn,rv);st("HH",wn,eo);st("hh",wn,eo);st("kk",wn,eo);st("hmm",mX);st("hmmss",pX);st("Hmm",mX);st("Hmmss",pX);Jr(["H","HH"],Ii);Jr(["k","kk"],function(t,e,r){var n=sr(t);e[Ii]=n===24?0:n});Jr(["a","A"],function(t,e,r){r._isPm=r._locale.isPM(t),r._meridiem=t});Jr(["h","hh"],function(t,e,r){e[Ii]=sr(t),Bt(r).bigHour=!0});Jr("hmm",function(t,e,r){var n=t.length-2;e[Ii]=sr(t.substr(0,n)),e[El]=sr(t.substr(n)),Bt(r).bigHour=!0});Jr("hmmss",function(t,e,r){var n=t.length-4,i=t.length-2;e[Ii]=sr(t.substr(0,n)),e[El]=sr(t.substr(n,2)),e[Fc]=sr(t.substr(i)),Bt(r).bigHour=!0});Jr("Hmm",function(t,e,r){var n=t.length-2;e[Ii]=sr(t.substr(0,n)),e[El]=sr(t.substr(n))});Jr("Hmmss",function(t,e,r){var n=t.length-4,i=t.length-2;e[Ii]=sr(t.substr(0,n)),e[El]=sr(t.substr(n,2)),e[Fc]=sr(t.substr(i))});function vfe(t){return(t+"").toLowerCase().charAt(0)==="p"}var wfe=/[ap]\.?m?\.?/i,yfe=nv("Hours",!0);function Sfe(t,e,r){return t>11?r?"pm":"PM":r?"am":"AM"}var MX={calendar:lhe,longDateFormat:fhe,invalidDate:ghe,ordinal:phe,dayOfMonthOrdinalParse:vhe,relativeTime:yhe,months:Nhe,monthsShort:yX,week:Ghe,weekdays:efe,weekdaysMin:tfe,weekdaysShort:_X,meridiemParse:wfe},Sn={},yw={},y1;function bfe(t,e){var r,n=Math.min(t.length,e.length);for(r=0;r<n;r+=1)if(t[r]!==e[r])return r;return n}function yj(t){return t&&t.toLowerCase().replace("_","-")}function Cfe(t){for(var e=0,r,n,i,s;e<t.length;){for(s=yj(t[e]).split("-"),r=s.length,n=yj(t[e+1]),n=n?n.split("-"):null;r>0;){if(i=IR(s.slice(0,r).join("-")),i)return i;if(n&&n.length>=r&&bfe(s,n)>=r-1)break;r--}e++}return y1}function xfe(t){return!!(t&&t.match("^[^/\\\\]*$"))}function IR(t){var e=null,r;if(Sn[t]===void 0&&typeof WE<"u"&&WE&&WE.exports&&xfe(t))try{e=y1._abbr,r=require,r("./locale/"+t),Of(e)}catch{Sn[t]=null}return Sn[t]}function Of(t,e){var r;return t&&(ua(e)?r=lh(t):r=sF(t,e),r?y1=r:typeof console<"u"&&console.warn&&console.warn("Locale "+t+" not found. Did you forget to load it?")),y1._abbr}function sF(t,e){if(e!==null){var r,n=MX;if(e.abbr=t,Sn[t]!=null)hX("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),n=Sn[t]._config;else if(e.parentLocale!=null)if(Sn[e.parentLocale]!=null)n=Sn[e.parentLocale]._config;else if(r=IR(e.parentLocale),r!=null)n=r._config;else return yw[e.parentLocale]||(yw[e.parentLocale]=[]),yw[e.parentLocale].push({name:t,config:e}),null;return Sn[t]=new KH(YI(n,e)),yw[t]&&yw[t].forEach(function(i){sF(i.name,i.config)}),Of(t),Sn[t]}else return delete Sn[t],null}function Efe(t,e){if(e!=null){var r,n,i=MX;Sn[t]!=null&&Sn[t].parentLocale!=null?Sn[t].set(YI(Sn[t]._config,e)):(n=IR(t),n!=null&&(i=n._config),e=YI(i,e),n==null&&(e.abbr=t),r=new KH(e),r.parentLocale=Sn[t],Sn[t]=r),Of(t)}else Sn[t]!=null&&(Sn[t].parentLocale!=null?(Sn[t]=Sn[t].parentLocale,t===Of()&&Of(t)):Sn[t]!=null&&delete Sn[t]);return Sn[t]}function lh(t){var e;if(t&&t._locale&&t._locale._abbr&&(t=t._locale._abbr),!t)return y1;if(!Pl(t)){if(e=IR(t),e)return e;t=[t]}return Cfe(t)}function _fe(){return zI(Sn)}function aF(t){var e,r=t._a;return r&&Bt(t).overflow===-2&&(e=r[Hc]<0||r[Hc]>11?Hc:r[xu]<1||r[xu]>tF(r[_s],r[Hc])?xu:r[Ii]<0||r[Ii]>24||r[Ii]===24&&(r[El]!==0||r[Fc]!==0||r[mg]!==0)?Ii:r[El]<0||r[El]>59?El:r[Fc]<0||r[Fc]>59?Fc:r[mg]<0||r[mg]>999?mg:-1,Bt(t)._overflowDayOfYear&&(e<_s||e>xu)&&(e=xu),Bt(t)._overflowWeeks&&e===-1&&(e=Ahe),Bt(t)._overflowWeekday&&e===-1&&(e=Ohe),Bt(t).overflow=e),t}var Rfe=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,Tfe=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,Mfe=/Z|[+-]\d\d(?::?\d\d)?/,cC=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],ND=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],Afe=/^\/?Date\((-?\d+)/i,Ofe=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,kfe={UT:0,GMT:0,EDT:-240,EST:-300,CDT:-300,CST:-360,MDT:-360,MST:-420,PDT:-420,PST:-480};function AX(t){var e,r,n=t._i,i=Rfe.exec(n)||Tfe.exec(n),s,a,o,u,c=cC.length,f=ND.length;if(i){for(Bt(t).iso=!0,e=0,r=c;e<r;e++)if(cC[e][1].exec(i[1])){a=cC[e][0],s=cC[e][2]!==!1;break}if(a==null){t._isValid=!1;return}if(i[3]){for(e=0,r=f;e<r;e++)if(ND[e][1].exec(i[3])){o=(i[2]||" ")+ND[e][0];break}if(o==null){t._isValid=!1;return}}if(!s&&o!=null){t._isValid=!1;return}if(i[4])if(Mfe.exec(i[4]))u="Z";else{t._isValid=!1;return}t._f=a+(o||"")+(u||""),lF(t)}else t._isValid=!1}function Dfe(t,e,r,n,i,s){var a=[Pfe(t),yX.indexOf(e),parseInt(r,10),parseInt(n,10),parseInt(i,10)];return s&&a.push(parseInt(s,10)),a}function Pfe(t){var e=parseInt(t,10);return e<=49?2e3+e:e<=999?1900+e:e}function Ife(t){return t.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function Nfe(t,e,r){if(t){var n=_X.indexOf(t),i=new Date(e[0],e[1],e[2]).getDay();if(n!==i)return Bt(r).weekdayMismatch=!0,r._isValid=!1,!1}return!0}function Hfe(t,e,r){if(t)return kfe[t];if(e)return 0;var n=parseInt(r,10),i=n%100,s=(n-i)/100;return s*60+i}function OX(t){var e=Ofe.exec(Ife(t._i)),r;if(e){if(r=Dfe(e[4],e[3],e[2],e[5],e[6],e[7]),!Nfe(e[1],r,t))return;t._a=r,t._tzm=Hfe(e[8],e[9],e[10]),t._d=v1.apply(null,t._a),t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),Bt(t).rfc2822=!0}else t._isValid=!1}function Ffe(t){var e=Afe.exec(t._i);if(e!==null){t._d=new Date(+e[1]);return}if(AX(t),t._isValid===!1)delete t._isValid;else return;if(OX(t),t._isValid===!1)delete t._isValid;else return;t._strict?t._isValid=!1:je.createFromInputFallback(t)}je.createFromInputFallback=Ko("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(t){t._d=new Date(t._i+(t._useUTC?" UTC":""))});function U0(t,e,r){return t??e??r}function Lfe(t){var e=new Date(je.now());return t._useUTC?[e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()]:[e.getFullYear(),e.getMonth(),e.getDate()]}function oF(t){var e,r,n=[],i,s,a;if(!t._d){for(i=Lfe(t),t._w&&t._a[xu]==null&&t._a[Hc]==null&&Bfe(t),t._dayOfYear!=null&&(a=U0(t._a[_s],i[_s]),(t._dayOfYear>Dy(a)||t._dayOfYear===0)&&(Bt(t)._overflowDayOfYear=!0),r=v1(a,0,t._dayOfYear),t._a[Hc]=r.getUTCMonth(),t._a[xu]=r.getUTCDate()),e=0;e<3&&t._a[e]==null;++e)t._a[e]=n[e]=i[e];for(;e<7;e++)t._a[e]=n[e]=t._a[e]==null?e===2?1:0:t._a[e];t._a[Ii]===24&&t._a[El]===0&&t._a[Fc]===0&&t._a[mg]===0&&(t._nextDay=!0,t._a[Ii]=0),t._d=(t._useUTC?v1:Yhe).apply(null,n),s=t._useUTC?t._d.getUTCDay():t._d.getDay(),t._tzm!=null&&t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),t._nextDay&&(t._a[Ii]=24),t._w&&typeof t._w.d<"u"&&t._w.d!==s&&(Bt(t).weekdayMismatch=!0)}}function Bfe(t){var e,r,n,i,s,a,o,u,c;e=t._w,e.GG!=null||e.W!=null||e.E!=null?(s=1,a=4,r=U0(e.GG,t._a[_s],w1(vn(),1,4).year),n=U0(e.W,1),i=U0(e.E,1),(i<1||i>7)&&(u=!0)):(s=t._locale._week.dow,a=t._locale._week.doy,c=w1(vn(),s,a),r=U0(e.gg,t._a[_s],c.year),n=U0(e.w,c.week),e.d!=null?(i=e.d,(i<0||i>6)&&(u=!0)):e.e!=null?(i=e.e+s,(e.e<0||e.e>6)&&(u=!0)):i=s),n<1||n>zc(r,s,a)?Bt(t)._overflowWeeks=!0:u!=null?Bt(t)._overflowWeekday=!0:(o=EX(r,n,i,s,a),t._a[_s]=o.year,t._dayOfYear=o.dayOfYear)}je.ISO_8601=function(){};je.RFC_2822=function(){};function lF(t){if(t._f===je.ISO_8601){AX(t);return}if(t._f===je.RFC_2822){OX(t);return}t._a=[],Bt(t).empty=!0;var e=""+t._i,r,n,i,s,a,o=e.length,u=0,c,f;for(i=fX(t._f,t._locale).match(XH)||[],f=i.length,r=0;r<f;r++)s=i[r],n=(e.match(Rhe(s,t))||[])[0],n&&(a=e.substr(0,e.indexOf(n)),a.length>0&&Bt(t).unusedInput.push(a),e=e.slice(e.indexOf(n)+n.length),u+=n.length),up[s]?(n?Bt(t).empty=!1:Bt(t).unusedTokens.push(s),Mhe(s,n,t)):t._strict&&!n&&Bt(t).unusedTokens.push(s);Bt(t).charsLeftOver=o-u,e.length>0&&Bt(t).unusedInput.push(e),t._a[Ii]<=12&&Bt(t).bigHour===!0&&t._a[Ii]>0&&(Bt(t).bigHour=void 0),Bt(t).parsedDateParts=t._a.slice(0),Bt(t).meridiem=t._meridiem,t._a[Ii]=Vfe(t._locale,t._a[Ii],t._meridiem),c=Bt(t).era,c!==null&&(t._a[_s]=t._locale.erasConvertYear(c,t._a[_s])),oF(t),aF(t)}function Vfe(t,e,r){var n;return r==null?e:t.meridiemHour!=null?t.meridiemHour(e,r):(t.isPM!=null&&(n=t.isPM(r),n&&e<12&&(e+=12),!n&&e===12&&(e=0)),e)}function Wfe(t){var e,r,n,i,s,a,o=!1,u=t._f.length;if(u===0){Bt(t).invalidFormat=!0,t._d=new Date(NaN);return}for(i=0;i<u;i++)s=0,a=!1,e=qH({},t),t._useUTC!=null&&(e._useUTC=t._useUTC),e._f=t._f[i],lF(e),GH(e)&&(a=!0),s+=Bt(e).charsLeftOver,s+=Bt(e).unusedTokens.length*10,Bt(e).score=s,o?s<n&&(n=s,r=e):(n==null||s<n||a)&&(n=s,r=e,a&&(o=!0));wf(t,r||e)}function $fe(t){if(!t._d){var e=QH(t._i),r=e.day===void 0?e.date:e.day;t._a=uX([e.year,e.month,r,e.hour,e.minute,e.second,e.millisecond],function(n){return n&&parseInt(n,10)}),oF(t)}}function Ufe(t){var e=new pS(aF(kX(t)));return e._nextDay&&(e.add(1,"d"),e._nextDay=void 0),e}function kX(t){var e=t._i,r=t._f;return t._locale=t._locale||lh(t._l),e===null||r===void 0&&e===""?TR({nullInput:!0}):(typeof e=="string"&&(t._i=e=t._locale.preparse(e)),Il(e)?new pS(aF(e)):(mS(e)?t._d=e:Pl(r)?Wfe(t):r?lF(t):jfe(t),GH(t)||(t._d=null),t))}function jfe(t){var e=t._i;ua(e)?t._d=new Date(je.now()):mS(e)?t._d=new Date(e.valueOf()):typeof e=="string"?Ffe(t):Pl(e)?(t._a=uX(e.slice(0),function(r){return parseInt(r,10)}),oF(t)):Eg(e)?$fe(t):th(e)?t._d=new Date(e):je.createFromInputFallback(t)}function DX(t,e,r,n,i){var s={};return(e===!0||e===!1)&&(n=e,e=void 0),(r===!0||r===!1)&&(n=r,r=void 0),(Eg(t)&&zH(t)||Pl(t)&&t.length===0)&&(t=void 0),s._isAMomentObject=!0,s._useUTC=s._isUTC=i,s._l=r,s._i=t,s._f=e,s._strict=n,Ufe(s)}function vn(t,e,r,n){return DX(t,e,r,n,!1)}var Yfe=Ko("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=vn.apply(null,arguments);return this.isValid()&&t.isValid()?t<this?this:t:TR()}),zfe=Ko("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=vn.apply(null,arguments);return this.isValid()&&t.isValid()?t>this?this:t:TR()});function PX(t,e){var r,n;if(e.length===1&&Pl(e[0])&&(e=e[0]),!e.length)return vn();for(r=e[0],n=1;n<e.length;++n)(!e[n].isValid()||e[n][t](r))&&(r=e[n]);return r}function Gfe(){var t=[].slice.call(arguments,0);return PX("isBefore",t)}function qfe(){var t=[].slice.call(arguments,0);return PX("isAfter",t)}var Kfe=function(){return Date.now?Date.now():+new Date},Sw=["year","quarter","month","week","day","hour","minute","second","millisecond"];function Xfe(t){var e,r=!1,n,i=Sw.length;for(e in t)if(_r(t,e)&&!(ri.call(Sw,e)!==-1&&(t[e]==null||!isNaN(t[e]))))return!1;for(n=0;n<i;++n)if(t[Sw[n]]){if(r)return!1;parseFloat(t[Sw[n]])!==sr(t[Sw[n]])&&(r=!0)}return!0}function Qfe(){return this._isValid}function Zfe(){return Ll(NaN)}function NR(t){var e=QH(t),r=e.year||0,n=e.quarter||0,i=e.month||0,s=e.week||e.isoWeek||0,a=e.day||0,o=e.hour||0,u=e.minute||0,c=e.second||0,f=e.millisecond||0;this._isValid=Xfe(e),this._milliseconds=+f+c*1e3+u*6e4+o*1e3*60*60,this._days=+a+s*7,this._months=+i+n*3+r*12,this._data={},this._locale=lh(),this._bubble()}function gE(t){return t instanceof NR}function qI(t){return t<0?Math.round(-1*t)*-1:Math.round(t)}function Jfe(t,e,r){var n=Math.min(t.length,e.length),i=Math.abs(t.length-e.length),s=0,a;for(a=0;a<n;a++)sr(t[a])!==sr(e[a])&&s++;return s+i}function IX(t,e){St(t,0,0,function(){var r=this.utcOffset(),n="+";return r<0&&(r=-r,n="-"),n+Lu(~~(r/60),2)+e+Lu(~~r%60,2)})}IX("Z",":");IX("ZZ","");st("Z",DR);st("ZZ",DR);Jr(["Z","ZZ"],function(t,e,r){r._useUTC=!0,r._tzm=uF(DR,t)});var ede=/([\+\-]|\d\d)/gi;function uF(t,e){var r=(e||"").match(t),n,i,s;return r===null?null:(n=r[r.length-1]||[],i=(n+"").match(ede)||["-",0,0],s=+(i[1]*60)+sr(i[2]),s===0?0:i[0]==="+"?s:-s)}function cF(t,e){var r,n;return e._isUTC?(r=e.clone(),n=(Il(t)||mS(t)?t.valueOf():vn(t).valueOf())-r.valueOf(),r._d.setTime(r._d.valueOf()+n),je.updateOffset(r,!1),r):vn(t).local()}function KI(t){return-Math.round(t._d.getTimezoneOffset())}je.updateOffset=function(){};function tde(t,e,r){var n=this._offset||0,i;if(!this.isValid())return t!=null?this:NaN;if(t!=null){if(typeof t=="string"){if(t=uF(DR,t),t===null)return this}else Math.abs(t)<16&&!r&&(t=t*60);return!this._isUTC&&e&&(i=KI(this)),this._offset=t,this._isUTC=!0,i!=null&&this.add(i,"m"),n!==t&&(!e||this._changeInProgress?FX(this,Ll(t-n,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,je.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?n:KI(this)}function rde(t,e){return t!=null?(typeof t!="string"&&(t=-t),this.utcOffset(t,e),this):-this.utcOffset()}function nde(t){return this.utcOffset(0,t)}function ide(t){return this._isUTC&&(this.utcOffset(0,t),this._isUTC=!1,t&&this.subtract(KI(this),"m")),this}function sde(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var t=uF(Ehe,this._i);t!=null?this.utcOffset(t):this.utcOffset(0,!0)}return this}function ade(t){return this.isValid()?(t=t?vn(t).utcOffset():0,(this.utcOffset()-t)%60===0):!1}function ode(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function lde(){if(!ua(this._isDSTShifted))return this._isDSTShifted;var t={},e;return qH(t,this),t=kX(t),t._a?(e=t._isUTC?zu(t._a):vn(t._a),this._isDSTShifted=this.isValid()&&Jfe(t._a,e.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function ude(){return this.isValid()?!this._isUTC:!1}function cde(){return this.isValid()?this._isUTC:!1}function NX(){return this.isValid()?this._isUTC&&this._offset===0:!1}var hde=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,fde=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function Ll(t,e){var r=t,n=null,i,s,a;return gE(t)?r={ms:t._milliseconds,d:t._days,M:t._months}:th(t)||!isNaN(+t)?(r={},e?r[e]=+t:r.milliseconds=+t):(n=hde.exec(t))?(i=n[1]==="-"?-1:1,r={y:0,d:sr(n[xu])*i,h:sr(n[Ii])*i,m:sr(n[El])*i,s:sr(n[Fc])*i,ms:sr(qI(n[mg]*1e3))*i}):(n=fde.exec(t))?(i=n[1]==="-"?-1:1,r={y:Ed(n[2],i),M:Ed(n[3],i),w:Ed(n[4],i),d:Ed(n[5],i),h:Ed(n[6],i),m:Ed(n[7],i),s:Ed(n[8],i)}):r==null?r={}:typeof r=="object"&&("from"in r||"to"in r)&&(a=dde(vn(r.from),vn(r.to)),r={},r.ms=a.milliseconds,r.M=a.months),s=new NR(r),gE(t)&&_r(t,"_locale")&&(s._locale=t._locale),gE(t)&&_r(t,"_isValid")&&(s._isValid=t._isValid),s}Ll.fn=NR.prototype;Ll.invalid=Zfe;function Ed(t,e){var r=t&&parseFloat(t.replace(",","."));return(isNaN(r)?0:r)*e}function Sj(t,e){var r={};return r.months=e.month()-t.month()+(e.year()-t.year())*12,t.clone().add(r.months,"M").isAfter(e)&&--r.months,r.milliseconds=+e-+t.clone().add(r.months,"M"),r}function dde(t,e){var r;return t.isValid()&&e.isValid()?(e=cF(e,t),t.isBefore(e)?r=Sj(t,e):(r=Sj(e,t),r.milliseconds=-r.milliseconds,r.months=-r.months),r):{milliseconds:0,months:0}}function HX(t,e){return function(r,n){var i,s;return n!==null&&!isNaN(+n)&&(hX(e,"moment()."+e+"(period, number) is deprecated. Please use moment()."+e+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),s=r,r=n,n=s),i=Ll(r,n),FX(this,i,t),this}}function FX(t,e,r,n){var i=e._milliseconds,s=qI(e._days),a=qI(e._months);t.isValid()&&(n=n??!0,a&&bX(t,p1(t,"Month")+a*r),s&&wX(t,"Date",p1(t,"Date")+s*r),i&&t._d.setTime(t._d.valueOf()+i*r),n&&je.updateOffset(t,s||a))}var gde=HX(1,"add"),mde=HX(-1,"subtract");function LX(t){return typeof t=="string"||t instanceof String}function pde(t){return Il(t)||mS(t)||LX(t)||th(t)||wde(t)||vde(t)||t===null||t===void 0}function vde(t){var e=Eg(t)&&!zH(t),r=!1,n=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],i,s,a=n.length;for(i=0;i<a;i+=1)s=n[i],r=r||_r(t,s);return e&&r}function wde(t){var e=Pl(t),r=!1;return e&&(r=t.filter(function(n){return!th(n)&&LX(t)}).length===0),e&&r}function yde(t){var e=Eg(t)&&!zH(t),r=!1,n=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],i,s;for(i=0;i<n.length;i+=1)s=n[i],r=r||_r(t,s);return e&&r}function Sde(t,e){var r=t.diff(e,"days",!0);return r<-6?"sameElse":r<-1?"lastWeek":r<0?"lastDay":r<1?"sameDay":r<2?"nextDay":r<7?"nextWeek":"sameElse"}function bde(t,e){arguments.length===1&&(arguments[0]?pde(arguments[0])?(t=arguments[0],e=void 0):yde(arguments[0])&&(e=arguments[0],t=void 0):(t=void 0,e=void 0));var r=t||vn(),n=cF(r,this).startOf("day"),i=je.calendarFormat(this,n)||"sameElse",s=e&&(Gu(e[i])?e[i].call(this,r):e[i]);return this.format(s||this.localeData().calendar(i,this,vn(r)))}function Cde(){return new pS(this)}function xde(t,e){var r=Il(t)?t:vn(t);return this.isValid()&&r.isValid()?(e=Xo(e)||"millisecond",e==="millisecond"?this.valueOf()>r.valueOf():r.valueOf()<this.clone().startOf(e).valueOf()):!1}function Ede(t,e){var r=Il(t)?t:vn(t);return this.isValid()&&r.isValid()?(e=Xo(e)||"millisecond",e==="millisecond"?this.valueOf()<r.valueOf():this.clone().endOf(e).valueOf()<r.valueOf()):!1}function _de(t,e,r,n){var i=Il(t)?t:vn(t),s=Il(e)?e:vn(e);return this.isValid()&&i.isValid()&&s.isValid()?(n=n||"()",(n[0]==="("?this.isAfter(i,r):!this.isBefore(i,r))&&(n[1]===")"?this.isBefore(s,r):!this.isAfter(s,r))):!1}function Rde(t,e){var r=Il(t)?t:vn(t),n;return this.isValid()&&r.isValid()?(e=Xo(e)||"millisecond",e==="millisecond"?this.valueOf()===r.valueOf():(n=r.valueOf(),this.clone().startOf(e).valueOf()<=n&&n<=this.clone().endOf(e).valueOf())):!1}function Tde(t,e){return this.isSame(t,e)||this.isAfter(t,e)}function Mde(t,e){return this.isSame(t,e)||this.isBefore(t,e)}function Ade(t,e,r){var n,i,s;if(!this.isValid())return NaN;if(n=cF(t,this),!n.isValid())return NaN;switch(i=(n.utcOffset()-this.utcOffset())*6e4,e=Xo(e),e){case"year":s=mE(this,n)/12;break;case"month":s=mE(this,n);break;case"quarter":s=mE(this,n)/3;break;case"second":s=(this-n)/1e3;break;case"minute":s=(this-n)/6e4;break;case"hour":s=(this-n)/36e5;break;case"day":s=(this-n-i)/864e5;break;case"week":s=(this-n-i)/6048e5;break;default:s=this-n}return r?s:No(s)}function mE(t,e){if(t.date()<e.date())return-mE(e,t);var r=(e.year()-t.year())*12+(e.month()-t.month()),n=t.clone().add(r,"months"),i,s;return e-n<0?(i=t.clone().add(r-1,"months"),s=(e-n)/(n-i)):(i=t.clone().add(r+1,"months"),s=(e-n)/(i-n)),-(r+s)||0}je.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";je.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function Ode(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function kde(t){if(!this.isValid())return null;var e=t!==!0,r=e?this.clone().utc():this;return r.year()<0||r.year()>9999?dE(r,e?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):Gu(Date.prototype.toISOString)?e?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",dE(r,"Z")):dE(r,e?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function Dde(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var t="moment",e="",r,n,i,s;return this.isLocal()||(t=this.utcOffset()===0?"moment.utc":"moment.parseZone",e="Z"),r="["+t+'("]',n=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",i="-MM-DD[T]HH:mm:ss.SSS",s=e+'[")]',this.format(r+n+i+s)}function Pde(t){t||(t=this.isUtc()?je.defaultFormatUtc:je.defaultFormat);var e=dE(this,t);return this.localeData().postformat(e)}function Ide(t,e){return this.isValid()&&(Il(t)&&t.isValid()||vn(t).isValid())?Ll({to:this,from:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function Nde(t){return this.from(vn(),t)}function Hde(t,e){return this.isValid()&&(Il(t)&&t.isValid()||vn(t).isValid())?Ll({from:this,to:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function Fde(t){return this.to(vn(),t)}function BX(t){var e;return t===void 0?this._locale._abbr:(e=lh(t),e!=null&&(this._locale=e),this)}var VX=Ko("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(t){return t===void 0?this.localeData():this.locale(t)});function WX(){return this._locale}var qE=1e3,cp=60*qE,KE=60*cp,$X=(365*400+97)*24*KE;function hp(t,e){return(t%e+e)%e}function UX(t,e,r){return t<100&&t>=0?new Date(t+400,e,r)-$X:new Date(t,e,r).valueOf()}function jX(t,e,r){return t<100&&t>=0?Date.UTC(t+400,e,r)-$X:Date.UTC(t,e,r)}function Lde(t){var e,r;if(t=Xo(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(r=this._isUTC?jX:UX,t){case"year":e=r(this.year(),0,1);break;case"quarter":e=r(this.year(),this.month()-this.month()%3,1);break;case"month":e=r(this.year(),this.month(),1);break;case"week":e=r(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":e=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":e=r(this.year(),this.month(),this.date());break;case"hour":e=this._d.valueOf(),e-=hp(e+(this._isUTC?0:this.utcOffset()*cp),KE);break;case"minute":e=this._d.valueOf(),e-=hp(e,cp);break;case"second":e=this._d.valueOf(),e-=hp(e,qE);break}return this._d.setTime(e),je.updateOffset(this,!0),this}function Bde(t){var e,r;if(t=Xo(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(r=this._isUTC?jX:UX,t){case"year":e=r(this.year()+1,0,1)-1;break;case"quarter":e=r(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":e=r(this.year(),this.month()+1,1)-1;break;case"week":e=r(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":e=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":e=r(this.year(),this.month(),this.date()+1)-1;break;case"hour":e=this._d.valueOf(),e+=KE-hp(e+(this._isUTC?0:this.utcOffset()*cp),KE)-1;break;case"minute":e=this._d.valueOf(),e+=cp-hp(e,cp)-1;break;case"second":e=this._d.valueOf(),e+=qE-hp(e,qE)-1;break}return this._d.setTime(e),je.updateOffset(this,!0),this}function Vde(){return this._d.valueOf()-(this._offset||0)*6e4}function Wde(){return Math.floor(this.valueOf()/1e3)}function $de(){return new Date(this.valueOf())}function Ude(){var t=this;return[t.year(),t.month(),t.date(),t.hour(),t.minute(),t.second(),t.millisecond()]}function jde(){var t=this;return{years:t.year(),months:t.month(),date:t.date(),hours:t.hours(),minutes:t.minutes(),seconds:t.seconds(),milliseconds:t.milliseconds()}}function Yde(){return this.isValid()?this.toISOString():null}function zde(){return GH(this)}function Gde(){return wf({},Bt(this))}function qde(){return Bt(this).overflow}function Kde(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}St("N",0,0,"eraAbbr");St("NN",0,0,"eraAbbr");St("NNN",0,0,"eraAbbr");St("NNNN",0,0,"eraName");St("NNNNN",0,0,"eraNarrow");St("y",["y",1],"yo","eraYear");St("y",["yy",2],0,"eraYear");St("y",["yyy",3],0,"eraYear");St("y",["yyyy",4],0,"eraYear");st("N",hF);st("NN",hF);st("NNN",hF);st("NNNN",age);st("NNNNN",oge);Jr(["N","NN","NNN","NNNN","NNNNN"],function(t,e,r,n){var i=r._locale.erasParse(t,n,r._strict);i?Bt(r).era=i:Bt(r).invalidEra=t});st("y",tv);st("yy",tv);st("yyy",tv);st("yyyy",tv);st("yo",lge);Jr(["y","yy","yyy","yyyy"],_s);Jr(["yo"],function(t,e,r,n){var i;r._locale._eraYearOrdinalRegex&&(i=t.match(r._locale._eraYearOrdinalRegex)),r._locale.eraYearOrdinalParse?e[_s]=r._locale.eraYearOrdinalParse(t,i):e[_s]=parseInt(t,10)});function Xde(t,e){var r,n,i,s=this._eras||lh("en")._eras;for(r=0,n=s.length;r<n;++r){switch(typeof s[r].since){case"string":i=je(s[r].since).startOf("day"),s[r].since=i.valueOf();break}switch(typeof s[r].until){case"undefined":s[r].until=1/0;break;case"string":i=je(s[r].until).startOf("day").valueOf(),s[r].until=i.valueOf();break}}return s}function Qde(t,e,r){var n,i,s=this.eras(),a,o,u;for(t=t.toUpperCase(),n=0,i=s.length;n<i;++n)if(a=s[n].name.toUpperCase(),o=s[n].abbr.toUpperCase(),u=s[n].narrow.toUpperCase(),r)switch(e){case"N":case"NN":case"NNN":if(o===t)return s[n];break;case"NNNN":if(a===t)return s[n];break;case"NNNNN":if(u===t)return s[n];break}else if([a,o,u].indexOf(t)>=0)return s[n]}function Zde(t,e){var r=t.since<=t.until?1:-1;return e===void 0?je(t.since).year():je(t.since).year()+(e-t.offset)*r}function Jde(){var t,e,r,n=this.localeData().eras();for(t=0,e=n.length;t<e;++t)if(r=this.clone().startOf("day").valueOf(),n[t].since<=r&&r<=n[t].until||n[t].until<=r&&r<=n[t].since)return n[t].name;return""}function ege(){var t,e,r,n=this.localeData().eras();for(t=0,e=n.length;t<e;++t)if(r=this.clone().startOf("day").valueOf(),n[t].since<=r&&r<=n[t].until||n[t].until<=r&&r<=n[t].since)return n[t].narrow;return""}function tge(){var t,e,r,n=this.localeData().eras();for(t=0,e=n.length;t<e;++t)if(r=this.clone().startOf("day").valueOf(),n[t].since<=r&&r<=n[t].until||n[t].until<=r&&r<=n[t].since)return n[t].abbr;return""}function rge(){var t,e,r,n,i=this.localeData().eras();for(t=0,e=i.length;t<e;++t)if(r=i[t].since<=i[t].until?1:-1,n=this.clone().startOf("day").valueOf(),i[t].since<=n&&n<=i[t].until||i[t].until<=n&&n<=i[t].since)return(this.year()-je(i[t].since).year())*r+i[t].offset;return this.year()}function nge(t){return _r(this,"_erasNameRegex")||fF.call(this),t?this._erasNameRegex:this._erasRegex}function ige(t){return _r(this,"_erasAbbrRegex")||fF.call(this),t?this._erasAbbrRegex:this._erasRegex}function sge(t){return _r(this,"_erasNarrowRegex")||fF.call(this),t?this._erasNarrowRegex:this._erasRegex}function hF(t,e){return e.erasAbbrRegex(t)}function age(t,e){return e.erasNameRegex(t)}function oge(t,e){return e.erasNarrowRegex(t)}function lge(t,e){return e._eraYearOrdinalRegex||tv}function fF(){var t=[],e=[],r=[],n=[],i,s,a,o,u,c=this.eras();for(i=0,s=c.length;i<s;++i)a=Yc(c[i].name),o=Yc(c[i].abbr),u=Yc(c[i].narrow),e.push(a),t.push(o),r.push(u),n.push(a),n.push(o),n.push(u);this._erasRegex=new RegExp("^("+n.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+e.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+t.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+r.join("|")+")","i")}St(0,["gg",2],0,function(){return this.weekYear()%100});St(0,["GG",2],0,function(){return this.isoWeekYear()%100});function HR(t,e){St(0,[t,t.length],0,e)}HR("gggg","weekYear");HR("ggggg","weekYear");HR("GGGG","isoWeekYear");HR("GGGGG","isoWeekYear");st("G",kR);st("g",kR);st("GG",wn,eo);st("gg",wn,eo);st("GGGG",JH,ZH);st("gggg",JH,ZH);st("GGGGG",OR,MR);st("ggggg",OR,MR);wS(["gggg","ggggg","GGGG","GGGGG"],function(t,e,r,n){e[n.substr(0,2)]=sr(t)});wS(["gg","GG"],function(t,e,r,n){e[n]=je.parseTwoDigitYear(t)});function uge(t){return YX.call(this,t,this.week(),this.weekday()+this.localeData()._week.dow,this.localeData()._week.dow,this.localeData()._week.doy)}function cge(t){return YX.call(this,t,this.isoWeek(),this.isoWeekday(),1,4)}function hge(){return zc(this.year(),1,4)}function fge(){return zc(this.isoWeekYear(),1,4)}function dge(){var t=this.localeData()._week;return zc(this.year(),t.dow,t.doy)}function gge(){var t=this.localeData()._week;return zc(this.weekYear(),t.dow,t.doy)}function YX(t,e,r,n,i){var s;return t==null?w1(this,n,i).year:(s=zc(t,n,i),e>s&&(e=s),mge.call(this,t,e,r,n,i))}function mge(t,e,r,n,i){var s=EX(t,e,r,n,i),a=v1(s.year,0,s.dayOfYear);return this.year(a.getUTCFullYear()),this.month(a.getUTCMonth()),this.date(a.getUTCDate()),this}St("Q",0,"Qo","quarter");st("Q",dX);Jr("Q",function(t,e){e[Hc]=(sr(t)-1)*3});function pge(t){return t==null?Math.ceil((this.month()+1)/3):this.month((t-1)*3+this.month()%3)}St("D",["DD",2],"Do","date");st("D",wn,rv);st("DD",wn,eo);st("Do",function(t,e){return t?e._dayOfMonthOrdinalParse||e._ordinalParse:e._dayOfMonthOrdinalParseLenient});Jr(["D","DD"],xu);Jr("Do",function(t,e){e[xu]=sr(t.match(wn)[0])});var zX=nv("Date",!0);St("DDD",["DDDD",3],"DDDo","dayOfYear");st("DDD",AR);st("DDDD",gX);Jr(["DDD","DDDD"],function(t,e,r){r._dayOfYear=sr(t)});function vge(t){var e=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return t==null?e:this.add(t-e,"d")}St("m",["mm",2],0,"minute");st("m",wn,eF);st("mm",wn,eo);Jr(["m","mm"],El);var wge=nv("Minutes",!1);St("s",["ss",2],0,"second");st("s",wn,eF);st("ss",wn,eo);Jr(["s","ss"],Fc);var yge=nv("Seconds",!1);St("S",0,0,function(){return~~(this.millisecond()/100)});St(0,["SS",2],0,function(){return~~(this.millisecond()/10)});St(0,["SSS",3],0,"millisecond");St(0,["SSSS",4],0,function(){return this.millisecond()*10});St(0,["SSSSS",5],0,function(){return this.millisecond()*100});St(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3});St(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4});St(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5});St(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6});st("S",AR,dX);st("SS",AR,eo);st("SSS",AR,gX);var yf,GX;for(yf="SSSS";yf.length<=9;yf+="S")st(yf,tv);function Sge(t,e){e[mg]=sr(("0."+t)*1e3)}for(yf="S";yf.length<=9;yf+="S")Jr(yf,Sge);GX=nv("Milliseconds",!1);St("z",0,0,"zoneAbbr");St("zz",0,0,"zoneName");function bge(){return this._isUTC?"UTC":""}function Cge(){return this._isUTC?"Coordinated Universal Time":""}var Ge=pS.prototype;Ge.add=gde;Ge.calendar=bde;Ge.clone=Cde;Ge.diff=Ade;Ge.endOf=Bde;Ge.format=Pde;Ge.from=Ide;Ge.fromNow=Nde;Ge.to=Hde;Ge.toNow=Fde;Ge.get=Dhe;Ge.invalidAt=qde;Ge.isAfter=xde;Ge.isBefore=Ede;Ge.isBetween=_de;Ge.isSame=Rde;Ge.isSameOrAfter=Tde;Ge.isSameOrBefore=Mde;Ge.isValid=zde;Ge.lang=VX;Ge.locale=BX;Ge.localeData=WX;Ge.max=zfe;Ge.min=Yfe;Ge.parsingFlags=Gde;Ge.set=Phe;Ge.startOf=Lde;Ge.subtract=mde;Ge.toArray=Ude;Ge.toObject=jde;Ge.toDate=$de;Ge.toISOString=kde;Ge.inspect=Dde;typeof Symbol<"u"&&Symbol.for!=null&&(Ge[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"});Ge.toJSON=Yde;Ge.toString=Ode;Ge.unix=Wde;Ge.valueOf=Vde;Ge.creationData=Kde;Ge.eraName=Jde;Ge.eraNarrow=ege;Ge.eraAbbr=tge;Ge.eraYear=rge;Ge.year=vX;Ge.isLeapYear=khe;Ge.weekYear=uge;Ge.isoWeekYear=cge;Ge.quarter=Ge.quarters=pge;Ge.month=CX;Ge.daysInMonth=$he;Ge.week=Ge.weeks=Xhe;Ge.isoWeek=Ge.isoWeeks=Qhe;Ge.weeksInYear=dge;Ge.weeksInWeekYear=gge;Ge.isoWeeksInYear=hge;Ge.isoWeeksInISOWeekYear=fge;Ge.date=zX;Ge.day=Ge.days=cfe;Ge.weekday=hfe;Ge.isoWeekday=ffe;Ge.dayOfYear=vge;Ge.hour=Ge.hours=yfe;Ge.minute=Ge.minutes=wge;Ge.second=Ge.seconds=yge;Ge.millisecond=Ge.milliseconds=GX;Ge.utcOffset=tde;Ge.utc=nde;Ge.local=ide;Ge.parseZone=sde;Ge.hasAlignedHourOffset=ade;Ge.isDST=ode;Ge.isLocal=ude;Ge.isUtcOffset=cde;Ge.isUtc=NX;Ge.isUTC=NX;Ge.zoneAbbr=bge;Ge.zoneName=Cge;Ge.dates=Ko("dates accessor is deprecated. Use date instead.",zX);Ge.months=Ko("months accessor is deprecated. Use month instead",CX);Ge.years=Ko("years accessor is deprecated. Use year instead",vX);Ge.zone=Ko("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",rde);Ge.isDSTShifted=Ko("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",lde);function xge(t){return vn(t*1e3)}function Ege(){return vn.apply(null,arguments).parseZone()}function qX(t){return t}var Rr=KH.prototype;Rr.calendar=uhe;Rr.longDateFormat=dhe;Rr.invalidDate=mhe;Rr.ordinal=whe;Rr.preparse=qX;Rr.postformat=qX;Rr.relativeTime=She;Rr.pastFuture=bhe;Rr.set=ohe;Rr.eras=Xde;Rr.erasParse=Qde;Rr.erasConvertYear=Zde;Rr.erasAbbrRegex=ige;Rr.erasNameRegex=nge;Rr.erasNarrowRegex=sge;Rr.months=Lhe;Rr.monthsShort=Bhe;Rr.monthsParse=Whe;Rr.monthsRegex=jhe;Rr.monthsShortRegex=Uhe;Rr.week=zhe;Rr.firstDayOfYear=Khe;Rr.firstDayOfWeek=qhe;Rr.weekdays=sfe;Rr.weekdaysMin=ofe;Rr.weekdaysShort=afe;Rr.weekdaysParse=ufe;Rr.weekdaysRegex=dfe;Rr.weekdaysShortRegex=gfe;Rr.weekdaysMinRegex=mfe;Rr.isPM=vfe;Rr.meridiem=Sfe;function XE(t,e,r,n){var i=lh(),s=zu().set(n,e);return i[r](s,t)}function KX(t,e,r){if(th(t)&&(e=t,t=void 0),t=t||"",e!=null)return XE(t,e,r,"month");var n,i=[];for(n=0;n<12;n++)i[n]=XE(t,n,r,"month");return i}function dF(t,e,r,n){typeof t=="boolean"?(th(e)&&(r=e,e=void 0),e=e||""):(e=t,r=e,t=!1,th(e)&&(r=e,e=void 0),e=e||"");var i=lh(),s=t?i._week.dow:0,a,o=[];if(r!=null)return XE(e,(r+s)%7,n,"day");for(a=0;a<7;a++)o[a]=XE(e,(a+s)%7,n,"day");return o}function _ge(t,e){return KX(t,e,"months")}function Rge(t,e){return KX(t,e,"monthsShort")}function Tge(t,e,r){return dF(t,e,r,"weekdays")}function Mge(t,e,r){return dF(t,e,r,"weekdaysShort")}function Age(t,e,r){return dF(t,e,r,"weekdaysMin")}Of("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(t){var e=t%10,r=sr(t%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th";return t+r}});je.lang=Ko("moment.lang is deprecated. Use moment.locale instead.",Of);je.langData=Ko("moment.langData is deprecated. Use moment.localeData instead.",lh);var dc=Math.abs;function Oge(){var t=this._data;return this._milliseconds=dc(this._milliseconds),this._days=dc(this._days),this._months=dc(this._months),t.milliseconds=dc(t.milliseconds),t.seconds=dc(t.seconds),t.minutes=dc(t.minutes),t.hours=dc(t.hours),t.months=dc(t.months),t.years=dc(t.years),this}function XX(t,e,r,n){var i=Ll(e,r);return t._milliseconds+=n*i._milliseconds,t._days+=n*i._days,t._months+=n*i._months,t._bubble()}function kge(t,e){return XX(this,t,e,1)}function Dge(t,e){return XX(this,t,e,-1)}function bj(t){return t<0?Math.floor(t):Math.ceil(t)}function Pge(){var t=this._milliseconds,e=this._days,r=this._months,n=this._data,i,s,a,o,u;return t>=0&&e>=0&&r>=0||t<=0&&e<=0&&r<=0||(t+=bj(XI(r)+e)*864e5,e=0,r=0),n.milliseconds=t%1e3,i=No(t/1e3),n.seconds=i%60,s=No(i/60),n.minutes=s%60,a=No(s/60),n.hours=a%24,e+=No(a/24),u=No(QX(e)),r+=u,e-=bj(XI(u)),o=No(r/12),r%=12,n.days=e,n.months=r,n.years=o,this}function QX(t){return t*4800/146097}function XI(t){return t*146097/4800}function Ige(t){if(!this.isValid())return NaN;var e,r,n=this._milliseconds;if(t=Xo(t),t==="month"||t==="quarter"||t==="year")switch(e=this._days+n/864e5,r=this._months+QX(e),t){case"month":return r;case"quarter":return r/3;case"year":return r/12}else switch(e=this._days+Math.round(XI(this._months)),t){case"week":return e/7+n/6048e5;case"day":return e+n/864e5;case"hour":return e*24+n/36e5;case"minute":return e*1440+n/6e4;case"second":return e*86400+n/1e3;case"millisecond":return Math.floor(e*864e5)+n;default:throw new Error("Unknown unit "+t)}}function uh(t){return function(){return this.as(t)}}var ZX=uh("ms"),Nge=uh("s"),Hge=uh("m"),Fge=uh("h"),Lge=uh("d"),Bge=uh("w"),Vge=uh("M"),Wge=uh("Q"),$ge=uh("y"),Uge=ZX;function jge(){return Ll(this)}function Yge(t){return t=Xo(t),this.isValid()?this[t+"s"]():NaN}function im(t){return function(){return this.isValid()?this._data[t]:NaN}}var zge=im("milliseconds"),Gge=im("seconds"),qge=im("minutes"),Kge=im("hours"),Xge=im("days"),Qge=im("months"),Zge=im("years");function Jge(){return No(this.days()/7)}var kc=Math.round,ep={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function eme(t,e,r,n,i){return i.relativeTime(e||1,!!r,t,n)}function tme(t,e,r,n){var i=Ll(t).abs(),s=kc(i.as("s")),a=kc(i.as("m")),o=kc(i.as("h")),u=kc(i.as("d")),c=kc(i.as("M")),f=kc(i.as("w")),g=kc(i.as("y")),m=s<=r.ss&&["s",s]||s<r.s&&["ss",s]||a<=1&&["m"]||a<r.m&&["mm",a]||o<=1&&["h"]||o<r.h&&["hh",o]||u<=1&&["d"]||u<r.d&&["dd",u];return r.w!=null&&(m=m||f<=1&&["w"]||f<r.w&&["ww",f]),m=m||c<=1&&["M"]||c<r.M&&["MM",c]||g<=1&&["y"]||["yy",g],m[2]=e,m[3]=+t>0,m[4]=n,eme.apply(null,m)}function rme(t){return t===void 0?kc:typeof t=="function"?(kc=t,!0):!1}function nme(t,e){return ep[t]===void 0?!1:e===void 0?ep[t]:(ep[t]=e,t==="s"&&(ep.ss=e-1),!0)}function ime(t,e){if(!this.isValid())return this.localeData().invalidDate();var r=!1,n=ep,i,s;return typeof t=="object"&&(e=t,t=!1),typeof t=="boolean"&&(r=t),typeof e=="object"&&(n=Object.assign({},ep,e),e.s!=null&&e.ss==null&&(n.ss=e.s-1)),i=this.localeData(),s=tme(this,!r,n,i),r&&(s=i.pastFuture(+this,s)),i.postformat(s)}var HD=Math.abs;function Jm(t){return(t>0)-(t<0)||+t}function FR(){if(!this.isValid())return this.localeData().invalidDate();var t=HD(this._milliseconds)/1e3,e=HD(this._days),r=HD(this._months),n,i,s,a,o=this.asSeconds(),u,c,f,g;return o?(n=No(t/60),i=No(n/60),t%=60,n%=60,s=No(r/12),r%=12,a=t?t.toFixed(3).replace(/\.?0+$/,""):"",u=o<0?"-":"",c=Jm(this._months)!==Jm(o)?"-":"",f=Jm(this._days)!==Jm(o)?"-":"",g=Jm(this._milliseconds)!==Jm(o)?"-":"",u+"P"+(s?c+s+"Y":"")+(r?c+r+"M":"")+(e?f+e+"D":"")+(i||n||t?"T":"")+(i?g+i+"H":"")+(n?g+n+"M":"")+(t?g+a+"S":"")):"P0D"}var mr=NR.prototype;mr.isValid=Qfe;mr.abs=Oge;mr.add=kge;mr.subtract=Dge;mr.as=Ige;mr.asMilliseconds=ZX;mr.asSeconds=Nge;mr.asMinutes=Hge;mr.asHours=Fge;mr.asDays=Lge;mr.asWeeks=Bge;mr.asMonths=Vge;mr.asQuarters=Wge;mr.asYears=$ge;mr.valueOf=Uge;mr._bubble=Pge;mr.clone=jge;mr.get=Yge;mr.milliseconds=zge;mr.seconds=Gge;mr.minutes=qge;mr.hours=Kge;mr.days=Xge;mr.weeks=Jge;mr.months=Qge;mr.years=Zge;mr.humanize=ime;mr.toISOString=FR;mr.toString=FR;mr.toJSON=FR;mr.locale=BX;mr.localeData=WX;mr.toIsoString=Ko("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",FR);mr.lang=VX;St("X",0,0,"unix");St("x",0,0,"valueOf");st("x",kR);st("X",_he);Jr("X",function(t,e,r){r._d=new Date(parseFloat(t)*1e3)});Jr("x",function(t,e,r){r._d=new Date(sr(t))});//! moment.js
je.version="2.30.1";she(vn);je.fn=Ge;je.min=Gfe;je.max=qfe;je.now=Kfe;je.utc=zu;je.unix=xge;je.months=_ge;je.isDate=mS;je.locale=Of;je.invalid=TR;je.duration=Ll;je.isMoment=Il;je.weekdays=Tge;je.parseZone=Ege;je.localeData=lh;je.isDuration=gE;je.monthsShort=Rge;je.weekdaysMin=Age;je.defineLocale=sF;je.updateLocale=Efe;je.locales=_fe;je.weekdaysShort=Mge;je.normalizeUnits=Xo;je.relativeTimeRounding=rme;je.relativeTimeThreshold=nme;je.calendarFormat=Sde;je.prototype=Ge;je.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};function JX(t){const e=t.length;let r=0;for(;r<e;)t[r]=[t[r]],r+=1}function QI(t,e){const r=e.length;let n=0;for(;n<r;)t.push(e[n]),n+=1}function Py(t){const e=[];if(!t||t.length===0||!t[0]||t[0].length===0)return e;const r=t.length,n=t[0].length;for(let i=0;i<r;i++)for(let s=0;s<n;s++)e[s]||(e[s]=[]),e[s][i]=t[i][s];return e}function Ri(t,e,r,n){let i=-1,s=t,a=r;Array.isArray(t)||(s=Array.from(t));const o=s.length;for(n&&o&&(i+=1,a=s[i]),i+=1;i<o;)a=e(a,s[i],i,s),i+=1;return a}function Ff(t,e){let r=0,n=t;Array.isArray(t)||(n=Array.from(t));const i=n.length,s=[];let a=-1;for(;r<i;){const o=n[r];e(o,r,n)&&(a+=1,s[a]=o),r+=1}return s}function nr(t,e){let r=0,n=t;Array.isArray(t)||(n=Array.from(t));const i=n.length,s=[];let a=-1;for(;r<i;){const o=n[r];a+=1,s[a]=e(o,r,n),r+=1}return s}function he(t,e){let r=0,n=t;Array.isArray(t)||(n=Array.from(t));const i=n.length;for(;r<i&&e(n[r],r,n)!==!1;)r+=1;return t}function eQ(t){return Ri(t,(e,r)=>e+r,0)}function sme(t){return Ri(t,(e,r)=>e>r?e:r,Array.isArray(t)?t[0]:void 0)}function ame(t){return Ri(t,(e,r)=>e<r?e:r,Array.isArray(t)?t[0]:void 0)}function ome(t){return t.length?eQ(t)/t.length:0}function tQ(t){return Ri(t,(e,r)=>e.concat(Array.isArray(r)?tQ(r):r),[])}function rQ(t){const e=[];return he(t,r=>{e.indexOf(r)===-1&&e.push(r)}),e}function ZI(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];const[n,...i]=[...e];let s=n;return he(i,a=>{s=s.filter(o=>!a.includes(o))}),s}function lme(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];const[n,...i]=[...e];let s=n;return he(i,a=>{s=s.filter(o=>a.includes(o))}),s}function ume(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];const[n,...i]=[...e],s=new Set(n);return he(i,a=>{he(a,o=>{s.has(o)||s.add(o)})}),Array.from(s)}function JI(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";return t.split(e)}const cme=Object.freeze(Object.defineProperty({__proto__:null,arrayAvg:ome,arrayEach:he,arrayFilter:Ff,arrayFlatten:tQ,arrayMap:nr,arrayMax:sme,arrayMin:ame,arrayReduce:Ri,arraySum:eQ,arrayUnique:rQ,extendArray:QI,getDifferenceOfArrays:ZI,getIntersectionOfArrays:lme,getUnionOfArrays:ume,pivot:Py,stringToArray:JI,to2dArray:JX},Symbol.toStringTag,{value:"Module"}));function Dr(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return Ri(t,(s,a,o)=>{const u=a.replace(/\r?\n\s*/g,""),c=r[o]?r[o]:"";return s+u+c},"").trim()}function cn(t){let e;switch(typeof t){case"string":case"number":e=`${t}`;break;case"object":e=t===null?"":t.toString();break;case"undefined":e="";break;default:e=t.toString();break}return e}function it(t){return typeof t<"u"}function gn(t){return typeof t>"u"}function In(t){return t===null||t===""||gn(t)}function nQ(t){return Object.prototype.toString.call(t)==="[object RegExp]"}const yy="length",Iy=t=>parseInt(t,16),Cj=t=>parseInt(t,10),QE=(t,e,r)=>t.substr(e,r),Ny=t=>t.codePointAt(0)-65,eN=t=>`${t}`.replace(/\-/g,""),hme=t=>Iy(QE(eN(t),Iy("12"),Ny("F")))/(Iy(QE(eN(t),Ny("B"),~~![][yy]))||9),fme=()=>typeof location<"u"&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host);let xj=!1;const Ej={invalid:()=>Dr`
    The license key for Handsontable is invalid.\x20
    If you need any help, contact us at support@handsontable.com.`,expired:t=>{let{keyValidityDate:e,hotVersion:r}=t;return Dr`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${r}. Renew your license key at handsontable.com or downgrade to a version released prior\x20
    to ${e}. If you need any help, contact us at sales@handsontable.com.`},missing:()=>Dr`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\x20
    us at support@handsontable.com.`,non_commercial:()=>""},_j={invalid:()=>Dr`
    The license key for Handsontable is invalid.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,expired:t=>{let{keyValidityDate:e,hotVersion:r}=t;return Dr`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${r}. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\x20
    license key or downgrade to a version released prior to ${e}. If you need any\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`},missing:()=>Dr`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,non_commercial:()=>""};function iQ(t,e){const r=!In(t),n=typeof t=="string"&&t.toLowerCase()==="non-commercial-and-evaluation",i="16.0.1";let s,a="invalid",o="invalid";t=eN(t||"");const u=dme(t);if(r||n||u)if(u){const c=je("10/07/2025","DD/MM/YYYY"),f=Math.floor(c.toDate().getTime()/864e5),g=hme(t);s=je((g+1)*864e5,"x").format("MMMM DD, YYYY"),f>g?(a="expired",o="expired"):(a="valid",o="valid")}else n?(a="non_commercial",o="valid"):(a="invalid",o="invalid");else a="missing",o="missing";if(fme()&&(a="valid",o="valid"),!xj&&a!=="valid"&&(Ej[a]({keyValidityDate:s,hotVersion:i})&&console[a==="non_commercial"?"info":"warn"](Ej[a]({keyValidityDate:s,hotVersion:i})),xj=!0),o!=="valid"&&e&&_j[o]({keyValidityDate:s,hotVersion:i})){const f=document.createElement("div");f.className="handsontable hot-display-license-info",f.innerHTML=_j[o]({keyValidityDate:s,hotVersion:i}),e.appendChild(f)}}function dme(t){let e=[][yy],r=e;if(t[yy]!==Ny("Z"))return!1;for(let n="",i="B<H4P+".split(""),s=Ny(i.shift());s;s=Ny(i.shift()||"A"))--s<""[yy]?r=r|(Cj(`${Cj(Iy(n)+(Iy(QE(t,Math.abs(s),2))+[]).padStart(2,"0"))}`)%97||2)>>1:n=QE(t,s,s?i[yy]===1?9:8:6);return r===e}const gme=Object.freeze(Object.defineProperty({__proto__:null,_injectProductInfo:iQ,isDefined:it,isEmpty:In,isRegExp:nQ,isUndefined:gn,stringify:cn},Symbol.toStringTag,{value:"Module"}));function Ms(t){return t[0].toUpperCase()+t.substr(1)}function mme(){const t=[];for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];let i=r.length;for(;i;){i-=1;const s=cn(r[i]).toLowerCase();t.indexOf(s)===-1&&t.push(s)}return t.length===1}function gF(){function t(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return t()+t()+t()+t()}function mF(t){return/^([0-9][0-9]?%$)|(^100%$)/.test(t)}function pF(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return`${t}`.replace(/(?:\\)?\[([^[\]]+)]/g,(r,n)=>r.charAt(0)==="\\"?r.substr(1,r.length-1):e[n]===void 0?"":e[n])}function tN(t){return LR(`${t}`,{ALLOWED_TAGS:[]})}function LR(t,e){return ihe.sanitize(t,e)}const pme=Object.freeze(Object.defineProperty({__proto__:null,equalsIgnoreCase:mme,isPercentValue:mF,randomString:gF,sanitize:LR,stripTags:tN,substitute:pF,toUpperCaseFirst:Ms},Symbol.toStringTag,{value:"Module"})),Zf=t=>["tabindex",t],vme=()=>["role","treegrid"],Lc=()=>["role","presentation"],wme=()=>["role","gridcell"],yme=()=>["role","gridcell button"],Sme=()=>["role","rowheader"],sQ=()=>["role","rowgroup"],bme=()=>["role","columnheader"],aQ=()=>["role","row"],Cme=()=>["role","menu"],xme=()=>["role","menuitem"],Eme=()=>["role","menuitemcheckbox"],_me=()=>["role","combobox"],oQ=()=>["role","listbox"],Rme=()=>["role","option"],Tme=()=>["role","checkbox"],Mme=()=>["scope","col"],Ame=()=>["scope","row"],Ome=()=>["type","text"],Rp=t=>["aria-label",t],sm=()=>["aria-hidden","true"],kme=()=>["aria-disabled","true"],Dme=()=>["aria-multiselectable","true"],lQ=t=>["aria-haspopup",t],uQ=t=>["aria-rowcount",t],BR=t=>["aria-colcount",t],cQ=t=>["aria-rowindex",t],vF=t=>["aria-colindex",t],Vo=t=>["aria-expanded",t],Pme=t=>["aria-sort",t],Rj=()=>["aria-readonly","true"],Tj=()=>["aria-invalid","true"],hQ=t=>["aria-checked",t],wF=()=>["aria-selected","true"],Ime=()=>["aria-autocomplete","list"],Nme=t=>["aria-controls",t],Hme=t=>["aria-activedescendant",t],Fme=t=>["aria-live",t],Lme=t=>["aria-relevant",t],Bme=t=>["aria-setsize",t],Vme=t=>["aria-posinset",t];var Mj={},FD,Aj;function Wme(){if(Aj)return FD;Aj=1;var t=ui(),e=UK(),r=Ei(),n=Jg(),i=RR(),s=t([].push);return FD=function(a){if(r(a))return a;if(e(a)){for(var o=a.length,u=[],c=0;c<o;c++){var f=a[c];typeof f=="string"?s(u,f):(typeof f=="number"||n(f)==="Number"||n(f)==="String")&&s(u,i(f))}var g=u.length,m=!0;return function(v,w){if(m)return m=!1,w;if(e(this))return w;for(var y=0;y<g;y++)if(u[y]===v)return w}}},FD}var Oj;function $me(){if(Oj)return Mj;Oj=1;var t=nn(),e=Xp(),r=fS(),n=xi(),i=ui(),s=Ci(),a=Ei(),o=DH(),u=YH(),c=Wme(),f=kH(),g=String,m=e("JSON","stringify"),v=i(/./.exec),w=i("".charAt),y=i("".charCodeAt),b=i("".replace),x=i(1.1.toString),_=/[\uD800-\uDFFF]/g,T=/^[\uD800-\uDBFF]$/,D=/^[\uDC00-\uDFFF]$/,P=!f||s(function(){var L=e("Symbol")("stringify detection");return m([L])!=="[null]"||m({a:L})!=="{}"||m(Object(L))!=="{}"}),O=s(function(){return m("\uDF06\uD834")!=='"\\udf06\\ud834"'||m("\uDEAD")!=='"\\udead"'}),A=function(L,H){var J=u(arguments),G=c(H);if(!(!a(G)&&(L===void 0||o(L))))return J[1]=function(ve,be){if(a(G)&&(be=n(G,this,g(ve),be)),!o(be))return be},r(m,null,J)},W=function(L,H,J){var G=w(J,H-1),ve=w(J,H+1);return v(T,L)&&!v(D,ve)||v(D,L)&&!v(T,G)?"\\u"+x(y(L,0),16):L};return m&&t({target:"JSON",stat:!0,arity:3,forced:P||O},{stringify:function(H,J,G){var ve=u(arguments),be=r(P?A:m,null,ve);return O&&typeof be=="string"?b(be,_,W):be}}),Mj}$me();function Tp(t){let e;return Array.isArray(t)?e=t.length?new Array(t.length).fill(null):[]:(e={},Wt(t,(r,n)=>{n!=="__children"&&(r&&typeof r=="object"&&!Array.isArray(r)?e[n]=Tp(r):Array.isArray(r)?r.length&&typeof r[0]=="object"&&!Array.isArray(r[0])?e[n]=[Tp(r[0])]:e[n]=[]:e[n]=null)})),e}function fQ(t,e){return e.prototype.constructor=e,t.prototype=new e,t.prototype.constructor=t,t}function oi(t,e,r){const n=Array.isArray(r);return Wt(e,(i,s)=>{(n===!1||r.includes(s))&&(t[s]=i)}),t}function yS(t,e){Wt(e,(r,n)=>{e[n]&&typeof e[n]=="object"?(t[n]||(Array.isArray(e[n])?t[n]=[]:Object.prototype.toString.call(e[n])==="[object Date]"?t[n]=e[n]:t[n]={}),yS(t[n],e[n])):t[n]=e[n]})}function As(t){return typeof t=="object"?JSON.parse(JSON.stringify(t)):t}function Nl(t){const e={};return Wt(t,(r,n)=>{e[n]=r}),e}function Lr(t){t.MIXINS||(t.MIXINS=[]);for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return he(r,i=>{t.MIXINS.push(i.MIXIN_NAME),Wt(i,(s,a)=>{if(t.prototype[a]!==void 0)throw new Error(`Mixin conflict. Property '${a}' already exist and cannot be overwritten.`);if(typeof s=="function")t.prototype[a]=s;else{const o=function(f,g){const m=`_${f}`,v=w=>{let y=w;return(Array.isArray(y)||Vt(y))&&(y=As(y)),y};return function(){return this[m]===void 0&&(this[m]=v(g)),this[m]}},u=function(f){const g=`_${f}`;return function(m){this[g]=m}};Object.defineProperty(t.prototype,a,{get:o(a,s),set:u(a),configurable:!0})}})}),t}function VR(t,e){return JSON.stringify(t)===JSON.stringify(e)}function Vt(t){return Object.prototype.toString.call(t)==="[object Object]"}function qu(t,e,r,n){n.value=r,n.writable=n.writable!==!1,n.enumerable=n.enumerable!==!1,n.configurable=n.configurable!==!1,Object.defineProperty(t,e,n)}function Wt(t,e){for(const r in t)if((!t.hasOwnProperty||t.hasOwnProperty&&Object.prototype.hasOwnProperty.call(t,r))&&e(t[r],r,t)===!1)break;return t}function dQ(t,e){const r=e.split(".");let n=t;return Wt(r,i=>{if(n=n[i],n===void 0)return n=void 0,!1}),n}function pE(t,e,r){if(typeof e!="string")return;const n=e.split(".");let i=t;n.forEach((s,a)=>{s==="__proto__"||s==="constructor"||s==="prototype"||(a!==n.length-1?(ni(i,s)||(i[s]={}),i=i[s]):i[s]=r)})}function WR(t){if(!Vt(t))return 0;const e=function(r){let n=0;return Vt(r)?Wt(r,(i,s)=>{s!=="__children"&&(n+=e(i))}):n+=1,n};return e(t)}function wa(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"value";const r=`_${e}`,n={_touched:!1,[r]:t,isTouched(){return this._touched}};return Object.defineProperty(n,e,{get(){return this[r]},set(i){this._touched=!0,this[r]=i},enumerable:!0,configurable:!0}),n}function ni(t,e){return Object.prototype.hasOwnProperty.call(t,e)}const Ume=Object.freeze(Object.defineProperty({__proto__:null,clone:Nl,createObjectPropListener:wa,deepClone:As,deepExtend:yS,deepObjectSize:WR,defineGetter:qu,duckSchema:Tp,extend:oi,getProperty:dQ,hasOwnProperty:ni,inherit:fQ,isObject:Vt,isObjectEqual:VR,mixin:Lr,objectEach:Wt,setProperty:pE},Symbol.toStringTag,{value:"Module"}));function S1(t){return window.requestAnimationFrame(t)}function b1(t){window.cancelAnimationFrame(t)}function yF(){return"ontouchstart"in window}function gQ(){return typeof window<"u"}let e0;function mQ(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return e0||(typeof Intl=="object"?e0=new Intl.Collator(t,e).compare:typeof String.prototype.localeCompare=="function"?e0=(r,n)=>`${r}`.localeCompare(n):e0=(r,n)=>r===n?0:r>n?-1:1,e0)}const jme=Object.freeze(Object.defineProperty({__proto__:null,cancelAnimationFrame:b1,getComparisonFunction:mQ,isCSR:gQ,isTouchSupported:yF,requestAnimationFrame:S1},Symbol.toStringTag,{value:"Module"})),Ro=t=>{const e={value:!1};return e.test=(r,n)=>{e.value=t(r,n)},e},ch={chrome:Ro((t,e)=>/Chrome/.test(t)&&/Google/.test(e)),chromeWebKit:Ro(t=>/CriOS/.test(t)),edge:Ro(t=>/Edge/.test(t)),edgeWebKit:Ro(t=>/EdgiOS/.test(t)),firefox:Ro(t=>/Firefox/.test(t)),firefoxWebKit:Ro(t=>/FxiOS/.test(t)),mobile:Ro(t=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(t)),safari:Ro((t,e)=>/Safari/.test(t)&&/Apple Computer/.test(e))},iv={mac:Ro(t=>/^Mac/.test(t)),win:Ro(t=>/^Win/.test(t)),linux:Ro(t=>/^Linux/.test(t)),ios:Ro(t=>/iPhone|iPad|iPod/i.test(t))};function pQ(){let{userAgent:t=navigator.userAgent,vendor:e=navigator.vendor}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Wt(ch,r=>{let{test:n}=r;return void n(t,e)})}function vQ(){let{platform:t=navigator.platform}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Wt(iv,e=>{let{test:r}=e;return void r(t)})}gQ()&&(pQ(),vQ());function SF(){return ch.chrome.value}function wQ(){return ch.chromeWebKit.value}function vE(){return ch.firefox.value}function yQ(){return ch.firefoxWebKit.value}function Mp(){return ch.safari.value}function SQ(){return ch.edge.value}function Yme(){return ch.edgeWebKit.value}function _l(){return ch.mobile.value}function bF(){return iv.ios.value}function CF(){let{maxTouchPoints:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:navigator;return t>2&&iv.mac.value}function ZE(){return iv.win.value}function JE(){return iv.mac.value}function zme(){return iv.linux.value}const Gme=Object.freeze(Object.defineProperty({__proto__:null,isChrome:SF,isChromeWebKit:wQ,isEdge:SQ,isEdgeWebKit:Yme,isFirefox:vE,isFirefoxWebKit:yQ,isIOS:bF,isIpadOS:CF,isLinuxOS:zme,isMacOS:JE,isMobileBrowser:_l,isSafari:Mp,isWindowsOS:ZE,setBrowserMeta:pQ,setPlatformMeta:vQ},Symbol.toStringTag,{value:"Module"}));function bQ(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=-1,n=null,i=t;for(;i!==null;){if(r===e){n=i;break}i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:(r+=1,i=i.parentNode)}return n}function Hy(t,e){const r=t.closest(".handsontable");return!!r&&(r.parentNode===e||r===e)}function CQ(t){return Object.getPrototypeOf(t.parent)&&t.frameElement}function Pg(t){return CQ(t)&&t.parent}function qme(t){return!!Object.getPrototypeOf(t.parent)}function Lf(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0;const{ELEMENT_NODE:n,DOCUMENT_FRAGMENT_NODE:i}=Node;let s=t;for(;s!=null&&s!==r;){const{nodeType:a,nodeName:o}=s;if(a===n&&(e.includes(o)||e.includes(s)))return s;const{host:u}=s;u&&a===i?s=u:s=s.parentNode}return null}function Sy(t,e,r){const n=[];let i=t;for(;i&&(i=Lf(i,e,r),!(!i||r&&!r.contains(i)));)n.push(i),i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:i=i.parentNode;const s=n.length;return s?n[s-1]:null}function xQ(t,e){const r={element:void 0,classNames:[]};let n=t;for(;n!==null&&n!==t.ownerDocument.documentElement&&!r.element;){if(typeof e=="string"&&n.classList.contains(e))r.element=n,r.classNames.push(e);else if(e instanceof RegExp){const i=Array.from(n.classList).filter(s=>e.test(s));i.length&&(r.element=n,r.classNames.push(...i))}n=n.parentElement}return r}function kf(t,e){let r=t.parentNode,n=[];for(typeof e=="string"?t.defaultView?n=Array.prototype.slice.call(t.querySelectorAll(e),0):n=Array.prototype.slice.call(t.ownerDocument.querySelectorAll(e),0):n.push(e);r!==null;){if(n.indexOf(r)>-1)return!0;r=r.parentNode}return!1}function EQ(t){let e=0,r=t;if(r.previousSibling)for(;r=r.previousSibling;)e+=1;return e}function af(t,e,r){const n=r.parentElement.querySelector(`.ht_clone_${t}`);return n?n.contains(e):null}function _Q(t){return!t||!t.length?[]:t.filter(e=>!!e)}function RQ(t,e){if(!t||!t.length)return{regexFree:[],regexes:[]};const r=[],n=[];return n.push(...t.filter(i=>{const s=i instanceof RegExp;return s&&e&&r.push(i),!s})),{regexFree:n,regexes:r}}function Ct(t,e){return t.classList===void 0||typeof e!="string"||e===""?!1:t.classList.contains(e)}function Ve(t,e){typeof e=="string"&&(e=e.split(" ")),e=_Q(e),e.length>0&&t.classList.add(...e)}function wt(t,e){typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);let{regexFree:r,regexes:n}=RQ(e,!0);r=_Q(r),r.length>0&&t.classList.remove(...r),n.forEach(i=>{t.classList.forEach(s=>{i.test(s)&&t.classList.remove(s)})})}function bt(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0;Array.isArray(e)||(e=[[e,r]]),e.forEach(n=>{Array.isArray(n)&&n[0]!==""&&t.setAttribute(...n)})}function am(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);const{regexFree:r,regexes:n}=RQ(e,!0);r.forEach(i=>{i!==""&&t.removeAttribute(i)}),n.forEach(i=>{t.getAttributeNames().forEach(s=>{i.test(s)&&t.removeAttribute(s)})})}function xF(t){if(t.nodeType===3)t.parentNode.removeChild(t);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(t.nodeName)>-1){const e=t.childNodes;for(let r=e.length-1;r>=0;r--)xF(e[r])}}function Bu(t){let e;for(;e=t.lastChild;)t.removeChild(e)}const TQ=/(<(.*)>|&(.*);)/;function om(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;TQ.test(e)?t.innerHTML=r?LR(e):e:Bf(t,e)}function Bf(t,e){const r=t.firstChild;r&&r.nodeType===3&&r.nextSibling===null?r.textContent=e:(Bu(t),t.appendChild(t.ownerDocument.createTextNode(e)))}function Ig(t){const e=t.ownerDocument.documentElement,r=t.ownerDocument.defaultView;let n=t;for(;n!==e;){if(n===null)return!1;if(n.nodeType===Node.DOCUMENT_FRAGMENT_NODE)if(n.host){if(n.host.impl)return Ig(n.host.impl);if(n.host)return Ig(n.host);throw new Error("Lost in Web Components world")}else return!1;else if(r.getComputedStyle(n).display==="none")return!1;n=n.parentNode}return!0}function MQ(t){const r=t.ownerDocument.defaultView;let n=t;for(;n.parentNode;){if(n.style.height==="0px"||n.style.height==="0")return r.getComputedStyle(n).overflow==="hidden";n=n.parentNode}return!1}function ns(t){const e=t.ownerDocument,r=e.defaultView,n=e.documentElement;let i=t,s,a,o;for(s=i.offsetLeft,a=i.offsetTop,o=i;(i=i.offsetParent)&&!(i===e.body||!("offsetLeft"in i));)s+=i.offsetLeft,a+=i.offsetTop,o=i;return o&&o.style.position==="fixed"&&(s+=r.pageXOffset||n.scrollLeft,a+=r.pageYOffset||n.scrollTop),{left:s,top:a}}function EF(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollY}function $R(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollX}function UR(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?EF(e):t.scrollTop}function _F(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?$R(e):t.scrollLeft}function C1(t){let e=t.ownerDocument,r=e?e.defaultView:void 0;e||(e=t.document?t.document:t,r=e.defaultView);const n=["auto","scroll"];let i=t.parentNode;for(;i&&i.style&&e.body!==i;){let{overflow:s,overflowX:a,overflowY:o}=i.style;if([s,a,o].includes("scroll"))return i;if({overflow:s,overflowX:a,overflowY:o}=r.getComputedStyle(i),n.includes(s)||n.includes(a)||n.includes(o)||i.clientHeight<=i.scrollHeight+1&&(n.includes(o)||n.includes(s))||i.clientWidth<=i.scrollWidth+1&&(n.includes(a)||n.includes(s)))return i;i=i.parentNode}return r}function AQ(t){return t.scrollHeight-t.clientHeight}function OQ(t){return t.scrollWidth-t.clientWidth}function Ap(t){const e=t.ownerDocument,r=e.defaultView;let n=t.parentNode;for(;n&&n.style&&e.body!==n;){if(n.style.overflow!=="visible"&&n.style.overflow!=="")return n;const i=r.getComputedStyle(n),s=["scroll","hidden","auto"],a=i.getPropertyValue("overflow"),o=i.getPropertyValue("overflow-y"),u=i.getPropertyValue("overflow-x");if(s.includes(a)||s.includes(o)||s.includes(u))return n;n=n.parentNode}return r}function x1(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:window;if(t){if(t===r)return e==="width"?`${r.innerWidth}px`:e==="height"?`${r.innerHeight}px`:void 0}else return;const n=t.style[e];if(n!==""&&n!==void 0)return n;const i=r.getComputedStyle(t);if(i[e]!==""&&i[e]!==void 0)return i[e]}function Kme(t,e){const{selectorText:r}=e;let n=!1;return e.type===CSSRule.STYLE_RULE&&r&&(t.msMatchesSelector?n=t.msMatchesSelector(r):t.matches&&(n=t.matches(r))),n}function Un(t){return t.offsetWidth}function ai(t){return t.offsetHeight}function fp(t){return t.clientHeight||t.innerHeight}function RF(t){return t.clientWidth||t.innerWidth}function Xme(t,e,r){t.addEventListener(e,r,!1)}function Qme(t,e,r){t.removeEventListener(e,r,!1)}function TF(t){return t.selectionStart?t.selectionStart:0}function kQ(t){return t.selectionEnd?t.selectionEnd:0}function Zme(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;const e=t.document;let r="";return t.getSelection?r=t.getSelection().toString():e.selection&&e.selection.type!=="Control"&&(r=e.selection.createRange().text),r}function rN(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;t.getSelection&&(t.getSelection().empty?t.getSelection().empty():t.getSelection().removeAllRanges&&t.getSelection().removeAllRanges())}function SS(t,e,r){if(r===void 0&&(r=e),t.setSelectionRange){t.focus();try{t.setSelectionRange(e,r)}catch{const i=t.parentNode,s=i.style.display;i.style.display="block",t.setSelectionRange(e,r),i.style.display=s}}}let LD;function MF(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return ZE()?Number.isInteger(t.defaultView.devicePixelRatio||1)?0:2:0}function Jme(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;const e=t.createElement("div");e.style.height="200px",e.style.width="100%";const r=t.createElement("div");Mp()&&!_l()&&r.classList.add("htScrollbarSafariTest"),r.style.boxSizing="content-box",r.style.height="150px",r.style.left="0px",r.style.overflow="hidden",r.style.position="absolute",r.style.top="0px",r.style.width="200px",r.style.visibility="hidden",r.appendChild(e),(t.body||t.documentElement).appendChild(r);const n=e.offsetWidth;r.style.overflow="scroll";let i=e.offsetWidth;return n===i&&(i=r.clientWidth),(t.body||t.documentElement).removeChild(r),n-i+MF(t)}function Ni(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return LD===void 0&&(LD=Jme(t)),LD}function AF(t){return t instanceof Window?t.document.body.scrollHeight>t.innerHeight:t.offsetWidth!==t.clientWidth}function OF(t){return t instanceof Window?t.document.body.scrollWidth>t.innerWidth:t.offsetHeight!==t.clientHeight}function jR(t,e,r){t.style.transform=`translate3d(${e},${r},0)`}function e0e(t){let e;return t.style.transform&&(e=t.style.transform)!==""?["transform",e]:-1}function bS(t){t.style.transform&&t.style.transform!==""&&(t.style.transform="")}function Fy(t){return t&&(["INPUT","SELECT","TEXTAREA"].indexOf(t.nodeName)>-1||t.contentEditable==="true")}function YR(t){return Fy(t)&&t.hasAttribute("data-hot-input")===!1}function t0e(t){const e=t.ownerDocument.activeElement;YR(e)||t.select()}function kF(t){return!t.parentNode}function DQ(t,e){new IntersectionObserver((n,i)=>{n.forEach(s=>{s.isIntersecting&&t.offsetParent!==null&&(e(),i.unobserve(t))})},{root:t.ownerDocument.body}).observe(t)}function DF(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const n=t.ownerDocument,i=n.createRange(),s=n.defaultView.getSelection();bt(t,"contenteditable",!0),r&&bt(t,...sm()),e&&Ve(t,"invisibleSelection"),i.selectNodeContents(t),s.removeAllRanges(),s.addRange(i)}function PF(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const r=t.ownerDocument.defaultView.getSelection();t.hasAttribute("aria-hidden")&&t.removeAttribute("aria-hidden"),r.removeAllRanges(),e&&wt(t,"invisibleSelection"),t.removeAttribute("contenteditable")}function PQ(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;DF(t,r),e(),PF(t,r)}function Iu(t){var e;const r=t==null||(e=t.ownerDocument)===null||e===void 0?void 0:e.defaultView.Element;return!!(r&&r!==null&&t instanceof r)}const r0e=Object.freeze(Object.defineProperty({__proto__:null,HTML_CHARACTERS:TQ,addClass:Ve,addEvent:Xme,clearTextSelection:rN,closest:Lf,closestDown:Sy,empty:Bu,fastInnerHTML:om,fastInnerText:Bf,findFirstParentWithClass:xQ,getCaretPosition:TF,getCssTransform:e0e,getFractionalScalingCompensation:MF,getFrameElement:CQ,getMaximumScrollLeft:OQ,getMaximumScrollTop:AQ,getParent:bQ,getParentWindow:Pg,getScrollLeft:_F,getScrollTop:UR,getScrollableElement:C1,getScrollbarWidth:Ni,getSelectionEndPosition:kQ,getSelectionText:Zme,getStyle:x1,getTrimmingContainer:Ap,getWindowScrollLeft:$R,getWindowScrollTop:EF,hasAccessToParentWindow:qme,hasClass:Ct,hasHorizontalScrollbar:OF,hasVerticalScrollbar:AF,hasZeroHeight:MQ,index:EQ,innerHeight:fp,innerWidth:RF,isChildOf:kf,isDetached:kF,isHTMLElement:Iu,isInput:Fy,isInternalElement:Hy,isOutsideInput:YR,isVisible:Ig,makeElementContentEditableAndSelectItsContent:DF,matchesCSSRules:Kme,observeVisibilityChangeOnce:DQ,offset:ns,outerHeight:ai,outerWidth:Un,overlayContainsElement:af,removeAttribute:am,removeClass:wt,removeContentEditableFromElementAndDeselect:PF,removeEvent:Qme,removeTextNodes:xF,resetCssTransform:bS,runWithSelectedContendEditableElement:PQ,selectElementIfAllowed:t0e,setAttribute:bt,setCaretPosition:SS,setOverlayPosition:jR},Symbol.toStringTag,{value:"Module"}));function kr(t){return typeof t=="function"}function IQ(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,r=0;const n={lastCallThrottled:!0};let i=null;function s(){for(var a=arguments.length,o=new Array(a),u=0;u<a;u++)o[u]=arguments[u];const c=Date.now();let f=!1;n.lastCallThrottled=!0,r||(r=c,f=!0);const g=e-(c-r);return f?(n.lastCallThrottled=!1,t.apply(this,o)):(i&&clearTimeout(i),i=setTimeout(()=>{n.lastCallThrottled=!1,t.apply(this,o),r=0,i=void 0},g)),n}return s}function n0e(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:10;const n=IQ(t,e);let i=r;function s(){i=r}function a(){for(var o=arguments.length,u=new Array(o),c=0;c<o;c++)u[c]=arguments[c];return i?(i-=1,t.apply(this,u)):n.apply(this,u)}return a.clearHits=s,a}function CS(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,r=null,n;function i(){for(var s=arguments.length,a=new Array(s),o=0;o<s;o++)a[o]=arguments[o];return r&&clearTimeout(r),r=setTimeout(()=>{n=t.apply(this,a)},e),n}return i}function i0e(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];const[n,...i]=e;return function(){for(var a=arguments.length,o=new Array(a),u=0;u<a;u++)o[u]=arguments[u];return Ri(i,(c,f)=>f(c),n.apply(this,o))}}function IF(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return function(){for(var s=arguments.length,a=new Array(s),o=0;o<s;o++)a[o]=arguments[o];return t.apply(this,r.concat(a))}}function NQ(t){const e=t.length;function r(n){return function(){for(var s=arguments.length,a=new Array(s),o=0;o<s;o++)a[o]=arguments[o];const u=n.concat(a);let c;return u.length>=e?c=t.apply(this,u):c=r(u),c}}return r([])}function s0e(t){const e=t.length;function r(n){return function(){for(var s=arguments.length,a=new Array(s),o=0;o<s;o++)a[o]=arguments[o];const u=n.concat(a.reverse());let c;return u.length>=e?c=t.apply(this,u):c=r(u),c}}return r([])}function e_(t,e,r,n,i,s,a,o){return it(o)?t.call(e,r,n,i,s,a,o):it(a)?t.call(e,r,n,i,s,a):it(s)?t.call(e,r,n,i,s):it(i)?t.call(e,r,n,i):it(n)?t.call(e,r,n):it(r)?t.call(e,r):t.call(e)}const a0e=Object.freeze(Object.defineProperty({__proto__:null,curry:NQ,curryRight:s0e,debounce:CS,fastCall:e_,isFunction:kr,partial:IF,pipe:i0e,throttle:IQ,throttleAfterHits:n0e},Symbol.toStringTag,{value:"Module"})),ut={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:vE()?182:174,AUDIO_MUTE:vE()?181:173,AUDIO_UP:vE()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},o0e=[ut.ALT,ut.ARROW_DOWN,ut.ARROW_LEFT,ut.ARROW_RIGHT,ut.ARROW_UP,ut.AUDIO_DOWN,ut.AUDIO_MUTE,ut.AUDIO_UP,ut.BACKSPACE,ut.CAPS_LOCK,ut.DELETE,ut.END,ut.ENTER,ut.ESCAPE,ut.F1,ut.F2,ut.F3,ut.F4,ut.F5,ut.F6,ut.F7,ut.F8,ut.F9,ut.F10,ut.F11,ut.F12,ut.F13,ut.F14,ut.F15,ut.F16,ut.F17,ut.F18,ut.F19,ut.HOME,ut.INSERT,ut.MEDIA_NEXT,ut.MEDIA_PLAY_PAUSE,ut.MEDIA_PREV,ut.MEDIA_STOP,ut.NULL,ut.NUM_LOCK,ut.PAGE_DOWN,ut.PAGE_UP,ut.PAUSE,ut.SCROLL_LOCK,ut.SHIFT,ut.TAB];function HQ(t){return t===32||t>=48&&t<=57||t>=96&&t<=111||t>=186&&t<=192||t>=219&&t<=222||t>=226||t>=65&&t<=90}function NF(t){return o0e.includes(t)}function l0e(t){const e=[];return JE()?e.push(ut.COMMAND_LEFT,ut.COMMAND_RIGHT,ut.COMMAND_FIREFOX):e.push(ut.CONTROL),e.includes(t)}function FQ(t){return[ut.CONTROL,ut.COMMAND_LEFT,ut.COMMAND_RIGHT,ut.COMMAND_FIREFOX].includes(t)}function sv(t,e){const r=e.split("|");let n=!1;return he(r,i=>{if(t===ut[i])return n=!0,!1}),n}const u0e=Object.freeze(Object.defineProperty({__proto__:null,KEY_CODES:ut,isCtrlKey:l0e,isCtrlMetaKey:FQ,isFunctionKey:NF,isKey:sv,isPrintableChar:HQ},Symbol.toStringTag,{value:"Module"}));function Qo(t){t.isImmediatePropagationEnabled=!1,t.cancelBubble=!0}function gf(t){return t.isImmediatePropagationEnabled===!1}function Vf(t){return t.button===2}function zR(t){return t.button===0}function LQ(t){return t instanceof TouchEvent}function BQ(t,e){const r={x:t.offsetX,y:t.offsetY};let n=t.target;if(!Iu(e)||n!==e&&n.contains(e))return r;for(;n!==e;)r.x+=n.offsetLeft,r.y+=n.offsetTop,n=n.offsetParent;return r}const c0e=Object.freeze(Object.defineProperty({__proto__:null,isImmediatePropagationStopped:gf,isLeftClick:zR,isRightClick:Vf,isTouchEvent:LQ,offsetRelativeTo:BQ,stopImmediatePropagation:Qo},Symbol.toStringTag,{value:"Module"}));function br(){it(console)&&console.warn(...arguments)}function HF(){it(console)&&console.error(...arguments)}const hg=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","beforeCompositionStart","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceChange","beforeViewportScrollVertically","beforeViewportScrollHorizontally","beforeViewportScroll","afterScrollHorizontally","afterScrollVertically","afterScroll","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSelectionFocusSet","beforeSelectColumns","afterSelectColumns","beforeSelectRows","afterSelectRows","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterSetTheme","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeRowWrap","beforeColumnWrap","beforeSetCellMeta","beforeSelectionFocusSet","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeSelectionHighlightSet","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyFiltersMultiSelectValue","modifyFocusedElement","modifyRowHeader","modifyRowHeight","modifyRowHeightByOverlayName","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","modifyGetCoordsElement","modifyFocusOnTabNavigation","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformFocus","modifyTransformStart","modifyTransformEnd","afterModifyTransformFocus","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","beforeBeginEditing","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],BD=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),VD=new Map([[]]);var kj={},WD,Dj;function h0e(){if(Dj)return WD;Dj=1;var t=Jp();return WD=function(e,r,n){for(var i=0,s=arguments.length>2?n:t(r),a=new e(s);s>i;)a[i]=r[i++];return a},WD}var $D,Pj;function f0e(){if(Pj)return $D;Pj=1;var t=li();return $D=function(e,r){var n=t[e],i=n&&n.prototype;return i&&i[r]},$D}var UD,Ij;function GR(){if(Ij)return UD;Ij=1;var t=Fl(),e=$H(),r=Xf().f,n=t("unscopables"),i=Array.prototype;return i[n]===void 0&&r(i,n,{configurable:!0,value:e(null)}),UD=function(s){i[n][s]=!0},UD}var Nj;function d0e(){if(Nj)return kj;Nj=1;var t=nn(),e=ui(),r=ba(),n=lS(),i=h0e(),s=f0e(),a=GR(),o=Array,u=e(s("Array","sort"));return t({target:"Array",proto:!0},{toSorted:function(f){f!==void 0&&r(f);var g=n(this),m=i(o,g);return u(m,f)}}),a("toSorted"),kj}d0e();var Hj={},Fj={},Lj;function g0e(){if(Lj)return Fj;Lj=1;var t=nn(),e=xi(),r=ev(),n=ba(),i=_i(),s=Yu(),a=Ca(),o=Qf(),u=o("find",TypeError);return t({target:"Iterator",proto:!0,real:!0,forced:u},{find:function(f){i(this);try{n(f)}catch(v){a(this,"throw",v)}if(u)return e(u,this,f);var g=s(this),m=0;return r(g,function(v,w){if(f(v,m++))return w(v)},{IS_RECORD:!0,INTERRUPTED:!0}).result}}),Fj}var Bj;function m0e(){return Bj||(Bj=1,g0e()),Hj}m0e();function p0e(t,e){VQ(t,e),e.add(t)}function jD(t,e,r){VQ(t,e),e.set(t,r)}function VQ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Vj(t,e,r){return t.set(t_(t,e),r),r}function Ji(t,e){return t.get(t_(t,e))}function t_(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const v0e=100;var Ha=new WeakMap,j0=new WeakMap,YD=new WeakMap,zD=new WeakSet;class Wj{constructor(){p0e(this,zD),jD(this,Ha,new Map),jD(this,j0,new Map),jD(this,YD,new Set),hg.forEach(e=>t_(zD,this,$j).call(this,e))}getHooks(e){var r;return(r=Ji(Ha,this).get(e))!==null&&r!==void 0?r:[]}add(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Ji(Ha,this).has(e)||(t_(zD,this,$j).call(this,e),hg.push(e));const i=Ji(Ha,this).get(e);if(i.find(c=>c.callback===r))return;const s=Number.isInteger(n.orderIndex)?n.orderIndex:0,a=!!n.runOnce,o=!!n.initialHook;let u=!1;if(o){const c=i.find(f=>f.initialHook);c&&(c.callback=r,u=!0)}if(!u){i.push({callback:r,orderIndex:s,runOnce:a,initialHook:o,skip:!1});let c=Ji(YD,this).has(e);!c&&s!==0&&(c=!0,Ji(YD,this).add(e)),c&&i.length>1&&Ji(Ha,this).set(e,i.toSorted((f,g)=>f.orderIndex-g.orderIndex))}}has(e){return Ji(Ha,this).has(e)&&Ji(Ha,this).get(e).length>0}remove(e,r){if(!Ji(Ha,this).has(e))return!1;const n=Ji(Ha,this).get(e),i=n.find(s=>s.callback===r);if(i){let s=Ji(j0,this).get(e);return i.skip=!0,s+=1,s>v0e&&(Ji(Ha,this).set(e,n.filter(a=>!a.skip)),s=0),Ji(j0,this).set(e,s),!0}return!1}destroy(){Ji(Ha,this).clear(),Ji(j0,this).clear(),Vj(Ha,this,null),Vj(j0,this,null)}}function $j(t){Ji(Ha,this).set(t,[]),Ji(j0,this).set(t,0)}function w0e(t,e,r){return(e=y0e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function y0e(t){var e=S0e(t,"string");return typeof e=="symbol"?e:e+""}function S0e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const b0e=Dr`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\x20
  learn about the migration path.`;class Je{constructor(){w0e(this,"globalBucket",new Wj)}static getSingleton(){return x0e()}getBucket(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return e?(e.pluginHookBucket||(e.pluginHookBucket=new Wj),e.pluginHookBucket):this.globalBucket}add(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,i=arguments.length>3?arguments[3]:void 0;return Array.isArray(r)?he(r,s=>this.add(e,s,n)):(BD.has(e)&&br(pF(b0e,{hookName:e,removedInVersion:BD.get(e)})),VD.has(e)&&br(VD.get(e)),this.getBucket(n).add(e,r,{orderIndex:i,runOnce:!1})),this}once(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,i=arguments.length>3?arguments[3]:void 0;return Array.isArray(r)?he(r,s=>this.once(e,s,n)):this.getBucket(n).add(e,r,{orderIndex:i,runOnce:!0}),this}addAsFixed(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return Array.isArray(r)?he(r,i=>this.addAsFixed(e,i,n)):this.getBucket(n).add(e,r,{initialHook:!0}),this}remove(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return this.getBucket(n).remove(e,r)}has(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return this.getBucket(r).has(e)}run(e,r,n,i,s,a,o,u){{const c=this.getBucket().getHooks(r),f=c?c.length:0;let g=0;if(f)for(;g<f;){if(!c[g]||c[g].skip){g+=1;continue}const m=e_(c[g].callback,e,n,i,s,a,o,u);m!==void 0&&(n=m),c[g]&&c[g].runOnce&&this.remove(r,c[g].callback),g+=1}}{const c=this.getBucket(e).getHooks(r),f=c?c.length:0;let g=0;if(f)for(;g<f;){if(!c[g]||c[g].skip){g+=1;continue}const m=e_(c[g].callback,e,n,i,s,a,o,u);m!==void 0&&(n=m),c[g]&&c[g].runOnce&&this.remove(r,c[g].callback,e),g+=1}}return n}destroy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.getBucket(e).destroy()}register(e){this.isRegistered(e)||hg.push(e)}deregister(e){this.isRegistered(e)&&hg.splice(hg.indexOf(e),1)}isDeprecated(e){return VD.has(e)||BD.has(e)}isRegistered(e){return hg.indexOf(e)>=0}getRegistered(){return hg}}const C0e=new Je;function x0e(){return C0e}const pg=new Map;function Zo(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"common";pg.has(t)||pg.set(t,new Map);const e=pg.get(t);function r(u,c){e.set(u,c)}function n(u){return e.get(u)}function i(u){return e.has(u)}function s(){return[...e.keys()]}function a(){return[...e.values()]}function o(){pg.delete(t),e.clear()}return{register:r,getItem:n,hasItem:i,getNames:s,getValues:a,clear:o}}function E0e(t,e){var r;return pg==null||(r=pg.get(t.guid))===null||r===void 0?void 0:r.get(e)}const nN=new WeakMap,{register:_0e,getItem:WQ,hasItem:$Q,getNames:R0e,getValues:sKe}=Zo("editors");function T0e(t){const e={},r=t;this.getConstructor=function(){return t},this.getInstance=function(n){return n.guid in e||(e[n.guid]=new r(n)),e[n.guid]},Je.getSingleton().add("afterDestroy",function(){e[this.guid]=null})}function UQ(t,e){let r;if(typeof t=="function")nN.get(t)||ca(null,t),r=nN.get(t);else if(typeof t=="string")r=WQ(t);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!r)throw Error(`No editor registered under name "${t}"`);return r.getInstance(e)}function E1(t){if(typeof t=="function")return t;if(!$Q(t))throw Error(`No registered editor found under "${t}" name`);return WQ(t).getConstructor()}function ca(t,e){t&&typeof t!="string"&&(e=t,t=e.EDITOR_TYPE);const r=new T0e(e);typeof t=="string"&&_0e(t,r),nN.set(e,r)}function M0e(t,e,r){return(e=A0e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function A0e(t){var e=O0e(t,"string");return typeof e=="symbol"?e:e+""}function O0e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let wE=0;class Uo{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;M0e(this,"context",void 0),this.context=e||this,this.context.eventListeners||(this.context.eventListeners=[])}addEventListener(e,r,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;function s(a){n.call(this,k0e(a))}return this.context.eventListeners.push({element:e,event:r,callback:n,callbackProxy:s,options:i,eventManager:this}),e.addEventListener(r,s,i),wE+=1,()=>{this.removeEventListener(e,r,n)}}removeEventListener(e,r,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,s=this.context.eventListeners.length,a;for(;s;)if(s-=1,a=this.context.eventListeners[s],a.event===r&&a.element===e){if(n&&n!==a.callback||i&&a.eventManager!==this)continue;this.context.eventListeners.splice(s,1),a.element.removeEventListener(a.event,a.callbackProxy,a.options),wE-=1}}clearEvents(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!this.context)return;let r=this.context.eventListeners.length;for(;r;){r-=1;const n=this.context.eventListeners[r];e&&n.eventManager!==this||(this.context.eventListeners.splice(r,1),n.element.removeEventListener(n.event,n.callbackProxy,n.options),wE-=1)}}clear(){this.clearEvents()}destroy(){this.clearEvents(),this.context=null}destroyWithOwnEventsOnly(){this.clearEvents(!0),this.context=null}fireEvent(e,r){let n=e.document,i=e;n||(n=e.ownerDocument?e.ownerDocument:e,i=n.defaultView);const s={bubbles:!0,cancelable:r!=="mousemove",view:i,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0};let a;n.createEvent?(a=n.createEvent("MouseEvents"),a.initMouseEvent(r,s.bubbles,s.cancelable,s.view,s.detail,s.screenX,s.screenY,s.clientX,s.clientY,s.ctrlKey,s.altKey,s.shiftKey,s.metaKey,s.button,n.body.parentNode)):a=n.createEventObject(),e.dispatchEvent?e.dispatchEvent(a):e.fireEvent(`on${r}`,a)}}function k0e(t){const e=t.stopImmediatePropagation;return t.stopImmediatePropagation=function(){e.apply(this),Qo(this)},t}function D0e(){return wE}function P0e(t,e){I0e(t,e),e.add(t)}function I0e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _d(t,e,r){return(e=N0e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function N0e(t){var e=H0e(t,"string");return typeof e=="symbol"?e:e+""}function H0e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function GD(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var hC=new WeakSet;class iN{constructor(e,r,n){P0e(this,hC),_d(this,"hot",void 0),_d(this,"tableMeta",void 0),_d(this,"selection",void 0),_d(this,"eventManager",void 0),_d(this,"destroyed",!1),_d(this,"activeEditor",void 0),_d(this,"cellProperties",void 0),this.hot=e,this.tableMeta=r,this.selection=n,this.eventManager=new Uo(e),this.hot.addHook("afterDocumentKeyDown",i=>GD(hC,this,Uj).call(this,i)),this.hot.addHook("beforeCompositionStart",i=>GD(hC,this,Uj).call(this,i)),this.hot.view._wt.update("onCellDblClick",(i,s,a)=>GD(hC,this,F0e).call(this,i,s,a))}getActiveEditor(){return this.activeEditor}prepareEditor(){var e;if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(!1,!1,c=>{c&&this.prepareEditor()});return}const r=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;if(!r||r.isHeader())return;const{row:n,col:i}=r,s=this.hot.runHooks("modifyGetCellCoords",n,i,!1,"meta");let a=n,o=i;if(Array.isArray(s)&&([a,o]=s),this.cellProperties=this.hot.getCellMeta(a,o),!this.isCellEditable()){this.clearActiveEditor();return}const u=this.hot.getCell(n,i,!0);if(u){const c=this.hot.getCellEditor(this.cellProperties),f=this.hot.colToProp(o),g=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(a),o);this.activeEditor=UQ(c,this.hot),this.activeEditor.prepare(n,i,f,u,g,this.cellProperties)}}isEditorOpened(){return this.activeEditor&&this.activeEditor.isOpened()}openEditor(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!this.isCellEditable()){this.clearActiveEditor();return}const i=this.hot.getSelectedRangeLast();let s=this.hot.runHooks("beforeBeginEditing",i.highlight.row,i.highlight.col,e,r,n);if(r instanceof MouseEvent&&typeof s!="boolean"&&(s=this.hot.selection.getLayerLevel()===0&&i.isSingle()),s===!1){this.clearActiveEditor();return}this.activeEditor||(this.hot.scrollToFocusedCell(),this.prepareEditor()),this.activeEditor&&(n&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(e,r))}closeEditor(e,r,n){this.activeEditor?this.activeEditor.finishEditing(e,r,n):n&&n(!1)}closeEditorAndSaveChanges(e){this.closeEditor(!1,e)}closeEditorAndRestoreOriginalValue(e){this.closeEditor(!0,e)}clearActiveEditor(){this.activeEditor=void 0}isCellEditable(){const e=this.hot.getSelectedRangeLast();if(!e)return!1;const r=this.hot.getCellEditor(this.cellProperties),{row:n,col:i}=e.highlight,{rowIndexMapper:s,columnIndexMapper:a}=this.hot,o=s.isHidden(this.hot.toPhysicalRow(n))||a.isHidden(this.hot.toPhysicalColumn(i));return!(this.cellProperties.readOnly||!r||o)}moveSelectionAfterEnter(e){const r={...typeof this.tableMeta.enterMoves=="function"?this.tableMeta.enterMoves(e):this.tableMeta.enterMoves};e.shiftKey&&(r.row=-r.row,r.col=-r.col),this.hot.selection.isMultiple()?this.selection.transformFocus(r.row,r.col):this.selection.transformStart(r.row,r.col,!0)}destroy(){this.destroyed=!0,this.eventManager.destroy()}}function Uj(t){const e=this.hot.getSelectedRangeLast();if(!this.hot.isListening()||!e||e.highlight.isHeader()||gf(t))return;const{keyCode:r}=t,n=(t.ctrlKey||t.metaKey)&&!t.altKey;(!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!NF(r)&&!FQ(r)&&!n&&!this.isEditorOpened()&&this.openEditor("",t)}function F0e(t,e){e.isCell()&&(this.hot.getShortcutManager().isCtrlPressed()?this.clearActiveEditor():this.openEditor(null,t,!0))}const jj=new WeakMap;iN.getInstance=function(t,e,r){let n=jj.get(t);return n||(n=new iN(t,e,r),jj.set(t,n)),n};function L0e(t,e){jQ(t,e),e.add(t)}function bw(t,e,r){jQ(t,e),e.set(t,r)}function jQ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ln(t,e){return t.get(Nc(t,e))}function Cw(t,e,r){return t.set(Nc(t,e),r),r}function Nc(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const dp=Object.freeze({CELL:"cell",MIXED:"mixed"});var wi=new WeakMap,fC=new WeakMap,dC=new WeakMap,gC=new WeakMap,mC=new WeakMap,uf=new WeakSet;class B0e{constructor(e){var r=this;L0e(this,uf),bw(this,wi,void 0),bw(this,fC,void 0),bw(this,dC,1),bw(this,gC,null),bw(this,mC,new Map);const n=e.getSettings();Cw(wi,this,e),Cw(fC,this,n.imeFastEdit?dp.MIXED:dp.CELL),ln(wi,this).addHook("afterUpdateSettings",function(){for(var i=arguments.length,s=new Array(i),a=0;a<i;a++)s[a]=arguments[a];return Nc(uf,r,W0e).call(r,...s)}),ln(wi,this).addHook("afterSelection",function(){for(var i=arguments.length,s=new Array(i),a=0;a<i;a++)s[a]=arguments[a];return Nc(uf,r,Yj).call(r,...s)}),ln(wi,this).addHook("afterSelectionFocusSet",function(){for(var i=arguments.length,s=new Array(i),a=0;a<i;a++)s[a]=arguments[a];return Nc(uf,r,Yj).call(r,...s)}),ln(wi,this).addHook("afterSelectionEnd",function(){for(var i=arguments.length,s=new Array(i),a=0;a<i;a++)s[a]=arguments[a];return Nc(uf,r,V0e).call(r,...s)})}getFocusMode(){return ln(fC,this)}setFocusMode(e){Object.values(dp).includes(e)?Cw(fC,this,e):br(`"${e}" is not a valid focus mode.`)}getRefocusDelay(){return ln(dC,this)}setRefocusDelay(e){Cw(dC,this,e)}setRefocusElementGetter(e){Cw(gC,this,e)}getRefocusElement(){var e;return typeof ln(gC,this)=="function"?ln(gC,this).call(this):(e=ln(wi,this).getActiveEditor())===null||e===void 0?void 0:e.TEXTAREA}focusOnHighlightedCell(e){const r=n=>{var i,s;const a=(i=ln(wi,this).getSelectedRangeLast())===null||i===void 0?void 0:i.highlight;if(!a)return;let o=ln(wi,this).runHooks("modifyFocusedElement",a.row,a.col,n);Iu(o)||(o=n),o&&!((s=ln(wi,this).getActiveEditor())!==null&&s!==void 0&&s.isOpened())&&o.focus({preventScroll:!0})};e?r(e):Nc(uf,this,FF).call(this,n=>r(n))}refocusToEditorTextarea(){var e;let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:ln(dC,this);if(ln(wi,this).getSettings().imeFastEdit&&!((e=ln(wi,this).getActiveEditor())!==null&&e!==void 0&&e.isOpened())){var n,i;(n=ln(wi,this).getActiveEditor())===null||n===void 0||(i=n.refreshValue)===null||i===void 0||i.call(n),ln(mC,this).has(r)||ln(mC,this).set(r,CS(()=>{if(!ln(wi,this).isDestroyed){var s;(s=this.getRefocusElement())===null||s===void 0||s.select()}},r)),ln(mC,this).get(r)()}}}function FF(t){var e;const r=(e=ln(wi,this).getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;if(!r||!ln(wi,this).selection.isCellVisible(r)){t(null);return}const n=ln(wi,this).getCell(r.row,r.col,!0);n===null?ln(wi,this).addHookOnce("afterScroll",()=>{t(ln(wi,this).getCell(r.row,r.col,!0))}):t(n)}function Yj(){Nc(uf,this,FF).call(this,t=>{const{activeElement:e}=ln(wi,this).rootDocument;e&&YR(e)&&e.blur(),this.focusOnHighlightedCell(t)})}function V0e(){Nc(uf,this,FF).call(this,t=>{this.getFocusMode()===dp.MIXED&&t?.nodeName==="TD"&&this.refocusToEditorTextarea()})}function W0e(t){typeof t.imeFastEdit=="boolean"&&this.setFocusMode(t.imeFastEdit?dp.MIXED:dp.CELL)}var zj={},qD,Gj;function $0e(){if(Gj)return qD;Gj=1;var t=Go(),e=Jg(),r=Fl(),n=r("match");return qD=function(i){var s;return t(i)&&((s=i[n])!==void 0?!!s:e(i)==="RegExp")},qD}var KD,qj;function U0e(){if(qj)return KD;qj=1;var t=li(),e=Ci(),r=t.RegExp,n=!e(function(){var i=!0;try{r(".","d")}catch{i=!1}var s={},a="",o=i?"dgimsy":"gimsy",u=function(m,v){Object.defineProperty(s,m,{get:function(){return a+=v,!0}})},c={dotAll:"s",global:"g",ignoreCase:"i",multiline:"m",sticky:"y"};i&&(c.hasIndices="d");for(var f in c)u(f,c[f]);var g=Object.getOwnPropertyDescriptor(r.prototype,"flags").get.call(s);return g!==o||a!==o});return KD={correct:n},KD}var XD,Kj;function j0e(){if(Kj)return XD;Kj=1;var t=_i();return XD=function(){var e=t(this),r="";return e.hasIndices&&(r+="d"),e.global&&(r+="g"),e.ignoreCase&&(r+="i"),e.multiline&&(r+="m"),e.dotAll&&(r+="s"),e.unicode&&(r+="u"),e.unicodeSets&&(r+="v"),e.sticky&&(r+="y"),r},XD}var QD,Xj;function Y0e(){if(Xj)return QD;Xj=1;var t=xi(),e=qo(),r=uS(),n=U0e(),i=j0e(),s=RegExp.prototype;return QD=n.correct?function(a){return a.flags}:function(a){return!n.correct&&r(s,a)&&!e(a,"flags")?t(i,a):a.flags},QD}var ZD,Qj;function z0e(){if(Qj)return ZD;Qj=1;var t=ui(),e=Qp(),r=Math.floor,n=t("".charAt),i=t("".replace),s=t("".slice),a=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,o=/\$([$&'`]|\d{1,2})/g;return ZD=function(u,c,f,g,m,v){var w=f+u.length,y=g.length,b=o;return m!==void 0&&(m=e(m),b=a),i(v,b,function(x,_){var T;switch(n(_,0)){case"$":return"$";case"&":return u;case"`":return s(c,0,f);case"'":return s(c,w);case"<":T=m[s(_,1,-1)];break;default:var D=+_;if(D===0)return x;if(D>y){var P=r(D/10);return P===0?x:P<=y?g[P-1]===void 0?n(_,1):g[P-1]+n(_,1):x}T=g[D-1]}return T===void 0?"":T})},ZD}var Zj;function G0e(){if(Zj)return zj;Zj=1;var t=nn(),e=xi(),r=ui(),n=oS(),i=Ei(),s=Go(),a=$0e(),o=RR(),u=cS(),c=Y0e(),f=z0e(),g=Fl(),m=Kf(),v=g("replace"),w=TypeError,y=r("".indexOf),b=r("".replace),x=r("".slice),_=Math.max;return t({target:"String",proto:!0},{replaceAll:function(D,P){var O=n(this),A,W,L,H,J,G,ve,be,we,ae,le=0,Te="";if(s(D)){if(A=a(D),A&&(W=o(n(c(D))),!~y(W,"g")))throw new w("`.replaceAll` does not allow non-global regexes");if(L=u(D,v),L)return e(L,D,O,P);if(m&&A)return b(o(O),D,P)}for(H=o(O),J=o(D),G=i(P),G||(P=o(P)),ve=J.length,be=_(1,ve),we=y(H,J);we!==-1;)ae=G?o(P(J,we,H)):f(J,H,we,[],void 0,P),Te+=x(H,le,we)+ae,le=we+ve,we=we+be>H.length?-1:y(H,J,we+be);return le<H.length&&(Te+=x(H,le)),Te}}),zj}G0e();var Jj={},e9={},t9;function q0e(){if(t9)return e9;t9=1;var t=nn(),e=ev(),r=ba(),n=_i(),i=Yu(),s=Ca(),a=Qf(),o=fS(),u=Ci(),c=TypeError,f=u(function(){[].keys().reduce(function(){},void 0)}),g=!f&&a("reduce",c);return t({target:"Iterator",proto:!0,real:!0,forced:f||g},{reduce:function(v){n(this);try{r(v)}catch(_){s(this,"throw",_)}var w=arguments.length<2,y=w?void 0:arguments[1];if(g)return o(g,this,w?[v]:[v,y]);var b=i(this),x=0;if(e(b,function(_){w?(w=!1,y=_):y=v(y,_,x),x++},{IS_RECORD:!0}),w)throw new c("Reduce of empty iterator with no initial value");return y}}),e9}var r9;function K0e(){return r9||(r9=1,q0e()),Jj}K0e();const YQ={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},X0e=new RegExp(Object.keys(YQ).map(t=>`(${t})`).join("|"),"gi");function Q0e(t){return(t&&t.nodeName||"")==="TABLE"}function sN(t){const e=t.hasColHeaders(),r=t.hasRowHeaders(),n=[e?-1:0,r?-1:0,t.countRows()-1,t.countCols()-1],i=t.getData(...n),s=i.length,a=s>0?i[0].length:0,o=["<table>","</table>"],u=e?["<thead>","</thead>"]:[],c=["<tbody>","</tbody>"],f=r?1:0,g=e?1:0;for(let m=0;m<s;m+=1){const v=e&&m===0,w=[];for(let b=0;b<a;b+=1){const x=!v&&r&&b===0;let _="";if(v)_=`<th>${t.getColHeader(b-f)}</th>`;else if(x)_=`<th>${t.getRowHeader(m-g)}</th>`;else{const T=i[m][b],{hidden:D,rowspan:P,colspan:O}=t.getCellMeta(m-g,b-f);if(!D){const A=[];if(P&&A.push(`rowspan="${P}"`),O&&A.push(`colspan="${O}"`),In(T))_=`<td ${A.join(" ")}></td>`;else{const W=T.toString().replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");_=`<td ${A.join(" ")}>${W}</td>`}}}w.push(_)}const y=["<tr>",...w,"</tr>"].join("");v?u.splice(1,0,y):c.splice(-1,0,y)}return o.splice(1,0,u.join(""),c.join("")),o.join("")}function aN(t){const e=t.length,r=["<table>"];for(let n=0;n<e;n+=1){const i=t[n],s=i.length,a=[];n===0&&r.push("<tbody>");for(let o=0;o<s;o+=1){const u=i[o],c=In(u)?"":u.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20{2,}/gi,f=>`<span style="mso-spacerun: yes">${"&nbsp;".repeat(f.length-1)} </span>`).replace(/\t/gi,"&#9;");a.push(`<td>${c}</td>`)}r.push("<tr>",...a,"</tr>"),n+1===e&&r.push("</tbody>")}return r.push("</table>"),r.join("")}function zQ(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document;const r={},n=e.createDocumentFragment(),i=e.createElement("div");n.appendChild(i);let s=t;if(typeof s=="string"){const T=s.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,D=>{const P=D.match(/<td\b[^>]*?>/g)[0],O=/<p.*?>/g,A=D.substring(P.length,D.lastIndexOf("<")).trim().replaceAll(/\n\s+/g," ").replaceAll(O,`
`).replace(`
`,"").replaceAll(/<\/(.*)>\s+$/mg,"</$1>").replace(/(<(?!br)([^>]+)>)/gi,"").replaceAll(/^&nbsp;$/mg,"");return`${P}${A}</td>`});i.insertAdjacentHTML("afterbegin",`${T}`),s=i.querySelector("table")}if(!s||!Q0e(s))return;const a=i.querySelector('meta[name$="enerator"]'),o=s.querySelector("tbody th")!==null,u=s.querySelector("tr"),c=u?Array.from(u.cells).reduce((T,D)=>T+D.colSpan,0)-(o?1:0):0,f=s.tFoot&&Array.from(s.tFoot.rows)||[],g=[];let m=!1,v=0,w=0;if(s.tHead){const T=Array.from(s.tHead.rows).filter(D=>{const P=D.querySelector("td")!==null;return P&&g.push(D),!P});v=T.length,m=v>0,v>1?r.nestedHeaders=Array.from(T).reduce((D,P)=>{const O=Array.from(P.cells).reduce((A,W,L)=>{if(o&&L===0)return A;const{colSpan:H,innerHTML:J}=W,G=H>1?{label:J,colspan:H}:J;return A.push(G),A},[]);return D.push(O),D},[]):m&&(r.colHeaders=Array.from(T[0].children).reduce((D,P,O)=>(o&&O===0||D.push(P.innerHTML),D),[]))}g.length&&(r.fixedRowsTop=g.length),f.length&&(r.fixedRowsBottom=f.length);const y=[...g,...Array.from(s.tBodies).reduce((T,D)=>(T.push(...Array.from(D.rows)),T),[]),...f];w=y.length;const b=new Array(w);for(let T=0;T<w;T++)b[T]=new Array(c);const x=[],_=[];for(let T=0;T<w;T++){const D=y[T],P=Array.from(D.cells),O=P.length;for(let A=0;A<O;A++){const W=P[A],{nodeName:L,innerHTML:H,rowSpan:J,colSpan:G}=W,ve=b[T].findIndex(be=>be===void 0);if(L==="TD"){if(J>1||G>1){for(let le=T;le<T+J;le++)if(le<w)for(let Te=ve;Te<ve+G;Te++)b[le][Te]=null;const we=W.getAttribute("style");we&&we.includes("mso-ignore:colspan")||x.push({col:ve,row:T,rowspan:J,colspan:G})}let be="";a&&/excel/gi.test(a.content)?be=H.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,`\r
`):be=H.replace(/<br(\s*|\/)>[\r\n]?/gim,`\r
`),b[T][ve]=be.replace(X0e,we=>YQ[we])}else _.push(H)}}return x.length&&(r.mergeCells=x),_.length&&(r.rowHeaders=_),b.length&&(r.data=b),r}const Z0e=Object.freeze(Object.defineProperty({__proto__:null,_dataToHTML:aN,htmlToGridSettings:zQ,instanceToHTML:sN},Symbol.toStringTag,{value:"Module"}));function Ss(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=typeof t;if(r==="number")return!isNaN(t)&&isFinite(t);if(r==="string"){if(t.length===0)return!1;if(t.length===1)return/\d/.test(t);const n=Array.from(new Set([".",...e])).map(i=>`\\${i}`).join("|");return new RegExp(`^[+-]?(((${n})?\\d+((${n})\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$`,"i").test(t.trim())}else if(r==="object")return!!t&&typeof t.valueOf()=="number"&&!(t instanceof Date);return!1}function GQ(t){return Ss(t,[","])}function ct(t,e,r){let n=-1;for(typeof e=="function"?(r=e,e=t):n=t-1;++n<=e&&r(n)!==!1;);}function oN(t,e,r){let n=t+1;for(typeof e=="function"&&(r=e,e=0);--n>=e&&r(n)!==!1;);}function LF(t,e){return e=parseInt(e.toString().replace("%",""),10),e=isNaN(e)?0:e,parseInt(t*e/100,10)}function ir(t,e,r){return Math.min(t,e)===t?e:Math.max(t,r)===t?r:t}const J0e=Object.freeze(Object.defineProperty({__proto__:null,clamp:ir,isNumeric:Ss,isNumericLike:GQ,rangeEach:ct,rangeEachReverse:oN,valueAccordingPercent:LF},Symbol.toStringTag,{value:"Module"})),lN="asc",epe="desc",n9=new Map([[lN,[-1,1]],[epe,[1,-1]]]),tpe=t=>`The priority '${t}' is already declared in a map.`,rpe=t=>`The priority '${t}' is not a number.`;function npe(){let{errorPriorityExists:t,errorPriorityNaN:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const r=new Map;t=kr(t)?t:tpe,e=kr(e)?e:rpe;function n(s,a){if(!Ss(s))throw new Error(e(s));if(r.has(s))throw new Error(t(s));r.set(s,a)}function i(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:lN;const[a,o]=n9.get(s)||n9.get(lN);return[...r].sort((u,c)=>u[0]<c[0]?a:o).map(u=>u[1])}return{addItem:n,getItems:i}}const ipe=t=>`The id '${t}' is already declared in a map.`;function qR(){let{errorIdExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Map;t=kr(t)?t:ipe;function r(c,f){if(u(c))throw new Error(t(c));e.set(c,f)}function n(c){return e.delete(c)}function i(){e.clear()}function s(c){const[f]=o().find(g=>{let[m,v]=g;return c===v?m:!1})||[null];return f}function a(c){return e.get(c)}function o(){return[...e]}function u(c){return e.has(c)}return{addItem:r,clear:i,getId:s,getItem:a,getItems:o,hasItem:u,removeItem:n}}const spe=t=>`'${t}' value is already declared in a unique set.`;function ape(){let{errorItemExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Set;t=kr(t)?t:spe;function r(s){if(e.has(s))throw new Error(t(s));e.add(s)}function n(){return[...e]}function i(){e.clear()}return{addItem:r,clear:i,getItems:n}}const BF=t=>`There is already registered "${t}" plugin.`,ope=t=>`There is already registered plugin on priority "${t}".`,lpe=t=>`The priority "${t}" is not a number.`,qQ=npe({errorPriorityExists:ope,errorPriorityNaN:lpe}),KQ=ape({errorItemExists:BF}),uN=qR({errorIdExists:BF});function VF(){return[...qQ.getItems(),...KQ.getItems()]}function xS(t){const e=Ms(t);return uN.getItem(e)}function upe(t){return!!xS(t)}function lr(t,e,r){[t,e,r]=hpe(t,e,r),xS(t)===void 0&&cpe(t,e,r)}function cpe(t,e,r){const n=Ms(t);if(uN.hasItem(n))throw new Error(BF(n));r===void 0?KQ.addItem(n):qQ.addItem(r,n),uN.addItem(n,e)}function hpe(t,e,r){return typeof t=="function"&&(e=t,t=e.PLUGIN_KEY,r=e.PLUGIN_PRIORITY),[t,e,r]}const{register:fpe,getItem:dpe,hasItem:XQ,getNames:gpe,getValues:aKe}=Zo("renderers");function _1(t){if(typeof t=="function")return t;if(!XQ(t))throw Error(`No registered renderer found under "${t}" name`);return dpe(t)}function La(t,e){typeof t!="string"&&(e=t,t=e.RENDERER_TYPE),fpe(t,e)}const{register:mpe,getItem:ppe,hasItem:QQ,getNames:vpe,getValues:oKe}=Zo("validators");function WF(t){if(typeof t=="function")return t;if(!QQ(t))throw Error(`No registered validator found under "${t}" name`);return ppe(t)}function fg(t,e){typeof t!="string"&&(e=t,t=e.VALIDATOR_TYPE),mpe(t,e)}var i9={},s9;function wpe(){if(s9)return i9;s9=1;var t=nn(),e=Qp(),r=Jp(),n=hS(),i=GR();return t({target:"Array",proto:!0},{at:function(a){var o=e(this),u=r(o),c=n(a),f=c>=0?c:u+c;return f<0||f>=u?void 0:o[f]}}),i("at"),i9}wpe();var a9={},o9;function ype(){if(o9)return a9;o9=1;var t=nn(),e=ui(),r=oS(),n=hS(),i=RR(),s=Ci(),a=e("".charAt),o=s(function(){return"𠮷".at(-2)!=="\uD842"});return t({target:"String",proto:!0,forced:o},{at:function(c){var f=i(r(this)),g=f.length,m=n(c),v=m>=0?m:g+m;return v<0||v>=g?void 0:a(f,v)}}),a9}ype();function xw(t,e,r){return(e=Spe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Spe(t){var e=bpe(t,"string");return typeof e=="symbol"?e:e+""}function bpe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Cpe{constructor(){xw(this,"count",0),xw(this,"startColumn",null),xw(this,"endColumn",null),xw(this,"startPosition",null),xw(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,r){const{totalCalculatedWidth:n,zeroBasedScrollOffset:i,viewportWidth:s,columnWidth:a}=r,o=i>0?s+1:s;n>=i&&n+a<=i+o&&((this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e)}finalize(e){var r;const{scrollOffset:n,viewportWidth:i,inlineStartOffset:s,zeroBasedScrollOffset:a,totalColumns:o,needReverse:u,startPositions:c,columnWidth:f}=e;if(this.endColumn===o-1&&u)for(this.startColumn=this.endColumn;this.startColumn>0;){const w=c[this.endColumn]+f-c[this.startColumn-1];if(w<=i&&(this.startColumn-=1),w>=i)break}this.startPosition=(r=c[this.startColumn])!==null&&r!==void 0?r:null;const g=a>0?i+1:i,m=n+i-g,v=this.startColumn===null?0:e.getColumnWidth(this.startColumn);m<-1*s||n>c.at(-1)||-1*n-i>-1*v?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,o<this.endColumn&&(this.endColumn=o-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function Ew(t,e,r){return(e=xpe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function xpe(t){var e=Epe(t,"string");return typeof e=="symbol"?e:e+""}function Epe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class _pe{constructor(){Ew(this,"count",0),Ew(this,"startRow",null),Ew(this,"endRow",null),Ew(this,"startPosition",null),Ew(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,r){const{totalCalculatedHeight:n,zeroBasedScrollOffset:i,innerViewportHeight:s,rowHeight:a}=r;n>=i&&n+a<=s&&(this.startRow===null&&(this.startRow=e),this.endRow=e)}finalize(e){var r;const{scrollOffset:n,viewportHeight:i,horizontalScrollbarHeight:s,totalRows:a,needReverse:o,startPositions:u,rowHeight:c}=e;if(this.endRow===a-1&&o)for(this.startRow=this.endRow;this.startRow>0;){const m=u[this.endRow]+c-u[this.startRow-1];if(m<=i-s&&(this.startRow-=1),m>=i-s)break}this.startPosition=(r=u[this.startRow])!==null&&r!==void 0?r:null;const f=n+i-s,g=this.startRow===null?0:e.getRowHeight(this.startRow);f<g||n>u.at(-1)?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endRow&&(this.endRow=a-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function _w(t,e,r){return(e=Rpe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Rpe(t){var e=Tpe(t,"string");return typeof e=="symbol"?e:e+""}function Tpe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ZQ{constructor(){_w(this,"count",0),_w(this,"startColumn",null),_w(this,"endColumn",null),_w(this,"startPosition",null),_w(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,r){const{totalCalculatedWidth:n,zeroBasedScrollOffset:i,viewportWidth:s}=r;n<=i&&(this.startColumn=e);const a=i>0?s+1:s;n>=i&&n<=i+a&&(this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e}finalize(e){var r;const{scrollOffset:n,viewportWidth:i,inlineStartOffset:s,zeroBasedScrollOffset:a,totalColumns:o,needReverse:u,startPositions:c,columnWidth:f}=e;if(this.endColumn===o-1&&u)for(this.startColumn=this.endColumn;this.startColumn>0;){const v=c[this.endColumn]+f-c[this.startColumn-1];if(this.startColumn-=1,v>i)break}this.startPosition=(r=c[this.startColumn])!==null&&r!==void 0?r:null;const g=a>0?i+1:i;n+i-g<-1*s||n>c.at(-1)+f||-1*n-i>0?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,o<this.endColumn&&(this.endColumn=o-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function Rw(t,e,r){return(e=Mpe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Mpe(t){var e=Ape(t,"string");return typeof e=="symbol"?e:e+""}function Ape(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class JQ{constructor(){Rw(this,"count",0),Rw(this,"startRow",null),Rw(this,"endRow",null),Rw(this,"startPosition",null),Rw(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,r){const{totalCalculatedHeight:n,zeroBasedScrollOffset:i,innerViewportHeight:s}=r;n<=i&&(this.startRow=e),n>=i&&n<=s&&this.startRow===null&&(this.startRow=e),this.endRow=e}finalize(e){var r;const{scrollOffset:n,viewportHeight:i,horizontalScrollbarHeight:s,totalRows:a,needReverse:o,startPositions:u,rowHeight:c}=e;if(this.endRow===a-1&&o)for(this.startRow=this.endRow;this.startRow>0;){const g=u[this.endRow]+c-u[this.startRow-1];if(this.startRow-=1,g>=i-s)break}this.startPosition=(r=u[this.startRow])!==null&&r!==void 0?r:null,n+i-s<0||n>u.at(-1)+c?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endRow&&(this.endRow=a-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function Tw(t,e,r){return(e=Ope(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Ope(t){var e=kpe(t,"string");return typeof e=="symbol"?e:e+""}function kpe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Dpe{constructor(){Tw(this,"count",0),Tw(this,"startColumn",0),Tw(this,"endColumn",0),Tw(this,"startPosition",0),Tw(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalColumns:r}=e;this.count=r,this.endColumn=this.count-1}process(){}finalize(){}}function Mw(t,e,r){return(e=Ppe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Ppe(t){var e=Ipe(t,"string");return typeof e=="symbol"?e:e+""}function Ipe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Npe{constructor(){Mw(this,"count",0),Mw(this,"startRow",0),Mw(this,"endRow",0),Mw(this,"startPosition",0),Mw(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalRows:r}=e;this.count=r,this.endRow=this.count-1}process(){}finalize(){}}function l9(t,e,r){return(e=Hpe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Hpe(t){var e=Fpe(t,"string");return typeof e=="symbol"?e:e+""}function Fpe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Lpe extends ZQ{constructor(){super(...arguments),l9(this,"columnStartOffset",0),l9(this,"columnEndOffset",0)}finalize(e){var r;super.finalize(e);const{overrideFn:n,totalColumns:i,startPositions:s}=e;if(this.startColumn!==null&&typeof n=="function"){const a=this.startColumn,o=this.endColumn;n(this),this.columnStartOffset=a-this.startColumn,this.columnEndOffset=this.endColumn-o}this.startColumn<0&&(this.startColumn=0),this.startPosition=(r=s[this.startColumn])!==null&&r!==void 0?r:null,i<this.endColumn&&(this.endColumn=i-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function u9(t,e,r){return(e=Bpe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Bpe(t){var e=Vpe(t,"string");return typeof e=="symbol"?e:e+""}function Vpe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Wpe extends JQ{constructor(){super(...arguments),u9(this,"rowStartOffset",0),u9(this,"rowEndOffset",0)}finalize(e){var r;super.finalize(e);const{overrideFn:n,totalRows:i,startPositions:s}=e;if(this.startRow!==null&&typeof n=="function"){const a=this.startRow,o=this.endRow;n(this),this.rowStartOffset=a-this.startRow,this.rowEndOffset=this.endRow-o}this.startRow<0&&(this.startRow=0),this.startPosition=(r=s[this.startRow])!==null&&r!==void 0?r:null,i<this.endRow&&(this.endRow=i-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function c9(t,e,r){return(e=$pe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function $pe(t){var e=Upe(t,"string");return typeof e=="symbol"?e:e+""}function Upe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class eZ{constructor(e){c9(this,"calculationTypes",[]),c9(this,"calculationResults",new Map),this.calculationTypes=e}_initialize(e){this.calculationTypes.forEach(r=>{let[n,i]=r;this.calculationResults.set(n,i),i.initialize(e)})}_process(e,r){this.calculationTypes.forEach(n=>{let[,i]=n;return i.process(e,r)})}_finalize(e){this.calculationTypes.forEach(r=>{let[,n]=r;return n.finalize(e)})}getResultsFor(e){return this.calculationResults.get(e)}}function ol(t,e,r){return(e=jpe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function jpe(t){var e=Ype(t,"string");return typeof e=="symbol"?e:e+""}function Ype(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Op=50;class zpe extends eZ{constructor(e){let{calculationTypes:r,viewportWidth:n,scrollOffset:i,totalColumns:s,columnWidthFn:a,overrideFn:o,inlineStartOffset:u}=e;super(r),ol(this,"viewportWidth",0),ol(this,"scrollOffset",0),ol(this,"zeroBasedScrollOffset",0),ol(this,"totalColumns",0),ol(this,"columnWidthFn",null),ol(this,"columnWidth",0),ol(this,"overrideFn",null),ol(this,"inlineStartOffset",0),ol(this,"totalCalculatedWidth",0),ol(this,"startPositions",[]),ol(this,"needReverse",!0),this.viewportWidth=n,this.scrollOffset=i,this.zeroBasedScrollOffset=Math.max(i,0),this.totalColumns=s,this.columnWidthFn=a,this.overrideFn=o,this.inlineStartOffset=u,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalColumns;e++)if(this.columnWidth=this.getColumnWidth(e),this._process(e,this),this.startPositions.push(this.totalCalculatedWidth),this.totalCalculatedWidth+=this.columnWidth,this.totalCalculatedWidth>=this.zeroBasedScrollOffset+this.viewportWidth){this.needReverse=!1;break}this._finalize(this)}getColumnWidth(e){const r=this.columnWidthFn(e);return isNaN(r)?Op:r}}function fo(t,e,r){return(e=Gpe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Gpe(t){var e=qpe(t,"string");return typeof e=="symbol"?e:e+""}function qpe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Kpe extends eZ{constructor(e){let{calculationTypes:r,viewportHeight:n,scrollOffset:i,totalRows:s,defaultRowHeight:a,rowHeightFn:o,overrideFn:u,horizontalScrollbarHeight:c}=e;super(r),fo(this,"viewportHeight",0),fo(this,"scrollOffset",0),fo(this,"zeroBasedScrollOffset",0),fo(this,"totalRows",0),fo(this,"rowHeightFn",null),fo(this,"rowHeight",0),fo(this,"overrideFn",null),fo(this,"horizontalScrollbarHeight",0),fo(this,"innerViewportHeight",0),fo(this,"totalCalculatedHeight",0),fo(this,"startPositions",[]),fo(this,"needReverse",!0),this.defaultHeight=a,this.viewportHeight=n,this.scrollOffset=i,this.zeroBasedScrollOffset=Math.max(i,0),this.totalRows=s,this.rowHeightFn=o,this.overrideFn=u,this.horizontalScrollbarHeight=c??0,this.innerViewportHeight=this.zeroBasedScrollOffset+this.viewportHeight-this.horizontalScrollbarHeight,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalRows;e++)if(this.rowHeight=this.getRowHeight(e),this._process(e,this),this.startPositions.push(this.totalCalculatedHeight),this.totalCalculatedHeight+=this.rowHeight,this.totalCalculatedHeight>=this.innerViewportHeight){this.needReverse=!1;break}this._finalize(this)}getRowHeight(e){const r=this.rowHeightFn(e);return isNaN(r)?this.defaultHeight:r}}function Xpe(t,e,r){Qpe(t,e),e.set(t,r)}function Qpe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function h9(t,e,r){return(e=Zpe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Zpe(t){var e=Jpe(t,"string");return typeof e=="symbol"?e:e+""}function Jpe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function t0(t,e){return t.get(tZ(t,e))}function f9(t,e,r){return t.set(tZ(t,e),r),r}function tZ(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var gc=new WeakMap;class Ng{constructor(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;h9(this,"row",null),h9(this,"col",null),Xpe(this,gc,!1),f9(gc,this,n),typeof e<"u"&&typeof r<"u"&&(this.row=e,this.col=r)}isValid(e){const{countRows:r,countCols:n,countRowHeaders:i,countColHeaders:s}={countRows:0,countCols:0,countRowHeaders:0,countColHeaders:0,...e};return!(!Number.isInteger(this.row)||!Number.isInteger(this.col)||this.row<-s||this.col<-i||this.row>=r||this.col>=n)}isEqual(e){return e===this?!0:this.row===e.row&&this.col===e.col}isHeader(){return!this.isCell()}isCell(){return this.row>=0&&this.col>=0}isRtl(){return t0(gc,this)}isSouthEastOf(e){return this.row>=e.row&&(t0(gc,this)?this.col<=e.col:this.col>=e.col)}isNorthWestOf(e){return this.row<=e.row&&(t0(gc,this)?this.col>=e.col:this.col<=e.col)}isSouthWestOf(e){return this.row>=e.row&&(t0(gc,this)?this.col>=e.col:this.col<=e.col)}isNorthEastOf(e){return this.row<=e.row&&(t0(gc,this)?this.col<=e.col:this.col>=e.col)}normalize(){return this.row=this.row===null?this.row:Math.max(this.row,0),this.col=this.col===null?this.col:Math.max(this.col,0),this}assign(e){return Number.isInteger(e?.row)&&(this.row=e.row),Number.isInteger(e?.col)&&(this.col=e.col),e instanceof Ng&&f9(gc,this,e.isRtl()),this}clone(){return new Ng(this.row,this.col,t0(gc,this))}toObject(){return{row:this.row,col:this.col}}}function eve(t,e,r){tve(t,e),e.set(t,r)}function tve(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function JD(t,e,r){return(e=rve(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function rve(t){var e=nve(t,"string");return typeof e=="symbol"?e:e+""}function nve(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function go(t,e){return t.get(rZ(t,e))}function ive(t,e,r){return t.set(rZ(t,e),r),r}function rZ(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var ta=new WeakMap;class ES{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;JD(this,"highlight",null),JD(this,"from",null),JD(this,"to",null),eve(this,ta,!1),this.highlight=e.clone(),this.from=r.clone(),this.to=n.clone(),ive(ta,this,i)}setHighlight(e){return this.highlight=e.clone(),this}setFrom(e){return this.from=e.clone(),this}setTo(e){return this.to=e.clone(),this}normalize(){return this.highlight.normalize(),this.from.normalize(),this.to.normalize(),this}isValid(e){return this.from.isValid(e)&&this.to.isValid(e)}isSingle(){return this.isSingleCell()||this.isSingleHeader()}isSingleCell(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}isSingleHeader(){return(this.from.row<0||this.from.col<0)&&this.from.row===this.to.row&&this.from.col===this.to.col}isHeader(){return this.from.isHeader()&&this.to.isHeader()?!0:this.from.col<0&&this.to.col<0||this.from.row<0&&this.to.row<0}containsHeaders(){return this.from.isHeader()||this.to.isHeader()}getOuterHeight(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}getOuterWidth(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}getHeight(){if(this.from.row<0&&this.to.row<0)return 0;const e=Math.max(this.from.row,0),r=Math.max(this.to.row,0);return Math.max(e,r)-Math.min(e,r)+1}getWidth(){if(this.from.col<0&&this.to.col<0)return 0;const e=Math.max(this.from.col,0),r=Math.max(this.to.col,0);return Math.max(e,r)-Math.min(e,r)+1}getCellsCount(){return this.getWidth()*this.getHeight()}includes(e){const{row:r,col:n}=e,i=this.getOuterTopStartCorner(),s=this.getOuterBottomEndCorner();return i.row<=r&&s.row>=r&&i.col<=n&&s.col>=n}includesRange(e){return this.includes(e.getOuterTopStartCorner())&&this.includes(e.getOuterBottomEndCorner())}isEqual(e){return Math.min(this.from.row,this.to.row)===Math.min(e.from.row,e.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(e.from.row,e.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(e.from.col,e.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(e.from.col,e.to.col)}overlaps(e){return e.isSouthEastOf(this.getOuterTopLeftCorner())&&e.isNorthWestOf(this.getOuterBottomRightCorner())}isSouthEastOf(e){return this.getOuterTopLeftCorner().isSouthEastOf(e)||this.getOuterBottomRightCorner().isSouthEastOf(e)}isNorthWestOf(e){return this.getOuterTopLeftCorner().isNorthWestOf(e)||this.getOuterBottomRightCorner().isNorthWestOf(e)}isOverlappingHorizontally(e){return this.getOuterTopEndCorner().col>=e.getOuterTopStartCorner().col&&this.getOuterTopEndCorner().col<=e.getOuterTopEndCorner().col||this.getOuterTopStartCorner().col<=e.getOuterTopEndCorner().col&&this.getOuterTopStartCorner().col>=e.getOuterTopStartCorner().col}isOverlappingVertically(e){return this.getOuterBottomStartCorner().row>=e.getOuterTopRightCorner().row&&this.getOuterBottomStartCorner().row<=e.getOuterBottomStartCorner().row||this.getOuterTopEndCorner().row<=e.getOuterBottomStartCorner().row&&this.getOuterTopEndCorner().row>=e.getOuterTopRightCorner().row}expand(e){const r=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner();return e.row<r.row||e.col<r.col||e.row>n.row||e.col>n.col?(this.from=this._createCellCoords(Math.min(r.row,e.row),Math.min(r.col,e.col)),this.to=this._createCellCoords(Math.max(n.row,e.row),Math.max(n.col,e.col)),!0):!1}expandByRange(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(this.includesRange(e)||!this.overlaps(e))return!1;const n=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner(),s=this.getDirection(),a=e.getOuterTopStartCorner(),o=e.getOuterBottomEndCorner(),u=Math.min(n.row,a.row),c=Math.min(n.col,a.col),f=Math.max(i.row,o.row),g=Math.max(i.col,o.col),m=this._createCellCoords(u,c),v=this._createCellCoords(f,g);return this.from=m,this.to=v,this.setDirection(s),r&&(this.highlight.row===this.getOuterBottomRightCorner().row&&this.getVerticalDirection()==="N-S"&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&this.getHorizontalDirection()==="W-E"&&this.flipDirectionHorizontally()),!0}getDirection(){if(this.from.isNorthWestOf(this.to))return"NW-SE";if(this.from.isNorthEastOf(this.to))return"NE-SW";if(this.from.isSouthEastOf(this.to))return"SE-NW";if(this.from.isSouthWestOf(this.to))return"SW-NE"}setDirection(e){switch(e){case"NW-SE":[this.from,this.to]=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];break;case"NE-SW":[this.from,this.to]=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];break;case"SE-NW":[this.from,this.to]=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];break;case"SW-NE":[this.from,this.to]=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];break}}getVerticalDirection(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}getHorizontalDirection(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}flipDirectionVertically(){switch(this.getDirection()){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break}}flipDirectionHorizontally(){switch(this.getDirection()){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break}}getTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getTopLeftCorner(){return go(ta,this)?this.getTopEndCorner():this.getTopStartCorner()}getBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getBottomRightCorner(){return go(ta,this)?this.getBottomStartCorner():this.getBottomEndCorner()}getTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getTopRightCorner(){return go(ta,this)?this.getTopStartCorner():this.getTopEndCorner()}getBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getBottomLeftCorner(){return go(ta,this)?this.getBottomEndCorner():this.getBottomStartCorner()}getOuterTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterTopLeftCorner(){return go(ta,this)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}getOuterBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterBottomRightCorner(){return go(ta,this)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}getOuterTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterTopRightCorner(){return go(ta,this)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}getOuterBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterBottomLeftCorner(){return go(ta,this)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}isCorner(e){return e.isEqual(this.getOuterTopLeftCorner())||e.isEqual(this.getOuterTopRightCorner())||e.isEqual(this.getOuterBottomLeftCorner())||e.isEqual(this.getOuterBottomRightCorner())}getOppositeCorner(e){if(!(e instanceof Ng))return!1;if(e.isEqual(this.getOuterBottomEndCorner()))return this.getOuterTopStartCorner();if(e.isEqual(this.getOuterTopStartCorner()))return this.getOuterBottomEndCorner();if(e.isEqual(this.getOuterTopEndCorner()))return this.getOuterBottomStartCorner();if(e.isEqual(this.getOuterBottomStartCorner()))return this.getOuterTopEndCorner()}getBordersSharedWith(e){if(!this.includesRange(e))return[];const r={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},n={top:Math.min(e.from.row,e.to.row),bottom:Math.max(e.from.row,e.to.row),left:Math.min(e.from.col,e.to.col),right:Math.max(e.from.col,e.to.col)},i=[];return r.top===n.top&&i.push("top"),r.right===n.right&&i.push(go(ta,this)?"left":"right"),r.bottom===n.bottom&&i.push("bottom"),r.left===n.left&&i.push(go(ta,this)?"right":"left"),i}getInner(){const e=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner(),n=[];for(let i=e.row;i<=r.row;i++)for(let s=e.col;s<=r.col;s++)!(this.from.row===i&&this.from.col===s)&&!(this.to.row===i&&this.to.col===s)&&n.push(this._createCellCoords(i,s));return n}getAll(){const e=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner(),n=[];for(let i=e.row;i<=r.row;i++)for(let s=e.col;s<=r.col;s++)e.row===i&&e.col===s?n.push(e):r.row===i&&r.col===s?n.push(r):n.push(this._createCellCoords(i,s));return n}forAll(e){const r=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner();for(let i=r.row;i<=n.row;i++)for(let s=r.col;s<=n.col;s++)if(e(i,s)===!1)return}clone(){return new ES(this.highlight,this.from,this.to,go(ta,this))}toObject(){return{from:this.from.toObject(),to:this.to.toObject()}}_createCellCoords(e,r){return new Ng(e,r,go(ta,this))}}function Yl(t,e,r){sve(t,e),e.set(t,r)}function sve(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ft(t,e){return t.get(nZ(t,e))}function Vh(t,e,r){return t.set(nZ(t,e),r),r}function nZ(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var mo=new WeakMap,e2=new WeakMap,Vi=new WeakMap,r0=new WeakMap,pC=new WeakMap,ll=new WeakMap,t2=new WeakMap,Aw=new WeakMap,Rd=new WeakMap,zl=new WeakMap;let iZ=class{constructor(e,r,n,i,s,a){let o=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;Yl(this,mo,void 0),Yl(this,e2,void 0),Yl(this,Vi,void 0),Yl(this,r0,void 0),Yl(this,pC,void 0),Yl(this,ll,void 0),Yl(this,t2,void 0),Yl(this,Aw,void 0),Yl(this,Rd,[null,null]),Yl(this,zl,[null,null]),Vh(mo,this,n),Vh(e2,this,r),Vh(Vi,this,s),Vh(r0,this,a),Vh(pC,this,o),Vh(ll,this,i),Vh(t2,this,e),this.registerEvents()}registerEvents(){ft(ll,this).addEventListener(ft(Vi,this).holder,"contextmenu",n=>this.onContextMenu(n)),ft(ll,this).addEventListener(ft(Vi,this).TABLE,"mouseover",n=>this.onMouseOver(n)),ft(ll,this).addEventListener(ft(Vi,this).TABLE,"mouseout",n=>this.onMouseOut(n));const e=()=>{ft(ll,this).addEventListener(ft(Vi,this).holder,"touchstart",n=>this.onTouchStart(n)),ft(ll,this).addEventListener(ft(Vi,this).holder,"touchend",n=>this.onTouchEnd(n)),this.momentumScrolling||(this.momentumScrolling={}),ft(ll,this).addEventListener(ft(Vi,this).holder,"scroll",()=>{clearTimeout(this.momentumScrolling._timeout),this.momentumScrolling.ongoing||ft(mo,this).getSetting("onBeforeTouchScroll"),this.momentumScrolling.ongoing=!0,this.momentumScrolling._timeout=setTimeout(()=>{this.touchApplied||(this.momentumScrolling.ongoing=!1,ft(mo,this).getSetting("onAfterMomentumScroll"))},200)})},r=()=>{ft(ll,this).addEventListener(ft(Vi,this).holder,"mouseup",n=>this.onMouseUp(n)),ft(ll,this).addEventListener(ft(Vi,this).holder,"mousedown",n=>this.onMouseDown(n))};_l()?e():(yF()&&e(),r())}selectedCellWasTouched(e){const n=this.parentCell(e).coords;if(ft(Aw,this)&&n){const[i,s]=[n.row,ft(Aw,this).from.row],[a,o]=[n.col,ft(Aw,this).from.col];return i===s&&a===o}return!1}parentCell(e){const r={},n=ft(Vi,this).TABLE,i=Sy(e,["TD","TH"],n);return i?(r.coords=ft(Vi,this).getCoords(i),r.TD=i):Ct(e,"wtBorder")&&Ct(e,"current")?(r.coords=ft(r0,this).getFocusSelection().cellRange.highlight,r.TD=ft(Vi,this).getCell(r.coords)):Ct(e,"wtBorder")&&Ct(e,"area")&&ft(r0,this).getAreaSelection().cellRange&&(r.coords=ft(r0,this).getAreaSelection().cellRange.to,r.TD=ft(Vi,this).getCell(r.coords)),r}onMouseDown(e){const r=ft(e2,this).rootDocument.activeElement,n=IF(bQ,e.target),i=e.target;if(!["TD","TH"].includes(r.nodeName)&&(i===r||n(0)===r||n(1)===r))return;const s=this.parentCell(i);Ct(i,"corner")?ft(mo,this).getSetting("onCellCornerMouseDown",e,i):s.TD&&ft(mo,this).has("onCellMouseDown")&&this.callListener("onCellMouseDown",e,s.coords,s.TD),(e.button===0||this.touchApplied)&&s.TD&&(ft(zl,this)[0]=s.TD,clearTimeout(ft(Rd,this)[0]),ft(Rd,this)[0]=setTimeout(()=>{ft(zl,this)[0]=null},1e3))}onContextMenu(e){if(ft(mo,this).has("onCellContextMenu")){const r=this.parentCell(e.target);r.TD&&this.callListener("onCellContextMenu",e,r.coords,r.TD)}}onMouseOver(e){if(!ft(mo,this).has("onCellMouseOver"))return;const r=ft(Vi,this).TABLE,n=Sy(e.target,["TD","TH"],r),i=ft(pC,this)||this;n&&n!==i.lastMouseOver&&kf(n,r)&&(i.lastMouseOver=n,this.callListener("onCellMouseOver",e,ft(Vi,this).getCoords(n),n))}onMouseOut(e){if(!ft(mo,this).has("onCellMouseOut"))return;const r=ft(Vi,this).TABLE,n=Sy(e.target,["TD","TH"],r),i=Sy(e.relatedTarget,["TD","TH"],r),s=ft(pC,this)||this;n&&n!==i&&kf(n,r)&&(this.callListener("onCellMouseOut",e,ft(Vi,this).getCoords(n),n),i===null&&(s.lastMouseOver=null))}onMouseUp(e){const r=this.parentCell(e.target);r.TD&&ft(mo,this).has("onCellMouseUp")&&this.callListener("onCellMouseUp",e,r.coords,r.TD),!(e.button!==0&&!this.touchApplied)&&(r.TD===ft(zl,this)[0]&&r.TD===ft(zl,this)[1]?(Ct(e.target,"corner")?this.callListener("onCellCornerDblClick",e,r.coords,r.TD):this.callListener("onCellDblClick",e,r.coords,r.TD),ft(zl,this)[0]=null,ft(zl,this)[1]=null):r.TD===ft(zl,this)[0]&&(ft(zl,this)[1]=r.TD,clearTimeout(ft(Rd,this)[1]),ft(Rd,this)[1]=setTimeout(()=>{ft(zl,this)[1]=null},500)))}onTouchStart(e){Vh(Aw,this,ft(r0,this).getFocusSelection().cellRange),this.touchApplied=!0,this.onMouseDown(e)}onTouchEnd(e){var r;const n=e.target,i=(r=this.parentCell(n))===null||r===void 0?void 0:r.coords,s=it(i)&&i.row>=0&&i.col>=0;if(e.cancelable&&s&&ft(mo,this).getSetting("isDataViewInstance")){const o=["A","BUTTON","INPUT"];bF()&&(wQ()||yQ())&&this.selectedCellWasTouched(n)&&!o.includes(n.tagName)?e.preventDefault():this.selectedCellWasTouched(n)||e.preventDefault()}this.onMouseUp(e),this.touchApplied=!1}callListener(e,r,n,i){const s=ft(mo,this).getSettingPure(e);s&&s(r,n,i,ft(t2,this).call(this))}destroy(){clearTimeout(ft(Rd,this)[0]),clearTimeout(ft(Rd,this)[1]),ft(ll,this).destroy()}};function r2(t,e,r){return(e=ave(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ave(t){var e=ove(t,"string");return typeof e=="symbol"?e:e+""}function ove(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class lve{constructor(e,r,n){r2(this,"offset",void 0),r2(this,"total",void 0),r2(this,"countTH",void 0),this.offset=e,this.total=r,this.countTH=n}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleRowHeadedColumnToSourceColumn(e){return this.renderedToSource(this.offsettedTH(e))}sourceColumnToVisibleRowHeadedColumn(e){return this.unOffsettedTH(this.sourceToRendered(e))}}function n2(t,e,r){return(e=uve(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function uve(t){var e=cve(t,"string");return typeof e=="symbol"?e:e+""}function cve(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class hve{constructor(e,r,n){n2(this,"offset",void 0),n2(this,"total",void 0),n2(this,"countTH",void 0),this.offset=e,this.total=r,this.countTH=n}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleColHeadedRowToSourceRow(e){return this.renderedToSource(this.offsettedTH(e))}sourceRowToVisibleColHeadedRow(e){return this.unOffsettedTH(this.sourceToRendered(e))}}function vC(t,e,r){return(e=fve(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function fve(t){var e=dve(t,"string");return typeof e=="symbol"?e:e+""}function dve(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class gve{constructor(){vC(this,"currentSize",0),vC(this,"nextSize",0),vC(this,"currentOffset",0),vC(this,"nextOffset",0)}setSize(e){this.currentSize=this.nextSize,this.nextSize=e}setOffset(e){this.currentOffset=this.nextOffset,this.nextOffset=e}}const mve=0,d9=1,cN=2;function i2(t,e,r){return(e=pve(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function pve(t){var e=vve(t,"string");return typeof e=="symbol"?e:e+""}function vve(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class wve{constructor(){i2(this,"size",new gve),i2(this,"workingSpace",mve),i2(this,"sharedSize",null)}setSize(e){this.size.setSize(e)}setOffset(e){this.size.setOffset(e)}getViewSize(){return this.size}isShared(){return this.sharedSize!==null}isPlaceOn(e){return this.workingSpace===e}append(e){this.workingSpace=d9,e.workingSpace=cN,this.sharedSize=e.getViewSize()}prepend(e){this.workingSpace=cN,e.workingSpace=d9,this.sharedSize=e.getViewSize()}}var g9={},s2,m9;function yve(){if(m9)return s2;m9=1;var t=_R(),e=TypeError;return s2=function(r,n){if(!delete r[n])throw new e("Cannot delete property "+t(n)+" of "+t(r))},s2}var p9;function Sve(){if(p9)return g9;p9=1;var t=nn(),e=Qp(),r=Jp(),n=jK(),i=yve(),s=YK(),a=[].unshift(0)!==1,o=function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(c){return c instanceof TypeError}},u=a||!o();return t({target:"Array",proto:!0,arity:1,forced:u},{unshift:function(f){var g=e(this),m=r(g),v=arguments.length;if(v){s(m+v);for(var w=m;w--;){var y=w+v;w in g?g[y]=g[w]:i(g,y)}for(var b=0;b<v;b++)g[b]=arguments[b]}return n(g,m+v)}}),g9}Sve();function bve(t,e,r){return(e=Cve(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Cve(t){var e=xve(t,"string");return typeof e=="symbol"?e:e+""}function xve(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class v9{constructor(e,r){bve(this,"order",[]),this.order=[...Array(r).keys()].map(n=>e+n)}get length(){return this.order.length}has(e){return this.order.indexOf(e)>-1}get(e){return e<this.order.length?this.order[e]:-1}remove(e){this.order.splice(this.order.indexOf(e),1)}prepend(e){return this.order.unshift(e),this.order.pop()}}function Eve(t,e,r){return(e=_ve(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _ve(t){var e=Rve(t,"string");return typeof e=="symbol"?e:e+""}function Rve(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Tve{constructor(e){Eve(this,"sizeSet",void 0),this.sizeSet=e}diff(){const{sizeSet:e}=this,{currentSize:r,nextSize:n}=e.getViewSize();let i=Math.max(n,r);if(i===0)return[];const{currentOffset:s,nextOffset:a}=e.getViewSize(),o=new v9(s,r),u=new v9(a,n),c=[];for(let f=0;f<i;f++){const g=o.get(f),m=u.get(f);if(m===-1)c.push(["remove",g]);else if(g===-1)!e.isShared()||e.isShared()&&e.isPlaceOn(cN)?c.push(["append",m]):c.push(["prepend",m]);else if(m>g)o.has(m)&&(o.remove(m),n<=o.length&&(i-=1)),c.push(["replace",m,g]);else if(m<g){const v=o.prepend(m);c.push(["insert_before",m,g,v])}else c.push(["none",m])}return c}}function n0(t,e,r){return(e=Mve(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Mve(t){var e=Ave(t,"string");return typeof e=="symbol"?e:e+""}function Ave(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class sZ{constructor(e,r){n0(this,"rootNode",void 0),n0(this,"nodesPool",void 0),n0(this,"sizeSet",new wve),n0(this,"collectedNodes",[]),n0(this,"viewDiffer",new Tve(this.sizeSet)),n0(this,"leads",[]),this.rootNode=e,this.nodesPool=r}setSize(e){return this.sizeSet.setSize(e),this}setOffset(e){return this.sizeSet.setOffset(e),this}isSharedViewSet(){return this.sizeSet.isShared()}getNode(e){return e<this.collectedNodes.length?this.collectedNodes[e]:null}getCurrentNode(){const e=this.collectedNodes.length;return e>0?this.collectedNodes[e-1]:null}applyCommand(e){const{rootNode:r}=this,[n,i,s,a]=e,o=this.nodesPool(i);switch(this.collectedNodes.push(o),n){case"prepend":r.insertBefore(o,r.firstChild);break;case"append":r.appendChild(o);break;case"insert_before":r.insertBefore(o,this.nodesPool(s)),r.removeChild(this.nodesPool(a));break;case"replace":r.replaceChild(o,this.nodesPool(s));break;case"remove":r.removeChild(o);break}}start(){this.collectedNodes.length=0,this.leads=this.viewDiffer.diff()}render(){this.leads.length>0&&this.applyCommand(this.leads.shift())}end(){for(;this.leads.length>0;)this.applyCommand(this.leads.shift())}}class aZ extends sZ{prependView(e){return this.sizeSet.prepend(e.sizeSet),e.sizeSet.append(this.sizeSet),this}appendView(e){return this.sizeSet.append(e.sizeSet),e.sizeSet.prepend(this.sizeSet),this}}function w9(t,e,r){return(e=Ove(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Ove(t){var e=kve(t,"string");return typeof e=="symbol"?e:e+""}function kve(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Dve{constructor(e){w9(this,"nodeType",void 0),w9(this,"pool",new Map),this.nodeType=e.toUpperCase()}setRootDocument(e){this.rootDocument=e}obtain(e,r){const i=typeof r=="number"?`${e}x${r}`:e.toString();if(this.pool.has(i))return this.pool.get(i);const s=this.rootDocument.createElement(this.nodeType);return this.pool.set(i,s),s}}function Ow(t,e,r){return(e=Pve(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Pve(t){var e=Ive(t,"string");return typeof e=="symbol"?e:e+""}function Ive(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class _S{constructor(e,r){Ow(this,"nodesPool",null),Ow(this,"nodeType",void 0),Ow(this,"rootNode",void 0),Ow(this,"table",null),Ow(this,"renderedNodes",0),this.nodesPool=typeof e=="string"?new Dve(e):null,this.nodeType=e,this.rootNode=r}setTable(e){this.nodesPool&&this.nodesPool.setRootDocument(e.rootDocument),this.table=e}adjust(){}render(){}}function y9(t,e,r){return(e=Nve(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Nve(t){var e=Hve(t,"string");return typeof e=="symbol"?e:e+""}function Hve(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Fve extends _S{constructor(){super("TH"),y9(this,"orderViews",new WeakMap),y9(this,"sourceRowIndex",0)}obtainOrderView(e){let r;return this.orderViews.has(e)?r=this.orderViews.get(e):(r=new aZ(e,n=>this.nodesPool.obtain(this.sourceRowIndex,n)),this.orderViews.set(e,r)),r}render(){const{rowsToRender:e,rowHeaderFunctions:r,rowHeadersCount:n,rows:i,cells:s}=this.table;for(let a=0;a<e;a++){const o=this.table.renderedRowToSource(a),u=i.getRenderedNode(a);this.sourceRowIndex=o;const c=this.obtainOrderView(u),f=s.obtainOrderView(u);c.appendView(f).setSize(n).setOffset(0).start();for(let g=n-1;g>=0;g--){c.render();const m=c.getCurrentNode();m.className="",m.removeAttribute("style"),am(m,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&bt(m,[Sme(),Ame(),vF(g+1),Zf(-1)]),r[g](o,m,g)}c.end()}}}class Lve extends _S{constructor(e){super(null,e)}adjust(){const{columnHeadersCount:e,rowHeadersCount:r}=this.table;let n=this.rootNode.firstChild;if(e){const{columnsToRender:i}=this.table,s=i+r;for(let o=0,u=e;o<u;o++){for(n=this.rootNode.childNodes[o],n||(n=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(n)),this.renderedNodes=n.childNodes.length;this.renderedNodes<s;)n.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>s;)n.removeChild(n.lastChild),this.renderedNodes-=1}const a=this.rootNode.childNodes.length;if(a>e)for(let o=e;o<a;o++)this.rootNode.removeChild(this.rootNode.lastChild)}else n&&Bu(n)}render(){const{columnHeadersCount:e}=this.table;this.table.isAriaEnabled()&&bt(this.rootNode,[sQ()]);for(let r=0;r<e;r+=1){const{columnHeaderFunctions:n,columnsToRender:i,rowHeadersCount:s}=this.table,a=this.rootNode.childNodes[r];this.table.isAriaEnabled()&&bt(a,[aQ(),cQ(r+1)]);for(let o=-1*s;o<i;o+=1){const u=this.table.renderedColumnToSource(o),c=a.childNodes[o+s];c.className="",c.removeAttribute("style"),am(c,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&bt(c,[vF(o+1+this.table.rowHeadersCount),Zf(-1),bme(),...o>=0?[Mme()]:[yme(),Rp("Select whole grid")]]),n[r](u,c,r)}}}}let S9=!1;class Bve extends _S{constructor(e){super(null,e)}adjust(){const{columnsToRender:e,rowHeadersCount:r}=this.table,n=e+r;for(;this.renderedNodes<n;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>n;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}render(){this.adjust();const{columnsToRender:e,rowHeadersCount:r}=this.table;!S9&&e>1e3&&(S9=!0,br(Dr`Performance tip: Handsontable rendered more than 1000 visible columns.\x20
        Consider limiting the number of rendered columns by specifying the table width and/or\x20
        turning off the "renderAllColumns" option.`));for(let i=0;i<r;i++){const s=this.table.renderedColumnToSource(i),a=this.table.columnUtils.getHeaderWidth(s);this.rootNode.childNodes[i].style.width=`${a}px`}for(let i=0;i<e;i++){const s=this.table.renderedColumnToSource(i),a=this.table.columnUtils.getWidth(s);this.rootNode.childNodes[i+r].style.width=`${a}px`}const n=this.rootNode.firstChild;n&&Ve(n,"rowHeader")}}function Vve(t,e,r){return(e=Wve(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Wve(t){var e=$ve(t,"string");return typeof e=="symbol"?e:e+""}function $ve(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const i0={rowEven:"ht__row_even",rowOdd:"ht__row_odd"};let b9=!1;class Uve extends _S{constructor(e){super("TR",e),Vve(this,"orderView",void 0),this.orderView=new sZ(e,r=>this.nodesPool.obtain(r))}getRenderedNode(e){return this.orderView.getNode(e)}hasStaleContent(e){return this.orderView.hasStaleContent(e)}render(){const{rowsToRender:e}=this.table;!b9&&e>1e3&&(b9=!0,br(Dr`Performance tip: Handsontable rendered more than 1000 visible rows.\x20
        Consider limiting the number of rendered rows by specifying the table height and/or\x20
        turning off the "renderAllRows" option.`)),this.table.isAriaEnabled()&&bt(this.rootNode,[sQ()]),this.orderView.setSize(e).setOffset(this.table.renderedRowToSource(0)).start();for(let i=0;i<e;i++){this.orderView.render();const s=this.orderView.getCurrentNode(),a=this.table.renderedRowToSource(i);if(this.table.isAriaEnabled()){var r,n;bt(s,[aQ(),cQ(a+((r=(n=this.table.rowUtils)===null||n===void 0||(n=n.dataAccessObject)===null||n===void 0?void 0:n.columnHeaders.length)!==null&&r!==void 0?r:0)+1)])}(a+1)%2===0?Ct(s,i0.rowEven)||(wt(s,i0.rowOdd),Ve(s,i0.rowEven)):Ct(s,i0.rowOdd)||(wt(s,i0.rowEven),Ve(s,i0.rowOdd))}this.orderView.end()}}function C9(t,e,r){return(e=jve(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function jve(t){var e=Yve(t,"string");return typeof e=="symbol"?e:e+""}function Yve(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class zve extends _S{constructor(){super("TD"),C9(this,"orderViews",new WeakMap),C9(this,"sourceRowIndex",0)}obtainOrderView(e){let r;return this.orderViews.has(e)?r=this.orderViews.get(e):(r=new aZ(e,n=>this.nodesPool.obtain(this.sourceRowIndex,n),this.nodeType),this.orderViews.set(e,r)),r}render(){const{rowsToRender:e,columnsToRender:r,rows:n,rowHeaders:i}=this.table;for(let o=0;o<e;o++){const u=this.table.renderedRowToSource(o),c=n.getRenderedNode(o);this.sourceRowIndex=u;const f=this.obtainOrderView(c),g=i.obtainOrderView(c);f.prependView(g).setSize(r).setOffset(0).start();for(let m=0;m<r;m++){f.render();const v=this.table.renderedColumnToSource(m),w=f.getCurrentNode();if(Ct(w,"hide")||(w.className=""),w.removeAttribute("style"),w.removeAttribute("dir"),am(w,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.cellRenderer(u,v,w),this.table.isAriaEnabled()){var s,a;bt(w,[...w.hasAttribute("role")?[]:[wme()],Zf(-1),vF(v+((s=(a=this.table.rowUtils)===null||a===void 0||(a=a.dataAccessObject)===null||a===void 0?void 0:a.rowHeaders.length)!==null&&s!==void 0?s:0)+1)])}}f.end()}}}function mi(t,e,r){return(e=Gve(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Gve(t){var e=qve(t,"string");return typeof e=="symbol"?e:e+""}function qve(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Kve{constructor(e){let{cellRenderer:r,stylesHandler:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};mi(this,"rootNode",void 0),mi(this,"rootDocument",void 0),mi(this,"rowHeaders",null),mi(this,"columnHeaders",null),mi(this,"colGroup",null),mi(this,"rows",null),mi(this,"cells",null),mi(this,"rowFilter",null),mi(this,"columnFilter",null),mi(this,"rowUtils",null),mi(this,"columnUtils",null),mi(this,"rowsToRender",0),mi(this,"columnsToRender",0),mi(this,"rowHeaderFunctions",[]),mi(this,"rowHeadersCount",0),mi(this,"columnHeaderFunctions",[]),mi(this,"columnHeadersCount",0),mi(this,"cellRenderer",void 0),mi(this,"activeOverlayName",void 0),mi(this,"stylesHandler",void 0),this.rootNode=e,this.rootDocument=this.rootNode.ownerDocument,this.cellRenderer=r,this.stylesHandler=n}setActiveOverlayName(e){this.activeOverlayName=e}setAxisUtils(e,r){this.rowUtils=e,this.columnUtils=r}setViewportSize(e,r){this.rowsToRender=e,this.columnsToRender=r}setFilters(e,r){this.rowFilter=e,this.columnFilter=r}setHeaderContentRenderers(e,r){this.rowHeaderFunctions=e,this.rowHeadersCount=e.length,this.columnHeaderFunctions=r,this.columnHeadersCount=r.length}setRenderers(){let{rowHeaders:e,columnHeaders:r,colGroup:n,rows:i,cells:s}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};e.setTable(this),r.setTable(this),n.setTable(this),i.setTable(this),s.setTable(this),this.rowHeaders=e,this.columnHeaders=r,this.colGroup=n,this.rows=i,this.cells=s}renderedRowToSource(e){return this.rowFilter.renderedToSource(e)}renderedColumnToSource(e){return this.columnFilter.renderedToSource(e)}isAriaEnabled(){return this.rowUtils.wtSettings.getSetting("ariaTags")}render(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();const{rowsToRender:e,rows:r}=this;for(let n=0;n<e;n++){const i=r.getRenderedNode(n),s=this.rowUtils;if(i.firstChild){const a=this.renderedRowToSource(n),o=s.getHeightByOverlayName(a,this.activeOverlayName),c=this.stylesHandler.areCellsBorderBox()?0:1;o?i.firstChild.style.height=`${o-c}px`:i.firstChild.style.height=""}}}}class Xve{constructor(){let{TABLE:e,THEAD:r,COLGROUP:n,TBODY:i,rowUtils:s,columnUtils:a,cellRenderer:o,stylesHandler:u}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.renderer=new Kve(e,{cellRenderer:o,stylesHandler:u}),this.renderer.setRenderers({rowHeaders:new Fve,columnHeaders:new Lve(r),colGroup:new Bve(n),rows:new Uve(i),cells:new zve}),this.renderer.setAxisUtils(s,a)}setActiveOverlayName(e){return this.renderer.setActiveOverlayName(e),this}setFilters(e,r){return this.renderer.setFilters(e,r),this}setViewportSize(e,r){return this.renderer.setViewportSize(e,r),this}setHeaderContentRenderers(e,r){return this.renderer.setHeaderContentRenderers(e,r),this}adjust(){this.renderer.adjust()}render(){this.renderer.render()}}function a2(t,e,r){return(e=Qve(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Qve(t){var e=Zve(t,"string");return typeof e=="symbol"?e:e+""}function Zve(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Jve{constructor(e,r){a2(this,"dataAccessObject",void 0),a2(this,"wtSettings",void 0),a2(this,"headerWidths",new Map),this.dataAccessObject=e,this.wtSettings=r}getWidth(e){return this.wtSettings.getSetting("columnWidth",e)||this.wtSettings.getSetting("defaultColumnWidth")}getHeaderHeight(e){let r=this.wtSettings.getSetting("stylesHandler").getDefaultRowHeight();const n=this.dataAccessObject.wtViewport.oversizedColumnHeaders[e];return n!==void 0&&(r=r?Math.max(r,n):n),r}getHeaderWidth(e){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(e))}calculateWidths(){const{wtSettings:e}=this;let r=e.getSetting("rowHeaderWidth");if(r=e.getSetting("onModifyRowHeaderWidth",r),r!=null){const n=e.getSetting("rowHeaders").length,i=e.getSetting("defaultColumnWidth");for(let s=0;s<n;s++){let a=Array.isArray(r)?r[s]:r;a=a??i,this.headerWidths.set(s,a)}}}}function x9(t,e,r){return(e=ewe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ewe(t){var e=twe(t,"string");return typeof e=="symbol"?e:e+""}function twe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class rwe{constructor(e,r){x9(this,"dataAccessObject",void 0),x9(this,"wtSettings",void 0),this.dataAccessObject=e,this.wtSettings=r}getHeight(e){let r=this.wtSettings.getSetting("rowHeight",e);const n=this.dataAccessObject.wtViewport.oversizedRows[e];return n!==void 0&&(r=r===void 0?n:Math.max(r,n)),r}getHeightByOverlayName(e,r){let n=this.wtSettings.getSetting("rowHeightByOverlayName",e,r);const i=this.dataAccessObject.wtViewport.oversizedRows[e];return i!==void 0&&(n=n===void 0?i:Math.max(n,i)),n}}function Gl(t,e,r){return(e=nwe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function nwe(t){var e=iwe(t,"string");return typeof e=="symbol"?e:e+""}function iwe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class av{constructor(e,r,n,i,s){Gl(this,"wtSettings",null),Gl(this,"domBindings",void 0),Gl(this,"TBODY",null),Gl(this,"THEAD",null),Gl(this,"COLGROUP",null),Gl(this,"hasTableHeight",!0),Gl(this,"hasTableWidth",!0),Gl(this,"isTableVisible",!1),Gl(this,"tableOffset",0),Gl(this,"holderOffset",0),this.domBindings=n,this.isMaster=s==="master",this.name=s,this.dataAccessObject=e,this.facadeGetter=r,this.wtSettings=i,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=n.rootTable,xF(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;const a=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",()=>this._modifyRowHeaderWidth(a)),this.rowUtils=new rwe(this.dataAccessObject,this.wtSettings),this.columnUtils=new Jve(this.dataAccessObject,this.wtSettings),this.tableRenderer=new Xve({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer"),stylesHandler:this.wtSettings.getSetting("stylesHandler")})}is(e){return this.name===e}fixTableDomTree(){const e=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=e.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=e.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=e.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}createSpreader(e){const r=e.parentNode;let n;return(!r||r.nodeType!==Node.ELEMENT_NODE||!Ct(r,"wtHolder"))&&(n=this.domBindings.rootDocument.createElement("div"),n.className="wtSpreader",r&&r.insertBefore(n,e),n.appendChild(e)),n.style.position="relative",this.wtSettings.getSetting("ariaTags")&&bt(n,[Lc()]),n}createHider(e){const r=e.parentNode;let n;return(!r||r.nodeType!==Node.ELEMENT_NODE||!Ct(r,"wtHolder"))&&(n=this.domBindings.rootDocument.createElement("div"),n.className="wtHider",r&&r.insertBefore(n,e),n.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&bt(n,[Lc()]),n}createHolder(e){const r=e.parentNode;let n;return(!r||r.nodeType!==Node.ELEMENT_NODE||!Ct(r,"wtHolder"))&&(n=this.domBindings.rootDocument.createElement("div"),n.style.position="relative",n.className="wtHolder",this.isMaster&&bt(n,[Zf(-1)]),r&&r.insertBefore(n,e),this.isMaster&&(n.parentNode.className+="ht_master handsontable",n.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr"),this.wtSettings.getSetting("ariaTags")&&bt(n.parentNode,[Lc()])),n.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&bt(n,[Lc()]),n}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:r}=this,{wtOverlays:n,wtViewport:i}=this.dataAccessObject,s=r.getSetting("totalRows"),a=r.getSetting("totalColumns"),o=r.getSetting("rowHeaders"),u=o.length,c=r.getSetting("columnHeaders"),f=c.length;let g=e;if(this.isMaster&&(n.beforeDraw(),this.holderOffset=ns(this.holder),g=i.createCalculators(g),u&&!r.getSetting("fixedColumnsStart"))){const v=n.inlineStartOverlay.getScrollPosition(),w=this.correctHeaderWidth;this.correctHeaderWidth=v!==0,w!==this.correctHeaderWidth&&(g=!1)}if(g)this.isMaster&&n.refresh(!0);else{this.isMaster?this.tableOffset=ns(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;const v=Math.max(this.getFirstRenderedRow(),0),w=Math.max(this.getFirstRenderedColumn(),0);this.rowFilter=new hve(v,s,f),this.columnFilter=new lve(w,a,u);let y=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();const b={};this.wtSettings.getSetting("beforeDraw",!0,b),y=b.skipRender!==!0}y&&(this.tableRenderer.setHeaderContentRenderers(o,c),(this.is(Eu)||this.is(Df))&&this.tableRenderer.setHeaderContentRenderers(o,[]),this.resetOversizedRows(),this.tableRenderer.setActiveOverlayName(this.name).setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render(),this.isMaster&&this.markOversizedColumnHeaders(),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(Eu))&&this.markOversizedRows(),this.isMaster?(this.wtSettings.getSetting("externalRowCalculator")||i.createVisibleCalculators(),n.refresh(!1),n.applyToDOM(),this.wtSettings.getSetting("onDraw",!0)):this.is(Eu)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize())}let m=!1;return this.isMaster&&(m=n.topOverlay.resetFixedPosition(),n.bottomOverlay.clone&&(m=n.bottomOverlay.resetFixedPosition()||m),m=n.inlineStartOverlay.resetFixedPosition()||m,n.topInlineStartCornerOverlay&&n.topInlineStartCornerOverlay.resetFixedPosition(),n.bottomInlineStartCornerOverlay&&n.bottomInlineStartCornerOverlay.clone&&n.bottomInlineStartCornerOverlay.resetFixedPosition()),m?(n.refreshAll(),n.adjustElementsSize()):this.dataAccessObject.selectionManager.setActiveOverlay(this.facadeGetter()).render(g),this.isMaster&&n.afterDraw(),this.dataAccessObject.drawn=!0,this}markIfOversizedColumnHeader(e){const r=this.columnFilter.renderedToSource(e);let n=this.wtSettings.getSetting("columnHeaders").length;const i=this.wtSettings.getSetting("stylesHandler").getDefaultRowHeight();let s,a,o;const u=this.wtSettings.getSetting("columnHeaderHeight")||[];for(;n;)n-=1,s=this.getColumnHeaderHeight(n),a=this.getColumnHeader(r,n),a&&(o=fp(a),(!s&&i<o||s<o)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=o),Array.isArray(u)?u[n]!==null&&u[n]!==void 0&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=u[n]):isNaN(u)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=u),this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]<(u[n]||u)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=u[n]||u))}adjustColumnHeaderHeights(){const{wtSettings:e}=this,r=this.THEAD.childNodes,n=this.dataAccessObject.wtViewport.oversizedColumnHeaders,i=e.getSetting("columnHeaders");for(let s=0,a=i.length;s<a;s++)if(n[s]){if(!r[s]||r[s].childNodes.length===0)return;r[s].childNodes[0].style.height=`${n[s]}px`}}resetOversizedRows(){const{wtSettings:e}=this,{wtViewport:r}=this.dataAccessObject;if(!(!this.isMaster&&!this.is(Eu))&&!e.getSetting("externalRowCalculator")){const n=this.getRenderedRowsCount();for(let i=0;i<n;i++){const s=this.rowFilter.renderedToSource(i);r.oversizedRows&&r.oversizedRows[s]&&(r.oversizedRows[s]=void 0)}}}getCell(e){let r=e.row,n=e.col;const i=this.wtSettings.getSetting("onModifyGetCellCoords",r,n,!this.isMaster,"render");if(i&&Array.isArray(i)&&([r,n]=i),this.isRowBeforeRenderedRows(r))return-1;if(this.isRowAfterRenderedRows(r))return-2;if(this.isColumnBeforeRenderedColumns(n))return-3;if(this.isColumnAfterRenderedColumns(n))return-4;const s=this.getRow(r);if(!s&&r>=0)throw new Error("TR was expected to be rendered but is not");const a=s.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(n)];if(!a&&n>=0)throw new Error("TD or TH was expected to be rendered but is not");return a}getRow(e){let r=null,n=null;if(e<0){var i;r=(i=this.rowFilter)===null||i===void 0?void 0:i.sourceRowToVisibleColHeadedRow(e),n=this.THEAD}else{var s;r=(s=this.rowFilter)===null||s===void 0?void 0:s.sourceToRendered(e),n=this.TBODY}return r!==void 0&&n!==void 0?n.childNodes.length<r+1?!1:n.childNodes[r]:!1}getColumnHeader(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const n=this.THEAD.childNodes[r];return n?.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]}getColumnHeaders(e){const r=[],n=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e);return this.THEAD.childNodes.forEach(i=>{const s=i.childNodes[n];s&&r.push(s)}),r}getRowHeader(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const n=this.wtSettings.getSetting("rowHeaders").length;if(r>=n)return;const i=this.rowFilter.sourceToRendered(e),s=i<0?this.rowFilter.sourceRowToVisibleColHeadedRow(e):i,o=(i<0?this.THEAD:this.TBODY).childNodes[s];return o?.childNodes[r]}getRowHeaders(e){const r=[],n=this.wtSettings.getSetting("rowHeaders").length;for(let i=0;i<n;i++){const s=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)],a=s?.childNodes[i];a&&r.push(a)}return r}getCoords(e){let r=e;if(r.nodeName!=="TD"&&r.nodeName!=="TH"&&(r=Lf(r,["TD","TH"])),r===null)return null;const n=r.parentNode;if(!n)return null;const i=n.parentNode;let s=EQ(n),a=r.cellIndex;af(Lg,r,this.wtRootElement)||af(Hg,r,this.wtRootElement)?i.nodeName==="THEAD"&&(s-=i.childNodes.length):af(Df,r,this.wtRootElement)||af(Eu,r,this.wtRootElement)?s=this.wtSettings.getSetting("totalRows")-i.childNodes.length+s:i===this.THEAD?s=this.rowFilter.visibleColHeadedRowToSourceRow(s):this.rowFilter&&(s=this.rowFilter.renderedToSource(s)),af(Lg,r,this.wtRootElement)||af(Fg,r,this.wtRootElement)||af(Df,r,this.wtRootElement)?a=this.columnFilter.offsettedTH(a):this.columnFilter&&(a=this.columnFilter.visibleRowHeadedColumnToSourceColumn(a));const o=this.wtSettings.getSetting("onModifyGetCoordsElement",s,a);return o&&Array.isArray(o)&&([s,a]=o),this.wot.createCellCoords(s,a)}markOversizedRows(){if(this.wtSettings.getSetting("externalRowCalculator"))return;let e=this.TBODY.childNodes.length;const r=this.wtSettings.getSetting("stylesHandler"),n=e*r.getDefaultRowHeight(),i=fp(this.TBODY)-1,s=r.areCellsBorderBox(),a=s?ai:fp,o=s?0:1,u=s?1:0;let c,f,g,m,v;if(!(n===i&&!this.wtSettings.getSetting("fixedRowsBottom")))for(;e;){e-=1,g=this.rowFilter.renderedToSource(e),c=this.getRowHeight(g),m=this.getTrForRow(g),v=m.querySelector("th");const w=g===0?u:0;v?f=a(v):f=a(m)-o,(!c&&r.getDefaultRowHeight()<f-w||c<f)&&(s||(f+=1),this.dataAccessObject.wtViewport.oversizedRows[g]=f)}}getTrForRow(e){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)]}isColumnHeaderRendered(e){if(e>=0)return!1;const n=this.wtSettings.getSetting("rowHeaders").length;return Math.abs(e)<=n}isRowHeaderRendered(e){if(e>=0)return!1;const n=this.wtSettings.getSetting("columnHeaders").length;return Math.abs(e)<=n}isRowBeforeRenderedRows(e){const r=this.getFirstRenderedRow();return e<0&&r<=0?!this.isRowHeaderRendered(e):e<r}isRowAfterRenderedRows(e){return e>this.getLastRenderedRow()}isColumnBeforeRenderedColumns(e){const r=this.getFirstRenderedColumn();return e<0&&r<=0?!this.isColumnHeaderRendered(e):e<r}isColumnAfterRenderedColumns(e){return this.columnFilter&&e>this.getLastRenderedColumn()}isColumnAfterViewport(e){return this.columnFilter&&e>this.getLastVisibleColumn()}isRowAfterViewport(e){return this.rowFilter&&e>this.getLastVisibleRow()}isColumnBeforeViewport(e){return this.columnFilter&&this.columnFilter.sourceToRendered(e)<0&&e>=0}isLastRowFullyVisible(){return this.getLastVisibleRow()===this.getLastRenderedRow()}isLastColumnFullyVisible(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}allRowsInViewport(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}allColumnsInViewport(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}getRowHeight(e){return this.rowUtils.getHeight(e)}getColumnHeaderHeight(e){return this.columnUtils.getHeaderHeight(e)}getColumnWidth(e){return this.columnUtils.getWidth(e)}hasDefinedSize(){return this.hasTableHeight&&this.hasTableWidth}getWidth(){return Un(this.TABLE)}getHeight(){return ai(this.TABLE)}getTotalWidth(){const e=Un(this.hider);return e!==0?e:this.getWidth()}getTotalHeight(){const e=ai(this.hider);return e!==0?e:this.getHeight()}isVisible(){return Ig(this.TABLE)}_modifyRowHeaderWidth(e){let r=kr(e)?e():null;return Array.isArray(r)?(r=[...r],r[r.length-1]=this._correctRowHeaderWidth(r[r.length-1])):r=this._correctRowHeaderWidth(r),r}_correctRowHeaderWidth(e){let r=e;return typeof e!="number"&&(r=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(r+=1),r}}const swe="stickyRowsBottom",$F={getFirstRenderedRow(){const t=this.getRenderedRowsCount();return t===0?-1:this.wtSettings.getSetting("totalRows")-t},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()===0?-1:this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){return Math.min(this.wtSettings.getSetting("totalRows"),this.wtSettings.getSetting("fixedRowsBottom"))},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return 0}};qu($F,"MIXIN_NAME",swe,{writable:!1,enumerable:!1});const awe="stickyColumnsStart",KR={getFirstRenderedColumn(){return this.getRenderedColumnsCount()===0?-1:0},getFirstVisibleColumn(){return this.getFirstRenderedColumn()},getFirstPartiallyVisibleColumn(){return this.getFirstRenderedColumn()},getLastRenderedColumn(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn(){return this.getLastRenderedColumn()},getLastPartiallyVisibleColumn(){return this.getLastRenderedColumn()},getRenderedColumnsCount(){return Math.min(this.wtSettings.getSetting("totalColumns"),this.wtSettings.getSetting("fixedColumnsStart"))},getVisibleColumnsCount(){return this.getRenderedColumnsCount()},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};qu(KR,"MIXIN_NAME",awe,{writable:!1,enumerable:!1});class UF extends av{constructor(e,r,n,i){super(e,r,n,i,Df)}}Lr(UF,$F);Lr(UF,KR);const Hg="top",Eu="bottom",Fg="inline_start",Lg="top_inline_start_corner",Df="bottom_inline_start_corner",oZ=[Hg,Eu,Fg,Lg,Df],owe=new Map([[Hg,`ht_clone_${Hg}`],[Eu,`ht_clone_${Eu}`],[Fg,`ht_clone_${Fg} ht_clone_left`],[Lg,`ht_clone_${Lg} ht_clone_top_left_corner`],[Df,`ht_clone_${Df} ht_clone_bottom_left_corner`]]);function lwe(t,e){uwe(t,e),e.add(t)}function uwe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function cwe(t,e,r){return(e=hwe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function hwe(t){var e=fwe(t,"string");return typeof e=="symbol"?e:e+""}function fwe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function wC(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var kw=new WeakSet;class dwe{constructor(e){lwe(this,kw),cwe(this,"dataAccessObject",void 0),this.dataAccessObject=e}scrollViewport(e,r,n){if(e.col<0||e.row<0)return!1;const i=this.scrollViewportHorizontally(e.col,r),s=this.scrollViewportVertically(e.row,n);return i||s}scrollViewportHorizontally(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"auto";const{drawn:n,totalColumns:i}=this.dataAccessObject;if(!n)return!1;const s=wa(r);if(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollHorizontally",e,s),!Number.isInteger(e)||e<0||e>i)return!1;r=s.value;const{fixedColumnsStart:a,inlineStartOverlay:o}=this.dataAccessObject,u=r==="auto";if(u&&e<a)return!1;const c=this.getFirstVisibleColumn(),f=this.getLastVisibleColumn();let g=!1;return(u&&(e<c||e>f)||!u)&&(g=o.scrollTo(e,u?e>=this.getLastPartiallyVisibleColumn():r==="end")),g}scrollViewportVertically(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"auto";const{drawn:n,totalRows:i}=this.dataAccessObject;if(!n)return!1;const s=wa(r);if(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollVertically",e,s),!Number.isInteger(e)||e<0||e>i)return!1;r=s.value;const{fixedRowsBottom:a,fixedRowsTop:o,topOverlay:u}=this.dataAccessObject,c=r==="auto";if(c&&(e<o||e>i-a-1))return!1;const f=this.getFirstVisibleRow(),g=this.getLastVisibleRow();let m=!1;return(c&&(e<f||e>g)||!c)&&(m=u.scrollTo(e,c?e>=this.getLastPartiallyVisibleRow():r==="bottom")),m}getFirstVisibleRow(){return this.dataAccessObject.wtTable.getFirstVisibleRow()}getLastVisibleRow(){return wC(kw,this,_9).call(this,this.dataAccessObject.wtTable.getLastVisibleRow())}getFirstPartiallyVisibleRow(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleRow()}getLastPartiallyVisibleRow(){return wC(kw,this,_9).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleRow())}getFirstVisibleColumn(){return this.dataAccessObject.wtTable.getFirstVisibleColumn()}getLastVisibleColumn(){return wC(kw,this,E9).call(this,this.dataAccessObject.wtTable.getLastVisibleColumn())}getFirstPartiallyVisibleColumn(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleColumn()}getLastPartiallyVisibleColumn(){return wC(kw,this,E9).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleColumn())}}function E9(t){const{wtSettings:e,inlineStartOverlay:r,wtTable:n,wtViewport:i,totalColumns:s,rootWindow:a}=this.dataAccessObject;if(r.mainTableScrollableElement===a){const o=e.getSetting("rtlMode");let u=null;if(o){const f=n.TABLE.getBoundingClientRect(),m=this.dataAccessObject.rootWindow.document.documentElement.offsetWidth;u=Math.abs(f.right-m)}else u=ns(n.wtRootElement).left;const c=Math.abs(_F(a,a));if(u>c){const f=RF(a);let g=i.getRowHeaderWidth();for(let m=1;m<=s;m++)if(g+=r.sumCellSizes(m-1,m),u+g-c>=f){t=m-2;break}}}return t}function _9(t){const{topOverlay:e,wtTable:r,wtViewport:n,totalRows:i,rootWindow:s}=this.dataAccessObject;if(e.mainTableScrollableElement===s){const a=ns(r.wtRootElement),o=UR(s,s);if(a.top>o){const u=fp(s);let c=n.getColumnHeaderHeight();for(let f=1;f<=i;f++)if(c+=e.sumCellSizes(f-1,f),a.top+c-o>=u){t=f-2;break}}}return t}function po(t,e,r){return(e=gwe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function gwe(t){var e=mwe(t,"string");return typeof e=="symbol"?e:e+""}function mwe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class jF{get eventManager(){return new Uo(this)}constructor(e,r){po(this,"wtTable",void 0),po(this,"wtScroll",void 0),po(this,"wtViewport",void 0),po(this,"wtOverlays",void 0),po(this,"selectionManager",void 0),po(this,"wtEvent",void 0),po(this,"guid",`wt_${gF()}`),po(this,"drawInterrupted",!1),po(this,"drawn",!1),po(this,"activeOverlayName","master"),po(this,"domBindings",void 0),po(this,"wtSettings",void 0),this.domBindings={rootTable:e,rootDocument:e.ownerDocument,rootWindow:e.ownerDocument.defaultView},this.wtSettings=r,this.wtScroll=new dwe(this.createScrollDao())}findOriginalHeaders(){const e=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(let r=0,n=this.wtTable.THEAD.childNodes[0].childNodes.length;r<n;r++)e.push(this.wtTable.THEAD.childNodes[0].childNodes[r].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(r,n){Bf(n,e[r])}])}}createCellCoords(e,r){return new Ng(e,r,this.wtSettings.getSetting("rtlMode"))}createCellRange(e,r,n){return new ES(e,r,n,this.wtSettings.getSetting("rtlMode"))}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.drawInterrupted=!1,!this.wtTable.isVisible()||MQ(this.wtTable.wtRootElement.parentNode)?this.drawInterrupted=!0:this.wtTable.draw(e),this}getCell(e){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1))return this.wtTable.getCell(e);const n=this.wtSettings.getSetting("totalRows"),i=this.wtSettings.getSetting("fixedRowsTop"),s=this.wtSettings.getSetting("fixedRowsBottom"),a=this.wtSettings.getSetting("fixedColumnsStart");if(e.row<i&&e.col<a)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(e);if(e.row<i)return this.wtOverlays.topOverlay.clone.wtTable.getCell(e);if(e.col<a&&e.row>=n-s){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(e)}else{if(e.col<a)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(e);if(e.row<n&&e.row>=n-s&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(e)}return this.wtTable.getCell(e)}scrollViewport(e,r,n){return this.wtScroll.scrollViewport(e,r,n)}scrollViewportHorizontally(e,r){return this.wtScroll.scrollViewportHorizontally(e,r)}scrollViewportVertically(e,r){return this.wtScroll.scrollViewportVertically(e,r)}getViewport(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}destroy(){this.wtOverlays.destroy(),this.wtEvent.destroy()}createScrollDao(){const e=this;return{get drawn(){return e.drawn},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get wtTable(){return e.wtTable},get wtViewport(){return e.wtViewport},get wtSettings(){return e.wtSettings},get rootWindow(){return e.domBindings.rootWindow},get totalRows(){return e.wtSettings.getSetting("totalRows")},get totalColumns(){return e.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return e.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return e.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return e.wtSettings.getSetting("fixedColumnsStart")}}}getTableDao(){const e=this;return{get wot(){return e},get parentTableOffset(){return e.cloneSource.wtTable.tableOffset},get cloneSource(){return e.cloneSource},get workspaceWidth(){return e.wtViewport.getWorkspaceWidth()},get wtViewport(){return e.wtViewport},get wtOverlays(){return e.wtOverlays},get selectionManager(){return e.selectionManager},get drawn(){return e.drawn},set drawn(r){e.drawn=r},get wtTable(){return e.wtTable},get startColumnRendered(){return e.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return e.wtViewport.columnsVisibleCalculator.startColumn},get startColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.startColumn},get endColumnRendered(){return e.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return e.wtViewport.columnsVisibleCalculator.endColumn},get endColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.endColumn},get countColumnsRendered(){return e.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return e.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return e.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return e.wtViewport.rowsVisibleCalculator.startRow},get startRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.startRow},get endRowRendered(){return e.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return e.wtViewport.rowsVisibleCalculator.endRow},get endRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.endRow},get countRowsRendered(){return e.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return e.wtViewport.rowsVisibleCalculator.count},get columnHeaders(){return e.wtSettings.getSetting("columnHeaders")},get rowHeaders(){return e.wtSettings.getSetting("rowHeaders")}}}}function R9(t,e,r){return(e=pwe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function pwe(t){var e=vwe(t,"string");return typeof e=="symbol"?e:e+""}function vwe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class wwe extends jF{constructor(e,r,n){super(e,r),R9(this,"cloneSource",void 0),R9(this,"cloneOverlay",void 0);const i=this.wtSettings.getSetting("facade",this);this.cloneSource=n.source,this.cloneOverlay=n.overlay,this.wtTable=this.cloneOverlay.createTable(this.getTableDao(),i,this.domBindings,this.wtSettings),this.wtViewport=n.viewport,this.selectionManager=n.selectionManager,this.wtEvent=new iZ(i,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager,n.event),this.findOriginalHeaders()}}function ywe(t,e,r){return(e=Swe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Swe(t){var e=bwe(t,"string");return typeof e=="symbol"?e:e+""}function bwe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class RS{constructor(e,r,n,i,s){ywe(this,"wtSettings",null),qu(this,"wot",e,{writable:!1}),this.domBindings=s,this.facadeGetter=r,this.wtSettings=i;const{TABLE:a,hider:o,spreader:u,holder:c,wtRootElement:f}=this.wot.wtTable;this.instance=this.wot,this.type=n,this.mainTableScrollableElement=null,this.TABLE=a,this.hider=o,this.spreader=u,this.holder=c,this.wtRootElement=f,this.trimmingContainer=Ap(this.hider.parentNode.parentNode),this.needFullRender=this.shouldBeRendered(),this.clone=this.makeClone()}hasRenderingStateChanged(){return this.needFullRender!==this.shouldBeRendered()}updateStateOfRendering(e){e==="before"&&this.shouldBeRendered()?this.needFullRender=!0:e==="after"&&!this.shouldBeRendered()&&(this.needFullRender=!1)}shouldBeRendered(){return!0}updateTrimmingContainer(){this.trimmingContainer=Ap(this.hider.parentNode.parentNode)}updateMainScrollableElement(){const{wtTable:e}=this.wot,{rootWindow:r}=this.domBindings;r.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=C1(e.TABLE)}getRelativeCellPosition(e,r,n){if(this.clone.wtTable.holder.contains(e)===!1){br(`The provided element is not a child of the ${this.type} overlay`);return}const i=this.mainTableScrollableElement===this.domBindings.rootWindow,s=n<this.wtSettings.getSetting("fixedColumnsStart"),a=r<this.wtSettings.getSetting("fixedRowsTop"),o=r>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),u=this.clone.wtTable.spreader,c={start:this.getRelativeStartPosition(u),top:u.offsetTop},f={start:this.getRelativeStartPosition(e),top:e.offsetTop};let g=null;return i?g=this.getRelativeCellPositionWithinWindow(a,s,f,c):g=this.getRelativeCellPositionWithinHolder(a,o,s,f,c),g}getRelativeStartPosition(e){return this.isRtl()?e.offsetParent.offsetWidth-e.offsetLeft-e.offsetWidth:e.offsetLeft}getRelativeCellPositionWithinWindow(e,r,n,i){const s=this.wot.wtTable.wtRootElement.getBoundingClientRect();let a=0,o=0;if(!r)a=i.start;else{let u=s.left;this.isRtl()&&(u=this.domBindings.rootWindow.innerWidth-(s.left+s.width+Ni())),a=u<=0?-1*u:0}return e?o=this.clone.wtTable.TABLE.getBoundingClientRect().top-s.top:o=i.top,{start:n.start+a,top:n.top+o}}getRelativeCellPositionWithinHolder(e,r,n,i,s){const a={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()};let o=0,u=0;if(n||(o=a.horizontal-s.start),r){const c=this.wot.wtTable.wtRootElement.getBoundingClientRect();u=this.clone.wtTable.TABLE.getBoundingClientRect().top*-1+c.top}else e||(u=a.vertical-s.top);return{start:i.start-o,top:i.top-u}}makeClone(){if(oZ.indexOf(this.type)===-1)throw new Error(`Clone type "${this.type}" is not supported.`);const{wtTable:e,wtSettings:r}=this.wot,{rootDocument:n,rootWindow:i}=this.domBindings,s=n.createElement("div"),a=n.createElement("table"),o=e.wtRootElement.parentNode;s.className=`${owe.get(this.type)} handsontable`,s.setAttribute("dir",this.isRtl()?"rtl":"ltr"),s.style.position="absolute",s.style.top=0,s.style.overflow="visible",this.isRtl()?s.style.right=0:s.style.left=0,r.getSetting("ariaTags")&&bt(s,[Lc()]),a.className=e.TABLE.className,e.TABLE.getAttribute("role")&&a.setAttribute("role",e.TABLE.getAttribute("role")),s.appendChild(a),o.appendChild(s);const c=this.wtSettings.getSetting("preventOverflow");return c===!0||c==="horizontal"&&this.type===Hg||c==="vertical"&&this.type===Fg?this.mainTableScrollableElement=i:i.getComputedStyle(o).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=e.holder:this.mainTableScrollableElement=C1(e.TABLE),new wwe(a,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selectionManager:this.wot.selectionManager})}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.needFullRender){const r=this.clone.cloneSource;r.activeOverlayName=this.clone.wtTable.name,this.clone.draw(e),r.activeOverlayName="master"}}reset(){const e=this.clone.wtTable.holder,r=this.clone.wtTable.hider,n=e.style,i=r.style,s=e.parentNode.style;[n,i,s].forEach(a=>{a.width="",a.height=""})}isRtl(){return this.wtSettings.getSetting("rtlMode")}destroy(){this.clone.eventManager.destroy()}}class Cwe extends RS{constructor(e,r,n,i,s,a){super(e,r,Df,n,i),this.bottomOverlay=s,this.inlineStartOverlay=a}createTable(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return new UF(...r)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wot:e}=this;if(this.updateTrimmingContainer(),!e.wtTable.holder.parentNode)return!1;const r=this.clone.wtTable.holder.parentNode;if(r.style.top="",this.trimmingContainer===this.domBindings.rootWindow){const s=this.inlineStartOverlay.getOverlayOffset(),a=this.bottomOverlay.getOverlayOffset();r.style[this.isRtl()?"right":"left"]=`${s}px`,r.style.bottom=`${a}px`}else bS(r),this.repositionOverlay();let n=ai(this.clone.wtTable.TABLE);const i=Un(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(n=0),r.style.height=`${n}px`,r.style.width=`${i}px`,!1}repositionOverlay(){const{wtTable:e,wtViewport:r}=this.wot,{rootDocument:n}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let s=0;r.hasVerticalScroll()||(s+=r.getWorkspaceHeight()-e.getTotalHeight()),r.hasVerticalScroll()&&r.hasHorizontalScroll()&&(s+=Ni(n)),i.style.bottom=`${s}px`}}const xwe="calculatedColumns",XR={getFirstRenderedColumn(){const t=this.dataAccessObject.startColumnRendered;return t===null?-1:t},getFirstVisibleColumn(){const t=this.dataAccessObject.startColumnVisible;return t===null?-1:t},getFirstPartiallyVisibleColumn(){const t=this.dataAccessObject.startColumnPartiallyVisible;return t===null?-1:t},getLastRenderedColumn(){const t=this.dataAccessObject.endColumnRendered;return t===null?-1:t},getLastVisibleColumn(){const t=this.dataAccessObject.endColumnVisible;return t===null?-1:t},getLastPartiallyVisibleColumn(){const t=this.dataAccessObject.endColumnPartiallyVisible;return t===null?-1:t},getRenderedColumnsCount(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount(){return this.dataAccessObject.countColumnsVisible},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};qu(XR,"MIXIN_NAME",xwe,{writable:!1,enumerable:!1});class YF extends av{constructor(e,r,n,i){super(e,r,n,i,Eu)}}Lr(YF,$F);Lr(YF,XR);function Ewe(t,e,r){return(e=_we(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _we(t){var e=Rwe(t,"string");return typeof e=="symbol"?e:e+""}function Rwe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Twe extends RS{constructor(e,r,n,i){super(e,r,Eu,n,i),Ewe(this,"cachedFixedRowsBottom",-1),this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom")}createTable(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return new YF(...r)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const{rootWindow:e}=this.domBindings,r=this.clone.wtTable.holder.parentNode;r.style.top="";let n=0;const i=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer===e&&(!i||i!=="vertical")?(n=this.getOverlayOffset(),r.style.bottom=`${n}px`):(n=this.getScrollPosition(),this.repositionOverlay());const s=this.adjustHeaderBordersPosition(n);return this.adjustElementsSize(),s}repositionOverlay(){const{wtTable:e,wtViewport:r}=this.wot,{rootDocument:n}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let s=0;r.hasVerticalScroll()||(s+=r.getWorkspaceHeight()-e.getTotalHeight()),r.hasVerticalScroll()&&r.hasHorizontalScroll()&&(s+=Ni(n)),i.style.bottom=`${s}px`}setScrollPosition(e){const{rootWindow:r}=this.domBindings,n=this.mainTableScrollableElement;let i=!1;if(n===r&&e!==r.scrollY){const s=r.scrollY;r.scrollTo($R(r),top),i=s!==r.scrollY}else if(e!==n.scrollTop){const s=n.scrollTop;n.scrollTop=e,i=s!==n.scrollTop}return i}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,r){const{wtTable:n,wtSettings:i}=this.wot,s=i.getSetting("stylesHandler").getDefaultRowHeight();let a=e,o=0;for(;a<r;){const u=n.getRowHeight(a);o+=u===void 0?s:u,a+=1}return o}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:r}=this.wot,{rootDocument:n,rootWindow:i}=this.domBindings,a=this.clone.wtTable.holder.parentNode.style,o=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||o==="horizontal"){let c=r.getWorkspaceWidth();r.hasVerticalScroll()&&(c-=Ni(n)),c=Math.min(c,e.wtRootElement.scrollWidth),a.width=`${c}px`}else a.width="";this.clone.wtTable.holder.style.width=a.width;let u=ai(this.clone.wtTable.TABLE);e.hasDefinedSize()||(u=0),a.height=`${u}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=e.parentNode.style.height}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:r}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?r.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:r.style[e]=""}scrollTo(e,r){let n=this.getTableParentOffset();const s=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;let a=0;r&&s.offsetHeight!==s.clientHeight&&(a=Ni(this.domBindings.rootDocument)),r?(n+=this.sumCellSizes(0,e+1),n-=this.wot.wtViewport.getViewportHeight(),n+=1):n+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),e),n+=a,this.setScrollPosition(n)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return UR(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,r=this.wtSettings.getSetting("preventOverflow");let n=0;if(this.trimmingContainer===e&&(!r||r!=="vertical")){const i=this.wot.wtTable.getTotalHeight(),s=this.clone.wtTable.getTotalHeight(),a=i-s,o=this.domBindings.rootDocument.documentElement.clientHeight;n=Math.max(this.getTableParentOffset()-this.getScrollPosition()-o+i,0),n>a&&(n=0)}return n}adjustHeaderBordersPosition(e){const r=this.wtSettings.getSetting("fixedRowsBottom"),n=this.cachedFixedRowsBottom!==r,i=this.wtSettings.getSetting("columnHeaders");let s=!1;if((n||r===0)&&i.length>0){const a=this.wot.wtTable.holder.parentNode,o=Ct(a,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),e||this.wtSettings.getSetting("totalRows")===0?(Ve(a,"innerBorderBottom"),s=!o):(wt(a,"innerBorderBottom"),s=o)}return s}}const Mwe="calculatedRows",zF={getFirstRenderedRow(){const t=this.dataAccessObject.startRowRendered;return t===null?-1:t},getFirstVisibleRow(){const t=this.dataAccessObject.startRowVisible;return t===null?-1:t},getFirstPartiallyVisibleRow(){const t=this.dataAccessObject.startRowPartiallyVisible;return t===null?-1:t},getLastRenderedRow(){const t=this.dataAccessObject.endRowRendered;return t===null?-1:t},getLastVisibleRow(){const t=this.dataAccessObject.endRowVisible;return t===null?-1:t},getLastPartiallyVisibleRow(){const t=this.dataAccessObject.endRowPartiallyVisible;return t===null?-1:t},getRenderedRowsCount(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount(){return this.dataAccessObject.countRowsVisible},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};qu(zF,"MIXIN_NAME",Mwe,{writable:!1,enumerable:!1});class GF extends av{constructor(e,r,n,i){super(e,r,n,i,Fg)}}Lr(GF,zF);Lr(GF,KR);const Awe="localHooks",as={_localHooks:Object.create(null),addLocalHook(t,e){return this._localHooks[t]||(this._localHooks[t]=[]),this._localHooks[t].push(e),this},runLocalHooks(t,e,r,n,i,s,a){if(this._localHooks[t]){const o=this._localHooks[t].length;for(let u=0;u<o;u++)e_(this._localHooks[t][u],this,e,r,n,i,s,a)}},clearLocalHooks(){return this._localHooks={},this}};qu(as,"MIXIN_NAME",Awe,{writable:!1,enumerable:!1});let lZ=class{constructor(e,r){this.settings=e,this.cellRange=r||null}isEmpty(){return this.cellRange===null}add(e){return this.isEmpty()?this.cellRange=this.settings.createCellRange(e):this.cellRange.expand(e),this}replace(e,r){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e))return this.cellRange.from=r,!0;if(this.cellRange.to.isEqual(e))return this.cellRange.to=r,!0}return!1}clear(){return this.cellRange=null,this}getCorners(){const e=this.cellRange.getOuterTopStartCorner(),r=this.cellRange.getOuterBottomEndCorner();return[e.row,e.col,r.row,r.col]}destroy(){this.runLocalHooks("destroy")}};Lr(lZ,as);const uZ="active-header",qF="header",KF="area",r_="focus",Owe="fill",kwe="row",Dwe="column",Pwe="custom-selection",XF=t=>{const e=t.wtSettings.getSetting("stylesHandler");if(e.isClassicTheme())return Object.freeze({width:6,height:6,borderWidth:1,borderStyle:"solid",borderColor:"#FFF"});const r=e.getCSSVariableValue("cell-autofill-size"),n=e.getCSSVariableValue("cell-autofill-border-width"),i=e.getCSSVariableValue("cell-autofill-border-color");return Object.freeze({width:r,height:r,borderWidth:n,borderStyle:"solid",borderColor:i})};var T9={},M9;function Iwe(){if(M9)return T9;M9=1;var t=GR();return t("flat"),T9}Iwe();function Nwe(t,e){cZ(t,e),e.add(t)}function A9(t,e,r){cZ(t,e),e.set(t,r)}function cZ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Tn(t,e){return t.get(Ly(t,e))}function O9(t,e,r){return t.set(Ly(t,e),r),r}function Ly(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var ml=new WeakMap,gs=new WeakMap,yC=new WeakSet;class Hwe{constructor(){Nwe(this,yC),A9(this,ml,void 0),A9(this,gs,void 0)}setActiveOverlay(e){return O9(gs,this,e),this}setActiveSelection(e){return O9(ml,this,e),this}scan(){const e=Tn(ml,this).settings.selectionType,r=new Set;return e==="active-header"?(this.scanColumnsInHeadersRange(n=>r.add(n)),this.scanRowsInHeadersRange(n=>r.add(n))):e==="area"?this.scanCellsRange(n=>r.add(n)):e==="focus"?(this.scanColumnsInHeadersRange(n=>r.add(n)),this.scanRowsInHeadersRange(n=>r.add(n)),this.scanCellsRange(n=>r.add(n))):e==="fill"?this.scanCellsRange(n=>r.add(n)):e==="header"?(this.scanColumnsInHeadersRange(n=>r.add(n)),this.scanRowsInHeadersRange(n=>r.add(n))):e==="row"?(this.scanRowsInHeadersRange(n=>r.add(n)),this.scanRowsInCellsRange(n=>r.add(n))):e==="column"&&(this.scanColumnsInHeadersRange(n=>r.add(n)),this.scanColumnsInCellsRange(n=>r.add(n))),r}scanColumnsInHeadersRange(e){const[r,n,i,s]=Tn(ml,this).getCorners(),{wtTable:a}=Tn(gs,this),o=a.getRenderedColumnsCount(),u=a.getColumnHeadersCount();let c=0;for(let f=-a.getRowHeadersCount();f<o;f++){const g=a.columnFilter.renderedToSource(f);if(!(g<n||g>s)){for(let m=-u;m<0;m++){if(m<r||m>i)continue;const v=m+u;let w=a.getColumnHeader(g,v);const y=Tn(gs,this).getSetting("onBeforeHighlightingColumnHeader",g,v,{selectionType:Tn(ml,this).settings.selectionType,columnCursor:c,selectionWidth:s-n+1});y!==null&&(y!==g&&(w=a.getColumnHeader(y,v)),e(w))}c+=1}}}scanRowsInHeadersRange(e){const[r,n,i,s]=Tn(ml,this).getCorners(),{wtTable:a}=Tn(gs,this),o=a.getRenderedRowsCount(),u=a.getRowHeadersCount();let c=0;for(let f=-a.getColumnHeadersCount();f<o;f++){const g=a.rowFilter.renderedToSource(f);if(!(g<r||g>i)){for(let m=-u;m<0;m++){if(m<n||m>s)continue;const v=m+u;let w=a.getRowHeader(g,v);const y=Tn(gs,this).getSetting("onBeforeHighlightingRowHeader",g,v,{selectionType:Tn(ml,this).settings.selectionType,rowCursor:c,selectionHeight:i-r+1});y!==null&&(y!==g&&(w=a.getRowHeader(y,v)),e(w))}c+=1}}}scanCellsRange(e){const{wtTable:r}=Tn(gs,this);Ly(yC,this,Fwe).call(this,(n,i)=>{const s=r.getCell(Tn(gs,this).createCellCoords(n,i)),a=Tn(gs,this).getSetting("onAfterDrawSelection",n,i,Tn(ml,this).settings.layerLevel);typeof a=="string"&&Ve(s,a),e(s)})}scanRowsInCellsRange(e){const[r,,n]=Tn(ml,this).getCorners(),{wtTable:i}=Tn(gs,this);Ly(yC,this,k9).call(this,(s,a)=>{if(s>=r&&s<=n){const o=i.getCell(Tn(gs,this).createCellCoords(s,a));e(o)}})}scanColumnsInCellsRange(e){const[,r,,n]=Tn(ml,this).getCorners(),{wtTable:i}=Tn(gs,this);Ly(yC,this,k9).call(this,(s,a)=>{if(a>=r&&a<=n){const o=i.getCell(Tn(gs,this).createCellCoords(s,a));e(o)}})}}function Fwe(t){let[e,r,n,i]=Tn(ml,this).getCorners();if(e<0&&n<0||r<0&&i<0)return;const{wtTable:s}=Tn(gs,this),a=e!==n||r!==i;if(r=Math.max(r,0),i=Math.max(i,0),e=Math.max(e,0),n=Math.max(n,0),a){if(r=Math.max(r,s.getFirstRenderedColumn()),i=Math.min(i,s.getLastRenderedColumn()),e=Math.max(e,s.getFirstRenderedRow()),n=Math.min(n,s.getLastRenderedRow()),i<r||n<e)return}else{const o=s.getCell(Tn(gs,this).createCellCoords(e,r));if(!Iu(o))return}for(let o=e;o<=n;o+=1)for(let u=r;u<=i;u+=1)t(o,u)}function k9(t){const{wtTable:e}=Tn(gs,this),r=e.getRenderedRowsCount(),n=e.getRenderedColumnsCount();for(let i=0;i<r;i+=1){const s=e.rowFilter.renderedToSource(i);for(let a=0;a<n;a+=1)t(s,e.columnFilter.renderedToSource(a))}}class D9{constructor(e,r){r&&(this.eventManager=e.eventManager,this.instance=e,this.wot=e,this.settings=r,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle=XF(this.instance),this.cornerCenterPointOffset=-Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(r),this.registerListeners())}registerListeners(){const e=this.wot.rootDocument.body;this.eventManager.addEventListener(e,"mousedown",()=>this.onMouseDown()),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp());for(let r=0,n=this.main.childNodes.length;r<n;r++){const i=this.main.childNodes[r];this.eventManager.addEventListener(i,"mouseenter",s=>this.onMouseEnter(s,this.main.childNodes[r]))}}onMouseDown(){this.mouseDown=!0}onMouseUp(){this.mouseDown=!1}onMouseEnter(e,r){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;e.preventDefault(),Qo(e);const n=this,i=this.wot.rootDocument.body,s=r.getBoundingClientRect();r.style.display="none";function a(u){if(u.clientY<Math.floor(s.top)||u.clientY>Math.ceil(s.top+s.height)||u.clientX<Math.floor(s.left)||u.clientX>Math.ceil(s.left+s.width))return!0}function o(u){a(u)&&(n.eventManager.removeEventListener(i,"mousemove",o),r.style.display="block")}this.eventManager.addEventListener(i,"mousemove",o)}createBorders(e){const{rootDocument:r}=this.wot;this.main=r.createElement("div");const n=["top","start","bottom","end","corner"];let i=this.main.style;i.position="absolute",i.top=0,i.left=0;for(let o=0;o<5;o++){const u=n[o],c=r.createElement("div");c.className=`wtBorder ${this.settings.className||""}`,this.settings[u]&&this.settings[u].hide&&(c.className+=" hidden"),i=c.style,i.backgroundColor=this.settings[u]&&this.settings[u].color?this.settings[u].color:e.border.color,i.height=this.settings[u]&&this.settings[u].width?`${this.settings[u].width}px`:`${e.border.width}px`,i.width=this.settings[u]&&this.settings[u].width?`${this.settings[u].width}px`:`${e.border.width}px`,this.main.appendChild(c)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=`${this.cornerDefaultStyle.width}px`,this.cornerStyle.height=`${this.cornerDefaultStyle.height}px`,this.cornerStyle.border=[`${this.cornerDefaultStyle.borderWidth}px`,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),_l()&&this.instance.getSetting("isDataViewInstance")&&this.createMultipleSelectorHandles(),this.disappear();const{wtTable:s}=this.wot;let a=s.bordersHolder;a||(a=r.createElement("div"),a.className="htBorders",s.bordersHolder=a,s.spreader.appendChild(a)),a.appendChild(this.main)}createMultipleSelectorHandles(){const{rootDocument:e,wtSettings:r}=this.wot,n=r.getSetting("stylesHandler"),i=n.getCSSVariableValue("cell-mobile-handle-size"),s=n.getCSSVariableValue("cell-mobile-handle-border-radius"),a=n.getCSSVariableValue("cell-mobile-handle-background-color"),o=n.getCSSVariableValue("cell-mobile-handle-border-width"),u=n.getCSSVariableValue("cell-mobile-handle-border-color");this.selectionHandles={top:e.createElement("DIV"),topHitArea:e.createElement("DIV"),bottom:e.createElement("DIV"),bottomHitArea:e.createElement("DIV")};const c=10,f=40;this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};const g={position:"absolute",height:`${f}px`,width:`${f}px`,"border-radius":`${parseInt(f/1.5,10)}px`};Wt(g,(v,w)=>{this.selectionHandles.styles.bottomHitArea[w]=v,this.selectionHandles.styles.topHitArea[w]=v});const m=n.isClassicTheme()?{position:"absolute",height:`${c}px`,width:`${c}px`,"border-radius":`${parseInt(c/1.5,10)}px`,background:"#F5F5FF",border:"1px solid #4285c8"}:{position:"absolute",height:`${i}px`,width:`${i}px`,"border-radius":`${s}px`,background:`${a}`,border:`${o}px solid ${u}`};Wt(m,(v,w)=>{this.selectionHandles.styles.bottom[w]=v,this.selectionHandles.styles.top[w]=v}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}isPartRange(e,r){const n=this.wot.selectionManager.getAreaSelection();return!!(n.cellRange&&(e!==n.cellRange.to.row||r!==n.cellRange.to.col))}updateMultipleSelectionHandlesPosition(e,r,n,i,s,a){const u=this.wot.wtSettings.getSetting("rtlMode")?"right":"left",{top:c,topHitArea:f,bottom:g,bottomHitArea:m}=this.selectionHandles.styles,v=parseInt(c.borderWidth,10),w=parseInt(c.width,10),y=parseInt(f.width,10),b=this.wot.wtTable.getWidth(),x=this.wot.wtTable.getHeight();c.top=`${parseInt(n-w-1,10)}px`,c[u]=`${parseInt(i-w-1,10)}px`,f.top=`${parseInt(n-y/4*3,10)}px`,f[u]=`${parseInt(i-y/4*3,10)}px`;const _=Math.min(parseInt(i+s,10),b-w-v*2),T=Math.min(parseInt(i+s-y/4,10),b-y-v*2);g[u]=`${_}px`,m[u]=`${T}px`;const D=Math.min(parseInt(n+a,10),x-w-v*2),P=Math.min(parseInt(n+a-y/4,10),x-y-v*2);g.top=`${D}px`,m.top=`${P}px`,this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(c.display="block",f.display="block",this.isPartRange(e,r)?(g.display="none",m.display="none"):(g.display="block",m.display="block")):(c.display="none",g.display="none",f.display="none",m.display="none"),e===this.wot.wtSettings.getSetting("fixedRowsTop")||r===this.wot.wtSettings.getSetting("fixedColumnsStart")?(c.zIndex="9999",f.zIndex="9999"):(c.zIndex="",f.zIndex="")}appear(e){if(this.disabled)return;let[r,n,i,s]=e;if(r<0&&i<0||n<0&&s<0){this.disappear();return}const{wtTable:a,rootDocument:o,rootWindow:u}=this.wot,c=r!==i||n!==s,f=this.wot.wtSettings.getSetting("stylesHandler").isClassicTheme(),g=a.getFirstRenderedRow(),m=a.getLastRenderedRow(),v=a.getFirstRenderedColumn(),w=a.getLastRenderedColumn();if(v<0&&w<0||g<0&&m<0){this.disappear();return}let y;if(c){if(n=Math.max(n,v),s=Math.min(s,w),r=Math.max(r,g),i=Math.min(i,m),s<n||i<r){this.disappear();return}y=a.getCell(this.wot.createCellCoords(r,n))}else if(y=a.getCell(this.wot.createCellCoords(r,n)),!Iu(y)){this.disappear();return}const b=c?a.getCell(this.wot.createCellCoords(i,s)):y,x=ns(y),_=c?ns(b):x,T=ns(a.TABLE),D=x.top,P=x.left,O=this.wot.wtSettings.getSetting("rtlMode");let A=0,W=0;if(O){const Te=Un(a.TABLE),ce=Un(y),K=u.innerWidth-T.left-Te;W=P+ce-_.left,A=u.innerWidth-P-ce-K-1}else W=_.left+Un(b)-P,A=P-T.left-1;if(this.isEntireColumnSelected(r,i)){const Te=r,ce=this.getDimensionsFromHeader("columns",n,s,Te,T);let K=null;ce&&([K,A,W]=ce),K&&(y=K)}let L=D-T.top-1,H=_.top+ai(b)-D;if(this.isEntireRowSelected(n,s)){const Te=n,ce=this.getDimensionsFromHeader("rows",r,i,Te,T);let K=null;ce&&([K,L,H]=ce),K&&(y=K)}const J=u.getComputedStyle(y);parseInt(J.borderTopWidth,10)>0&&(L+=1,H=H>0?H-1:0),parseInt(J[O?"borderRightWidth":"borderLeftWidth"],10)>0&&(A+=1,W=W>0?W-1:0);const G=O?"right":"left",ve=Math.ceil(this.settings.border.width/2);this.topStyle.top=`${L}px`,this.topStyle[G]=`${A}px`,this.topStyle.width=`${W+ve}px`,this.topStyle.display="block",this.startStyle.top=`${L}px`,this.startStyle[G]=`${A}px`,this.startStyle.height=`${H+ve}px`,this.startStyle.display="block",this.bottomStyle.top=`${L+H-parseInt(this.bottomStyle.height,10)+ve}px`,this.bottomStyle[G]=`${A}px`,this.bottomStyle.width=`${W+ve}px`,this.bottomStyle.display="block",this.endStyle.top=`${L}px`,this.endStyle[G]=`${A+W-parseInt(this.endStyle.width,10)+ve}px`,this.endStyle.height=`${H+ve}px`,this.endStyle.display="block";let be=this.settings.border.cornerVisible;be=typeof be=="function"?be(this.settings.layerLevel):be;const we=this.wot.getSetting("onModifyGetCellCoords",i,s,!1,"render");let[ae,le]=[i,s];if(we&&Array.isArray(we)&&([,,ae,le]=we),_l()||!be||this.isPartRange(ae,le))this.cornerStyle.display="none";else{this.cornerStyle.top=`${L+H+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle[G]=`${A+W+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderRightWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderLeftWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderBottomWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";let Te=Ap(a.TABLE);const ce=Te===u;ce&&(Te=o.documentElement);const K=parseInt(this.cornerDefaultStyle.borderWidth,10)-1,Se=Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),B=Math.ceil(parseInt(this.cornerDefaultStyle.height,10)/2);if(s===this.wot.getSetting("totalColumns")-1){const E=ce?b.getBoundingClientRect().left:b.offsetLeft;let R=!1,M=0;if(O?(M=E-parseInt(this.cornerDefaultStyle.width,10)/2,R=M<0):(M=E+Un(b)+parseInt(this.cornerDefaultStyle.width,10)/2,R=M>=RF(Te)),R){const F=Math.floor(A+W+this.cornerCenterPointOffset-Se-K);f?(this.cornerStyle[G]=`${F}px`,this.cornerStyle[O?"borderLeftWidth":"borderRightWidth"]=0):this.cornerStyle[G]=`${F-1}px`}}if(i===this.wot.getSetting("totalRows")-1&&(ce?b.getBoundingClientRect().top:b.offsetTop)+ai(b)+parseInt(this.cornerDefaultStyle.height,10)/2>=fp(Te)){const F=Math.floor(L+H+this.cornerCenterPointOffset-B-K);f?(this.cornerStyle.top=`${F}px`,this.cornerStyle.borderBottomWidth=0):this.cornerStyle.top=`${F-1}px`}this.cornerStyle.display="block"}_l()&&this.instance.getSetting("isDataViewInstance")&&this.updateMultipleSelectionHandlesPosition(i,s,L,A,W,H)}isEntireColumnSelected(e,r){return e===this.wot.wtTable.getFirstRenderedRow()&&r===this.wot.wtTable.getLastRenderedRow()}isEntireRowSelected(e,r){return e===this.wot.wtTable.getFirstRenderedColumn()&&r===this.wot.wtTable.getLastRenderedColumn()}getDimensionsFromHeader(e,r,n,i,s){const{wtTable:a}=this.wot,o=a.wtRootElement.parentNode;let u=null,c=null,f=null,g=null,m=null,v=null,w=null,y=null;switch(e){case"rows":u=function(){return a.getRowHeader(...arguments)},c=function(){return ai(...arguments)},f="ht__selection--rows",v="top";break;case"columns":u=function(){return a.getColumnHeader(...arguments)},c=function(){return Un(...arguments)},f="ht__selection--columns",v="left";break}if(o.classList.contains(f)){const b=this.wot.getSetting("columnHeaders").length;if(w=u(r,b-i),y=u(n,b-i),!w||!y)return!1;const x=ns(w),_=ns(y);return w&&y&&(g=x[v]-s[v]-1,m=_[v]+c(y)-x[v]),[w,g,m]}return!1}changeBorderStyle(e,r){const n=this[e].style,i=r[e];!i||i.hide?Ve(this[e],"hidden"):(Ct(this[e],"hidden")&&wt(this[e],"hidden"),n.backgroundColor=i.color,(e==="top"||e==="bottom")&&(n.height=`${i.width}px`),(e==="start"||e==="end")&&(n.width=`${i.width}px`))}changeBorderToDefaultStyle(e){const r={width:1,color:"#000"},n=this[e].style;n.backgroundColor=r.color,n.width=`${r.width}px`,n.height=`${r.width}px`}toggleHiddenClass(e,r){this.changeBorderToDefaultStyle(e),r?Ve(this[e],"hidden"):wt(this[e],"hidden")}disappear(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",_l()&&this.instance.getSetting("isDataViewInstance")&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}destroy(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}function Lwe(t,e){hZ(t,e),e.add(t)}function s0(t,e,r){hZ(t,e),e.set(t,r)}function hZ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ut(t,e){return t.get(QF(t,e))}function P9(t,e,r){return t.set(QF(t,e),r),r}function QF(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var ms=new WeakMap,ha=new WeakMap,o2=new WeakMap,by=new WeakMap,l2=new WeakMap,Td=new WeakMap,I9=new WeakSet;class Bwe{constructor(e){Lwe(this,I9),s0(this,ms,void 0),s0(this,ha,void 0),s0(this,o2,new Hwe),s0(this,by,new WeakMap),s0(this,l2,new WeakSet),s0(this,Td,new Map),P9(ha,this,e)}setActiveOverlay(e){return P9(ms,this,e),Ut(o2,this).setActiveOverlay(Ut(ms,this)),Ut(by,this).has(Ut(ms,this))||Ut(by,this).set(Ut(ms,this),new Set),this}getFocusSelection(){return Ut(ha,this)!==null?Ut(ha,this).getFocus():null}getAreaSelection(){return Ut(ha,this)!==null?Ut(ha,this).createLayeredArea():null}getBorderInstance(e){if(!e.settings.border)return null;if(Ut(Td,this).has(e)){const n=Ut(Td,this).get(e);if(n.has(Ut(ms,this)))return n.get(Ut(ms,this));const i=new D9(Ut(ms,this),e.settings);return n.set(Ut(ms,this),i),i}const r=new D9(Ut(ms,this),e.settings);return Ut(Td,this).set(e,new Map([[Ut(ms,this),r]])),r}getBorderInstances(e){var r,n;return Array.from((r=(n=Ut(Td,this).get(e))===null||n===void 0?void 0:n.values())!==null&&r!==void 0?r:[])}destroyBorders(e){Ut(Td,this).get(e).forEach(r=>r.destroy()),Ut(Td,this).delete(e)}render(e){if(Ut(ha,this)===null)return;e&&QF(I9,this,Vwe).call(this);const r=Array.from(Ut(ha,this)),n=new Map,i=new Map;for(let s=0;s<r.length;s++){const a=r[s],{className:o,headerAttributes:u,createLayers:c,selectionType:f}=a.settings;Ut(l2,this).has(a)||(Ut(l2,this).add(a),a.addLocalHook("destroy",()=>this.destroyBorders(a)));const g=this.getBorderInstance(a);if(a.isEmpty()){g?.disappear();continue}o&&Ut(o2,this).setActiveSelection(a).scan().forEach(w=>{if(n.has(w)){const y=n.get(w);y.has(o)&&c===!0?y.set(o,y.get(o)+1):y.set(o,1)}else n.set(w,new Map([[o,1]]));u&&(i.has(w)||i.set(w,[]),w.nodeName==="TH"&&i.get(w).push(...u))});const m=a.getCorners();Ut(ms,this).getSetting("onBeforeDrawBorders",m,f),g?.appear(m)}n.forEach((s,a)=>{var o;const u=Array.from(s).map(c=>{let[f,g]=c;return g===1?f:[f,...Array.from({length:g-1},(m,v)=>`${f}-${v+1}`)]}).flat();u.forEach(c=>Ut(by,this).get(Ut(ms,this)).add(c)),Ve(a,u),a.nodeName==="TD"&&Array.isArray((o=Ut(ha,this).options)===null||o===void 0?void 0:o.cellAttributes)&&bt(a,Ut(ha,this).options.cellAttributes)}),Array.from(i.keys()).forEach(s=>{bt(s,[...i.get(s)])})}}function Vwe(){const t=Ut(by,this).get(Ut(ms,this)),e=Ut(ms,this).wtSettings.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(e))for(let r=0;r<e.length;r++)t.add(e[r]);t.forEach(r=>{var n,i;const s=Ut(ms,this).wtTable.TABLE.querySelectorAll(`.${r}`);let a=[];Array.isArray((n=Ut(ha,this).options)===null||n===void 0?void 0:n.cellAttributes)&&(a=Ut(ha,this).options.cellAttributes.map(o=>o[0])),Array.isArray((i=Ut(ha,this).options)===null||i===void 0?void 0:i.headerAttributes)&&(a=[...a,...Ut(ha,this).options.headerAttributes.map(o=>o[0])]);for(let o=0,u=s.length;o<u;o++)wt(s[o],r),am(s[o],a)}),t.clear()}class Wwe extends RS{constructor(e,r,n,i){super(e,r,Fg,n,i)}createTable(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return new GF(...r)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wtTable:e}=this.wot;if(!this.needFullRender||!this.shouldBeRendered()||!e.holder.parentNode)return!1;const{rootWindow:r}=this.domBindings,n=this.clone.wtTable.holder.parentNode,i=this.wtSettings.getSetting("preventOverflow");let s=0;this.trimmingContainer===r&&(!i||i!=="horizontal")?(s=this.getOverlayOffset()*(this.isRtl()?-1:1),jR(n,`${s}px`,"0px")):(s=this.getScrollPosition(),bS(n));const a=this.adjustHeaderBordersPosition(s);return this.adjustElementsSize(),a}setScrollPosition(e){const{rootWindow:r}=this.domBindings;let n=!1;this.isRtl()&&(e=-e);const i=this.mainTableScrollableElement;if(i===r&&e!==r.scrollX){const s=r.scrollX;r.scrollTo(e,EF(r)),n=s!==r.scrollX}else if(e!==i.scrollLeft){const s=i.scrollLeft;i.scrollLeft=e,n=s!==i.scrollLeft}return n}onScroll(){this.wtSettings.getSetting("onScrollVertically")}sumCellSizes(e,r){const n=this.wtSettings.getSetting("defaultColumnWidth");let i=e,s=0;for(;i<r;)s+=this.wot.wtTable.getColumnWidth(i)||n,i+=1;return s}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:r}=this.wot,{rootDocument:n,rootWindow:i}=this.domBindings,a=this.clone.wtTable.holder.parentNode.style,o=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||o==="vertical"){let c=r.getWorkspaceHeight();r.hasHorizontalScroll()&&(c-=Ni(n)),c=Math.min(c,e.wtRootElement.scrollHeight),a.height=`${c}px`}else a.height="";this.clone.wtTable.holder.style.height=a.height;const u=Un(this.clone.wtTable.TABLE);a.width=`${u}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,r=XF(this.wot),n=this.wot.selectionManager.getFocusSelection()?parseInt(r.width,10)/2:0;this.clone.wtTable.hider.style.height=this.hider.style.height,e.style.height=e.parentNode.style.height,e.style.width=`${parseInt(e.parentNode.style.width,10)+n}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalColumns"),r=this.isRtl()?"right":"left";if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number")this.spreader.style[r]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style[r]="0";else throw new Error("Incorrect value of the columnsRenderCalculator");this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`:this.clone.wtTable.spreader.style.top=""}scrollTo(e,r){const{wtSettings:n}=this,i=n.getSetting("rowHeaders"),s=n.getSetting("fixedColumnsStart"),o=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,u=s===0&&i.length>0&&!Ct(o.parentNode,"innerBorderInlineStart")?1:0;let c=this.getTableParentOffset(),f=0;if(r){const g=this.wot.wtTable.getColumnWidth(e),m=this.wot.wtViewport.getViewportWidth();g>m&&(r=!1)}return r&&o.offsetWidth!==o.clientWidth&&(f=Ni(this.domBindings.rootDocument)),r?(c+=this.sumCellSizes(0,e+1),c-=this.wot.wtViewport.getViewportWidth(),c+=u):c+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),e),c+=f,OQ(this.mainTableScrollableElement)===c-u&&u>0&&this.wot.wtOverlays.expandHiderHorizontallyBy(u),this.setScrollPosition(c)}getTableParentOffset(){const e=this.wtSettings.getSetting("preventOverflow");let r=0;return!e&&this.trimmingContainer===this.domBindings.rootWindow&&(r=this.wot.wtTable.holderOffset.left),r}getScrollPosition(){return Math.abs(_F(this.mainTableScrollableElement,this.domBindings.rootWindow))}getOverlayOffset(){const{rootWindow:e}=this.domBindings,r=this.wtSettings.getSetting("preventOverflow");let n=0;if(this.trimmingContainer===e&&(!r||r!=="horizontal")){this.isRtl()?n=Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):n=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);const i=this.wot.wtTable.getTotalWidth(),s=this.clone.wtTable.getTotalWidth(),a=i-s;n>a&&(n=0)}return n}adjustHeaderBordersPosition(e){const{wtSettings:r}=this,n=this.wot.wtTable.holder.parentNode,i=r.getSetting("rowHeaders"),s=r.getSetting("fixedColumnsStart"),a=r.getSetting("totalRows"),o=r.getSetting("preventOverflow")==="vertical";a?wt(n,"emptyRows"):Ve(n,"emptyRows");let u=!1;if(!o){if(s&&!i.length)Ve(n,"innerBorderLeft innerBorderInlineStart");else if(!s&&i.length){const c=Ct(n,"innerBorderInlineStart");e?(Ve(n,"innerBorderLeft innerBorderInlineStart"),u=!c):(wt(n,"innerBorderLeft innerBorderInlineStart"),u=c)}}return u}}const $we="stickyRowsTop",ZF={getFirstRenderedRow(){return this.getRenderedRowsCount()===0?-1:0},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){return Math.min(this.wtSettings.getSetting("totalRows"),this.wtSettings.getSetting("fixedRowsTop"))},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};qu(ZF,"MIXIN_NAME",$we,{writable:!1,enumerable:!1});class JF extends av{constructor(e,r,n,i){super(e,r,n,i,Lg)}}Lr(JF,ZF);Lr(JF,KR);function N9(t,e,r){return(e=Uwe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Uwe(t){var e=jwe(t,"string");return typeof e=="symbol"?e:e+""}function jwe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ywe extends RS{constructor(e,r,n,i,s,a){super(e,r,Lg,n,i),N9(this,"topOverlay",void 0),N9(this,"inlineStartOverlay",void 0),this.topOverlay=s,this.inlineStartOverlay=a}createTable(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return new JF(...r)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){const i=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),s=this.topOverlay.getOverlayOffset();jR(e,`${i}px`,`${s}px`)}else bS(e);let r=ai(this.clone.wtTable.TABLE);const n=Un(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(r=0),e.style.height=`${r}px`,e.style.width=`${n}px`,!1}}class eL extends av{constructor(e,r,n,i){super(e,r,n,i,Hg)}}Lr(eL,ZF);Lr(eL,XR);function zwe(t,e,r){return(e=Gwe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Gwe(t){var e=qwe(t,"string");return typeof e=="symbol"?e:e+""}function qwe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Kwe extends RS{constructor(e,r,n,i){super(e,r,Hg,n,i),zwe(this,"cachedFixedRowsTop",-1),this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop")}createTable(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return new eL(...r)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode,{rootWindow:r}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let i=0,s=!1;if(this.trimmingContainer===r&&(!n||n!=="vertical")){const{wtTable:o}=this.wot,u=o.hider.getBoundingClientRect(),c=Math.ceil(u.bottom),f=e.offsetHeight;s=c===f,i=this.getOverlayOffset(),jR(e,"0px",`${i}px`)}else i=this.getScrollPosition(),bS(e);const a=this.adjustHeaderBordersPosition(i,s);return this.adjustElementsSize(),a}setScrollPosition(e){const{rootWindow:r}=this.domBindings,n=this.mainTableScrollableElement;let i=!1;if(n===r&&e!==r.scrollY){const s=r.scrollY;r.scrollTo($R(r),e),i=s!==r.scrollY}else if(e!==n.scrollTop){const s=n.scrollTop;n.scrollTop=e,i=s!==n.scrollTop}return i}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,r){const n=this.wtSettings.getSetting("stylesHandler").getDefaultRowHeight();let i=e,s=0;for(;i<r;){const a=this.wot.wtTable.getRowHeight(i);s+=a===void 0?n:a,i+=1}return s}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:r}=this.wot,{rootDocument:n,rootWindow:i}=this.domBindings,a=this.clone.wtTable.holder.parentNode.style,o=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||o==="horizontal"){let c=r.getWorkspaceWidth();r.hasVerticalScroll()&&(c-=Ni(n)),c=Math.min(c,e.wtRootElement.scrollWidth),a.width=`${c}px`}else a.width="";this.clone.wtTable.holder.style.width=a.width;let u=ai(this.clone.wtTable.TABLE);e.hasDefinedSize()||(u=0),a.height=`${u}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,r=XF(this.wot),n=this.wot.selectionManager.getFocusSelection()?parseInt(r.height,10)/2:0;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=`${parseInt(e.parentNode.style.height,10)+n}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:r}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?r.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:r.style[e]=""}scrollTo(e,r){const{wot:n,wtSettings:i}=this,a=(n.cloneSource?n.cloneSource:n).wtTable.holder,o=i.getSetting("columnHeaders"),c=i.getSetting("fixedRowsTop")===0&&o.length>0&&!Ct(a.parentNode,"innerBorderTop")?1:0;let f=this.getTableParentOffset(),g=0;if(r){const m=this.wot.wtTable.getRowHeight(e),v=this.wot.wtViewport.getViewportHeight();m>v&&(r=!1)}if(r&&a.offsetHeight!==a.clientHeight&&(g=Ni(this.domBindings.rootDocument)),r){const m=i.getSetting("fixedRowsBottom"),v=i.getSetting("totalRows");f+=this.sumCellSizes(0,e+1),f-=n.wtViewport.getViewportHeight()-this.sumCellSizes(v-m,v),f+=1,f+=c}else f+=this.sumCellSizes(i.getSetting("fixedRowsTop"),e);return f+=g,AQ(this.mainTableScrollableElement)===f-c&&c>0&&this.wot.wtOverlays.expandHiderVerticallyBy(c),this.setScrollPosition(f)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return UR(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,r=this.wtSettings.getSetting("preventOverflow");let n=0;if(this.trimmingContainer===e&&(!r||r!=="vertical")){const i=this.wot.wtTable.getTotalHeight(),s=this.clone.wtTable.getTotalHeight(),a=i-s;n=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),n>a&&(n=0)}return n}adjustHeaderBordersPosition(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{wtSettings:n}=this,i=this.wot.wtTable.holder.parentNode,s=n.getSetting("totalColumns"),a=n.getSetting("preventOverflow")==="horizontal";s?wt(i,"emptyColumns"):Ve(i,"emptyColumns");let o=!1;if(!r&&!a){const u=n.getSetting("fixedRowsTop"),c=this.cachedFixedRowsTop!==u,f=n.getSetting("columnHeaders");if((c||u===0)&&f.length>0){const g=Ct(i,"innerBorderTop");this.cachedFixedRowsTop=n.getSetting("fixedRowsTop"),e||n.getSetting("totalRows")===0?(Ve(i,"innerBorderTop"),o=!g):(wt(i,"innerBorderTop"),o=g)}}return o}}function SC(t,e,r){Xwe(t,e),e.set(t,r)}function Xwe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function mc(t,e,r){return(e=Qwe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Qwe(t){var e=Zwe(t,"string");return typeof e=="symbol"?e:e+""}function Zwe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Md(t,e,r){return t.set(fZ(t,e),r),r}function pc(t,e){return t.get(fZ(t,e))}function fZ(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var a0=new WeakMap,bC=new WeakMap,o0=new WeakMap,CC=new WeakMap;class Jwe{constructor(e,r,n,i,s,a){mc(this,"wot",null),SC(this,a0,[]),mc(this,"topOverlay",null),mc(this,"bottomOverlay",null),mc(this,"inlineStartOverlay",null),mc(this,"topInlineStartCornerOverlay",null),mc(this,"bottomInlineStartCornerOverlay",null),mc(this,"browserLineHeight",void 0),mc(this,"wtSettings",null),SC(this,bC,!1),SC(this,o0,0),SC(this,CC,null),mc(this,"resizeObserver",new ResizeObserver(f=>{S1(()=>{!Array.isArray(f)||!f.length||(Md(o0,this,pc(o0,this)+1),pc(o0,this)===100&&(br("The ResizeObserver callback was fired too many times in direct succession.\nThis may be due to an infinite loop caused by setting a dynamic height/width (for example, with the `dvh` units) to a Handsontable container's parent. \nThe observer will be disconnected."),this.resizeObserver.disconnect()),pc(CC,this)!==null&&clearTimeout(pc(CC,this)),Md(CC,this,setTimeout(()=>{Md(o0,this,0)},100)),this.wtSettings.getSetting("onContainerElementResize"))})})),this.wot=e,this.wtSettings=i,this.domBindings=n,this.facadeGetter=r,this.wtTable=a;const{rootDocument:o,rootWindow:u}=this.domBindings;this.instance=this.wot,this.eventManager=s,this.scrollbarSize=Ni(o);const c=u.getComputedStyle(a.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden";this.scrollableElement=c?a.holder:C1(a.TABLE),this.initOverlays(),this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=u.scrollX,this.lastScrollY=u.scrollY}getOverlays(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const r=[...pc(a0,this)];return e&&r.push(this.wtTable),r}initBrowserLineHeight(){const{rootWindow:e,rootDocument:r}=this.domBindings,n=e.getComputedStyle(r.body),i=parseInt(n.lineHeight,10),s=parseInt(n.fontSize,10)*1.2;this.browserLineHeight=i||s}initOverlays(){const e=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=new Kwe(...e),this.bottomOverlay=new Twe(...e),this.inlineStartOverlay=new Wwe(...e),this.topInlineStartCornerOverlay=new Ywe(...e,this.topOverlay,this.inlineStartOverlay),this.bottomInlineStartCornerOverlay=new Cwe(...e,this.bottomOverlay,this.inlineStartOverlay),Md(a0,this,[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay])}beforeDraw(){Md(bC,this,pc(a0,this).reduce((e,r)=>r.hasRenderingStateChanged()||e,!1)),pc(a0,this).forEach(e=>e.updateStateOfRendering("before"))}afterDraw(){this.syncScrollWithMaster(),pc(a0,this).forEach(e=>{const r=e.hasRenderingStateChanged();e.updateStateOfRendering("after"),r&&!e.needFullRender&&e.reset()})}refreshAll(){if(this.wot.drawn){if(!this.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}registerListeners(){const{rootDocument:e,rootWindow:r}=this.domBindings,{mainTableScrollableElement:n}=this.topOverlay,{mainTableScrollableElement:i}=this.inlineStartOverlay;this.eventManager.addEventListener(e.documentElement,"keydown",g=>this.onKeyDown(g)),this.eventManager.addEventListener(e.documentElement,"keyup",()=>this.onKeyUp()),this.eventManager.addEventListener(e,"visibilitychange",()=>this.onKeyUp()),this.eventManager.addEventListener(n,"scroll",g=>this.onTableScroll(g),{passive:!0}),n!==i&&this.eventManager.addEventListener(i,"scroll",g=>this.onTableScroll(g),{passive:!0});const s=r.devicePixelRatio&&r.devicePixelRatio>1,a=this.scrollableElement===r,o=this.wtSettings.getSetting("preventWheel"),u={passive:a};(o||s||!SF())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",g=>this.onCloneWheel(g,o),u),[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay].forEach(g=>{this.eventManager.addEventListener(g.clone.wtTable.holder,"wheel",m=>this.onCloneWheel(m,o),u)});let f;this.eventManager.addEventListener(r,"resize",()=>{S1(()=>{clearTimeout(f),this.wtSettings.getSetting("onWindowResize"),f=setTimeout(()=>{Md(o0,this,0)},200)})}),a||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}onTableScroll(e){const r=this.domBindings.rootWindow,n=this.inlineStartOverlay.mainTableScrollableElement,i=this.topOverlay.mainTableScrollableElement,s=e.target;this.keyPressed&&(i!==r&&s!==r&&!e.target.contains(i)||n!==r&&s!==r&&!e.target.contains(n))||this.syncScrollPositions(e)}onCloneWheel(e,r){const{rootWindow:n}=this.domBindings,i=this.inlineStartOverlay.mainTableScrollableElement,s=this.topOverlay.mainTableScrollableElement,a=e.target,o=s!==n&&a!==n&&!a.contains(s),u=i!==n&&a!==n&&!a.contains(i);if(this.keyPressed&&(o||u)||this.scrollableElement===n)return;const c=this.translateMouseWheelToScroll(e);(r||this.scrollableElement!==n&&c)&&e.preventDefault()}onKeyDown(e){this.keyPressed=sv(e.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}onKeyUp(){this.keyPressed=!1}translateMouseWheelToScroll(e){let r=isNaN(e.deltaY)?-1*e.wheelDeltaY:e.deltaY,n=isNaN(e.deltaX)?-1*e.wheelDeltaX:e.deltaX;e.deltaMode===1&&(n+=n*this.browserLineHeight,r+=r*this.browserLineHeight);const i=this.scrollVertically(r),s=this.scrollHorizontally(n);return i||s}scrollVertically(e){const r=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=e,r!==this.scrollableElement.scrollTop}scrollHorizontally(e){const r=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=e,r!==this.scrollableElement.scrollLeft}syncScrollPositions(){if(this.destroyed)return;const e=this.topOverlay.clone.wtTable.holder,r=this.inlineStartOverlay.clone.wtTable.holder;let n=this.scrollableElement.scrollLeft,i=this.scrollableElement.scrollTop;if(this.wot.wtViewport.isHorizontallyScrollableByWindow()&&(n=this.scrollableElement.scrollX),this.wot.wtViewport.isVerticallyScrollableByWindow()&&(i=this.scrollableElement.scrollY),this.horizontalScrolling=this.lastScrollX!==n,this.verticalScrolling=this.lastScrollY!==i,this.lastScrollX=n,this.lastScrollY=i,this.horizontalScrolling){e.scrollLeft=n;const s=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;s&&(s.scrollLeft=n)}this.verticalScrolling&&(r.scrollTop=i),this.refreshAll()}syncScrollWithMaster(){if(!pc(bC,this))return;const e=this.topOverlay.mainTableScrollableElement,{scrollLeft:r,scrollTop:n}=e;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=r),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=r),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=n),Md(bC,this,!1)}updateMainScrollableElements(){this.eventManager.clearEvents(!0),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();const{wtTable:e}=this,{rootWindow:r}=this.domBindings;r.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.scrollableElement=e.holder:this.scrollableElement=C1(e.TABLE),this.registerListeners()}destroy(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateLastSpreaderSize()&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(e),this.inlineStartOverlay.refresh(e),this.topOverlay.refresh(e),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(e),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(e)}updateLastSpreaderSize(){const e=this.wtTable.spreader,r=e.clientWidth,n=e.clientHeight,i=r!==this.spreaderLastSize.width||n!==this.spreaderLastSize.height;return i&&(this.spreaderLastSize.width=r,this.spreaderLastSize.height=n),i}adjustElementsSize(){const{wtViewport:e}=this.wot,{wtTable:r}=this,{rootWindow:n}=this.domBindings,i=this.scrollableElement===n,s=this.wtSettings.getSetting("totalColumns"),a=this.wtSettings.getSetting("totalRows"),o=e.getRowHeaderWidth(),c=e.getColumnHeaderHeight()+this.topOverlay.sumCellSizes(0,a)+1,f=o+this.inlineStartOverlay.sumCellSizes(0,s),m=r.hider.style,v=()=>i?!1:this.scrollableElement.scrollTop>Math.max(0,c-r.holder.clientHeight),w=()=>i?!1:this.scrollableElement.scrollLeft>Math.max(0,f-r.holder.clientWidth),y=v()?1:0,b=w()?1:0;m.width=`${f+b}px`,m.height=`${c+y}px`,this.topOverlay.adjustElementsSize(),this.inlineStartOverlay.adjustElementsSize(),this.bottomOverlay.adjustElementsSize()}expandHiderVerticallyBy(e){const{wtTable:r}=this;r.hider.style.height=`${parseInt(r.hider.style.height,10)+e}px`}expandHiderHorizontallyBy(e){const{wtTable:r}=this;r.hider.style.width=`${parseInt(r.hider.style.width,10)+e}px`}applyToDOM(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}getParentOverlay(e){if(!e)return null;const r=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];let n=null;return he(r,i=>{i&&i.clone&&i.clone.wtTable.TABLE.contains(e)&&(n=i.clone)}),n}syncOverlayTableClassNames(){const e=this.wtTable.TABLE,r=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];he(r,n=>{n&&(n.clone.wtTable.TABLE.className=e.className)})}}function H9(t,e,r){return(e=eye(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function eye(t){var e=tye(t,"string");return typeof e=="symbol"?e:e+""}function tye(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class rye{constructor(e){H9(this,"settings",{}),H9(this,"defaults",Object.freeze(this.getDefaults())),Wt(this.defaults,(r,n)=>{if(e[n]!==void 0)this.settings[n]=e[n];else{if(r===void 0)throw new Error(`A required setting "${n}" was not provided`);this.settings[n]=r}})}getDefaults(){return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,currentRowClassName:null,currentColumnClassName:null,preventOverflow(){return!1},preventWheel:!1,data:void 0,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:()=>this.getSetting("fixedColumnsStart")>0||this.getSetting("rowHeaders").length>0,shouldRenderTopOverlay:()=>this.getSetting("fixedRowsTop")>0||this.getSetting("columnHeaders").length>0,shouldRenderBottomOverlay:()=>this.getSetting("fixedRowsBottom")>0,minSpareRows:0,rowHeaders(){return[]},columnHeaders(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:(e,r,n)=>{const i=this.getSetting("data",e,r);Bf(n,i??"")},columnWidth(){},rowHeight(){},rowHeightByOverlayName(){},defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,viewportRowRenderingThreshold:null,viewportColumnRenderingThreshold:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onBeforeViewportScrollHorizontally:e=>e,onBeforeViewportScrollVertically:e=>e,onScrollHorizontally:null,onScrollVertically:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onModifyGetCoordsElement:null,onModifyGetCoords:null,onBeforeHighlightingRowHeader:e=>e,onBeforeHighlightingColumnHeader:e=>e,onWindowResize:null,onContainerElementResize:null,renderAllColumns:!1,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1,ariaTags:!0,stylesHandler:null}}update(e,r){return r===void 0?Wt(e,(n,i)=>{this.settings[i]=n}):this.settings[e]=r,this}getSetting(e,r,n,i,s){return typeof this.settings[e]=="function"?this.settings[e](r,n,i,s):r!==void 0&&Array.isArray(this.settings[e])?this.settings[e][r]:this.settings[e]}getSettingPure(e){return this.settings[e]}has(e){return!!this.settings[e]}}class tL extends av{constructor(e,r,n,i){super(e,r,n,i,"master")}alignOverlaysWithTrimmingContainer(){const e=Ap(this.wtRootElement),{rootWindow:r}=this.domBindings;if(e===r)this.wtSettings.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible");else{const n=e.parentElement,i=x1(e,"height",r),s=x1(e,"overflow",r),a=this.holder.style,{scrollWidth:o,scrollHeight:u}=e;let c=e.offsetWidth,f=e.offsetHeight;if(n&&["auto","hidden","scroll"].includes(s)){const m=e.cloneNode(!1);m.style.overflow="auto",m.style.position="absolute",e.nextElementSibling?n.insertBefore(m,e.nextElementSibling):n.appendChild(m);const v=parseInt(r.getComputedStyle(m).height,10);n.removeChild(m),v===0&&(f=0)}f=Math.min(f,u),a.height=i==="auto"?"auto":`${f}px`,c=Math.min(c,o),a.width=`${c}px`,a.overflow="",this.hasTableHeight=a.height==="auto"?!0:f>0,this.hasTableWidth=c>0}this.isTableVisible=Ig(this.TABLE)}markOversizedColumnHeaders(){const{wtSettings:e}=this,{wtViewport:r}=this.dataAccessObject,n="master",s=e.getSetting("columnHeaders").length;if(s&&!r.hasOversizedColumnHeadersMarked[n]){const o=e.getSetting("rowHeaders").length,u=this.getRenderedColumnsCount();for(let c=0;c<s;c++)for(let f=-1*o;f<u;f++)this.markIfOversizedColumnHeader(f);r.hasOversizedColumnHeadersMarked[n]=!0}}}Lr(tL,zF);Lr(tL,XR);class nye{constructor(e,r,n,i,s){this.dataAccessObject=e,this.wot=e.wot,this.instance=this.wot,this.domBindings=r,this.wtSettings=n,this.wtTable=s,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.rowsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllRows")?new Npe:new Wpe],["fullyVisible",()=>new _pe],["partiallyVisible",()=>new JQ]]),this.columnsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllColumns")?new Dpe:new Lpe],["fullyVisible",()=>new Cpe],["partiallyVisible",()=>new ZQ]]),this.eventManager=i,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",()=>{this.clientHeight=this.getWorkspaceHeight()})}getWorkspaceHeight(){const e=this.domBindings.rootDocument,r=this.dataAccessObject.topOverlayTrimmingContainer;let n=0;return r===this.domBindings.rootWindow?n=e.documentElement.clientHeight:n=ai(r)>0&&r.clientHeight>0?r.clientHeight:1/0,n}getViewportHeight(){let e=this.getWorkspaceHeight();if(e===1/0)return e;const r=this.getColumnHeaderHeight();return r>0&&(e-=r),e}getWorkspaceWidth(){const{rootDocument:e,rootWindow:r}=this.domBindings,n=this.dataAccessObject.inlineStartOverlayTrimmingContainer;let i;if(n===r){const s=this.wtSettings.getSetting("totalColumns");i=this.wtTable.holder.offsetWidth,this.getRowHeaderWidth()+this.sumColumnWidths(0,s)>i&&(i=e.documentElement.clientWidth)}else i=n.clientWidth;return i}getViewportWidth(){const e=this.getWorkspaceWidth();if(e===1/0)return e;const r=this.getRowHeaderWidth();return r>0?e-r:e}hasVerticalScroll(){if(this.isVerticallyScrollableByWindow()){const s=this.domBindings.rootDocument.documentElement;return s.scrollHeight>s.clientHeight}const{holder:e,hider:r}=this.wtTable,n=e.clientHeight,i=r.offsetHeight;return n<i?!0:i>this.getWorkspaceHeight()}hasHorizontalScroll(){if(this.isVerticallyScrollableByWindow()){const s=this.domBindings.rootDocument.documentElement;return s.scrollWidth>s.clientWidth}const{holder:e,hider:r}=this.wtTable,n=e.clientWidth,i=r.offsetWidth;return n<i?!0:i>this.getWorkspaceWidth()}isVerticallyScrollableByWindow(){return this.dataAccessObject.topOverlayTrimmingContainer===this.domBindings.rootWindow}isHorizontallyScrollableByWindow(){return this.dataAccessObject.inlineStartOverlayTrimmingContainer===this.domBindings.rootWindow}sumColumnWidths(e,r){let n=0,i=e;for(;i<r;)n+=this.wtTable.getColumnWidth(i),i+=1;return n}getWorkspaceOffset(){return ns(this.wtTable.holder)}getColumnHeaderHeight(){return this.wtSettings.getSetting("columnHeaders").length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=ai(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}getRowHeaderWidth(){const e=this.wtSettings.getSetting("rowHeaderWidth"),r=this.wtSettings.getSetting("rowHeaders");if(e){this.rowHeaderWidth=0;for(let n=0,i=r.length;n<i;n++)this.rowHeaderWidth+=e[n]||e}if(isNaN(this.rowHeaderWidth))if(r.length){let n=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(let i=0,s=r.length;i<s;i++)n?(this.rowHeaderWidth+=Un(n),n=n.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}createRowsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:r,wtTable:n}=this;let i=this.getViewportHeight(),s,a;this.rowHeaderWidth=NaN;let o=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset;const u=r.getSetting("fixedRowsTop"),c=r.getSetting("fixedRowsBottom"),f=r.getSetting("totalRows");return u&&o>=0&&(a=this.dataAccessObject.topOverlay.sumCellSizes(0,u),o+=a,i-=a),c&&this.dataAccessObject.bottomOverlay.clone&&(a=this.dataAccessObject.bottomOverlay.sumCellSizes(f-c,f),i-=a),n.holder.clientHeight===n.holder.offsetHeight?s=0:s=Ni(this.domBindings.rootDocument),new Kpe({calculationTypes:e.map(g=>[g,this.rowsCalculatorTypes.get(g)()]),viewportHeight:i,scrollOffset:o,totalRows:r.getSetting("totalRows"),defaultRowHeight:r.getSetting("stylesHandler").getDefaultRowHeight(),rowHeightFn:g=>n.getRowHeight(g),overrideFn:r.getSettingPure("viewportRowCalculatorOverride"),horizontalScrollbarHeight:s})}createColumnsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:r,wtTable:n}=this;let i=this.getViewportWidth(),s=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;const a=r.getSetting("fixedColumnsStart");if(a&&s>=0){const o=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,a);s+=o,i-=o}return n.holder.clientWidth!==n.holder.offsetWidth&&(i-=Ni(this.domBindings.rootDocument)),new zpe({calculationTypes:e.map(o=>[o,this.columnsCalculatorTypes.get(o)()]),viewportWidth:i,scrollOffset:s,totalColumns:r.getSetting("totalColumns"),columnWidthFn:o=>n.getColumnWidth(o),overrideFn:r.getSettingPure("viewportColumnCalculatorOverride"),inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}createCalculators(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:r}=this,n=this.createRowsCalculator(),i=this.createColumnsCalculator();if(e&&!r.getSetting("renderAllRows")){const s=n.getResultsFor("fullyVisible");e=this.areAllProposedVisibleRowsAlreadyRendered(s)}if(e&&!r.getSetting("renderAllColumns")){const s=i.getResultsFor("fullyVisible");e=this.areAllProposedVisibleColumnsAlreadyRendered(s)}return e||(this.rowsRenderCalculator=n.getResultsFor("rendered"),this.columnsRenderCalculator=i.getResultsFor("rendered")),this.rowsVisibleCalculator=n.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=i.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=n.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=i.getResultsFor("partiallyVisible"),e}createVisibleCalculators(){const e=this.createRowsCalculator(["fullyVisible","partiallyVisible"]),r=this.createColumnsCalculator(["fullyVisible","partiallyVisible"]);this.rowsVisibleCalculator=e.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=r.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=e.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=r.getResultsFor("partiallyVisible")}areAllProposedVisibleRowsAlreadyRendered(e){if(!this.rowsVisibleCalculator)return!1;let{startRow:r,endRow:n}=e;if(r===null&&n===null){if(!e.isVisibleInTrimmingContainer)return!0;r=this.rowsPartiallyVisibleCalculator.startRow,n=this.rowsPartiallyVisibleCalculator.endRow}const{startRow:i,endRow:s,rowStartOffset:a,rowEndOffset:o}=this.rowsRenderCalculator,u=this.wtSettings.getSetting("totalRows")-1,c=this.wtSettings.getSetting("viewportRowRenderingThreshold");return Number.isInteger(c)&&c>0?(r=Math.max(0,r-Math.min(a,c)),n=Math.min(u,n+Math.min(o,c))):c==="auto"&&(r=Math.max(0,r-Math.ceil(a/2)),n=Math.min(u,n+Math.ceil(o/2))),r<i||r===i&&r>0?!1:!(n>s||n===s&&n<u)}areAllProposedVisibleColumnsAlreadyRendered(e){if(!this.columnsVisibleCalculator)return!1;let{startColumn:r,endColumn:n}=e;if(r===null&&n===null){if(!e.isVisibleInTrimmingContainer)return!0;r=this.columnsPartiallyVisibleCalculator.startColumn,n=this.columnsPartiallyVisibleCalculator.endColumn}const{startColumn:i,endColumn:s,columnStartOffset:a,columnEndOffset:o}=this.columnsRenderCalculator,u=this.wtSettings.getSetting("totalColumns")-1,c=this.wtSettings.getSetting("viewportColumnRenderingThreshold");return Number.isInteger(c)&&c>0?(r=Math.max(0,r-Math.min(a,c)),n=Math.min(u,n+Math.min(o,c))):c==="auto"&&(r=Math.max(0,r-Math.ceil(a/2)),n=Math.min(u,n+Math.ceil(o/2))),r<i||r===i&&r>0?!1:!(n>s||n===s&&n<u)}resetHasOversizedColumnHeadersMarked(){Wt(this.hasOversizedColumnHeadersMarked,(e,r,n)=>{n[r]=void 0})}}class iye extends jF{constructor(e,r){super(e,new rye(r));const n=this.wtSettings.getSetting("facade",this);this.wtTable=new tL(this.getTableDao(),n,this.domBindings,this.wtSettings),this.wtViewport=new nye(this.getViewportDao(),this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.selectionManager=new Bwe(this.wtSettings.getSetting("selections")),this.wtEvent=new iZ(n,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager),this.wtOverlays=new Jwe(this,n,this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.exportSettingsAsClassNames(),this.findOriginalHeaders()}exportSettingsAsClassNames(){const e={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},r=[],n=[];Wt(e,(i,s)=>{this.wtSettings.getSetting(s).length&&n.push(i),r.push(i)}),wt(this.wtTable.wtRootElement.parentNode,r),Ve(this.wtTable.wtRootElement.parentNode,n)}getOverlayByName(e){var r;if(!oZ.includes(e))return null;const n=e.replace(/_([a-z])/g,i=>i[1].toUpperCase());return(r=this.wtOverlays[`${n}Overlay`])!==null&&r!==void 0?r:null}getViewportDao(){const e=this;return{get wot(){return e},get topOverlayTrimmingContainer(){return e.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return e.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return e.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return e.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return e.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return e.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get bottomOverlay(){return e.wtOverlays.bottomOverlay}}}}class rL{constructor(e){e instanceof jF?this._wot=e:this._initFromSettings(e)}_initFromSettings(e){e.facade=r=>{const n=new rL(r);return()=>n},this._wot=new iye(e.table,e)}get guid(){return this._wot.guid}get rootDocument(){return this._wot.domBindings.rootDocument}get rootWindow(){return this._wot.domBindings.rootWindow}get wtSettings(){return this._wot.wtSettings}get cloneSource(){return this._wot.cloneSource}get cloneOverlay(){return this._wot.cloneOverlay}get selectionManager(){return this._wot.selectionManager}get wtViewport(){return this._wot.wtViewport}get wtOverlays(){return this._wot.wtOverlays}get wtTable(){return this._wot.wtTable}get wtEvent(){return this._wot.wtEvent}get wtScroll(){return this._wot.wtScroll}get drawn(){return this._wot.drawn}set drawn(e){this._wot.drawn=e}get activeOverlayName(){return this._wot.activeOverlayName}get drawInterrupted(){return this._wot.drawInterrupted}set drawInterrupted(e){this._wot.drawInterrupted=e}get lastMouseOver(){return this._wot.lastMouseOver}set lastMouseOver(e){this._wot.lastMouseOver=e}get momentumScrolling(){return this._wot.momentumScrolling}set momentumScrolling(e){this._wot.momentumScrolling=e}get touchApplied(){return this._wot.touchApplied}set touchApplied(e){this._wot.touchApplied=e}get domBindings(){return this._wot.domBindings}get eventListeners(){return this._wot.eventListeners}set eventListeners(e){this._wot.eventListeners=e}get eventManager(){return this._wot.eventManager}createCellCoords(e,r){return this._wot.createCellCoords(e,r)}createCellRange(e,r,n){return this._wot.createCellRange(e,r,n)}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this._wot.draw(e),this}getCell(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._wot.getCell(e,r)}scrollViewport(e,r,n){return this._wot.scrollViewport(e,r,n)}scrollViewportHorizontally(e,r){return this._wot.scrollViewportHorizontally(e,r)}scrollViewportVertically(e,r){return this._wot.scrollViewportVertically(e,r)}getViewport(){return this._wot.getViewport()}getOverlayName(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}getOverlayByName(e){return this._wot.getOverlayByName(e)}exportSettingsAsClassNames(){return this._wot.exportSettingsAsClassNames()}update(e,r){return this._wot.wtSettings.update(e,r),this}getSetting(e,r,n,i,s){return this._wot.wtSettings.getSetting(e,r,n,i,s)}hasSetting(e){return this._wot.wtSettings.hasSetting(e)}destroy(){this._wot.destroy()}}function F9(t){let{isShiftKey:e,isLeftClick:r,isRightClick:n,coords:i,selection:s,controller:a,cellCoordsFactory:o}=t;const u=s.isSelected()?s.getSelectedRange().current():null,c=s.isSelectedByCorner(),f=s.isSelectedByRowHeader();if(s.markSource("mouse"),e&&u)i.row>=0&&i.col>=0&&!a.cell?s.setRangeEnd(i):(c||f)&&i.row>=0&&i.col>=0&&!a.cell?s.setRangeEnd(o(i.row,i.col)):c&&i.row<0&&!a.column?s.setRangeEnd(o(u.to.row,i.col)):f&&i.col<0&&!a.row?s.setRangeEnd(o(i.row,u.to.col)):(!c&&!f&&i.col<0||c&&i.col<0)&&!a.row?s.selectRows(Math.max(u.from.row,0),i.row,i.col):(!c&&!f&&i.row<0||f&&i.row<0)&&!a.column&&s.selectColumns(Math.max(u.from.col,0),i.col,i.row);else{const g=!s.inInSelection(i),m=r||n&&g;i.row<0&&i.col>=0&&!a.column?m&&s.selectColumns(i.col,i.col,i.row):i.col<0&&i.row>=0&&!a.row?m&&s.selectRows(i.row,i.row,i.col):i.col>=0&&i.row>=0&&!a.cell?m&&s.setRangeStart(i):i.col<0&&i.row<0&&s.selectAll(!0,!0,{disableHeadersHighlight:!0,focusPosition:{row:0,col:0}})}s.markEndSource()}function sye(t){let{isLeftClick:e,coords:r,selection:n,controller:i,cellCoordsFactory:s}=t;if(!e)return;const a=n.isSelectedByRowHeader(),o=n.isSelectedByColumnHeader(),u=n.tableProps.countCols(),c=n.tableProps.countRows();n.markSource("mouse"),o&&!i.column?n.setRangeEnd(s(c-1,r.col)):a&&!i.row?n.setRangeEnd(s(r.row,u-1)):i.cell||n.setRangeEnd(r),n.markEndSource()}function L9(t){let{isLeftClick:e,selection:r,cellRangeMapper:n}=t;if(!e||r.settings.selectionMode!=="multiple")return;const i=r.getSelectedRange(),s=i.clone().map(o=>n.toRenderable(o)),a=s.current();if(s.size()>1&&!a.isHeader()&&!r.isMultiple(a)){const o=s.findAll(a);o.length===s.size()?(i.pop(),r.refresh()):o.length>1&&(i.removeLayers(o.map(u=>{let{layer:c}=u;return c})),r.refresh())}}const aye=new Map([["touchstart",F9],["touchend",L9],["mousedown",F9],["mouseover",sye],["mouseup",L9]]);function u2(t,e){aye.get(t.type)({isShiftKey:t.shiftKey,isLeftClick:zR(t)||t.type==="touchstart",isRightClick:Vf(t),...e})}const dZ=new WeakMap,nL=Symbol("rootInstance");function oye(t){dZ.set(t,!0)}function lye(t){return t===nL}function Y0(t){return dZ.has(t)}function uye(t,e){gZ(t,e),e.add(t)}function Wh(t,e,r){gZ(t,e),e.set(t,r)}function gZ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function $h(t,e,r){return(e=cye(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function cye(t){var e=hye(t,"string");return typeof e=="symbol"?e:e+""}function hye(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Jn(t,e){return t.get(gp(t,e))}function ra(t,e,r){return t.set(gp(t,e),r),r}function gp(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var c2=new WeakMap,xC=new WeakMap,EC=new WeakMap,vc=new WeakMap,ul=new WeakMap,h2=new WeakMap,f2=new WeakMap,l0=new WeakMap,Cy=new WeakSet;class fye{constructor(e){uye(this,Cy),$h(this,"hot",void 0),$h(this,"eventManager",void 0),$h(this,"settings",void 0),$h(this,"THEAD",void 0),$h(this,"TBODY",void 0),$h(this,"_wt",void 0),$h(this,"activeWt",void 0),Wh(this,c2,0),Wh(this,xC,0),$h(this,"postponedAdjustElementsSize",!1),Wh(this,EC,!1),Wh(this,vc,void 0),Wh(this,ul,void 0),Wh(this,h2,0),Wh(this,f2,0),Wh(this,l0,null),this.hot=e,this.eventManager=new Uo(this.hot),this.settings=this.hot.getSettings(),this.createElements(),this.registerEvents(),this.initializeWalkontable()}render(){if(!this.hot.isRenderSuspended()){const e=this.hot.forceFullRender;this.hot.runHooks("beforeRender",e),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize()),this._wt.draw(!e),gp(Cy,this,gye).call(this),this.hot.runHooks("afterRender",e),this.hot.forceFullRender=!1}}adjustElementsSize(){this.hot.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize()}getCellAtCoords(e,r){const n=this._wt.getCell(e,r);return n<0?null:n}scrollViewport(e,r,n){return this._wt.scrollViewport(e,r,n)}scrollViewportHorizontally(e,r){return this._wt.scrollViewportHorizontally(e,r)}scrollViewportVertically(e,r){return this._wt.scrollViewportVertically(e,r)}createElements(){const{rootElement:e,rootDocument:r}=this.hot,n=e.getAttribute("style");n&&e.setAttribute("data-originalstyle",n),Ve(e,"handsontable"),ra(ul,this,r.createElement("TABLE")),Ve(Jn(ul,this),"htCore"),this.hot.getSettings().tableClassName&&Ve(Jn(ul,this),this.hot.getSettings().tableClassName),this.settings.ariaTags&&(bt(Jn(ul,this),[Lc()]),bt(e,[vme(),uQ(-1),BR(this.hot.countCols()),Dme()])),this.THEAD=r.createElement("THEAD"),Jn(ul,this).appendChild(this.THEAD),this.TBODY=r.createElement("TBODY"),Jn(ul,this).appendChild(this.TBODY),this.hot.table=Jn(ul,this),this.hot.container.insertBefore(Jn(ul,this),this.hot.container.firstChild)}registerEvents(){const{rootElement:e,rootDocument:r,selection:n,rootWindow:i}=this.hot,s=r.documentElement;this.eventManager.addEventListener(e,"mousedown",o=>{ra(EC,this,!0),this.isTextSelectionAllowed(o.target)||(rN(i),o.preventDefault(),i.focus())}),this.eventManager.addEventListener(e,"mouseup",()=>{ra(EC,this,!1)}),this.eventManager.addEventListener(e,"mousemove",o=>{Jn(EC,this)&&!this.isTextSelectionAllowed(o.target)&&(this.settings.fragmentSelection&&rN(i),o.preventDefault())}),this.eventManager.addEventListener(s,"keyup",o=>{n.isInProgress()&&!o.shiftKey&&n.finish()}),this.eventManager.addEventListener(s,"mouseup",o=>{n.isInProgress()&&zR(o)&&n.finish(),ra(vc,this,!1);const u=YR(r.activeElement);Fy(r.activeElement)&&!u||(u||!n.isSelected()&&!n.isSelectedByAnyHeader()&&!e.contains(o.target)&&!Vf(o))&&this.hot.unlisten()}),this.eventManager.addEventListener(s,"contextmenu",o=>{n.isInProgress()&&Vf(o)&&(n.finish(),ra(vc,this,!1))}),this.eventManager.addEventListener(s,"touchend",()=>{n.isInProgress()&&n.finish(),ra(vc,this,!1)}),this.eventManager.addEventListener(s,"mousedown",o=>{const u=o.target,c=o.x||o.clientX,f=o.y||o.clientY;let g=o.target;if(Jn(vc,this)||!e||!this.hot.view)return;const{holder:m}=this._wt.wtTable;if(g===m){const w=Ni(r);if(r.elementFromPoint(c+w,f)!==m||r.elementFromPoint(c,f+w)!==m)return}else for(;g!==s;){if(g===null){if(o.isTargetWebComponent)break;return}if(g===e)return;g=g.parentNode}(typeof this.settings.outsideClickDeselects=="function"?this.settings.outsideClickDeselects(u):this.settings.outsideClickDeselects)?this.hot.deselectCell():this.hot.destroyEditor(!1,!1)});let a=Pg(i);for(;a!==null;)this.eventManager.addEventListener(a.document.documentElement,"click",()=>{this.hot.unlisten()}),a=Pg(a);this.eventManager.addEventListener(Jn(ul,this),"selectstart",o=>{this.settings.fragmentSelection||Fy(o.target)||o.preventDefault()})}translateFromRenderableToVisualCoords(e){let{row:r,col:n}=e;return this.hot._createCellCoords(...this.translateFromRenderableToVisualIndex(r,n))}translateFromRenderableToVisualIndex(e,r){let n=e>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(e):e,i=r>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(r):r;return n===null&&(n=e),i===null&&(i=r),[n,i]}countRenderableIndexes(e,r){const n=Math.min(e.getNotTrimmedIndexesLength(),r),i=e.getNearestNotHiddenIndex(n-1,-1);return i===null?0:e.getRenderableFromVisualIndex(i)+1}countRenderableColumns(){return this.countRenderableIndexes(this.hot.columnIndexMapper,this.settings.maxCols)}countRenderableRows(){return this.countRenderableIndexes(this.hot.rowIndexMapper,this.settings.maxRows)}countNotHiddenRowIndexes(e,r){return this.countNotHiddenIndexes(e,r,this.hot.rowIndexMapper,this.countRenderableRows())}countNotHiddenColumnIndexes(e,r){return this.countNotHiddenIndexes(e,r,this.hot.columnIndexMapper,this.countRenderableColumns())}countNotHiddenIndexes(e,r,n,i){if(isNaN(e)||e<0)return 0;const s=n.getNearestNotHiddenIndex(e,r),a=n.getRenderableFromVisualIndex(s);if(!Number.isInteger(a))return 0;let o=0;return r<0?o=a+1:r>0&&(o=i-a),o}countNotHiddenFixedColumnsStart(){const e=this.hot.countCols(),r=Math.min(parseInt(this.settings.fixedColumnsStart,10),e)-1;return this.countNotHiddenColumnIndexes(r,-1)}countNotHiddenFixedRowsTop(){const e=this.hot.countRows(),r=Math.min(parseInt(this.settings.fixedRowsTop,10),e)-1;return this.countNotHiddenRowIndexes(r,-1)}countNotHiddenFixedRowsBottom(){const e=this.hot.countRows(),r=Math.max(e-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(r,1)}countRenderableColumnsInRange(e,r){let n=0;for(let i=e;i<=r;i++)this.hot.columnIndexMapper.getRenderableFromVisualIndex(i)!==null&&(n+=1);return n}countRenderableRowsInRange(e,r){let n=0;for(let i=e;i<=r;i++)this.hot.rowIndexMapper.getRenderableFromVisualIndex(i)!==null&&(n+=1);return n}addClassNameToLicenseElement(e){var r;const n=(r=this.hot.rootElement.parentNode)===null||r===void 0?void 0:r.querySelector(".hot-display-license-info");n&&Ve(n,e)}removeClassNameFromLicenseElement(e){var r;const n=(r=this.hot.rootElement.parentNode)===null||r===void 0?void 0:r.querySelector(".hot-display-license-info");n&&wt(n,e)}isMainTableNotFullyCoveredByOverlays(){const e=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),r=this.countNotHiddenFixedColumnsStart();return this.hot.countRenderedRows()>e&&this.hot.countRenderedCols()>r}initializeWalkontable(){const e={ariaTags:this.settings.ariaTags,rtlMode:this.hot.isRtl(),externalRowCalculator:this.hot.getPlugin("autoRowSize")&&this.hot.getPlugin("autoRowSize").isEnabled(),table:Jn(ul,this),isDataViewInstance:()=>Y0(this.hot),preventOverflow:()=>this.settings.preventOverflow,preventWheel:()=>this.settings.preventWheel,viewportColumnRenderingThreshold:()=>this.settings.viewportColumnRenderingThreshold,viewportRowRenderingThreshold:()=>this.settings.viewportRowRenderingThreshold,data:(s,a)=>this.hot.getDataAtCell(...this.translateFromRenderableToVisualIndex(s,a)),totalRows:()=>this.countRenderableRows(),totalColumns:()=>this.countRenderableColumns(),fixedColumnsStart:()=>this.countNotHiddenFixedColumnsStart(),fixedRowsTop:()=>this.countNotHiddenFixedRowsTop(),fixedRowsBottom:()=>this.countNotHiddenFixedRowsBottom(),shouldRenderInlineStartOverlay:()=>this.settings.fixedColumnsStart>0||e.rowHeaders().length>0,shouldRenderTopOverlay:()=>this.settings.fixedRowsTop>0||e.columnHeaders().length>0,shouldRenderBottomOverlay:()=>this.settings.fixedRowsBottom>0,minSpareRows:()=>this.settings.minSpareRows,renderAllRows:this.settings.renderAllRows,renderAllColumns:this.settings.renderAllColumns,rowHeaders:()=>{const s=[];return this.hot.hasRowHeaders()&&s.push((a,o)=>{const u=a>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(a):a;this.appendRowHeader(u,o)}),this.hot.runHooks("afterGetRowHeaderRenderers",s),ra(xC,this,s.length),this.hot.getSettings().ariaTags&&gp(Cy,this,mZ).call(this)===this.hot.countCols()&&gp(Cy,this,dye).call(this,Jn(xC,this)),s},columnHeaders:()=>{const s=[];return this.hot.hasColHeaders()&&s.push((a,o)=>{const u=a>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(a):a;this.appendColHeader(u,o)}),this.hot.runHooks("afterGetColumnHeaderRenderers",s),ra(c2,this,s.length),s},columnWidth:s=>{const a=this.hot.columnIndexMapper.getVisualFromRenderableIndex(s);return this.hot.getColWidth(a===null?s:a)},rowHeight:s=>{const a=this.hot.rowIndexMapper.getVisualFromRenderableIndex(s);return this.hot.getRowHeight(a===null?s:a)},rowHeightByOverlayName:(s,a)=>{const o=this.hot.rowIndexMapper.getVisualFromRenderableIndex(s),u=o===null?s:o;return this.hot.runHooks("modifyRowHeightByOverlayName",this.hot.getRowHeight(u),u,a)},cellRenderer:(s,a,o)=>{const[u,c]=this.translateFromRenderableToVisualIndex(s,a),f=this.hot.runHooks("modifyGetCellCoords",u,c,!1,"meta");let g=u,m=c;Array.isArray(f)&&([g,m]=f);const v=this.hot.getCellMeta(g,m),w=this.hot.colToProp(m);let y=this.hot.getDataAtRowProp(g,w);this.hot.hasHook("beforeValueRender")&&(y=this.hot.runHooks("beforeValueRender",y,v)),this.hot.runHooks("beforeRenderer",o,u,c,w,y,v),this.hot.getCellRenderer(v)(this.hot,o,u,c,w,y,v),this.hot.runHooks("afterRenderer",o,u,c,w,y,v)},selections:this.hot.selection.highlight,hideBorderOnMouseDownOver:()=>this.settings.fragmentSelection,onWindowResize:()=>{this.hot&&!this.hot.isDestroyed&&this.hot.refreshDimensions()},onContainerElementResize:()=>{this.hot&&!this.hot.isDestroyed&&Ig(this.hot.rootElement)&&this.hot.refreshDimensions()},onCellMouseDown:(s,a,o,u)=>{const c=this.translateFromRenderableToVisualCoords(a),f={row:!1,column:!1,cell:!1};this.hot.listen(),this.activeWt=u,ra(vc,this,!0),ra(l0,this,{x:s.clientX,y:s.clientY}),this.hot.runHooks("beforeOnCellMouseDown",s,c,o,f),!gf(s)&&(u2(s,{coords:c,selection:this.hot.selection,controller:f,cellCoordsFactory:(g,m)=>this.hot._createCellCoords(g,m)}),this.hot.runHooks("afterOnCellMouseDown",s,c,o),this.activeWt=this._wt)},onCellContextMenu:(s,a,o,u)=>{const c=this.translateFromRenderableToVisualCoords(a);this.activeWt=u,ra(vc,this,!1),this.hot.selection.isInProgress()&&this.hot.selection.finish(),this.hot.runHooks("beforeOnCellContextMenu",s,c,o),!gf(s)&&(this.hot.runHooks("afterOnCellContextMenu",s,c,o),this.activeWt=this._wt)},onCellMouseOut:(s,a,o,u)=>{const c=this.translateFromRenderableToVisualCoords(a);this.activeWt=u,this.hot.runHooks("beforeOnCellMouseOut",s,c,o),!gf(s)&&(this.hot.runHooks("afterOnCellMouseOut",s,c,o),this.activeWt=this._wt)},onCellMouseOver:(s,a,o,u)=>{const c=this.translateFromRenderableToVisualCoords(a),f={row:!1,column:!1,cell:!1};this.activeWt=u,this.hot.runHooks("beforeOnCellMouseOver",s,c,o,f),!gf(s)&&(Jn(vc,this)&&(!Jn(l0,this)||Jn(l0,this).x!==s.clientX||Jn(l0,this).y!==s.clientY)&&u2(s,{coords:c,selection:this.hot.selection,controller:f,cellCoordsFactory:(g,m)=>this.hot._createCellCoords(g,m)}),this.hot.runHooks("afterOnCellMouseOver",s,c,o),this.activeWt=this._wt,ra(l0,this,null))},onCellMouseUp:(s,a,o,u)=>{const c=this.translateFromRenderableToVisualCoords(a);this.activeWt=u,this.hot.runHooks("beforeOnCellMouseUp",s,c,o),!(gf(s)||this.hot.isDestroyed)&&(u2(s,{coords:c,selection:this.hot.selection,cellRangeMapper:E0e(this.hot,"cellRangeMapper")}),this.hot.runHooks("afterOnCellMouseUp",s,c,o),this.activeWt=this._wt)},onCellCornerMouseDown:s=>{s.preventDefault(),this.hot.runHooks("afterOnCellCornerMouseDown",s)},onCellCornerDblClick:s=>{s.preventDefault(),this.hot.runHooks("afterOnCellCornerDblClick",s)},beforeDraw:(s,a)=>this.beforeRender(s,a),onDraw:s=>this.afterRender(s),onBeforeViewportScrollVertically:(s,a)=>{const o=this.hot.rowIndexMapper,u=s<0;let c=s;return!u&&(c=o.getVisualFromRenderableIndex(s),c===null)?s:(c=this.hot.runHooks("beforeViewportScrollVertically",c,a),this.hot.runHooks("beforeViewportScroll"),u?c:o.getRenderableFromVisualIndex(c))},onBeforeViewportScrollHorizontally:(s,a)=>{const o=this.hot.columnIndexMapper,u=s<0;let c=s;return!u&&(c=o.getVisualFromRenderableIndex(s),c===null)?s:(c=this.hot.runHooks("beforeViewportScrollHorizontally",c,a),this.hot.runHooks("beforeViewportScroll"),u?c:o.getRenderableFromVisualIndex(c))},onScrollVertically:()=>{this.hot.runHooks("afterScrollVertically"),this.hot.runHooks("afterScroll")},onScrollHorizontally:()=>{this.hot.runHooks("afterScrollHorizontally"),this.hot.runHooks("afterScroll")},onBeforeRemoveCellClassNames:()=>this.hot.runHooks("beforeRemoveCellClassNames"),onBeforeHighlightingRowHeader:(s,a,o)=>{const u=this.hot.rowIndexMapper,c=s<0;let f=s;c||(f=u.getVisualFromRenderableIndex(s));const g=this.hot.runHooks("beforeHighlightingRowHeader",f,a,o);return c?g:u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(g,1))},onBeforeHighlightingColumnHeader:(s,a,o)=>{const u=this.hot.columnIndexMapper,c=s<0;let f=s;c||(f=u.getVisualFromRenderableIndex(s));const g=this.hot.runHooks("beforeHighlightingColumnHeader",f,a,o);return c?g:u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(g,1))},onAfterDrawSelection:(s,a,o)=>{let u;const[c,f]=this.translateFromRenderableToVisualIndex(s,a),g=this.hot.selection.getSelectedRange();if(g.size()>0){const v=g.peekByIndex(o??0);u=[v.from.row,v.from.col,v.to.row,v.to.col]}return this.hot.runHooks("afterDrawSelection",c,f,u,o)},onBeforeDrawBorders:(s,a)=>{const[o,u,c,f]=s,g=[this.hot.rowIndexMapper.getVisualFromRenderableIndex(o),this.hot.columnIndexMapper.getVisualFromRenderableIndex(u),this.hot.rowIndexMapper.getVisualFromRenderableIndex(c),this.hot.columnIndexMapper.getVisualFromRenderableIndex(f)];return this.hot.runHooks("beforeDrawBorders",g,a)},onBeforeTouchScroll:()=>this.hot.runHooks("beforeTouchScroll"),onAfterMomentumScroll:()=>this.hot.runHooks("afterMomentumScroll"),onModifyRowHeaderWidth:s=>this.hot.runHooks("modifyRowHeaderWidth",s),onModifyGetCellCoords:(s,a,o,u)=>{const c=this.hot.rowIndexMapper,f=this.hot.columnIndexMapper,g=a>=0?f.getVisualFromRenderableIndex(a):a,m=s>=0?c.getVisualFromRenderableIndex(s):s,v=this.hot.runHooks("modifyGetCellCoords",m,g,o,u);if(Array.isArray(v)){const[w,y,b,x]=v;return[w>=0?c.getRenderableFromVisualIndex(c.getNearestNotHiddenIndex(w,1)):w,y>=0?f.getRenderableFromVisualIndex(f.getNearestNotHiddenIndex(y,1)):y,b>=0?c.getRenderableFromVisualIndex(c.getNearestNotHiddenIndex(b,-1)):b,x>=0?f.getRenderableFromVisualIndex(f.getNearestNotHiddenIndex(x,-1)):x]}},onModifyGetCoordsElement:(s,a)=>{const o=this.hot.rowIndexMapper,u=this.hot.columnIndexMapper,c=a>=0?u.getVisualFromRenderableIndex(a):a,f=s>=0?o.getVisualFromRenderableIndex(s):s,g=this.hot.runHooks("modifyGetCoordsElement",f,c);if(Array.isArray(g)){const[m,v]=g;return[m>=0?o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(m,1)):m,v>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(v,1)):v]}},viewportRowCalculatorOverride:s=>{let a=this.settings.viewportRowRenderingOffset;if(a==="auto"&&this.settings.fixedRowsTop&&(a=10),a>0||a==="auto"){const o=this.countRenderableRows(),u=s.startRow,c=s.endRow;if(typeof a=="number")s.startRow=Math.max(u-a,0),s.endRow=Math.min(c+a,o-1);else if(a==="auto"){const f=Math.max(1,Math.ceil(c/o*12));s.startRow=Math.max(u-f,0),s.endRow=Math.min(c+f,o-1)}}this.hot.runHooks("afterViewportRowCalculatorOverride",s)},viewportColumnCalculatorOverride:s=>{let a=this.settings.viewportColumnRenderingOffset;if(a==="auto"&&this.settings.fixedColumnsStart&&(a=10),a>0||a==="auto"){const o=this.countRenderableColumns(),u=s.startColumn,c=s.endColumn;if(typeof a=="number"&&(s.startColumn=Math.max(u-a,0),s.endColumn=Math.min(c+a,o-1)),a==="auto"){const f=Math.max(1,Math.ceil(c/o*6));s.startColumn=Math.max(u-f,0),s.endColumn=Math.min(c+f,o-1)}}this.hot.runHooks("afterViewportColumnCalculatorOverride",s)},rowHeaderWidth:()=>this.settings.rowHeaderWidth,columnHeaderHeight:()=>{const s=this.hot.runHooks("modifyColumnHeaderHeight");return this.settings.columnHeaderHeight||s},stylesHandler:()=>this.hot.stylesHandler};this.hot.runHooks("beforeInitWalkontable",e),this._wt=new rL(e),this.activeWt=this._wt;const r=this._wt.wtTable.spreader,{width:n,height:i}=this.hot.rootElement.getBoundingClientRect();this.setLastSize(n,i),this.eventManager.addEventListener(r,"mousedown",s=>{s.target===r&&s.which===3&&s.stopPropagation()}),this.eventManager.addEventListener(r,"contextmenu",s=>{s.target===r&&s.which===3&&s.stopPropagation()}),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"click",()=>{this.settings.observeDOMVisibility&&this._wt.drawInterrupted&&this.hot.render()})}isTextSelectionAllowed(e){if(Fy(e))return!0;const r=kf(e,this._wt.wtTable.spreader);return!!(this.settings.fragmentSelection===!0&&r||this.settings.fragmentSelection==="cell"&&this.isSelectedOnlyCell()&&r||!this.settings.fragmentSelection&&this.isCellEdited()&&this.isSelectedOnlyCell())}isMouseDown(){return Jn(vc,this)}isSelectedOnlyCell(){var e,r;return(e=(r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.isSingleCell())!==null&&e!==void 0?e:!1}isCellEdited(){const e=this.hot.getActiveEditor();return e&&e.isOpened()}beforeRender(e,r){e&&this.hot.runHooks("beforeViewRender",this.hot.forceFullRender,r)}afterRender(e){e&&this.hot.runHooks("afterViewRender",this.hot.forceFullRender)}appendRowHeader(e,r){if(r.firstChild){const n=r.firstChild;if(!Ct(n,"relative")){Bu(r),this.appendRowHeader(e,r);return}this.updateCellHeader(n.querySelector(".rowHeader"),e,this.hot.getRowHeader)}else{const{rootDocument:n,getRowHeader:i}=this.hot,s=n.createElement("div"),a=n.createElement("span");s.className="relative",a.className="rowHeader",this.updateCellHeader(a,e,i),s.appendChild(a),r.appendChild(s)}this.hot.runHooks("afterGetRowHeader",e,r)}appendColHeader(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.hot.getColHeader,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;const s=()=>{const a=e>=0?this.hot.getColumnMeta(e).headerClassName:null;return a?a.split(" "):[]};if(r.firstChild){const a=r.firstChild;Ct(a,"relative")?(this.updateCellHeader(a.querySelector(".colHeader"),e,n,i),a.className="",Ve(a,["relative",...s()])):(Bu(r),this.appendColHeader(e,r,n,i))}else{const{rootDocument:a}=this.hot,o=a.createElement("div"),u=a.createElement("span"),c=s();o.classList.add("relative",...c),u.className="colHeader",this.settings.ariaTags&&(bt(o,...Lc()),bt(u,...Lc())),this.updateCellHeader(u,e,n,i),o.appendChild(u),r.appendChild(o)}this.hot.runHooks("afterGetColHeader",e,r,i)}updateCellHeader(e,r,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,s=r;const a=this._wt.wtOverlays.getParentOverlay(e)||this._wt;e.parentNode&&(Ct(e,"colHeader")?s=a.wtTable.columnFilter.sourceToRendered(r):Ct(e,"rowHeader")&&(s=a.wtTable.rowFilter.sourceToRendered(r))),s>-1?om(e,n(r,i)):(Bf(e," "),Ve(e,"cornerHeader"))}maximumVisibleElementWidth(e){const n=this._wt.wtViewport.getWorkspaceWidth()-e;return n>0?n:0}maximumVisibleElementHeight(e){const n=this._wt.wtViewport.getWorkspaceHeight()-e;return n>0?n:0}setLastSize(e,r){ra(h2,this,e),ra(f2,this,r)}getLastSize(){return{width:Jn(h2,this),height:Jn(f2,this)}}getFirstRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;const e=this.hot.rowIndexMapper,r=e.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedRow());return e.getNearestNotHiddenIndex(r??0,1)}getLastRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;const e=this.hot.rowIndexMapper,r=e.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedRow());return e.getNearestNotHiddenIndex(r??this.hot.countRows()-1,-1)}getFirstRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;const e=this.hot.columnIndexMapper,r=e.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedColumn());return e.getNearestNotHiddenIndex(r??0,1)}getLastRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;const e=this.hot.columnIndexMapper,r=e.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedColumn());return e.getNearestNotHiddenIndex(r??this.hot.countCols()-1,-1)}getFirstFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleRow())}getLastFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleRow())}getFirstFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleColumn())}getLastFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleColumn())}getFirstPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleRow())}getLastPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleRow())}getFirstPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleColumn())}getLastPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleColumn())}getColumnHeadersCount(){return Jn(c2,this)}getRowHeadersCount(){return Jn(xC,this)}getViewportWidth(){return this._wt.wtViewport.getViewportWidth()}getWorkspaceWidth(){return this._wt.wtViewport.getWorkspaceWidth()}getViewportHeight(){return this._wt.wtViewport.getViewportHeight()}getWorkspaceHeight(){return this._wt.wtViewport.getWorkspaceHeight()}getElementOverlayName(e){var r;return((r=this._wt.wtOverlays.getParentOverlay(e))!==null&&r!==void 0?r:this._wt).wtTable.name}getOverlayByName(e){return this._wt.getOverlayByName(e)}getActiveOverlayName(){return this._wt.activeOverlayName}isVisible(){return this._wt.wtTable.isVisible()}hasVerticalScroll(){return this._wt.wtViewport.hasVerticalScroll()}hasHorizontalScroll(){return this._wt.wtViewport.hasHorizontalScroll()}getTableWidth(){return this._wt.wtTable.getWidth()}getTableHeight(){return this._wt.wtTable.getHeight()}getTableOffset(){return this._wt.wtViewport.getWorkspaceOffset()}getRowHeaderWidth(){return this._wt.wtViewport.getRowHeaderWidth()}getColumnHeaderHeight(){return this._wt.wtViewport.getColumnHeaderHeight()}isVerticallyScrollableByWindow(){return this._wt.wtViewport.isVerticallyScrollableByWindow()}isHorizontallyScrollableByWindow(){return this._wt.wtViewport.isHorizontallyScrollableByWindow()}destroy(){this._wt.destroy(),this.eventManager.destroy()}}function mZ(){return parseInt(this.hot.rootElement.getAttribute(BR()[0]),10)}function dye(t){const e=gp(Cy,this,mZ).call(this)+t;bt(this.hot.rootElement,...BR(e))}function gye(){const t=this.hot.rootElement;this.hasVerticalScroll()?Ve(t,"htHasScrollY"):wt(t,"htHasScrollY"),this.hasHorizontalScroll()?Ve(t,"htHasScrollX"):wt(t,"htHasScrollX")}var B9={},V9={},W9;function mye(){if(W9)return V9;W9=1;var t=nn(),e=xi(),r=ev(),n=ba(),i=_i(),s=Yu(),a=Ca(),o=Qf(),u=o("every",TypeError);return t({target:"Iterator",proto:!0,real:!0,forced:u},{every:function(f){i(this);try{n(f)}catch(v){a(this,"throw",v)}if(u)return e(u,this,f);var g=s(this),m=0;return!r(g,function(v,w){if(!f(v,m++))return w()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}}),V9}var $9;function pye(){return $9||($9=1,mye()),B9}pye();const pZ="ABCDEFGHIJKLMNOPQRSTUVWXYZ",hN=pZ.length;function QR(t){let e=t+1,r="",n;for(;e>0;)n=(e-1)%hN,r=String.fromCharCode(65+n)+r,e=parseInt((e-n)/hN,10);return r}function vye(t){let e=0;if(t)for(let r=0,n=t.length-1;r<t.length;r+=1,n-=1)e+=hN**n*(pZ.indexOf(t[r])+1);return e-=1,e}function wye(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4;const r=[];let n,i;for(n=0;n<t;n++){const s=[];for(i=0;i<e;i++)s.push(QR(i)+(n+1));r.push(s)}return r}function yye(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4;const r=[];let n,i;for(n=0;n<t;n++){const s={};for(i=0;i<e;i++)s[`prop${i}`]=QR(i)+(n+1);r.push(s)}return r}function Sye(t,e){const r=[];let n;for(let i=0;i<t;i++){n=[];for(let s=0;s<e;s++)n.push("");r.push(n)}return r}function iL(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=t;const n=[];return(!Array.isArray(t)||!Array.isArray(t[0]))&&(r=[t]),r.forEach((i,s)=>{Array.isArray(i)?i.forEach((a,o)=>{n.push([s+e,o,a])}):Object.keys(i).forEach(a=>{n.push([s+e,a,i[a]])})}),n}function sL(t){let e=0;return Array.isArray(t)&&(t[0]&&Array.isArray(t[0])?e=t[0].length:t[0]&&Vt(t[0])&&(e=WR(t[0]))),e}function vZ(t){return!!(Array.isArray(t)&&t.length&&t.every(e=>Array.isArray(e)))}function wZ(t){return!!(Array.isArray(t)&&t.length&&t.every(e=>typeof e=="object"&&!Array.isArray(e)&&e!==null))}const bye=Object.freeze(Object.defineProperty({__proto__:null,countFirstRowKeys:sL,createEmptySpreadsheetData:Sye,createSpreadsheetData:wye,createSpreadsheetObjectData:yye,dataRowToChangesArray:iL,isArrayOfArrays:vZ,isArrayOfObjects:wZ,spreadsheetColumnIndex:vye,spreadsheetColumnLabel:QR},Symbol.toStringTag,{value:"Module"}));function Dw(t,e,r){return(e=Cye(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Cye(t){var e=xye(t,"string");return typeof e=="symbol"?e:e+""}function xye(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Eye{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];Dw(this,"hot",void 0),Dw(this,"data",void 0),Dw(this,"dataType","array"),Dw(this,"colToProp",()=>{}),Dw(this,"propToCol",()=>{}),this.hot=e,this.data=r}modifyRowData(e){let r;return this.hot.hasHook("modifyRowData")&&(r=this.hot.runHooks("modifyRowData",e)),r!==void 0&&!Number.isInteger(r)?r:this.data[e]}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return!this.data||this.data.length===0?this.data:this.getByRange(null,null,e)}setData(e){this.data=e}getAtColumn(e){const r=[];return he(this.data,(n,i)=>{const s=this.getAtCell(i,e);r.push(s)}),r}getAtRow(e,r,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const s=r===void 0&&n===void 0,{dataDotNotation:a}=this.hot.getSettings();let o=null,u=null;if(o=this.modifyRowData(e),Array.isArray(o))u=[],s?o.forEach((c,f)=>{u[f]=this.getAtPhysicalCell(e,f,o)}):ct(r,n,c=>{u[c-r]=this.getAtPhysicalCell(e,c,o)});else if(Vt(o)||kr(o))if(i?u=[]:u={},!s||i){const f=this.countFirstRowKeys()-1;ct(0,f,g=>{const m=this.colToProp(g);if(g>=(r||0)&&g<=(n||f)&&!Number.isInteger(m)){const v=this.getAtPhysicalCell(e,m,o);i?u.push(v):a?pE(u,m,v):u[m]=v}})}else Wt(o,(c,f)=>{const g=this.getAtPhysicalCell(e,f,o);a?pE(u,f,g):u[f]=g});return u}setAtCell(e,r,n){if(!(e>=this.countRows()||r>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){const i=wa(n);this.hot.runHooks("modifySourceData",e,r,i,"set"),i.isTouched()&&(n=i.value)}["__proto__","constructor","prototype"].includes(e)||(Number.isInteger(r)?this.data[e][r]=n:pE(this.data[e],r,n))}}getAtPhysicalCell(e,r,n){let i=null;if(n)if(typeof r=="string"){const{dataDotNotation:s}=this.hot.getSettings();i=s?dQ(n,r):n[r]}else typeof r=="function"?i=r(n):i=n[r];if(this.hot.hasHook("modifySourceData")){const s=wa(i);this.hot.runHooks("modifySourceData",e,r,s,"get"),s.isTouched()&&(i=s.value)}return i}getAtCell(e,r){const n=this.modifyRowData(e);return this.getAtPhysicalCell(e,this.colToProp(r),n)}getByRange(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=!1,s=null,a=null,o=null,u=null;e===null||r===null?(i=!0,s=0,o=this.countRows()-1):(s=Math.min(e.row,r.row),a=Math.min(e.col,r.col),o=Math.max(e.row,r.row),u=Math.max(e.col,r.col));const c=[];return ct(s,o,f=>{c.push(i?this.getAtRow(f,void 0,void 0,n):this.getAtRow(f,a,u,n))}),c}countRows(){if(this.hot.hasHook("modifySourceLength")){const e=this.hot.runHooks("modifySourceLength");if(Number.isInteger(e))return e}return this.data.length}countFirstRowKeys(){return sL(this.data)}destroy(){this.data=null,this.hot=null}}var U9={},j9={},Y9;function _ye(){if(Y9)return j9;Y9=1;var t=nn(),e=xi(),r=ev(),n=ba(),i=_i(),s=Yu(),a=Ca(),o=Qf(),u=o("some",TypeError);return t({target:"Iterator",proto:!0,real:!0,forced:u},{some:function(f){i(this);try{n(f)}catch(v){a(this,"throw",v)}if(u)return e(u,this,f);var g=s(this),m=0;return r(g,function(v,w){if(f(v,m++))return w()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}}),j9}var z9;function Rye(){return z9||(z9=1,_ye()),U9}Rye();function G9(t,e,r){return(e=Tye(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Tye(t){var e=Mye(t,"string");return typeof e=="symbol"?e:e+""}function Mye(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class lm{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;G9(this,"indexedValues",[]),G9(this,"initValueOrFn",void 0),this.initValueOrFn=e}getValues(){return this.indexedValues}getValueAtIndex(e){const r=this.indexedValues;if(e<r.length)return r[e]}setValues(e){this.indexedValues=e.slice(),this.runLocalHooks("change")}setValueAtIndex(e,r){return e<this.indexedValues.length?(this.indexedValues[e]=r,this.runLocalHooks("change"),!0):!1}clear(){this.setDefaultValues()}getLength(){return this.getValues().length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,kr(this.initValueOrFn)?ct(e-1,r=>this.indexedValues.push(this.initValueOrFn(r))):ct(e-1,()=>this.indexedValues.push(this.initValueOrFn)),this.runLocalHooks("change")}init(e){return this.setDefaultValues(e),this.runLocalHooks("init"),this}insert(){this.runLocalHooks("change")}remove(){this.runLocalHooks("change")}destroy(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}Lr(lm,as);function aL(t,e,r,n){const i=r.length?r[0]:void 0;return[...t.slice(0,i),...r.map((s,a)=>kr(n)?n(s,a):n),...i===void 0?[]:t.slice(i)]}function oL(t,e){return Ff(t,(r,n)=>e.includes(n)===!1)}class Jf extends lm{insert(e,r){this.indexedValues=aL(this.indexedValues,e,r,this.initValueOrFn),super.insert(e,r)}remove(e){this.indexedValues=oL(this.indexedValues,e),super.remove(e)}}class ZR extends Jf{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getHiddenIndexes(){return Ri(this.getValues(),(e,r,n)=>(r&&e.push(n),e),[])}}function lL(t,e,r){return[...t.slice(0,e),...r,...t.slice(e)]}function R1(t,e){return Ff(t,r=>e.includes(r)===!1)}function uL(t,e){return nr(t,r=>r-e.filter(n=>n<r).length)}function cL(t,e){const r=e[0],n=e.length;return nr(t,i=>i>=r?i+n:i)}function Aye(t,e,r){return(e=Oye(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Oye(t){var e=kye(t,"string");return typeof e=="symbol"?e:e+""}function kye(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class JR extends lm{constructor(){super(...arguments),Aye(this,"orderOfIndexes",[])}getValues(){return this.orderOfIndexes.map(e=>this.indexedValues[e])}setValues(e){this.orderOfIndexes=[...Array(e.length).keys()],super.setValues(e)}setValueAtIndex(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.orderOfIndexes.length;return e<this.indexedValues.length?(this.indexedValues[e]=r,this.orderOfIndexes.includes(e)===!1&&this.orderOfIndexes.splice(n,0,e),this.runLocalHooks("change"),!0):!1}clearValue(e){this.orderOfIndexes=R1(this.orderOfIndexes,[e]),kr(this.initValueOrFn)?super.setValueAtIndex(e,this.initValueOrFn(e)):super.setValueAtIndex(e,this.initValueOrFn)}getLength(){return this.orderOfIndexes.length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,super.setDefaultValues(e)}insert(e,r){this.indexedValues=aL(this.indexedValues,e,r,this.initValueOrFn),this.orderOfIndexes=cL(this.orderOfIndexes,r),super.insert(e,r)}remove(e){this.indexedValues=oL(this.indexedValues,e),this.orderOfIndexes=R1(this.orderOfIndexes,e),this.orderOfIndexes=uL(this.orderOfIndexes,e),super.remove(e)}getEntries(){return this.orderOfIndexes.map(e=>[e,this.getValueAtIndex(e)])}}class TS extends Jf{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getTrimmedIndexes(){return Ri(this.getValues(),(e,r,n)=>(r&&e.push(n),e),[])}}const q9=new Map([["indexesSequence",{getListWithInsertedItems:lL,getListWithRemovedItems:R1}],["physicallyIndexed",{getListWithInsertedItems:aL,getListWithRemovedItems:oL}]]),yZ=t=>{if(q9.has(t)===!1)throw new Error(`Alter strategy with ID '${t}' does not exist.`);return q9.get(t)};class SZ extends lm{constructor(){super(e=>e)}insert(e,r){const n=cL(this.indexedValues,r);this.indexedValues=lL(n,e,r),super.insert(e,r)}remove(e){const r=R1(this.indexedValues,e);this.indexedValues=uL(r,e),super.remove(e)}}const K9=new Map([["hiding",ZR],["index",lm],["linkedPhysicalIndexToValue",JR],["physicalIndexToValue",Jf],["trimming",TS]]);function Dye(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!K9.has(t))throw new Error(`The provided map type ("${t}") does not exist.`);return new(K9.get(t))(e)}function Pye(t,e,r){return(e=Iye(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Iye(t){var e=Nye(t,"string");return typeof e=="symbol"?e:e+""}function Nye(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let fN=0;class hL{constructor(){Pye(this,"collection",new Map)}register(e,r){this.collection.has(e)===!1&&(this.collection.set(e,r),r.addLocalHook("change",()=>this.runLocalHooks("change",r)),fN+=1)}unregister(e){const r=this.collection.get(e);it(r)&&(r.destroy(),this.collection.delete(e),this.runLocalHooks("change",r),fN-=1)}unregisterAll(){this.collection.forEach((e,r)=>this.unregister(r)),this.collection.clear()}get(e){return gn(e)?Array.from(this.collection.values()):this.collection.get(e)}getLength(){return this.collection.size}removeFromEvery(e){this.collection.forEach(r=>{r.remove(e)})}insertToEvery(e,r){this.collection.forEach(n=>{n.insert(e,r)})}initEvery(e){this.collection.forEach(r=>{r.init(e)})}}Lr(hL,as);function Hye(){return fN}function d2(t,e,r){return(e=Fye(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Fye(t){var e=Lye(t,"string");return typeof e=="symbol"?e:e+""}function Lye(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class X9 extends hL{constructor(e,r){super(),d2(this,"mergedValuesCache",[]),d2(this,"aggregationFunction",void 0),d2(this,"fallbackValue",void 0),this.aggregationFunction=e,this.fallbackValue=r}getMergedValues(){if((arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0)return this.mergedValuesCache;if(this.getLength()===0)return[];const r=nr(this.get(),s=>s.getValues()),n=[],i=it(r[0])&&r[0].length||0;for(let s=0;s<i;s+=1){const a=[];for(let o=0;o<this.getLength();o+=1)a.push(r[o][s]);n.push(a)}return nr(n,this.aggregationFunction)}getMergedValueAtIndex(e,r){const n=this.getMergedValues(r)[e];return it(n)?n:this.fallbackValue}updateCache(){this.mergedValuesCache=this.getMergedValues(!1)}}function Bye(t,e,r){Vye(t,e),e.set(t,r)}function Vye(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Wye(t,e,r){return t.set(bZ(t,e),r),r}function $ye(t,e){return t.get(bZ(t,e))}function bZ(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var g2=new WeakMap;class CZ{constructor(){Bye(this,g2,[])}subscribe(e){return this.addLocalHook("change",e),this._write($ye(g2,this)),this}unsubscribe(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}_write(e){return e.length>0&&this.runLocalHooks("change",e),this}_writeInitialChanges(e){Wye(g2,this,e)}}Lr(CZ,as);function Q9(t,e){const r=[];let n=0,i=0;for(;n<t.length&&i<e.length;n++,i++)t[n]!==e[i]&&r.push({op:"replace",index:i,oldValue:t[n],newValue:e[i]});for(;n<e.length;n++)r.push({op:"insert",index:n,oldValue:void 0,newValue:e[n]});for(;i<t.length;i++)r.push({op:"remove",index:i,oldValue:t[i],newValue:void 0});return r}function Pw(t,e,r){Uye(t,e),e.set(t,r)}function Uye(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function vo(t,e){return t.get(xZ(t,e))}function _C(t,e,r){return t.set(xZ(t,e),r),r}function xZ(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var RC=new WeakMap,Iw=new WeakMap,TC=new WeakMap,MC=new WeakMap,AC=new WeakMap;class jye{constructor(){let{initialIndexValue:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Pw(this,RC,new Set),Pw(this,Iw,[]),Pw(this,TC,[]),Pw(this,MC,!1),Pw(this,AC,!1),_C(AC,this,e??!1)}createObserver(){const e=new CZ;return vo(RC,this).add(e),e.addLocalHook("unsubscribe",()=>{vo(RC,this).delete(e)}),e._writeInitialChanges(Q9(vo(Iw,this),vo(TC,this))),e}emit(e){let r=vo(TC,this);(!vo(MC,this)||vo(Iw,this).length!==e.length)&&(e.length===0?e=new Array(r.length).fill(vo(AC,this)):_C(Iw,this,new Array(e.length).fill(vo(AC,this))),vo(MC,this)||(_C(MC,this,!0),r=vo(Iw,this)));const n=Q9(r,e);vo(RC,this).forEach(i=>i._write(n)),_C(TC,this,e)}}function Ns(t,e,r){return(e=Yye(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Yye(t){var e=zye(t,"string");return typeof e=="symbol"?e:e+""}function zye(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class dN{constructor(){Ns(this,"indexesSequence",new SZ),Ns(this,"trimmingMapsCollection",new X9(e=>e.some(r=>r===!0),!1)),Ns(this,"hidingMapsCollection",new X9(e=>e.some(r=>r===!0),!1)),Ns(this,"variousMapsCollection",new hL),Ns(this,"hidingChangesObservable",new jye({initialIndexValue:!1})),Ns(this,"notTrimmedIndexesCache",[]),Ns(this,"notHiddenIndexesCache",[]),Ns(this,"isBatched",!1),Ns(this,"indexesSequenceChanged",!1),Ns(this,"indexesChangeSource",void 0),Ns(this,"trimmedIndexesChanged",!1),Ns(this,"hiddenIndexesChanged",!1),Ns(this,"renderablePhysicalIndexesCache",[]),Ns(this,"fromPhysicalToVisualIndexesCache",new Map),Ns(this,"fromVisualToRenderableIndexesCache",new Map),this.indexesSequence.addLocalHook("change",()=>{this.indexesSequenceChanged=!0,this.updateCache(),this.runLocalHooks("indexesSequenceChange",this.indexesChangeSource),this.runLocalHooks("change",this.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",e=>{this.trimmedIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",e=>{this.hiddenIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",e=>{this.runLocalHooks("change",e,this.variousMapsCollection)})}suspendOperations(){this.isBatched=!0}resumeOperations(){this.isBatched=!1,this.updateCache()}createChangesObserver(e){if(e!=="hiding")throw new Error(`Unsupported index map type "${e}".`);return this.hidingChangesObservable.createObserver()}createAndRegisterIndexMap(e,r,n){return this.registerMap(e,Dye(r,n))}registerMap(e,r){if(this.trimmingMapsCollection.get(e)||this.hidingMapsCollection.get(e)||this.variousMapsCollection.get(e))throw Error(`Map with name "${e}" has been already registered.`);r instanceof TS?this.trimmingMapsCollection.register(e,r):r instanceof ZR?this.hidingMapsCollection.register(e,r):this.variousMapsCollection.register(e,r);const n=this.getNumberOfIndexes();return n>0&&r.init(n),r}unregisterMap(e){this.trimmingMapsCollection.unregister(e),this.hidingMapsCollection.unregister(e),this.variousMapsCollection.unregister(e)}unregisterAll(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}getPhysicalFromVisualIndex(e){const r=this.notTrimmedIndexesCache[e];return it(r)?r:null}getPhysicalFromRenderableIndex(e){const r=this.renderablePhysicalIndexesCache[e];return it(r)?r:null}getVisualFromPhysicalIndex(e){const r=this.fromPhysicalToVisualIndexesCache.get(e);return it(r)?r:null}getVisualFromRenderableIndex(e){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(e))}getRenderableFromVisualIndex(e){const r=this.fromVisualToRenderableIndexesCache.get(e);return it(r)?r:null}getNearestNotHiddenIndex(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(this.getPhysicalFromVisualIndex(e)===null)return null;if(this.fromVisualToRenderableIndexesCache.has(e))return e;const s=Array.from(this.fromVisualToRenderableIndexesCache.keys());let a=-1;return r>0?a=s.findIndex(o=>o>e):a=s.reverse().findIndex(o=>o<e),a===-1?n?this.getNearestNotHiddenIndex(e,-r,!1):null:s[a]}initToLength(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=[...new Array(e).keys()],this.notHiddenIndexesCache=[...new Array(e).keys()],this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(e),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(e),this.variousMapsCollection.initEvery(e),this.resumeOperations(),this.runLocalHooks("init")}fitToLength(e){const r=this.getNumberOfIndexes();if(e<r){const n=[...Array(this.getNumberOfIndexes()-e).keys()].map(i=>i+e);this.removeIndexes(n)}else this.insertIndexes(r,e-r)}getIndexesSequence(){return this.indexesSequence.getValues()}setIndexesSequence(e){this.indexesChangeSource===void 0&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(e),this.indexesChangeSource==="update"&&(this.indexesChangeSource=void 0)}getNotTrimmedIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notTrimmedIndexesCache:this.getIndexesSequence().filter(n=>this.isTrimmed(n)===!1)}getNotTrimmedIndexesLength(){return this.getNotTrimmedIndexes().length}getNotHiddenIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notHiddenIndexesCache:this.getIndexesSequence().filter(n=>this.isHidden(n)===!1)}getNotHiddenIndexesLength(){return this.getNotHiddenIndexes().length}getRenderableIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.renderablePhysicalIndexesCache:this.getNotTrimmedIndexes().filter(n=>this.isHidden(n)===!1)}getRenderableIndexesLength(){return this.getRenderableIndexes().length}getNumberOfIndexes(){return this.getIndexesSequence().length}moveIndexes(e,r){typeof e=="number"&&(e=[e]);const n=nr(e,c=>this.getPhysicalFromVisualIndex(c)),i=this.getNotTrimmedIndexesLength(),s=e.length,a=R1(this.getIndexesSequence(),n),o=a.filter(c=>this.isTrimmed(c)===!1);let u=a.indexOf(o[o.length-1])+1;if(r+s<i){const c=o[r];u=a.indexOf(c)}this.indexesChangeSource="move",this.setIndexesSequence(lL(a,u,n)),this.indexesChangeSource=void 0}isTrimmed(e){return this.trimmingMapsCollection.getMergedValueAtIndex(e)}isHidden(e){return this.hidingMapsCollection.getMergedValueAtIndex(e)}insertIndexes(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"start";const i=this.getNotTrimmedIndexes()[e],s=it(i)?i:this.getNumberOfIndexes(),a=this.getIndexesSequence().includes(i)?this.getIndexesSequence().indexOf(i):this.getNumberOfIndexes(),o=nr(new Array(r).fill(s),(c,f)=>c+f);this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(a,o),this.indexesChangeSource=void 0;const u=n==="end"?o.map(c=>c+1):o;this.trimmingMapsCollection.insertToEvery(a,u),this.hidingMapsCollection.insertToEvery(a,u),this.variousMapsCollection.insertToEvery(a,u),this.resumeOperations()}removeIndexes(e){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(e),this.hidingMapsCollection.removeFromEvery(e),this.variousMapsCollection.removeFromEvery(e),this.resumeOperations()}updateCache(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const r=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(e===!0||this.isBatched===!1&&r===!0)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}cacheFromPhysicalToVisualIndexes(){const e=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(let r=0;r<e;r+=1){const n=this.getPhysicalFromVisualIndex(r);this.fromPhysicalToVisualIndexesCache.set(n,r)}}cacheFromVisualToRenderableIndexes(){const e=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(let r=0;r<e;r+=1){const n=this.getPhysicalFromRenderableIndex(r),i=this.getVisualFromPhysicalIndex(n);this.fromVisualToRenderableIndexesCache.set(i,r)}}}Lr(dN,as);function Gye(t,e){return Wt(e,(r,n)=>{gn(t[n])&&(t[n]=r)}),t}function EZ(t){const r=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(t);return r?`${r[1].toLowerCase()}-${r[2].toUpperCase()}`:t}function _Z(t){it(t)&&HF(Dr`Language with code "${t}" was not found. You should register particular language\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`)}function qye(t,e){return Array.isArray(t)&&Number.isInteger(e)?t[e]:t}const{register:Kye,getValues:Xye}=Zo("phraseFormatters");function Qye(t,e){Kye(t,e)}function Zye(){return Xye()}Qye("pluralize",qye);const RZ="ContextMenu:items",Pt=RZ,fL=`${Pt}.noItems`,dL=`${Pt}.insertRowAbove`,gL=`${Pt}.insertRowBelow`,mL=`${Pt}.insertColumnOnTheLeft`,pL=`${Pt}.insertColumnOnTheRight`,vL=`${Pt}.removeRow`,wL=`${Pt}.removeColumn`,yL=`${Pt}.undo`,SL=`${Pt}.redo`,n_=`${Pt}.readOnly`,bL=`${Pt}.clearColumn`,CL=`${Pt}.copy`,xL=`${Pt}.copyWithHeaders`,EL=`${Pt}.copyWithGroupHeaders`,_L=`${Pt}.copyHeadersOnly`,RL=`${Pt}.cut`,TL=`${Pt}.freezeColumn`,ML=`${Pt}.unfreezeColumn`,AL=`${Pt}.mergeCells`,OL=`${Pt}.unmergeCells`,kL=`${Pt}.addComment`,DL=`${Pt}.editComment`,PL=`${Pt}.removeComment`,IL=`${Pt}.readOnlyComment`,NL=`${Pt}.align`,HL=`${Pt}.align.left`,FL=`${Pt}.align.center`,LL=`${Pt}.align.right`,BL=`${Pt}.align.justify`,VL=`${Pt}.align.top`,WL=`${Pt}.align.middle`,$L=`${Pt}.align.bottom`,UL=`${Pt}.borders`,jL=`${Pt}.borders.top`,YL=`${Pt}.borders.right`,zL=`${Pt}.borders.bottom`,GL=`${Pt}.borders.left`,qL=`${Pt}.borders.remove`,KL=`${Pt}.nestedHeaders.insertChildRow`,XL=`${Pt}.nestedHeaders.detachFromParent`,QL=`${Pt}.hideColumn`,ZL=`${Pt}.showColumn`,JL=`${Pt}.hideRow`,e4=`${Pt}.showRow`,Xs="Filters:",Nn=`${Xs}conditions`,eT=`${Nn}.none`,t4=`${Nn}.isEmpty`,r4=`${Nn}.isNotEmpty`,n4=`${Nn}.isEqualTo`,i4=`${Nn}.isNotEqualTo`,s4=`${Nn}.beginsWith`,a4=`${Nn}.endsWith`,o4=`${Nn}.contains`,l4=`${Nn}.doesNotContain`,Jye=`${Nn}.byValue`,u4=`${Nn}.greaterThan`,c4=`${Nn}.greaterThanOrEqualTo`,h4=`${Nn}.lessThan`,f4=`${Nn}.lessThanOrEqualTo`,d4=`${Nn}.isBetween`,g4=`${Nn}.isNotBetween`,m4=`${Nn}.after`,p4=`${Nn}.before`,v4=`${Nn}.today`,w4=`${Nn}.tomorrow`,y4=`${Nn}.yesterday`,S4=`${Xs}labels.filterByCondition`,b4=`${Xs}labels.filterByValue`,C4=`${Xs}labels.conjunction`,tT=`${Xs}labels.disjunction`,i_=`${Xs}values.blankCells`,x4=`${Xs}buttons.selectAll`,E4=`${Xs}buttons.clear`,_4=`${Xs}buttons.ok`,R4=`${Xs}buttons.cancel`,T4=`${Xs}buttons.placeholder.search`,M4=`${Xs}buttons.placeholder.value`,A4=`${Xs}buttons.placeholder.secondValue`,O4="CheckboxRenderer:",k4=`${O4}checked`,D4=`${O4}unchecked`,e1e=Object.freeze(Object.defineProperty({__proto__:null,CHECKBOX_CHECKED:k4,CHECKBOX_RENDERER_NAMESPACE:O4,CHECKBOX_UNCHECKED:D4,CONTEXTMENU_ITEMS_ADD_COMMENT:kL,CONTEXTMENU_ITEMS_ALIGNMENT:NL,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:$L,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:FL,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:BL,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:HL,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:WL,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:LL,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:VL,CONTEXTMENU_ITEMS_BORDERS:UL,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:zL,CONTEXTMENU_ITEMS_BORDERS_LEFT:GL,CONTEXTMENU_ITEMS_BORDERS_RIGHT:YL,CONTEXTMENU_ITEMS_BORDERS_TOP:jL,CONTEXTMENU_ITEMS_CLEAR_COLUMN:bL,CONTEXTMENU_ITEMS_COPY:CL,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:_L,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:EL,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:xL,CONTEXTMENU_ITEMS_CUT:RL,CONTEXTMENU_ITEMS_EDIT_COMMENT:DL,CONTEXTMENU_ITEMS_FREEZE_COLUMN:TL,CONTEXTMENU_ITEMS_HIDE_COLUMN:QL,CONTEXTMENU_ITEMS_HIDE_ROW:JL,CONTEXTMENU_ITEMS_INSERT_LEFT:mL,CONTEXTMENU_ITEMS_INSERT_RIGHT:pL,CONTEXTMENU_ITEMS_MERGE_CELLS:AL,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:XL,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:KL,CONTEXTMENU_ITEMS_NO_ITEMS:fL,CONTEXTMENU_ITEMS_READ_ONLY:n_,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:IL,CONTEXTMENU_ITEMS_REDO:SL,CONTEXTMENU_ITEMS_REMOVE_BORDERS:qL,CONTEXTMENU_ITEMS_REMOVE_COLUMN:wL,CONTEXTMENU_ITEMS_REMOVE_COMMENT:PL,CONTEXTMENU_ITEMS_REMOVE_ROW:vL,CONTEXTMENU_ITEMS_ROW_ABOVE:dL,CONTEXTMENU_ITEMS_ROW_BELOW:gL,CONTEXTMENU_ITEMS_SHOW_COLUMN:ZL,CONTEXTMENU_ITEMS_SHOW_ROW:e4,CONTEXTMENU_ITEMS_UNDO:yL,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:ML,CONTEXTMENU_ITEMS_UNMERGE_CELLS:OL,CONTEXT_MENU_ITEMS_NAMESPACE:RZ,FILTERS_BUTTONS_CANCEL:R4,FILTERS_BUTTONS_CLEAR:E4,FILTERS_BUTTONS_OK:_4,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:T4,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:A4,FILTERS_BUTTONS_PLACEHOLDER_VALUE:M4,FILTERS_BUTTONS_SELECT_ALL:x4,FILTERS_CONDITIONS_AFTER:m4,FILTERS_CONDITIONS_BEFORE:p4,FILTERS_CONDITIONS_BEGINS_WITH:s4,FILTERS_CONDITIONS_BETWEEN:d4,FILTERS_CONDITIONS_BY_VALUE:Jye,FILTERS_CONDITIONS_CONTAINS:o4,FILTERS_CONDITIONS_EMPTY:t4,FILTERS_CONDITIONS_ENDS_WITH:a4,FILTERS_CONDITIONS_EQUAL:n4,FILTERS_CONDITIONS_GREATER_THAN:u4,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:c4,FILTERS_CONDITIONS_LESS_THAN:h4,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:f4,FILTERS_CONDITIONS_NAMESPACE:Nn,FILTERS_CONDITIONS_NONE:eT,FILTERS_CONDITIONS_NOT_BETWEEN:g4,FILTERS_CONDITIONS_NOT_CONTAIN:l4,FILTERS_CONDITIONS_NOT_EMPTY:r4,FILTERS_CONDITIONS_NOT_EQUAL:i4,FILTERS_CONDITIONS_TODAY:v4,FILTERS_CONDITIONS_TOMORROW:w4,FILTERS_CONDITIONS_YESTERDAY:y4,FILTERS_DIVS_FILTER_BY_CONDITION:S4,FILTERS_DIVS_FILTER_BY_VALUE:b4,FILTERS_LABELS_CONJUNCTION:C4,FILTERS_LABELS_DISJUNCTION:tT,FILTERS_NAMESPACE:Xs,FILTERS_VALUES_BLANK_CELLS:i_},Symbol.toStringTag,{value:"Module"}));/**
 * @preserve
 * Authors: Handsoncode
 * Last updated: Nov 15, 2017
 *
 * Description: Definition file for English - United States language-country.
 */const TZ={languageCode:"en-US",[fL]:"No available options",[dL]:"Insert row above",[gL]:"Insert row below",[mL]:"Insert column left",[pL]:"Insert column right",[vL]:["Remove row","Remove rows"],[wL]:["Remove column","Remove columns"],[yL]:"Undo",[SL]:"Redo",[n_]:"Read only",[bL]:"Clear column",[NL]:"Alignment",[HL]:"Left",[FL]:"Center",[LL]:"Right",[BL]:"Justify",[VL]:"Top",[WL]:"Middle",[$L]:"Bottom",[TL]:"Freeze column",[ML]:"Unfreeze column",[UL]:"Borders",[jL]:"Top",[YL]:"Right",[zL]:"Bottom",[GL]:"Left",[qL]:"Remove border(s)",[kL]:"Add comment",[DL]:"Edit comment",[PL]:"Delete comment",[IL]:"Read-only comment",[AL]:"Merge cells",[OL]:"Unmerge cells",[CL]:"Copy",[xL]:["Copy with header","Copy with headers"],[EL]:["Copy with group header","Copy with group headers"],[_L]:["Copy header only","Copy headers only"],[RL]:"Cut",[KL]:"Insert child row",[XL]:"Detach from parent",[QL]:["Hide column","Hide columns"],[ZL]:["Show column","Show columns"],[JL]:["Hide row","Hide rows"],[e4]:["Show row","Show rows"],[eT]:"None",[t4]:"Is empty",[r4]:"Is not empty",[n4]:"Is equal to",[i4]:"Is not equal to",[s4]:"Begins with",[a4]:"Ends with",[o4]:"Contains",[l4]:"Does not contain",[u4]:"Greater than",[c4]:"Greater than or equal to",[h4]:"Less than",[f4]:"Less than or equal to",[d4]:"Is between",[g4]:"Is not between",[m4]:"After",[p4]:"Before",[v4]:"Today",[w4]:"Tomorrow",[y4]:"Yesterday",[i_]:"Blank cells",[S4]:"Filter by condition",[b4]:"Filter by value",[C4]:"And",[tT]:"Or",[x4]:"Select all",[E4]:"Clear",[_4]:"OK",[R4]:"Cancel",[T4]:"Search",[M4]:"Value",[A4]:"Second value",[k4]:"Checked",[D4]:"Unchecked"},t1e=e1e,gN=TZ.languageCode,{register:r1e,getItem:MZ,hasItem:n1e,getValues:i1e}=Zo("languagesDictionaries");AZ(TZ);function AZ(t,e){let r=t,n=e;return Vt(t)&&(n=t,r=n.languageCode),s1e(r,n),r1e(r,As(n)),As(n)}function s1e(t,e){t!==gN&&Gye(e,MZ(gN))}function OZ(t){return P4(t)?As(MZ(t)):null}function P4(t){return n1e(t)}function a1e(){return i1e()}function kZ(t,e,r){const n=OZ(t);if(n===null)return null;const i=n[e];if(gn(i))return null;const s=o1e(i,r);return Array.isArray(s)?s[0]:s}function o1e(t,e){let r=t;return he(Zye(),n=>{r=n(t,e)}),r}function l1e(t){let e=EZ(t);return P4(e)||(e=gN,_Z(t)),e}function u1e(t,e,r){return(e=c1e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function c1e(t){var e=h1e(t,"string");return typeof e=="symbol"?e:e+""}function h1e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class hh extends lZ{constructor(e,r){super(e,null),u1e(this,"visualCellRange",null),this.visualCellRange=r||null,this.commit()}add(e){return this.visualCellRange===null?this.visualCellRange=this.settings.createCellRange(e):this.visualCellRange.expand(e),this}clear(){return this.visualCellRange=null,super.clear()}trimToVisibleCellsRangeOnly(e){let{from:r,to:n}=e,i=this.getNearestNotHiddenCoords(r,1),s=this.getNearestNotHiddenCoords(n,-1);return i===null||s===null?null:((i.row>s.row||i.col>s.col)&&(i=r,s=n),this.settings.createCellRange(i,i,s))}getNearestNotHiddenCoords(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:r;const i=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper,e.row,r);if(i===null)return null;const s=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper,e.col,n);return s===null?null:this.settings.createCellCoords(i,s)}getNearestNotHiddenIndex(e,r,n){return r<0?r:e.getNearestNotHiddenIndex(r,n)}commit(){if(this.visualCellRange===null)return this;const e=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return e===null?this.cellRange=null:this.cellRange=this.createRenderableCellRange(e.from,e.to),this}syncWith(e){const r=e.from.clone().normalize(),n=e.getVerticalDirection()==="N-S"?1:-1,i=e.getHorizontalDirection()==="W-E"?1:-1,s=this.settings.visualToRenderableCoords(this.visualCellRange.highlight);let a=null;if((s===null||s.col===null||s.row===null)&&(a=this.getNearestNotHiddenCoords(r,n,i)),a!==null&&e.overlaps(a)){const o=e.highlight.clone();if(o.row>=0&&(o.row=a.row),o.col>=0&&(o.col=a.col),this.cellRange===null){const u=this.settings.visualToRenderableCoords(o);this.cellRange=this.settings.createCellRange(u)}e.setHighlight(o)}return this.settings.selectionType==="focus"&&s!==null&&a===null&&e.setHighlight(this.visualCellRange.highlight),this}getCorners(){const{from:e,to:r}=this.cellRange;return[Math.min(e.row,r.row),Math.min(e.col,r.col),Math.max(e.row,r.row),Math.max(e.col,r.col)]}getVisualCorners(){const e=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),r=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[e.row,e.col,r.row,r.col]}createRenderableCellRange(e,r){const n=this.settings.visualToRenderableCoords(e),i=this.settings.visualToRenderableCoords(r);return n.row===null||n.col===null||i.row===null||i.col===null?null:this.settings.createCellRange(n,n,i)}}function m2(t){let{activeHeaderClassName:e,...r}=t;return new hh({className:e,...r,selectionType:uZ})}function f1e(t){let{areaCornerVisible:e,...r}=t;return new hh({className:"area",createLayers:!0,border:{width:1,color:"#4b89ff",cornerVisible:e},...r,selectionType:KF})}function d1e(t){let{...e}=t;return new hh({className:"highlight",...e,selectionType:KF})}function g1e(t){let{columnClassName:e,...r}=t;return new hh({className:e,...r,selectionType:Dwe})}function m1e(t){let{cellCornerVisible:e,...r}=t;return new hh({className:"current",headerAttributes:[wF()],border:{width:2,color:"#4b89ff",cornerVisible:e},...r,selectionType:r_})}function p1e(t){let{border:e,visualCellRange:r,...n}=t;return new hh({...e,...n,selectionType:Pwe},r)}function v1e(t){let{...e}=t;return new hh({className:"fill",border:{width:1,color:"#ff0000"},...e,selectionType:Owe})}function Z9(t){let{headerClassName:e,...r}=t;return new hh({className:e,...r,selectionType:qF})}function w1e(t){let{rowClassName:e,...r}=t;return new hh({className:e,...r,selectionType:kwe})}function y1e(t,e){S1e(t,e),e.add(t)}function S1e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function na(t,e,r){return(e=b1e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function b1e(t){var e=C1e(t,"string");return typeof e=="symbol"?e:e+""}function C1e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function wc(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var ql=new WeakSet;class x1e{constructor(e){y1e(this,ql),na(this,"options",void 0),na(this,"layerLevel",0),na(this,"focus",void 0),na(this,"fill",void 0),na(this,"layeredAreas",new Map),na(this,"areas",new Map),na(this,"rowHeaders",new Map),na(this,"columnHeaders",new Map),na(this,"activeRowHeaders",new Map),na(this,"activeColumnHeaders",new Map),na(this,"activeCornerHeaders",new Map),na(this,"rowHighlights",new Map),na(this,"columnHighlights",new Map),na(this,"customSelections",[]),this.options=e,this.focus=m1e(e),this.fill=v1e(e)}isEnabledFor(e,r){let n=e;e===r_&&(n="current");let i=this.options.disabledCellSelection(r.row,r.col);return typeof i=="string"&&(i=[i]),i===!1||Array.isArray(i)&&!i.includes(n)}useLayerLevel(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.layerLevel=e,this}getFocus(){return this.focus}getFill(){return this.fill}createLayeredArea(){return wc(ql,this,yc).call(this,this.layeredAreas,f1e)}getLayeredAreas(){return[...this.layeredAreas.values()]}createArea(){return wc(ql,this,yc).call(this,this.areas,d1e)}getAreas(){return[...this.areas.values()]}createRowHeader(){return wc(ql,this,yc).call(this,this.rowHeaders,Z9)}getRowHeaders(){return[...this.rowHeaders.values()]}createColumnHeader(){return wc(ql,this,yc).call(this,this.columnHeaders,Z9)}getColumnHeaders(){return[...this.columnHeaders.values()]}createActiveRowHeader(){return wc(ql,this,yc).call(this,this.activeRowHeaders,m2)}getActiveRowHeaders(){return[...this.activeRowHeaders.values()]}createActiveColumnHeader(){return wc(ql,this,yc).call(this,this.activeColumnHeaders,m2)}getActiveColumnHeaders(){return[...this.activeColumnHeaders.values()]}createActiveCornerHeader(){return wc(ql,this,yc).call(this,this.activeCornerHeaders,m2)}getActiveCornerHeaders(){return[...this.activeCornerHeaders.values()]}createRowHighlight(){return wc(ql,this,yc).call(this,this.rowHighlights,w1e)}getRowHighlights(){return[...this.rowHighlights.values()]}createColumnHighlight(){return wc(ql,this,yc).call(this,this.columnHighlights,g1e)}getColumnHighlights(){return[...this.columnHighlights.values()]}getCustomSelections(){return[...this.customSelections.values()]}addCustomSelection(e){this.customSelections.push(p1e({...this.options,...e}))}clear(){this.focus.clear(),this.fill.clear(),he(this.areas.values(),e=>void e.clear()),he(this.layeredAreas.values(),e=>void e.clear()),he(this.rowHeaders.values(),e=>void e.clear()),he(this.columnHeaders.values(),e=>void e.clear()),he(this.activeRowHeaders.values(),e=>void e.clear()),he(this.activeColumnHeaders.values(),e=>void e.clear()),he(this.activeCornerHeaders.values(),e=>void e.clear()),he(this.rowHighlights.values(),e=>void e.clear()),he(this.columnHighlights.values(),e=>void e.clear())}[Symbol.iterator](){return[this.focus,this.fill,...this.areas.values(),...this.layeredAreas.values(),...this.rowHeaders.values(),...this.columnHeaders.values(),...this.activeRowHeaders.values(),...this.activeColumnHeaders.values(),...this.activeCornerHeaders.values(),...this.rowHighlights.values(),...this.columnHighlights.values(),...this.customSelections][Symbol.iterator]()}}function yc(t,e){const r=this.layerLevel;if(t.has(r))return t.get(r);const n=e({layerLevel:r,...this.options});return t.set(r,n),n}function J9(t,e,r){return(e=E1e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function E1e(t){var e=_1e(t,"string");return typeof e=="symbol"?e:e+""}function _1e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class I4{constructor(e){J9(this,"ranges",[]),J9(this,"createCellRange",void 0),this.createCellRange=e}isEmpty(){return this.size()===0}set(e){return this.clear(),this.ranges.push(this.createCellRange(e)),this}add(e){return this.ranges.push(this.createCellRange(e)),this}pop(){return this.ranges.pop()}current(){return this.peekByIndex(this.size()-1)}previous(){return this.peekByIndex(this.size()-2)}includes(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:()=>!0;return this.ranges.some((n,i)=>n.includes(e)&&r(n,i))}findAll(e){const r=[];return this.ranges.forEach((n,i)=>{n.isEqual(e)&&r.push({range:n,layer:i})}),r}remove(e){return this.ranges=this.ranges.filter(r=>!e.some(n=>n.isEqual(r))),this}removeLayers(e){return this.ranges=this.ranges.filter((r,n)=>!e.includes(n)),this}clear(){return this.ranges.length=0,this}size(){return this.ranges.length}clone(){const e=new I4(this.createCellRange);return e.ranges=this.ranges.map(r=>r.clone()),e}map(e){return this.ranges=this.ranges.map((r,n)=>e(r,n)),this}peekByIndex(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,r;return e>=0&&e<this.size()&&(r=this.ranges[e]),r}[Symbol.iterator](){return this.ranges[Symbol.iterator]()}}function R1e(t,e){DZ(t,e),e.add(t)}function p2(t,e,r){DZ(t,e),e.set(t,r)}function DZ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function dr(t,e){return t.get(vi(t,e))}function OC(t,e,r){return t.set(vi(t,e),r),r}function vi(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var kC=new WeakMap,un=new WeakMap,Tl=new WeakMap,ki=new WeakSet;class mN{constructor(e,r){R1e(this,ki),p2(this,kC,void 0),p2(this,un,void 0),p2(this,Tl,{x:0,y:0}),OC(kC,this,e),OC(un,this,r)}transformStart(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=dr(un,this).createCellCoords(e,r);let s=dr(kC,this).current().highlight;const a=dr(un,this).visualToRenderableCoords(s);let o=0,u=0;if(this.runLocalHooks("beforeTransformStart",i),a.row!==null&&a.col!==null){const{width:c,height:f}=vi(ki,this,PZ).call(this),{row:g,col:m}=vi(ki,this,t7).call(this,s),v=dr(un,this).fixedRowsBottom(),w=dr(un,this).minSpareRows(),y=dr(un,this).minSpareCols(),b=dr(un,this).autoWrapRow(),x=dr(un,this).autoWrapCol(),_=dr(un,this).createCellCoords(g+i.row,m+i.col);if(_.row>=f){const P=wa(n&&w>0&&v===0),O=_.col+1,A=dr(un,this).createCellCoords(_.row-f,O>=c?O-c:O);this.runLocalHooks("beforeColumnWrap",P,vi(ki,this,u0).call(this,A),O>=c),P.value?this.runLocalHooks("insertRowRequire",dr(un,this).countRenderableRows()):x&&_.assign(A)}else if(_.row<0){const P=wa(x),O=_.col-1,A=dr(un,this).createCellCoords(f+_.row,O<0?c+O:O);this.runLocalHooks("beforeColumnWrap",P,vi(ki,this,u0).call(this,A),O<0),x&&_.assign(A)}if(_.col>=c){const P=wa(n&&y>0),O=_.row+1,A=dr(un,this).createCellCoords(O>=f?O-f:O,_.col-c);this.runLocalHooks("beforeRowWrap",P,vi(ki,this,u0).call(this,A),O>=f),P.value?this.runLocalHooks("insertColRequire",dr(un,this).countRenderableColumns()):b&&_.assign(A)}else if(_.col<0){const P=wa(b),O=_.row-1,A=dr(un,this).createCellCoords(O<0?f+O:O,c+_.col);this.runLocalHooks("beforeRowWrap",P,vi(ki,this,u0).call(this,A),O<0),b&&_.assign(A)}const{rowDir:T,colDir:D}=vi(ki,this,e7).call(this,_);o=T,u=D,s=vi(ki,this,u0).call(this,_)}return this.runLocalHooks("afterTransformStart",s,o,u),s}transformEnd(e,r){const n=dr(un,this).createCellCoords(e,r),i=dr(kC,this).current(),s=dr(un,this).visualToRenderableCoords(i.highlight),a=vi(ki,this,v2).call(this,i.to.row,i.from.row),o=vi(ki,this,w2).call(this,i.to.col,i.from.col),u=i.to.clone();let c=0,f=0;if(this.runLocalHooks("beforeTransformEnd",n),s.row!==null&&s.col!==null&&a!==null&&o!==null){const{row:g,col:m}=vi(ki,this,t7).call(this,i.highlight),v=dr(un,this).createCellCoords(a+n.row,o+n.col),w=i.getTopStartCorner(),y=i.getTopEndCorner(),b=i.getBottomEndCorner();if(n.col<0&&o>=m&&v.col<m){const D=v.col-m;v.col=vi(ki,this,w2).call(this,w.col,y.col)+D}else if(n.col>0&&o<=m&&v.col>m){const D=vi(ki,this,w2).call(this,y.col,w.col),P=Math.max(v.col-D,1);v.col=D+P}if(n.row<0&&a>=g&&v.row<g){const D=v.row-g;v.row=vi(ki,this,v2).call(this,w.row,b.row)+D}else if(n.row>0&&a<=g&&v.row>g){const D=vi(ki,this,v2).call(this,b.row,w.row),P=Math.max(v.row-D,1);v.row=D+P}const{rowDir:x,colDir:_}=vi(ki,this,e7).call(this,v);c=x,f=_;const T=vi(ki,this,u0).call(this,v);n.row===0&&n.col!==0?u.col=T.col:n.row!==0&&n.col===0?u.row=T.row:(u.row=T.row,u.col=T.col)}return this.runLocalHooks("afterTransformEnd",u,c,f),u}setOffsetSize(e){let{x:r,y:n}=e;OC(Tl,this,{x:r,y:n})}resetOffsetSize(){OC(Tl,this,{x:0,y:0})}}function e7(t){const{width:e,height:r}=vi(ki,this,PZ).call(this);let n=0,i=0;return t.row<0?(n=-1,t.row=0):t.row>0&&t.row>=r&&(n=1,t.row=r-1),t.col<0?(i=-1,t.col=0):t.col>0&&t.col>=e&&(i=1,t.col=e-1),{rowDir:n,colDir:i}}function PZ(){return{width:dr(Tl,this).x+dr(un,this).countRenderableColumns(),height:dr(Tl,this).y+dr(un,this).countRenderableRows()}}function v2(t,e){const r=dr(un,this).findFirstNonHiddenRenderableRow(t,e);return r===null?null:dr(Tl,this).y+r}function w2(t,e){const r=dr(un,this).findFirstNonHiddenRenderableColumn(t,e);return r===null?null:dr(Tl,this).x+r}function t7(t){const{row:e,col:r}=dr(un,this).visualToRenderableCoords(t);if(e===null||r===null)throw new Error("Renderable coords are not visible.");return dr(un,this).createCellCoords(dr(Tl,this).y+e,dr(Tl,this).x+r)}function u0(t){const e=t.clone();return e.col=t.col-dr(Tl,this).x,e.row=t.row-dr(Tl,this).y,dr(un,this).renderableToVisualCoords(e)}Lr(mN,as);const rT=0,nT=1,IZ=2,N4=3,T1e=[N4,IZ],M1e=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],y2=Symbol("root"),r7=Symbol("child");function kp(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:y2;if(e!==y2&&e!==r7)throw new Error("The second argument is used internally only and cannot be overwritten.");const r=Array.isArray(t),n=e===y2;let i=rT;if(r){const s=t[0];t.length===0?i=nT:n&&s instanceof ES?i=N4:n&&Array.isArray(s)?i=kp(s,r7):t.length>=2&&t.length<=4&&!t.some((o,u)=>!M1e[u].includes(typeof o))&&(i=IZ)}return i}function T1(t){let{createCellCoords:e,createCellRange:r,keepDirection:n=!1,propToCol:i}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!T1e.includes(t))throw new Error("Unsupported selection ranges schema type was provided.");return function(s){const a=t===N4;let o=a?s.from.row:s[0],u=a?s.from.col:s[1],c=a?s.to.row:s[2],f=a?s.to.col:s[3];if(typeof i=="function"&&(typeof u=="string"&&(u=i(u)),typeof f=="string"&&(f=i(f))),gn(c)&&(c=o),gn(f)&&(f=u),!n){const v=o,w=u,y=c,b=f;o=Math.min(v,y),u=Math.min(w,b),c=Math.max(v,y),f=Math.max(w,b)}const g=e(o,u),m=e(c,f);return r(g,g,m)}}function A1e(t){const e=kp(t.getSelected());if(e===rT||e===nT)return[];const r=T1(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),n=new Set;he(t.getSelected(),a=>{const{from:o,to:u}=r(a),c=Math.max(o.col,0),f=u.col-c+1;he(Array.from(new Array(f),(g,m)=>c+m),g=>{n.has(g)||n.add(g)})});const i=Array.from(n).sort((a,o)=>a-o);return Ri(i,(a,o,u,c)=>(u!==0&&o===c[u-1]+1?a[a.length-1][1]+=1:a.push([o,1]),a),[])}function O1e(t){const e=kp(t.getSelected());if(e===rT||e===nT)return[];const r=T1(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),n=new Set;he(t.getSelected(),a=>{const{from:o,to:u}=r(a),c=Math.max(o.row,0),f=u.row-c+1;he(Array.from(new Array(f),(g,m)=>c+m),g=>{n.has(g)||n.add(g)})});const i=Array.from(n).sort((a,o)=>a-o);return Ri(i,(a,o,u,c)=>(u!==0&&o===c[u-1]+1?a[a.length-1][1]+=1:a.push([o,1]),a),[])}function c0(t,e,r){k1e(t,e),e.set(t,r)}function k1e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ad(t,e,r){return(e=D1e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function D1e(t){var e=P1e(t,"string");return typeof e=="symbol"?e:e+""}function P1e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function hn(t,e){return t.get(NZ(t,e))}function Kl(t,e,r){return t.set(NZ(t,e),r),r}function NZ(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var us=new WeakMap,Od=new WeakMap,DC=new WeakMap,Nw=new WeakMap,PC=new WeakMap,Hw=new WeakMap;class HZ{constructor(e,r){var n=this;Ad(this,"settings",void 0),Ad(this,"tableProps",void 0),Ad(this,"inProgress",!1),Ad(this,"selectedRange",new I4((i,s,a)=>this.tableProps.createCellRange(i,s,a))),Ad(this,"highlight",void 0),c0(this,us,void 0),c0(this,Od,void 0),Ad(this,"selectedByRowHeader",new Set),Ad(this,"selectedByColumnHeader",new Set),c0(this,DC,!1),c0(this,Nw,!1),c0(this,PC,"unknown"),c0(this,Hw,-1),this.settings=e,this.tableProps=r,this.highlight=new x1e({headerClassName:e.currentHeaderClassName,activeHeaderClassName:e.activeHeaderClassName,rowClassName:e.currentRowClassName,columnClassName:e.currentColClassName,cellAttributes:[wF()],rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,disabledCellSelection:(i,s)=>this.tableProps.isDisabledCellSelection(i,s),cellCornerVisible:function(){return n.isCellCornerVisible(...arguments)},areaCornerVisible:function(){return n.isAreaCornerVisible(...arguments)},visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),createCellCoords:(i,s)=>this.tableProps.createCellCoords(i,s),createCellRange:(i,s,a)=>this.tableProps.createCellRange(i,s,a)}),Kl(us,this,new mN(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>this.tableProps.countRenderableRows(),countRenderableColumns:()=>this.tableProps.countRenderableColumns(),visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),findFirstNonHiddenRenderableRow:function(){return n.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return n.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(i,s)=>this.tableProps.createCellCoords(i,s),fixedRowsBottom:()=>e.fixedRowsBottom,minSpareRows:()=>e.minSpareRows,minSpareCols:()=>e.minSpareCols,autoWrapRow:()=>e.autoWrapRow,autoWrapCol:()=>e.autoWrapCol})),Kl(Od,this,new mN(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>{const i=this.selectedRange.current();return this.tableProps.countRenderableRowsInRange(0,i.getOuterBottomEndCorner().row)},countRenderableColumns:()=>{const i=this.selectedRange.current();return this.tableProps.countRenderableColumnsInRange(0,i.getOuterBottomEndCorner().col)},visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),findFirstNonHiddenRenderableRow:function(){return n.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return n.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(i,s)=>this.tableProps.createCellCoords(i,s),fixedRowsBottom:()=>0,minSpareRows:()=>0,minSpareCols:()=>0,autoWrapRow:()=>!0,autoWrapCol:()=>!0})),hn(us,this).addLocalHook("beforeTransformStart",function(){for(var i=arguments.length,s=new Array(i),a=0;a<i;a++)s[a]=arguments[a];return n.runLocalHooks("beforeModifyTransformStart",...s)}),hn(us,this).addLocalHook("afterTransformStart",function(){for(var i=arguments.length,s=new Array(i),a=0;a<i;a++)s[a]=arguments[a];return n.runLocalHooks("afterModifyTransformStart",...s)}),hn(us,this).addLocalHook("beforeTransformEnd",function(){for(var i=arguments.length,s=new Array(i),a=0;a<i;a++)s[a]=arguments[a];return n.runLocalHooks("beforeModifyTransformEnd",...s)}),hn(us,this).addLocalHook("afterTransformEnd",function(){for(var i=arguments.length,s=new Array(i),a=0;a<i;a++)s[a]=arguments[a];return n.runLocalHooks("afterModifyTransformEnd",...s)}),hn(us,this).addLocalHook("insertRowRequire",function(){for(var i=arguments.length,s=new Array(i),a=0;a<i;a++)s[a]=arguments[a];return n.runLocalHooks("insertRowRequire",...s)}),hn(us,this).addLocalHook("insertColRequire",function(){for(var i=arguments.length,s=new Array(i),a=0;a<i;a++)s[a]=arguments[a];return n.runLocalHooks("insertColRequire",...s)}),hn(us,this).addLocalHook("beforeRowWrap",function(){for(var i=arguments.length,s=new Array(i),a=0;a<i;a++)s[a]=arguments[a];return n.runLocalHooks("beforeRowWrap",...s)}),hn(us,this).addLocalHook("beforeColumnWrap",function(){for(var i=arguments.length,s=new Array(i),a=0;a<i;a++)s[a]=arguments[a];return n.runLocalHooks("beforeColumnWrap",...s)}),hn(Od,this).addLocalHook("beforeTransformStart",function(){for(var i=arguments.length,s=new Array(i),a=0;a<i;a++)s[a]=arguments[a];return n.runLocalHooks("beforeModifyTransformFocus",...s)}),hn(Od,this).addLocalHook("afterTransformStart",function(){for(var i=arguments.length,s=new Array(i),a=0;a<i;a++)s[a]=arguments[a];return n.runLocalHooks("afterModifyTransformFocus",...s)})}getSelectedRange(){return this.selectedRange}markSource(e){Kl(PC,this,e)}markEndSource(){Kl(PC,this,"unknown")}getSelectionSource(){return hn(PC,this)}setExpectedLayers(e){Kl(Hw,this,e)}begin(){this.inProgress=!0}finish(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1,Kl(Hw,this,-1)}isInProgress(){return this.inProgress}setRangeStart(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:e;const s=this.settings.selectionMode==="multiple",a=gn(r)?this.tableProps.getShortcutManager().isCtrlPressed():r,o=e.clone();Kl(DC,this,!1),this.runLocalHooks(`beforeSetRangeStart${n?"Only":""}`,o),(!s||s&&!a&&gn(r))&&this.selectedRange.clear(),this.selectedRange.add(o).current().setHighlight(i.clone()),this.getLayerLevel()===0&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),n||this.setRangeEnd(e)}setRangeStartOnly(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e;this.setRangeStart(e,r,!0,n)}setRangeEnd(e){if(this.selectedRange.isEmpty())return;const r=e.clone(),n=this.tableProps.countRows(),i=this.tableProps.countCols(),s=this.selectedRange.current().clone().setTo(e).isSingleHeader();if((n>0||i>0)&&(n===0&&r.col<0&&!s||i===0&&r.row<0&&!s))return;this.runLocalHooks("beforeSetRangeEnd",r),this.begin();const a=this.selectedRange.current();if(this.settings.navigableHeaders||a.highlight.normalize(),this.settings.selectionMode==="single")a.setFrom(a.highlight),a.setTo(a.highlight);else{const u=a.getHorizontalDirection(),c=a.getVerticalDirection(),f=this.isMultiple();a.setTo(r),f&&(u!==a.getHorizontalDirection()||a.getWidth()===1&&!a.includes(a.highlight))&&a.from.assign({col:a.highlight.col}),f&&(c!==a.getVerticalDirection()||a.getHeight()===1&&!a.includes(a.highlight))&&a.from.assign({row:a.highlight.row})}n>0&&i>0&&(!this.settings.navigableHeaders||this.settings.navigableHeaders&&!a.isSingleHeader())&&a.to.normalize(),this.runLocalHooks("beforeHighlightSet"),this.setRangeFocus(this.selectedRange.current().highlight),this.applyAndCommit();const o=hn(Hw,this)===-1||this.selectedRange.size()===hn(Hw,this);this.runLocalHooks("afterSetRangeEnd",e,o)}applyAndCommit(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectedRange.current(),r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLayerLevel();const n=this.tableProps.countRows(),i=this.tableProps.countCols();r<this.highlight.layerLevel&&(he(this.highlight.getAreas(),w=>void w.clear()),he(this.highlight.getLayeredAreas(),w=>void w.clear()),he(this.highlight.getRowHeaders(),w=>void w.clear()),he(this.highlight.getColumnHeaders(),w=>void w.clear()),he(this.highlight.getActiveRowHeaders(),w=>void w.clear()),he(this.highlight.getActiveColumnHeaders(),w=>void w.clear()),he(this.highlight.getActiveCornerHeaders(),w=>void w.clear()),he(this.highlight.getRowHighlights(),w=>void w.clear()),he(this.highlight.getColumnHighlights(),w=>void w.clear())),this.highlight.useLayerLevel(r);const s=this.highlight.createArea(),a=this.highlight.createLayeredArea(),o=this.highlight.createRowHeader(),u=this.highlight.createColumnHeader(),c=this.highlight.createActiveRowHeader(),f=this.highlight.createActiveColumnHeader(),g=this.highlight.createActiveCornerHeader(),m=this.highlight.createRowHighlight(),v=this.highlight.createColumnHighlight();if(s.clear(),a.clear(),o.clear(),u.clear(),c.clear(),f.clear(),g.clear(),m.clear(),v.clear(),this.highlight.isEnabledFor(KF,e.highlight)&&(this.isMultiple()||r>=1)&&(s.add(e.from).add(e.to).commit(),a.add(e.from).add(e.to).commit(),r===1)){const w=this.selectedRange.previous();this.highlight.useLayerLevel(r-1),this.highlight.createArea().add(w.from).commit().syncWith(w),this.highlight.createLayeredArea().add(w.from).commit().syncWith(w),this.highlight.useLayerLevel(r)}if(this.highlight.isEnabledFor(qF,e.highlight)){if(!e.isSingleHeader()){const b=this.tableProps.createCellCoords(Math.max(e.from.row,0),-1),x=this.tableProps.createCellCoords(e.to.row,-1),_=this.tableProps.createCellCoords(-1,Math.max(e.from.col,0)),T=this.tableProps.createCellCoords(-1,e.to.col);this.settings.selectionMode==="single"?(o.add(b).commit(),u.add(_).commit(),m.add(b).commit(),v.add(_).commit()):(o.add(b).add(x).commit(),u.add(_).add(T).commit(),m.add(b).add(x).commit(),v.add(_).add(T).commit())}const w=!hn(Nw,this)&&this.isEntireRowSelected()&&(i>0&&i===e.getWidth()||i===0&&this.isSelectedByRowHeader()),y=!hn(Nw,this)&&this.isEntireColumnSelected()&&(n>0&&n===e.getHeight()||n===0&&this.isSelectedByColumnHeader());w&&c.add(this.tableProps.createCellCoords(Math.max(e.from.row,0),Math.min(-this.tableProps.countRowHeaders(),-1))).add(this.tableProps.createCellCoords(Math.max(e.to.row,0),-1)).commit(),y&&f.add(this.tableProps.createCellCoords(Math.min(-this.tableProps.countColHeaders(),-1),Math.max(e.from.col,0))).add(this.tableProps.createCellCoords(-1,Math.max(e.to.col,0))).commit(),w&&y&&g.add(this.tableProps.createCellCoords(-this.tableProps.countColHeaders(),-this.tableProps.countRowHeaders())).add(this.tableProps.createCellCoords(-1,-1)).commit()}}setRangeFocus(e){if(this.selectedRange.isEmpty())return;const r=this.selectedRange.current();this.inProgress||this.runLocalHooks("beforeSetFocus",e);const n=this.highlight.getFocus();n.clear(),r.setHighlight(e),this.inProgress||this.runLocalHooks("beforeHighlightSet"),this.highlight.isEnabledFor(r_,r.highlight)&&n.add(r.highlight).commit().syncWith(r),this.inProgress||(Kl(DC,this,!0),this.runLocalHooks("afterSetFocus",r.highlight))}transformStart(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.settings.navigableHeaders?hn(us,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):hn(us,this).resetOffsetSize(),this.setRangeStart(hn(us,this).transformStart(e,r,n))}transformEnd(e,r){this.settings.navigableHeaders?hn(us,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):hn(us,this).resetOffsetSize(),this.setRangeEnd(hn(us,this).transformEnd(e,r))}transformFocus(e,r){const n=this.selectedRange.current(),{row:i,col:s}=n.getOuterTopStartCorner(),a=this.tableProps.countRenderableColumnsInRange(0,s-1),o=this.tableProps.countRenderableRowsInRange(0,i-1);n.highlight.isHeader()?hn(Od,this).setOffsetSize({x:s<0?Math.abs(s):-a,y:i<0?Math.abs(i):-o}):hn(Od,this).setOffsetSize({x:s<0?0:-a,y:i<0?0:-o});const u=hn(Od,this).transformStart(e,r);this.setRangeFocus(u.normalize())}shiftRows(e,r){if(!this.isSelected())return;const n=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByColumnHeader()||n.getOuterTopStartCorner().row>=e){const{from:i,to:s,highlight:a}=n,o=this.tableProps.countRows(),u=this.isSelectedByRowHeader(),c=this.isSelectedByColumnHeader(),f=c?-1:0,g=c?0:r;this.getSelectedRange().pop();const m=this.tableProps.createCellCoords(ir(i.row+g,f,o-1),i.col),v=this.tableProps.createCellCoords(ir(s.row+r,f,o-1),s.col);this.markSource("shift"),a.row>=e?this.setRangeStartOnly(m,!0,this.tableProps.createCellCoords(ir(a.row+r,0,o-1),a.col)):this.setRangeStartOnly(m,!0),u&&this.selectedByRowHeader.add(this.getLayerLevel()),c&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(v),this.markEndSource()}}shiftColumns(e,r){if(!this.isSelected())return;const n=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByRowHeader()||n.getOuterTopStartCorner().col>=e){const{from:i,to:s,highlight:a}=n,o=this.tableProps.countCols(),u=this.isSelectedByRowHeader(),c=this.isSelectedByColumnHeader(),f=u?-1:0,g=u?0:r;this.getSelectedRange().pop();const m=this.tableProps.createCellCoords(i.row,ir(i.col+g,f,o-1)),v=this.tableProps.createCellCoords(s.row,ir(s.col+r,f,o-1));this.markSource("shift"),a.col>=e?this.setRangeStartOnly(m,!0,this.tableProps.createCellCoords(a.row,ir(a.col+r,0,o-1))):this.setRangeStartOnly(m,!0),u&&this.selectedByRowHeader.add(this.getLayerLevel()),c&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(v),this.markEndSource()}}getLayerLevel(){return this.selectedRange.size()-1}isSelected(){return!this.selectedRange.isEmpty()}isMultiple(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectedRange.current();if(!this.isSelected())return!1;const r=wa(!e.isSingle());return this.runLocalHooks("afterIsMultipleSelection",r),r.value}isFocusSelectionChanged(){return this.isSelected()&&hn(DC,this)}isSelectedByRowHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(e)&&(e===-1?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(e))}isEntireRowSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const r=i=>{const{col:s}=i.getOuterTopStartCorner(),a=this.tableProps.countRowHeaders(),o=this.tableProps.countCols();return(a>0&&s<0||a===0)&&i.getWidth()===o};if(e===-1)return Array.from(this.selectedRange).some(i=>r(i));const n=this.selectedRange.peekByIndex(e);return n?r(n):!1}isSelectedByColumnHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&(e===-1?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(e))}isEntireColumnSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const r=i=>{const{row:s}=i.getOuterTopStartCorner(),a=this.tableProps.countColHeaders(),o=this.tableProps.countRows();return(a>0&&s<0||a===0)&&i.getHeight()===o};if(e===-1)return Array.from(this.selectedRange).some(i=>r(i));const n=this.selectedRange.peekByIndex(e);return n?r(n):!1}isSelectedByAnyHeader(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}isSelectedByCorner(){return this.selectedByColumnHeader.has(this.getLayerLevel())&&this.selectedByRowHeader.has(this.getLayerLevel())}inInSelection(e){return this.selectedRange.includes(e)}isCellCornerVisible(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}isCellVisible(e){const r=this.tableProps.visualToRenderableCoords(e);return r.row!==null&&r.col!==null}isAreaCornerVisible(e){return Number.isInteger(e)&&e!==this.getLayerLevel()?!1:this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}clear(){this.selectedRange.clear(),this.highlight.clear()}deselect(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}selectAll(){var e;let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{focusPosition:!1,disableHeadersHighlight:!1};const s=this.tableProps.countRows(),a=this.tableProps.countCols(),o=this.tableProps.countRowHeaders(),u=this.tableProps.countColHeaders(),c=n?-u:0,f=r?-o:0;if(c===0&&f===0&&(s===0||a===0))return;let g=(e=this.getSelectedRange().current())===null||e===void 0?void 0:e.highlight;const{focusPosition:m,disableHeadersHighlight:v}=i;Kl(Nw,this,v),m&&Number.isInteger(m?.row)&&Number.isInteger(m?.col)&&(g=this.tableProps.createCellCoords(ir(m.row,c,s-1),ir(m.col,f,a-1)));const w=this.tableProps.createCellCoords(c,f),y=this.tableProps.createCellCoords(s-1,a-1);this.clear(),this.setRangeStartOnly(w,void 0,g),f<0&&this.selectedByRowHeader.add(this.getLayerLevel()),c<0&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(y),this.finish(),Kl(Nw,this,!1)}selectCells(e){var r=this;const n=kp(e);if(n===nT)return!1;if(n===rT)throw new Error(Dr`Unsupported format of the selection ranges was passed. To select cells pass\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`);const i=T1(n,{createCellCoords:function(){return r.tableProps.createCellCoords(...arguments)},createCellRange:function(){return r.tableProps.createCellRange(...arguments)},propToCol:u=>this.tableProps.propToCol(u),keepDirection:!0}),s=this.settings.navigableHeaders,a={countRows:this.tableProps.countRows(),countCols:this.tableProps.countCols(),countRowHeaders:s?this.tableProps.countRowHeaders():0,countColHeaders:s?this.tableProps.countColHeaders():0},o=!e.some(u=>{const c=i(u),f=c.isValid(a);return!(f&&!c.containsHeaders()||f&&c.containsHeaders()&&c.isSingleHeader())});return o&&(this.clear(),this.setExpectedLayers(e.length),he(e,u=>{const{from:c,to:f}=i(u);this.setRangeStartOnly(c.clone(),!1),this.setRangeEnd(f.clone())}),this.finish()),o}selectColumns(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const i=typeof e=="string"?this.tableProps.propToCol(e):e,s=typeof r=="string"?this.tableProps.propToCol(r):r,a=this.tableProps.countRows(),o=this.tableProps.countCols(),u=this.tableProps.countColHeaders(),c=u===0?0:-u,f=this.tableProps.createCellCoords(c,i),g=this.tableProps.createCellCoords(a-1,s),m=this.tableProps.createCellRange(f,f,g).isValid({countRows:a,countCols:o,countRowHeaders:0,countColHeaders:u});if(m){let v=0,w=0;Number.isInteger(n?.row)&&Number.isInteger(n?.col)?(v=ir(n.row,c,a-1),w=ir(n.col,Math.min(i,s),Math.max(i,s))):(v=ir(n,c,a-1),w=i);const y=this.tableProps.createCellCoords(v,w),b=u===0?0:ir(y.row,c,-1),x=a-1,_=this.tableProps.createCellCoords(b,i),T=this.tableProps.createCellCoords(x,s);this.runLocalHooks("beforeSelectColumns",_,T,y),_.row=b,T.row=x,this.setRangeStartOnly(_,void 0,y),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(T),this.runLocalHooks("afterSelectColumns",_,T,y),this.finish()}return m}selectRows(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const i=this.tableProps.countRows(),s=this.tableProps.countCols(),a=this.tableProps.countRowHeaders(),o=a===0?0:-a,u=this.tableProps.createCellCoords(e,o),c=this.tableProps.createCellCoords(r,s-1),f=this.tableProps.createCellRange(u,u,c).isValid({countRows:i,countCols:s,countRowHeaders:a,countColHeaders:0});if(f){let g=0,m=0;Number.isInteger(n?.row)&&Number.isInteger(n?.col)?(g=ir(n.row,Math.min(e,r),Math.max(e,r)),m=ir(n.col,o,s-1)):(g=e,m=ir(n,o,s-1));const v=this.tableProps.createCellCoords(g,m),w=a===0?0:ir(v.col,o,-1),y=s-1,b=this.tableProps.createCellCoords(e,w),x=this.tableProps.createCellCoords(r,y);this.runLocalHooks("beforeSelectRows",b,x,v),b.col=w,x.col=y,this.setRangeStartOnly(b,void 0,v),this.selectedByRowHeader.add(this.getLayerLevel()),this.setRangeEnd(x),this.runLocalHooks("afterSelectRows",b,x,v),this.finish()}return f}refresh(){if(!this.isSelected())return;const e=this.tableProps.countRows(),r=this.tableProps.countCols();if(e===0||r===0){this.deselect();return}const n=this.selectedRange.ranges.map(a=>a.clone());this.markSource("refresh");const i=new Set(this.selectedByRowHeader),s=new Set(this.selectedByColumnHeader);this.clear(),this.setExpectedLayers(n.length),n.forEach(a=>{const{from:o,to:u,highlight:c}=a,f=e-1,g=r-1;c.assign({row:ir(c.row,this.settings.navigableHeaders?-1/0:0,f),col:ir(c.col,this.settings.navigableHeaders?-1/0:0,g)}),o.assign({row:ir(o.row,-1/0,f),col:ir(o.col,-1/0,g)}),u.assign({row:ir(u.row,-1/0,f),col:ir(u.col,-1/0,g)}),this.setRangeStartOnly(o,!0,c),this.setRangeEnd(u)}),this.selectedByRowHeader=i,this.selectedByColumnHeader=s,this.finish(),this.markEndSource()}commit(){if(this.highlight.getCustomSelections().forEach(i=>{i.commit()}),!this.isSelected())return;const r=this.getLayerLevel(),n=this.selectedRange.current();this.highlight.isEnabledFor(r_,n.highlight)&&this.highlight.getFocus().commit().syncWith(n);for(let i=0;i<this.selectedRange.size();i+=1){this.highlight.useLayerLevel(i);const s=this.highlight.createArea(),a=this.highlight.createLayeredArea(),o=this.highlight.createRowHeader(),u=this.highlight.createColumnHeader(),c=this.highlight.createActiveRowHeader(),f=this.highlight.createActiveColumnHeader(),g=this.highlight.createActiveCornerHeader(),m=this.highlight.createRowHighlight(),v=this.highlight.createColumnHighlight();s.commit(),a.commit(),o.commit(),u.commit(),c.commit(),f.commit(),g.commit(),m.commit(),v.commit()}this.highlight.useLayerLevel(r)}}Lr(HZ,as);const n7=/^(\r\n|\n\r|\r|\n)/,I1e=/^[^\t\r\n]+/,i7=/^\t/;function N1e(t){const e=[[""]];if(t.length===0)return e;let r=0,n=0,i;for(;t.length>0&&i!==t.length;)if(i=t.length,t.match(i7))t=t.replace(i7,""),r+=1,e[n][r]="";else if(t.match(n7))t=t.replace(n7,""),r=0,n+=1,e[n]=[""];else{let s="";if(t.startsWith('"')){let a=0,o=!0;for(;o;){const u=t.slice(0,1);u==='"'&&(a+=1),s+=u,t=t.slice(1),(t.length===0||t.match(/^[\t\r\n]/)&&a%2===0)&&(o=!1)}s=s.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,u=>new Array(Math.floor(u.length/2)).fill('"').join(""))}else{const a=t.match(I1e);s=a?a[0]:"",t=t.slice(s.length)}e[n][r]=s}return e}function By(t){let e,r,n,i,s="",a;for(e=0,r=t.length;e<r;e+=1){for(i=t[e].length,n=0;n<i;n+=1)n>0&&(s+="	"),a=t[e][n],typeof a=="string"?a.indexOf(`
`)>-1?s+=`"${a.replace(/"/g,'""')}"`:s+=a:a==null?s+="":s+=a;e!==r-1&&(s+=`
`)}return s}function kd(t,e,r){return(e=H1e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function H1e(t){var e=F1e(t,"string");return typeof e=="symbol"?e:e+""}function F1e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class tp{static get DESTINATION_RENDERER(){return 1}static get DESTINATION_CLIPBOARD_GENERATOR(){return 2}constructor(e,r,n){kd(this,"hot",void 0),kd(this,"metaManager",void 0),kd(this,"tableMeta",void 0),kd(this,"dataSource",void 0),kd(this,"duckSchema",void 0),kd(this,"colToPropCache",void 0),kd(this,"propToColCache",void 0),this.hot=e,this.metaManager=n,this.tableMeta=n.getTableMeta(),this.dataSource=r,this.refreshDuckSchema(),this.createMap()}createMap(){const e=this.getSchema();if(typeof e>"u")throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");const r=this.tableMeta.columns;let n;if(this.colToPropCache=[],this.propToColCache=new Map,r){let i=0,s=0,a=!1;if(typeof r=="function"){const o=WR(e);i=o>0?o:this.countFirstRowKeys(),a=!0}else{const o=this.tableMeta.maxCols;i=Math.min(o,r.length)}for(n=0;n<i;n++){const o=a?r(n):r[n];if(Vt(o)){if(typeof o.data<"u"){const u=a?s:n;this.colToPropCache[u]=o.data,this.propToColCache.set(o.data,u)}s+=1}}}else this.recursiveDuckColumns(e)}countFirstRowKeys(){return sL(this.dataSource)}recursiveDuckColumns(e,r,n){let i=r,s=n,a;return typeof i>"u"&&(i=0,s=""),typeof e=="object"&&!Array.isArray(e)&&Wt(e,(o,u)=>{o===null?(a=s+u,this.colToPropCache.push(a),this.propToColCache.set(a,i),i+=1):i=this.recursiveDuckColumns(o,i,`${u}.`)}),i}colToProp(e){if(Number.isInteger(e)===!1)return e;const r=this.hot.toPhysicalColumn(e);return r===null?e:this.colToPropCache&&it(this.colToPropCache[r])?this.colToPropCache[r]:r}propToCol(e){const r=this.propToColCache.get(e);if(it(r))return this.hot.toVisualColumn(r);const n=this.hot.toVisualColumn(e);return n===null?e:n}getSchema(){const e=this.tableMeta.dataSchema;return e?typeof e=="function"?e():e:this.duckSchema}createDuckSchema(){return this.dataSource&&this.dataSource[0]?Tp(this.dataSource[0]):{}}refreshDuckSchema(){this.duckSchema=this.createDuckSchema()}createRow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:n,mode:i="above"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const s=this.hot.countSourceRows();let a=s,o=0,u=e;if((typeof u!="number"||u>=s)&&(u=s),u<this.hot.countRows()&&(a=this.hot.toPhysicalRow(u)),this.hot.runHooks("beforeCreateRow",u,r,n)===!1||a===null)return{delta:0};const f=this.tableMeta.maxRows,g=this.getSchema().length,m=[];for(;o<r&&s+o<f;){let w=null;this.hot.dataType==="array"?this.tableMeta.dataSchema?w=As(this.getSchema()):(w=[],ct(g-1,()=>w.push(null))):this.hot.dataType==="function"?w=this.tableMeta.dataSchema(u+o):(w={},yS(w,this.getSchema())),m.push(w),o+=1}this.hot.rowIndexMapper.insertIndexes(u,o),i==="below"&&(a=Math.min(a+1,s)),this.spliceData(a,0,m);const v=this.hot.toVisualRow(a);return this.hot.countSourceRows()===m.length&&this.hot.columnIndexMapper.initToLength(this.hot.getInitialColumnCount()),o>0&&(e==null?this.metaManager.createRow(null,o):n!=="auto"&&this.metaManager.createRow(a,r)),this.hot.runHooks("afterCreateRow",v,o,n),{delta:o,startPhysicalIndex:a}}createCol(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:n,mode:i="start"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!this.hot.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");const s=this.dataSource,a=this.tableMeta.maxCols,o=this.hot.countSourceCols(),u=this.hot.countCols(),c=this.hot.countSourceRows(),f=typeof e=="number"&&e<=o?e:u;if(this.hot.runHooks("beforeCreateCol",f,r,n)===!1)return{delta:0};const g=f<u?this.hot.toPhysicalColumn(f):o,m=i==="end"?Math.min(g+1,o):g;let v=0;for(let w=m;v<r&&u+v<a;w++){if(typeof f!="number"||f>=u+v)if(c>0)for(let y=0;y<c;y+=1)typeof s[y]>"u"&&(s[y]=[]),s[y].push(null);else s.push([null]);else for(let y=0;y<c;y++)s[y].splice(w,0,null);v+=1}return v>0&&(e==null?this.metaManager.createColumn(null,v):n!=="auto"&&this.metaManager.createColumn(m,r)),this.hot.columnIndexMapper.insertIndexes(f,v,i),this.hot.runHooks("afterCreateCol",this.hot.toVisualColumn(m),v,n),this.refreshDuckSchema(),{delta:v,startPhysicalIndex:m}}removeRow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0,i=Number.isInteger(e)?e:-r;const s=this.visualRowsToPhysical(i,r),a=this.hot.countSourceRows();if(i=(a+i)%a,this.hot.runHooks("beforeRemoveRow",i,s.length,s,n)===!1)return!1;const u=s.length;if(this.filterData(i,u,s),i<this.hot.countRows()){this.hot.rowIndexMapper.removeIndexes(s);const f=it(this.tableMeta.columns)||it(this.tableMeta.dataSchema)||this.tableMeta.colHeaders;this.hot.rowIndexMapper.getNotTrimmedIndexesLength()===0&&!f&&this.hot.columnIndexMapper.setIndexesSequence([])}return s.slice(0).sort((f,g)=>g-f).forEach(f=>{this.metaManager.removeRow(f,1)}),this.hot.runHooks("afterRemoveRow",i,u,s,n),!0}removeCol(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0;if(this.hot.dataType==="object"||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");let i=typeof e!="number"?-r:e;i=(this.hot.countCols()+i)%this.hot.countCols();const s=this.visualColumnsToPhysical(i,r),a=s.slice(0).sort((g,m)=>m-g);if(this.hot.runHooks("beforeRemoveCol",i,r,s,n)===!1)return!1;let u=!0;const c=a.length,f=this.dataSource;for(let g=0;g<c;g++)u&&s[0]!==s[g]-g&&(u=!1);if(u)for(let g=0,m=this.hot.countSourceRows();g<m;g++)f[g].splice(s[0],r),g===0&&this.metaManager.removeColumn(s[0],r);else for(let g=0,m=this.hot.countSourceRows();g<m;g++)for(let v=0;v<c;v++)f[g].splice(a[v],1),g===0&&this.metaManager.removeColumn(a[v],1);return i<this.hot.countCols()&&(this.hot.columnIndexMapper.removeIndexes(s),!this.tableMeta.rowHeaders&&this.hot.columnIndexMapper.getNotTrimmedIndexesLength()===0&&this.hot.rowIndexMapper.setIndexesSequence([])),this.hot.runHooks("afterRemoveCol",i,r,s,n),this.refreshDuckSchema(),!0}spliceCol(e,r,n){const i=this.hot.getDataAtCol(e),s=i.slice(r,r+n),a=i.slice(r+n);for(var o=arguments.length,u=new Array(o>3?o-3:0),c=3;c<o;c++)u[c-3]=arguments[c];QI(u,a);let f=0;for(;f<n;)u.push(null),f+=1;return JX(u),this.hot.populateFromArray(r,e,u,null,null,"spliceCol"),s}spliceRow(e,r,n){const i=this.hot.getSourceDataAtRow(e),s=i.slice(r,r+n),a=i.slice(r+n);for(var o=arguments.length,u=new Array(o>3?o-3:0),c=3;c<o;c++)u[c-3]=arguments[c];QI(u,a);let f=0;for(;f<n;)u.push(null),f+=1;return this.hot.populateFromArray(e,r,[u],null,null,"spliceRow"),s}spliceData(e,r,n){if(this.hot.runHooks("beforeDataSplice",e,r,n)!==!1){const s=[...this.dataSource.slice(0,e),...n,...this.dataSource.slice(e)];this.dataSource.length=0,s.forEach(a=>this.dataSource.push(a))}}filterData(e,r,n){let i=this.hot.runHooks("filterData",e,r,n);Array.isArray(i)===!1&&(i=this.dataSource.filter((s,a)=>n.indexOf(a)===-1)),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,i)}get(e,r){const n=this.hot.toPhysicalRow(e);let i=this.dataSource[n];const s=this.hot.runHooks("modifyRowData",n);i=isNaN(s)?s:i;const{dataDotNotation:a}=this.hot.getSettings();let o=null;if(i&&i.hasOwnProperty&&ni(i,r))o=i[r];else if(a&&typeof r=="string"&&r.indexOf(".")>-1){let u=i;if(!u)return null;const c=r.split(".");for(let f=0,g=c.length;f<g;f++)if(u=u[c[f]],typeof u>"u")return null;o=u}else typeof r=="function"&&(o=r(this.dataSource.slice(n,n+1)[0]));if(this.hot.hasHook("modifyData")){const u=wa(o);this.hot.runHooks("modifyData",e,this.propToCol(r),u,"get"),u.isTouched()&&(o=u.value)}return o}getCopyable(e,r){return this.hot.getCellMeta(e,this.propToCol(r)).copyable?this.get(e,r):""}set(e,r,n){const i=this.hot.toPhysicalRow(e);let s=n,a=this.dataSource[i];const o=this.hot.runHooks("modifyRowData",i);if(a=isNaN(o)?o:a,this.hot.hasHook("modifyData")){const c=wa(s);this.hot.runHooks("modifyData",e,this.propToCol(r),c,"set"),c.isTouched()&&(s=c.value)}const{dataDotNotation:u}=this.hot.getSettings();if(a&&a.hasOwnProperty&&ni(a,r))a[r]=s;else if(u&&typeof r=="string"&&r.indexOf(".")>-1){let c=a,f=0,g;const m=r.split(".");for(f=0,g=m.length-1;f<g;f++){if(m[f]==="__proto__"||m[f]==="constructor"||m[f]==="prototype")return;typeof c[m[f]]>"u"&&(c[m[f]]={}),c=c[m[f]]}c[m[f]]=s}else if(typeof r=="function")r(this.dataSource.slice(i,i+1)[0],s);else{if(r==="__proto__"||r==="constructor"||r==="prototype")return;a[r]=s}}visualRowsToPhysical(e,r){const n=this.hot.countSourceRows(),i=[];let s=(n+e)%n,a=r,o;for(;s<n&&a;)o=this.hot.toPhysicalRow(s),i.push(o),a-=1,s+=1;return i}visualColumnsToPhysical(e,r){const n=this.hot.countCols(),i=[];let s=(n+e)%n,a=r;for(;s<n&&a;){const o=this.hot.toPhysicalColumn(s);i.push(o),a-=1,s+=1}return i}clear(){for(let e=0;e<this.hot.countSourceRows();e++)for(let r=0;r<this.hot.countCols();r++)this.set(e,this.colToProp(r),"")}getLength(){const e=this.tableMeta.maxRows;let r;e<0||e===0?r=0:r=e||1/0;const n=this.hot.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(n,r)}getAll(){const e={row:0,col:0},r={row:Math.max(this.hot.countRows()-1,0),col:Math.max(this.hot.countCols()-1,0)};return e.row-r.row===0&&!this.hot.countSourceRows()?[]:this.getRange(e,r,tp.DESTINATION_RENDERER)}countCachedColumns(){return this.colToPropCache.length}getRange(e,r,n){const i=[];let s,a,o;const u=this.tableMeta.maxRows,c=this.tableMeta.maxCols;if(u===0||c===0)return[];const f=n===tp.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,g=Math.min(Math.max(u-1,0),Math.max(e.row,r.row)),m=Math.min(Math.max(c-1,0),Math.max(e.col,r.col));for(s=Math.min(e.row,r.row);s<=g;s++){o=[];const v=s>=0?this.hot.toPhysicalRow(s):s;for(a=Math.min(e.col,r.col);a<=m&&v!==null;a++)o.push(f.call(this,s,this.colToProp(a)));v!==null&&i.push(o)}return i}getText(e,r){return By(this.getRange(e,r,tp.DESTINATION_RENDERER))}getCopyableText(e,r){return By(this.getRange(e,r,tp.DESTINATION_CLIPBOARD_GENERATOR))}destroy(){this.hot=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}const{register:L1e,getItem:B1e,hasItem:FZ,getNames:V1e,getValues:cKe}=Zo("cellTypes");function H4(t){if(!FZ(t))throw Error(`You declared cell type "${t}" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by
                 "Handsontable.cellTypes.registerCellType" method`);return B1e(t)}function xo(t,e){typeof t!="string"&&(e=t,t=e.CELL_TYPE);const{editor:r,renderer:n,validator:i}=e;r&&ca(t,r),n&&La(t,n),i&&fg(t,i),L1e(t,e)}function W1e(t,e){var r;return t==="CELL_TYPE"?!1:((r=e._automaticallyAssignedMetaProps)===null||r===void 0?void 0:r.has(t))||!ni(e,t)}function iT(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t;const n=typeof e.type=="string"?H4(e.type):e.type;if(t._automaticallyAssignedMetaProps&&Wt(e,(s,a)=>void t._automaticallyAssignedMetaProps.delete(a)),!Vt(n))return;r===t&&!t._automaticallyAssignedMetaProps&&(t._automaticallyAssignedMetaProps=new Set);const i={};Wt(n,(s,a)=>{if(W1e(a,r)){var o;i[a]=s,(o=t._automaticallyAssignedMetaProps)===null||o===void 0||o.add(a)}}),oi(t,i)}function $1e(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];function r(){}fQ(r,t);for(let n=0;n<e.length;n++)r.prototype[e[n]]=void 0;return r}function yE(t){return Number.isInteger(t)&&t>=0}function SE(t,e){if(!t())throw new Error(`Assertion failed: ${e}`)}function IC(t){return t==null}const LZ=()=>({_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,ariaTags:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataDotNotation:!0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",timeFormat:"h:mm:ss a",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,headerClassName:void 0,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",imeFastEdit:!1,isEmptyCol(t){let e,r,n;for(e=0,r=this.countRows();e<r;e++)if(n=this.getDataAtCell(e,t),In(n)===!1)return!1;return!0},isEmptyRow(t){let e,r,n,i;for(e=0,r=this.countCols();e<r;e++)if(n=this.getDataAtCell(t,e),In(n)===!1)return typeof n=="object"?(i=this.getCellMeta(t,e),VR(this.getSchema()[i.prop],n)):!1;return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,navigableHeaders:!1,tabNavigation:!0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:!1,renderAllColumns:!1,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,textEllipsis:!1,themeName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:!0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",viewportColumnRenderingThreshold:0,viewportRowRenderingThreshold:0,visibleRows:10,width:void 0,wordWrap:!0});function s7(t,e,r){return(e=U1e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function U1e(t){var e=j1e(t,"string");return typeof e=="symbol"?e:e+""}function j1e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Y1e(){return class{}}class z1e{constructor(e){s7(this,"metaCtor",Y1e()),s7(this,"meta",void 0),this.meta=this.metaCtor.prototype,oi(this.meta,LZ()),this.meta.instance=e}getMetaConstructor(){return this.metaCtor}getMeta(){return this.meta}updateMeta(e){var r;oi(this.meta,e),iT(this.meta,{...e,type:(r=e.type)!==null&&r!==void 0?r:this.meta.type},e)}}function G1e(t,e,r){return(e=q1e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function q1e(t){var e=K1e(t,"string");return typeof e=="symbol"?e:e+""}function K1e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class X1e{constructor(e){G1e(this,"meta",void 0);const r=e.getMetaConstructor();this.meta=new r}getMeta(){return this.meta}updateMeta(e){oi(this.meta,e),iT(this.meta,e,e)}}function NC(t,e,r){return(e=Q1e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Q1e(t){var e=Z1e(t,"string");return typeof e=="symbol"?e:e+""}function Z1e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class s_{constructor(e){NC(this,"valueFactory",void 0),NC(this,"data",[]),NC(this,"index",[]),NC(this,"holes",new Set),this.valueFactory=e}obtain(e){SE(()=>yE(e),"Expecting an unsigned number.");const r=this._getStorageIndexByKey(e);let n;if(r>=0)n=this.data[r],n===void 0&&(n=this.valueFactory(e),this.data[r]=n);else if(n=this.valueFactory(e),this.holes.size>0){const i=this.holes.values().next().value;this.holes.delete(i),this.data[i]=n,this.index[e]=i}else this.data.push(n),this.index[e]=this.data.length-1;return n}insert(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;SE(()=>yE(e)||IC(e),"Expecting an unsigned number or null/undefined argument.");const n=[],i=this.data.length;for(let a=0;a<r;a++)n.push(i+a),this.data.push(void 0);const s=IC(e)?this.index.length:e;this.index=[...this.index.slice(0,s),...n,...this.index.slice(s)]}remove(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;SE(()=>yE(e)||IC(e),"Expecting an unsigned number or null/undefined argument.");const n=this.index.splice(IC(e)?this.index.length-r:e,r);for(let i=0;i<n.length;i++){const s=n[i];typeof s=="number"&&this.holes.add(s)}}size(){return this.data.length-this.holes.size}values(){return this.data.filter((e,r)=>e!==void 0&&!this.holes.has(r))[Symbol.iterator]()}entries(){const e=[];for(let n=0;n<this.data.length;n++){const i=this._getKeyByStorageIndex(n);i!==-1&&this.data[n]!==void 0&&e.push([i,this.data[n]])}let r=0;return{next:()=>{if(r<e.length){const n=e[r];return r+=1,{value:n,done:!1}}return{done:!0}}}}clear(){this.data=[],this.index=[],this.holes.clear()}_getStorageIndexByKey(e){return this.index.length>e?this.index[e]:-1}_getKeyByStorageIndex(e){return this.index.indexOf(e)}[Symbol.iterator](){return this.entries()}}function a7(t,e,r){return(e=J1e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function J1e(t){var e=eSe(t,"string");return typeof e=="symbol"?e:e+""}function eSe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const tSe=["data","width"];class rSe{constructor(e){a7(this,"globalMeta",void 0),a7(this,"metas",new s_(()=>this._createMeta())),this.globalMeta=e,this.metas=new s_(()=>this._createMeta())}updateMeta(e,r){const n=this.getMeta(e);oi(n,r),iT(n,r)}createColumn(e,r){this.metas.insert(e,r)}removeColumn(e,r){this.metas.remove(e,r)}getMeta(e){return this.metas.obtain(e)}getMetaConstructor(e){return this.metas.obtain(e).constructor}clearCache(){this.metas.clear()}_createMeta(){return $1e(this.globalMeta.getMetaConstructor(),tSe).prototype}}function o7(t,e,r){return(e=nSe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function nSe(t){var e=iSe(t,"string");return typeof e=="symbol"?e:e+""}function iSe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class sSe{constructor(e){o7(this,"columnMeta",void 0),o7(this,"metas",new s_(()=>this._createRow())),this.columnMeta=e}updateMeta(e,r,n){const i=this.getMeta(e,r);oi(i,n),iT(i,n)}createRow(e,r){this.metas.insert(e,r)}createColumn(e,r){for(let n=0;n<this.metas.size();n++)this.metas.obtain(n).insert(e,r)}removeRow(e,r){this.metas.remove(e,r)}removeColumn(e,r){for(let n=0;n<this.metas.size();n++)this.metas.obtain(n).remove(e,r)}getMeta(e,r,n){const i=this.metas.obtain(e).obtain(r);return n===void 0?i:i[n]}setMeta(e,r,n,i){var s;const a=this.metas.obtain(e).obtain(r);(s=a._automaticallyAssignedMetaProps)===null||s===void 0||s.delete(n),a[n]=i}removeMeta(e,r,n){const i=this.metas.obtain(e).obtain(r);delete i[n]}getMetas(){const e=[],r=Array.from(this.metas.values());for(let n=0;n<r.length;n++)it(r[n])&&e.push(...r[n].values());return e}getMetasAtRow(e){SE(()=>yE(e),"Expecting an unsigned number.");const r=new Map(this.metas);return r.has(e)?Array.from(r.get(e).values()):[]}clearCache(){this.metas.clear()}_createRow(){return new s_(e=>this._createMeta(e))}_createMeta(e){const r=this.columnMeta.getMetaConstructor(e);return new r}}class BZ{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];this.hot=e,this.globalMeta=new z1e(e),this.tableMeta=new X1e(this.globalMeta),this.columnMeta=new rSe(this.globalMeta),this.cellMeta=new sSe(this.columnMeta),n.forEach(i=>new i(this)),this.globalMeta.updateMeta(r)}getGlobalMeta(){return this.globalMeta.getMeta()}updateGlobalMeta(e){this.globalMeta.updateMeta(e)}getTableMeta(){return this.tableMeta.getMeta()}updateTableMeta(e){this.tableMeta.updateMeta(e)}getColumnMeta(e){return this.columnMeta.getMeta(e)}updateColumnMeta(e,r){this.columnMeta.updateMeta(e,r)}getCellMeta(e,r,n){const i=this.cellMeta.getMeta(e,r);return i.visualRow=n.visualRow,i.visualCol=n.visualColumn,i.row=e,i.col=r,n.skipMetaExtension||this.runLocalHooks("afterGetCellMeta",i),i}getCellMetaKeyValue(e,r,n){if(typeof n!="string")throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(e,r,n)}setCellMeta(e,r,n,i){this.cellMeta.setMeta(e,r,n,i)}updateCellMeta(e,r,n){this.cellMeta.updateMeta(e,r,n)}removeCellMeta(e,r,n){this.cellMeta.removeMeta(e,r,n)}getCellsMeta(){return this.cellMeta.getMetas()}getCellsMetaAtRow(e){return this.cellMeta.getMetasAtRow(e)}createRow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createRow(e,r)}removeRow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeRow(e,r)}createColumn(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createColumn(e,r),this.columnMeta.createColumn(e,r)}removeColumn(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeColumn(e,r),this.columnMeta.removeColumn(e,r)}clearCellsCache(){this.cellMeta.clearCache()}clearCache(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}Lr(BZ,as);function l7(t,e,r,n){const{hotInstance:i,dataMap:s,dataSource:a,internalSource:o,source:u,metaManager:c,firstRun:f}=n,g=Ms(o),m=i.getSettings();Array.isArray(m.dataSchema)?i.dataType="array":kr(m.dataSchema)?i.dataType="function":i.dataType="object",s&&s.destroy(),t=i.runHooks(`before${g}`,t,f,u);const v=new tp(i,t,c);if(e(v),typeof t=="object"&&t!==null)t.push&&t.splice||(t=[t]);else if(t===null){const w=v.getSchema();t=[];let y,b=0,x=0;for(b=0,x=m.startRows;b<x;b++)if((i.dataType==="object"||i.dataType==="function")&&m.dataSchema)y=As(w),t.push(y);else if(i.dataType==="array")y=As(w[0]),t.push(y);else{y=[];for(let _=0,T=m.startCols;_<T;_++)y.push(null);t.push(y)}}else throw new Error(`${o} only accepts array of objects or array of arrays (${typeof t} given)`);Array.isArray(t[0])&&(i.dataType="array"),m.data=t,v.dataSource=t,a.data=t,a.dataType=i.dataType,a.colToProp=v.colToProp.bind(v),a.propToCol=v.propToCol.bind(v),a.countCachedColumns=v.countCachedColumns.bind(v),r(v),i.runHooks(`after${g}`,t,f,u),f||(i.runHooks("afterChange",null,o),i.render()),i.getSettings().ariaTags&&bt(i.rootElement,[uQ(-1),BR(i.countCols()+(i.view?i.countRowHeaders():0))])}function u7(t,e,r){return(e=aSe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function aSe(t){var e=oSe(t,"string");return typeof e=="symbol"?e:e+""}function oSe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class lSe{constructor(e){var r=this;u7(this,"metaManager",void 0),u7(this,"metaSyncMemo",new Map),this.metaManager=e,e.addLocalHook("afterGetCellMeta",function(){return r.extendCellMeta(...arguments)}),Je.getSingleton().add("beforeRender",n=>{n&&this.metaSyncMemo.clear()},this.metaManager.hot)}extendCellMeta(e){var r;const{row:n,col:i}=e;if((r=this.metaSyncMemo.get(n))!==null&&r!==void 0&&r.has(i))return;const{visualRow:s,visualCol:a}=e,o=this.metaManager.hot,u=o.colToProp(a);e.prop=u,o.runHooks("beforeGetCellMeta",s,a,e);const c=ni(e,"type")?e.type:null;let f=kr(e.cells)?e.cells(n,i,u):null;if(c)if(f){var g;f.type=(g=f.type)!==null&&g!==void 0?g:c}else f={type:c};f&&this.metaManager.updateCellMeta(n,i,f),o.runHooks("afterGetCellMeta",s,a,e),this.metaSyncMemo.has(n)||this.metaSyncMemo.set(n,new Set),this.metaSyncMemo.get(n).add(i)}}function uSe(t,e,r){cSe(t,e),e.set(t,r)}function cSe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function S2(t,e,r){return(e=hSe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function hSe(t){var e=fSe(t,"string");return typeof e=="symbol"?e:e+""}function fSe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function dSe(t,e){return t.get(gSe(t,e))}function gSe(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var c7=new WeakMap;class mSe{constructor(e){S2(this,"metaManager",void 0),S2(this,"usageTracker",new Set),S2(this,"propDescriptors",new Map([["ariaTags",{initOnly:!0}],["fixedColumnsLeft",{target:"fixedColumnsStart",onChange(r){if(this.metaManager.hot.isRtl()&&r==="fixedColumnsLeft")throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{initOnly:!0}],["renderAllColumns",{initOnly:!0}],["renderAllRows",{initOnly:!0}]])),uSe(this,c7,(r,n,i)=>{if(!i)throw new Error(`The \`${r}\` option can not be updated after the Handsontable is initialized.`)}),this.metaManager=e,this.extendMetaProps()}extendMetaProps(){this.propDescriptors.forEach((e,r)=>{const{initOnly:n,target:i,onChange:s}=e,a=typeof i=="string",o=a?i:r,u=`_${o}`;this.metaManager.globalMeta.meta[u]=this.metaManager.globalMeta.meta[o],s?(this.installPropWatcher(r,u,s),a&&this.installPropWatcher(i,u,s)):n&&(this.installPropWatcher(r,u,dSe(c7,this)),this.metaManager.globalMeta.meta._initOnlySettings||(this.metaManager.globalMeta.meta._initOnlySettings=[]),this.metaManager.globalMeta.meta._initOnlySettings.push(r))})}installPropWatcher(e,r,n){const i=this;Object.defineProperty(this.metaManager.globalMeta.meta,e,{get(){return this[r]},set(s){const a=!i.usageTracker.has(e);i.usageTracker.add(e),n.call(i,e,s,a),this[r]=s},enumerable:!0,configurable:!0})}}const VZ="gridDefault",ed="editorManager.handlingEditor",pSe={name:"editorCloseAndSave",callback(t){t._getEditorManager().closeEditorAndSaveChanges()}},vSe="hooksRefRegisterer",WZ={_hooksStorage:Object.create(null),addHook(t,e){return this._hooksStorage[t]||(this._hooksStorage[t]=[]),this.hot.addHook(t,e),this._hooksStorage[t].push(e),this},removeHooksByKey(t){he(this._hooksStorage[t]||[],e=>{this.hot.removeHook(t,e)})},clearHooks(){Wt(this._hooksStorage,(t,e)=>this.removeHooksByKey(e)),this._hooksStorage={}}};qu(WZ,"MIXIN_NAME",vSe,{writable:!1,enumerable:!1});function cl(t,e,r){return(e=wSe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function wSe(t){var e=ySe(t,"string");return typeof e=="symbol"?e:e+""}function ySe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const SSe="base",Vn=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"});class ov{static get EDITOR_TYPE(){return SSe}constructor(e){cl(this,"hot",void 0),cl(this,"state",Vn.VIRGIN),cl(this,"_opened",!1),cl(this,"_fullEditMode",!1),cl(this,"_closeCallback",null),cl(this,"TD",null),cl(this,"row",null),cl(this,"col",null),cl(this,"prop",null),cl(this,"originalValue",null),cl(this,"cellProperties",null),this.hot=e,this.init()}_fireCallbacks(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)}init(){}getValue(){throw Error("Editor getValue() method unimplemented")}setValue(){throw Error("Editor setValue() method unimplemented")}open(){throw Error("Editor open() method unimplemented")}close(){throw Error("Editor close() method unimplemented")}prepare(e,r,n,i,s,a){this.TD=i,this.row=e,this.col=r,this.prop=n,this.originalValue=s,this.cellProperties=a,this.state=this.isOpened()?this.state:Vn.VIRGIN}extend(){return class extends this.constructor{}}saveValue(e,r){let n,i,s,a;if(r){const u=this.hot.getSelectedLast();n=Math.max(Math.min(u[0],u[2]),0),i=Math.max(Math.min(u[1],u[3]),0),s=Math.max(u[0],u[2]),a=Math.max(u[1],u[3])}else[n,i,s,a]=[this.row,this.col,null,null];const o=this.hot.runHooks("modifyGetCellCoords",n,i,!1,"meta");Array.isArray(o)&&([n,i]=o),this.hot.populateFromArray(n,i,e,s,a,"edit")}beginEditing(e,r){if(this.state!==Vn.VIRGIN)return;const n=this.hot,i=n.rowIndexMapper.getRenderableFromVisualIndex(this.row),s=n.columnIndexMapper.getRenderableFromVisualIndex(this.col),a=()=>{if(this.state=Vn.EDITING,this.isInFullEditMode()){const u=typeof e=="string"?e:cn(this.originalValue);this.setValue(u)}this.open(r),this._opened=!0,this.focus(),n.view.render(),n.runHooks("afterBeginEditing",this.row,this.col)};this.hot.addHookOnce("afterScroll",a),n.view.scrollViewport(n._createCellCoords(i,s))||(this.hot.removeHook("afterScroll",a),a())}finishEditing(e,r,n){let i;if(n){const s=this._closeCallback;this._closeCallback=a=>{s&&s(a),n(a),this.hot.view.render()}}if(!this.isWaiting()){if(this.state===Vn.VIRGIN){this.hot._registerTimeout(()=>{this._fireCallbacks(!0)});return}if(this.state===Vn.EDITING){if(e){this.cancelChanges(),this.hot.view.render();return}const s=this.getValue();this.cellProperties.trimWhitespace?i=[[typeof s=="string"?String.prototype.trim.call(s||""):s]]:i=[[s]],this.state=Vn.WAITING,this.saveValue(i,r),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",a=>{this.state=Vn.FINISHED,this.discardEditor(a)}):(this.state=Vn.FINISHED,this.discardEditor(!0))}}}cancelChanges(){this.state=Vn.FINISHED,this.discardEditor()}discardEditor(e){this.state===Vn.FINISHED&&(e===!1&&this.cellProperties.allowInvalid!==!0?(this.hot.selectCell(this.row,this.col),this.focus(),this.state=Vn.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=Vn.VIRGIN,this._fireCallbacks(!0),this.hot.getShortcutManager().setActiveContextName("grid")))}enableFullEditMode(){this._fullEditMode=!0}isInFullEditMode(){return this._fullEditMode}isOpened(){return this._opened}isWaiting(){return this.state===Vn.WAITING}getEditedCellRect(){var e;const r=this.getEditedCell();if(!r)return;const{wtOverlays:n,wtViewport:i}=this.hot.view._wt,s=this.hot.rootWindow,a=ns(r),o=Un(r),u=ns(this.hot.rootElement),c=Un(this.hot.rootElement),f=n.topOverlay.holder,g=n.inlineStartOverlay.holder,m=f!==s?f.scrollTop:0,v=g!==s?g.scrollLeft:0,w=s.innerWidth-u.left-c,{wtTable:y}=(e=n.getParentOverlay(r))!==null&&e!==void 0?e:this.hot.view._wt,b=y.name,x=["master","inline_start"].includes(b)?m:0,_=["master","top","bottom"].includes(b)?v:0,T=a.top===u.top?0:1;let D=a.top-u.top-T-x,P=0;this.hot.isRtl()?P=s.innerWidth-a.left-o-w-1+_:P=a.left-u.left-1-_,["top","top_inline_start_corner"].includes(b)&&(D+=n.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(b)&&(P+=Math.abs(n.inlineStartOverlay.getOverlayOffset()));const O=this.hot.hasColHeaders(),A=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),W=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),H=this.hot.rowIndexMapper.getRenderableIndexesLength()-this.hot.view._wt.getSetting("fixedRowsBottom");(O&&A<=0||A===H)&&(D+=1),W<=0&&(P+=1);const J=i.rowsRenderCalculator.startPosition,G=i.columnsRenderCalculator.startPosition,ve=Math.abs(n.inlineStartOverlay.getScrollPosition()),be=n.topOverlay.getScrollPosition(),we=Ni(this.hot.rootDocument);let ae=r.offsetTop;if(["inline_start","master"].includes(b)&&(ae+=J-be),["bottom","bottom_inline_start_corner"].includes(b)){const{wtViewport:te,wtTable:fe}=n.bottomOverlay.clone;ae+=te.getWorkspaceHeight()-fe.getHeight()-we}let le=r.offsetLeft;this.hot.isRtl()?(le>=0?le=y.getWidth()-r.offsetLeft:le=Math.abs(le),le+=G-ve-o):["top","master","bottom"].includes(b)&&(le+=G-ve);const Te=s.getComputedStyle(this.TD),ce=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",K=parseInt(Te[ce],10)>0?0:1,Se=parseInt(Te.borderTopWidth,10)>0?0:1,B=Un(r)+K,E=ai(r)+Se,R=AF(f)?we:0,M=OF(g)?we:0,F=this.hot.view.maximumVisibleElementWidth(le)-R+K,Z=Math.max(this.hot.view.maximumVisibleElementHeight(ae)-M+Se,this.hot.stylesHandler.getDefaultRowHeight());return{top:D,start:P,height:E,maxHeight:Z,width:B,maxWidth:F}}getEditedCellsLayerClass(){switch(this.checkEditorSection()){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}getEditedCell(){return this.hot.getCell(this.row,this.col,!0)}checkEditorSection(){const e=this.hot.countRows();let r="";return this.row<this.hot.getSettings().fixedRowsTop?this.col<this.hot.getSettings().fixedColumnsStart?r="top-inline-start-corner":r="top":this.hot.getSettings().fixedRowsBottom&&this.row>=e-this.hot.getSettings().fixedRowsBottom?this.col<this.hot.getSettings().fixedColumnsStart?r="bottom-inline-start-corner":r="bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(r="inline-start"),r}}Lr(ov,WZ);const bSe={name:"editorCloseAndSaveByArrowKeys",callback(t,e,r){const n=t._getEditorManager(),i=n.getActiveEditor();i.isInFullEditMode()&&i.state===Vn.EDITING||(n.closeEditorAndSaveChanges(),t.getSelected()&&(r.includes("arrowdown")?t.selection.transformStart(1,0):r.includes("arrowup")?t.selection.transformStart(-1,0):r.includes("arrowleft")?t.selection.transformStart(0,-1*t.getDirectionFactor()):r.includes("arrowright")&&t.selection.transformStart(0,t.getDirectionFactor())),e.preventDefault())}},CSe={name:"editorCloseAndSaveByEnter",callback(t,e){const r=t._getEditorManager();r.closeEditorAndSaveChanges(e.ctrlKey||e.metaKey),r.moveSelectionAfterEnter(e)}},xSe={name:"editorCloseWithoutSaving",callback(t){const e=t._getEditorManager();e.closeEditorAndRestoreOriginalValue(t.getShortcutManager().isCtrlPressed()),e.activeEditor.focus()}},ESe={name:"editorFastOpen",callback(t,e){const{highlight:r}=t.getSelectedRangeLast();r.isHeader()||t._getEditorManager().openEditor(null,e,!0)}},_Se={name:"editorOpen",callback(t,e,r){const n=t._getEditorManager(),i=t.getSelectedRangeLast(),{highlight:s}=i;if(t.selection.isMultiple()&&!i.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0){const a=t.getSettings(),o=typeof a.enterMoves=="function"?a.enterMoves(e):a.enterMoves;r.includes("shift")?t.selection.transformFocus(-o.row,-o.col):t.selection.transformFocus(o.row,o.col);return}s.isHeader()||(t.getSettings().enterBeginsEditing?n.cellProperties.readOnly?n.moveSelectionAfterEnter(e):n.openEditor(null,e,!0):n.moveSelectionAfterEnter(e),Qo(e))}};function RSe(){return[pSe,bSe,CSe,xSe,ESe,_Se]}const TSe={name:"extendCellsSelectionDown",callback(t){const{selection:e}=t,{highlight:r}=t.getSelectedRangeLast();!e.isSelectedByColumnHeader()&&!e.isSelectedByCorner()&&(r.isCell()||r.isHeader()&&e.isSelectedByRowHeader())&&(e.markSource("keyboard"),e.transformEnd(1,0),e.markEndSource())}},MSe={name:"extendCellsSelectionDownByViewportHeight",callback(t){const{selection:e,rowIndexMapper:r}=t,{to:n}=t.getSelectedRangeLast(),i=Math.min(n.row+t.countVisibleRows(),t.countRows()-1),s=r.getNearestNotHiddenIndex(i,-1);if(s!==null){const a=t._createCellCoords(s,n.col),o=n.row-t.getFirstFullyVisibleRow(),u=Math.min(a.row-o,t.countRows()-1);e.markSource("keyboard"),e.setRangeEnd(a),e.markEndSource(),t.scrollViewportTo({row:u,verticalSnap:"top",horizontalSnap:"start"})}}},ASe={name:"extendCellsSelectionLeft",callback(t){const{selection:e}=t,{highlight:r}=t.getSelectedRangeLast();!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&(r.isCell()||r.isHeader()&&e.isSelectedByColumnHeader())&&(e.markSource("keyboard"),e.transformEnd(0,-1*t.getDirectionFactor()),e.markEndSource())}},OSe={name:"extendCellsSelectionRight",callback(t){const{selection:e}=t,{highlight:r}=t.getSelectedRangeLast();!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&(r.isCell()||r.isHeader()&&e.isSelectedByColumnHeader())&&(e.markSource("keyboard"),e.transformEnd(0,t.getDirectionFactor()),e.markEndSource())}},kSe={name:"extendCellsSelectionToColumns",callback(t){const{selection:e}=t,{highlight:r,from:n,to:i}=t.getSelectedRangeLast();e.markSource("keyboard"),e.isSelectedByRowHeader()?e.selectAll(!0,!0):t.selectColumns(n.col,i.col,r),e.markEndSource()}},DSe={name:"extendCellsSelectionToMostBottom",callback(t){const{selection:e,rowIndexMapper:r}=t,{highlight:n,from:i,to:s}=t.getSelectedRangeLast(),a=n.isHeader()&&e.isSelectedByRowHeader();if(n.isCell()||a){const o=r.getNearestNotHiddenIndex(t.countRows()-1,-1),u=i.clone();u.row=n.row,e.markSource("keyboard"),e.setRangeStart(u,void 0,!1,n.clone()),a&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(o,s.col)),e.markEndSource()}}},PSe={name:"extendCellsSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:r}=t,{highlight:n,from:i,to:s}=t.getSelectedRangeLast();if(!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&n.isCell()){const a=r.getNearestNotHiddenIndex(t.countCols()-1,-1),o=i.clone();o.col=n.col,e.markSource("keyboard"),e.setRangeStart(o,void 0,!1,n.clone()),e.setRangeEnd(t._createCellCoords(s.row,a)),e.markEndSource()}}},ISe={name:"extendCellsSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:r}=t,{highlight:n,from:i,to:s}=t.getSelectedRangeLast();if(!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&n.isCell()){const a=parseInt(t.getSettings().fixedColumnsStart,10),o=r.getNearestNotHiddenIndex(a,1),u=i.clone();u.col=n.col,e.markSource("keyboard"),e.setRangeStart(u,void 0,!1,n.clone()),e.setRangeEnd(t._createCellCoords(s.row,o)),e.markEndSource()}}},NSe={name:"extendCellsSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:r}=t,{highlight:n,from:i,to:s}=t.getSelectedRangeLast(),a=n.isHeader()&&e.isSelectedByColumnHeader();if(n.isCell()||a){const o=r.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]),u=i.clone();u.col=n.col,e.markSource("keyboard"),e.setRangeStart(u,void 0,!1,n.clone()),a&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(s.row,o)),e.markEndSource()}}},HSe={name:"extendCellsSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:r}=t,{highlight:n,from:i,to:s}=t.getSelectedRangeLast(),a=n.isHeader()&&e.isSelectedByColumnHeader();if(n.isCell()||a){const o=r.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]),u=i.clone();u.col=n.col,e.markSource("keyboard"),e.setRangeStart(u,void 0,!1,n.clone()),a&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(s.row,o)),e.markEndSource()}}},FSe={name:"extendCellsSelectionToMostTop",callback(t){const{selection:e,rowIndexMapper:r}=t,{highlight:n,from:i,to:s}=t.getSelectedRangeLast(),a=n.isHeader()&&e.isSelectedByRowHeader();if(n.isCell()||a){const o=r.getNearestNotHiddenIndex(0,1),u=i.clone();u.row=n.row,e.markSource("keyboard"),e.setRangeStart(u,void 0,!1,n.clone()),a&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(o,s.col)),e.markEndSource()}}},LSe={name:"extendCellsSelectionToRows",callback(t){const{selection:e}=t,{highlight:r,from:n,to:i}=t.getSelectedRangeLast();e.markSource("keyboard"),e.isSelectedByColumnHeader()?e.selectAll(!0,!0):t.selectRows(n.row,i.row,r),e.markEndSource()}},BSe={name:"extendCellsSelectionUp",callback(t){const{selection:e}=t,{highlight:r}=t.getSelectedRangeLast();!e.isSelectedByColumnHeader()&&!e.isSelectedByCorner()&&(r.isCell()||r.isHeader()&&e.isSelectedByRowHeader())&&(e.markSource("keyboard"),e.transformEnd(-1,0),e.markEndSource())}},VSe={name:"extendCellsSelectionUpByViewportHeight",callback(t){const{selection:e,rowIndexMapper:r}=t,{to:n}=t.getSelectedRangeLast(),i=Math.max(n.row-t.countVisibleRows(),0),s=r.getNearestNotHiddenIndex(i,1);if(s!==null){const a=t._createCellCoords(s,n.col),o=n.row-t.getFirstFullyVisibleRow(),u=Math.max(a.row-o,0);e.markSource("keyboard"),e.setRangeEnd(a),e.markEndSource(),t.scrollViewportTo({row:u,verticalSnap:"top",horizontalSnap:"start"})}}};function WSe(){return[TSe,MSe,ASe,OSe,kSe,DSe,PSe,ISe,NSe,HSe,FSe,LSe,BSe,VSe]}const $Se={name:"moveCellSelectionDown",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.transformStart(1,0),e.markEndSource()}},USe={name:"moveCellSelectionDownByViewportHeight",callback(t){const{selection:e}=t,{navigableHeaders:r}=t.getSettings(),n=r?t.countColHeaders():0,{row:i}=t.getSelectedRangeLast().highlight;let s=t.countVisibleRows()+n;s=s===0?1:s,i===t.countRows()-1?s=1:i+s>t.countRows()&&(s=t.countRows()-i-1),e.markSource("keyboard"),e.transformStart(s,0),e.markEndSource(),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}},jSe={name:"moveCellSelectionInlineEnd",callback(t,e){const{selection:r}=t,n=t.getSettings(),i=t.getSelectedRangeLast(),s=typeof n.tabMoves=="function"?n.tabMoves(e):n.tabMoves;r.markSource("keyboard"),r.isMultiple()&&!i.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0?r.transformFocus(-s.row,-s.col):r.transformStart(-s.row,-s.col),r.markEndSource()}},YSe={name:"moveCellSelectionInlineStart",callback(t,e){const{selection:r}=t,n=t.getSettings(),i=t.getSelectedRangeLast(),s=typeof n.tabMoves=="function"?n.tabMoves(e):n.tabMoves;r.markSource("keyboard"),r.isMultiple()&&!i.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0?r.transformFocus(s.row,s.col):r.transformStart(s.row,s.col),r.markEndSource()}},zSe={name:"moveCellSelectionLeft",callback(t){const{selection:e}=t;e.markSource("keyboard"),e.transformStart(0,-1*t.getDirectionFactor()),e.markEndSource()}},GSe={name:"moveCellSelectionRight",callback(t){const{selection:e}=t;e.markSource("keyboard"),e.transformStart(0,t.getDirectionFactor()),e.markEndSource()}},qSe={name:"moveCellSelectionToMostBottom",callback(t){const{selection:e}=t,{col:r}=t.getSelectedRangeLast().highlight;let n=t.rowIndexMapper.getNearestNotHiddenIndex(t.countRows()-1,-1);n===null&&(n=-1),e.setRangeStart(t._createCellCoords(n,r))}},KSe={name:"moveCellSelectionToMostBottomInlineEnd",callback(t){const{selection:e,rowIndexMapper:r,columnIndexMapper:n}=t,i=parseInt(t.getSettings().fixedRowsBottom,10),s=r.getNearestNotHiddenIndex(t.countRows()-i-1,-1),a=n.getNearestNotHiddenIndex(t.countCols()-1,-1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(s,a)),e.markEndSource()}},XSe={name:"moveCellSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:r}=t;e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(t.getSelectedRangeLast().highlight.row,r.getNearestNotHiddenIndex(t.countCols()-1,-1))),e.markEndSource()}},QSe={name:"moveCellSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:r}=t,n=parseInt(t.getSettings().fixedColumnsStart,10),i=t.getSelectedRangeLast().highlight.row,s=r.getNearestNotHiddenIndex(n,1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(i,s)),e.markEndSource()}},ZSe={name:"moveCellSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:r}=t,n=t.getSelectedRangeLast().highlight.row;let i=r.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]);i===null&&(i=t.isRtl()?-1:-t.countRowHeaders()),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(n,i)),e.markEndSource()}},JSe={name:"moveCellSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:r}=t,{row:n}=t.getSelectedRangeLast().highlight;let i=r.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]);i===null&&(i=t.isRtl()?-t.countRowHeaders():-1),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(n,i)),e.markEndSource()}},ebe={name:"moveCellSelectionToMostTop",callback(t){const{selection:e}=t,{col:r}=t.getSelectedRangeLast().highlight;let n=t.rowIndexMapper.getNearestNotHiddenIndex(0,1);n===null&&(n=-t.countColHeaders()),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(n,r)),e.markEndSource()}},tbe={name:"moveCellSelectionToMostTopInlineStart",callback(t){const{selection:e,rowIndexMapper:r,columnIndexMapper:n}=t,i=parseInt(t.getSettings().fixedRowsTop,10),s=parseInt(t.getSettings().fixedColumnsStart,10),a=r.getNearestNotHiddenIndex(i,1),o=n.getNearestNotHiddenIndex(s,1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(a,o)),e.markEndSource()}},rbe={name:"moveCellSelectionUp",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.transformStart(-1,0),e.markEndSource()}},nbe={name:"moveCellSelectionUpByViewportHight",callback(t){const{selection:e}=t,{navigableHeaders:r}=t.getSettings(),n=r?t.countColHeaders():0,{row:i}=t.getSelectedRangeLast().highlight;let s=t.countVisibleRows()+n;s=s===0?-1:-s,i===-n?s=-1:i+s<n&&(s=-(i+n)),e.markSource("keyboard"),e.transformStart(s,0),e.markEndSource(),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}};function ibe(){return[$Se,USe,jSe,YSe,zSe,GSe,qSe,KSe,XSe,QSe,ZSe,JSe,ebe,tbe,rbe,nbe]}const sbe={name:"emptySelectedCells",callback(t){t.emptySelectedCells(),t._getEditorManager().prepareEditor()}},abe={name:"scrollToFocusedCell",callback(t){const{highlight:e}=t.getSelectedRangeLast(),r=t.getFirstFullyVisibleRow()-1,n=t.getFirstFullyVisibleColumn()-1,i=t.getLastFullyVisibleRow()+1,s=t.getLastFullyVisibleColumn()+1,a=t._createCellCoords(r,n),o=t._createCellCoords(i,s);if(!t._createCellRange(a,a,o).includes(e)&&(e.row>=0||e.col>=0)){const c={};if(e.col>=0){const f=Math.floor(t.countVisibleCols()/2);c.col=Math.max(e.col-f,0)}if(e.row>=0){const f=Math.floor(t.countVisibleRows()/2);c.row=Math.max(e.row-f,0)}t.scrollViewportTo({...c,verticalSnap:"top",horizontalSnap:"start"})}}},obe={name:"selectAllCells",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.selectAll(!0,!0,{disableHeadersHighlight:!0}),e.markEndSource()}},lbe={name:"selectAllCellsAndHeaders",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.selectAll(!0,!0,{disableHeadersHighlight:!1}),e.markEndSource()}},ube={name:"populateSelectedCellsData",callback(t){const e=t.getSelectedRange(),{row:r,col:n}=e[e.length-1].highlight.normalize(),i=t.getDataAtCell(r,n),s=new Map;for(let a=0;a<e.length;a++)e[a].forAll((o,u)=>{if(o>=0&&u>=0&&(o!==r||u!==n)){const{readOnly:c}=t.getCellMeta(o,u);c||s.set(`${o}x${u}`,[o,u,i])}});t.setDataAtCell(Array.from(s.values()))}},cbe=[...RSe(),...WSe(),...ibe(),sbe,abe,obe,lbe,ube];function $Z(t){const e={};return cbe.forEach(r=>{let{name:n,callback:i}=r;e[n]=function(){for(var s=arguments.length,a=new Array(s),o=0;o<s;o++)a[o]=arguments[o];return i(t,...a)}}),e}function hbe(t){const e=t.getShortcutManager().addContext("editor"),r=$Z(t),n={group:ed};e.addShortcuts([{keys:[["Enter"],["Enter","Shift"]],callback:(i,s)=>r.editorCloseAndSaveByEnter(i,s)},{keys:[["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],captureCtrl:!0,callback:(i,s)=>r.editorCloseAndSaveByEnter(i,s)},{keys:[["Tab"],["Tab","Shift"],["PageDown"],["PageUp"]],forwardToContext:t.getShortcutManager().getContext("grid"),callback:(i,s)=>r.editorCloseAndSave(i,s)},{keys:[["ArrowDown"],["ArrowUp"],["ArrowLeft"],["ArrowRight"]],preventDefault:!1,callback:(i,s)=>r.editorCloseAndSaveByArrowKeys(i,s)},{keys:[["Escape"],["Escape","Control/Meta"]],callback:()=>r.editorCloseWithoutSaving()}],n)}function fbe(t){const e=t.getShortcutManager().addContext("grid"),r=$Z(t),n={runOnlyIf:()=>{const{navigableHeaders:i}=t.getSettings();return it(t.getSelected())&&(i||!i&&t.countRenderedRows()>0&&t.countRenderedCols()>0)},group:VZ};e.addShortcuts([{keys:[["F2"]],callback:i=>r.editorFastOpen(i)},{keys:[["Enter"],["Enter","Shift"]],callback:(i,s)=>r.editorOpen(i,s)},{keys:[["Backspace"],["Delete"]],callback:()=>r.emptySelectedCells()}],{group:ed,runOnlyIf:()=>it(t.getSelected())}),e.addShortcuts([{keys:[["Control/Meta","A"]],callback:()=>r.selectAllCells(),runOnlyIf:()=>{var i;return!((i=t.getSelectedRangeLast())!==null&&i!==void 0&&i.highlight.isHeader())}},{keys:[["Control/Meta","A"]],callback:()=>{},runOnlyIf:()=>{var i;return(i=t.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight.isHeader()},preventDefault:!0},{keys:[["Control/Meta","Shift","Space"]],callback:()=>r.selectAllCellsAndHeaders()},{keys:[["Control/Meta","Enter"]],callback:()=>r.populateSelectedCellsData(),runOnlyIf:()=>{var i,s;return!((i=t.getSelectedRangeLast())!==null&&i!==void 0&&i.highlight.isHeader())&&((s=t.getSelectedRangeLast())===null||s===void 0?void 0:s.getCellsCount())>1}},{keys:[["Control","Space"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToColumns()},{keys:[["Shift","Space"]],stopPropagation:!0,callback:()=>r.extendCellsSelectionToRows()},{keys:[["ArrowUp"]],callback:()=>r.moveCellSelectionUp()},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostTop()},{keys:[["ArrowUp","Shift"]],callback:()=>r.extendCellsSelectionUp()},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToMostTop(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowDown"]],callback:()=>r.moveCellSelectionDown()},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostBottom()},{keys:[["ArrowDown","Shift"]],callback:()=>r.extendCellsSelectionDown()},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToMostBottom(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowLeft"]],callback:()=>r.moveCellSelectionLeft()},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostLeft()},{keys:[["ArrowLeft","Shift"]],callback:()=>r.extendCellsSelectionLeft()},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToMostLeft(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["ArrowRight"]],callback:()=>r.moveCellSelectionRight()},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostRight()},{keys:[["ArrowRight","Shift"]],callback:()=>r.extendCellsSelectionRight()},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToMostRight(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["Home"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["Home","Shift"]],callback:()=>r.extendCellsSelectionToMostInlineStart()},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostTopInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End","Shift"]],callback:()=>r.extendCellsSelectionToMostInlineEnd()},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostBottomInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["PageUp"]],callback:()=>r.moveCellSelectionUpByViewportHight()},{keys:[["PageUp","Shift"]],callback:()=>r.extendCellsSelectionUpByViewportHeight()},{keys:[["PageDown"]],callback:()=>r.moveCellSelectionDownByViewportHeight()},{keys:[["PageDown","Shift"]],callback:()=>r.extendCellsSelectionDownByViewportHeight()},{keys:[["Tab"]],preventDefault:!1,callback:i=>r.moveCellSelectionInlineStart(i)},{keys:[["Shift","Tab"]],preventDefault:!1,callback:i=>r.moveCellSelectionInlineEnd(i)},{keys:[["Control/Meta","Backspace"]],callback:()=>r.scrollToFocusedCell()}],n)}function dbe(t){[fbe,hbe].forEach(e=>e(t))}function gbe(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r=t.rootElement,n=h7(t),i=h7(t);return n.addEventListener("focus",()=>e?.onFocusFromTop()),i.addEventListener("focus",()=>e?.onFocusFromBottom()),r.before(n),r.after(i),{activate(){t._registerTimeout(()=>{n.tabIndex=0,i.tabIndex=0},10)},deactivate(){t._registerTimeout(()=>{n.tabIndex=-1,i.tabIndex=-1},10)}}}function h7(t){const r=t.rootDocument.createElement("input");return r.type="text",r.name="__htFocusCatcher",r.classList.add("htFocusCatcher"),t.getSettings().ariaTags&&bt(r,[Rp("Focus catcher")]),r}function mbe(t){const e=pbe(t);let r;const{activate:n,deactivate:i}=gbe(t,{onFocusFromTop(){var g;const m=(g=e(r))!==null&&g!==void 0?g:pN(t);m&&(t.runHooks("modifyFocusOnTabNavigation","from_above",m),t.selectCell(m.row,m.col)),t.listen()},onFocusFromBottom(){var g;const m=(g=e(r))!==null&&g!==void 0?g:vN(t);m&&(t.runHooks("modifyFocusOnTabNavigation","from_below",m),t.selectCell(m.row,m.col)),t.listen()}}),s={wrapped:!1,flipped:!1};let a=!0,o=!1,u=!1;t.addHook("afterListen",()=>i()),t.addHook("afterUnlisten",()=>n()),t.addHook("afterSelection",(g,m,v,w,y)=>{if(o&&(s.wrapped&&s.flipped||u)&&(u=!1,y.value=!0),a){var b;r=(b=t.getSelectedRangeLast())===null||b===void 0?void 0:b.highlight}}),t.addHook("beforeRowWrap",(g,m,v)=>{s.wrapped=!0,s.flipped=v});function c(){s.wrapped=!1,s.flipped=!1,t.deselectCell(),t.unlisten()}const f={keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:VZ,group:"focusCatcher"};t.getShortcutManager().getContext("grid").addShortcuts([{...f,callback:()=>{const{tabNavigation:g}=t.getSettings();o=!0,t.getSelectedRangeLast()&&!g&&(a=!1),g||(u=!0)},position:"before"},{...f,callback:g=>{const{tabNavigation:m,autoWrapRow:v}=t.getSettings();if(o=!1,a=!0,!m||!t.selection.isSelected()||v&&s.wrapped&&s.flipped||!v&&s.wrapped)return v&&s.wrapped&&s.flipped&&(r=g.shiftKey?pN(t):vN(t)),c(),!1;g.preventDefault()},position:"after"}])}function pN(t){const{rowIndexMapper:e,columnIndexMapper:r}=t,{navigableHeaders:n}=t.getSettings();let i=n&&t.countColHeaders()>0?-t.countColHeaders():0,s=n&&t.countRowHeaders()>0?-t.countRowHeaders():0;return i===0&&(i=e.getVisualFromRenderableIndex(i)),s===0&&(s=r.getVisualFromRenderableIndex(s)),i===null||s===null?null:t._createCellCoords(i,s)}function vN(t){var e,r;const{rowIndexMapper:n,columnIndexMapper:i}=t,{navigableHeaders:s}=t.getSettings();let a=n.getRenderableIndexesLength()-1,o=i.getRenderableIndexesLength()-1;if(a<0){if(!s||t.countColHeaders()===0)return null;a=-1}if(o<0){if(!s||t.countColHeaders()===0)return null;o=-1}return t._createCellCoords((e=n.getVisualFromRenderableIndex(a))!==null&&e!==void 0?e:a,(r=i.getVisualFromRenderableIndex(o))!==null&&r!==void 0?r:o)}function pbe(t){return e=>{if(!e)return null;const r=pN(t),n=vN(t);return e.col<r.col&&(e.col=r.col),e.col>n.col&&(e.col=n.col),e.row<r.row&&(e.row=r.row),e.row>n.row&&(e.row=n.row),e}}function lv(t){Iu(t)&&t.scrollIntoView({block:"nearest",inline:"nearest"})}function sT(t){const{selection:e,view:r}=t,n=t.getSelectedRangeLast(),i=e.getSelectionSource(),s=r.getFirstFullyVisibleColumn(),a=r.getLastFullyVisibleColumn(),o=n.getTopStartCorner().col,u=n.getBottomEndCorner().col,c=o<=s,f=u>=a,g=r.getFirstFullyVisibleRow(),m=r.getLastFullyVisibleRow(),v=n.getTopStartCorner().row,w=n.getBottomEndCorner().row,y=v<=g,b=w>=m;return{getComputedColumnTarget(x){return i==="mouse"||i==="keyboard"?x.col:c&&f?n.highlight.col:c?o:f?u:x.col},getComputedRowTarget(x){return i==="mouse"||i==="keyboard"?x.row:y&&b?n.highlight.row:y?v:b?w:x.row}}}function vbe(t){return e=>{const r=sT(t).getComputedColumnTarget(e);t.scrollViewportTo({col:r},()=>{const n=!!t.getSettings().colHeaders;lv(t.getCell(n?-1:0,r,!0))})}}function wbe(){return()=>{}}function ybe(t){return e=>{t.scrollViewportTo(e.toObject(),()=>{const{row:r,col:n}=t.getSelectedRangeLast().highlight;lv(t.getCell(r,n,!0))})}}function Sbe(t){return e=>{const r=sT(t),n={row:r.getComputedRowTarget(e),col:r.getComputedColumnTarget(e)};t.scrollViewportTo(n,()=>{const{row:i,col:s}=n;lv(t.getCell(i,s,!0))})}}function bbe(t){return e=>{const r=sT(t),n={row:r.getComputedRowTarget(e),col:r.getComputedColumnTarget(e)};t.scrollViewportTo(n,()=>{const{row:i,col:s}=n;lv(t.getCell(i,s,!0))})}}function Cbe(t){return e=>{const r=sT(t).getComputedRowTarget(e);t.scrollViewportTo({row:r},()=>{const n=!!t.getSettings().rowHeaders;lv(t.getCell(r,n?-1:0,!0))})}}function xbe(t){return e=>{const r=t.selection.getSelectionSource(),{row:n,col:i}=e,s=()=>{lv(t.getCell(n,i,!0))};if(n<0&&i>=0)t.scrollViewportTo({col:i},s);else if(i<0&&n>=0)t.scrollViewportTo({row:n},s);else{if(r==="mouse"&&(i===t.view.getLastPartiallyVisibleColumn()||n===t.view.getLastPartiallyVisibleRow()))return;t.scrollViewportTo({row:n,col:i},s)}}}function Ebe(t){const{selection:e}=t;let r=!1,n=!1;return{resume(){n=!1},suspend(){n=!0},skipNextScrollCycle(){r=!0},scrollTo(i){var s;if(r||n){r=!1;return}let a;e.isFocusSelectionChanged()?a=ybe(t):e.isSelectedByCorner()?a=wbe():e.isSelectedByRowHeader()?a=Cbe(t):e.isSelectedByColumnHeader()?a=vbe(t):e.getSelectedRange().size()===1&&e.isMultiple()?a=Sbe(t):e.getSelectedRange().size()===1&&!e.isMultiple()?a=xbe(t):e.getSelectedRange().size()>1&&(a=bbe(t)),(s=a)===null||s===void 0||s(i)}}}const f7=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),HC=t=>t.map(e=>{const r=e.toLowerCase();return f7.has(r)?f7.get(r):r}).sort().join("+"),_be=t=>t.split("+"),d7=new Map([[96,"numpad0"],[97,"numpad1"],[98,"numpad2"],[99,"numpad3"],[100,"numpad4"],[101,"numpad5"],[102,"numpad6"],[103,"numpad7"],[104,"numpad8"],[105,"numpad9"],[106,"multiply"],[107,"add"],[108,"decimal"],[109,"subtract"],[110,"decimal"],[111,"divide"],[112,"f1"],[113,"f2"],[114,"f3"],[115,"f4"],[116,"f5"],[117,"f6"],[118,"f7"],[119,"f8"],[120,"f9"],[121,"f10"],[122,"f11"],[123,"f12"],[186,"semicolon"],[187,"equal"],[188,"comma"],[189,"minus"],[190,"period"],[191,"slash"],[192,"backquote"],[219,"bracketleft"],[220,"backslash"],[221,"bracketright"],[222,"quote"]]),b2=t=>{let{which:e,key:r}=t;if(d7.has(e))return d7.get(e);const n=String.fromCharCode(e).toLowerCase();return/^[a-z0-9]$/.test(n)?n:r.toLowerCase()},UZ=Symbol("shortcut-context");function jZ(t){return Vt(t)&&t.__kindOf===UZ}const Rbe=t=>{const e=qR({errorIdExists:u=>`The "${u}" shortcut is already registered in the "${t}" context.`}),r=function(){let{keys:u,callback:c,group:f,runOnlyIf:g=()=>!0,captureCtrl:m=!1,preventDefault:v=!0,stopPropagation:w=!1,relativeToGroup:y,position:b,forwardToContext:x}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(gn(f))throw new Error("You need to define the shortcut's group.");if(kr(c)===!1)throw new Error("The shortcut's callback needs to be a function.");if(Array.isArray(u)===!1)throw new Error(Dr`Pass the shortcut\'s keys as an array of arrays,\x20
      using the KeyboardEvent.key properties:\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`);const _={callback:c,group:f,runOnlyIf:g,captureCtrl:m,preventDefault:v,stopPropagation:w};it(y)&&(_.relativeToGroup=y,_.position=b),jZ(x)&&(_.forwardToContext=x),u.forEach(T=>{const D=HC(T);if(e.hasItem(D)){const O=e.getItem(D);let A=O.findIndex(W=>W.group===y);A!==-1?b==="before"?A-=1:A+=1:A=O.length,O.splice(A,0,_)}else e.addItem(D,[_])})},n=function(u){let c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};u.forEach(f=>{Wt(c,(g,m)=>{Object.prototype.hasOwnProperty.call(f,m)===!1&&(f[m]=c[m])}),r(f)})},i=u=>{const c=HC(u);e.removeItem(c)};return{__kindOf:UZ,addShortcut:r,addShortcuts:n,getShortcuts:u=>{const c=HC(u),f=e.getItem(c);return it(f)?f.slice():[]},hasShortcut:u=>{const c=HC(u);return e.hasItem(c)},removeShortcutsByKeys:i,removeShortcutsByGroup:u=>{e.getItems().forEach(f=>{let[g,m]=f;const v=m.filter(w=>w.group!==u);v.length===0?i(_be(g)):(m.length=0,m.push(...v))})}}};function Tbe(){const t=new Set;return{press(e){t.add(e)},release(e){t.delete(e)},releaseAll(){t.clear()},isPressed(e){return t.has(e)}}}const Mbe=["meta","alt","shift","control"],Fw=Tbe(),Lw=[];let FC=0;function Abe(t,e,r,n,i){const s=v=>Mbe.includes(v),a=function(v){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const y=[];return v.altKey&&y.push("alt"),w&&(v.ctrlKey||v.metaKey)?y.push("control/meta"):(v.ctrlKey&&y.push("control"),v.metaKey&&y.push("meta")),v.shiftKey&&y.push("shift"),y},o=v=>{if(e(v)===!1||r(v)===!1||v.keyCode===229||typeof v.key!="string"||gf(v))return;const y=b2(v);let b=[];s(y)||(b=a(v));const x=[y].concat(b);!i(v,x)&&(JE()&&b.includes("meta")||!JE()&&b.includes("control"))&&i(v,[y].concat(a(v,!0))),n(v)},u=v=>{if(typeof v.key=="string"){const w=b2(v);s(w)&&Fw.press(w)}},c=v=>{if(typeof v.key=="string"){const w=b2(v);s(w)&&Fw.release(w)}},f=()=>{Fw.releaseAll()};return{mount:()=>{let v=t;for(FC+=1;v;)FC===1&&(v.document.documentElement.addEventListener("keydown",u),Lw.push({event:"keydown",listener:u}),v.document.documentElement.addEventListener("keyup",c),Lw.push({event:"keyup",listener:c})),v.document.documentElement.addEventListener("keydown",o),v.document.documentElement.addEventListener("blur",f),v=Pg(v)},unmount:()=>{let v=t;for(FC-=1;v;){if(FC===0){for(let w=0;w<Lw.length;w++){const{event:y,listener:b}=Lw[w];v.document.documentElement.removeEventListener(y,b)}Lw.length=0}v.document.documentElement.removeEventListener("keydown",o),v.document.documentElement.removeEventListener("blur",f),v=Pg(v)}},isPressed:v=>Fw.isPressed(v),releasePressedKeys:()=>Fw.releaseAll()}}const Obe=t=>{let{ownerWindow:e,handleEvent:r,beforeKeyDown:n,afterKeyDown:i}=t;const s=qR({errorIdExists:w=>`The "${w}" context name is already registered.`});let a="grid";const o=w=>{const y=Rbe(w);return s.addItem(w,y),y},u=()=>a,c=w=>s.getItem(w),f=w=>{if(!s.hasItem(w))throw new Error(Dr`You've tried to activate the "${w}" shortcut context\x20
        that does not exist. Before activation, register the context using the "addContext" method.`);a=w};let g=!1;const m=function(w,y){let b=arguments.length>2&&arguments[2]!==void 0?arguments[2]:u();const x=jZ(b)?b:c(b);let _=!1;if(!x.hasShortcut(y))return _;const T=x.getShortcuts(y);for(let D=0;D<T.length;D++){const{callback:P,runOnlyIf:O,preventDefault:A,stopPropagation:W,captureCtrl:L,forwardToContext:H}=T[D];if(O(w)===!0){if(g=L,_=P(w,y)===!1,g=!1,A&&w.preventDefault(),W&&(Qo(w),w.stopPropagation()),_)break;H&&m(w,y,H)}}return _},v=Abe(e,r,n,i,m);return v.mount(),{addContext:o,getActiveContextName:u,getContext:c,setActiveContextName:f,isCtrlPressed:()=>!g&&(v.isPressed("control")||v.isPressed("meta")),releasePressedKeys:()=>v.releasePressedKeys(),destroy:()=>v.unmount()}};function g7(t){const{classNames:e}=xQ(t,/ht-theme-[a-zA-Z0-9_-]+/);return e.pop()}function kbe(t,e){YZ(t,e),e.add(t)}function Dd(t,e,r){YZ(t,e),e.set(t,r)}function YZ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function vs(t,e){return t.get(Cl(t,e))}function To(t,e,r){return t.set(Cl(t,e),r),r}function Cl(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const m7=23;var Pd=new WeakMap,a_=new WeakMap,F4=new WeakMap,wN=new WeakMap,of=new WeakMap,xy=new WeakMap,M1=new WeakMap,du=new WeakSet;class Dbe{constructor(e,r){kbe(this,du),Dd(this,Pd,void 0),Dd(this,a_,void 0),Dd(this,F4,void 0),Dd(this,wN,void 0),Dd(this,of,!0),Dd(this,xy,{}),Dd(this,M1,{}),To(a_,this,e),To(wN,this,r)}isClassicTheme(){return vs(of,this)}getCSSVariableValue(e){var r;if(vs(of,this))return null;if(vs(xy,this)[`--ht-${e}`])return vs(xy,this)[`--ht-${e}`];const n=(r=Cl(du,this,Nbe).call(this,`--ht-${e}`))!==null&&r!==void 0?r:Cl(du,this,zZ).call(this,`--ht-${e}`);if(n!==null)return vs(xy,this)[`--ht-${e}`]=n,n}getStyleForTD(e){var r;return(r=vs(M1,this))===null||r===void 0?void 0:r.td[e]}getDefaultRowHeight(){if(vs(of,this))return m7;const e=Cl(du,this,Pbe).call(this);return e||m7}areCellsBorderBox(){return this.getStyleForTD("box-sizing")==="border-box"}useTheme(e){if(!e){To(Pd,this,void 0),To(of,this,!0),Cl(du,this,C2).call(this);return}if(e&&e!==vs(Pd,this)){if(!/ht-theme-.*/.test(e)){br(`Invalid theme name: ${e}. Please provide a valid theme name.`),To(Pd,this,void 0),To(of,this,!1),Cl(du,this,C2).call(this);return}vs(Pd,this)&&Cl(du,this,Hbe).call(this),To(Pd,this,e),To(of,this,!1),Cl(du,this,C2).call(this)}}getThemeName(){return vs(Pd,this)}}function Pbe(){const t=this.getCSSVariableValue("line-height"),e=this.getCSSVariableValue("cell-vertical-padding"),r=Math.ceil(parseFloat(this.getStyleForTD("border-bottom-width")));return t===null||e===null||isNaN(r)?null:t+2*e+r}function C2(){this.isClassicTheme()||To(F4,this,getComputedStyle(vs(a_,this)));const t=Cl(du,this,Ibe).call(this,["box-sizing","border-bottom-width"]);vs(M1,this).td={...vs(M1,this).td,"box-sizing":t["box-sizing"],"border-bottom-width":t["border-bottom-width"]}}function Ibe(t){const e=vs(wN,this),r=vs(a_,this),n=e.createElement("table"),i=e.createElement("tbody"),s=e.createElement("tr"),a=e.createElement("tr"),o=e.createElement("td");a.appendChild(o),i.appendChild(s),i.appendChild(a),n.appendChild(i),r.appendChild(n);const u=getComputedStyle(o),c={};return t.forEach(f=>{c[f]=u.getPropertyValue(f)}),r.removeChild(n),c}function Nbe(t){const e=Math.ceil(parseFloat(Cl(du,this,zZ).call(this,t)));return Number.isNaN(e)?null:e}function zZ(t){const e=vs(F4,this).getPropertyValue(t);return e===""?null:e}function Hbe(){To(M1,this,{}),To(xy,this,{}),To(of,this,!0)}function Fbe(t,e){GZ(t,e),e.add(t)}function p7(t,e,r){GZ(t,e),e.set(t,r)}function GZ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function v7(t,e){return t.get(Dp(t,e))}function w7(t,e,r){return t.set(Dp(t,e),r),r}function Dp(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var yN=new WeakMap,SN=new WeakMap,Vy=new WeakSet;class Lbe{constructor(e){let{rowIndexMapper:r,columnIndexMapper:n}=e;Fbe(this,Vy),p7(this,yN,void 0),p7(this,SN,void 0),w7(yN,this,r),w7(SN,this,n)}toRenderable(e){const r=e.getVerticalDirection()==="N-S"?1:-1,n=e.getHorizontalDirection()==="W-E"?1:-1,i=Dp(Vy,this,y7).call(this,e.from,r,n);if(i===null)return null;const s=Dp(Vy,this,y7).call(this,e.to,-r,-n);if(s===null)return null;const a=e.clone();return a.from=i,a.to=s,a.includes(e.highlight)||(a.highlight=i),a}}function y7(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e;const n=Dp(Vy,this,S7).call(this,v7(yN,this),t.row,e);if(n===null)return null;const i=Dp(Vy,this,S7).call(this,v7(SN,this),t.col,r);return i===null?null:t.clone().assign({row:n,col:i})}function S7(t,e,r){return e<0?e:t.getNearestNotHiddenIndex(e,r)}let x2=null;const E2=new Map;function qZ(t,e){var r,n=this;let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=this;const a=new Uo(s);let o,u,c,f,g,m,v=!0;lye(i)&&oye(this),this.rootContainer=t,this.rootWrapperElement=void 0,this.rootPortalElement=void 0,this.rootElement=Y0(this)?t.ownerDocument.createElement("div"):t,this.rootDocument=t.ownerDocument,this.rootWindow=this.rootDocument.defaultView,Y0(this)&&(this.rootWrapperElement=this.rootDocument.createElement("div"),this.rootPortalElement=this.rootDocument.createElement("div"),Ve(this.rootElement,"ht-wrapper"),Ve(this.rootWrapperElement,"ht-root-wrapper"),this.rootWrapperElement.appendChild(this.rootElement),this.rootContainer.appendChild(this.rootWrapperElement),Ve(this.rootPortalElement,"ht-portal"),this.rootDocument.body.appendChild(this.rootPortalElement)),this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;const w=(r=e?.layoutDirection)!==null&&r!==void 0?r:"inherit",y=["rtl","ltr"].includes(w)?w:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",y),this.isRtl=function(){return y==="rtl"},this.isLtr=function(){return!s.isRtl()},this.getDirectionFactor=function(){return s.isLtr()?1:-1},this.stylesHandler=new Dbe(s.rootElement,s.rootDocument),e.language=l1e(e.language);const b=Object.fromEntries(Object.entries(e).filter(E=>{let[R]=E;return!(Je.getSingleton().isRegistered(R)||Je.getSingleton().isDeprecated(R))})),x=new BZ(s,b,[lSe,mSe]),_=x.getTableMeta(),T=x.getGlobalMeta(),D=qR();this.container=this.rootDocument.createElement("div"),this.rootElement.insertBefore(this.container,this.rootElement.firstChild),Y0(this)&&iQ(e.licenseKey,this.rootWrapperElement),this.guid=`ht_${gF()}`,E2.set(this.guid,this),this.columnIndexMapper=new dN,this.rowIndexMapper=new dN,this.columnIndexMapper.addLocalHook("indexesSequenceChange",E=>{s.runHooks("afterColumnSequenceChange",E)}),this.rowIndexMapper.addLocalHook("indexesSequenceChange",E=>{s.runHooks("afterRowSequenceChange",E)}),a.addEventListener(this.rootDocument.documentElement,"compositionstart",E=>{s.runHooks("beforeCompositionStart",E)}),u=new Eye(s);const P=Zo(this.guid);P.register("cellRangeMapper",new Lbe({rowIndexMapper:this.rowIndexMapper,columnIndexMapper:this.columnIndexMapper})),(!this.rootElement.id||this.rootElement.id.substring(0,3)==="ht_")&&(this.rootElement.id=this.guid);const O=E=>{const{row:R,col:M}=E;return s._createCellCoords(R>=0?s.rowIndexMapper.getRenderableFromVisualIndex(R):R,M>=0?s.columnIndexMapper.getRenderableFromVisualIndex(M):M)},A=E=>{const{row:R,col:M}=E;return s._createCellCoords(R>=0?s.rowIndexMapper.getVisualFromRenderableIndex(R):R,M>=0?s.columnIndexMapper.getVisualFromRenderableIndex(M):M)},W=(E,R)=>{const M=R>E?1:-1,F=Math.min(E,R),Z=Math.max(E,R),te=s.rowIndexMapper.getNearestNotHiddenIndex(E,M);return te===null||M===1&&te>Z||M===-1&&te<F?null:te>=0?s.rowIndexMapper.getRenderableFromVisualIndex(te):te},L=(E,R)=>{const M=R>E?1:-1,F=Math.min(E,R),Z=Math.max(E,R),te=s.columnIndexMapper.getNearestNotHiddenIndex(E,M);return te===null||M===1&&te>Z||M===-1&&te<F?null:te>=0?s.columnIndexMapper.getRenderableFromVisualIndex(te):te};let H=new HZ(_,{rowIndexMapper:s.rowIndexMapper,columnIndexMapper:s.columnIndexMapper,countCols:()=>s.countCols(),countRows:()=>s.countRows(),propToCol:E=>o.propToCol(E),isEditorOpened:()=>s.getActiveEditor()?s.getActiveEditor().isOpened():!1,countRenderableColumns:()=>this.view.countRenderableColumns(),countRenderableRows:()=>this.view.countRenderableRows(),countRowHeaders:()=>this.countRowHeaders(),countColHeaders:()=>this.countColHeaders(),countRenderableRowsInRange:function(){return n.view.countRenderableRowsInRange(...arguments)},countRenderableColumnsInRange:function(){return n.view.countRenderableColumnsInRange(...arguments)},getShortcutManager:()=>s.getShortcutManager(),createCellCoords:(E,R)=>s._createCellCoords(E,R),createCellRange:(E,R,M)=>s._createCellRange(E,R,M),visualToRenderableCoords:O,renderableToVisualCoords:A,findFirstNonHiddenRenderableRow:W,findFirstNonHiddenRenderableColumn:L,isDisabledCellSelection:(E,R)=>E<0||R<0?s.getSettings().disableVisualSelection:s.getCellMeta(E,R).disableVisualSelection});this.selection=H;const J=E=>{let{hiddenIndexesChanged:R}=E;this.forceFullRender=!0,R&&this.selection.commit()};this.columnIndexMapper.addLocalHook("cacheUpdated",J),this.rowIndexMapper.addLocalHook("cacheUpdated",J),this.selection.addLocalHook("afterSetRangeEnd",(E,R)=>{const M=wa(!1),F=this.selection.getSelectedRange(),{from:Z,to:te}=F.current(),fe=F.size()-1;this.runHooks("afterSelection",Z.row,Z.col,te.row,te.col,M,fe),this.runHooks("afterSelectionByProp",Z.row,s.colToProp(Z.col),te.row,s.colToProp(te.col),M,fe),R&&(!M.isTouched()||M.isTouched()&&!M.value)&&m.scrollTo(E);const I=H.isSelectedByRowHeader(),U=H.isSelectedByColumnHeader();I&&U?Ve(this.rootElement,["ht__selection--rows","ht__selection--columns"]):I?(wt(this.rootElement,"ht__selection--columns"),Ve(this.rootElement,"ht__selection--rows")):U?(wt(this.rootElement,"ht__selection--rows"),Ve(this.rootElement,"ht__selection--columns")):wt(this.rootElement,["ht__selection--rows","ht__selection--columns"]),["shift","refresh"].includes(H.getSelectionSource())||f.closeEditor(null),H.getSelectionSource()!=="refresh"&&(s.view.render(),f.prepareEditor())}),this.selection.addLocalHook("beforeSetFocus",E=>{this.runHooks("beforeSelectionFocusSet",E.row,E.col)}),this.selection.addLocalHook("afterSetFocus",E=>{const R=wa(!1);this.runHooks("afterSelectionFocusSet",E.row,E.col,R),(!R.isTouched()||R.isTouched()&&!R.value)&&m.scrollTo(E),f.closeEditor(),s.view.render(),f.prepareEditor()}),this.selection.addLocalHook("afterSelectionFinished",E=>{const R=E.length-1,{from:M,to:F}=E[R];this.runHooks("afterSelectionEnd",M.row,M.col,F.row,F.col,R),this.runHooks("afterSelectionEndByProp",M.row,s.colToProp(M.col),F.row,s.colToProp(F.col),R),H.getSelectionSource()==="refresh"&&(s.view.render(),f.prepareEditor())}),this.selection.addLocalHook("afterIsMultipleSelection",E=>{const R=this.runHooks("afterIsMultipleSelection",E.value);E.value&&(E.value=R)}),this.selection.addLocalHook("afterDeselect",()=>{f.closeEditor(),s.view.render(),wt(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this.runHooks("afterDeselect")}),this.selection.addLocalHook("beforeHighlightSet",()=>this.runHooks("beforeSelectionHighlightSet")).addLocalHook("beforeSetRangeStart",function(){for(var E=arguments.length,R=new Array(E),M=0;M<E;M++)R[M]=arguments[M];return n.runHooks("beforeSetRangeStart",...R)}).addLocalHook("beforeSetRangeStartOnly",function(){for(var E=arguments.length,R=new Array(E),M=0;M<E;M++)R[M]=arguments[M];return n.runHooks("beforeSetRangeStartOnly",...R)}).addLocalHook("beforeSetRangeEnd",function(){for(var E=arguments.length,R=new Array(E),M=0;M<E;M++)R[M]=arguments[M];return n.runHooks("beforeSetRangeEnd",...R)}).addLocalHook("beforeSelectColumns",function(){for(var E=arguments.length,R=new Array(E),M=0;M<E;M++)R[M]=arguments[M];return n.runHooks("beforeSelectColumns",...R)}).addLocalHook("afterSelectColumns",function(){for(var E=arguments.length,R=new Array(E),M=0;M<E;M++)R[M]=arguments[M];return n.runHooks("afterSelectColumns",...R)}).addLocalHook("beforeSelectRows",function(){for(var E=arguments.length,R=new Array(E),M=0;M<E;M++)R[M]=arguments[M];return n.runHooks("beforeSelectRows",...R)}).addLocalHook("afterSelectRows",function(){for(var E=arguments.length,R=new Array(E),M=0;M<E;M++)R[M]=arguments[M];return n.runHooks("afterSelectRows",...R)}).addLocalHook("beforeModifyTransformStart",function(){for(var E=arguments.length,R=new Array(E),M=0;M<E;M++)R[M]=arguments[M];return n.runHooks("modifyTransformStart",...R)}).addLocalHook("afterModifyTransformStart",function(){for(var E=arguments.length,R=new Array(E),M=0;M<E;M++)R[M]=arguments[M];return n.runHooks("afterModifyTransformStart",...R)}).addLocalHook("beforeModifyTransformFocus",function(){for(var E=arguments.length,R=new Array(E),M=0;M<E;M++)R[M]=arguments[M];return n.runHooks("modifyTransformFocus",...R)}).addLocalHook("afterModifyTransformFocus",function(){for(var E=arguments.length,R=new Array(E),M=0;M<E;M++)R[M]=arguments[M];return n.runHooks("afterModifyTransformFocus",...R)}).addLocalHook("beforeModifyTransformEnd",function(){for(var E=arguments.length,R=new Array(E),M=0;M<E;M++)R[M]=arguments[M];return n.runHooks("modifyTransformEnd",...R)}).addLocalHook("afterModifyTransformEnd",function(){for(var E=arguments.length,R=new Array(E),M=0;M<E;M++)R[M]=arguments[M];return n.runHooks("afterModifyTransformEnd",...R)}).addLocalHook("beforeRowWrap",function(){for(var E=arguments.length,R=new Array(E),M=0;M<E;M++)R[M]=arguments[M];return n.runHooks("beforeRowWrap",...R)}).addLocalHook("beforeColumnWrap",function(){for(var E=arguments.length,R=new Array(E),M=0;M<E;M++)R[M]=arguments[M];return n.runHooks("beforeColumnWrap",...R)}).addLocalHook("insertRowRequire",E=>this.alter("insert_row_above",E,1,"auto")).addLocalHook("insertColRequire",E=>this.alter("insert_col_start",E,1,"auto")),c={alter(E,R){let M=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,F=arguments.length>3?arguments[3]:void 0,Z=arguments.length>4?arguments[4]:void 0;const te=fe=>{if(fe.length===0)return[];const I=[...fe];return I.sort((k,ee)=>{let[oe]=k,[de]=ee;return oe===de?0:oe>de?1:-1}),Ri(I,(k,ee)=>{let[oe,de]=ee;const pe=k[k.length-1],[Q,ge]=pe,xe=Q+ge;if(oe<=xe){const _e=Math.max(de-(xe-oe),0);pe[1]+=_e}else k.push([oe,de]);return k},[I[0]])};switch(E){case"insert_row_below":case"insert_row_above":const fe=s.countSourceRows();if(_.maxRows===fe)return;const I=E==="insert_row_below"?"below":"above";R=R??(I==="below"?fe:0);const{delta:U,startPhysicalIndex:k}=o.createRow(R,M,{source:F,mode:I});H.shiftRows(s.toVisualRow(k),U);break;case"insert_col_start":case"insert_col_end":const ee=E==="insert_col_end"?"end":"start";R=R??(ee==="end"?s.countSourceCols():0);const{delta:oe,startPhysicalIndex:de}=o.createCol(R,M,{source:F,mode:ee});if(oe){if(Array.isArray(_.colHeaders)){const ge=[s.toVisualColumn(de),0];ge.length+=oe,Array.prototype.splice.apply(_.colHeaders,ge)}H.shiftColumns(s.toVisualColumn(de),oe)}break;case"remove_row":const pe=ge=>{let xe=0;he(ge,_e=>{let[Ne,Xe]=_e;const Qe=In(Ne)?s.countRows()-1:Math.max(Ne-xe,0);if(Number.isInteger(Ne)&&(Ne=Math.max(Ne-xe,0)),!o.removeRow(Ne,Xe,F))return;if(H.isSelected()){const{row:nt}=s.getSelectedRangeLast().highlight;nt>=Ne&&nt<=Ne+Xe-1&&f.closeEditor(!0)}const Mt=s.countRows(),Et=_.fixedRowsTop;Et>=Qe+1&&(_.fixedRowsTop-=Math.min(Xe,Et-Qe));const at=_.fixedRowsBottom;if(at&&Qe>=Mt-at&&(_.fixedRowsBottom-=Math.min(Xe,at)),Mt===0)H.deselect();else if(F==="ContextMenu.removeRow"){const nt=H.getSelectedRange(),pt=nt.pop();nt.clear().set(pt.from).current().setTo(pt.to),H.refresh()}else H.shiftRows(Ne,-Xe);xe+=Xe})};Array.isArray(R)?pe(te(R)):pe([[R,M]]);break;case"remove_col":const Q=ge=>{let xe=0;he(ge,_e=>{let[Ne,Xe]=_e;const Qe=In(Ne)?s.countCols()-1:Math.max(Ne-xe,0);let ht=s.toPhysicalColumn(Qe);if(Number.isInteger(Ne)&&(Ne=Math.max(Ne-xe,0)),!o.removeCol(Ne,Xe,F))return;if(H.isSelected()){const{col:nt}=s.getSelectedRangeLast().highlight;nt>=Ne&&nt<=Ne+Xe-1&&f.closeEditor(!0)}if(s.countCols()===0)H.deselect();else if(F==="ContextMenu.removeColumn"){const nt=H.getSelectedRange(),pt=nt.pop();nt.clear().set(pt.from).current().setTo(pt.to),H.refresh()}else H.shiftColumns(Ne,-Xe);const at=_.fixedColumnsStart;at>=Qe+1&&(_.fixedColumnsStart-=Math.min(Xe,at-Qe)),Array.isArray(_.colHeaders)&&(typeof ht>"u"&&(ht=-1),_.colHeaders.splice(ht,Xe)),xe+=Xe})};Array.isArray(R)?Q(te(R)):Q([[R,M]]);break;default:throw new Error(`There is no such action "${E}"`)}Z||c.adjustRowsAndCols(),s.view.render(),s.view.adjustElementsSize()},adjustRowsAndCols(){const E=_.minRows,R=_.minSpareRows,M=_.minCols,F=_.minSpareCols;if(E){const Z=s.countRows();Z<E&&o.createRow(Z,E-Z,{source:"auto"})}if(R){const Z=s.countEmptyRows(!0);if(Z<R){const te=R-Z,fe=Math.min(te,_.maxRows-s.countSourceRows());o.createRow(s.countRows(),fe,{source:"auto"})}}{let Z;(M||F)&&(Z=s.countEmptyCols(!0));let te=s.countCols();if(M&&!_.columns&&te<M){const fe=M-te;Z+=fe,o.createCol(te,fe,{source:"auto"})}if(F&&!_.columns&&s.dataType==="array"&&Z<F){te=s.countCols();const fe=F-Z,I=Math.min(fe,_.maxCols-te);o.createCol(te,I,{source:"auto"})}}},populateFromArray(E,R,M,F,Z){let te,fe,I,U;const k=[],ee={},oe=[],de=E.row,pe=E.col;if(fe=R.length,fe===0)return!1;let Q=0,ge=0;switch(Vt(M)&&(Q=M.col-pe+1,ge=M.row-de+1),Z){case"shift_down":const xe=Py(R),_e=xe.length,Ne=Math.max(_e,Q),Xe=s.getData().slice(de),Qe=Py(Xe).slice(pe,pe+Ne);for(I=0;I<Ne;I+=1)if(I<_e){for(te=0,fe=xe[I].length;te<ge-fe;te+=1)xe[I].push(xe[I][te%fe]);I<Qe.length?oe.push(xe[I].concat(Qe[I])):oe.push(xe[I].concat(new Array(Xe.length).fill(null)))}else oe.push(xe[I%_e].concat(Qe[I]));s.populateFromArray(de,pe,Py(oe));break;case"shift_right":const ht=R.length,Mt=Math.max(ht,ge),Et=s.getData().slice(de).map(Kt=>Kt.slice(pe));for(te=0;te<Mt;te+=1)if(te<ht){for(I=0,U=R[te].length;I<Q-U;I+=1)R[te].push(R[te][I%U]);if(te<Et.length)for(let Kt=0;Kt<Et[te].length;Kt+=1)R[te].push(Et[te][Kt]);else R[te].push(...new Array(Et[0].length).fill(null))}else R.push(R[te%fe].slice(0,Mt).concat(Et[te]));s.populateFromArray(de,pe,R);break;case"overwrite":default:ee.row=E.row,ee.col=E.col;let at=0,nt=0,pt=!0,yt;const pr=function(or){let vr=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const $t=R[or%R.length];return vr!==null?$t[vr%$t.length]:$t},sn=R.length,Dt=M?M.row-E.row+1:0;for(M?fe=Dt:fe=Math.max(sn,Dt),te=0;te<fe&&!(M&&ee.row>M.row&&Dt>sn||!_.allowInsertRow&&ee.row>s.countRows()-1||ee.row>=_.maxRows);te++){const Kt=te-at,or=pr(Kt).length,vr=M?M.col-E.col+1:0;if(M?U=vr:U=Math.max(or,vr),ee.col=E.col,yt=s.getCellMeta(ee.row,ee.col),(F==="CopyPaste.paste"||F==="Autofill.fill")&&yt.skipRowOnPaste){at+=1,ee.row+=1,fe+=1;continue}for(nt=0,I=0;I<U&&!(M&&ee.col>M.col&&vr>or||!_.allowInsertColumn&&ee.col>s.countCols()-1||ee.col>=_.maxCols);I++){if(yt=s.getCellMeta(ee.row,ee.col),(F==="CopyPaste.paste"||F==="Autofill.fill")&&yt.skipColumnOnPaste){nt+=1,ee.col+=1,U+=1;continue}if(yt.readOnly&&F!=="UndoRedo.undo"){ee.col+=1;continue}const $t=I-nt;let qi=pr(Kt,$t),Kn=s.getDataAtCell(ee.row,ee.col);if(qi!==null&&typeof qi=="object")if(Array.isArray(qi)&&Kn===null&&(Kn=[]),Kn===null||typeof Kn!="object")pt=!1;else{const xa=Tp(Array.isArray(Kn)?Kn:Kn[0]||Kn),Bl=Tp(Array.isArray(qi)?qi:qi[0]||qi);VR(xa,Bl)||Array.isArray(xa)&&Array.isArray(Bl)?qi=As(qi):pt=!1}else Kn!==null&&typeof Kn=="object"&&(pt=!1);pt&&k.push([ee.row,ee.col,qi]),pt=!0,ee.col+=1}ee.row+=1}s.setDataAtCell(k,null,null,F||"populateFromArray");break}}};function G(E){const R=EZ(E);P4(R)?(s.runHooks("beforeLanguageChange",R),T.language=R,s.runHooks("afterLanguageChange",R)):_Z(E)}function ve(E,R){const M=E==="className"?s.rootElement:s.table;if(v)Ve(M,R);else{let F=[],Z=[];T[E]&&(F=Array.isArray(T[E])?T[E]:JI(T[E])),R&&(Z=Array.isArray(R)?R:JI(R));const te=ZI(F,Z),fe=ZI(Z,F);te.length&&wt(M,te),fe.length&&Ve(M,fe)}T[E]=R}this.init=function(){u.setData(_.data),s.runHooks("beforeInit"),(_l()||CF())&&Ve(s.rootElement,"mobile"),this.updateSettings(e,!0),this.view=new fye(this);const E=_.themeName||g7(s.rootContainer);s.useTheme(E),f=iN.getInstance(s,_,H),m=Ebe(s),g=new B0e(s),Y0(this)&&mbe(s),s.runHooks("init"),this.render(),v&&s.rootElement.offsetParent===null&&DQ(s.rootElement,()=>{s.view._wt.wtOverlays.updateLastSpreaderSize(),s.render(),s.view.adjustElementsSize()}),typeof v=="object"&&(s.runHooks("afterChange",v[0],v[1]),v=!1),s.runHooks("afterInit")};function be(){let E=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue(){this.validatorsInQueue+=1,E=!1},removeValidatorFormQueue(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty(){},checkIfQueueIsEmpty(){this.validatorsInQueue===0&&E===!1&&(E=!0,this.onQueueEmpty(this.valid))}}}function we(E){const R=E.replace(",",".");return isNaN(parseFloat(R))===!1?parseFloat(R):E}function ae(E,R,M){if(!E.length){M();return}const F=s.getActiveEditor(),Z=new be;let te=!0;Z.onQueueEmpty=()=>{F&&te&&F.cancelChanges(),M()};for(let fe=E.length-1;fe>=0;fe--){const[I,U]=E[fe],k=o.propToCol(U);let ee;Number.isInteger(k)?ee=s.getCellMeta(I,k):ee={...Object.getPrototypeOf(_),..._},s.getCellValidator(ee)&&(Z.addValidatorToQueue(),s.validateCell(E[fe][3],ee,function(oe,de){return function(pe){if(typeof pe!="boolean")throw new Error("Validation error: result is not boolean");pe===!1&&de.allowInvalid===!1&&(te=!1,E.splice(oe,1),de.valid=!0),Z.removeValidatorFormQueue()}}(fe,ee),R))}Z.checkIfQueueIsEmpty()}function le(E,R){for(let F=E.length-1;F>=0;F--){let Z=!1;if(E[F]===null){E.splice(F,1);continue}if(!((E[F][2]===null||E[F][2]===void 0)&&(E[F][3]===null||E[F][3]===void 0))){if(_.allowInsertRow)for(;E[F][0]>s.countRows()-1;){const{delta:te}=o.createRow(void 0,void 0,{source:"auto"});if(te===0){Z=!0;break}}if(s.dataType==="array"&&(!_.columns||_.columns.length===0)&&_.allowInsertColumn)for(;o.propToCol(E[F][1])>s.countCols()-1;){const{delta:te}=o.createCol(void 0,void 0,{source:"auto"});if(te===0){Z=!0;break}}Z||o.set(E[F][0],E[F][1],E[F][3])}}if(E.length>0){c.adjustRowsAndCols(),s.runHooks("beforeChangeRender",E,R),f.closeEditor(),s.render(),f.prepareEditor(),s.view.adjustElementsSize(),s.runHooks("afterChange",E,R||"edit");const F=s.getActiveEditor();F&&it(F.refreshValue)&&F.refreshValue()}else s.render()}this._createCellCoords=function(E,R){return s.view._wt.createCellCoords(E,R)},this._createCellRange=function(E,R,M){return s.view._wt.createCellRange(E,R,M)},this.validateCell=function(E,R,M,F){let Z=s.getCellValidator(R);function te(fe){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0)||R.hidden===!0){M(fe);return}const U=R.visualCol,k=R.visualRow,ee=s.getCell(k,U,!0);if(ee&&ee.nodeName!=="TH"){const oe=s.rowIndexMapper.getRenderableFromVisualIndex(k),de=s.columnIndexMapper.getRenderableFromVisualIndex(U);s.view._wt.getSetting("cellRenderer",oe,de,ee)}M(fe)}nQ(Z)&&(Z=function(fe){return function(I,U){U(fe.test(I))}}(Z)),kr(Z)?(E=s.runHooks("beforeValidate",E,R.visualRow,R.prop,F),s._registerImmediate(()=>{Z.call(R,E,fe=>{s&&(fe=s.runHooks("afterValidate",fe,E,R.visualRow,R.prop,F),R.valid=fe,te(fe),s.runHooks("postAfterValidate",fe,E,R.visualRow,R.prop,F))})})):s._registerImmediate(()=>{R.valid=!0,te(R.valid,!1)})};function Te(E,R,M){return Array.isArray(E)?E:[[E,R,M]]}function ce(E,R){const M=s.runHooks("beforeChange",E,R||"edit"),F=E.filter(te=>te!==null);if(M===!1||F.length===0){var Z;return(Z=s.getActiveEditor())===null||Z===void 0||Z.cancelChanges(),[]}for(let te=F.length-1;te>=0;te--){const[fe,I,,U]=F[te],k=o.propToCol(I);let ee;Number.isInteger(k)?ee=s.getCellMeta(fe,k):ee={...Object.getPrototypeOf(_),..._};const{type:oe,checkedTemplate:de,uncheckedTemplate:pe}=ee;if(oe==="numeric"&&typeof U=="string"&&GQ(U)&&(F[te][3]=we(U)),oe==="checkbox"){const Q=cn(U),ge=Q===cn(de),xe=Q===cn(pe);(ge||xe)&&(F[te][3]=ge?de:pe)}}return F}this.setDataAtCell=function(E,R,M,F){const Z=Te(E,R,M),te=[];let fe=F,I,U,k;for(I=0,U=Z.length;I<U;I++){if(typeof Z[I]!="object")throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if(typeof Z[I][1]!="number")throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");Z[I][1]>=this.countCols()?k=Z[I][1]:k=o.colToProp(Z[I][1]),te.push([Z[I][0],k,u.getAtCell(this.toPhysicalRow(Z[I][0]),Z[I][1]),Z[I][2]])}!fe&&typeof E=="object"&&(fe=R);const ee=ce(te,fe);s.runHooks("afterSetDataAtCell",ee,fe),ae(ee,fe,()=>{le(ee,fe)})},this.setDataAtRowProp=function(E,R,M,F){const Z=Te(E,R,M),te=[];let fe=F,I,U;for(I=0,U=Z.length;I<U;I++)te.push([Z[I][0],Z[I][1],u.getAtCell(this.toPhysicalRow(Z[I][0]),Z[I][1]),Z[I][2]]);!fe&&typeof E=="object"&&(fe=R);const k=ce(te,F);s.runHooks("afterSetDataAtRowProp",k,fe),ae(k,fe,()=>{le(k,fe)})},this.listen=function(){s&&!s.isListening()&&(E2.forEach(E=>{s!==E&&E.unlisten()}),x2=s.guid,s.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(x2=null,s.runHooks("afterUnlisten"))},this.isListening=function(){return x2===s.guid},this.destroyEditor=function(){let E=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,R=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;f.closeEditor(E),s.view.render(),R&&H.isSelected()&&f.prepareEditor()},this.populateFromArray=function(E,R,M,F,Z,te,fe){if(!(typeof M=="object"&&typeof M[0]=="object"))throw new Error("populateFromArray parameter `input` must be an array of arrays");const I=typeof F=="number"?s._createCellCoords(F,Z):null;return c.populateFromArray(s._createCellCoords(E,R),M,I,te,fe)},this.spliceCol=function(E,R,M){for(var F=arguments.length,Z=new Array(F>3?F-3:0),te=3;te<F;te++)Z[te-3]=arguments[te];return o.spliceCol(E,R,M,...Z)},this.spliceRow=function(E,R,M){for(var F=arguments.length,Z=new Array(F>3?F-3:0),te=3;te<F;te++)Z[te-3]=arguments[te];return o.spliceRow(E,R,M,...Z)},this.getSelected=function(){if(H.isSelected())return nr(H.getSelectedRange(),E=>{let{from:R,to:M}=E;return[R.row,R.col,M.row,M.col]})},this.getSelectedLast=function(){const E=this.getSelected();let R;return E&&E.length>0&&(R=E[E.length-1]),R},this.getSelectedRange=function(){if(H.isSelected())return Array.from(H.getSelectedRange())},this.getSelectedRangeLast=function(){const E=this.getSelectedRange();let R;return E&&E.length>0&&(R=E[E.length-1]),R},this.emptySelectedCells=function(E){if(!H.isSelected()||this.countRows()===0||this.countCols()===0)return;const R=[];he(H.getSelectedRange(),M=>{if(M.isSingleHeader())return;const F=M.getTopStartCorner(),Z=M.getBottomEndCorner();ct(F.row,Z.row,te=>{ct(F.col,Z.col,fe=>{this.getCellMeta(te,fe).readOnly||R.push([te,fe,null])})})}),R.length>0&&this.setDataAtCell(R,E)},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){const E=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(E,0),!this.isRenderSuspended()&&E===this.renderSuspendedCounter&&s.view.render()},this.render=function(){this.view&&(this.forceFullRender=!0,this.isRenderSuspended()||s.view.render())},this.batchRender=function(E){this.suspendRender();const R=E();return this.resumeRender(),R},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){let E=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const R=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(R,0),(!this.isExecutionSuspended()&&R===this.executionSuspendedCounter||E)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(E){let R=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.suspendExecution();const M=E();return this.resumeExecution(R),M},this.batch=function(E){this.suspendRender(),this.suspendExecution();const R=E();return this.resumeExecution(),this.resumeRender(),R},this.refreshDimensions=function(){if(!s.view)return;const E=s.view,{width:R,height:M}=E.getLastSize(),{width:F,height:Z}=s.rootElement.getBoundingClientRect(),te=F!==R||Z!==M;s.runHooks("beforeRefreshDimensions",{width:R,height:M},{width:F,height:Z},te)!==!1&&((te||E._wt.wtOverlays.scrollableElement===s.rootWindow)&&(E.setLastSize(F,Z),s.render(),E.adjustElementsSize()),s.runHooks("afterRefreshDimensions",{width:R,height:M},{width:F,height:Z},te))},this.updateData=function(E,R){l7(E,M=>{o=M},M=>{o=M,s.columnIndexMapper.fitToLength(this.getInitialColumnCount()),s.rowIndexMapper.fitToLength(this.countSourceRows()),c.adjustRowsAndCols(),H.refresh()},{hotInstance:s,dataMap:o,dataSource:u,internalSource:"updateData",source:R,metaManager:x,firstRun:v})},this.loadData=function(E,R){l7(E,M=>{o=M},()=>{x.clearCellsCache(),s.initIndexMappers(),c.adjustRowsAndCols(),H.refresh(),v&&(v=[null,"loadData"])},{hotInstance:s,dataMap:o,dataSource:u,internalSource:"loadData",source:R,metaManager:x,firstRun:v})},this.getInitialColumnCount=function(){const E=_.columns;let R=0;if(Array.isArray(E))R=E.length;else if(kr(E))if(s.dataType==="array"){const M=this.countSourceCols();for(let F=0;F<M;F+=1)E(F)&&(R+=1)}else(s.dataType==="object"||s.dataType==="function")&&(R=o.colToPropCache.length);else if(it(_.dataSchema)){const M=o.getSchema();R=Array.isArray(M)?M.length:WR(M)}else R=this.countSourceCols();return R},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(E,R,M,F){return gn(E)?o.getAll():o.getRange(s._createCellCoords(E,R),s._createCellCoords(M,F),o.DESTINATION_RENDERER)},this.getCopyableText=function(E,R,M,F){return o.getCopyableText(s._createCellCoords(E,R),s._createCellCoords(M,F))},this.getCopyableData=function(E,R){return o.getCopyable(E,o.colToProp(R))},this.getSchema=function(){return o.getSchema()},this.updateSettings=function(E){let R=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const M=(v?s.loadData:s.updateData).bind(this);let F=!1,Z,te;if(it(E.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(it(E.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(it(E.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');E.language&&G(E.language);for(Z in E)if(!(Z==="data"||Z==="language"))if(Z==="className")ve("className",E.className);else if(Z==="tableClassName"&&s.table)ve("tableClassName",E.tableClassName),s.view._wt.wtOverlays.syncOverlayTableClassNames();else if(Je.getSingleton().isRegistered(Z)||Je.getSingleton().isDeprecated(Z)){const ee=E[Z];kr(ee)?(Je.getSingleton().addAsFixed(Z,ee,s),_[Z]=ee):Array.isArray(ee)&&(Je.getSingleton().add(Z,ee,s),_[Z]=ee)}else!R&&ni(E,Z)&&(T[Z]=E[Z]);E.data===void 0&&_.data===void 0?M(null,"updateSettings"):E.data!==void 0?M(E.data,"updateSettings"):E.columns!==void 0&&(o.createMap(),s.initIndexMappers());const fe=s.countCols(),I=_.columns;if(I&&kr(I)&&(F=!0),(E.cell!==void 0||E.cells!==void 0||E.columns!==void 0)&&x.clearCache(),fe>0)for(Z=0,te=0;Z<fe;Z++){if(I){const ee=F?I(Z):I[te];ee&&x.updateColumnMeta(te,ee)}te+=1}it(E.cell)&&Wt(E.cell,ee=>{s.setCellMetaObject(ee.row,ee.col,ee)}),s.runHooks("afterCellMetaReset");let U=s.rootElement.style.height;U!==""&&(U=parseInt(s.rootElement.style.height,10));let k=E.height;if(kr(k)&&(k=k()),R&&s.rootElement.getAttribute("style")&&s.rootElement.setAttribute("data-initialstyle",s.rootElement.getAttribute("style")),k===null){const ee=s.rootElement.getAttribute("data-initialstyle");ee&&(ee.indexOf("height")>-1||ee.indexOf("overflow")>-1)?s.rootElement.setAttribute("style",ee):(s.rootElement.style.height="",s.rootElement.style.overflow="")}else k!==void 0&&(s.rootElement.style.height=isNaN(k)?`${k}`:`${k}px`,s.rootElement.style.overflow="hidden");if(typeof E.width<"u"){let ee=E.width;kr(ee)&&(ee=ee()),s.rootElement.style.width=isNaN(ee)?`${ee}`:`${ee}px`}if(!R){if(s.view){s.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),s.view._wt.exportSettingsAsClassNames();const ee=s.getCurrentThemeName();ni(E,"themeName")&&ee!==E.themeName&&s.useTheme(E.themeName)}s.runHooks("afterUpdateSettings",E)}c.adjustRowsAndCols(),s.view&&!v&&(s.render(),s.view._wt.wtOverlays.adjustElementsSize()),!R&&s.view&&(U===""||k===""||k===void 0)&&U!==k&&s.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){const E=s.getSelectedLast();if(_.getValue){if(kr(_.getValue))return _.getValue.call(s);if(E)return s.getData()[E[0][0]][_.getValue]}else if(E)return s.getDataAtCell(E[0],E[1])},this.getSettings=function(){return _},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(E,R,M,F,Z){c.alter(E,R,M,F,Z)},this.getCell=function(E,R){let M=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,F=R,Z=E;if(R>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(R)))return null;F=this.columnIndexMapper.getRenderableFromVisualIndex(R)}if(E>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(E)))return null;Z=this.rowIndexMapper.getRenderableFromVisualIndex(E)}return Z===null||F===null||Z===void 0||F===void 0?null:s.view.getCellAtCoords(s._createCellCoords(Z,F),M)},this.getCoords=function(E){const R=this.view._wt.wtTable.getCoords(E);if(R===null)return null;const{row:M,col:F}=R;let Z=M,te=F;return M>=0&&(Z=this.rowIndexMapper.getVisualFromRenderableIndex(M)),F>=0&&(te=this.columnIndexMapper.getVisualFromRenderableIndex(F)),s._createCellCoords(Z,te)},this.colToProp=function(E){return o.colToProp(E)},this.propToCol=function(E){return o.propToCol(E)},this.toVisualRow=E=>this.rowIndexMapper.getVisualFromPhysicalIndex(E),this.toVisualColumn=E=>this.columnIndexMapper.getVisualFromPhysicalIndex(E),this.toPhysicalRow=E=>this.rowIndexMapper.getPhysicalFromVisualIndex(E),this.toPhysicalColumn=E=>this.columnIndexMapper.getPhysicalFromVisualIndex(E),this.getDataAtCell=function(E,R){return o.get(E,o.colToProp(R))},this.getDataAtRowProp=function(E,R){return o.get(E,R)},this.getDataAtCol=function(E){const R=[],M=o.getRange(s._createCellCoords(0,E),s._createCellCoords(_.data.length-1,E),o.DESTINATION_RENDERER);for(let F=0;F<M.length;F+=1)for(let Z=0;Z<M[F].length;Z+=1)R.push(M[F][Z]);return R},this.getDataAtProp=function(E){const R=[],M=o.getRange(s._createCellCoords(0,o.propToCol(E)),s._createCellCoords(_.data.length-1,o.propToCol(E)),o.DESTINATION_RENDERER);for(let F=0;F<M.length;F+=1)for(let Z=0;Z<M[F].length;Z+=1)R.push(M[F][Z]);return R},this.getSourceData=function(E,R,M,F){let Z;return E===void 0?Z=u.getData():Z=u.getByRange(s._createCellCoords(E,R),s._createCellCoords(M,F)),Z},this.getSourceDataArray=function(E,R,M,F){let Z;return E===void 0?Z=u.getData(!0):Z=u.getByRange(s._createCellCoords(E,R),s._createCellCoords(M,F),!0),Z},this.getSourceDataAtCol=function(E){return u.getAtColumn(E)},this.setSourceDataAtCell=function(E,R,M,F){const Z=Te(E,R,M),te=this.hasHook("afterSetSourceDataAtCell"),fe=[];te&&he(Z,U=>{let[k,ee,oe]=U;fe.push([k,ee,u.getAtCell(k,ee),oe])}),he(Z,U=>{let[k,ee,oe]=U;u.setAtCell(k,ee,oe)}),te&&this.runHooks("afterSetSourceDataAtCell",fe,F),this.render();const I=s.getActiveEditor();I&&it(I.refreshValue)&&I.refreshValue()},this.getSourceDataAtRow=function(E){return u.getAtRow(E)},this.getSourceDataAtCell=function(E,R){return u.getAtCell(E,R)},this.getDataAtRow=function(E){return o.getRange(s._createCellCoords(E,0),s._createCellCoords(E,this.countCols()-1),o.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(E,R,M,F){const Z=E===void 0?[0,0,this.countRows(),this.countCols()]:[E,R,M,F],[te,fe]=Z;let[,,I,U]=Z,k=null,ee=null;I===void 0&&(I=te),U===void 0&&(U=fe);let oe="mixed";return ct(Math.max(Math.min(te,I),0),Math.max(te,I),de=>{let pe=!0;return ct(Math.max(Math.min(fe,U),0),Math.max(fe,U),Q=>(ee=this.getCellMeta(de,Q).type,k?pe=k===ee:k=ee,pe)),oe=pe?ee:"mixed",pe}),oe},this.removeCellMeta=function(E,R,M){const[F,Z]=[this.toPhysicalRow(E),this.toPhysicalColumn(R)];let te=x.getCellMetaKeyValue(F,Z,M);s.runHooks("beforeRemoveCellMeta",E,R,M,te)!==!1&&(x.removeCellMeta(F,Z,M),s.runHooks("afterRemoveCellMeta",E,R,M,te)),te=null},this.spliceCellsMeta=function(E){let R=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;for(var M=arguments.length,F=new Array(M>2?M-2:0),Z=2;Z<M;Z++)F[Z-2]=arguments[Z];if(F.length>0&&!Array.isArray(F[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");R>0&&x.removeRow(this.toPhysicalRow(E),R),F.length>0&&he(F.reverse(),te=>{x.createRow(this.toPhysicalRow(E)),he(te,(fe,I)=>this.setCellMetaObject(E,I,fe))}),s.render()},this.setCellMetaObject=function(E,R,M){typeof M=="object"&&Wt(M,(F,Z)=>{this.setCellMeta(E,R,Z,F)})},this.setCellMeta=function(E,R,M,F){if(s.runHooks("beforeSetCellMeta",E,R,M,F)===!1)return;let te=E,fe=R;E<this.countRows()&&(te=this.toPhysicalRow(E)),R<this.countCols()&&(fe=this.toPhysicalColumn(R)),x.setCellMeta(te,fe,M,F),s.runHooks("afterSetCellMeta",E,R,M,F)},this.getCellsMeta=function(){return x.getCellsMeta()},this.getCellMeta=function(E,R){let M=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{skipMetaExtension:!1},F=this.toPhysicalRow(E),Z=this.toPhysicalColumn(R);return F===null&&(F=E),Z===null&&(Z=R),x.getCellMeta(F,Z,{visualRow:E,visualColumn:R,...M})},this.getColumnMeta=function(E){return x.getColumnMeta(this.toPhysicalColumn(E))},this.getCellMetaAtRow=function(E){return x.getCellsMetaAtRow(E)},this.isColumnModificationAllowed=function(){return!(s.dataType==="object"||_.columns)},this.getCellRenderer=function(E,R){const M=typeof E=="number"?s.getCellMeta(E,R).renderer:E.renderer;return typeof M=="string"?_1(M):gn(M)?_1("text"):M},this.getCellEditor=function(E,R){const M=typeof E=="number"?s.getCellMeta(E,R).editor:E.editor;return typeof M=="string"?E1(M):gn(M)?E1("text"):M},this.getCellValidator=function(E,R){const M=typeof E=="number"?s.getCellMeta(E,R).validator:E.validator;return typeof M=="string"?WF(M):M},this.validateCells=function(E){this._validateCells(E)},this.validateRows=function(E,R){if(!Array.isArray(E))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(R,E)},this.validateColumns=function(E,R){if(!Array.isArray(E))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(R,void 0,E)},this._validateCells=function(E,R,M){const F=new be;E&&(F.onQueueEmpty=E);let Z=s.countRows()-1;for(;Z>=0;){if(R!==void 0&&R.indexOf(Z)===-1){Z-=1;continue}let te=s.countCols()-1;for(;te>=0;){if(M!==void 0&&M.indexOf(te)===-1){te-=1;continue}F.addValidatorToQueue(),s.validateCell(s.getDataAtCell(Z,te),s.getCellMeta(Z,te),fe=>{if(typeof fe!="boolean")throw new Error("Validation error: result is not boolean");fe===!1&&(F.valid=!1),F.removeValidatorFormQueue()},"validateCells"),te-=1}Z-=1}F.checkIfQueueIsEmpty()},this.getRowHeader=function(E){let R=_.rowHeaders,M=E;return M!==void 0&&(M=s.runHooks("modifyRowHeader",M)),M===void 0?(R=[],ct(s.countRows()-1,F=>{R.push(s.getRowHeader(F))})):Array.isArray(R)&&R[M]!==void 0?R=R[M]:kr(R)?R=R(M):R&&typeof R!="string"&&typeof R!="number"&&(R=M+1),R},this.hasRowHeaders=function(){return!!_.rowHeaders},this.hasColHeaders=function(){if(_.colHeaders!==void 0&&_.colHeaders!==null)return!!_.colHeaders;for(let E=0,R=s.countCols();E<R;E++)if(s.getColHeader(E))return!0;return!1},this.getColHeader=function(E){let R=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;const M=s.runHooks("modifyColHeader",E);if(M===void 0){const I=[],U=s.countCols();for(let k=0;k<U;k++)I.push(s.getColHeader(k));return I}let F=_.colHeaders;const Z=function(I){const U=[],k=s.countCols();let ee=0;for(;ee<k;ee++)kr(_.columns)&&_.columns(ee)&&U.push(ee);return U[I]},te=s.toPhysicalColumn(M),fe=Z(te);return _.colHeaders===!1?F=null:_.columns&&kr(_.columns)&&_.columns(fe)&&_.columns(fe).title?F=_.columns(fe).title:_.columns&&_.columns[te]&&_.columns[te].title?F=_.columns[te].title:Array.isArray(_.colHeaders)&&_.colHeaders[te]!==void 0?F=_.colHeaders[te]:kr(_.colHeaders)?F=_.colHeaders(te):_.colHeaders&&typeof _.colHeaders!="string"&&typeof _.colHeaders!="number"&&(F=QR(M)),F=s.runHooks("modifyColumnHeaderValue",F,E,R),F},this._getColWidthFromSettings=function(E){let R;if(E>=0&&(R=s.getCellMeta(0,E).width),(R===void 0||R===_.width)&&(R=_.colWidths),R!=null){switch(typeof R){case"object":R=R[E];break;case"function":R=R(E);break}typeof R=="string"&&(R=parseInt(R,10))}return R},this.getColWidth=function(E,R){let M=s._getColWidthFromSettings(E);return M=s.runHooks("modifyColWidth",M,E,R),M===void 0&&(M=Op),M},this._getRowHeightFromSettings=function(E){const R=s.stylesHandler.getDefaultRowHeight();let M=_.rowHeights;if(M!=null){switch(typeof M){case"object":M=M[E];break;case"function":M=M(E);break}typeof M=="string"&&(M=parseInt(M,10))}return M!=null&&M<R?R:M},this.getRowHeight=function(E,R){let M=s._getRowHeightFromSettings(E);return M=s.runHooks("modifyRowHeight",M,E,R),M},this.countSourceRows=function(){return u.countRows()},this.countSourceCols=function(){return u.countFirstRowKeys()},this.countRows=function(){return o.getLength()},this.countCols=function(){const E=_.maxCols,R=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(E,R)},this.countRenderedRows=function(){return s.view._wt.drawn?s.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return s.view._wt.drawn?s.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return s.view._wt.drawn?s.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return s.view._wt.drawn?s.view._wt.wtTable.getVisibleColumnsCount():-1},this.countRowHeaders=function(){return this.view.getRowHeadersCount()},this.countColHeaders=function(){return this.view.getColumnHeadersCount()},this.countEmptyRows=function(){let E=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,R=0;return oN(s.countRows()-1,M=>{if(s.isEmptyRow(M))R+=1;else if(E===!0)return!1}),R},this.countEmptyCols=function(){let E=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,R=0;return oN(s.countCols()-1,M=>{if(s.isEmptyCol(M))R+=1;else if(E===!0)return!1}),R},this.isEmptyRow=function(E){return _.isEmptyRow.call(s,E)},this.isEmptyCol=function(E){return _.isEmptyCol.call(s,E)},this.selectCell=function(E,R,M,F){let Z=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,te=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;return gn(E)||gn(R)?!1:this.selectCells([[E,R,M,F]],Z,te)},this.selectCells=function(){let E=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[[]],R=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,M=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;R===!1&&m.suspend();const F=H.selectCells(E);return F&&M&&s.listen(),m.resume(),F},this.selectColumns=function(E){let R=arguments.length>1&&arguments[1]!==void 0?arguments[1]:E,M=arguments.length>2?arguments[2]:void 0;return H.selectColumns(E,R,M)},this.selectRows=function(E){let R=arguments.length>1&&arguments[1]!==void 0?arguments[1]:E,M=arguments.length>2?arguments[2]:void 0;return H.selectRows(E,R,M)},this.deselectCell=function(){H.deselect()},this.selectAll=function(){let E=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,R=arguments.length>1&&arguments[1]!==void 0?arguments[1]:E,M=arguments.length>2?arguments[2]:void 0;m.skipNextScrollCycle(),H.selectAll(E,R,M)};const K=(E,R)=>E.getNearestNotHiddenIndex(R,1,!0);this.scrollViewportTo=function(E,R){if(typeof E=="number"){var M;E={row:arguments[0],col:arguments[1],verticalSnap:arguments[2]?"bottom":"top",horizontalSnap:arguments[3]?"end":"start",considerHiddenIndexes:(M=arguments[4])!==null&&M!==void 0?M:!0}}const{row:F,col:Z,considerHiddenIndexes:te}=E??{};let fe=F,I=Z;if(kr(R)&&this.addHookOnce("afterScroll",R),te===void 0||te){const oe=Number.isInteger(F)&&F>=0,de=Number.isInteger(Z)&&Z>=0,pe=oe?K(this.rowIndexMapper,F):void 0,Q=de?K(this.columnIndexMapper,Z):void 0;if(pe===null||Q===null)return!1;fe=oe?s.rowIndexMapper.getRenderableFromVisualIndex(pe):F,I=de?s.columnIndexMapper.getRenderableFromVisualIndex(Q):Z}const U=Number.isInteger(fe),k=Number.isInteger(I);let ee=!1;return U&&fe>=0&&k&&I>=0?ee=s.view.scrollViewport(s._createCellCoords(fe,I),E.horizontalSnap,E.verticalSnap):U&&fe>=0&&(k&&I<0||!k)?ee=s.view.scrollViewportVertically(fe,E.verticalSnap):k&&I>=0&&(U&&fe<0||!U)&&(ee=s.view.scrollViewportHorizontally(I,E.horizontalSnap)),kr(R)&&(ee?this.view.render():(this.removeHook("afterScroll",R),this._registerMicrotask(()=>R()))),ee},this.scrollToFocusedCell=function(E){if(!this.selection.isSelected())return!1;kr(E)&&this.addHookOnce("afterScroll",E);const{highlight:R}=this.getSelectedRangeLast(),M=this.scrollViewportTo(R.toObject());return M?this.view.render():kr(E)&&(this.removeHook("afterScroll",E),this._registerMicrotask(()=>E())),M},this.destroy=function(){s._clearTimeouts(),s._clearImmediates(),s.view&&s.view.destroy(),u&&u.destroy(),u=null,this.getShortcutManager().destroy(),P.clear(),x.clearCache(),E2.delete(this.guid),a.destroy(),f&&f.destroy(),s.rootContainer&&Bu(s.rootContainer),s.rootPortalElement&&s.rootPortalElement.remove(),s.batchExecution(()=>{s.rowIndexMapper.unregisterAll(),s.columnIndexMapper.unregisterAll(),D.getItems().forEach(E=>{let[,R]=E;R.destroy()}),D.clear(),s.runHooks("afterDestroy")},!0),Je.getSingleton().destroy(s),Wt(s,(E,R,M)=>{kr(E)?M[R]=Se(R):R!=="guid"&&(M[R]=null)}),s.isDestroyed=!0,o&&o.destroy(),o=null,c=null,H=null,f=null,s=null};function Se(E){return()=>{throw new Error(`The "${E}" method cannot be called because this Handsontable instance has been destroyed`)}}this.getActiveEditor=function(){return f.getActiveEditor()},this.getFirstRenderedVisibleRow=function(){return s.view.getFirstRenderedVisibleRow()},this.getLastRenderedVisibleRow=function(){return s.view.getLastRenderedVisibleRow()},this.getFirstRenderedVisibleColumn=function(){return s.view.getFirstRenderedVisibleColumn()},this.getLastRenderedVisibleColumn=function(){return s.view.getLastRenderedVisibleColumn()},this.getFirstFullyVisibleRow=function(){return s.view.getFirstFullyVisibleRow()},this.getLastFullyVisibleRow=function(){return s.view.getLastFullyVisibleRow()},this.getFirstFullyVisibleColumn=function(){return s.view.getFirstFullyVisibleColumn()},this.getLastFullyVisibleColumn=function(){return s.view.getLastFullyVisibleColumn()},this.getFirstPartiallyVisibleRow=function(){return s.view.getFirstPartiallyVisibleRow()},this.getLastPartiallyVisibleRow=function(){return s.view.getLastPartiallyVisibleRow()},this.getFirstPartiallyVisibleColumn=function(){return s.view.getFirstPartiallyVisibleColumn()},this.getLastPartiallyVisibleColumn=function(){return s.view.getLastPartiallyVisibleColumn()},this.getPlugin=function(E){return D.getItem(Ms(E))},this.getPluginName=function(E){return E===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:D.getId(E)},this.getInstance=function(){return s},this.addHook=function(E,R,M){Je.getSingleton().add(E,R,s,M)},this.hasHook=function(E){return Je.getSingleton().has(E,s)||Je.getSingleton().has(E)},this.addHookOnce=function(E,R,M){Je.getSingleton().once(E,R,s,M)},this.removeHook=function(E,R){Je.getSingleton().remove(E,R,s)},this.runHooks=function(E,R,M,F,Z,te,fe){return Je.getSingleton().run(s,E,R,M,F,Z,te,fe)},this.getTranslatedPhrase=function(E,R){return kZ(_.language,E,R)},this.toHTML=()=>sN(this),this.toTableElement=()=>{const E=this.rootDocument.createElement("div");return E.insertAdjacentHTML("afterbegin",sN(this)),E.firstElementChild},this.timeouts=[],this.useTheme=E=>{const R=!!v;this.stylesHandler.useTheme(E);const M=this.stylesHandler.getThemeName();Y0(this)&&(wt(this.rootWrapperElement,/ht-theme-.*/g),wt(this.rootPortalElement,/ht-theme-.*/g),M&&(Ve(this.rootWrapperElement,M),Ve(this.rootPortalElement,M),getComputedStyle(this.rootWrapperElement).getPropertyValue("--ht-line-height")||br(`The "${M}" theme is enabled, but its stylesheets are missing or not imported correctly.             Import the correct CSS files in order to use that theme.`))),R||(s.render(),s.scrollViewportTo(0,0),g7(this.rootContainer)&&(wt(this.rootContainer,/ht-theme-.*/g),M&&Ve(this.rootContainer,M))),this.runHooks("afterSetTheme",M,R)},this.getCurrentThemeName=()=>this.stylesHandler.getThemeName(),this.getTableHeight=()=>this.rootElement.offsetHeight,this.getTableWidth=()=>this.rootElement.offsetWidth,this._registerTimeout=function(E){let R=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,M=E;typeof M=="function"&&(M=setTimeout(M,R)),this.timeouts.push(M)},this._clearTimeouts=function(){he(this.timeouts,E=>{clearTimeout(E)})},this.immediates=[],this._registerImmediate=function(E){this.immediates.push(setImmediate(E))},this._clearImmediates=function(){he(this.immediates,E=>{clearImmediate(E)})},this._registerMicrotask=function(E){this.rootWindow.queueMicrotask(()=>{this.isDestroyed||E()})},this._getEditorManager=function(){return f};const B=Obe({handleEvent(){return s.isListening()},beforeKeyDown:E=>this.runHooks("beforeKeyDown",E),afterKeyDown:E=>{this.isDestroyed||s.runHooks("afterDocumentKeyDown",E)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",E=>{E.ctrlKey===!1&&E.metaKey===!1&&B.releasePressedKeys()}),this.getShortcutManager=function(){return B},this.getFocusManager=function(){return g},VF().forEach(E=>{const R=xS(E);D.addItem(E,new R(this))}),dbe(s),B.setActiveContextName("grid"),Je.getSingleton().run(s,"construct")}function b7(t,e,r){t.addEventListener(e,r,!1)}function C7(t,e,r){t.removeEventListener(e,r,!1)}function LC(t){return t.ownerDocument.defaultView.getComputedStyle(t)}function KZ(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300,textContent:g=>g.value,...e},n=t.body,i=t.createTextNode(""),s=t.createElement("span");let a;function o(){var g,m;i.textContent=r.textContent(a),s.style.position="absolute",s.style.fontSize=LC(a).fontSize,s.style.fontFamily=LC(a).fontFamily,s.style.whiteSpace="pre",n.appendChild(s);const v=parseInt(((g=LC(a))===null||g===void 0?void 0:g.paddingInlineStart)||0,10),w=parseInt(((m=LC(a))===null||m===void 0?void 0:m.paddingInlineEnd)||0,10),y=s.clientWidth+v+w+1;n.removeChild(s);const b=a.style;b.height=`${r.minHeight}px`,r.minWidth>y?b.width=`${r.minWidth}px`:y>r.maxWidth?b.width=`${r.maxWidth}px`:b.width=`${y}px`;const x=a.scrollHeight?a.scrollHeight-1:0;r.minHeight>x?b.height=`${r.minHeight}px`:r.maxHeight<x?(b.height=`${r.maxHeight}px`,b.overflowY="visible"):b.height=`${x}px`}function u(){t.defaultView.setTimeout(o,0)}function c(g){if(g&&g.minHeight)if(g.minHeight==="inherit")r.minHeight=a.clientHeight;else{const m=parseInt(g.minHeight,10);isNaN(m)||(r.minHeight=m)}if(g&&g.maxHeight)if(g.maxHeight==="inherit")r.maxHeight=a.clientHeight;else{const m=parseInt(g.maxHeight,10);isNaN(m)||(r.maxHeight=m)}if(g&&g.minWidth)if(g.minWidth==="inherit")r.minWidth=a.clientWidth;else{const m=parseInt(g.minWidth,10);isNaN(m)||(r.minWidth=m)}if(g&&g.maxWidth)if(g.maxWidth==="inherit")r.maxWidth=a.clientWidth;else{const m=parseInt(g.maxWidth,10);isNaN(m)||(r.maxWidth=m)}s.firstChild||(s.className="autoResize",s.style.display="inline-block",s.appendChild(i))}function f(g,m){let v=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;a=g,c(m),a.nodeName==="TEXTAREA"&&(a.style.resize="none",a.style.height=`${r.minHeight}px`,a.style.minWidth=`${r.minWidth}px`,a.style.maxWidth=`${r.maxWidth}px`,a.style.overflowY="hidden"),v&&(b7(a,"input",o),b7(a,"keydown",u)),o()}return{init:f,resize:o,unObserve(){C7(a,"input",o),C7(a,"keydown",u)}}}function x7(t,e){const r=TF(e),n=e.value.split(`
`);let i=r,s=0;for(let a=0;a<n.length;a++){const o=n[a];a!==0&&(s+=n[a-1].length+1);const u=s+o.length;if(t==="home"?i=s:t==="end"&&(i=u),r<=u)break}SS(e,i)}function Id(t,e,r){return(e=Bbe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Bbe(t){var e=Vbe(t,"string");return typeof e=="symbol"?e:e+""}function Vbe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Wbe="ht_editor_visible",BC="ht_editor_hidden",E7="textEditor",$be="text";class um extends ov{static get EDITOR_TYPE(){return $be}constructor(e){super(e),Id(this,"eventManager",new Uo(this)),Id(this,"autoResize",KZ(this.hot.rootDocument)),Id(this,"TEXTAREA",void 0),Id(this,"textareaStyle",void 0),Id(this,"TEXTAREA_PARENT",void 0),Id(this,"textareaParentStyle",void 0),Id(this,"layerClass",void 0),this.eventManager=new Uo(this),this.createElements(),this.bindEvents(),this.hot.addHookOnce("afterDestroy",()=>this.destroy())}getValue(){return this.TEXTAREA.value}setValue(e){this.TEXTAREA.value=e}open(){this._opened=!0,this.refreshDimensions(),this.showEditableElement(),this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.autoResize.unObserve(),Hy(this.hot.rootDocument.activeElement,this.hot.rootElement)&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts()}prepare(e,r,n,i,s,a){const o=this.state;if(super.prepare(e,r,n,i,s,a),!a.readOnly){this.refreshDimensions(!0);const{allowInvalid:u}=a;u&&!this.isOpened()&&(this.TEXTAREA.value=""),o!==Vn.FINISHED&&!this.isOpened()&&this.hideEditableElement()}}beginEditing(e,r){this.state===Vn.VIRGIN&&(this.TEXTAREA.value="",super.beginEditing(e,r))}focus(){this.TEXTAREA.select(),SS(this.TEXTAREA,this.TEXTAREA.value.length)}createElements(){const{rootDocument:e}=this.hot;this.TEXTAREA=e.createElement("TEXTAREA"),bt(this.TEXTAREA,[["data-hot-input",""],Zf(-1)]),Ve(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=e.createElement("DIV"),Ve(this.TEXTAREA_PARENT,"handsontableInputHolder"),Ct(this.TEXTAREA_PARENT,this.layerClass)&&wt(this.TEXTAREA_PARENT,this.layerClass),Ve(this.TEXTAREA_PARENT,BC),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}hideEditableElement(){SQ()&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",wt(this.TEXTAREA_PARENT,this.layerClass),Ve(this.TEXTAREA_PARENT,BC)}showEditableElement(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="";const e=this.TEXTAREA_PARENT.childNodes;let r=!1;ct(e.length-1,n=>{const i=e[n];if(Ct(i,"handsontableEditor"))return r=!0,!1}),Ct(this.TEXTAREA_PARENT,BC)&&wt(this.TEXTAREA_PARENT,BC),r?(this.layerClass=Wbe,Ve(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),Ve(this.TEXTAREA_PARENT,this.layerClass))}refreshValue(){const e=this.hot.toPhysicalRow(this.row),r=this.hot.getSourceDataAtCell(e,this.col);this.originalValue=r,this.setValue(r),this.refreshDimensions()}refreshDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.state!==Vn.EDITING&&!e)return;if(this.TD=this.getEditedCell(),!this.TD){e||this.close();return}const{top:r,start:n,width:i,maxWidth:s,height:a,maxHeight:o}=this.getEditedCellRect();this.textareaParentStyle.top=`${r}px`,this.textareaParentStyle[this.hot.isRtl()?"right":"left"]=`${n}px`,this.showEditableElement();const u=this.hot.rootWindow.getComputedStyle(this.TD);this.TEXTAREA.style.fontSize=u.fontSize,this.TEXTAREA.style.fontFamily=u.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor,this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(i,s),minHeight:Math.min(a,o),maxWidth:s,maxHeight:o},!0)}bindEvents(){bF()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",()=>this.finishEditing(!1)),this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>{this.refreshDimensions(),this.state===Vn.EDITING&&this.focus()}),this.addHook("afterRowResize",()=>{this.refreshDimensions(),this.state===Vn.EDITING&&this.focus()})}allowKeyEventPropagation(){}destroy(){this.eventManager.destroy(),this.clearHooks()}registerShortcuts(){const r=this.hot.getShortcutManager().getContext("editor"),n={runOnlyIf:()=>it(this.hot.getSelected()),group:E7},i=()=>{this.hot.rootDocument.execCommand("insertText",!1,`
`)};r.addShortcuts([{keys:[["Control","Enter"]],callback:()=>(i(),!1),runOnlyIf:s=>!this.hot.selection.isMultiple()&&!s.altKey},{keys:[["Meta","Enter"]],callback:()=>(i(),!1),runOnlyIf:()=>!this.hot.selection.isMultiple()},{keys:[["Alt","Enter"]],callback:()=>(i(),!1)},{keys:[["Home"]],callback:(s,a)=>{let[o]=a;x7(o,this.TEXTAREA)}},{keys:[["End"]],callback:(s,a)=>{let[o]=a;x7(o,this.TEXTAREA)}}],n)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(E7)}}const Ube="base",jbe="htTextEllipsis";function MS(t,e,r,n,i,s,a){const o=a.ariaTags,u=[],c=[],f=[],g=[];a.className&&Ve(e,a.className),a.readOnly?(u.push(a.readOnlyCellClassName),o&&g.push(Rj())):o&&f.push(Rj()[0]),a.valid===!1&&a.invalidCellClassName?(u.push(a.invalidCellClassName),o&&g.push(Tj())):(c.push(a.invalidCellClassName),o&&f.push(Tj()[0])),a.wordWrap===!1&&a.noWordWrapClassName&&u.push(a.noWordWrapClassName),!s&&a.placeholder&&u.push(a.placeholderCellClassName),a.textEllipsis&&u.push(jbe),wt(e,c),Ve(e,u),am(e,f),bt(e,g)}MS.RENDERER_TYPE=Ube;const Ybe="text";function fh(t,e,r,n,i,s,a){MS.apply(this,[t,e,r,n,i,s,a]);let o=s;!o&&a.placeholder&&(o=a.placeholder),o=cn(o),a.trimWhitespace&&(o=o.trim()),Bf(e,o)}fh.RENDERER_TYPE=Ybe;const zbe="text",XZ={CELL_TYPE:zbe,editor:um,renderer:fh};xo(XZ);tt.editors={BaseEditor:ov};function tt(t,e){const r=new qZ(t,e||{},nL);return r.init(),r}tt.Core=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new qZ(t,e,nL)};tt.DefaultSettings=LZ();tt.hooks=Je.getSingleton();tt.CellCoords=Ng;tt.CellRange=ES;tt.packageName="handsontable";tt.buildDate="10/07/2025 10:59:01";tt.version="16.0.1";tt.languages={dictionaryKeys:t1e,getLanguageDictionary:OZ,getLanguagesDictionaries:a1e,registerLanguageDictionary:AZ,getTranslatedPhrase:kZ};function _7(t,e,r){return(e=Gbe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Gbe(t){var e=qbe(t,"string");return typeof e=="symbol"?e:e+""}function qbe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const R7="handsontableEditor",Kbe="handsontable";class L4 extends um{constructor(){super(...arguments),_7(this,"isFlippedVertically",!1),_7(this,"isFlippedHorizontally",!1)}static get EDITOR_TYPE(){return Kbe}open(){super.open();const e=this.htContainer.style;this.htEditor&&(this.htEditor.destroy(),e.width="",e.height="",e.overflow=""),e.display==="none"&&(e.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),SS(this.TEXTAREA,0,this.TEXTAREA.value.length),this.htEditor.updateSettings({width:this.getTargetDropdownWidth(),height:this.getTargetDropdownHeight()}),this.refreshDimensions(),this.flipDropdownVerticallyIfNeeded(),this.flipDropdownHorizontallyIfNeeded()}close(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),super.close()}prepare(e,r,n,i,s,a){super.prepare(e,r,n,i,s,a);const o=this,u={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,ariaTags:!1,themeName:this.hot.getCurrentThemeName(),afterOnCellMouseDown(c,f){const g=this.getSourceData(f.row,f.col);g!==void 0&&o.setValue(g),o.hot.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&oi(u,a.handsontable),this.htOptions=u}beginEditing(e,r){const n=this.hot.getSettings().onBeginEditing;n&&n()===!1||super.beginEditing(e,r)}createElements(){super.createElements();const e=this.hot.rootDocument.createElement("DIV");e.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(e),this.htContainer=e,this.assignHooks()}finishEditing(e,r,n){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()){const i=this.htEditor.getValue();i!==void 0&&this.setValue(i)}super.finishEditing(e,r,n)}flipDropdownVerticallyIfNeeded(){const{view:e}=this.hot,r=this.getEditedCellRect();let n=r.top;if(e.isVerticallyScrollableByWindow()){const o=e.getTableOffset().top-this.hot.rootWindow.scrollY;n=Math.max(n+o,0)}const i=this.getDropdownHeight(),s=e.getWorkspaceHeight()-n-r.height,a=i>s&&n>s+r.height;return a?this.flipDropdownVertically():this.unflipDropdownVertically(),{isFlipped:a,spaceAbove:n,spaceBelow:s}}flipDropdownVertically(){const e=this.htEditor.rootElement.style;e.position="absolute",e.top=`${-this.getDropdownHeight()}px`,this.isFlippedVertically=!0}unflipDropdownVertically(){const e=this.htEditor.rootElement.style;e.position="absolute",e.top="",this.isFlippedVertically=!1}flipDropdownHorizontallyIfNeeded(){const{view:e}=this.hot,r=this.getEditedCellRect();let n=r.start+r.width;if(e.isHorizontallyScrollableByWindow()){const o=e.getTableOffset().left-this.hot.rootWindow.scrollX;n=Math.max(n+o,0)}const i=this.getDropdownWidth(),s=e.getWorkspaceWidth()-n+r.width,a=i>s&&n>s;return a?this.flipDropdownHorizontally():this.unflipDropdownHorizontally(),{isFlipped:a,spaceInlineStart:n,spaceInlineEnd:s}}flipDropdownHorizontally(){const e=this.htEditor.rootElement.style,{width:r}=this.getEditedCellRect();e.position="absolute",e[this.hot.isRtl()?"right":"left"]=`${-(this.getDropdownWidth()-r)}px`,this.isFlippedHorizontally=!0}unflipDropdownHorizontally(){const e=this.htEditor.rootElement.style;e.position="absolute",e[this.hot.isRtl()?"right":"left"]="",this.isFlippedHorizontally=!1}getDropdownHeight(){return this.htEditor.getTableHeight()}getDropdownWidth(){return this.htEditor.getTableWidth()}getTargetDropdownWidth(){return this.htEditor.view.getTableWidth()}getTargetDropdownHeight(){return this.htEditor.view.getTableHeight()+1}assignHooks(){this.hot.addHook("afterDestroy",()=>{var e;(e=this.htEditor)===null||e===void 0||e.destroy()}),this.hot.addHook("afterSetTheme",(e,r)=>{r||this.close()})}registerShortcuts(){const r=this.hot.getShortcutManager().getContext("editor");super.registerShortcuts();const n={group:R7,relativeToGroup:ed,position:"before"},i=(s,a)=>{const o=this.htEditor;if(s!==void 0&&(s<0||this.isFlippedVertically&&s>o.countRows()-1?o.deselectCell():o.selectCell(s,0),o.getData().length))return a.preventDefault(),Qo(a),this.hot.listen(),this.TEXTAREA.focus(),!1};r.addShortcuts([{keys:[["ArrowUp"]],callback:s=>{const a=this.htEditor;let o,u;return!a.getSelectedLast()&&this.isFlippedVertically?o=a.countRows()-1:a.getSelectedLast()&&(this.isFlippedVertically?(u=a.getSelectedLast()[0],o=Math.max(0,u-1)):(u=a.getSelectedLast()[0],o=u-1)),i(o,s)},preventDefault:!1},{keys:[["ArrowDown"]],callback:s=>{const a=this.htEditor;let o,u;if(!a.getSelectedLast()&&!this.isFlippedVertically)o=0;else if(a.getSelectedLast()){if(this.isFlippedVertically)o=a.getSelectedLast()[0]+1;else if(!this.isFlippedVertically){const c=a.countRows()-1;u=a.getSelectedLast()[0],o=Math.min(c,u+1)}}return i(o,s)},preventDefault:!1}],n)}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(R7)}}function Xbe(t,e){QZ(t,e),e.add(t)}function T7(t,e,r){QZ(t,e),e.set(t,r)}function QZ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function VC(t,e,r){return(e=Qbe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Qbe(t){var e=Zbe(t,"string");return typeof e=="symbol"?e:e+""}function Zbe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function _2(t,e){return t.get(bN(t,e))}function bN(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const Jbe="autocomplete";var R2=new WeakMap,M7=new WeakMap,T2=new WeakSet;class B4 extends L4{constructor(){super(...arguments),Xbe(this,T2),VC(this,"query",null),VC(this,"strippedChoices",[]),VC(this,"rawChoices",[]),T7(this,R2,this.hot.guid.slice(0,9)),T7(this,M7,CS(()=>{this.focus()},100)),VC(this,"sortByRelevance",function(e,r,n){const i=[],s=[],a=e.length;let o=r.length,u,c,f,g;if(a===0){for(f=0;f<o;f++)s.push(f);return s}for(f=0;f<o;f++){if(c=tN(cn(r[f])),n)g=c.indexOf(e);else{const m=this.cellProperties.locale;g=c.toLocaleLowerCase(m).indexOf(e.toLocaleLowerCase(m))}g!==-1&&(u=c.length-g-a,i.push({baseIndex:f,index:g,charsLeft:u,value:c}))}for(i.sort((m,v)=>{if(v.index===-1)return-1;if(m.index===-1)return 1;if(m.index<v.index)return-1;if(v.index<m.index)return 1;if(m.index===v.index){if(m.charsLeft<v.charsLeft)return-1;if(m.charsLeft>v.charsLeft)return 1}return 0}),f=0,o=i.length;f<o;f++)s.push(i[f].baseIndex);return s})}static get EDITOR_TYPE(){return Jbe}getValue(){const e=this.rawChoices.find(r=>this.stripValueIfNeeded(r)===this.TEXTAREA.value);return it(e)?e:this.TEXTAREA.value}createElements(){super.createElements(),Ve(this.htContainer,"autocompleteEditor"),Ve(this.htContainer,this.hot.rootWindow.navigator.platform.indexOf("Mac")===-1?"":"htMacScroll"),this.hot.getSettings().ariaTags&&bt(this.TEXTAREA,[Ome(),_me(),lQ("listbox"),Ime()])}prepare(e,r,n,i,s,a){super.prepare(e,r,n,i,s,a),this.hot.getSettings().ariaTags&&bt(this.TEXTAREA,[Vo("false"),Nme(`${_2(R2,this)}-listbox-${e}-${r}`)])}open(){super.open();const e=this.cellProperties.trimDropdown===void 0?!0:this.cellProperties.trimDropdown,r=this.hot.getSettings().ariaTags,n=Array.isArray(this.cellProperties.source)?this.cellProperties.source:null,i=n?.length,{row:s,col:a}=this;this.showEditableElement(),this.focus(),this.addHook("beforeKeyDown",o=>this.onBeforeKeyDown(o)),this.htEditor.addHook("afterScroll",_2(M7,this)),this.htEditor.updateSettings({colWidths:e?[Un(this.TEXTAREA)-2]:void 0,autoColumnSize:!0,renderer:(o,u,c,f,g,m,v)=>{fh(o,u,c,f,g,m,v);const{filteringCaseSensitive:w,allowHtml:y,locale:b}=this.cellProperties,x=this.query;let _=cn(m),T,D;_&&!y&&(T=w===!0?_.indexOf(x):_.toLocaleLowerCase(b).indexOf(x.toLocaleLowerCase(b)),T!==-1&&(D=_.substr(T,x.length),_=_.replace(D,`<strong>${D}</strong>`))),r&&bt(u,[Rme(),...n?[Bme(i)]:[],...n?[Vme(n.indexOf(m)+1)]:[],["id",`${this.htEditor.rootElement.id}_${c}-${f}`]]),u.innerHTML=_},afterSelectionEnd:(o,u)=>{if(r){const c=g=>{bt(g,[wF()]),bt(this.TEXTAREA,...Hme(g.id))},f=this.htEditor.getCell(o,u,!0);f!==null?c(f):this.htEditor.addHookOnce("afterScrollVertically",()=>{const g=this.htEditor.getCell(o,u,!0);c(g)})}}}),r&&(bt(this.htEditor.view._wt.wtOverlays.wtTable.TABLE,...Lc()),bt(this.htEditor.rootElement,[oQ(),Fme("polite"),Lme("text"),["id",`${_2(R2,this)}-listbox-${s}-${a}`]]),bt(this.TEXTAREA,...Vo("true"))),this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)})}close(){this.removeHooksByKey("beforeKeyDown"),super.close(),this.hot.getSettings().ariaTags&&bt(this.TEXTAREA,[Vo("false")])}discardEditor(e){super.discardEditor(e),this.hot.view.render()}queryChoices(e){const r=this.cellProperties.source;this.query=e,typeof r=="function"?r.call(this.cellProperties,e,n=>{this.rawChoices=n,this.updateChoicesList(this.stripValuesIfNeeded(n))}):Array.isArray(r)?(this.rawChoices=r,this.updateChoicesList(this.stripValuesIfNeeded(r))):this.updateChoicesList([])}updateChoicesList(e){const r=TF(this.TEXTAREA),n=kQ(this.TEXTAREA),i=this.cellProperties.sortByRelevance,s=this.cellProperties.filter;let a=null,o=null,u=e;i&&(a=this.sortByRelevance(this.stripValueIfNeeded(this.getValue()),u,this.cellProperties.filteringCaseSensitive));const c=Array.isArray(a)?a.length:0;if(s===!1)c&&(o=a[0]);else{const f=[];for(let g=0,m=u.length;g<m&&!(i&&c<=g);g++)c?f.push(u[a[g]]):f.push(u[g]);o=0,u=f}this.strippedChoices=u,u.length===0?this.htEditor.rootElement.style.display="none":this.htEditor.rootElement.style.display="",this.htEditor.loadData(Py([u])),u.length>0&&(this.updateDropdownDimensions(),this.flipDropdownVerticallyIfNeeded(),this.cellProperties.strict===!0&&this.highlightBestMatchingChoice(o)),this.hot.listen(),SS(this.TEXTAREA,r,r===n?void 0:n)}flipDropdownVerticallyIfNeeded(){const e=super.flipDropdownVerticallyIfNeeded(),{isFlipped:r,spaceAbove:n,spaceBelow:i}=e;return this.limitDropdownIfNeeded(r?n:i),e}limitDropdownIfNeeded(e){const r=this.getDropdownHeight();if(r>e){let n=0,i=0,s=null;do i=this.htEditor.stylesHandler.getDefaultRowHeight(),n+=i;while(n<e);s=n-i,this.isFlippedVertically&&(this.htEditor.rootElement.style.top=`${parseInt(this.htEditor.rootElement.style.top,10)+r-s}px`),this.setDropdownHeight(n-i)}}updateDropdownDimensions(){const e=MF(),r=this.getTargetEditorWidth()+e,n=this.getTargetEditorHeight()+e;this.htEditor.updateSettings({width:r,height:n}),bN(T2,this,A7).call(this),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}setDropdownHeight(e){this.htEditor.updateSettings({height:e}),bN(T2,this,A7).call(this),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}highlightBestMatchingChoice(e){typeof e=="number"?this.htEditor.selectCell(e,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}getTargetEditorHeight(){let e=0;if(!this.hot.getCurrentThemeName()){const i=this.hot.rootWindow.getComputedStyle(this.htContainer.querySelector(".htCore"));e=parseInt(i.borderTopWidth,10)+parseInt(i.borderBottomWidth,10)}const r=Math.min(this.cellProperties.visibleRows,this.strippedChoices.length);return Array.from({length:r},(i,s)=>s).reduce((i,s)=>{const a=this.hot.stylesHandler.getDefaultRowHeight()+(s===0?1:0);return i+a},0)+e}getTargetEditorWidth(){let e=0;if(!this.hot.getCurrentThemeName()){const r=this.hot.rootWindow.getComputedStyle(this.htContainer.querySelector(".htCore"));e=parseInt(r.borderInlineStartWidth,10)+parseInt(r.borderInlineEndWidth,10)}return this.htEditor.getColWidth(0)+e}stripValueIfNeeded(e){return this.stripValuesIfNeeded([e])[0]}stripValuesIfNeeded(e){const{allowHtml:r}=this.cellProperties,n=nr(e,s=>cn(s));return nr(n,s=>r?s:tN(s))}allowKeyEventPropagation(e){const r=this.htEditor.getSelectedRangeLast(),n={row:r?r.from.row:-1};let i=!1;return e===ut.ARROW_DOWN&&n.row>0&&n.row<this.htEditor.countRows()-1&&(i=!0),e===ut.ARROW_UP&&n.row>-1&&(i=!0),i}onBeforeKeyDown(e){if(HQ(e.keyCode)||e.keyCode===ut.BACKSPACE||e.keyCode===ut.DELETE||e.keyCode===ut.INSERT){let r=10;if(e.keyCode===ut.C&&(e.ctrlKey||e.metaKey))return;this.isOpened()||(r+=10),this.htEditor&&this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)},r)}}}function A7(){this.htEditor.view.hasVerticalScroll()&&this.htEditor.updateSettings({width:this.getTargetEditorWidth()+Ni(this.hot.rootDocument)})}const eCe="checkbox";class ZZ extends ov{static get EDITOR_TYPE(){return eCe}beginEditing(e,r){if(r&&r.type==="mouseup"&&r.target.nodeName==="TD"){const n=this.TD.querySelector('input[type="checkbox"]');Ct(n,"htBadValue")||n.click()}}finishEditing(){}init(){}open(){}close(){}getValue(){}setValue(){}focus(){}}/*!
 * Pikaday
 *
 * Copyright © 2014 David Bushell | BSD & MIT license | https://github.com/Pikaday/Pikaday
 */const Sf=()=>window,Po=()=>window.document,CN=(t,e)=>window.setTimeout(t,e),uu=function(t,e,r,n){t.addEventListener(e,r,!!n)},Sc=function(t,e,r,n){t.removeEventListener(e,r,!!n)},tCe=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")},Fa=function(t,e){return(" "+t.className+" ").indexOf(" "+e+" ")!==-1},M2=function(t,e){Fa(t,e)||(t.className=t.className===""?e:t.className+" "+e)},A2=function(t,e){t.className=tCe((" "+t.className+" ").replace(" "+e+" "," "))},V4=function(t){return/Array/.test(Object.prototype.toString.call(t))},$a=function(t){return/Date/.test(Object.prototype.toString.call(t))&&!isNaN(t.getTime())},rCe=function(t){let e=t.getDay();return e===0||e===6},nCe=function(t){return t%4===0&&t%100!==0||t%400===0},O7=function(t,e){return[31,nCe(t)?29:28,31,30,31,30,31,31,30,31,30,31][e]},WC=function(t){$a(t)&&t.setHours(0,0,0,0)},$C=function(t,e){return t.getTime()===e.getTime()},o_=function(t,e,r){let n,i;for(n in e)i=t[n]!==void 0,i&&typeof e[n]=="object"&&e[n]!==null&&e[n].nodeName===void 0?$a(e[n])?r&&(t[n]=new Date(e[n].getTime())):V4(e[n])?r&&(t[n]=e[n].slice(0)):t[n]=o_({},e[n],r):(r||!i)&&(t[n]=e[n]);return t},k7=function(t,e,r){let n=Po().createEvent("HTMLEvents");n.initEvent(e,!0,!1),n=o_(n,r),t.dispatchEvent(n)},D7=function(t){return t.month<0&&(t.year-=Math.ceil(Math.abs(t.month)/12),t.month+=12),t.month>11&&(t.year+=Math.floor(Math.abs(t.month)/12),t.month-=12),t},Xl={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,firstWeekOfYearMinDays:4,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},P7=function(t,e,r){for(e+=t.firstDay;e>=7;)e-=7;return r?t.i18n.weekdaysShort[e]:t.i18n.weekdays[e]},iCe=function(t){let e=[],r="false";if(t.isEmpty)if(t.showDaysInNextAndPreviousMonths)e.push("is-outside-current-month"),t.enableSelectionDaysInNextAndPreviousMonths||e.push("is-selection-disabled");else return'<td class="is-empty"></td>';return t.isDisabled&&e.push("is-disabled"),t.isToday&&e.push("is-today"),t.isSelected&&(e.push("is-selected"),r="true"),t.hasEvent&&e.push("has-event"),t.isInRange&&e.push("is-inrange"),t.isStartRange&&e.push("is-startrange"),t.isEndRange&&e.push("is-endrange"),'<td data-day="'+t.day+'" class="'+e.join(" ")+'" aria-selected="'+r+'"><button class="pika-button pika-day" type="button" data-pika-year="'+t.year+'" data-pika-month="'+t.month+'" data-pika-day="'+t.day+'">'+t.day+"</button></td>"},sCe=function(t,e){t.setHours(0,0,0,0);let r=t.getDate(),n=t.getDay(),i=e,s=i-1,a=7,o=function(m){return(m+a-1)%a};t.setDate(r+s-o(n));let u=new Date(t.getFullYear(),0,i),c=1440*60*1e3,f=(t.getTime()-u.getTime())/c;return 1+Math.round((f-s+o(u.getDay()))/a)},aCe=function(t,e,r,n,i){let s=new Date(n,r,e);return'<td class="pika-week">'+(t.hasMoment?t.moment(s).isoWeek():sCe(s,i))+"</td>"},oCe=function(t,e,r,n){return'<tr class="pika-row'+(r?" pick-whole-week":"")+(n?" is-selected":"")+'">'+(e?t.reverse():t).join("")+"</tr>"},lCe=function(t){return"<tbody>"+t.join("")+"</tbody>"},uCe=function(t){let e,r=[];for(t.showWeekNumber&&r.push("<th></th>"),e=0;e<7;e++)r.push('<th scope="col"><abbr title="'+P7(t,e)+'">'+P7(t,e,!0)+"</abbr></th>");return"<thead><tr>"+(t.isRTL?r.reverse():r).join("")+"</tr></thead>"},cCe=function(t,e,r,n,i,s){let a,o,u,c=t._o,f=r===c.minYear,g=r===c.maxYear,m='<div id="'+s+'" class="pika-title" role="heading" aria-live="polite">',v,w,y=!0,b=!0;for(u=[],a=0;a<12;a++)u.push('<option value="'+(r===i?a-e:12+a-e)+'"'+(a===n?' selected="selected"':"")+(f&&a<c.minMonth||g&&a>c.maxMonth?' disabled="disabled"':"")+">"+c.i18n.months[a]+"</option>");for(v='<div class="pika-label">'+c.i18n.months[n]+'<select class="pika-select pika-select-month" tabindex="-1">'+u.join("")+"</select></div>",V4(c.yearRange)?(a=c.yearRange[0],o=c.yearRange[1]+1):(a=r-c.yearRange,o=1+r+c.yearRange),u=[];a<o&&a<=c.maxYear;a++)a>=c.minYear&&u.push('<option value="'+a+'"'+(a===r?' selected="selected"':"")+">"+a+"</option>");return w='<div class="pika-label">'+r+c.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+u.join("")+"</select></div>",c.showMonthAfterYear?m+=w+v:m+=v+w,f&&(n===0||c.minMonth>=n)&&(y=!1),g&&(n===11||c.maxMonth<=n)&&(b=!1),e===0&&(m+='<button class="pika-prev'+(y?"":" is-disabled")+'" type="button">'+c.i18n.previousMonth+"</button>"),e===t._o.numberOfMonths-1&&(m+='<button class="pika-next'+(b?"":" is-disabled")+'" type="button">'+c.i18n.nextMonth+"</button>"),m+="</div>"},hCe=function(t,e,r){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+r+'">'+uCe(t)+lCe(e)+"</table>"};function xN(t){let e=this,r=e.config(t);e._onMouseDown=function(i){if(!e._v)return;i=i||Sf().event;let s=i.target||i.srcElement;if(s)if(Fa(s,"is-disabled")||(Fa(s,"pika-button")&&!Fa(s,"is-empty")&&!Fa(s.parentNode,"is-disabled")?(e.setDate(new Date(s.getAttribute("data-pika-year"),s.getAttribute("data-pika-month"),s.getAttribute("data-pika-day"))),r.bound&&CN(function(){e.hide(),r.blurFieldOnSelect&&r.field&&r.field.blur()},100)):Fa(s,"pika-prev")?e.prevMonth():Fa(s,"pika-next")&&e.nextMonth()),Fa(s,"pika-select"))e._c=!0;else if(i.preventDefault)i.preventDefault();else return i.returnValue=!1,!1},e._onChange=function(i){i=i||Sf().event;let s=i.target||i.srcElement;s&&(Fa(s,"pika-select-month")?e.gotoMonth(s.value):Fa(s,"pika-select-year")&&e.gotoYear(s.value))},e._onKeyChange=function(i){if(i=i||Sf().event,e.isVisible())switch(i.keyCode){case 13:case 27:r.field&&r.field.blur();break;case 37:e.adjustDate("subtract",1);break;case 38:e.adjustDate("subtract",7);break;case 39:e.adjustDate("add",1);break;case 40:e.adjustDate("add",7);break;case 8:case 46:e.setDate(null);break}},e._parseFieldValue=function(){if(r.parse)return r.parse(r.field.value,r.format);if(this.hasMoment){let i=this.moment(r.field.value,r.format,r.formatStrict);return i&&i.isValid()?i.toDate():null}else return new Date(Date.parse(r.field.value))},e._onInputChange=function(i){let s;i.firedBy!==e&&(s=e._parseFieldValue(),$a(s)&&e.setDate(s),e._v||e.show())},e._onInputFocus=function(){e.show()},e._onInputClick=function(){e.show()},e._onInputBlur=function(){let i=Po().activeElement;do if(Fa(i,"pika-single"))return;while(i=i.parentNode);e._c||(e._b=CN(function(){e.hide()},50)),e._c=!1},e._onClick=function(i){i=i||Sf().event;let s=i.target||i.srcElement,a=s;if(s){!hasEventListeners&&Fa(s,"pika-select")&&(s.onchange||(s.setAttribute("onchange","return;"),uu(s,"change",e._onChange)));do if(Fa(a,"pika-single")||a===r.trigger)return;while(a=a.parentNode);e._v&&s!==r.trigger&&a!==r.trigger&&e.hide()}},e.el=Po().createElement("div"),e.el.className="pika-single"+(r.isRTL?" is-rtl":"")+(r.theme?" "+r.theme:""),uu(e.el,"mousedown",e._onMouseDown,!0),uu(e.el,"touchend",e._onMouseDown,!0),uu(e.el,"change",e._onChange),r.keyboardInput&&uu(Po(),"keydown",e._onKeyChange),r.field&&(r.container?r.container.appendChild(e.el):r.bound?Po().body.appendChild(e.el):r.field.parentNode.insertBefore(e.el,r.field.nextSibling),uu(r.field,"change",e._onInputChange),r.defaultDate||(r.defaultDate=e._parseFieldValue(),r.setDefaultDate=!0));let n=r.defaultDate;$a(n)?r.setDefaultDate?e.setDate(n,!0):e.gotoDate(n):e.gotoDate(new Date),r.bound?(this.hide(),e.el.className+=" is-bound",uu(r.trigger,"click",e._onInputClick),uu(r.trigger,"focus",e._onInputFocus),uu(r.trigger,"blur",e._onInputBlur)):this.show()}xN.prototype={config:function(t){this._o||(this._o=o_({},Xl,!0));let e=o_(this._o,t,!0);e.isRTL=!!e.isRTL,e.field=e.field&&e.field.nodeName?e.field:null,e.theme=typeof e.theme=="string"&&e.theme?e.theme:null,e.bound=!!(e.bound!==void 0?e.field&&e.bound:e.field),e.trigger=e.trigger&&e.trigger.nodeName?e.trigger:e.field,e.disableWeekends=!!e.disableWeekends,e.disableDayFn=typeof e.disableDayFn=="function"?e.disableDayFn:null;let r=parseInt(e.numberOfMonths,10)||1;if(e.numberOfMonths=r>4?4:r,$a(e.minDate)||(e.minDate=!1),$a(e.maxDate)||(e.maxDate=!1),e.minDate&&e.maxDate&&e.maxDate<e.minDate&&(e.maxDate=e.minDate=!1),e.minDate&&this.setMinDate(e.minDate),e.maxDate&&this.setMaxDate(e.maxDate),V4(e.yearRange)){let n=new Date().getFullYear()-10;e.yearRange[0]=parseInt(e.yearRange[0],10)||n,e.yearRange[1]=parseInt(e.yearRange[1],10)||n}else e.yearRange=Math.abs(parseInt(e.yearRange,10))||Xl.yearRange,e.yearRange>100&&(e.yearRange=100);return e},toString:function(t){return t=t||this._o.format,$a(this._d)?this._o.toString?this._o.toString(this._d,t):this.hasMoment?this.moment(this._d).format(t):this._d.toDateString():""},getMoment:function(){return this.hasMoment?this.moment(this._d):null},setMoment:function(t,e){this.hasMoment&&this.moment.isMoment(t)&&this.setDate(t.toDate(),e)},useMoment:function(t){this.hasMoment=!0,this.moment=t},getDate:function(){return $a(this._d)?new Date(this._d.getTime()):null},setDate:function(t,e){if(!t)return this._d=null,this._o.field&&(this._o.field.value="",k7(this._o.field,"change",{firedBy:this})),this.draw();if(typeof t=="string"&&(t=new Date(Date.parse(t))),!$a(t))return;let r=this._o.minDate,n=this._o.maxDate;$a(r)&&t<r?t=r:$a(n)&&t>n&&(t=n),this._d=new Date(t.getTime()),WC(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),k7(this._o.field,"change",{firedBy:this})),!e&&typeof this._o.onSelect=="function"&&this._o.onSelect.call(this,this.getDate())},clear:function(){this.setDate(null)},gotoDate:function(t){let e=!0;if($a(t)){if(this.calendars){let r=new Date(this.calendars[0].year,this.calendars[0].month,1),n=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),i=t.getTime();n.setMonth(n.getMonth()+1),n.setDate(n.getDate()-1),e=i<r.getTime()||n.getTime()<i}e&&(this.calendars=[{month:t.getMonth(),year:t.getFullYear()}],this._o.mainCalendar==="right"&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(t,e){let r=this.getDate()||new Date,n=parseInt(e)*24*60*60*1e3,i;t==="add"?i=new Date(r.valueOf()+n):t==="subtract"&&(i=new Date(r.valueOf()-n)),this.setDate(i)},adjustCalendars:function(){this.calendars[0]=D7(this.calendars[0]);for(let t=1;t<this._o.numberOfMonths;t++)this.calendars[t]=D7({month:this.calendars[0].month+t,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(t){isNaN(t)||(this.calendars[0].month=parseInt(t,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(t){isNaN(t)||(this.calendars[0].year=parseInt(t,10),this.adjustCalendars())},setMinDate:function(t){t instanceof Date?(WC(t),this._o.minDate=t,this._o.minYear=t.getFullYear(),this._o.minMonth=t.getMonth()):(this._o.minDate=Xl.minDate,this._o.minYear=Xl.minYear,this._o.minMonth=Xl.minMonth,this._o.startRange=Xl.startRange),this.draw()},setMaxDate:function(t){t instanceof Date?(WC(t),this._o.maxDate=t,this._o.maxYear=t.getFullYear(),this._o.maxMonth=t.getMonth()):(this._o.maxDate=Xl.maxDate,this._o.maxYear=Xl.maxYear,this._o.maxMonth=Xl.maxMonth,this._o.endRange=Xl.endRange),this.draw()},setStartRange:function(t){this._o.startRange=t},setEndRange:function(t){this._o.endRange=t},draw:function(t){if(!this._v&&!t)return;let e=this._o,r=e.minYear,n=e.maxYear,i=e.minMonth,s=e.maxMonth,a="",o;this._y<=r&&(this._y=r,!isNaN(i)&&this._m<i&&(this._m=i)),this._y>=n&&(this._y=n,!isNaN(s)&&this._m>s&&(this._m=s));for(let u=0;u<e.numberOfMonths;u++)o="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2),a+='<div class="pika-lendar">'+cCe(this,u,this.calendars[u].year,this.calendars[u].month,this.calendars[0].year,o)+this.render(this.calendars[u].year,this.calendars[u].month,o)+"</div>";this.el.innerHTML=a,e.bound&&e.field.type!=="hidden"&&CN(function(){e.trigger.focus()},1),typeof this._o.onDraw=="function"&&this._o.onDraw(this),e.bound&&e.field.setAttribute("aria-label",e.ariaLabel)},adjustPosition:function(){let t,e,r,n,i,s,a,o,u,c,f;this._o.container||(this.el.style.position="absolute",t=this._o.trigger,e=this.el.offsetWidth,r=this.el.offsetHeight,n=Sf().innerWidth||Po().documentElement.clientWidth,i=Sf().innerHeight||Po().documentElement.clientHeight,s=Po().body.scrollTop||Po().documentElement.scrollTop,c=!0,f=!0,u=t.getBoundingClientRect(),a=u.left+Sf().pageXOffset,o=u.bottom+Sf().pageYOffset,(this._o.reposition&&a+e>n||this._o.position.indexOf("right")>-1&&a-e+t.offsetWidth>0)&&(a=a-e+t.offsetWidth,c=!1),(this._o.reposition&&o+r>i+s||this._o.position.indexOf("top")>-1&&o-r-t.offsetHeight>0)&&(o=o-r-t.offsetHeight,f=!1),a<0&&(a=0),o<0&&(o=0),this.el.style.left=a+"px",this.el.style.top=o+"px",M2(this.el,c?"left-aligned":"right-aligned"),M2(this.el,f?"bottom-aligned":"top-aligned"),A2(this.el,c?"right-aligned":"left-aligned"),A2(this.el,f?"top-aligned":"bottom-aligned"))},render:function(t,e,r){let n=this._o,i=new Date,s=O7(t,e),a=new Date(t,e,1).getDay(),o=[],u=[];WC(i),n.firstDay>0&&(a-=n.firstDay,a<0&&(a+=7));let c=e===0?11:e-1,f=e===11?0:e+1,g=e===0?t-1:t,m=e===11?t+1:t,v=O7(g,c),w=s+a,y=w;for(;y>7;)y-=7;w+=7-y;let b=!1;for(let x=0,_=0;x<w;x++){let T=new Date(t,e,1+(x-a)),D=$a(this._d)?$C(T,this._d):!1,P=$C(T,i),O=n.events.indexOf(T.toDateString())!==-1,A=x<a||x>=s+a,W=1+(x-a),L=e,H=t,J=n.startRange&&$C(n.startRange,T),G=n.endRange&&$C(n.endRange,T),ve=n.startRange&&n.endRange&&n.startRange<T&&T<n.endRange,be=n.minDate&&T<n.minDate||n.maxDate&&T>n.maxDate||n.disableWeekends&&rCe(T)||n.disableDayFn&&n.disableDayFn(T);A&&(x<a?(W=v+W,L=c,H=g):(W=W-s,L=f,H=m));let we={day:W,month:L,year:H,hasEvent:O,isSelected:D,isToday:P,isDisabled:be,isEmpty:A,isStartRange:J,isEndRange:G,isInRange:ve,showDaysInNextAndPreviousMonths:n.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:n.enableSelectionDaysInNextAndPreviousMonths};n.pickWholeWeek&&D&&(b=!0),u.push(iCe(we)),++_===7&&(n.showWeekNumber&&u.unshift(aCe(this,x-a,e,t,n.firstWeekOfYearMinDays)),o.push(oCe(u,n.isRTL,n.pickWholeWeek,b)),u=[],_=0,b=!1)}return hCe(n,o,r)},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),A2(this.el,"is-hidden"),this._o.bound&&(uu(Po(),"click",this._onClick),this.adjustPosition()),typeof this._o.onOpen=="function"&&this._o.onOpen.call(this))},hide:function(){let t=this._v;t!==!1&&(this._o.bound&&Sc(Po(),"click",this._onClick),this._o.container||(this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto"),M2(this.el,"is-hidden"),this._v=!1,t!==void 0&&typeof this._o.onClose=="function"&&this._o.onClose.call(this))},destroy:function(){let t=this._o;this.hide(),Sc(this.el,"mousedown",this._onMouseDown,!0),Sc(this.el,"touchend",this._onMouseDown,!0),Sc(this.el,"change",this._onChange),t.keyboardInput&&Sc(Po(),"keydown",this._onKeyChange),t.field&&(Sc(t.field,"change",this._onInputChange),t.bound&&(Sc(t.trigger,"click",this._onInputClick),Sc(t.trigger,"focus",this._onInputFocus),Sc(t.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}};function fCe(t,e){dCe(t,e),e.add(t)}function dCe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function I7(t,e,r){return(e=gCe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function gCe(t){var e=mCe(t,"string");return typeof e=="symbol"?e:e+""}function mCe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function O2(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const JZ="date",N7="dateEditor",pCe="DD/MM/YYYY";var UC=new WeakSet;class eJ extends um{constructor(){super(...arguments),fCe(this,UC),I7(this,"parentDestroyed",!1),I7(this,"$datePicker",null)}static get EDITOR_TYPE(){return JZ}init(){if(typeof je!="function")throw new Error("You need to include moment.js to your project.");if(typeof xN!="function")throw new Error("You need to include Pikaday to your project.");super.init(),this.hot.addHook("afterDestroy",()=>{this.parentDestroyed=!0,this.destroyElements()}),this.hot.addHook("afterSetTheme",(e,r)=>{r||this.close()})}createElements(){super.createElements(),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),Ve(this.datePicker,"htDatepickerHolder"),this.hot.rootPortalElement.appendChild(this.datePicker),this.eventManager.addEventListener(this.datePicker,"mousedown",e=>{Ct(e.target,"pika-day")&&this.hideDatepicker(),e.stopPropagation()})}destroyElements(){const e=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),e&&e.removeChild(this.datePicker)}prepare(e,r,n,i,s,a){super.prepare(e,r,n,i,s,a)}open(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const n=this.hot.getShortcutManager().getContext("editor");this.showDatepicker(e),super.open(),n.addShortcuts([{keys:[["ArrowLeft"]],callback:()=>{this.$datePicker.adjustDate("subtract",1)}},{keys:[["ArrowRight"]],callback:()=>{this.$datePicker.adjustDate("add",1)}},{keys:[["ArrowUp"]],callback:()=>{this.$datePicker.adjustDate("subtract",7)}},{keys:[["ArrowDown"]],callback:()=>{this.$datePicker.adjustDate("add",7)}}],{group:N7})}close(){var e;(e=this.$datePicker)!==null&&e!==void 0&&e.destroy&&this.$datePicker.destroy(),this.hot._registerTimeout(()=>{const i=this.hot._getEditorManager();i.closeEditor(),this.hot.view.render(),i.prepareEditor()}),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(N7),super.close()}finishEditing(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;super.finishEditing(e,r)}showDatepicker(e){const r=O2(UC,this,k2).call(this),n=this.hot.view.isMouseDown(),i=e?NF(e.keyCode):!1;let s;this.datePicker.style.display="block",this.$datePicker=new xN(this.getDatePickerConfig()),typeof this.$datePicker.useMoment=="function"&&this.$datePicker.useMoment(je),this.$datePicker._onInputFocus=function(){},this.originalValue?(s=this.originalValue,je(s,r,!0).isValid()&&this.$datePicker.setMoment(je(s,r),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),!i&&!n&&this.setValue("")):this.cellProperties.defaultDate?(s=this.cellProperties.defaultDate,je(s,r,!0).isValid()&&this.$datePicker.setMoment(je(s,r),!0),!i&&!n&&this.setValue("")):this.$datePicker.gotoToday()}hideDatepicker(){this.datePickerStyle.display="none",this.$datePicker.hide()}getDatePickerConfig(){var e;const r=this.TEXTAREA,n={};this.cellProperties&&this.cellProperties.datePickerConfig&&yS(n,this.cellProperties.datePickerConfig);const i=n.onSelect,s=n.onClose;return n.field=r,n.trigger=r,n.container=this.datePicker,n.bound=!1,n.keyboardInput=!1,n.format=(e=n.format)!==null&&e!==void 0?e:O2(UC,this,k2).call(this),n.reposition=n.reposition||!1,n.isRTL=!1,n.onSelect=a=>{let o=a;isNaN(o.getTime())||(o=je(o).format(O2(UC,this,k2).call(this))),this.setValue(o),i&&i(),_l()&&this.hideDatepicker()},n.onClose=()=>{this.parentDestroyed||this.finishEditing(!1),s&&s()},n}refreshDimensions(e){var r;if(super.refreshDimensions(e),this.state!==Vn.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.hideDatepicker();return}const{rowIndexMapper:n,columnIndexMapper:i}=this.hot,{wtOverlays:s}=this.hot.view._wt,{wtTable:a}=(r=s.getParentOverlay(this.TD))!==null&&r!==void 0?r:this.hot.view._wt,o=n.getVisualFromRenderableIndex(a.getFirstPartiallyVisibleRow()),u=n.getVisualFromRenderableIndex(a.getLastPartiallyVisibleRow()),c=i.getVisualFromRenderableIndex(a.getFirstPartiallyVisibleColumn()),f=i.getVisualFromRenderableIndex(a.getLastPartiallyVisibleColumn());if(this.row>=o&&this.row<=u&&this.col>=c&&this.col<=f){const g=this.TD.getBoundingClientRect();this.datePickerStyle.top=`${this.hot.rootWindow.pageYOffset+g.top+ai(this.TD)}px`;let m=this.hot.rootWindow.pageXOffset;this.hot.isRtl()?m+=g.right-Un(this.datePicker):m+=g.left,this.datePickerStyle.left=`${m}px`}else this.hideDatepicker()}}function k2(){var t;return(t=this.cellProperties.dateFormat)!==null&&t!==void 0?t:pCe}const vCe="dropdown";class tJ extends B4{static get EDITOR_TYPE(){return vCe}prepare(e,r,n,i,s,a){a.filter=!1,a.strict=!0,super.prepare(e,r,n,i,s,a)}}const wCe="numeric";class rJ extends um{static get EDITOR_TYPE(){return wCe}}function yCe(t,e,r){return(e=SCe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function SCe(t){var e=bCe(t,"string");return typeof e=="symbol"?e:e+""}function bCe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const CCe="password";class nJ extends um{constructor(){super(...arguments),yCe(this,"autoResize",KZ(this.hot.rootDocument,{textContent:e=>"•".repeat(e.value.length)}))}static get EDITOR_TYPE(){return CCe}createElements(){super.createElements(),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,Bu(this.TEXTAREA_PARENT),this.TEXTAREA.setAttribute(...Zf(-1)),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}const D2="ht_editor_visible",H7="selectEditor",xCe="select";class iJ extends ov{static get EDITOR_TYPE(){return xCe}init(){this.selectWrapper=this.hot.rootDocument.createElement("div"),this.select=this.hot.rootDocument.createElement("select"),this.select.setAttribute("data-hot-input","true"),this.selectWrapper.style.display="none";const e=this.hot.rootDocument.createElement("DIV"),r=this.hot.getSettings().ariaTags;e.className="htAutocompleteArrow",r&&e.setAttribute(...sm()),e.appendChild(this.hot.rootDocument.createTextNode("▼")),Ve(this.selectWrapper,"htSelectEditor"),this.selectWrapper.appendChild(this.select),this.selectWrapper.insertBefore(e,this.selectWrapper.firstChild),this.hot.rootElement.appendChild(this.selectWrapper),this.registerHooks()}getValue(){return this.select.value}setValue(e){this.select.value=e}open(){this._opened=!0,this.refreshDimensions(),this.selectWrapper.style.display="",this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.selectWrapper.style.display="none",Ct(this.selectWrapper,D2)&&wt(this.selectWrapper,D2),this.unregisterShortcuts(),this.clearHooks()}focus(){this.select.focus()}registerHooks(){this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>this.refreshDimensions()),this.addHook("afterRowResize",()=>this.refreshDimensions())}prepare(e,r,n,i,s,a){super.prepare(e,r,n,i,s,a);const o=this.cellProperties.selectOptions;let u;typeof o=="function"?u=this.prepareOptions(o(this.row,this.col,this.prop)):u=this.prepareOptions(o),Bu(this.select),Wt(u,(c,f)=>{const g=this.hot.rootDocument.createElement("OPTION");g.value=f,om(g,c),this.select.appendChild(g)})}prepareOptions(e){let r={};if(Array.isArray(e))for(let n=0,i=e.length;n<i;n++)r[e[n]]=e[n];else typeof e=="object"&&(r=e);return r}refreshValue(){const e=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=e,this.setValue(e),this.refreshDimensions()}refreshDimensions(){if(this.state!==Vn.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.close();return}const{top:e,start:r,width:n,height:i}=this.getEditedCellRect(),s=this.selectWrapper.style;s.height=`${i}px`,s.width=`${n}px`,s.top=`${e}px`,s[this.hot.isRtl()?"right":"left"]=`${r}px`,s.margin="0px",Ve(this.selectWrapper,D2)}registerShortcuts(){const r=this.hot.getShortcutManager().getContext("editor"),n={group:H7};this.isInFullEditMode()&&r.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{const i=this.select.selectedIndex-1;i>=0&&(this.select[i].selected=!0)}},{keys:[["ArrowDown"]],callback:()=>{const i=this.select.selectedIndex+1;i<=this.select.length-1&&(this.select[i].selected=!0)}}],n)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(H7)}}const ECe="time";class sJ extends um{static get EDITOR_TYPE(){return ECe}prepare(e,r,n,i,s,a){super.prepare(e,r,n,i,s,a),this.TEXTAREA.dir="ltr"}}function _Ce(){ca(ov),ca(B4),ca(ZZ),ca(eJ),ca(tJ),ca(L4),ca(rJ),ca(nJ),ca(iJ),ca(um),ca(sJ)}const RCe="html";function W4(t,e,r,n,i,s,a){MS.apply(this,[t,e,r,n,i,s,a]),om(e,s??"",!1)}W4.RENDERER_TYPE=RCe;const TCe="autocomplete";function uv(t,e,r,n,i,s,a){const{rootDocument:o}=t,u=a.allowHtml?W4:fh,c=o.createElement("DIV"),f=t.getSettings().ariaTags;if(c.className="htAutocompleteArrow",f&&c.setAttribute(...sm()),c.appendChild(o.createTextNode("▼")),u.apply(this,[t,e,r,n,i,s,a]),e.firstChild||e.appendChild(o.createTextNode(" ")),e.insertBefore(c,e.firstChild),Ve(e,"htAutocomplete"),!t.acArrowListener){const g=new Uo(t);t.acArrowListener=function(m){Ct(m.target,"htAutocompleteArrow")&&t.view._wt.getSetting("onCellDblClick",null,t._createCellCoords(r,n),e)},g.addEventListener(t.rootElement,"mousedown",t.acArrowListener),t.addHookOnce("afterDestroy",()=>{g.destroy()})}}uv.RENDERER_TYPE=TCe;const MCe="dropdown";function $4(t,e,r,n,i,s,a){uv.apply(this,[t,e,r,n,i,s,a])}$4.RENDERER_TYPE=MCe;const F7=new WeakMap,L7=new WeakMap,ACe="htBadValue",Pp="data-row",Ip="data-col",OCe="checkboxRenderer",aJ="checkbox";Je.getSingleton().add("modifyAutoColumnSizeSeed",function(t,e,r){const{label:n,type:i,row:s,column:a,prop:o}=e;if(i===aJ){if(n){const{value:u,property:c}=n;let f=r;if(u)f=typeof u=="function"?u(s,a,o,r):u;else if(c){const g=this.getDataAtRowProp(s,c);f=g!==null?g:r}t=f}return t}});function U4(t,e,r,n,i,s,a){const{rootDocument:o}=t,u=t.getSettings().ariaTags;MS.apply(this,[t,e,r,n,i,s,a]),kCe(t);let c=DCe(o);const f=a.label;let g=!1;if(typeof a.checkedTemplate>"u"&&(a.checkedTemplate=!0),typeof a.uncheckedTemplate>"u"&&(a.uncheckedTemplate=!1),Bu(e),s===a.checkedTemplate||cn(s).toLocaleLowerCase(a.locale)===cn(a.checkedTemplate).toLocaleLowerCase(a.locale)?c.checked=!0:s===a.uncheckedTemplate||cn(s).toLocaleLowerCase(a.locale)===cn(a.uncheckedTemplate).toLocaleLowerCase(a.locale)?c.checked=!1:In(s)?Ve(c,"noValue"):(c.style.display="none",Ve(c,ACe),g=!0),bt(c,[[Pp,r],[Ip,n]]),u&&bt(c,[Rp(c.checked?t.getTranslatedPhrase(k4):t.getTranslatedPhrase(D4)),hQ(c.checked),Tme()]),!g&&f){let y="";if(f.value)y=typeof f.value=="function"?f.value.call(this,r,n,i,s):f.value;else if(f.property){const x=t.getDataAtRowProp(r,f.property);y=x!==null?x:""}const b=PCe(o,y,f.separated!==!0);f.position==="before"?f.separated?(e.appendChild(b),e.appendChild(c)):(b.appendChild(c),c=b):(!f.position||f.position==="after")&&(f.separated?(e.appendChild(c),e.appendChild(b)):(b.insertBefore(c,b.firstChild),c=b))}(!f||f&&!f.separated)&&e.appendChild(c),g&&e.appendChild(o.createTextNode("#bad-value#")),F7.has(t)||(F7.set(t,!0),m());function m(){const b=t.getShortcutManager().getContext("grid"),x={group:OCe,relativeToGroup:ed,position:"before"};b.addShortcuts([{keys:[["space"]],callback:()=>(v(),!w()),runOnlyIf:()=>{var _;return(_=t.getSelectedRangeLast())===null||_===void 0?void 0:_.highlight.isCell()}},{keys:[["enter"]],callback:()=>(v(),!w()),runOnlyIf:()=>{const _=t.getSelectedRangeLast();return t.getSettings().enterBeginsEditing&&_?.highlight.isCell()&&!t.selection.isMultiple()}},{keys:[["delete"],["backspace"]],callback:()=>(v(!0),!w()),runOnlyIf:()=>{var _;return(_=t.getSelectedRangeLast())===null||_===void 0?void 0:_.highlight.isCell()}}],x)}function v(){let y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const b=t.getSelectedRange(),x=[],_=new Map;let T=[],D=0;if(b){for(let P=0;P<b.length;P++){const{row:O,col:A}=b[P].getTopStartCorner(),{row:W,col:L}=b[P].getBottomEndCorner();for(let H=O;H<=W;H+=1)for(let J=A;J<=L;J+=1){const G=t.getCellMeta(H,J);if(G.hidden)continue;const ve={checkedTemplate:G.checkedTemplate,uncheckedTemplate:G.uncheckedTemplate};if(G.type!=="checkbox"){y===!0&&!G.readOnly&&(_.has(x.length)?_.set(x.length,[..._.get(x.length),[H,J,null]]):_.set(x.length,[[H,J,null]]));continue}if(G.readOnly===!0)continue;typeof G.checkedTemplate>"u"&&(G.checkedTemplate=!0),typeof G.uncheckedTemplate>"u"&&(G.uncheckedTemplate=!1);const be=t.getDataAtCell(H,J);y===!1?[G.checkedTemplate,G.checkedTemplate.toString()].includes(be)?T.push([H,J,G.uncheckedTemplate,ve]):[G.uncheckedTemplate,G.uncheckedTemplate.toString(),null,void 0].includes(be)&&T.push([H,J,G.checkedTemplate,ve]):T.push([H,J,G.uncheckedTemplate,ve]),D+=1}x.push(D),D=0}T.every(P=>{let[,,O]=P;return O===T[0][2]})?T=T.map(P=>{let[O,A,W]=P;return[O,A,W]}):T=T.map(P=>{let[O,A,,W]=P;return[O,A,W.checkedTemplate]}),T.length>0&&x.forEach((P,O)=>{let A=T.splice(0,P);_.size&&_.has(O)&&(A=[...A,..._.get(O)]),t.setDataAtCell(A)})}}function w(){const y=t.getSelectedRange();if(y){for(let b=0;b<y.length;b++){const x=y[b].getTopStartCorner(),_=y[b].getBottomEndCorner();for(let T=x.row;T<=_.row;T++)for(let D=x.col;D<=_.col;D++){if(t.getCellMeta(T,D).readOnly)continue;const O=t.getCell(T,D);if(Iu(O)&&O.querySelectorAll("input[type=checkbox]").length>0)return!0}}return!1}}}U4.RENDERER_TYPE=aJ;function kCe(t){let e=L7.get(t);if(!e){const{rootElement:r}=t;e=new Uo(t),e.addEventListener(r,"click",n=>NCe(n,t)),e.addEventListener(r,"mouseup",n=>ICe(n,t)),e.addEventListener(r,"change",n=>HCe(n,t)),L7.set(t,e)}return e}function DCe(t){const e=t.createElement("input");return e.className="htCheckboxRendererInput",e.type="checkbox",e.setAttribute("tabindex","-1"),e.cloneNode(!1)}function PCe(t,e,r){const n=t.createElement("label");n.className=`htCheckboxRendererLabel ${r?"fullWidth":""}`;const i=t.createTextNode(e);if(r){const s=t.createElement("span");s.appendChild(i),n.appendChild(s)}else n.appendChild(i);return n.cloneNode(!0)}function ICe(t,e){const{target:r}=t;j4(r)&&(!r.hasAttribute(Pp)||!r.hasAttribute(Ip)||setTimeout(e.listen,10))}function NCe(t,e){const{target:r}=t;if(!j4(r)||!r.hasAttribute(Pp)||!r.hasAttribute(Ip))return;const n=parseInt(r.getAttribute(Pp),10),i=parseInt(r.getAttribute(Ip),10);e.getCellMeta(n,i).readOnly&&t.preventDefault()}function HCe(t,e){const{target:r}=t;if(!j4(r)||!r.hasAttribute(Pp)||!r.hasAttribute(Ip))return;const n=parseInt(r.getAttribute(Pp),10),i=parseInt(r.getAttribute(Ip),10),s=e.getCellMeta(n,i);if(!s.readOnly){let a=null;t.target.checked?a=s.uncheckedTemplate===void 0?!0:s.checkedTemplate:a=s.uncheckedTemplate===void 0?!1:s.uncheckedTemplate,e.setDataAtCell(n,i,a)}}function j4(t){return t.tagName==="INPUT"&&t.getAttribute("type")==="checkbox"}const FCe="handsontable";function Y4(t,e,r,n,i,s,a){uv.apply(this,[t,e,r,n,i,s,a])}Y4.RENDERER_TYPE=FCe;var LCe=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function BCe(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var P2,B7;function VCe(){return B7||(B7=1,P2={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(t){let e=t%10;return~~(t%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th"},bytes:{binarySuffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],decimalSuffixes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"]},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0,spaceSeparatedCurrency:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}}),P2}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var I2,V7;function oJ(){if(V7)return I2;V7=1;const t=[{key:"ZiB",factor:Math.pow(1024,7)},{key:"ZB",factor:Math.pow(1e3,7)},{key:"YiB",factor:Math.pow(1024,8)},{key:"YB",factor:Math.pow(1e3,8)},{key:"TiB",factor:Math.pow(1024,4)},{key:"TB",factor:Math.pow(1e3,4)},{key:"PiB",factor:Math.pow(1024,5)},{key:"PB",factor:Math.pow(1e3,5)},{key:"MiB",factor:Math.pow(1024,2)},{key:"MB",factor:Math.pow(1e3,2)},{key:"KiB",factor:Math.pow(1024,1)},{key:"KB",factor:Math.pow(1e3,1)},{key:"GiB",factor:Math.pow(1024,3)},{key:"GB",factor:Math.pow(1e3,3)},{key:"EiB",factor:Math.pow(1024,6)},{key:"EB",factor:Math.pow(1e3,6)},{key:"B",factor:1}];function e(u){return u.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function r(u,c,f,g,m,v,w){if(!isNaN(+u))return+u;let y="",b=u.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(b!==u)return-1*r(b,c,f,g,m,v);for(let O=0;O<t.length;O++){let A=t[O];if(y=u.replace(RegExp(`([0-9 ])(${A.key})$`),"$1"),y!==u)return r(y,c,f,g,m,v)*A.factor}if(y=u.replace("%",""),y!==u)return r(y,c,f,g,m,v)/100;let x=parseFloat(u);if(isNaN(x))return;let _=g(x);if(_&&_!=="."&&(y=u.replace(new RegExp(`${e(_)}$`),""),y!==u))return r(y,c,f,g,m,v);let T={};Object.keys(v).forEach(O=>{T[v[O]]=O});let D=Object.keys(T).sort().reverse(),P=D.length;for(let O=0;O<P;O++){let A=D[O],W=T[A];if(y=u.replace(A,""),y!==u){let L;switch(W){case"thousand":L=Math.pow(10,3);break;case"million":L=Math.pow(10,6);break;case"billion":L=Math.pow(10,9);break;case"trillion":L=Math.pow(10,12);break}return r(y,c,f,g,m,v)*L}}}function n(u,c,f){let g=u.replace(f,"");return g=g.replace(new RegExp(`([0-9])${e(c.thousands)}([0-9])`,"g"),"$1$2"),g=g.replace(c.decimal,"."),g}function i(u,c,f="",g,m,v,w){if(u==="")return;if(u===m)return 0;let y=n(u,c,f);return r(y,c,f,g,m,v)}function s(u,c){if(!(u.indexOf(":")&&c.thousands!==":"))return!1;let g=u.split(":");if(g.length!==3)return!1;let m=+g[0],v=+g[1],w=+g[2];return!isNaN(m)&&!isNaN(v)&&!isNaN(w)}function a(u){let c=u.split(":"),f=+c[0],g=+c[1];return+c[2]+60*g+3600*f}function o(u,c){const f=q4();let g=f.currentDelimiters(),m=f.currentCurrency().symbol,v=f.currentOrdinal(),w=f.getZeroFormat(),y=f.currentAbbreviations(),b;if(typeof u=="string")s(u,g)?b=a(u):b=i(u,g,m,v,w,y);else if(typeof u=="number")b=u;else return;if(b!==void 0)return b}return I2={unformat:o},I2}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var N2,W7;function z4(){if(W7)return N2;W7=1;let t=oJ();const e=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,r=["currency","percent","byte","time","ordinal","number"],n=["trillion","billion","million","thousand"],i=["prefix","infix","postfix"],s=["sign","parenthesis"],a={type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},c={output:{type:"string",validValues:r},base:{type:"string",validValues:["decimal","binary","general"],restriction:(b,x)=>x.output==="byte",message:"`base` must be provided only when the output is `byte`",mandatory:b=>b.output==="byte"},characteristic:{type:"number",restriction:b=>b>=0,message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:n},average:"boolean",lowPrecision:{type:"boolean",restriction:(b,x)=>x.average===!0,message:"`lowPrecision` must be provided only when the option `average` is set"},currencyPosition:{type:"string",validValues:i},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:b=>b>=0,message:"value must be positive"},{restriction:(b,x)=>!x.exponential,message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:b=>b>=0,message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",roundingFunction:"function",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",spaceSeparatedCurrency:"boolean",spaceSeparatedAbbreviation:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:s},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:(b,x)=>x.output==="percent",message:"`prefixSymbol` can be provided only when the output is `percent`"}},f={languageTag:{type:"string",mandatory:!0,restriction:b=>b.match(e),message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:a,spaceSeparated:"boolean",spaceSeparatedCurrency:"boolean",ordinal:{type:"function",mandatory:!0},bytes:{type:"object",children:{binarySuffixes:"object",decimalSuffixes:"object"}},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function g(b,x){let _=m(b),T=w(x);return _&&T}function m(b){return t.unformat(b)!==void 0}function v(b,x,_,T=!1){let D=Object.keys(b).map(P=>{if(!x[P])return console.error(`${_} Invalid key: ${P}`),!1;let O=b[P],A=x[P];if(typeof A=="string"&&(A={type:A}),A.type==="format"){if(!v(O,c,`[Validate ${P}]`,!0))return!1}else if(typeof O!==A.type)return console.error(`${_} ${P} type mismatched: "${A.type}" expected, "${typeof O}" provided`),!1;if(A.restrictions&&A.restrictions.length){let W=A.restrictions.length;for(let L=0;L<W;L++){let{restriction:H,message:J}=A.restrictions[L];if(!H(O,b))return console.error(`${_} ${P} invalid value: ${J}`),!1}}return A.restriction&&!A.restriction(O,b)?(console.error(`${_} ${P} invalid value: ${A.message}`),!1):A.validValues&&A.validValues.indexOf(O)===-1?(console.error(`${_} ${P} invalid value: must be among ${JSON.stringify(A.validValues)}, "${O}" provided`),!1):!(A.children&&!v(O,A.children,`[Validate ${P}]`))});return T||D.push(...Object.keys(x).map(P=>{let O=x[P];if(typeof O=="string"&&(O={type:O}),O.mandatory){let A=O.mandatory;if(typeof A=="function"&&(A=A(b)),A&&b[P]===void 0)return console.error(`${_} Missing mandatory key "${P}"`),!1}return!0})),D.reduce((P,O)=>P&&O,!0)}function w(b){return v(b,c,"[Validate format]")}function y(b){return v(b,f,"[Validate language]")}return N2={validate:g,validateFormat:w,validateInput:m,validateLanguage:y},N2}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */function WCe(t,e){let r=t.match(/^{([^}]*)}/);return r?(e.prefix=r[1],t.slice(r[0].length)):t}function $Ce(t,e){let r=t.match(/{([^}]*)}$/);return r?(e.postfix=r[1],t.slice(0,-r[0].length)):t}function UCe(t,e){if(t.indexOf("$")!==-1){e.output="currency";return}if(t.indexOf("%")!==-1){e.output="percent";return}if(t.indexOf("bd")!==-1){e.output="byte",e.base="general";return}if(t.indexOf("b")!==-1){e.output="byte",e.base="binary";return}if(t.indexOf("d")!==-1){e.output="byte",e.base="decimal";return}if(t.indexOf(":")!==-1){e.output="time";return}t.indexOf("o")!==-1&&(e.output="ordinal")}function jCe(t,e){t.indexOf(",")!==-1&&(e.thousandSeparated=!0)}function YCe(t,e){t.indexOf(" ")!==-1&&(e.spaceSeparated=!0,e.spaceSeparatedCurrency=!0,(e.average||e.forceAverage)&&(e.spaceSeparatedAbbreviation=!0))}function zCe(t,e){let r=t.match(/[1-9]+[0-9]*/);r&&(e.totalLength=+r[0])}function GCe(t,e){let n=t.split(".")[0].match(/0+/);n&&(e.characteristic=n[0].length)}function qCe(t,e){let r=t.split(".")[1];if(r){let n=r.match(/0+/);n&&(e.mantissa=n[0].length)}}function KCe(t,e){const r=t.split(".")[1];r&&(e.trimMantissa=r.indexOf("[")!==-1)}function XCe(t,e){t.indexOf("a")!==-1&&(e.average=!0)}function QCe(t,e){t.indexOf("K")!==-1?e.forceAverage="thousand":t.indexOf("M")!==-1?e.forceAverage="million":t.indexOf("B")!==-1?e.forceAverage="billion":t.indexOf("T")!==-1&&(e.forceAverage="trillion")}function ZCe(t,e){t.match(/\[\.]/)?e.optionalMantissa=!0:t.match(/\./)&&(e.optionalMantissa=!1)}function JCe(t,e){if(t.indexOf(".")!==-1){let r=t.split(".")[0];e.optionalCharacteristic=r.indexOf("0")===-1}}function exe(t,e){t.match(/^\+?\([^)]*\)$/)&&(e.negative="parenthesis"),t.match(/^\+?-/)&&(e.negative="sign")}function txe(t,e){t.match(/^\+/)&&(e.forceSign=!0)}function rxe(t,e={}){return typeof t!="string"?t:(t=WCe(t,e),t=$Ce(t,e),UCe(t,e),zCe(t,e),GCe(t,e),JCe(t,e),XCe(t,e),QCe(t,e),qCe(t,e),ZCe(t,e),KCe(t,e),jCe(t,e),YCe(t,e),exe(t,e),txe(t,e),e)}var G4={parseFormat:rxe};/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var H2,$7;function q4(){if($7)return H2;$7=1;const t=VCe(),e=z4(),r=G4;let n={},i,s={},a=null,o={};function u(f){i=f}function c(){return s[i]}return n.languages=()=>Object.assign({},s),n.currentLanguage=()=>i,n.currentBytes=()=>c().bytes||{},n.currentCurrency=()=>c().currency,n.currentAbbreviations=()=>c().abbreviations,n.currentDelimiters=()=>c().delimiters,n.currentOrdinal=()=>c().ordinal,n.currentDefaults=()=>Object.assign({},c().defaults,o),n.currentOrdinalDefaultFormat=()=>Object.assign({},n.currentDefaults(),c().ordinalFormat),n.currentByteDefaultFormat=()=>Object.assign({},n.currentDefaults(),c().byteFormat),n.currentPercentageDefaultFormat=()=>Object.assign({},n.currentDefaults(),c().percentageFormat),n.currentCurrencyDefaultFormat=()=>Object.assign({},n.currentDefaults(),c().currencyFormat),n.currentTimeDefaultFormat=()=>Object.assign({},n.currentDefaults(),c().timeFormat),n.setDefaults=f=>{f=r.parseFormat(f),e.validateFormat(f)&&(o=f)},n.getZeroFormat=()=>a,n.setZeroFormat=f=>a=typeof f=="string"?f:null,n.hasZeroFormat=()=>a!==null,n.languageData=f=>{if(f){if(s[f])return s[f];throw new Error(`Unknown tag "${f}"`)}return c()},n.registerLanguage=(f,g=!1)=>{if(!e.validateLanguage(f))throw new Error("Invalid language data");s[f.languageTag]=f,g&&u(f.languageTag)},n.setLanguage=(f,g=t.languageTag)=>{if(!s[f]){let m=f.split("-")[0],v=Object.keys(s).find(w=>w.split("-")[0]===m);if(!s[v]){u(g);return}u(v);return}u(f)},n.registerLanguage(t),i=t.languageTag,H2=n,H2}function nxe(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */function ixe(t,e){t.forEach(r=>{let n;try{n=nxe(`../languages/${r}`)}catch{console.error(`Unable to load "${r}". No matching language file found.`)}n&&e.registerLanguage(n)})}var sxe=t=>({loadLanguagesInNode:e=>ixe(e,t)}),lJ={exports:{}};(function(t){(function(e){var r,n=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,i=Math.ceil,s=Math.floor,a="[BigNumber Error] ",o=a+"Number primitive has more than 15 significant digits: ",u=1e14,c=14,f=9007199254740991,g=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],m=1e7,v=1e9;function w(O){var A,W,L,H=R.prototype={constructor:R,toString:null,valueOf:null},J=new R(1),G=20,ve=4,be=-7,we=21,ae=-1e7,le=1e7,Te=!1,ce=1,K=0,Se={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:" ",suffix:""},B="0123456789abcdefghijklmnopqrstuvwxyz",E=!0;function R(I,U){var k,ee,oe,de,pe,Q,ge,xe,_e=this;if(!(_e instanceof R))return new R(I,U);if(U==null){if(I&&I._isBigNumber===!0){_e.s=I.s,!I.c||I.e>le?_e.c=_e.e=null:I.e<ae?_e.c=[_e.e=0]:(_e.e=I.e,_e.c=I.c.slice());return}if((Q=typeof I=="number")&&I*0==0){if(_e.s=1/I<0?(I=-I,-1):1,I===~~I){for(de=0,pe=I;pe>=10;pe/=10,de++);de>le?_e.c=_e.e=null:(_e.e=de,_e.c=[I]);return}xe=String(I)}else{if(!n.test(xe=String(I)))return L(_e,xe,Q);_e.s=xe.charCodeAt(0)==45?(xe=xe.slice(1),-1):1}(de=xe.indexOf("."))>-1&&(xe=xe.replace(".","")),(pe=xe.search(/e/i))>0?(de<0&&(de=pe),de+=+xe.slice(pe+1),xe=xe.substring(0,pe)):de<0&&(de=xe.length)}else{if(_(U,2,B.length,"Base"),U==10&&E)return _e=new R(I),te(_e,G+_e.e+1,ve);if(xe=String(I),Q=typeof I=="number"){if(I*0!=0)return L(_e,xe,Q,U);if(_e.s=1/I<0?(xe=xe.slice(1),-1):1,R.DEBUG&&xe.replace(/^0\.0*|\./,"").length>15)throw Error(o+I)}else _e.s=xe.charCodeAt(0)===45?(xe=xe.slice(1),-1):1;for(k=B.slice(0,U),de=pe=0,ge=xe.length;pe<ge;pe++)if(k.indexOf(ee=xe.charAt(pe))<0){if(ee=="."){if(pe>de){de=ge;continue}}else if(!oe&&(xe==xe.toUpperCase()&&(xe=xe.toLowerCase())||xe==xe.toLowerCase()&&(xe=xe.toUpperCase()))){oe=!0,pe=-1,de=0;continue}return L(_e,String(I),Q,U)}Q=!1,xe=W(xe,U,10,_e.s),(de=xe.indexOf("."))>-1?xe=xe.replace(".",""):de=xe.length}for(pe=0;xe.charCodeAt(pe)===48;pe++);for(ge=xe.length;xe.charCodeAt(--ge)===48;);if(xe=xe.slice(pe,++ge)){if(ge-=pe,Q&&R.DEBUG&&ge>15&&(I>f||I!==s(I)))throw Error(o+_e.s*I);if((de=de-pe-1)>le)_e.c=_e.e=null;else if(de<ae)_e.c=[_e.e=0];else{if(_e.e=de,_e.c=[],pe=(de+1)%c,de<0&&(pe+=c),pe<ge){for(pe&&_e.c.push(+xe.slice(0,pe)),ge-=c;pe<ge;)_e.c.push(+xe.slice(pe,pe+=c));pe=c-(xe=xe.slice(pe)).length}else pe-=ge;for(;pe--;xe+="0");_e.c.push(+xe)}}else _e.c=[_e.e=0]}R.clone=w,R.ROUND_UP=0,R.ROUND_DOWN=1,R.ROUND_CEIL=2,R.ROUND_FLOOR=3,R.ROUND_HALF_UP=4,R.ROUND_HALF_DOWN=5,R.ROUND_HALF_EVEN=6,R.ROUND_HALF_CEIL=7,R.ROUND_HALF_FLOOR=8,R.EUCLID=9,R.config=R.set=function(I){var U,k;if(I!=null)if(typeof I=="object"){if(I.hasOwnProperty(U="DECIMAL_PLACES")&&(k=I[U],_(k,0,v,U),G=k),I.hasOwnProperty(U="ROUNDING_MODE")&&(k=I[U],_(k,0,8,U),ve=k),I.hasOwnProperty(U="EXPONENTIAL_AT")&&(k=I[U],k&&k.pop?(_(k[0],-v,0,U),_(k[1],0,v,U),be=k[0],we=k[1]):(_(k,-v,v,U),be=-(we=k<0?-k:k))),I.hasOwnProperty(U="RANGE"))if(k=I[U],k&&k.pop)_(k[0],-v,-1,U),_(k[1],1,v,U),ae=k[0],le=k[1];else if(_(k,-v,v,U),k)ae=-(le=k<0?-k:k);else throw Error(a+U+" cannot be zero: "+k);if(I.hasOwnProperty(U="CRYPTO"))if(k=I[U],k===!!k)if(k)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))Te=k;else throw Te=!k,Error(a+"crypto unavailable");else Te=k;else throw Error(a+U+" not true or false: "+k);if(I.hasOwnProperty(U="MODULO_MODE")&&(k=I[U],_(k,0,9,U),ce=k),I.hasOwnProperty(U="POW_PRECISION")&&(k=I[U],_(k,0,v,U),K=k),I.hasOwnProperty(U="FORMAT"))if(k=I[U],typeof k=="object")Se=k;else throw Error(a+U+" not an object: "+k);if(I.hasOwnProperty(U="ALPHABET"))if(k=I[U],typeof k=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(k))E=k.slice(0,10)=="0123456789",B=k;else throw Error(a+U+" invalid: "+k)}else throw Error(a+"Object expected: "+I);return{DECIMAL_PLACES:G,ROUNDING_MODE:ve,EXPONENTIAL_AT:[be,we],RANGE:[ae,le],CRYPTO:Te,MODULO_MODE:ce,POW_PRECISION:K,FORMAT:Se,ALPHABET:B}},R.isBigNumber=function(I){if(!I||I._isBigNumber!==!0)return!1;if(!R.DEBUG)return!0;var U,k,ee=I.c,oe=I.e,de=I.s;e:if({}.toString.call(ee)=="[object Array]"){if((de===1||de===-1)&&oe>=-v&&oe<=v&&oe===s(oe)){if(ee[0]===0){if(oe===0&&ee.length===1)return!0;break e}if(U=(oe+1)%c,U<1&&(U+=c),String(ee[0]).length==U){for(U=0;U<ee.length;U++)if(k=ee[U],k<0||k>=u||k!==s(k))break e;if(k!==0)return!0}}}else if(ee===null&&oe===null&&(de===null||de===1||de===-1))return!0;throw Error(a+"Invalid BigNumber: "+I)},R.maximum=R.max=function(){return F(arguments,-1)},R.minimum=R.min=function(){return F(arguments,1)},R.random=function(){var I=9007199254740992,U=Math.random()*I&2097151?function(){return s(Math.random()*I)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(k){var ee,oe,de,pe,Q,ge=0,xe=[],_e=new R(J);if(k==null?k=G:_(k,0,v),pe=i(k/c),Te)if(crypto.getRandomValues){for(ee=crypto.getRandomValues(new Uint32Array(pe*=2));ge<pe;)Q=ee[ge]*131072+(ee[ge+1]>>>11),Q>=9e15?(oe=crypto.getRandomValues(new Uint32Array(2)),ee[ge]=oe[0],ee[ge+1]=oe[1]):(xe.push(Q%1e14),ge+=2);ge=pe/2}else if(crypto.randomBytes){for(ee=crypto.randomBytes(pe*=7);ge<pe;)Q=(ee[ge]&31)*281474976710656+ee[ge+1]*1099511627776+ee[ge+2]*4294967296+ee[ge+3]*16777216+(ee[ge+4]<<16)+(ee[ge+5]<<8)+ee[ge+6],Q>=9e15?crypto.randomBytes(7).copy(ee,ge):(xe.push(Q%1e14),ge+=7);ge=pe/7}else throw Te=!1,Error(a+"crypto unavailable");if(!Te)for(;ge<pe;)Q=U(),Q<9e15&&(xe[ge++]=Q%1e14);for(pe=xe[--ge],k%=c,pe&&k&&(Q=g[c-k],xe[ge]=s(pe/Q)*Q);xe[ge]===0;xe.pop(),ge--);if(ge<0)xe=[de=0];else{for(de=-1;xe[0]===0;xe.splice(0,1),de-=c);for(ge=1,Q=xe[0];Q>=10;Q/=10,ge++);ge<c&&(de-=c-ge)}return _e.e=de,_e.c=xe,_e}}(),R.sum=function(){for(var I=1,U=arguments,k=new R(U[0]);I<U.length;)k=k.plus(U[I++]);return k},W=function(){var I="0123456789";function U(k,ee,oe,de){for(var pe,Q=[0],ge,xe=0,_e=k.length;xe<_e;){for(ge=Q.length;ge--;Q[ge]*=ee);for(Q[0]+=de.indexOf(k.charAt(xe++)),pe=0;pe<Q.length;pe++)Q[pe]>oe-1&&(Q[pe+1]==null&&(Q[pe+1]=0),Q[pe+1]+=Q[pe]/oe|0,Q[pe]%=oe)}return Q.reverse()}return function(k,ee,oe,de,pe){var Q,ge,xe,_e,Ne,Xe,Qe,ht,Mt=k.indexOf("."),Et=G,at=ve;for(Mt>=0&&(_e=K,K=0,k=k.replace(".",""),ht=new R(ee),Xe=ht.pow(k.length-Mt),K=_e,ht.c=U(P(b(Xe.c),Xe.e,"0"),10,oe,I),ht.e=ht.c.length),Qe=U(k,ee,oe,pe?(Q=B,I):(Q=I,B)),xe=_e=Qe.length;Qe[--_e]==0;Qe.pop());if(!Qe[0])return Q.charAt(0);if(Mt<0?--xe:(Xe.c=Qe,Xe.e=xe,Xe.s=de,Xe=A(Xe,ht,Et,at,oe),Qe=Xe.c,Ne=Xe.r,xe=Xe.e),ge=xe+Et+1,Mt=Qe[ge],_e=oe/2,Ne=Ne||ge<0||Qe[ge+1]!=null,Ne=at<4?(Mt!=null||Ne)&&(at==0||at==(Xe.s<0?3:2)):Mt>_e||Mt==_e&&(at==4||Ne||at==6&&Qe[ge-1]&1||at==(Xe.s<0?8:7)),ge<1||!Qe[0])k=Ne?P(Q.charAt(1),-Et,Q.charAt(0)):Q.charAt(0);else{if(Qe.length=ge,Ne)for(--oe;++Qe[--ge]>oe;)Qe[ge]=0,ge||(++xe,Qe=[1].concat(Qe));for(_e=Qe.length;!Qe[--_e];);for(Mt=0,k="";Mt<=_e;k+=Q.charAt(Qe[Mt++]));k=P(k,xe,Q.charAt(0))}return k}}(),A=function(){function I(ee,oe,de){var pe,Q,ge,xe,_e=0,Ne=ee.length,Xe=oe%m,Qe=oe/m|0;for(ee=ee.slice();Ne--;)ge=ee[Ne]%m,xe=ee[Ne]/m|0,pe=Qe*ge+xe*Xe,Q=Xe*ge+pe%m*m+_e,_e=(Q/de|0)+(pe/m|0)+Qe*xe,ee[Ne]=Q%de;return _e&&(ee=[_e].concat(ee)),ee}function U(ee,oe,de,pe){var Q,ge;if(de!=pe)ge=de>pe?1:-1;else for(Q=ge=0;Q<de;Q++)if(ee[Q]!=oe[Q]){ge=ee[Q]>oe[Q]?1:-1;break}return ge}function k(ee,oe,de,pe){for(var Q=0;de--;)ee[de]-=Q,Q=ee[de]<oe[de]?1:0,ee[de]=Q*pe+ee[de]-oe[de];for(;!ee[0]&&ee.length>1;ee.splice(0,1));}return function(ee,oe,de,pe,Q){var ge,xe,_e,Ne,Xe,Qe,ht,Mt,Et,at,nt,pt,yt,pr,sn,Dt,Kt,or=ee.s==oe.s?1:-1,vr=ee.c,$t=oe.c;if(!vr||!vr[0]||!$t||!$t[0])return new R(!ee.s||!oe.s||(vr?$t&&vr[0]==$t[0]:!$t)?NaN:vr&&vr[0]==0||!$t?or*0:or/0);for(Mt=new R(or),Et=Mt.c=[],xe=ee.e-oe.e,or=de+xe+1,Q||(Q=u,xe=y(ee.e/c)-y(oe.e/c),or=or/c|0),_e=0;$t[_e]==(vr[_e]||0);_e++);if($t[_e]>(vr[_e]||0)&&xe--,or<0)Et.push(1),Ne=!0;else{for(pr=vr.length,Dt=$t.length,_e=0,or+=2,Xe=s(Q/($t[0]+1)),Xe>1&&($t=I($t,Xe,Q),vr=I(vr,Xe,Q),Dt=$t.length,pr=vr.length),yt=Dt,at=vr.slice(0,Dt),nt=at.length;nt<Dt;at[nt++]=0);Kt=$t.slice(),Kt=[0].concat(Kt),sn=$t[0],$t[1]>=Q/2&&sn++;do{if(Xe=0,ge=U($t,at,Dt,nt),ge<0){if(pt=at[0],Dt!=nt&&(pt=pt*Q+(at[1]||0)),Xe=s(pt/sn),Xe>1)for(Xe>=Q&&(Xe=Q-1),Qe=I($t,Xe,Q),ht=Qe.length,nt=at.length;U(Qe,at,ht,nt)==1;)Xe--,k(Qe,Dt<ht?Kt:$t,ht,Q),ht=Qe.length,ge=1;else Xe==0&&(ge=Xe=1),Qe=$t.slice(),ht=Qe.length;if(ht<nt&&(Qe=[0].concat(Qe)),k(at,Qe,nt,Q),nt=at.length,ge==-1)for(;U($t,at,Dt,nt)<1;)Xe++,k(at,Dt<nt?Kt:$t,nt,Q),nt=at.length}else ge===0&&(Xe++,at=[0]);Et[_e++]=Xe,at[0]?at[nt++]=vr[yt]||0:(at=[vr[yt]],nt=1)}while((yt++<pr||at[0]!=null)&&or--);Ne=at[0]!=null,Et[0]||Et.splice(0,1)}if(Q==u){for(_e=1,or=Et[0];or>=10;or/=10,_e++);te(Mt,de+(Mt.e=_e+xe*c-1)+1,pe,Ne)}else Mt.e=xe,Mt.r=+Ne;return Mt}}();function M(I,U,k,ee){var oe,de,pe,Q,ge;if(k==null?k=ve:_(k,0,8),!I.c)return I.toString();if(oe=I.c[0],pe=I.e,U==null)ge=b(I.c),ge=ee==1||ee==2&&(pe<=be||pe>=we)?D(ge,pe):P(ge,pe,"0");else if(I=te(new R(I),U,k),de=I.e,ge=b(I.c),Q=ge.length,ee==1||ee==2&&(U<=de||de<=be)){for(;Q<U;ge+="0",Q++);ge=D(ge,de)}else if(U-=pe,ge=P(ge,de,"0"),de+1>Q){if(--U>0)for(ge+=".";U--;ge+="0");}else if(U+=de-Q,U>0)for(de+1==Q&&(ge+=".");U--;ge+="0");return I.s<0&&oe?"-"+ge:ge}function F(I,U){for(var k,ee,oe=1,de=new R(I[0]);oe<I.length;oe++)ee=new R(I[oe]),(!ee.s||(k=x(de,ee))===U||k===0&&de.s===U)&&(de=ee);return de}function Z(I,U,k){for(var ee=1,oe=U.length;!U[--oe];U.pop());for(oe=U[0];oe>=10;oe/=10,ee++);return(k=ee+k*c-1)>le?I.c=I.e=null:k<ae?I.c=[I.e=0]:(I.e=k,I.c=U),I}L=function(){var I=/^(-?)0([xbo])(?=\w[\w.]*$)/i,U=/^([^.]+)\.$/,k=/^\.([^.]+)$/,ee=/^-?(Infinity|NaN)$/,oe=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(de,pe,Q,ge){var xe,_e=Q?pe:pe.replace(oe,"");if(ee.test(_e))de.s=isNaN(_e)?null:_e<0?-1:1;else{if(!Q&&(_e=_e.replace(I,function(Ne,Xe,Qe){return xe=(Qe=Qe.toLowerCase())=="x"?16:Qe=="b"?2:8,!ge||ge==xe?Xe:Ne}),ge&&(xe=ge,_e=_e.replace(U,"$1").replace(k,"0.$1")),pe!=_e))return new R(_e,xe);if(R.DEBUG)throw Error(a+"Not a"+(ge?" base "+ge:"")+" number: "+pe);de.s=null}de.c=de.e=null}}();function te(I,U,k,ee){var oe,de,pe,Q,ge,xe,_e,Ne=I.c,Xe=g;if(Ne){e:{for(oe=1,Q=Ne[0];Q>=10;Q/=10,oe++);if(de=U-oe,de<0)de+=c,pe=U,ge=Ne[xe=0],_e=s(ge/Xe[oe-pe-1]%10);else if(xe=i((de+1)/c),xe>=Ne.length)if(ee){for(;Ne.length<=xe;Ne.push(0));ge=_e=0,oe=1,de%=c,pe=de-c+1}else break e;else{for(ge=Q=Ne[xe],oe=1;Q>=10;Q/=10,oe++);de%=c,pe=de-c+oe,_e=pe<0?0:s(ge/Xe[oe-pe-1]%10)}if(ee=ee||U<0||Ne[xe+1]!=null||(pe<0?ge:ge%Xe[oe-pe-1]),ee=k<4?(_e||ee)&&(k==0||k==(I.s<0?3:2)):_e>5||_e==5&&(k==4||ee||k==6&&(de>0?pe>0?ge/Xe[oe-pe]:0:Ne[xe-1])%10&1||k==(I.s<0?8:7)),U<1||!Ne[0])return Ne.length=0,ee?(U-=I.e+1,Ne[0]=Xe[(c-U%c)%c],I.e=-U||0):Ne[0]=I.e=0,I;if(de==0?(Ne.length=xe,Q=1,xe--):(Ne.length=xe+1,Q=Xe[c-de],Ne[xe]=pe>0?s(ge/Xe[oe-pe]%Xe[pe])*Q:0),ee)for(;;)if(xe==0){for(de=1,pe=Ne[0];pe>=10;pe/=10,de++);for(pe=Ne[0]+=Q,Q=1;pe>=10;pe/=10,Q++);de!=Q&&(I.e++,Ne[0]==u&&(Ne[0]=1));break}else{if(Ne[xe]+=Q,Ne[xe]!=u)break;Ne[xe--]=0,Q=1}for(de=Ne.length;Ne[--de]===0;Ne.pop());}I.e>le?I.c=I.e=null:I.e<ae&&(I.c=[I.e=0])}return I}function fe(I){var U,k=I.e;return k===null?I.toString():(U=b(I.c),U=k<=be||k>=we?D(U,k):P(U,k,"0"),I.s<0?"-"+U:U)}return H.absoluteValue=H.abs=function(){var I=new R(this);return I.s<0&&(I.s=1),I},H.comparedTo=function(I,U){return x(this,new R(I,U))},H.decimalPlaces=H.dp=function(I,U){var k,ee,oe,de=this;if(I!=null)return _(I,0,v),U==null?U=ve:_(U,0,8),te(new R(de),I+de.e+1,U);if(!(k=de.c))return null;if(ee=((oe=k.length-1)-y(this.e/c))*c,oe=k[oe])for(;oe%10==0;oe/=10,ee--);return ee<0&&(ee=0),ee},H.dividedBy=H.div=function(I,U){return A(this,new R(I,U),G,ve)},H.dividedToIntegerBy=H.idiv=function(I,U){return A(this,new R(I,U),0,1)},H.exponentiatedBy=H.pow=function(I,U){var k,ee,oe,de,pe,Q,ge,xe,_e,Ne=this;if(I=new R(I),I.c&&!I.isInteger())throw Error(a+"Exponent not an integer: "+fe(I));if(U!=null&&(U=new R(U)),Q=I.e>14,!Ne.c||!Ne.c[0]||Ne.c[0]==1&&!Ne.e&&Ne.c.length==1||!I.c||!I.c[0])return _e=new R(Math.pow(+fe(Ne),Q?I.s*(2-T(I)):+fe(I))),U?_e.mod(U):_e;if(ge=I.s<0,U){if(U.c?!U.c[0]:!U.s)return new R(NaN);ee=!ge&&Ne.isInteger()&&U.isInteger(),ee&&(Ne=Ne.mod(U))}else{if(I.e>9&&(Ne.e>0||Ne.e<-1||(Ne.e==0?Ne.c[0]>1||Q&&Ne.c[1]>=24e7:Ne.c[0]<8e13||Q&&Ne.c[0]<=9999975e7)))return de=Ne.s<0&&T(I)?-0:0,Ne.e>-1&&(de=1/de),new R(ge?1/de:de);K&&(de=i(K/c+2))}for(Q?(k=new R(.5),ge&&(I.s=1),xe=T(I)):(oe=Math.abs(+fe(I)),xe=oe%2),_e=new R(J);;){if(xe){if(_e=_e.times(Ne),!_e.c)break;de?_e.c.length>de&&(_e.c.length=de):ee&&(_e=_e.mod(U))}if(oe){if(oe=s(oe/2),oe===0)break;xe=oe%2}else if(I=I.times(k),te(I,I.e+1,1),I.e>14)xe=T(I);else{if(oe=+fe(I),oe===0)break;xe=oe%2}Ne=Ne.times(Ne),de?Ne.c&&Ne.c.length>de&&(Ne.c.length=de):ee&&(Ne=Ne.mod(U))}return ee?_e:(ge&&(_e=J.div(_e)),U?_e.mod(U):de?te(_e,K,ve,pe):_e)},H.integerValue=function(I){var U=new R(this);return I==null?I=ve:_(I,0,8),te(U,U.e+1,I)},H.isEqualTo=H.eq=function(I,U){return x(this,new R(I,U))===0},H.isFinite=function(){return!!this.c},H.isGreaterThan=H.gt=function(I,U){return x(this,new R(I,U))>0},H.isGreaterThanOrEqualTo=H.gte=function(I,U){return(U=x(this,new R(I,U)))===1||U===0},H.isInteger=function(){return!!this.c&&y(this.e/c)>this.c.length-2},H.isLessThan=H.lt=function(I,U){return x(this,new R(I,U))<0},H.isLessThanOrEqualTo=H.lte=function(I,U){return(U=x(this,new R(I,U)))===-1||U===0},H.isNaN=function(){return!this.s},H.isNegative=function(){return this.s<0},H.isPositive=function(){return this.s>0},H.isZero=function(){return!!this.c&&this.c[0]==0},H.minus=function(I,U){var k,ee,oe,de,pe=this,Q=pe.s;if(I=new R(I,U),U=I.s,!Q||!U)return new R(NaN);if(Q!=U)return I.s=-U,pe.plus(I);var ge=pe.e/c,xe=I.e/c,_e=pe.c,Ne=I.c;if(!ge||!xe){if(!_e||!Ne)return _e?(I.s=-U,I):new R(Ne?pe:NaN);if(!_e[0]||!Ne[0])return Ne[0]?(I.s=-U,I):new R(_e[0]?pe:ve==3?-0:0)}if(ge=y(ge),xe=y(xe),_e=_e.slice(),Q=ge-xe){for((de=Q<0)?(Q=-Q,oe=_e):(xe=ge,oe=Ne),oe.reverse(),U=Q;U--;oe.push(0));oe.reverse()}else for(ee=(de=(Q=_e.length)<(U=Ne.length))?Q:U,Q=U=0;U<ee;U++)if(_e[U]!=Ne[U]){de=_e[U]<Ne[U];break}if(de&&(oe=_e,_e=Ne,Ne=oe,I.s=-I.s),U=(ee=Ne.length)-(k=_e.length),U>0)for(;U--;_e[k++]=0);for(U=u-1;ee>Q;){if(_e[--ee]<Ne[ee]){for(k=ee;k&&!_e[--k];_e[k]=U);--_e[k],_e[ee]+=u}_e[ee]-=Ne[ee]}for(;_e[0]==0;_e.splice(0,1),--xe);return _e[0]?Z(I,_e,xe):(I.s=ve==3?-1:1,I.c=[I.e=0],I)},H.modulo=H.mod=function(I,U){var k,ee,oe=this;return I=new R(I,U),!oe.c||!I.s||I.c&&!I.c[0]?new R(NaN):!I.c||oe.c&&!oe.c[0]?new R(oe):(ce==9?(ee=I.s,I.s=1,k=A(oe,I,0,3),I.s=ee,k.s*=ee):k=A(oe,I,0,ce),I=oe.minus(k.times(I)),!I.c[0]&&ce==1&&(I.s=oe.s),I)},H.multipliedBy=H.times=function(I,U){var k,ee,oe,de,pe,Q,ge,xe,_e,Ne,Xe,Qe,ht,Mt,Et,at=this,nt=at.c,pt=(I=new R(I,U)).c;if(!nt||!pt||!nt[0]||!pt[0])return!at.s||!I.s||nt&&!nt[0]&&!pt||pt&&!pt[0]&&!nt?I.c=I.e=I.s=null:(I.s*=at.s,!nt||!pt?I.c=I.e=null:(I.c=[0],I.e=0)),I;for(ee=y(at.e/c)+y(I.e/c),I.s*=at.s,ge=nt.length,Ne=pt.length,ge<Ne&&(ht=nt,nt=pt,pt=ht,oe=ge,ge=Ne,Ne=oe),oe=ge+Ne,ht=[];oe--;ht.push(0));for(Mt=u,Et=m,oe=Ne;--oe>=0;){for(k=0,Xe=pt[oe]%Et,Qe=pt[oe]/Et|0,pe=ge,de=oe+pe;de>oe;)xe=nt[--pe]%Et,_e=nt[pe]/Et|0,Q=Qe*xe+_e*Xe,xe=Xe*xe+Q%Et*Et+ht[de]+k,k=(xe/Mt|0)+(Q/Et|0)+Qe*_e,ht[de--]=xe%Mt;ht[de]=k}return k?++ee:ht.splice(0,1),Z(I,ht,ee)},H.negated=function(){var I=new R(this);return I.s=-I.s||null,I},H.plus=function(I,U){var k,ee=this,oe=ee.s;if(I=new R(I,U),U=I.s,!oe||!U)return new R(NaN);if(oe!=U)return I.s=-U,ee.minus(I);var de=ee.e/c,pe=I.e/c,Q=ee.c,ge=I.c;if(!de||!pe){if(!Q||!ge)return new R(oe/0);if(!Q[0]||!ge[0])return ge[0]?I:new R(Q[0]?ee:oe*0)}if(de=y(de),pe=y(pe),Q=Q.slice(),oe=de-pe){for(oe>0?(pe=de,k=ge):(oe=-oe,k=Q),k.reverse();oe--;k.push(0));k.reverse()}for(oe=Q.length,U=ge.length,oe-U<0&&(k=ge,ge=Q,Q=k,U=oe),oe=0;U;)oe=(Q[--U]=Q[U]+ge[U]+oe)/u|0,Q[U]=u===Q[U]?0:Q[U]%u;return oe&&(Q=[oe].concat(Q),++pe),Z(I,Q,pe)},H.precision=H.sd=function(I,U){var k,ee,oe,de=this;if(I!=null&&I!==!!I)return _(I,1,v),U==null?U=ve:_(U,0,8),te(new R(de),I,U);if(!(k=de.c))return null;if(oe=k.length-1,ee=oe*c+1,oe=k[oe]){for(;oe%10==0;oe/=10,ee--);for(oe=k[0];oe>=10;oe/=10,ee++);}return I&&de.e+1>ee&&(ee=de.e+1),ee},H.shiftedBy=function(I){return _(I,-f,f),this.times("1e"+I)},H.squareRoot=H.sqrt=function(){var I,U,k,ee,oe,de=this,pe=de.c,Q=de.s,ge=de.e,xe=G+4,_e=new R("0.5");if(Q!==1||!pe||!pe[0])return new R(!Q||Q<0&&(!pe||pe[0])?NaN:pe?de:1/0);if(Q=Math.sqrt(+fe(de)),Q==0||Q==1/0?(U=b(pe),(U.length+ge)%2==0&&(U+="0"),Q=Math.sqrt(+U),ge=y((ge+1)/2)-(ge<0||ge%2),Q==1/0?U="5e"+ge:(U=Q.toExponential(),U=U.slice(0,U.indexOf("e")+1)+ge),k=new R(U)):k=new R(Q+""),k.c[0]){for(ge=k.e,Q=ge+xe,Q<3&&(Q=0);;)if(oe=k,k=_e.times(oe.plus(A(de,oe,xe,1))),b(oe.c).slice(0,Q)===(U=b(k.c)).slice(0,Q))if(k.e<ge&&--Q,U=U.slice(Q-3,Q+1),U=="9999"||!ee&&U=="4999"){if(!ee&&(te(oe,oe.e+G+2,0),oe.times(oe).eq(de))){k=oe;break}xe+=4,Q+=4,ee=1}else{(!+U||!+U.slice(1)&&U.charAt(0)=="5")&&(te(k,k.e+G+2,1),I=!k.times(k).eq(de));break}}return te(k,k.e+G+1,ve,I)},H.toExponential=function(I,U){return I!=null&&(_(I,0,v),I++),M(this,I,U,1)},H.toFixed=function(I,U){return I!=null&&(_(I,0,v),I=I+this.e+1),M(this,I,U)},H.toFormat=function(I,U,k){var ee,oe=this;if(k==null)I!=null&&U&&typeof U=="object"?(k=U,U=null):I&&typeof I=="object"?(k=I,I=U=null):k=Se;else if(typeof k!="object")throw Error(a+"Argument not an object: "+k);if(ee=oe.toFixed(I,U),oe.c){var de,pe=ee.split("."),Q=+k.groupSize,ge=+k.secondaryGroupSize,xe=k.groupSeparator||"",_e=pe[0],Ne=pe[1],Xe=oe.s<0,Qe=Xe?_e.slice(1):_e,ht=Qe.length;if(ge&&(de=Q,Q=ge,ge=de,ht-=de),Q>0&&ht>0){for(de=ht%Q||Q,_e=Qe.substr(0,de);de<ht;de+=Q)_e+=xe+Qe.substr(de,Q);ge>0&&(_e+=xe+Qe.slice(de)),Xe&&(_e="-"+_e)}ee=Ne?_e+(k.decimalSeparator||"")+((ge=+k.fractionGroupSize)?Ne.replace(new RegExp("\\d{"+ge+"}\\B","g"),"$&"+(k.fractionGroupSeparator||"")):Ne):_e}return(k.prefix||"")+ee+(k.suffix||"")},H.toFraction=function(I){var U,k,ee,oe,de,pe,Q,ge,xe,_e,Ne,Xe,Qe=this,ht=Qe.c;if(I!=null&&(Q=new R(I),!Q.isInteger()&&(Q.c||Q.s!==1)||Q.lt(J)))throw Error(a+"Argument "+(Q.isInteger()?"out of range: ":"not an integer: ")+fe(Q));if(!ht)return new R(Qe);for(U=new R(J),xe=k=new R(J),ee=ge=new R(J),Xe=b(ht),de=U.e=Xe.length-Qe.e-1,U.c[0]=g[(pe=de%c)<0?c+pe:pe],I=!I||Q.comparedTo(U)>0?de>0?U:xe:Q,pe=le,le=1/0,Q=new R(Xe),ge.c[0]=0;_e=A(Q,U,0,1),oe=k.plus(_e.times(ee)),oe.comparedTo(I)!=1;)k=ee,ee=oe,xe=ge.plus(_e.times(oe=xe)),ge=oe,U=Q.minus(_e.times(oe=U)),Q=oe;return oe=A(I.minus(k),ee,0,1),ge=ge.plus(oe.times(xe)),k=k.plus(oe.times(ee)),ge.s=xe.s=Qe.s,de=de*2,Ne=A(xe,ee,de,ve).minus(Qe).abs().comparedTo(A(ge,k,de,ve).minus(Qe).abs())<1?[xe,ee]:[ge,k],le=pe,Ne},H.toNumber=function(){return+fe(this)},H.toPrecision=function(I,U){return I!=null&&_(I,1,v),M(this,I,U,2)},H.toString=function(I){var U,k=this,ee=k.s,oe=k.e;return oe===null?ee?(U="Infinity",ee<0&&(U="-"+U)):U="NaN":(I==null?U=oe<=be||oe>=we?D(b(k.c),oe):P(b(k.c),oe,"0"):I===10&&E?(k=te(new R(k),G+oe+1,ve),U=P(b(k.c),k.e,"0")):(_(I,2,B.length,"Base"),U=W(P(b(k.c),oe,"0"),10,I,ee,!0)),ee<0&&k.c[0]&&(U="-"+U)),U},H.valueOf=H.toJSON=function(){return fe(this)},H._isBigNumber=!0,O!=null&&R.set(O),R}function y(O){var A=O|0;return O>0||O===A?A:A-1}function b(O){for(var A,W,L=1,H=O.length,J=O[0]+"";L<H;){for(A=O[L++]+"",W=c-A.length;W--;A="0"+A);J+=A}for(H=J.length;J.charCodeAt(--H)===48;);return J.slice(0,H+1||1)}function x(O,A){var W,L,H=O.c,J=A.c,G=O.s,ve=A.s,be=O.e,we=A.e;if(!G||!ve)return null;if(W=H&&!H[0],L=J&&!J[0],W||L)return W?L?0:-ve:G;if(G!=ve)return G;if(W=G<0,L=be==we,!H||!J)return L?0:!H^W?1:-1;if(!L)return be>we^W?1:-1;for(ve=(be=H.length)<(we=J.length)?be:we,G=0;G<ve;G++)if(H[G]!=J[G])return H[G]>J[G]^W?1:-1;return be==we?0:be>we^W?1:-1}function _(O,A,W,L){if(O<A||O>W||O!==s(O))throw Error(a+(L||"Argument")+(typeof O=="number"?O<A||O>W?" out of range: ":" not an integer: ":" not a primitive number: ")+String(O))}function T(O){var A=O.c.length-1;return y(O.e/c)==A&&O.c[A]%2!=0}function D(O,A){return(O.length>1?O.charAt(0)+"."+O.slice(1):O)+(A<0?"e":"e+")+A}function P(O,A,W){var L,H;if(A<0){for(H=W+".";++A;H+=W);O=H+O}else if(L=O.length,++A>L){for(H=W,A-=L;--A;H+=W);O+=H}else A<L&&(O=O.slice(0,A)+"."+O.slice(A));return O}r=w(),r.default=r.BigNumber=r,t.exports?t.exports=r:(e||(e=typeof self<"u"&&self?self:window),e.BigNumber=r)})(LCe)})(lJ);var uJ=lJ.exports;/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */const wl=q4(),axe=z4(),oxe=G4,lxe=uJ,Zi={trillion:Math.pow(10,12),billion:Math.pow(10,9),million:Math.pow(10,6),thousand:Math.pow(10,3)},AS={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1,roundingFunction:Math.round,spaceSeparatedAbbreviation:!1},{binarySuffixes:cJ,decimalSuffixes:l_}=wl.currentBytes(),K4={general:{scale:1024,suffixes:l_},binary:{scale:1024,suffixes:cJ},decimal:{scale:1e3,suffixes:l_}};function uxe(t,e={},r){if(typeof e=="string"&&(e=oxe.parseFormat(e)),!axe.validateFormat(e))return"ERROR: invalid format";let i=e.prefix||"",s=e.postfix||"",a=cxe(t,e,r);return a=Axe(a,i),a=Oxe(a,s),a}function cxe(t,e,r){switch(e.output){case"currency":return e=z0(e,wl.currentCurrencyDefaultFormat()),wxe(t,e,wl);case"percent":return e=z0(e,wl.currentPercentageDefaultFormat()),vxe(t,e,wl,r);case"byte":return e=z0(e,wl.currentByteDefaultFormat()),gxe(t,e,wl,r);case"time":return e=z0(e,wl.currentTimeDefaultFormat()),pxe(t);case"ordinal":return e=z0(e,wl.currentOrdinalDefaultFormat()),mxe(t,e,wl);case"number":default:return OS({instance:t,providedFormat:e})}}function hxe(t){let e=K4.decimal;return aT(t._value,e.suffixes,e.scale).suffix}function fxe(t){let e=K4.binary;return aT(t._value,e.suffixes,e.scale).suffix}function dxe(t){let e=K4.general;return aT(t._value,e.suffixes,e.scale).suffix}function aT(t,e,r){let n=e[0],i=Math.abs(t);if(i>=r){for(let s=1;s<e.length;++s){let a=Math.pow(r,s),o=Math.pow(r,s+1);if(i>=a&&i<o){n=e[s],t=t/a;break}}n===e[0]&&(t=t/Math.pow(r,e.length-1),n=e[e.length-1])}return{value:t,suffix:n}}function gxe(t,e,r,n){let i=e.base||"binary",s=Object.assign({},AS,e);const{binarySuffixes:a,decimalSuffixes:o}=r.currentBytes();let c={general:{scale:1024,suffixes:o||l_,marker:"bd"},binary:{scale:1024,suffixes:a||cJ,marker:"b"},decimal:{scale:1e3,suffixes:o||l_,marker:"d"}}[i],{value:f,suffix:g}=aT(t._value,c.suffixes,c.scale);return`${OS({instance:n(f),providedFormat:e,state:r,defaults:r.currentByteDefaultFormat()})}${s.spaceSeparated?" ":""}${g}`}function mxe(t,e,r){let n=r.currentOrdinal(),i=Object.assign({},AS,e),s=OS({instance:t,providedFormat:e,state:r}),a=n(t._value);return`${s}${i.spaceSeparated?" ":""}${a}`}function pxe(t){let e=Math.floor(t._value/60/60),r=Math.floor((t._value-e*60*60)/60),n=Math.round(t._value-e*60*60-r*60);return`${e}:${r<10?"0":""}${r}:${n<10?"0":""}${n}`}function vxe(t,e,r,n){let i=e.prefixSymbol,s=OS({instance:n(t._value*100),providedFormat:e,state:r}),a=Object.assign({},AS,e);return i?`%${a.spaceSeparated?" ":""}${s}`:`${s}${a.spaceSeparated?" ":""}%`}function wxe(t,e,r){const n=r.currentCurrency();let i=Object.assign({},e),s=Object.assign({},AS,i),a,o="",u=!!s.totalLength||!!s.forceAverage||s.average,c=i.currencyPosition||n.position,f=i.currencySymbol||n.symbol;const g=s.spaceSeparatedCurrency!==void 0?s.spaceSeparatedCurrency:s.spaceSeparated;i.lowPrecision===void 0&&(i.lowPrecision=!1),g&&(o=" "),c==="infix"&&(a=o+f+o);let m=OS({instance:t,providedFormat:i,state:r,decimalSeparator:a});return c==="prefix"&&(t._value<0&&s.negative==="sign"?m=`-${o}${f}${m.slice(1)}`:t._value>0&&s.forceSign?m=`+${o}${f}${m.slice(1)}`:m=f+o+m),(!c||c==="postfix")&&(o=!s.spaceSeparatedAbbreviation&&u?"":o,m=m+o+f),m}function yxe({value:t,forceAverage:e,lowPrecision:r=!0,abbreviations:n,spaceSeparated:i=!1,totalLength:s=0,roundingFunction:a=Math.round}){let o="",u=Math.abs(t),c=-1;if(e&&n[e]&&Zi[e]?(o=n[e],t=t/Zi[e]):u>=Zi.trillion||r&&a(u/Zi.trillion)===1?(o=n.trillion,t=t/Zi.trillion):u<Zi.trillion&&u>=Zi.billion||r&&a(u/Zi.billion)===1?(o=n.billion,t=t/Zi.billion):u<Zi.billion&&u>=Zi.million||r&&a(u/Zi.million)===1?(o=n.million,t=t/Zi.million):(u<Zi.million&&u>=Zi.thousand||r&&a(u/Zi.thousand)===1)&&(o=n.thousand,t=t/Zi.thousand),o&&(o=(i?" ":"")+o),s){let g=t<0,m=t.toString().split(".")[0],v=g?m.length-1:m.length;c=Math.max(s-v,0)}return{value:t,abbreviation:o,mantissaPrecision:c}}function Sxe({value:t,characteristicPrecision:e}){let[r,n]=t.toExponential().split("e"),i=+r;if(!e)return{value:i,abbreviation:`e${n}`};let s=1;return s<e&&(i=i*Math.pow(10,e-s),n=+n-(e-s),n=n>=0?`+${n}`:n),{value:i,abbreviation:`e${n}`}}function jC(t){let e="";for(let r=0;r<t;r++)e+="0";return e}function bxe(t,e){let r=t.toString(),[n,i]=r.split("e"),[s,a=""]=n.split(".");if(+i>0)r=s+a+jC(i-a.length);else{let o=".";+s<0?o=`-0${o}`:o=`0${o}`;let u=(jC(-i-1)+Math.abs(s)+a).substr(0,e);u.length<e&&(u+=jC(e-u.length)),r=o+u}return+i>0&&e>0&&(r+=`.${jC(e)}`),r}function Cxe(t,e,r=Math.round){return t.toString().indexOf("e")!==-1?bxe(t,e):new lxe(r(+`${t}e+${e}`)/Math.pow(10,e)).toFixed(e)}function xxe(t,e,r,n,i,s){if(n===-1)return t;let a=Cxe(e,n,s),[o,u=""]=a.toString().split(".");if(u.match(/^0+$/)&&(r||i))return o;let c=u.match(/0+$/);return i&&c?`${o}.${u.toString().slice(0,c.index)}`:a.toString()}function Exe(t,e,r,n){let i=t,[s,a]=i.toString().split(".");if(s.match(/^-?0$/)&&r)return a?`${s.replace("0","")}.${a}`:s.replace("0","");const o=e<0&&s.indexOf("-")===0;if(o&&(s=s.slice(1),i=i.slice(1)),s.length<n){let u=n-s.length;for(let c=0;c<u;c++)i=`0${i}`}return o&&(i=`-${i}`),i.toString()}function _xe(t,e){let r=[],n=0;for(let i=t;i>0;i--)n===e&&(r.unshift(i),n=0),n++;return r}function Rxe(t,e,r,n,i){let s=n.currentDelimiters(),a=s.thousands;i=i||s.decimal;let o=s.thousandsSize||3,u=t.toString(),c=u.split(".")[0],f=u.split(".")[1];const g=e<0&&c.indexOf("-")===0;return r&&(g&&(c=c.slice(1)),_xe(c.length,o).forEach((v,w)=>{c=c.slice(0,v+w)+a+c.slice(v+w)}),g&&(c=`-${c}`)),f?u=c+i+f:u=c,u}function Txe(t,e){return t+e}function Mxe(t,e,r){return e===0?t:+t==0?t.replace("-",""):e>0?`+${t}`:r==="sign"?t:`(${t.replace("-","")})`}function Axe(t,e){return e+t}function Oxe(t,e){return t+e}function OS({instance:t,providedFormat:e,state:r=wl,decimalSeparator:n,defaults:i=r.currentDefaults()}){let s=t._value;if(s===0&&r.hasZeroFormat())return r.getZeroFormat();if(!isFinite(s))return s.toString();let a=Object.assign({},AS,i,e),o=a.totalLength,u=o?0:a.characteristic,c=a.optionalCharacteristic,f=a.forceAverage,g=a.lowPrecision,m=!!o||!!f||a.average,v=o?-1:m&&e.mantissa===void 0?0:a.mantissa,w=o?!1:e.optionalMantissa===void 0?v===-1:a.optionalMantissa,y=a.trimMantissa,b=a.thousandSeparated,x=a.spaceSeparated,_=a.negative,T=a.forceSign,D=a.exponential,P=a.roundingFunction,O="";if(m){let W=yxe({value:s,forceAverage:f,lowPrecision:g,abbreviations:r.currentAbbreviations(),spaceSeparated:x,roundingFunction:P,totalLength:o});s=W.value,O+=W.abbreviation,o&&(v=W.mantissaPrecision)}if(D){let W=Sxe({value:s,characteristicPrecision:u});s=W.value,O=W.abbreviation+O}let A=xxe(s.toString(),s,w,v,y,P);return A=Exe(A,s,c,u),A=Rxe(A,s,b,r,n),(m||D)&&(A=Txe(A,O)),(T||s<0)&&(A=Mxe(A,s,_)),A}function z0(t,e){if(!t)return e;let r=Object.keys(t);return r.length===1&&r[0]==="output"?e:t}var kxe=t=>({format:(...e)=>uxe(...e,t),getByteUnit:(...e)=>dxe(...e,t),getBinaryByteUnit:(...e)=>fxe(...e,t),getDecimalByteUnit:(...e)=>hxe(...e,t),formatOrDefault:z0});/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */const rh=uJ;function Dxe(t,e,r){let n=new rh(t._value),i=e;return r.isNumbro(e)&&(i=e._value),i=new rh(i),t._value=n.plus(i).toNumber(),t}function hJ(t,e,r){let n=new rh(t._value),i=e;return r.isNumbro(e)&&(i=e._value),i=new rh(i),t._value=n.minus(i).toNumber(),t}function Pxe(t,e,r){let n=new rh(t._value),i=e;return r.isNumbro(e)&&(i=e._value),i=new rh(i),t._value=n.times(i).toNumber(),t}function Ixe(t,e,r){let n=new rh(t._value),i=e;return r.isNumbro(e)&&(i=e._value),i=new rh(i),t._value=n.dividedBy(i).toNumber(),t}function Nxe(t,e,r){let n=e;return r.isNumbro(e)&&(n=e._value),t._value=n,t}function Hxe(t,e,r){let n=r(t._value);return hJ(n,e,r),Math.abs(n._value)}var Fxe=t=>({add:(e,r)=>Dxe(e,r,t),subtract:(e,r)=>hJ(e,r,t),multiply:(e,r)=>Pxe(e,r,t),divide:(e,r)=>Ixe(e,r,t),set:(e,r)=>Nxe(e,r,t),difference:(e,r)=>Hxe(e,r,t),BigNumber:rh});/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */const Lxe="2.5.0",Ku=q4(),Bxe=z4(),Vxe=sxe(zn),Wxe=oJ();let Nd=kxe(zn),og=Fxe(zn);const $xe=G4;class fJ{constructor(e){this._value=e}clone(){return zn(this._value)}format(e={}){return Nd.format(this,e)}formatCurrency(e){return typeof e=="string"&&(e=$xe.parseFormat(e)),e=Nd.formatOrDefault(e,Ku.currentCurrencyDefaultFormat()),e.output="currency",Nd.format(this,e)}formatTime(e={}){return e.output="time",Nd.format(this,e)}binaryByteUnits(){return Nd.getBinaryByteUnit(this)}decimalByteUnits(){return Nd.getDecimalByteUnit(this)}byteUnits(){return Nd.getByteUnit(this)}difference(e){return og.difference(this,e)}add(e){return og.add(this,e)}subtract(e){return og.subtract(this,e)}multiply(e){return og.multiply(this,e)}divide(e){return og.divide(this,e)}set(e){return og.set(this,dJ(e))}value(){return this._value}valueOf(){return this._value}}function dJ(t){let e=t;return zn.isNumbro(t)?e=t._value:typeof t=="string"?e=zn.unformat(t):isNaN(t)&&(e=NaN),e}function zn(t){return new fJ(dJ(t))}zn.version=Lxe;zn.isNumbro=function(t){return t instanceof fJ};zn.language=Ku.currentLanguage;zn.registerLanguage=Ku.registerLanguage;zn.setLanguage=Ku.setLanguage;zn.languages=Ku.languages;zn.languageData=Ku.languageData;zn.zeroFormat=Ku.setZeroFormat;zn.defaultFormat=Ku.currentDefaults;zn.setDefaults=Ku.setDefaults;zn.defaultCurrencyFormat=Ku.currentCurrencyDefaultFormat;zn.validate=Bxe.validate;zn.loadLanguagesInNode=Vxe.loadLanguagesInNode;zn.unformat=Wxe.unformat;zn.BigNumber=og.BigNumber;var Uxe=zn,Hd=BCe(Uxe);const jxe="numeric";function gJ(t,e){if(Ss(t)){const r=e.numericFormat,n=r&&r.culture||"-",i=r&&r.pattern;if(typeof n<"u"&&!Hd.languages()[n]){const s=n.replace("-",""),a=Hd.allLanguages?Hd.allLanguages[n]:Hd[s];a&&Hd.registerLanguage(a)}Hd.setLanguage(n),t=Hd(t).format(i||"0")}return t}function X4(t,e,r,n,i,s,a){let o=s;if(Ss(o)){let c=[];if(Array.isArray(a.className))c=a.className;else{var u;const f=(u=a.className)!==null&&u!==void 0?u:"";f.length&&(c=f.split(" "))}o=gJ(o,a),c.indexOf("htLeft")<0&&c.indexOf("htCenter")<0&&c.indexOf("htRight")<0&&c.indexOf("htJustify")<0&&c.push("htRight"),c.indexOf("htNumeric")<0&&c.push("htNumeric"),a.className=c.join(" "),e.dir="ltr"}fh(t,e,r,n,i,o,a)}X4.RENDERER_TYPE=jxe;const Yxe="password";function Q4(t,e,r,n,i,s,a){fh.apply(this,[t,e,r,n,i,s,a]);const o=a.hashLength||e.innerHTML.length,u=a.hashSymbol||"*";let c="";ct(o-1,()=>{c+=u}),om(e,c)}Q4.RENDERER_TYPE=Yxe;const zxe="select";function Z4(t,e,r,n,i,s,a){fh.apply(this,[t,e,r,n,i,s,a])}Z4.RENDERER_TYPE=zxe;const Gxe="time";function J4(t,e,r,n,i,s,a){fh.apply(this,[t,e,r,n,i,s,a]),e.dir="ltr"}J4.RENDERER_TYPE=Gxe;function qxe(){La(uv),La(MS),La(U4),La($4),La(Y4),La(W4),La(X4),La(Q4),La(Z4),La(fh),La(J4)}const Kxe="autocomplete";function oT(t,e){let r=t;if(r==null&&(r=""),this.allowEmpty&&r===""){e(!0);return}this.strict&&this.source?typeof this.source=="function"?this.source(r,U7(r,e)):U7(r,e)(this.source):e(!0)}oT.VALIDATOR_TYPE=Kxe;function U7(t,e){const r=t;return function(n){let i=!1;for(let s=0,a=n.length;s<a;s++)if(r===n[s]){i=!0;break}e(i)}}function mJ(t){const e=new Date(t);return isNaN(new Date(`${t}T00:00`).getDate())?e:new Date(e.getTime()+e.getTimezoneOffset()*6e4)}const Xxe=Object.freeze(Object.defineProperty({__proto__:null,getNormalizedDate:mJ},Symbol.toStringTag,{value:"Module"})),Qxe="date";function e3(t,e){const r=UQ(JZ,this.instance);let n=t,i=!0;n==null&&(n="");let s=je(n,this.dateFormat||r.defaultDateFormat,!0).isValid(),a=je(new Date(n)).isValid()||s;if(this.allowEmpty&&n===""&&(a=!0,s=!0),a||(i=!1),!a&&s&&(i=!0),a&&!s)if(this.correctFormat===!0){const o=Zxe(n,this.dateFormat);this.instance.setDataAtCell(this.visualRow,this.visualCol,o,"dateValidator"),i=!0}else i=!1;e(i)}e3.VALIDATOR_TYPE=Qxe;function Zxe(t,e){const r=je(mJ(t)),n=je(t,e),i=t.search(/[A-Za-z]/g)>-1;let s;return r.isValid()&&r.format("x")===n.format("x")||!n.isValid()||i?s=r:s=n,s.format(e)}const Jxe="dropdown";function t3(t,e){oT.apply(this,[t,e])}t3.VALIDATOR_TYPE=Jxe;const eEe="numeric";function r3(t,e){let r=t;r==null&&(r=""),this.allowEmpty&&r===""?e(!0):e(r===""?!1:Ss(t))}r3.VALIDATOR_TYPE=eEe;const tEe=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"],rEe="time";function n3(t,e){const r=this.timeFormat||"h:mm:ss a";let n=!0,i=t;i===null&&(i=""),i=/^\d{3,}$/.test(i)?parseInt(i,10):i;const s=/^\d{1,2}$/.test(i);s&&(i+=":00");const a=je(i,tEe,!0).isValid()?je(i):je(i,r);let o=a.isValid(),u=je(i,r,!0).isValid()&&!s;if(this.allowEmpty&&i===""&&(o=!0,u=!0),o||(n=!1),!o&&u&&(n=!0),o&&!u)if(this.correctFormat===!0){const c=a.format(r);this.instance.setDataAtCell(this.visualRow,this.visualCol,c,"timeValidator"),n=!0}else n=!1;e(n)}n3.VALIDATOR_TYPE=rEe;function nEe(){fg(oT),fg(t3),fg(e3),fg(r3),fg(n3)}const iEe="autocomplete",sEe={CELL_TYPE:iEe,editor:B4,renderer:uv,validator:oT},aEe="checkbox",oEe={CELL_TYPE:aEe,editor:ZZ,renderer:U4},lEe="date";function pJ(t,e,r,n,i,s,a){uv.apply(this,[t,e,r,n,i,s,a])}pJ.RENDERER_TYPE=lEe;const uEe="date",cEe={CELL_TYPE:uEe,editor:eJ,renderer:pJ,validator:e3},hEe="dropdown",vJ={CELL_TYPE:hEe,editor:tJ,renderer:$4,validator:t3,filter:!1,strict:!0},fEe="handsontable",dEe={CELL_TYPE:fEe,editor:L4,renderer:Y4},gEe="numeric",mEe={CELL_TYPE:gEe,editor:rJ,renderer:X4,validator:r3,dataType:"number"},pEe="password",vEe={CELL_TYPE:pEe,editor:nJ,renderer:Q4,copyable:!1},wEe="select",yEe={CELL_TYPE:wEe,editor:iJ,renderer:Z4},SEe="time",bEe={CELL_TYPE:SEe,editor:sJ,renderer:J4,validator:n3};function CEe(){xo(sEe),xo(oEe),xo(cEe),xo(vJ),xo(dEe),xo(mEe),xo(vEe),xo(yEe),xo(XZ),xo(bEe)}function xEe(t,e){wJ(t,e),e.add(t)}function EEe(t,e,r){wJ(t,e),e.set(t,r)}function wJ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function h0(t,e,r){return(e=_Ee(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _Ee(t){var e=REe(t,"string");return typeof e=="symbol"?e:e+""}function REe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function f0(t,e){return t.get(yJ(t,e))}function yJ(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const j7=new Map([["plugin",upe],["cell-type",FZ],["editor",$Q],["renderer",XQ],["validator",QQ]]),SJ=Symbol("mainSetting"),TEe="base",YC=[];let Fd=null;var Ld=new WeakMap,Y7=new WeakSet;class ur{static get PLUGIN_KEY(){return TEe}static get SETTING_KEYS(){return[this.PLUGIN_KEY]}static get DEFAULT_SETTINGS(){return{}}constructor(e){xEe(this,Y7),h0(this,"eventManager",new Uo(this)),h0(this,"pluginName",null),h0(this,"pluginsInitializedCallbacks",[]),h0(this,"isPluginsReady",!1),h0(this,"enabled",!1),h0(this,"initialized",!1),EEe(this,Ld,{}),qu(this,"hot",e,{writable:!1}),Fd=null,this.hot.addHook("afterPluginsInitialized",()=>this.onAfterPluginsInitialized()),this.hot.addHook("afterUpdateSettings",r=>this.onUpdateSettings(r)),this.hot.addHook("beforeInit",()=>this.init())}init(){this.pluginName=this.hot.getPluginName(this);const e=this.constructor.PLUGIN_DEPS,r=Array.isArray(e)?e:[];if(r.length>0){const i=[];if(r.forEach(s=>{const[a,o]=s.split(":");if(!j7.has(a))throw new Error(`Unknown plugin dependency type "${a}" was found.`);j7.get(a)(o)||i.push(` - ${o} (${a})`)}),i.length>0){const s=[`The ${this.pluginName} plugin requires the following modules:
`,`${i.join(`
`)}
`].join("");YC.push(s)}}if(Fd||(Fd=VF()),Fd.indexOf(this.pluginName)>=0&&Fd.splice(Fd.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",()=>{this.isEnabled&&this.isEnabled()&&this.enablePlugin()}),Fd.length===0){if(YC.length>0){const i=[`${YC.join(`
`)}
`,"You have to import and register them manually."].join("");throw YC.length=0,new Error(i)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}enablePlugin(){this.enabled=!0}disablePlugin(){var e;(e=this.eventManager)===null||e===void 0||e.clear(),this.clearHooks(),this.enabled=!1}getSetting(e){const r=this.hot.getSettings()[this.constructor.PLUGIN_KEY];if(e===void 0)return r;const n=this.constructor.DEFAULT_SETTINGS;if((Array.isArray(r)||Vt(r))&&n[SJ]===e){var i;return Array.isArray(r)?r:(i=r[e])!==null&&i!==void 0?i:n[e]}if(Vt(r)){var s;return(s=r[e])!==null&&s!==void 0?s:n[e]}return n[e]}addHook(e,r,n){f0(Ld,this)[e]=f0(Ld,this)[e]||[];const i=f0(Ld,this)[e];this.hot.addHook(e,r,n),i.push(r),f0(Ld,this)[e]=i}removeHooks(e){he(f0(Ld,this)[e]||[],r=>{this.hot.removeHook(e,r)})}clearHooks(){const e=f0(Ld,this);Wt(e,(r,n)=>this.removeHooks(n)),e.length=0}callOnPluginsReady(e){this.isPluginsReady?e():this.pluginsInitializedCallbacks.push(e)}onAfterPluginsInitialized(){he(this.pluginsInitializedCallbacks,e=>e()),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}onUpdateSettings(e){const r=yJ(Y7,this,MEe).call(this,e);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&r&&this.updatePlugin(e))}updatePlugin(){}destroy(){var e;(e=this.eventManager)===null||e===void 0||e.destroy(),this.clearHooks(),Wt(this,(r,n)=>{n!=="hot"&&(this[n]=null)}),delete this.t,delete this.hot}}function MEe(t){if(!t)return!1;const e=this.constructor.SETTING_KEYS;if(typeof e=="boolean")return e;for(let r=0;r<e.length;r++)if(t[e[r]]!==void 0)return!0;return!1}function Bd(t,e,r){return(e=AEe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function AEe(t){var e=OEe(t,"string");return typeof e=="symbol"?e:e+""}function OEe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let i3=class{constructor(e){Bd(this,"hot",null),Bd(this,"container",null),Bd(this,"injected",!1),Bd(this,"rows",[]),Bd(this,"columns",[]),Bd(this,"samples",null),Bd(this,"settings",{useHeaders:!0}),this.hot=e}addRow(e,r){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));const n={row:e};this.rows.push(n),this.samples=r,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol(e)),this.table.tr.appendChild(this.createRow(e)),e===0&&Ve(this.table.table,"htGhostTableFirstRow"),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}addColumnHeadersRow(e){const r=this.hot.getColHeader(0);if(r!=null){const n={row:-1};this.rows.push(n),this.container=this.createContainer(this.hot.rootElement.className),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}}addColumn(e,r){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));const n={col:e};this.columns.push(n),this.samples=r,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&this.hot.getColHeader(e)!==null&&this.hot.view.appendColHeader(e,this.table.th,void 0,-1),this.table.tBody.appendChild(this.createCol(e)),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}getHeights(e){this.injected||this.injectTable(),he(this.rows,r=>{const{height:n}=r.table.getBoundingClientRect();e(r.row,Math.ceil(n))})}getWidths(e){this.injected||this.injectTable(),he(this.columns,r=>{const{width:n}=r.table.getBoundingClientRect();e(r.col,Math.ceil(n))})}setSettings(e){this.settings=e}setSetting(e,r){this.settings||(this.settings={}),this.settings[e]=r}getSettings(){return this.settings}getSetting(e){return this.settings?this.settings[e]:null}createColGroupsCol(e){const r=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&r.appendChild(this.createColElement(-1,-1)),this.samples.forEach(n=>{he(n.strings,i=>{r.appendChild(this.createColElement(i.col,e))})}),r}createRow(e){const{rootDocument:r}=this.hot,n=r.createDocumentFragment(),i=r.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(e,i),n.appendChild(i)),this.samples.forEach(s=>{he(s.strings,a=>{const o=a.col,u=this.hot.getCellMeta(e,o),c=this.hot.getCellRenderer(u),f=r.createElement("td");f.setAttribute("ghost-table",1),c(this.hot,f,e,o,this.hot.colToProp(o),a.value,u),n.appendChild(f)})}),n}appendColumnHeadersRow(){const{rootDocument:e}=this.hot,r=e.createDocumentFragment(),n=[];if(this.hot.hasRowHeaders()){const i=e.createElement("th");n.push([-1,i]),r.appendChild(i)}this.samples.forEach(i=>{he(i.strings,s=>{const a=s.col,o=e.createElement("th");n.push([a,o]),r.appendChild(o)})}),this.table.tHead.appendChild(r),he(n,i=>{const[s,a]=i;this.hot.view.appendColHeader(s,a)})}createCol(e){const{rootDocument:r}=this.hot,n=r.createDocumentFragment();return this.samples.forEach(i=>{he(i.strings,s=>{const a=s.row,o=this.hot.getCellMeta(a,e),u=this.hot.getCellRenderer(o),c=r.createElement("td"),f=r.createElement("tr");c.setAttribute("ghost-table",1),u(this.hot,c,a,e,this.hot.colToProp(e),s.value,o),f.appendChild(c),n.appendChild(f)})}),n}clean(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}injectTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.injected||((e||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}removeTable(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}createColElement(e,r){const n=this.hot.rootDocument.createElement("col");let i=0;r>=0&&e>=0&&(i=this.hot.getCellMeta(r,e).colspan);let s=this.hot.getColWidth(e);if(i>1)for(let a=e+1;a<e+i;a++)s+=this.hot.getColWidth(a);return n.style.width=`${s}px`,n}createTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:r}=this.hot,n=r.createDocumentFragment(),i=r.createElement("table"),s=r.createElement("thead"),a=r.createElement("tbody"),o=r.createElement("colgroup"),u=r.createElement("tr"),c=r.createElement("th");return this.isVertical()&&i.appendChild(o),this.isHorizontal()&&(u.appendChild(c),s.appendChild(u),i.style.tableLayout="auto",i.style.width="auto"),i.appendChild(s),this.isVertical()&&a.appendChild(u),i.appendChild(a),Ve(i,e),n.appendChild(i),{fragment:n,table:i,tHead:s,tBody:a,colGroup:o,tr:u,th:c}}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:r}=this.hot,n=r.createDocumentFragment(),i=r.createElement("div"),s=`htGhostTable htAutoSize ${e.trim()}`;return Ve(i,s),n.appendChild(i),{fragment:n,container:i}}isVertical(){return!!(this.rows.length&&!this.columns.length)}isHorizontal(){return!!(this.columns.length&&!this.rows.length)}};function zC(t,e,r){return(e=kEe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function kEe(t){var e=DEe(t,"string");return typeof e=="symbol"?e:e+""}function DEe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class lT{static get SAMPLE_COUNT(){return 3}constructor(e){zC(this,"samples",null),zC(this,"dataFactory",null),zC(this,"customSampleCount",null),zC(this,"allowDuplicates",!1),this.dataFactory=e}getSampleCount(){return this.customSampleCount?this.customSampleCount:lT.SAMPLE_COUNT}setSampleCount(e){this.customSampleCount=e}setAllowDuplicates(e){this.allowDuplicates=e}generateRowSamples(e,r){return this.generateSamples("row",r,e)}generateColumnSamples(e,r){return this.generateSamples("col",r,e)}generateSamples(e,r,n){const i=new Map,{from:s,to:a}=typeof n=="number"?{from:n,to:n}:n;return ct(s,a,o=>{const u=this.generateSample(e,r,o);i.set(o,u)}),i}generateSample(e,r,n){if(e!=="row"&&e!=="col")throw new Error("Unsupported sample type");const i=new Map,s=e==="row"?"col":"row",a=[];return ct(r.from,r.to,o=>{const u=e==="row"?this.dataFactory(n,o):this.dataFactory(o,n);if(u===!1)return;const{value:c,bundleSeed:f}=u,g=typeof f=="string"&&f.length>0;let m;g?m=f:Vt(c)?m=`${Object.keys(c).length}`:Array.isArray(c)?m=`${c.length}`:m=`${cn(c).length}`,i.has(m)||i.set(m,{needed:this.getSampleCount(),strings:[]});const v=i.get(m);v.needed&&(!(a.indexOf(c)>-1)||this.allowDuplicates||g)&&(v.strings.push({value:c,[s]:o}),a.push(c),v.needed-=1)}),i}}function PEe(t,e){bJ(t,e),e.add(t)}function F2(t,e,r){bJ(t,e),e.set(t,r)}function bJ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Bw(t,e,r){return(e=IEe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function IEe(t){var e=NEe(t,"string");return typeof e=="symbol"?e:e+""}function NEe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function bf(t,e){return t.get(da(t,e))}function u_(t,e,r){return t.set(da(t,e),r),r}function da(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}Je.getSingleton().register("modifyAutoColumnSizeSeed");const L2="autoColumnSize",HEe=10,FEe="autoColumnSize";var s3=new WeakMap,G0=new WeakMap,Np=new WeakMap,Va=new WeakSet;class Wy extends ur{static get PLUGIN_KEY(){return L2}static get PLUGIN_PRIORITY(){return HEe}static get SETTING_KEYS(){return!0}static get DEFAULT_SETTINGS(){return{useHeaders:!0,samplingRatio:null,allowSampleDuplicates:!1}}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 50}constructor(e){super(e),PEe(this,Va),Bw(this,"ghostTable",new i3(this.hot)),Bw(this,"samplesGenerator",new lT((r,n)=>{const i=this.hot.toPhysicalRow(r),s=this.hot.toPhysicalColumn(n);if(this.hot.rowIndexMapper.isHidden(i)||this.hot.columnIndexMapper.isHidden(s))return!1;const a=this.hot.getCellMeta(r,n);let o="";a.spanned||(o=this.hot.getDataAtCell(r,n));let u="";return this.hot.hasHook("modifyAutoColumnSizeSeed")&&(u=this.hot.runHooks("modifyAutoColumnSizeSeed",u,a,o)),{value:o,bundleSeed:u}})),Bw(this,"inProgress",!1),Bw(this,"measuredColumns",0),Bw(this,"columnWidthsMap",new Jf),F2(this,s3,!1),F2(this,G0,[]),F2(this,Np,[]),this.hot.columnIndexMapper.registerMap(FEe,this.columnWidthsMap),this.addHook("beforeColumnResize",(r,n,i)=>da(Va,this,z7).call(this,r,n,i))}isEnabled(){return this.hot.getSettings()[L2]!==!1&&!this.hot.getSettings().colWidths}enablePlugin(){var e=this;if(this.enabled)return;this.ghostTable.setSetting("useHeaders",this.getSetting("useHeaders")),this.samplesGenerator.setAllowDuplicates(this.getSetting("allowSampleDuplicates"));const r=this.getSetting("samplingRatio");r&&!isNaN(r)&&this.samplesGenerator.setSampleCount(parseInt(r,10)),this.addHook("afterLoadData",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return da(Va,e,VEe).call(e,...i)}),this.addHook("beforeChangeRender",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return da(Va,e,WEe).call(e,...i)}),this.addHook("afterFormulasValuesUpdate",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return da(Va,e,UEe).call(e,...i)}),this.addHook("beforeRender",()=>da(Va,this,BEe).call(this)),this.addHook("modifyColWidth",(n,i)=>this.getColumnWidth(i,n)),this.addHook("init",()=>da(Va,this,$Ee).call(this)),super.enablePlugin()}updatePlugin(){u_(Np,this,this.findColumnsWhereHeaderWasChanged()),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.addHook("beforeColumnResize",(e,r,n)=>da(Va,this,z7).call(this,e,r,n))}calculateVisibleColumnsWidth(){if(!this.hot.countRows())return;const e=this.getFirstVisibleColumn(),r=this.getLastVisibleColumn();if(e===-1||r===-1)return;const n=this.hot.forceFullRender;this.calculateColumnsWidth({from:e,to:r},void 0,n)}calculateColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countRows()-1},n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=typeof e=="number"?{from:e,to:e}:e,s=typeof r=="number"?{from:r,to:r}:r;ct(i.from,i.to,a=>{let o=this.hot.toPhysicalColumn(a);o===null&&(o=a),(n||this.columnWidthsMap.getValueAtIndex(o)===null&&!this.hot._getColWidthFromSettings(o))&&da(Va,this,CJ).call(this,a,s)}),this.ghostTable.columns.length&&(da(Va,this,xJ).call(this),this.measuredColumns=i.to+1,this.ghostTable.clean())}calculateAllColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n=0;const i=this.hot.countCols()-1;let s=null;this.inProgress=!0;const a=()=>{if(!this.hot){b1(s),this.inProgress=!1;return}this.calculateColumnsWidth({from:n,to:Math.min(n+Wy.CALCULATION_STEP,i)},e,r),n=n+Wy.CALCULATION_STEP+1,n<i?s=S1(a):(b1(s),this.inProgress=!1,this.hot.view.adjustElementsSize())},o=this.getSyncCalculationLimit();o>=0&&(this.calculateColumnsWidth({from:0,to:o},e,r),n=o+1),n<i?a():this.inProgress=!1}recalculateAllColumnsWidth(){this.hot.view.isVisible()&&this.calculateAllColumnsWidth({from:0,to:this.hot.countRows()-1},!0)}getSyncCalculationLimit(){const e=this.hot.getSettings()[L2];let r=Wy.SYNC_CALCULATION_LIMIT;const n=this.hot.countCols()-1;return Vt(e)&&(r=e.syncLimit,mF(r)?r=LF(n,r):r>>=0),Math.min(r,n)}getColumnWidth(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=r;return i===void 0&&(i=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e)),n&&typeof i=="number"&&(i=Math.max(i,Op))),i}getFirstVisibleColumn(){var e;return(e=this.hot.getFirstRenderedVisibleColumn())!==null&&e!==void 0?e:-1}getLastVisibleColumn(){var e;return(e=this.hot.getLastRenderedVisibleColumn())!==null&&e!==void 0?e:-1}findColumnsWhereHeaderWasChanged(){return this.hot.getColHeader().reduce((n,i,s)=>{const a=bf(G0,this).length;return(a-1<s||bf(G0,this)[s]!==i)&&n.push(this.hot.toVisualColumn(s)),a-1<s?bf(G0,this).push(i):bf(G0,this)[s]=i,n},[])}clearCache(e){Array.isArray(e)?this.hot.batchExecution(()=>{e.forEach(r=>{this.columnWidthsMap.setValueAtIndex(r,null)})},!0):this.columnWidthsMap.clear()}isNeedRecalculate(){return!!this.columnWidthsMap.getValues().slice(0,this.measuredColumns).filter(e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function LEe(t){const e={from:0,to:this.hot.countRows()-1};t.forEach(r=>{const n=this.hot.toPhysicalColumn(r);n!==null&&(this.hot._getColWidthFromSettings(n)||da(Va,this,CJ).call(this,r,e))}),this.ghostTable.columns.length&&(da(Va,this,xJ).call(this),this.ghostTable.clean())}function CJ(t,e){this.samplesGenerator.generateColumnSamples(t,e).forEach((n,i)=>this.ghostTable.addColumn(i,n))}function xJ(){this.hot.batchExecution(()=>{this.ghostTable.getWidths((t,e)=>{const r=this.hot.toPhysicalColumn(t);this.columnWidthsMap.setValueAtIndex(r,e)})},!0)}function BEe(){this.calculateVisibleColumnsWidth(),this.inProgress||(da(Va,this,LEe).call(this,bf(Np,this)),u_(Np,this,[]))}function VEe(t,e){e||this.recalculateAllColumnsWidth()}function WEe(t){const e=t.reduce((r,n)=>{let[,i]=n;const s=this.hot.propToCol(i);return Number.isInteger(s)&&r.indexOf(s)===-1&&r.push(s),r},[]);bf(Np,this).push(...e)}function z7(t,e,r){let n=t;return r&&(this.calculateColumnsWidth(e,void 0,!0),n=this.getColumnWidth(e,void 0,!1)),n}function $Ee(){u_(G0,this,this.hot.getColHeader()),this.recalculateAllColumnsWidth(),u_(s3,this,!0)}function UEe(t){if(!bf(s3,this))return;const e=t.reduce((r,n)=>{var i;const s=(i=n.address)===null||i===void 0?void 0:i.col;if(Number.isInteger(s)){const a=this.hot.toVisualColumn(s);r.indexOf(a)===-1&&r.push(a)}return r},[]);bf(Np,this).push(...e)}const vg={horizontal:"horizontal",vertical:"vertical"};function jEe(t,e,r){let n,i,s;return e[0]===t[0]&&e[1]<t[1]?(s="left",n=r(e[0],e[1]),i=r(e[2],t[1]-1)):e[2]===t[2]&&e[0]===t[0]&&e[3]>t[3]?(s="right",n=r(e[0],t[3]+1),i=r(e[2],e[3])):e[0]<t[0]&&e[1]===t[1]?(s="up",n=r(e[0],e[1]),i=r(t[0]-1,e[3])):e[2]>t[2]&&e[1]===t[1]&&(s="down",n=r(t[2]+1,e[1]),i=r(e[2],e[3])),n&&n.normalize(),i&&i.normalize(),{directionOfDrag:s,startOfDragCoords:n,endOfDragCoords:i}}function YEe(t){const e={};return t===!0?(e.directions=Object.keys(vg),e.autoInsertRow=!0):Vt(t)?(it(t.autoInsertRow)?t.direction===vg.horizontal?e.autoInsertRow=!1:e.autoInsertRow=t.autoInsertRow:e.autoInsertRow=!1,it(t.direction)?e.directions=[t.direction]:e.directions=Object.keys(vg)):typeof t=="string"?(e.directions=[t],e.autoInsertRow=!0):(e.directions=[],e.autoInsertRow=!1),e}function zEe(t,e){GEe(t,e),e.add(t)}function GEe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function d0(t,e,r){return(e=qEe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function qEe(t){var e=KEe(t,"string");return typeof e=="symbol"?e:e+""}function KEe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Vw(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}Je.getSingleton().register("modifyAutofillRange");Je.getSingleton().register("beforeAutofill");Je.getSingleton().register("afterAutofill");const G7="autofill",XEe=20,QEe=["fillHandle"],ZEe="insert_row_below",JEe=200;var g0=new WeakSet;class e_e extends ur{constructor(){super(...arguments),zEe(this,g0),d0(this,"addingStarted",!1),d0(this,"mouseDownOnCellCorner",!1),d0(this,"mouseDragOutside",!1),d0(this,"handleDraggedCells",0),d0(this,"directions",[]),d0(this,"autoInsertRow",!1)}static get PLUGIN_KEY(){return G7}static get PLUGIN_PRIORITY(){return XEe}static get SETTING_KEYS(){return[G7,...QEe]}isEnabled(){return this.hot.getSettings().fillHandle}enablePlugin(){this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",e=>Vw(g0,this,r_e).call(this,e)),this.addHook("afterOnCellCornerDblClick",e=>Vw(g0,this,t_e).call(this,e)),this.addHook("beforeOnCellMouseOver",(e,r)=>Vw(g0,this,n_e).call(this,r)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.clearMappedSettings(),super.disablePlugin()}getSelectionData(){const e=this.hot.getSelectedRangeLast(),{row:r,col:n}=e.getTopStartCorner(),{row:i,col:s}=e.getBottomEndCorner(),a=this.hot.runHooks("modifyCopyableRange",[{startRow:r,startCol:n,endRow:i,endCol:s}]),o=[],u=[],c=[];return he(a,f=>{for(let g=f.startRow;g<=f.endRow;g+=1)o.indexOf(g)===-1&&o.push(g);for(let g=f.startCol;g<=f.endCol;g+=1)u.indexOf(g)===-1&&u.push(g)}),he(o,f=>{const g=[];he(u,m=>{g.push(this.hot.getCopyableData(f,m))}),c.push(g)}),c}fillIn(){if(this.hot.selection.highlight.getFill().isEmpty())return!1;const[e,r,n,i]=this.hot.selection.highlight.getFill().getVisualCorners(),s=this.hot.getSelectedRangeLast(),a=s.getTopStartCorner(),o=s.getBottomEndCorner();this.resetSelectionOfDraggedArea();const u=[a.row,a.col,o.row,o.col],c=this.hot.runHooks("modifyAutofillRange",[Math.min(a.row,e),Math.min(a.col,r),Math.max(o.row,n),Math.max(o.col,i)],u),{directionOfDrag:f,startOfDragCoords:g,endOfDragCoords:m}=jEe(u,c,(v,w)=>this.hot._createCellCoords(v,w));if(g&&g.row>-1&&g.col>-1){const v=this.getSelectionData(),w=s.clone(),y=this.hot._createCellRange(g,g,m),b=this.hot.runHooks("beforeAutofill",v,w,y,f);if(b===!1)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;let x=b;const _=b;if(["up","left"].indexOf(f)>-1&&!(_.length===1&&_[0].length===0))if(x=[],f==="up"){const T=m.row-g.row+1,D=T%_.length;for(let P=0;P<T;P++)x.push(_[(P+(_.length-D))%_.length])}else{const T=m.col-g.col+1,D=T%_[0].length;for(let P=0;P<_.length;P++){x.push([]);for(let O=0;O<T;O++)x[P].push(_[P][(O+(_[P].length-D))%_[P].length])}}this.hot.populateFromArray(g.row,g.col,x,m.row,m.col,`${this.pluginName}.fill`,null),this.setSelection(c),this.hot.runHooks("afterAutofill",x,w,y,f),this.hot.render()}else this.hot.view.render();return!0}reduceSelectionAreaIfNeeded(e){return e.row<0&&(e.row=0),e.col<0&&(e.col=0),e}getCoordsOfDragAndDropBorders(e){const r=this.hot.getSelectedRangeLast(),n=r.getBottomEndCorner();let i=e;if(this.directions.includes(vg.vertical)&&this.directions.includes(vg.horizontal)){const s=r.getTopStartCorner();(n.col<=e.col||s.col>=e.col)&&(i=this.hot._createCellCoords(n.row,e.col)),(n.row<e.row||s.row>e.row)&&(i=this.hot._createCellCoords(e.row,n.col))}else if(this.directions.includes(vg.vertical))i=this.hot._createCellCoords(e.row,n.col);else if(this.directions.includes(vg.horizontal))i=this.hot._createCellCoords(n.row,e.col);else return;return this.reduceSelectionAreaIfNeeded(i)}showBorder(e){const r=this.getCoordsOfDragAndDropBorders(e);r&&this.redrawBorders(r)}addRow(){this.hot._registerTimeout(()=>{this.hot.alter(ZEe,void 0,1,`${this.pluginName}.fill`),this.addingStarted=!1},JEe)}addNewRowIfNeeded(){if(!this.hot.selection.highlight.getFill().isEmpty()&&this.addingStarted===!1&&this.autoInsertRow){const e=this.hot.getSelectedLast(),r=this.hot.selection.highlight.getFill().getVisualCorners(),n=this.hot.countRows();e[2]<n-1&&r[2]===n-1&&(this.addingStarted=!0,this.addRow())}}getIndexOfLastAdjacentFilledInRow(e){const r=this.hot.getData(),n=this.hot.countRows();let i;for(let s=e[2]+1;s<n;s++){for(let u=e[1];u<=e[3];u++){const c=r[s][u];if(!In(c))return-1}const a=r[s][e[1]-1],o=r[s][e[3]+1];(!In(a)||!In(o))&&(i=s)}return i}addSelectionFromStartAreaToSpecificRowIndex(e,r){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(e[0],e[1])).add(this.hot._createCellCoords(r,e[3])).commit()}setSelection(e){this.hot.selectCell(...nr(e,r=>Math.max(r,0)),!1,!1)}selectAdjacent(){const e=this.hot.getSelectedLast(),r=this.getIndexOfLastAdjacentFilledInRow(e);return r===-1||r===void 0?!1:(this.addSelectionFromStartAreaToSpecificRowIndex(e,r),!0)}resetSelectionOfDraggedArea(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}redrawBorders(e){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(e).commit(),this.hot.view.render()}getIfMouseWasDraggedOutside(e){const{documentElement:r}=this.hot.rootDocument,n=ns(this.hot.table).top-(this.hot.rootWindow.pageYOffset||r.scrollTop)+ai(this.hot.table),i=ns(this.hot.table).left-(this.hot.rootWindow.pageXOffset||r.scrollLeft)+Un(this.hot.table);return e.clientY>n&&e.clientX<=i}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mouseup",()=>Vw(g0,this,i_e).call(this)),this.eventManager.addEventListener(e,"mousemove",r=>Vw(g0,this,s_e).call(this,r))}clearMappedSettings(){this.directions.length=0,this.autoInsertRow=!1}mapSettings(){const e=YEe(this.hot.getSettings().fillHandle);this.directions=e.directions,this.autoInsertRow=e.autoInsertRow}destroy(){super.destroy()}}function t_e(){this.selectAdjacent()&&this.fillIn()}function r_e(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}function n_e(t){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(t),this.addNewRowIfNeeded())}function i_e(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}function s_e(t){const e=this.getIfMouseWasDraggedOutside(t);this.addingStarted===!1&&this.handleDraggedCells>0&&e?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}function a_e(t,e){EJ(t,e),e.add(t)}function q7(t,e,r){EJ(t,e),e.set(t,r)}function EJ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function m0(t,e,r){return(e=o_e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function o_e(t){var e=l_e(t,"string");return typeof e=="symbol"?e:e+""}function l_e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function _J(t,e,r){return t.set(vu(t,e),r),r}function c_(t,e){return t.get(vu(t,e))}function vu(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const B2="autoRowSize",u_e=40,c_e="autoRowSize";var A1=new WeakMap,a3=new WeakMap,Tc=new WeakSet;class $y extends ur{static get PLUGIN_KEY(){return B2}static get PLUGIN_PRIORITY(){return u_e}static get SETTING_KEYS(){return!0}static get DEFAULT_SETTINGS(){return{useHeaders:!0,samplingRatio:null,allowSampleDuplicates:!1}}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 500}constructor(e){super(e),a_e(this,Tc),m0(this,"headerHeight",null),m0(this,"ghostTable",new i3(this.hot)),m0(this,"samplesGenerator",new lT((r,n)=>{const i=this.hot.toPhysicalRow(r),s=this.hot.toPhysicalColumn(n);if(this.hot.rowIndexMapper.isHidden(i)||this.hot.columnIndexMapper.isHidden(s)||r>=0&&n>=0&&this.hot.getCellMeta(r,n).hidden)return!1;let a;return r>=0?a=this.hot.getDataAtCell(r,n):r===-1&&(a=this.hot.getColHeader(n)),{value:a}})),m0(this,"inProgress",!1),m0(this,"measuredRows",0),m0(this,"rowHeightsMap",new Jf),q7(this,A1,[]),q7(this,a3,!1),this.hot.rowIndexMapper.registerMap(c_e,this.rowHeightsMap),this.addHook("beforeRowResize",(r,n,i)=>vu(Tc,this,K7).call(this,r,n,i))}isEnabled(){const e=this.hot.getSettings()[B2];return e===!0||Vt(e)}enablePlugin(){var e=this;if(this.enabled)return;this.samplesGenerator.setAllowDuplicates(this.getSetting("allowSampleDuplicates"));const r=this.getSetting("samplingRatio");r&&!isNaN(r)&&this.samplesGenerator.setSampleCount(parseInt(r,10)),this.addHook("afterLoadData",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return vu(Tc,e,d_e).call(e,...i)}),this.addHook("beforeChangeRender",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return vu(Tc,e,g_e).call(e,...i)}),this.addHook("beforeColumnResize",()=>this.recalculateAllRowsHeight()),this.addHook("afterFormulasValuesUpdate",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return vu(Tc,e,p_e).call(e,...i)}),this.addHook("beforeRender",()=>vu(Tc,this,f_e).call(this)),this.addHook("modifyRowHeight",(n,i)=>this.getRowHeight(i,n)),this.addHook("init",()=>vu(Tc,this,m_e).call(this)),this.addHook("modifyColumnHeaderHeight",()=>this.getColumnHeaderHeight()),super.enablePlugin()}disablePlugin(){this.headerHeight=null,super.disablePlugin(),this.addHook("beforeRowResize",(e,r,n)=>vu(Tc,this,K7).call(this,e,r,n))}calculateVisibleRowsHeight(){if(!this.hot.countCols())return;const e=this.getFirstVisibleRow(),r=this.getLastVisibleRow();if(e===-1||r===-1)return;const n=this.hot.forceFullRender;this.calculateRowsHeight({from:e,to:r},void 0,n)}calculateRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countCols()-1},n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=typeof e=="number"?{from:e,to:e}:e,s=typeof r=="number"?{from:r,to:r}:r;if(this.hot.getColHeader(0)!==null){const a=this.samplesGenerator.generateRowSamples(-1,s);this.ghostTable.addColumnHeadersRow(a.get(-1))}ct(i.from,i.to,a=>{let o=this.hot.toPhysicalRow(a);o===null&&(o=a),(n||this.rowHeightsMap.getValueAtIndex(o)===null)&&this.samplesGenerator.generateRowSamples(a,s).forEach((c,f)=>this.ghostTable.addRow(f,c))}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((a,o)=>{a<0?this.headerHeight=o:this.rowHeightsMap.setValueAtIndex(this.hot.toPhysicalRow(a),o)})},!0),this.measuredRows=i.to+1,this.ghostTable.clean())}calculateAllRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n=0;const i=this.hot.countRows()-1;let s=null;this.inProgress=!0;const a=()=>{if(!this.hot){b1(s),this.inProgress=!1;return}this.calculateRowsHeight({from:n,to:Math.min(n+$y.CALCULATION_STEP,i)},e,r),n=n+$y.CALCULATION_STEP+1,n<i?s=S1(a):(b1(s),this.inProgress=!1,this.hot.view.adjustElementsSize())},o=this.getSyncCalculationLimit();o>=0&&(this.calculateRowsHeight({from:0,to:o},e,r),n=o+1),n<i?a():(this.inProgress=!1,this.hot.view.adjustElementsSize())}recalculateAllRowsHeight(){this.hot.view.isVisible()&&this.calculateAllRowsHeight({from:0,to:this.hot.countCols()-1},!0)}getSyncCalculationLimit(){const e=this.hot.getSettings()[B2];let r=$y.SYNC_CALCULATION_LIMIT;const n=this.hot.countRows()-1;return Vt(e)&&(r=e.syncLimit,mF(r)?r=LF(n,r):r>>=0),Math.min(r,n)}getRowHeight(e,r){const n=e<0?this.headerHeight:this.rowHeightsMap.getValueAtIndex(this.hot.toPhysicalRow(e));let i=r;return n!==null&&n>(r||0)&&(i=n),i}getColumnHeaderHeight(){return this.headerHeight}getFirstVisibleRow(){var e;return(e=this.hot.getFirstRenderedVisibleRow())!==null&&e!==void 0?e:-1}getLastVisibleRow(){var e;return(e=this.hot.getLastRenderedVisibleRow())!==null&&e!==void 0?e:-1}clearCache(e){this.headerHeight=null,Array.isArray(e)?this.hot.batchExecution(()=>{e.forEach(r=>{this.rowHeightsMap.setValueAtIndex(r,null)})},!0):this.rowHeightsMap.clear()}clearCacheByRange(e){const{from:r,to:n}=typeof e=="number"?{from:e,to:e}:e;this.hot.batchExecution(()=>{ct(Math.min(r,n),Math.max(r,n),i=>{this.rowHeightsMap.setValueAtIndex(i,null)})},!0)}isNeedRecalculate(){return!!this.rowHeightsMap.getValues().slice(0,this.measuredRows).filter(e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function h_e(t){const e={from:0,to:this.hot.countCols()-1};t.forEach(r=>{this.samplesGenerator.generateRowSamples(r,e).forEach((i,s)=>this.ghostTable.addRow(s,i))}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((r,n)=>{const i=this.hot.toPhysicalRow(r);this.rowHeightsMap.setValueAtIndex(i,n)})},!0),this.ghostTable.clean())}function f_e(){this.calculateVisibleRowsHeight(),this.inProgress||(vu(Tc,this,h_e).call(this,c_(A1,this)),_J(A1,this,[]))}function K7(t,e,r){let n=t;return r&&(this.calculateRowsHeight(e,void 0,!0),n=this.getRowHeight(e)),n}function d_e(t,e){e||this.recalculateAllRowsHeight()}function g_e(t){const e=t.reduce((r,n)=>{let[i]=n;return r.indexOf(i)===-1&&r.push(i),r},[]);c_(A1,this).push(...e)}function m_e(){this.recalculateAllRowsHeight(),_J(a3,this,!0)}function p_e(t){if(!c_(a3,this))return;const e=t.reduce((r,n)=>{var i;const s=(i=n.address)===null||i===void 0?void 0:i.row;if(Number.isInteger(s)){const a=this.hot.toVisualRow(s);r.indexOf(a)===-1&&r.push(a)}return r},[]);c_(A1,this).push(...e)}const{getListWithInsertedItems:v_e,getListWithRemovedItems:w_e}=yZ("physicallyIndexed");class y_e extends lm{constructor(){super(e=>e)}insert(e,r){const n=cL(this.indexedValues,r);this.indexedValues=v_e(n,e,r,this.initValueOrFn),super.insert(e,r)}remove(e){const r=w_e(this.indexedValues,e);this.indexedValues=uL(r,e),super.remove(e)}}const{getListWithInsertedItems:S_e,getListWithRemovedItems:b_e}=yZ("physicallyIndexed");class C_e extends lm{constructor(){super(e=>e)}insert(e,r){this.indexedValues=S_e(this.indexedValues,e,r,(n,i)=>this.getNextValue(i)),super.insert(e,r)}remove(e){this.indexedValues=b_e(this.indexedValues,e),super.remove(e)}getNextValue(e){return Math.max(...this.getValues())+1+e}}function x_e(t,e){E_e(t,e),e.add(t)}function E_e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function __e(t,e,r){return(e=R_e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function R_e(t){var e=T_e(t,"string");return typeof e=="symbol"?e:e+""}function T_e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function M_e(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const X7="bindRowsWithHeaders",A_e=210,O_e="loose",Q7=new Map([["loose",y_e],["strict",C_e]]);var Z7=new WeakSet;class k_e extends ur{constructor(){super(...arguments),x_e(this,Z7),__e(this,"headerIndexes",null)}static get PLUGIN_KEY(){return X7}static get PLUGIN_PRIORITY(){return A_e}isEnabled(){return!!this.hot.getSettings()[X7]}enablePlugin(){var e;if(this.enabled)return;const r=(e=Q7.get(this.getSetting()))!==null&&e!==void 0?e:Q7.get(O_e);this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new r),this.addHook("modifyRowHeader",n=>M_e(Z7,this,D_e).call(this,n)),super.enablePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),super.disablePlugin()}destroy(){super.destroy()}}function D_e(t){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(t))}function P_e(t,e){RJ(t,e),e.add(t)}function I_e(t,e,r){RJ(t,e),e.set(t,r)}function RJ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function J7(t,e,r){return(e=N_e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function N_e(t){var e=H_e(t,"string");return typeof e=="symbol"?e:e+""}function H_e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function eY(t,e){return t.get(rp(t,e))}function V2(t,e,r){return t.set(rp(t,e),r),r}function rp(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const bE="collapsibleColumns",F_e=290,L_e=["nestedHeaders"],mp="collapsibleIndicator",tY=bE,rY=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]);var p0=new WeakMap,Ww=new WeakSet;class B_e extends ur{constructor(){super(...arguments),P_e(this,Ww),J7(this,"nestedHeadersPlugin",null),J7(this,"headerStateManager",null),I_e(this,p0,null)}static get PLUGIN_KEY(){return bE}static get PLUGIN_PRIORITY(){return F_e}static get PLUGIN_DEPS(){return["plugin:NestedHeaders"]}static get SETTING_KEYS(){return[bE,...L_e]}isEnabled(){return!!this.hot.getSettings()[bE]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:r}=this.hot.getSettings();r||br("You need to configure the Nested Headers plugin in order to use collapsible headers."),V2(p0,this,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",()=>rp(Ww,this,$_e).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return rp(Ww,e,U_e).call(e,...i)}),this.addHook("afterGetColHeader",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return rp(Ww,e,V_e).call(e,...i)}),this.addHook("beforeOnCellMouseDown",(n,i,s)=>rp(Ww,this,W_e).call(this,n,i,s)),this.registerShortcuts(),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){const{collapsibleColumns:e}=this.hot.getSettings();typeof e=="boolean"?this.headerStateManager.mapState(r=>({collapsible:r.origColspan>1})):Array.isArray(e)&&(this.headerStateManager.mapState(()=>({collapsible:!1})),this.headerStateManager.mergeStateWith(e))}super.updatePlugin()}}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),V2(p0,this,null),this.nestedHeadersPlugin=null,this.unregisterShortcuts(),this.clearButtons(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{var e;const{row:r,col:n}=this.hot.getSelectedRangeLast().highlight,{collapsible:i,isCollapsed:s,columnIndex:a}=(e=this.headerStateManager.getHeaderTreeNodeData(r,n))!==null&&e!==void 0?e:{};if(i)return s?this.expandSection({row:r,col:a}):this.collapseSection({row:r,col:a}),!1},runOnlyIf:()=>{var e,r;return((e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.isSingle())&&((r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.highlight.isHeader())},group:tY,relativeToGroup:ed,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(tY)}clearButtons(){if(!this.hot.view)return;const e=this.hot.view._wt.getSetting("columnHeaders").length,r=this.hot.view._wt.wtTable.THEAD,n=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,i=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,s=function(a){a&&a.parentNode.removeChild(a)};ct(0,e-1,a=>{const o=r.childNodes[a],u=n.childNodes[a],c=i?i.childNodes[a]:null;ct(0,o.childNodes.length-1,f=>{let g=o.childNodes[f].querySelector(`.${mp}`);s(g),u&&u.childNodes[f]&&(g=u.childNodes[f].querySelector(`.${mp}`),s(g)),i&&c&&c.childNodes[f]&&(g=c.childNodes[f].querySelector(`.${mp}`),s(g))})})}expandSection(e){this.toggleCollapsibleSection([e],"expand")}collapseSection(e){this.toggleCollapsibleSection([e],"collapse")}toggleAllCollapsibleSections(e){const r=this.headerStateManager.mapNodes(n=>{const{collapsible:i,origColspan:s,headerLevel:a,columnIndex:o,isCollapsed:u}=n;if(i===!0&&s>1&&(u&&e==="expand"||!u&&e==="collapse"))return{row:this.headerStateManager.levelToRowCoords(a),col:o}});this.toggleCollapsibleSection(r,e)}collapseAll(){this.toggleAllCollapsibleSections("collapse")}expandAll(){this.toggleAllCollapsibleSections("expand")}toggleCollapsibleSection(e,r){if(!rY.has(r))throw new Error(`Unsupported action is passed (${r}).`);if(!Array.isArray(e))return;const n=Ff(e,v=>{let{row:w}=v;return w<0});let i=n.length>0;he(n,v=>{var w;let{row:y,col:b}=v;const{collapsible:x,isCollapsed:_}=(w=this.headerStateManager.getHeaderSettings(y,b))!==null&&w!==void 0?w:{};if(!x||_&&r==="collapse"||!_&&r==="expand")return i=!1,!1});const s=[],a=[];i&&he(n,v=>{let{row:w,col:y}=v;const{colspanCompensation:b,affectedColumns:x,rollbackModification:_}=this.headerStateManager.triggerNodeModification(r,w,y);b>0&&(a.push(...x),s.push(_))});const o=this.getCollapsedColumns();let u=[];r==="collapse"?u=rQ([...o,...a]):r==="expand"&&(u=Ff(o,v=>!a.includes(v)));const c=rY.get(r);if(this.hot.runHooks(c.beforeHook,o,u,i)===!1){he(s,v=>{v()});return}this.hot.batchExecution(()=>{he(a,v=>{eY(p0,this).setValueAtIndex(this.hot.toPhysicalColumn(v),c.hideColumn)})},!0);const g=this.getCollapsedColumns().length!==o.length,m=this.hot.getSelectedRangeLast();if(r==="collapse"&&g&&m){const{row:v,col:w}=m.highlight;if((this.hot.rowIndexMapper.isHidden(v)||this.hot.columnIndexMapper.isHidden(w))&&a.includes(w)){const b=v>=0?this.hot.rowIndexMapper.getNearestNotHiddenIndex(v,1,!0):v,x=w>=0?this.hot.columnIndexMapper.getNearestNotHiddenIndex(w,1,!0):w;b!==null&&x!==null&&this.hot.selectCell(b,x)}}this.hot.runHooks(c.afterHook,o,u,i,g),this.hot.render(),this.hot.view.adjustElementsSize()}getCollapsedColumns(){return eY(p0,this).getHiddenIndexes()}destroy(){V2(p0,this,null),super.destroy()}}function V_e(t,e,r){var n;const{collapsible:i,origColspan:s,isCollapsed:a}=(n=this.headerStateManager.getHeaderSettings(r,t))!==null&&n!==void 0?n:{},o=i&&s>1&&t>=this.hot.getSettings().fixedColumnsStart,u=this.hot.getSettings().ariaTags;let c=e.querySelector(`.${mp}`);if(am(e,[Vo("")[0]]),o)c||(c=this.hot.rootDocument.createElement("div"),Ve(c,mp),e.querySelector("div:first-child").appendChild(c)),wt(c,["collapsed","expanded"]),a?(Ve(c,"collapsed"),Bf(c,"+"),u&&bt(e,...Vo(!1))):(Ve(c,"expanded"),Bf(c,"-"),u&&bt(e,...Vo(!0))),u&&bt(c,...sm());else{var f;(f=c)===null||f===void 0||f.remove()}}function W_e(t,e){Ct(t.target,mp)&&(Ct(t.target,"expanded")?(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"collapse")):Ct(t.target,"collapsed")&&(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"expand")),Qo(t))}function $_e(){this.updatePlugin()}function U_e(t,e){e||this.updatePlugin()}function Vd(t,e,r){return(e=j_e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function j_e(t){var e=Y_e(t,"string");return typeof e=="symbol"?e:e+""}function Y_e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const z_e=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"],G_e=!1,q_e=!0,K_e=!0;class X_e{constructor(e,r){Vd(this,"hot",void 0),Vd(this,"sortingStates",new JR),Vd(this,"sortEmptyCells",G_e),Vd(this,"indicator",q_e),Vd(this,"headerAction",K_e),Vd(this,"compareFunctionFactory",void 0),Vd(this,"mapName",void 0),this.hot=e,this.mapName=r,this.hot.columnIndexMapper.registerMap(r,this.sortingStates)}updateAllColumnsProperties(e){Vt(e)&&Wt(e,(r,n)=>{z_e.includes(n)&&(this[n]=r)})}getAllColumnsProperties(){const e={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return typeof this.compareFunctionFactory=="function"&&(e.compareFunctionFactory=this.compareFunctionFactory),e}getSortOrderOfColumn(e){var r;return(r=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))===null||r===void 0?void 0:r.sortOrder}getIndexOfColumnInSortQueue(e){return e=this.hot.toPhysicalColumn(e),this.sortingStates.getEntries().findIndex(r=>{let[n]=r;return n===e})}getNumberOfSortedColumns(){return this.sortingStates.getLength()}isListOfSortedColumnsEmpty(){return this.getNumberOfSortedColumns()===0}isColumnSorted(e){return Vt(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))}getSortStates(){return this.sortingStates===null?[]:this.sortingStates.getEntries().map(r=>{let[n,i]=r;return{column:this.hot.toVisualColumn(n),...i}})}getColumnSortState(e){const r=this.getSortOrderOfColumn(e);if(it(r))return{column:e,sortOrder:r}}setSortStates(e){this.sortingStates.clear();for(let r=0;r<e.length;r+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(e[r].column),{sortOrder:e[r].sortOrder})}destroy(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}}function TJ(t,e,r){const n=e.locale;return function(i,s){const{sortEmptyCells:a}=r;return typeof i=="string"&&(i=i.toLocaleLowerCase(n)),typeof s=="string"&&(s=s.toLocaleLowerCase(n)),i===s?Nu:In(i)?In(s)?Nu:a&&t==="asc"?An:On:In(s)?a&&t==="asc"?On:An:isNaN(i)&&!isNaN(s)?t==="asc"?On:An:!isNaN(i)&&isNaN(s)||(isNaN(i)||isNaN(s)||(i=parseFloat(i),s=parseFloat(s)),i<s)?t==="asc"?An:On:i>s?t==="asc"?On:An:Nu}}const MJ="default";function Q_e(t,e,r){return function(n,i){const s=parseFloat(n),a=parseFloat(i),{sortEmptyCells:o}=r;if(s===a||isNaN(s)&&isNaN(a))return Nu;if(o){if(In(n))return t==="asc"?An:On;if(In(i))return t==="asc"?On:An}return isNaN(s)?On:isNaN(a)?An:s<a?t==="asc"?An:On:s>a?t==="asc"?On:An:Nu}}const Z_e="numeric";function J_e(t,e,r){const n=e.checkedTemplate,i=e.uncheckedTemplate,{sortEmptyCells:s}=r;return function(a,o){const u=In(a),c=In(o),f=u?i:a,g=c?i:o,m=f===i||f===n,v=g===i||g===n;if(s===!1){if(u&&c===!1)return On;if(u===!1&&c)return An}return m===!1&&v?t==="asc"?An:On:m&&v===!1?t==="asc"?On:An:m===!1&&v===!1?TJ(t,e,r)(a,o):f===i&&g===n?t==="asc"?An:On:f===n&&g===i?t==="asc"?On:An:Nu}}const eRe="checkbox";function tRe(t,e,r){return IJ(t,e.dateFormat,r)}const rRe="date";function nRe(t,e,r){return IJ(t,e.timeFormat,r)}const iRe="time",{register:kS,getItem:nY,hasItem:sRe}=Zo("sorting.compareFunctionFactory"),{register:AJ,getItem:aRe}=Zo("sorting.mainSortComparator");function OJ(t){return sRe(t)?nY(t):nY(MJ)}kS(eRe,J_e);kS(rRe,tRe);kS(MJ,TJ);kS(Z_e,Q_e);kS(iRe,nRe);const Nu=0,An=-1,On=1;function oRe(t,e){const r=aRe(e);for(var n=arguments.length,i=new Array(n>2?n-2:0),s=2;s<n;s++)i[s-2]=arguments[s];t.sort(r(...i))}const h_="asc",f_="desc",kJ="colHeader";function lRe(t){if(Vt(t)===!1)return!1;const{column:e,sortOrder:r}=t;return Number.isInteger(e)&&[h_,f_].includes(r)}function uRe(t){if(t.some(r=>lRe(r)===!1))return!1;const e=t.map(r=>{let{column:n}=r;return n});return new Set(e).size===e.length}function iY(t){if(t!==f_)return t===h_?f_:h_}function DJ(t){return t.querySelector(`.${kJ}`)}function PJ(t,e){if(t<0||!e.parentNode)return!1;const r=e.parentNode.parentNode.childNodes;return Array.from(r).indexOf(e.parentNode)-r.length===-1}function o3(t,e,r){return t===-1&&e>=0&&Vf(r)===!1}function IJ(t,e,r){return function(n,i){const{sortEmptyCells:s}=r;if(n===i)return Nu;if(In(n))return In(i)?Nu:s&&t==="asc"?An:On;if(In(i))return s&&t==="asc"?On:An;const a=je(n,e),o=je(i,e);return a.isValid()?o.isValid()?o.isAfter(a)?t==="asc"?An:On:o.isBefore(a)?t==="asc"?On:An:Nu:An:On}}function cRe(t,e){br(Dr`Plugins \`columnSorting\` and \`multiColumnSorting\` should not be enabled simultaneously.\x20
    Only \`${t}\` will work. The \`${e}\` plugin will remain disabled.`)}const hRe="ascending",fRe="descending",NJ="indicatorDisabled",HJ="columnSorting",FJ="sortAction",LJ=new Map([[h_,hRe],[f_,fRe]]);function dRe(t,e,r,n){const i=[HJ];if(n&&i.push(FJ),r===!1)return i.push(NJ),i;const s=t.getSortOrderOfColumn(e);return it(s)&&i.push(LJ.get(s)),i}function gRe(){return Array.from(LJ.values()).concat(FJ,NJ,HJ)}function mRe(t,e){return function(r,n){const[,...i]=r,[,...s]=n;return function(o){const u=t[o],c=e[o],f=i[o],g=s[o],m=c.columnSorting;return(m.compareFunctionFactory?m.compareFunctionFactory:OJ(c.type))(u,c,m)(f,g)}(0)}}function pRe(t,e){vRe(t,e),e.add(t)}function vRe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function GC(t,e,r){return(e=wRe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function wRe(t){var e=yRe(t,"string");return typeof e=="symbol"?e:e+""}function yRe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function q0(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const d_="columnSorting",SRe=50,g_="append",bRe="replace",sY=d_;AJ(d_,mRe);Je.getSingleton().register("beforeColumnSort");Je.getSingleton().register("afterColumnSort");const $w=new WeakMap;var lg=new WeakSet;class BJ extends ur{constructor(){super(...arguments),pRe(this,lg),GC(this,"columnStatesManager",null),GC(this,"columnMetaCache",null),GC(this,"pluginKey",d_),GC(this,"indexesSequenceCache",null)}static get PLUGIN_KEY(){return d_}static get PLUGIN_PRIORITY(){return SRe}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){var e=this;if($w.has(this.hot)&&$w.get(this.hot)!==this.pluginKey){this.hot.updateSettings({[this.pluginKey]:!1}),cRe($w.get(this.hot),this.pluginKey);return}this.enabled||($w.set(this.hot,this.pluginKey),this.columnStatesManager=new X_e(this.hot,`${this.pluginKey}.sortingStates`),this.columnMetaCache=new Jf(r=>{let n=this.hot.toVisualColumn(r);return n===null&&(n=r),this.getMergedPluginSettings(n)}),this.hot.columnIndexMapper.registerMap(`${this.pluginKey}.columnMeta`,this.columnMetaCache),this.addHook("afterGetColHeader",(r,n)=>q0(lg,this,CRe).call(this,r,n)),this.addHook("beforeOnCellMouseDown",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return q0(lg,e,ERe).call(e,...n)}),this.addHook("afterOnCellMouseDown",(r,n)=>this.onAfterOnCellMouseDown(r,n)),this.addHook("afterInit",()=>q0(lg,this,EN).call(this)),this.addHook("afterLoadData",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return q0(lg,e,xRe).call(e,...n)}),this.hot.view&&q0(lg,this,EN).call(this),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){const e=(r,n)=>{const i=DJ(n);PJ(r,n)===!1||i===null||this.updateHeaderClasses(i)};$w.delete(this.hot),this.hot.addHook("afterGetColHeader",e),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("afterGetColHeader",e)}),this.hot.batchExecution(()=>{this.indexesSequenceCache!==null&&(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginKey),this.indexesSequenceCache=null)},!0),this.hot.columnIndexMapper.unregisterMap(`${this.pluginKey}.columnMeta`),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();return this.sort(this.getColumnNextConfig(e.col)),!1},runOnlyIf:()=>{var e,r;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n&&((r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.isSingle())&&this.hot.selection.isCellVisible(n)&&n.row===-1&&n.col>=0},relativeToGroup:ed,position:"before",group:sY})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(sY)}sort(e){const r=this.getSortConfig(),n=this.getNormalizedSortConfigs(e),i=this.areValidSortConfigs(n);this.hot.runHooks("beforeColumnSort",r,n,i)!==!1&&(r.length===0&&this.indexesSequenceCache===null&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new SZ),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),i&&(this.columnStatesManager.setSortStates(n),this.sortByPresetSortStates(n),this.saveAllSortSettings(n)),this.hot.runHooks("afterColumnSort",r,i?n:r,i),i&&this.hot.render())}clearSort(){this.sort([])}isSorted(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}getSortConfig(e){return it(e)?this.columnStatesManager.getColumnSortState(e):this.columnStatesManager.getSortStates()}setSortConfig(e){const r=this.getNormalizedSortConfigs(e);this.areValidSortConfigs(r)&&this.columnStatesManager.setSortStates(r)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e.slice(0,1):[e]}areValidSortConfigs(e){const r=this.hot.countCols();return uRe(e)&&e.every(n=>{let{column:i}=n;return i<=r&&i>=0})}saveAllSortSettings(e){const r=this.columnStatesManager.getAllColumnsProperties(),n=i=>{let{column:s,...a}=i;return{column:this.hot.toPhysicalColumn(s),...a}};r.initialConfig=nr(e,n),this.hot.runHooks("persistentStateSave","columnSorting",r)}getAllSavedSortSettings(){const e={};this.hot.runHooks("persistentStateLoad","columnSorting",e);const r=e.value,n=i=>{let{column:s,...a}=i;return{column:this.hot.toVisualColumn(s),...a}};return it(r)&&Array.isArray(r.initialConfig)&&(r.initialConfig=nr(r.initialConfig,n)),r}getColumnNextConfig(e){const r=this.columnStatesManager.getSortOrderOfColumn(e);if(it(r)){const i=iY(r);return it(i)?{column:e,sortOrder:i}:void 0}const n=this.hot.countCols();if(Number.isInteger(e)&&e>=0&&e<n)return{column:e,sortOrder:iY()}}getNextSortConfig(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:g_;const n=this.columnStatesManager.getIndexOfColumnInSortQueue(e),i=n!==-1,s=this.getSortConfig(),a=this.getColumnNextConfig(e);if(i){if(gn(a))return[...s.slice(0,n),...s.slice(n+1)];if(r===g_)return[...s.slice(0,n),...s.slice(n+1),a];if(r===bRe)return[...s.slice(0,n),a,...s.slice(n+1)]}return it(a)?s.concat(a):s}getPluginColumnConfig(e){if(Vt(e)){const r=e[this.pluginKey];if(Vt(r))return r}return{}}getMergedPluginSettings(e){const r=this.hot.getSettings()[this.pluginKey],n=this.columnStatesManager.getAllColumnsProperties(),i=this.hot.getCellMeta(0,e),s=Object.getPrototypeOf(i);return Array.isArray(s.columns)?Object.assign(n,r,this.getPluginColumnConfig(s.columns[e])):kr(s.columns)?Object.assign(n,r,this.getPluginColumnConfig(s.columns(e))):Object.assign(n,r)}getFirstCellSettings(e){const r=this.hot.getCellMeta(0,e),n=Object.create(r);return n[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(e)),n}getNumberOfRowsToSort(e){const r=this.hot.getSettings();return r.maxRows<=e?r.maxRows:e-r.minSpareRows}sortByPresetSortStates(e){if(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),e.length===0)return;const r=[],n=this.hot.countRows(),i=c=>nr(e,f=>this.hot.getDataAtCell(c,f.column));for(let c=0;c<this.getNumberOfRowsToSort(n);c+=1)r.push([this.hot.toPhysicalRow(c)].concat(i(c)));const s=nr(r,c=>c[0]);oRe(r,this.pluginKey,nr(e,c=>c.sortOrder),nr(e,c=>this.getFirstCellSettings(c.column)));for(let c=r.length;c<n;c+=1)r.push([c].concat(i(c)));const a=nr(r,c=>c[0]),o=new Map(nr(s,(c,f)=>[c,a[f]])),u=nr(this.hot.rowIndexMapper.getIndexesSequence(),c=>o.has(c)?o.get(c):c);this.hot.rowIndexMapper.setIndexesSequence(u)}sortBySettings(e){if(Vt(e)){this.columnStatesManager.updateAllColumnsProperties(e);const r=e.initialConfig;(Array.isArray(r)||Vt(r))&&this.sort(r)}else this.hot.render()}updateHeaderClasses(e){if(wt(e,gRe()),this.enabled!==!1){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];Ve(e,dRe(...n))}}onUpdateSettings(e){super.onUpdateSettings(e),this.columnMetaCache!==null&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),it(e[this.pluginKey])&&this.sortBySettings(e[this.pluginKey])}wasClickableHeaderClicked(e,r){return this.getFirstCellSettings(r)[this.pluginKey].headerAction&&Ct(e.target,kJ)}onAfterOnCellMouseDown(e,r){if(o3(r.row,r.col,e)!==!1&&this.wasClickableHeaderClicked(e,r.col)){this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(r.col));const n=this.hot.getActiveEditor(),i=this.getColumnNextConfig(r.col);n!=null&&n.isOpened()&&this.hot.getCellValidator(n.row,n.col)?this.hot.addHookOnce("postAfterValidate",()=>{this.sort(i)}):this.sort(i)}}destroy(){var e;(e=this.columnStatesManager)===null||e===void 0||e.destroy(),super.destroy()}}function EN(){const t=this.getAllSavedSortSettings();if(Vt(t))this.sortBySettings(t);else{const e=this.hot.getSettings()[this.pluginKey];this.sortBySettings(e)}}function CRe(t,e){const r=DJ(e);if(PJ(t,e)===!1||r===null)return;const n=this.getFirstCellSettings(t)[this.pluginKey],i=n.indicator,s=n.headerAction;if(this.updateHeaderClasses(r,this.columnStatesManager,t,i,s),this.hot.getSettings().ariaTags){const a=this.columnStatesManager.getSortOrderOfColumn(t);bt(e,...Pme(a?`${a}ending`:"none"))}}function xRe(t){t===!0&&this.hot.view&&q0(lg,this,EN).call(this)}function ERe(t,e,r,n){o3(e.row,e.col,t)!==!1&&this.wasClickableHeaderClicked(t,e.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(n.column=!0)}function Wd(t,e,r){return(e=_Re(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _Re(t){var e=RRe(t,"string");return typeof e=="symbol"?e:e+""}function RRe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class TRe{constructor(e,r){Wd(this,"plugin",void 0),Wd(this,"hot",void 0),Wd(this,"endpoints",[]),Wd(this,"settings",void 0),Wd(this,"settingsType","array"),Wd(this,"currentEndpoint",null),Wd(this,"cellsToSetCache",[]),this.plugin=e,this.hot=this.plugin.hot,this.settings=r}initEndpoints(){this.endpoints=this.parseSettings(),this.refreshAllEndpoints()}getEndpoint(e){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings)[e]:this.endpoints[e]}getAllEndpoints(){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings):this.endpoints}fillMissingEndpointData(e){return this.parseSettings(e.call(this))}parseSettings(e){const r=[];let n=e;if(!n&&typeof this.settings=="function"){this.settingsType="function";return}return n||(n=this.settings),he(n,i=>{const s={};this.assignSetting(i,s,"ranges",[[0,this.hot.countRows()-1]]),this.assignSetting(i,s,"reversedRowCoords",!1),this.assignSetting(i,s,"destinationRow",new Error(`
        You must provide a destination row for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(i,s,"destinationColumn",new Error(`
        You must provide a destination column for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(i,s,"sourceColumn",i.destinationColumn),this.assignSetting(i,s,"type","sum"),this.assignSetting(i,s,"forceNumeric",!1),this.assignSetting(i,s,"suppressDataTypeErrors",!0),this.assignSetting(i,s,"customFunction",null),this.assignSetting(i,s,"readOnly",!0),this.assignSetting(i,s,"roundFloat",!1),r.push(s)}),r}assignSetting(e,r,n,i){if(n==="ranges"&&e[n]===void 0){r[n]=i;return}else if(n==="ranges"&&e[n].length===0)return;if(e[n]===void 0){if(i instanceof Error)throw i;r[n]=i}else n==="destinationRow"&&r.reversedRowCoords?r[n]=this.hot.countRows()-e[n]-1:r[n]=e[n]}resetSetupBeforeStructureAlteration(e,r,n){if(this.settingsType!=="function")return;const i=e.indexOf("row")>-1?"row":"col",s=this.getAllEndpoints();he(s,a=>{i==="row"&&a.destinationRow>=r&&(e==="insert_row"?a.alterRowOffset=n:e==="remove_row"&&(a.alterRowOffset=-1*n)),i==="col"&&a.destinationColumn>=r&&(e==="insert_col"?a.alterColumnOffset=n:e==="remove_col"&&(a.alterColumnOffset=-1*n))}),this.resetAllEndpoints(s,!1)}resetSetupAfterStructureAlteration(e,r,n,i,s){let a=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;if(this.settingsType==="function"){const m=()=>(this.hot.removeHook("beforeViewRender",m),this.refreshAllEndpoints());this.hot.addHookOnce("beforeViewRender",m);return}const o=e.indexOf("row")>-1?"row":"col",u=e.indexOf("remove")>-1?-1:1,c=this.getAllEndpoints(),f=e.indexOf("move_row")===0,g=r;he(c,m=>{o==="row"&&m.destinationRow>=g&&(m.alterRowOffset=u*n),o==="col"&&m.destinationColumn>=g&&(m.alterColumnOffset=u*n)}),this.resetAllEndpoints(c,!f),f?he(c,m=>{this.extendEndpointRanges(m,g,i[0],i.length),this.recreatePhysicalRanges(m),this.clearOffsetInformation(m)}):he(c,m=>{this.shiftEndpointCoordinates(m,g)}),a&&this.refreshAllEndpoints()}clearOffsetInformation(e){e.alterRowOffset=void 0,e.alterColumnOffset=void 0}extendEndpointRanges(e,r,n,i){he(e.ranges,s=>{s[1]&&(r>=s[0]&&r<=s[1]?n>s[1]?s[1]+=i:n<s[0]&&(s[0]-=i):n>=s[0]&&n<=s[1]&&(s[1]-=i,r<=s[0]&&(s[0]+=1,s[1]+=1)))})}recreatePhysicalRanges(e){const r=e.ranges,n=[],i=[];he(r,s=>{const a=[];if(s[1])for(let o=s[0];o<=s[1];o++)a.push(this.hot.toPhysicalRow(o));else a.push(this.hot.toPhysicalRow(s[0]));i.push(a)}),he(i,s=>{let a=[];he(s,(o,u)=>{u===0?a.push(o):s[u]!==s[u-1]+1&&(a.push(s[u-1]),n.push(a),a=[],a.push(o)),u===s.length-1&&(a.push(o),n.push(a))})}),e.ranges=n}shiftEndpointCoordinates(e,r){e.alterRowOffset&&e.alterRowOffset!==0?(e.destinationRow+=e.alterRowOffset||0,he(e.ranges,n=>{he(n,(i,s)=>{i>=r&&(n[s]+=e.alterRowOffset||0)})})):e.alterColumnOffset&&e.alterColumnOffset!==0&&(e.destinationColumn+=e.alterColumnOffset||0,e.sourceColumn+=e.alterColumnOffset||0)}resetAllEndpoints(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getAllEndpoints(),r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;e.some(i=>{const s=i.alterRowOffset||0,a=i.alterColumnOffset||0;return i.destinationRow+s>=this.hot.countRows()||i.destinationColumn+a>=this.hot.countCols()})||(this.cellsToSetCache=[],he(e,i=>{this.resetEndpointValue(i,r)}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}refreshAllEndpoints(){this.cellsToSetCache=[],he(this.getAllEndpoints(),e=>{this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e,"init")}),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshChangedEndpoints(e){const r=[];this.cellsToSetCache=[],he(e,(n,i,s)=>{`${n[2]||""}`!=`${n[3]}`&&he(this.getAllEndpoints(),(a,o)=>{this.hot.propToCol(s[i][1])===a.sourceColumn&&r.indexOf(o)===-1&&r.push(o)})}),he(r,n=>{this.refreshEndpoint(this.getEndpoint(n))}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshCellMetas(){this.endpoints.forEach(e=>{const r=this.hot.toVisualRow(e.destinationRow);if(r!==null){const n=this.hot.getCellMeta(r,e.destinationColumn);n.readOnly=e.readOnly,n.className="columnSummaryResult"}})}refreshEndpoint(e){this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e),this.currentEndpoint=null}resetEndpointValue(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const n=e.alterRowOffset||0,i=e.alterColumnOffset||0;this.cellsToSetCache.push([this.hot.toVisualRow(e.destinationRow+(r?n:0)),this.hot.toVisualColumn(e.destinationColumn+(r?i:0)),""])}setEndpointValue(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=this.hot.toVisualRow(e.destinationRow);if(e.destinationRow>=this.hot.countRows()||e.destinationColumn>=this.hot.countCols()){this.throwOutOfBoundsWarning();return}const s=this.hot.toVisualRow(e.destinationRow);if(s!==null){const a=this.hot.getCellMeta(s,e.destinationColumn);(r==="init"||a.readOnly!==e.readOnly)&&(a.readOnly=e.readOnly,a.className="columnSummaryResult")}if((e.roundFloat===!0||Number.isInteger(e.roundFloat))&&!isNaN(e.result)){const a=e.roundFloat;let o=0;Number.isInteger(a)&&(o=Math.min(Math.max(0,a),100)),e.result=e.result.toFixed(o)}n?this.hot.setDataAtCell(i,e.destinationColumn,e.result,"ColumnSummary.set"):this.cellsToSetCache.push([i,e.destinationColumn,e.result]),e.alterRowOffset=void 0,e.alterColumnOffset=void 0}throwOutOfBoundsWarning(){br("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}}function W2(t){return t==null||isNaN(t)}function MRe(t,e){ARe(t,e),e.add(t)}function ARe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ORe(t,e,r){return(e=kRe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function kRe(t){var e=DRe(t,"string");return typeof e=="symbol"?e:e+""}function DRe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function qC(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const $2="columnSummary",PRe=220;var Uw=new WeakSet;class IRe extends ur{constructor(){super(...arguments),MRe(this,Uw),ORe(this,"endpoints",null)}static get PLUGIN_KEY(){return $2}static get PLUGIN_PRIORITY(){return PRe}isEnabled(){return!!this.hot.getSettings()[$2]}enablePlugin(){var e=this;this.enabled||(this.settings=this.hot.getSettings()[$2],this.endpoints=new TRe(this,this.settings),this.addHook("afterInit",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return qC(Uw,e,NRe).call(e,...n)}),this.addHook("afterChange",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return qC(Uw,e,FRe).call(e,...n)}),this.addHook("afterUpdateSettings",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return qC(Uw,e,HRe).call(e,...n)}),this.addHook("beforeCreateRow",(r,n,i)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_row",r,n,null,i)),this.addHook("beforeCreateCol",(r,n,i)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_col",r,n,null,i)),this.addHook("beforeRemoveRow",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return e.endpoints.resetSetupBeforeStructureAlteration("remove_row",...n)}),this.addHook("beforeRemoveCol",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return e.endpoints.resetSetupBeforeStructureAlteration("remove_col",...n)}),this.addHook("afterCreateRow",(r,n,i)=>this.endpoints.resetSetupAfterStructureAlteration("insert_row",r,n,null,i)),this.addHook("afterCreateCol",(r,n,i)=>this.endpoints.resetSetupAfterStructureAlteration("insert_col",r,n,null,i)),this.addHook("afterRemoveRow",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return e.endpoints.resetSetupAfterStructureAlteration("remove_row",...n)}),this.addHook("afterRemoveCol",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return e.endpoints.resetSetupAfterStructureAlteration("remove_col",...n)}),this.addHook("afterRowMove",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return qC(Uw,e,LRe).call(e,...n)}),super.enablePlugin())}disablePlugin(){this.endpoints=null,this.settings=null,this.currentEndpoint=null,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.endpoints.initEndpoints(),super.updatePlugin()}calculate(e){switch(e.type.toLowerCase()){case"sum":e.result=this.calculateSum(e);break;case"min":e.result=this.calculateMinMax(e,e.type);break;case"max":e.result=this.calculateMinMax(e,e.type);break;case"count":e.result=this.countEntries(e);break;case"average":e.result=this.calculateAverage(e);break;case"custom":e.result=e.customFunction.call(this,e);break}}calculateSum(e){let r=0;return Wt(e.ranges,n=>{r+=this.getPartialSum(n,e.sourceColumn)}),r}getPartialSum(e,r){let n=0,i=e[1]||e[0],s=null,a=0;do{if(s=this.getCellValue(i,r),s=W2(s)?null:s,s!==null){const o=(`${s}`.split(".")[1]||[]).length||1;o>a&&(a=o)}n+=s||0,i-=1}while(i>=e[0]);return Math.round(n*10**a)/10**a}calculateMinMax(e,r){let n=null;return Wt(e.ranges,i=>{const s=this.getPartialMinMax(i,e.sourceColumn,r);if(n===null&&s!==null&&(n=s),s!==null)switch(r){case"min":n=Math.min(n,s);break;case"max":n=Math.max(n,s);break}}),n===null?"Not enough data":n}getPartialMinMax(e,r,n){let i=null,s=e[1]||e[0],a;do{if(a=this.getCellValue(s,r),a=W2(a)?null:a,i===null)i=a;else if(a!==null)switch(n){case"min":i=Math.min(i,a);break;case"max":i=Math.max(i,a);break}s-=1}while(s>=e[0]);return i}countEmpty(e,r){let n,i=0,s=e[1]||e[0];do n=this.getCellValue(s,r),n=W2(n)?null:n,n===null&&(i+=1),s-=1;while(s>=e[0]);return i}countEntries(e){let r=0;const n=e.ranges;return Wt(n,i=>{const s=i[1]===void 0?1:i[1]-i[0]+1,a=this.countEmpty(i,e.sourceColumn);r+=s,r-=a}),r}calculateAverage(e){const r=this.calculateSum(e),n=this.countEntries(e);return r/n}getCellValue(e,r){const n=this.hot.toVisualRow(e),i=this.hot.toVisualColumn(r);let s=this.hot.getSourceDataAtCell(e,r),a="";if(n!==null&&i!==null&&(a=this.hot.getCellMeta(n,i).className||""),a.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&(typeof s=="string"&&(s=s.replace(/,/,".")),s=parseFloat(s)),isNaN(s)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error(Dr`ColumnSummary plugin: cell at (${e}, ${r}) is not in a\x20
          numeric format. Cannot do the calculation.`);return s}}function NRe(){this.endpoints.initEndpoints()}function HRe(t){t.columns!==void 0&&this.endpoints.refreshCellMetas()}function FRe(t,e){t&&e!=="ColumnSummary.reset"&&e!=="ColumnSummary.set"&&e!=="loadData"&&this.endpoints.refreshChangedEndpoints(t)}function LRe(t,e){this.endpoints.resetSetupBeforeStructureAlteration("move_row",t[0],t.length,t,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",e,t.length,t,this.pluginName)}function BRe(t,e){VJ(t,e),e.add(t)}function U2(t,e,r){VJ(t,e),e.set(t,r)}function VJ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function K0(t,e){return t.get(l3(t,e))}function _N(t,e,r){return t.set(l3(t,e),r),r}function l3(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var m_=new WeakMap,KC=new WeakMap,XC=new WeakMap,aY=new WeakSet;class WJ{constructor(){BRe(this,aY),U2(this,m_,!0),U2(this,KC,null),U2(this,XC,new ResizeObserver(e=>l3(aY,this,VRe).call(this,e)))}setObservedElement(e){_N(KC,this,e)}unobserve(){K0(XC,this).unobserve(K0(KC,this))}observe(){_N(m_,this,!0),K0(XC,this).observe(K0(KC,this))}destroy(){K0(XC,this).disconnect()}}function VRe(t){if(K0(m_,this)||!Array.isArray(t)||!t.length){_N(m_,this,!1);return}t.forEach(e=>{let{borderBoxSize:r}=e;const{inlineSize:n,blockSize:i}=r[0];this.runLocalHooks("resize",n,i)})}Lr(WJ,as);function Uh(t,e,r){WRe(t,e),e.set(t,r)}function WRe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Wr(t,e){return t.get($J(t,e))}function Ql(t,e,r){return t.set($J(t,e),r),r}function $J(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var v0=new WeakMap,j2=new WeakMap,Y2=new WeakMap,bc=new WeakMap,jh=new WeakMap,Yh=new WeakMap,QC=new WeakMap,w0=new WeakMap;class wg{static get CLASS_EDITOR_CONTAINER(){return"htCommentsContainer"}static get CLASS_EDITOR(){return"htComments"}static get CLASS_INPUT(){return"htCommentTextArea"}static get CLASS_CELL(){return"htCommentCell"}constructor(e,r,n){var i=this;Uh(this,v0,void 0),Uh(this,j2,void 0),Uh(this,Y2,!1),Uh(this,bc,null),Uh(this,jh,void 0),Uh(this,Yh,void 0),Uh(this,QC,!0),Uh(this,w0,new WJ),Ql(v0,this,e),Ql(j2,this,n),Ql(Y2,this,r),Ql(jh,this,this.createEditor()),Ql(Yh,this,Wr(jh,this).style),Wr(w0,this).setObservedElement(this.getInputElement()),Wr(w0,this).addLocalHook("resize",function(){for(var s=arguments.length,a=new Array(s),o=0;o<s;o++)a[o]=arguments[o];return i.runLocalHooks("resize",...a)}),this.hide()}setPosition(e,r){Wr(Yh,this).left=`${e}px`,Wr(Yh,this).top=`${r}px`}setSize(e,r){if(e&&r){const n=this.getInputElement();n.style.width=`${e}px`,n.style.height=`${r}px`}}getSize(){return{width:Un(this.getInputElement()),height:ai(this.getInputElement())}}observeSize(){Wr(w0,this).observe()}resetSize(){const e=this.getInputElement();e.style.width="",e.style.height=""}setReadOnlyState(e){const r=this.getInputElement();r.readOnly=e}show(){Wr(Yh,this).display="block",Ql(QC,this,!1)}hide(){Wr(w0,this).unobserve(),Wr(QC,this)||(Wr(Yh,this).display="none"),Ql(QC,this,!0)}isVisible(){return Wr(Yh,this).display==="block"}setValue(){const r=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:"")||"";this.getInputElement().value=r}getValue(){return this.getInputElement().value}isFocused(){return Wr(v0,this).activeElement===this.getInputElement()}focus(){this.getInputElement().focus()}createEditor(){const e=Wr(v0,this).createElement("div"),r=Wr(v0,this).createElement("textarea");return e.style.display="none",Ql(bc,this,Wr(v0,this).createElement("div")),Wr(bc,this).setAttribute("dir",Wr(Y2,this)?"rtl":"ltr"),Ve(Wr(bc,this),wg.CLASS_EDITOR_CONTAINER),Wr(j2,this).appendChild(Wr(bc,this)),Ve(e,wg.CLASS_EDITOR),Ve(r,wg.CLASS_INPUT),r.setAttribute("data-hot-input",!0),e.appendChild(r),Wr(bc,this).appendChild(e),e}getInputElement(){return Wr(jh,this).querySelector(`.${wg.CLASS_INPUT}`)}getEditorElement(){return Wr(jh,this)}destroy(){const e=Wr(bc,this)?Wr(bc,this).parentNode:null;Wr(jh,this).parentNode.removeChild(Wr(jh,this)),Ql(jh,this,null),Ql(Yh,this,null),Wr(w0,this).destroy(),e&&e.removeChild(Wr(bc,this))}}Lr(wg,as);function z2(t,e,r){return(e=$Re(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function $Re(t){var e=URe(t,"string");return typeof e=="symbol"?e:e+""}function URe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const jRe=250,YRe=250;class UJ{constructor(e){z2(this,"wasLastActionShow",!0),z2(this,"showDebounced",null),z2(this,"hidingTimer",null),this.updateDelay(e)}hide(){this.wasLastActionShow=!1,this.hidingTimer=setTimeout(()=>{this.wasLastActionShow===!1&&this.runLocalHooks("hide")},YRe)}show(e){this.wasLastActionShow=!0,this.showDebounced(e)}cancelHiding(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}updateDelay(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:jRe;this.showDebounced=CS(r=>{this.wasLastActionShow&&this.runLocalHooks("show",r.from.row,r.from.col)},e)}destroy(){this.clearLocalHooks()}}Lr(UJ,as);function zRe(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","")} ${e}`}function GRe(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","")} ${e}`}function $d(t,e){const r={};return he(t,n=>{n.forAll((i,s)=>{i>=0&&s>=0&&(r[i]||(r[i]=[]),r[i][s]=e(i,s))})}),r}function lf(t,e,r,n,i){he(t,s=>{s.forAll((a,o)=>{a>=0&&o>=0&&qRe(a,o,e,r,n,i)})})}function qRe(t,e,r,n,i,s){const a=i(t,e);let o=n;a.className&&(r==="vertical"?o=zRe(a.className,n):o=GRe(a.className,n)),s(t,e,"className",o)}function jJ(t){return`<span class="selected">✓</span>${t}`}function CE(t,e){let r=!1;return Array.isArray(t)&&he(t,n=>(n.forAll((i,s)=>{if(i>=0&&s>=0&&e(i,s))return r=!0,!1}),r)),r}function uT(t,e){const r={top:0,left:0};if(e!==t.ownerDocument){const{frameElement:n}=e.defaultView,{top:i,left:s}=n.getBoundingClientRect();r.top=i,r.left=s}return r}const Yt="---------";function KRe(){return{name:Yt}}const Mo="alignment";function XRe(){return{key:Mo,name(){return this.getTranslatedPhrase(NL)},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()?!0:!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:`${Mo}:left`,name(){return this.getTranslatedPhrase(HL)},callback(){const t=this.getSelectedRange(),e=$d(t,(i,s)=>this.getCellMeta(i,s).className),r="horizontal",n="htLeft";this.runHooks("beforeCellAlignment",e,t,r,n),lf(t,r,n,(i,s)=>this.getCellMeta(i,s),(i,s,a,o)=>this.setCellMeta(i,s,a,o)),this.render()},disabled:!1},{key:`${Mo}:center`,name(){return this.getTranslatedPhrase(FL)},callback(){const t=this.getSelectedRange(),e=$d(t,(i,s)=>this.getCellMeta(i,s).className),r="horizontal",n="htCenter";this.runHooks("beforeCellAlignment",e,t,r,n),lf(t,r,n,(i,s)=>this.getCellMeta(i,s),(i,s,a,o)=>this.setCellMeta(i,s,a,o)),this.render()},disabled:!1},{key:`${Mo}:right`,name(){return this.getTranslatedPhrase(LL)},callback(){const t=this.getSelectedRange(),e=$d(t,(i,s)=>this.getCellMeta(i,s).className),r="horizontal",n="htRight";this.runHooks("beforeCellAlignment",e,t,r,n),lf(t,r,n,(i,s)=>this.getCellMeta(i,s),(i,s,a,o)=>this.setCellMeta(i,s,a,o)),this.render()},disabled:!1},{key:`${Mo}:justify`,name(){return this.getTranslatedPhrase(BL)},callback(){const t=this.getSelectedRange(),e=$d(t,(i,s)=>this.getCellMeta(i,s).className),r="horizontal",n="htJustify";this.runHooks("beforeCellAlignment",e,t,r,n),lf(t,r,n,(i,s)=>this.getCellMeta(i,s),(i,s,a,o)=>this.setCellMeta(i,s,a,o)),this.render()},disabled:!1},{name:Yt},{key:`${Mo}:top`,name(){return this.getTranslatedPhrase(VL)},callback(){const t=this.getSelectedRange(),e=$d(t,(i,s)=>this.getCellMeta(i,s).className),r="vertical",n="htTop";this.runHooks("beforeCellAlignment",e,t,r,n),lf(t,r,n,(i,s)=>this.getCellMeta(i,s),(i,s,a,o)=>this.setCellMeta(i,s,a,o)),this.render()},disabled:!1},{key:`${Mo}:middle`,name(){return this.getTranslatedPhrase(WL)},callback(){const t=this.getSelectedRange(),e=$d(t,(i,s)=>this.getCellMeta(i,s).className),r="vertical",n="htMiddle";this.runHooks("beforeCellAlignment",e,t,r,n),lf(t,r,n,(i,s)=>this.getCellMeta(i,s),(i,s,a,o)=>this.setCellMeta(i,s,a,o)),this.render()},disabled:!1},{key:`${Mo}:bottom`,name(){return this.getTranslatedPhrase($L)},callback(){const t=this.getSelectedRange(),e=$d(t,(i,s)=>this.getCellMeta(i,s).className),r="vertical",n="htBottom";this.runHooks("beforeCellAlignment",e,t,r,n),lf(t,r,n,(i,s)=>this.getCellMeta(i,s),(i,s,a,o)=>this.setCellMeta(i,s,a,o)),this.render()},disabled:!1}]}}}const cT="clear_column";function QRe(){return{key:cT,name(){return this.getTranslatedPhrase(bL)},callback(t,e){const r=e[0].start.col,n=e[0].end.col;this.countRows()&&this.populateFromArray(0,r,[[null]],Math.max(e[0].start.row,e[0].end.row),n,"ContextMenu.clearColumn")},disabled(){const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.col<0||!this.selection.isSelectedByColumnHeader())return!0;let e=!1;return t.forAll((r,n)=>{if(r<0||n<0)return!0;const{readOnly:i}=this.getCellMeta(r,n);return i?!0:(e=!0,!1)}),!e}}}const DS="col_left";function ZRe(){return{key:DS,name(){return this.getTranslatedPhrase(mL)},callback(){const t=this.getSelectedRangeLast().getTopLeftCorner(),e=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(e,t.col,1,"ContextMenu.columnLeft")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();return!t||this.selection.isSelectedByRowHeader()||t.isSingleHeader()&&t.highlight.col<0||this.countSourceCols()>=this.getSettings().maxCols?!0:this.selection.isSelectedByCorner()?this.countCols()===0:!1},hidden(){return!this.getSettings().allowInsertColumn}}}const PS="col_right";function JRe(){return{key:PS,name(){return this.getTranslatedPhrase(pL)},callback(){const t=this.getSelectedRangeLast().getTopRightCorner(),e=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(e,t.col,1,"ContextMenu.columnRight")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();return!!(!t||this.selection.isSelectedByRowHeader()||t.isSingleHeader()&&t.highlight.col<0||this.countSourceCols()>=this.getSettings().maxCols)},hidden(){return!this.getSettings().allowInsertColumn}}}const IS="make_read_only";function eTe(){return{key:IS,checkable:!0,ariaChecked(){return CE(this.getSelectedRange(),(e,r)=>this.getCellMeta(e,r).readOnly)},ariaLabel(){return this.getTranslatedPhrase(n_)},name(){let t=this.getTranslatedPhrase(n_);return CE(this.getSelectedRange(),(r,n)=>this.getCellMeta(r,n).readOnly)&&(t=jJ(t)),t},callback(){const t=this.getSelectedRange(),e=CE(t,(r,n)=>this.getCellMeta(r,n).readOnly);he(t,r=>{r.forAll((n,i)=>{n>=0&&i>=0&&this.setCellMeta(n,i,"readOnly",!e)})}),this.render()},disabled(){const t=this.getSelectedRangeLast();return!!(!t||t.isSingleHeader()||this.selection.isSelectedByCorner()||this.countRows()===0||this.countCols()===0||!this.getSelectedRange()||this.getSelectedRange().length===0)}}}const hT="redo";function tTe(){return{key:hT,name(){return this.getTranslatedPhrase(SL)},callback(){this.getPlugin("undoRedo").redo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isRedoAvailable()}}}const NS="remove_col";function rTe(){return{key:NS,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[,r,,n]=t[0];r-n!==0&&(e=1)}return this.getTranslatedPhrase(wL,e)},callback(){this.alter("remove_col",A1e(this),null,"ContextMenu.removeColumn")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.col<0)return!0;const e=this.countCols();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByRowHeader()||e===0},hidden(){return!this.getSettings().allowRemoveColumn}}}const fT="remove_row";function nTe(){return{key:fT,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[r,,n]=t[0];r-n!==0&&(e=1)}return this.getTranslatedPhrase(vL,e)},callback(){this.alter("remove_row",O1e(this),1,"ContextMenu.removeRow")},disabled(){const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.row<0)return!0;const e=this.countRows();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByColumnHeader()||e===0},hidden(){return!this.getSettings().allowRemoveRow}}}const dT="row_above";function iTe(){return{key:dT,name(){return this.getTranslatedPhrase(dL)},callback(){const t=this.getSelectedRangeLast().getTopLeftCorner();this.alter("insert_row_above",t.row,1,"ContextMenu.rowAbove")},disabled(){const t=this.getSelectedRangeLast();return!t||this.selection.isSelectedByColumnHeader()||t.isSingleHeader()&&t.highlight.row<0||this.countSourceRows()>=this.getSettings().maxRows?!0:this.selection.isSelectedByCorner()?this.countRows()===0:!1},hidden(){return!this.getSettings().allowInsertRow}}}const gT="row_below";function sTe(){return{key:gT,name(){return this.getTranslatedPhrase(gL)},callback(){const t=this.getSelectedRangeLast().getBottomRightCorner();this.alter("insert_row_below",t.row,1,"ContextMenu.rowBelow")},disabled(){const t=this.getSelectedRangeLast();return!!(!t||this.selection.isSelectedByColumnHeader()||t.isSingleHeader()&&t.highlight.row<0||this.countSourceRows()>=this.getSettings().maxRows)},hidden(){return!this.getSettings().allowInsertRow}}}const O1="no_items";function aTe(){return{key:O1,name(){return this.getTranslatedPhrase(fL)},disabled:!0,isCommand:!1}}const mT="undo";function oTe(){return{key:mT,name(){return this.getTranslatedPhrase(yL)},callback(){this.getPlugin("undoRedo").undo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isUndoAvailable()}}}const lTe=[dT,gT,DS,PS,cT,fT,NS,mT,hT,IS,Mo,Yt,O1],uTe={[Yt]:KRe,[O1]:aTe,[dT]:iTe,[gT]:sTe,[DS]:ZRe,[PS]:JRe,[cT]:QRe,[fT]:nTe,[NS]:rTe,[mT]:oTe,[hT]:tTe,[IS]:eTe,[Mo]:XRe};function YJ(){const t={};return Wt(uTe,(e,r)=>{t[r]=e()}),t}function cTe(t){return{key:"commentsAddEdit",name(){var e;const r=(e=this.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return r!=null&&r.isCell()&&t.getCommentAtCell(r.row,r.col)?this.getTranslatedPhrase(DL):this.getTranslatedPhrase(kL)},callback(){const e=this.getSelectedRangeLast();t.setRange(e),t.show(),t.focusEditor()},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function hTe(t){return{key:"commentsRemove",name(){return this.getTranslatedPhrase(PL)},callback(){this.getSelectedRangeLast().forAll((r,n)=>{r>=0&&n>=0&&t.removeCommentAtCell(r,n,!1)}),this.render()},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function fTe(t){return{key:"commentsReadOnly",name(){const e=this.getTranslatedPhrase(IL);return CE(this.getSelectedRange(),(n,i)=>t.getCommentMeta(n,i,xE))?jJ(e):e},callback(){this.getSelectedRangeLast().forAll((r,n)=>{if(r>=0&&n>=0){const i=!!t.getCommentMeta(r,n,xE);t.updateCommentMeta(r,n,{[xE]:!i})}})},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||!t.getCommentAtCell(e.highlight.row,e.highlight.col)||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function dTe(t,e){zJ(t,e),e.add(t)}function y0(t,e,r){zJ(t,e),e.set(t,r)}function zJ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function gTe(t,e,r){return(e=mTe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function mTe(t){var e=pTe(t,"string");return typeof e=="symbol"?e:e+""}function pTe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Cf(t,e,r){return t.set(Ba(t,e),r),r}function jt(t,e){return t.get(Ba(t,e))}function Ba(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const p_="comments",vTe=60,Dc="comment",Ey="value",GJ="style",xE="readOnly",jw=p_,RN=`plugin:${p_}`;var Ur=new WeakMap,gu=new WeakMap,pT=new WeakMap,EE=new WeakMap,TN=new WeakMap,v_=new WeakMap,wo=new WeakSet;class wTe extends ur{constructor(){super(...arguments),dTe(this,wo),gTe(this,"range",{}),y0(this,Ur,null),y0(this,gu,null),y0(this,pT,!1),y0(this,EE,!1),y0(this,TN,null),y0(this,v_,"")}static get PLUGIN_KEY(){return p_}static get PLUGIN_PRIORITY(){return vTe}static get DEFAULT_SETTINGS(){return{displayDelay:250}}isEnabled(){return!!this.hot.getSettings()[p_]}enablePlugin(){var e=this;this.enabled||(jt(Ur,this)||(Cf(Ur,this,new wg(this.hot.rootDocument,this.hot.isRtl(),this.hot.rootPortalElement)),jt(Ur,this).addLocalHook("resize",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Ba(wo,e,RTe).call(e,...n)}),this.hot.addHook("afterSetTheme",(r,n)=>{n||this.hide()})),jt(gu,this)||Cf(gu,this,new UJ(this.getSetting("displayDelay"))),this.addHook("afterContextMenuDefaultOptions",r=>this.addToContextMenu(r)),this.addHook("afterRenderer",(r,n,i,s,a,o)=>Ba(wo,this,xTe).call(this,r,o)),this.addHook("afterScroll",()=>Ba(wo,this,TTe).call(this)),this.addHook("afterBeginEditing",()=>this.hide()),this.addHook("afterDocumentKeyDown",r=>Ba(wo,this,oY).call(this,r)),this.addHook("beforeCompositionStart",r=>Ba(wo,this,oY).call(this,r)),jt(gu,this).addLocalHook("hide",()=>this.hide()),jt(gu,this).addLocalHook("show",(r,n)=>this.showAtCell(r,n)),this.registerShortcuts(),this.registerListeners(),super.enablePlugin())}updatePlugin(){jt(gu,this).updateDelay(this.getSetting("displayDelay")),super.updatePlugin()}disablePlugin(){this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager(),r=e.getContext("grid"),n=e.addContext(RN);r.addShortcut({keys:[["Control","Alt","M"]],callback:()=>{const i=this.hot.getSelectedRangeLast();Cf(EE,this,!0),this.hot.scrollToFocusedCell(()=>{this.setRange(i),this.show(),this.focusEditor(),e.setActiveContextName(RN),this.hot._registerTimeout(()=>{Cf(EE,this,!1)})})},stopPropagation:!0,runOnlyIf:()=>{var i;return(i=this.hot.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight.isCell()},group:jw}),n.addShortcut({keys:[["Escape"]],callback:()=>{jt(Ur,this).setValue(jt(v_,this)),this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>jt(Ur,this).isVisible()&&jt(Ur,this).isFocused(),group:jw}),n.addShortcut({keys:[["Control/Meta","Enter"]],callback:()=>{this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>jt(Ur,this).isVisible()&&jt(Ur,this).isFocused(),group:jw}),n.addShortcut({keys:[["Shift","Tab"],["Tab"]],forwardToContext:e.getContext("grid"),callback:()=>{jt(Ur,this).setValue(jt(Ur,this).getValue()),this.hide(),e.setActiveContextName("grid")},group:jw})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(jw)}registerListeners(){const{rootDocument:e}=this.hot,r=this.getEditorInputElement();this.eventManager.addEventListener(e,"mouseover",n=>Ba(wo,this,bTe).call(this,n)),this.eventManager.addEventListener(e,"mousedown",n=>Ba(wo,this,yTe).call(this,n)),this.eventManager.addEventListener(e,"mouseup",()=>Ba(wo,this,CTe).call(this)),this.eventManager.addEventListener(r,"focus",()=>Ba(wo,this,_Te).call(this)),this.eventManager.addEventListener(r,"blur",()=>Ba(wo,this,ETe).call(this)),this.eventManager.addEventListener(this.getEditorInputElement(),"mousedown",n=>Ba(wo,this,STe).call(this,n))}setRange(e){this.range=e}clearRange(){this.range={}}targetIsCellWithComment(e){const r=Lf(e.target,"TD","TBODY");return!!(r&&Ct(r,"htCommentCell")&&Lf(r,[this.hot.rootElement]))}targetIsCommentTextArea(e){return this.getEditorInputElement()===e.target}setComment(e){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const r=jt(Ur,this).getValue();let n="";e!=null?n=e:r!=null&&(n=r);const i=this.range.from.row,s=this.range.from.col;this.updateCommentMeta(i,s,{[Ey]:n}),this.hot.render()}setCommentAtCell(e,r,n){this.setRange({from:this.hot._createCellCoords(e,r)}),this.setComment(n)}removeComment(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,Dc),e&&this.hot.render(),this.hide()}removeCommentAtCell(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;this.setRange({from:this.hot._createCellCoords(e,r)}),this.removeComment(n)}getComment(){const e=this.range.from.row,r=this.range.from.col;return this.getCommentMeta(e,r,Ey)}getCommentAtCell(e,r){return this.getCommentMeta(e,r,Ey)}show(){var e;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const{from:{row:r,col:n}}=this.range;if(r<0||r>this.hot.countSourceRows()-1||n<0||n>this.hot.countSourceCols()-1)return!1;const i=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return jt(gu,this).cancelHiding(),jt(Ur,this).setValue((e=i[Dc]?i[Dc][Ey]:null)!==null&&e!==void 0?e:""),jt(Ur,this).show(),this.refreshEditor(!0),!0}showAtCell(e,r){return this.setRange({from:this.hot._createCellCoords(e,r)}),this.show()}hide(){jt(Ur,this).hide()}refreshEditor(){if(!(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1)&&(!this.range.from||!jt(Ur,this).isVisible()))return;const{rowIndexMapper:r,columnIndexMapper:n}=this.hot,{row:i,col:s}=this.range.from;let a=r.getRenderableFromVisualIndex(i),o=n.getRenderableFromVisualIndex(s);const u=a===null;jt(Ur,this).setPosition(0,0),a===null&&(a=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(i,-1))),o===null&&(o=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(s,-1)));const c=a===null,f=o===null;a=a??0,o=o??0;const{rootWindow:g,view:{_wt:m}}=this.hot,{wtTable:v}=m,w=m.getCell({row:a,col:o},!0),y=this.getCommentMeta(i,s,GJ);y?jt(Ur,this).setSize(y.width,y.height):jt(Ur,this).resetSize();const b=f?0:v.getColumnWidth(o),x=u&&!c?ai(w):0,{left:_,top:T,width:D,height:P}=w.getBoundingClientRect(),{width:O,height:A}=jt(Ur,this).getSize(),{innerWidth:W,innerHeight:L}=this.hot.rootWindow,H=this.hot.rootDocument.documentElement,J=Ni(this.hot.rootDocument),G=AF(this.hot.rootWindow)?J:0,ve=OF(this.hot.rootWindow)?J:0;let be=_+g.scrollX+b,we=T+g.scrollY+x;this.hot.isRtl()&&(be-=O+b),this.hot.isLtr()&&_+D+O>W-G?be=_+g.scrollX-O-1:this.hot.isRtl()&&be<-(H.scrollWidth-H.clientWidth)&&(be=_+g.scrollX+b+1),T+A>L-ve&&(we-=A-P+1),jt(Ur,this).setPosition(be,we),jt(Ur,this).setReadOnlyState(this.getCommentMeta(i,s,xE)),jt(Ur,this).observeSize()}focusEditor(){jt(Ur,this).focus()}updateCommentMeta(e,r,n){const i=this.hot.getCellMeta(e,r)[Dc];let s;i?(s=As(i),yS(s,n)):s=n,this.hot.setCellMeta(e,r,Dc,s)}getCommentMeta(e,r,n){const i=this.hot.getCellMeta(e,r);if(i[Dc])return i[Dc][n]}addToContextMenu(e){e.items.push({name:Yt},cTe(this),hTe(this),fTe(this))}getEditorInputElement(){return jt(Ur,this).getInputElement()}destroy(){var e,r;(e=jt(Ur,this))===null||e===void 0||e.destroy(),(r=jt(gu,this))===null||r===void 0||r.destroy(),super.destroy()}}function yTe(t){if(!(!this.hot.view||!this.hot.view._wt)&&!jt(pT,this)&&!this.targetIsCommentTextArea(t)){const e=Lf(t.target,"TD","TBODY");let r=null;e&&(r=this.hot.getCoords(e)),(!e||this.range.from&&r&&(this.range.from.row!==r.row||this.range.from.col!==r.col))&&this.hide()}}function STe(t){t.stopPropagation()}function bTe(t){const{rootDocument:e}=this.hot;if(!(jt(pT,this)||jt(Ur,this).isFocused()||Ct(t.target,"wtBorder")||jt(TN,this)===t.target||!jt(Ur,this)))if(Cf(TN,this,e.elementFromPoint(t.clientX,t.clientY)),this.targetIsCellWithComment(t)){const r=this.hot._createCellRange(this.hot.getCoords(t.target));jt(gu,this).show(r)}else kf(t.target,e)&&!this.targetIsCommentTextArea(t)&&jt(gu,this).hide()}function CTe(){Cf(pT,this,!1)}function xTe(t,e){e[Dc]&&e[Dc][Ey]&&Ve(t,e.commentedCellClassName)}function ETe(){Cf(v_,this,""),this.hot.getShortcutManager().setActiveContextName("grid"),this.setComment()}function _Te(){Cf(v_,this,this.getComment()),this.hot.listen(),this.hot.getShortcutManager().setActiveContextName(RN)}function RTe(t,e){this.updateCommentMeta(this.range.from.row,this.range.from.col,{[GJ]:{width:t,height:e}})}function oY(t){jt(Ur,this).isFocused()&&Qo(t)}function TTe(){jt(EE,this)||this.hide()}function G2(t,e,r){return(e=MTe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function MTe(t){var e=ATe(t,"string");return typeof e=="symbol"?e:e+""}function ATe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class qJ{constructor(e){G2(this,"hot",void 0),G2(this,"commands",{}),G2(this,"commonCallback",null),this.hot=e}registerCommand(e,r){this.commands[e]=r}setCommonCallback(e){this.commonCallback=e}execute(e){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];const s=e.split(":"),a=s[0],o=s.length===2?s[1]:null;let u=this.commands[a];if(!u)throw new Error(`Menu command '${a}' not exists.`);if(o&&u.submenu&&(u=OTe(o,u.submenu.items)),u.disabled===!0||typeof u.disabled=="function"&&u.disabled.call(this.hot)===!0||ni(u,"submenu"))return;const c=[];typeof u.callback=="function"&&c.push(u.callback),typeof this.commonCallback=="function"&&c.push(this.commonCallback),n.unshift(s.join(":")),he(c,f=>f.apply(this.hot,n))}}function OTe(t,e){let r;return he(e,n=>{const i=n.key?n.key.split(":"):null;if(Array.isArray(i)&&i[1]===t)return r=n,!1}),r}function q2(t,e,r){return(e=kTe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function kTe(t){var e=DTe(t,"string");return typeof e=="symbol"?e:e+""}function DTe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class KJ{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;q2(this,"hot",void 0),q2(this,"predefinedItems",YJ()),q2(this,"defaultOrderPattern",void 0),this.hot=e,this.defaultOrderPattern=r}setPredefinedItems(e){const r={};this.defaultOrderPattern.length=0,Wt(e,(n,i)=>{let s="";n.name===Yt?(r[Yt]=n,s=Yt):isNaN(parseInt(i,10))?(n.key=n.key===void 0?i:n.key,r[i]=n,s=n.key):(r[n.key]=n,s=n.key),this.defaultOrderPattern.push(s)}),this.predefinedItems=r}getItems(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return PTe(e,this.defaultOrderPattern,this.predefinedItems)}}function PTe(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const n=[];let i=t;return i&&i.items?i=i.items:Array.isArray(i)||(i=e),Vt(i)?Wt(i,(s,a)=>{let o=r[typeof s=="string"?s:a];o||(o=s),Vt(s)?oi(o,s):typeof o=="string"&&(o={name:o}),o.key===void 0&&(o.key=a),n.push(o)}):he(i,(s,a)=>{let o=r[s];!o&&lTe.indexOf(s)>=0||(o||(o={name:s,key:`${a}`}),Vt(s)&&oi(o,s),o.key===void 0&&(o.key=a),n.push(o))}),n}function zh(t,e,r){return(e=ITe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ITe(t){var e=NTe(t,"string");return typeof e=="symbol"?e:e+""}function NTe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class HTe{constructor(e,r){zh(this,"top",void 0),zh(this,"topRelative",void 0),zh(this,"left",void 0),zh(this,"leftRelative",void 0),zh(this,"scrollTop",void 0),zh(this,"scrollLeft",void 0),zh(this,"cellHeight",void 0),zh(this,"cellWidth",void 0);const n=r.scrollY,i=r.scrollX;let s,a,o,u,c,f;this.rootWindow=r,this.type=this.getSourceType(e),this.type==="literal"?(s=parseInt(e.top,10),o=parseInt(e.left,10),c=e.height||0,f=e.width||0,a=s,u=o,s+=n,o+=i):this.type==="event"&&(s=parseInt(e.pageY,10),o=parseInt(e.pageX,10),c=e.target.clientHeight,f=e.target.clientWidth,a=s-n,u=o-i),this.top=s,this.topRelative=a,this.left=o,this.leftRelative=u,this.scrollTop=n,this.scrollLeft=i,this.cellHeight=c,this.cellWidth=f}getSourceType(e){let r="literal";return e instanceof Event&&(r="event"),r}fitsAbove(e){return this.topRelative>=e.offsetHeight}fitsBelow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+e.offsetHeight<=r}fitsOnRight(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+e.offsetWidth<=r}fitsOnLeft(e){return this.leftRelative>=e.offsetWidth}}function Yw(t,e,r){FTe(t,e),e.set(t,r)}function FTe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function It(t,e){return t.get(XJ(t,e))}function ZC(t,e,r){return t.set(XJ(t,e),r),r}function XJ(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Hs=new WeakMap,ia=new WeakMap,sa=new WeakMap,K2=new WeakMap,S0=new WeakMap;class LTe{constructor(e){Yw(this,Hs,void 0),Yw(this,ia,void 0),Yw(this,sa,void 0),Yw(this,K2,!1),Yw(this,S0,{above:0,below:0,left:0,right:0}),ZC(K2,this,e)}setOffset(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return It(S0,this)[e]=r,this}setElement(e){return ZC(Hs,this,e),this}setParentElement(e){return ZC(ia,this,e),this}updatePosition(e){ZC(sa,this,new HTe(e,It(Hs,this).ownerDocument.defaultView)),It(K2,this)?(It(sa,this).fitsBelow(It(Hs,this))?this.setPositionBelowCursor():It(sa,this).fitsAbove(It(Hs,this))?this.setPositionAboveCursor():this.setPositionBelowCursor(),this.updateHorizontalPosition()):(this.setPositionBelowCursor(),this.setPositionOnRightOfCursor())}updateHorizontalPosition(){It(Hs,this).dir==="rtl"?It(sa,this).fitsOnLeft(It(Hs,this))?this.setPositionOnLeftOfCursor():this.setPositionOnRightOfCursor():It(sa,this).fitsOnRight(It(Hs,this))?this.setPositionOnRightOfCursor():this.setPositionOnLeftOfCursor()}setPositionAboveCursor(){let e=It(S0,this).above+It(sa,this).top-It(Hs,this).offsetHeight;if(It(ia,this)){const n=It(ia,this).ownerDocument.defaultView.getComputedStyle(It(ia,this).querySelector(".ht_master")),i=Number.parseInt(n.paddingTop,10),s=Number.parseInt(n.borderTop,10);e=It(sa,this).top+It(sa,this).cellHeight-It(Hs,this).scrollHeight+i+s}It(Hs,this).style.top=`${e}px`}setPositionBelowCursor(){let e=It(S0,this).below+It(sa,this).top+1;if(It(ia,this)){const n=It(ia,this).ownerDocument.defaultView.getComputedStyle(It(ia,this).querySelector(".ht_master")),i=Number.parseInt(n.paddingTop,10),s=Number.parseInt(n.borderTop,10);e=It(sa,this).top-i-s-1}It(Hs,this).style.top=`${e}px`}setPositionOnRightOfCursor(){let e=It(sa,this).left;if(It(ia,this)){const r=It(ia,this).ownerDocument.defaultView,n=Number.parseInt(r.getComputedStyle(It(ia,this).querySelector(".htCore")).borderRightWidth,10);e+=It(sa,this).cellWidth+n}else e+=It(S0,this).right;It(Hs,this).style.left=`${e}px`}setPositionOnLeftOfCursor(){let e=It(S0,this).left+It(sa,this).left-It(Hs,this).offsetWidth;if(It(ia,this)){const r=It(ia,this).ownerDocument.defaultView,n=Number.parseInt(r.getComputedStyle(It(ia,this).querySelector(".htCore")).borderLeftWidth,10);e-=n}It(Hs,this).style.left=`${e}px`}}function QJ(t){let{initialPage:e=-1,size:r=()=>0,onItemSelect:n=()=>{},onClear:i=()=>{}}=t;const s=new Set;let a=ir(e,-1,y()-1);function o(x,_){const T=y()-1;return x<0&&(x=T),x>T&&(x=0),s.has(x)?-1:(s.add(x),n(x,!1)===!1&&(x=o(_===1?++x:--x,_)),x)}function u(x){x>-1&&x<y()&&n(x,!0)!==!1&&(a=x)}function c(x){x>-1&&x<y()&&(a=x)}function f(){return a}function g(){y()>0&&(s.clear(),a=o(0,1))}function m(){y()>0&&(s.clear(),a=o(y()-1,-1))}function v(){y()>0&&(s.clear(),a=o(++a,1))}function w(){y()>0&&(s.clear(),a=o(--a,-1))}function y(){return Math.max(r(),0)}function b(){s.clear(),a=e,i()}return{setCurrentPage:u,setPageCursorAt:c,getCurrentPage:f,toFirstItem:g,toLastItem:m,toNextItem:v,toPreviousItem:w,getSize:y,clear:b}}function BTe(t){return nr(t,e=>({start:e.getTopStartCorner(),end:e.getBottomEndCorner()}))}function MN(t){return ni(t,"submenu")}function AN(t){return new RegExp(Yt,"i").test(t.name)}function _E(t,e){return t.disabled===!0||typeof t.disabled=="function"&&t.disabled.call(e)===!0}function lY(t){return ni(t,"disableSelection")}function VTe(t){return Ct(t,"htSeparator")}function WTe(t){return Ct(t,"htSubmenu")}function $Te(t){return Ct(t,"htDisabled")}function UTe(t){return Ct(t,"htSelectionDisabled")}function jTe(t,e){return!t.hidden||!(typeof t.hidden=="function"&&t.hidden.call(e))}function ZJ(t,e){const r=t.slice(0);for(let n=0;n<r.length&&r[n].name===e;)r.shift();return r}function YTe(t,e){let r=t.slice(0);return r.reverse(),r=ZJ(r,e),r.reverse(),r}function zTe(t){const e=[];return he(t,(r,n)=>{n>0?e[e.length-1].name!==r.name&&e.push(r):e.push(r)}),e}function GTe(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Yt,r=t.slice(0);return r=ZJ(r,e),r=YTe(r,e),r=zTe(r),r}function qTe(t){return t.checkable===!0}function KTe(t){return QJ({size:()=>t.countRows(),onItemSelect(e,r){const n=t.getCell(e,0);if(!n||VTe(n)||$Te(n)||UTe(n))return!1;t.selectCell(e,0,...r?[e,0,!1,!1]:[])},onClear(){t.deselectCell()}})}function XTe(t){const{hot:e,hotMenu:r}=t;return[{keys:[["Control/Meta","A"]],forwardToContext:e.getShortcutManager().getContext("grid"),callback:()=>t.close(!0)},{keys:[["Tab"],["Shift","Tab"]],callback:(n,i)=>{const s=e.getSettings(),a=typeof s.tabMoves=="function"?s.tabMoves(n):s.tabMoves;i.includes("shift")?e.selection.transformStart(-a.row,-a.col):e.selection.transformStart(a.row,a.col),t.close(!0)}},{keys:[["Escape"]],callback:()=>t.close()},{keys:[["ArrowDown"]],callback:()=>t.getNavigator().toNextItem()},{keys:[["ArrowUp"]],callback:()=>t.getNavigator().toPreviousItem()},{keys:[[e.isRtl()?"ArrowLeft":"ArrowRight"]],callback:()=>{const n=r.getSelectedLast();if(n){const i=t.openSubMenu(n[0]);i&&i.getNavigator().toFirstItem()}}},{keys:[[e.isRtl()?"ArrowRight":"ArrowLeft"]],callback:()=>{r.getSelectedLast()&&t.isSubMenu()&&(t.close(),t.isSubMenu()&&t.parentMenu.hotMenu.listen())}},{keys:[["Control/Meta","ArrowUp"],["Home"]],callback:()=>t.getNavigator().toFirstItem()},{keys:[["Control/Meta","ArrowDown"],["End"]],callback:()=>t.getNavigator().toLastItem()},{keys:[["Enter"],["Space"]],callback:n=>{const i=r.getSelectedLast();i&&(r.getSourceDataAtRow(i[0]).submenu?t.openSubMenu(i[0]).getNavigator().toFirstItem():(t.executeCommand(n),t.close(!0)))}},{keys:[["PageUp"]],callback:()=>{r.getSelectedLast()?r.selection.transformStart(-r.countVisibleRows(),0):t.getNavigator().toFirstItem()}},{keys:[["PageDown"]],callback:()=>{r.getSelectedLast()?r.selection.transformStart(r.countVisibleRows(),0):t.getNavigator().toLastItem()}}]}const JJ="menu",uY=JJ;function QTe(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=[];n(XTe(t)),e.forEach(c=>{let{shortcuts:f,contextName:g}=c;i(f,g)});function n(c,f){o(f).addShortcuts(c,{group:JJ})}function i(c,f){const g=o(f);c.forEach(m=>{let{keys:v}=m;v.forEach(w=>g.removeShortcutsByKeys(w))}),r.push({shortcuts:c,contextName:f}),n(c,f)}function s(){return[...r]}function a(c){return c?`${uY}:${c}`:uY}function o(c){var f;const g=t.hotMenu.getShortcutManager(),m=a(c);return(f=g.getContext(m))!==null&&f!==void 0?f:g.addContext(m)}function u(c){t.hotMenu.getShortcutManager().setActiveContextName(a(c))}return{addCustomShortcuts:i,getCustomShortcuts:s,getContext:o,listen:u}}function ZTe(t){return(e,r,n,i,s,a)=>{const o=e.getSourceDataAtRow(n),u=t.rootDocument.createElement("div"),c=typeof a=="function"?a.call(t):a,f=typeof o.ariaLabel=="function"?o.ariaLabel.call(t):o.ariaLabel,g=typeof o.ariaChecked=="function"?o.ariaChecked.call(t):o.ariaChecked;if(Bu(r),Ve(u,"htItemWrapper"),t.getSettings().ariaTags){const m=!_E(o,t)&&!lY(o)&&!AN(o);bt(r,[...qTe(o)?[Eme(),Rp(f),hQ(g)]:[xme(),Rp(c)],...m?[Zf(-1)]:[],..._E(o,t)?[kme()]:[],...MN(o)?[Vo(!1)]:[]])}r.className="",r.appendChild(u),AN(o)?Ve(r,"htSeparator"):typeof o.renderer=="function"?(Ve(r,"htCustomMenuRenderer"),r.appendChild(o.renderer(e,u,n,i,s,c))):om(u,c),_E(o,t)?Ve(r,"htDisabled"):lY(o)?Ve(r,"htSelectionDisabled"):MN(o)&&Ve(r,"htSubmenu")}}function X2(t,e,r){JTe(t,e),e.set(t,r)}function JTe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Zl(t,e,r){return(e=eMe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function eMe(t){var e=tMe(t,"string");return typeof e=="symbol"?e:e+""}function tMe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Q2(t,e,r){return t.set(eee(t,e),r),r}function Gh(t,e){return t.get(eee(t,e))}function eee(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const cY=215;var b0=new WeakMap,JC=new WeakMap,ex=new WeakMap;class cv{get tableBorderWidth(){return Gh(ex,this)===void 0&&this.hotMenu&&Q2(ex,this,parseInt(this.hotMenu.rootWindow.getComputedStyle(this.hotMenu.view._wt.wtTable.TABLE).borderWidth,10)),Gh(ex,this)}constructor(e,r){var n=this;Zl(this,"hot",void 0),Zl(this,"options",void 0),Zl(this,"eventManager",new Uo(this)),Zl(this,"container",void 0),Zl(this,"positioner",void 0),Zl(this,"hotMenu",null),Zl(this,"hotSubMenus",{}),Zl(this,"parentMenu",void 0),Zl(this,"menuItems",null),Zl(this,"origOutsideClickDeselects",null),X2(this,b0,void 0),X2(this,JC,void 0),X2(this,ex,void 0),this.hot=e,this.options=r||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:cY,container:this.hot.rootPortalElement},this.container=this.createContainer(this.options.name),this.positioner=new LTe(this.options.keepInViewport),this.parentMenu=this.options.parent||null,this.registerEvents(),this.isSubMenu()&&this.addLocalHook("afterSelectionChange",function(){for(var i=arguments.length,s=new Array(i),a=0;a<i;a++)s[a]=arguments[a];return n.parentMenu.runLocalHooks("afterSelectionChange",...s)}),this.hot.addHook("afterSetTheme",(i,s)=>{this.options.container!==this.hot.rootPortalElement&&(wt(this.options.container,/ht-theme-.*/g),Ve(this.options.container,i)),s||this.close()})}registerEvents(){let e=this.hot.rootWindow;for(;e;)this.eventManager.addEventListener(e.document,"mousedown",r=>this.onDocumentMouseDown(r)),this.eventManager.addEventListener(e.document,"touchstart",r=>this.onDocumentMouseDown(r)),this.eventManager.addEventListener(e.document,"contextmenu",r=>this.onDocumentContextMenu(r)),e=Pg(e)}setMenuItems(e){this.menuItems=e}getNavigator(){return Gh(b0,this)}getKeyboardShortcutsCtrl(){return Gh(JC,this)}getSelectedItem(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}hasSelectedItem(){return Array.isArray(this.hotMenu.getSelectedLast())}isSubMenu(){return this.parentMenu!==null}open(){this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";const e=CS(o=>this.openSubMenu(o),300),r=this.options.minWidth||cY;let n=!1,i=Ff(this.menuItems,o=>(o.key===O1&&(n=!0),jTe(o,this.hot)));if(i.length<1&&!n)i.push(YJ()[O1]);else if(i.length===0)return;i=GTe(i,Yt);let s=!1;const a={data:i,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth(o){return it(o)&&o<r?r:o},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,hiddenRows:!0,maxCols:1,columns:[{data:"name",renderer:ZTe(this.hot)}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",ariaTags:!1,themeName:this.hot.getCurrentThemeName(),beforeRefreshDimensions:()=>!1,beforeOnCellMouseOver:(o,u)=>{this.hotMenu.stylesHandler.isClassicTheme()?Gh(b0,this).setCurrentPage(u.row):Gh(b0,this).setPageCursorAt(u.row)},afterOnCellMouseOver:(o,u)=>{this.isAllSubMenusClosed()?e(u.row):this.openSubMenu(u.row)},afterOnCellContextMenu:o=>{o.preventDefault(),ZE()&&s&&this.hasSelectedItem()&&this.close(!0)},afterSelection:(o,u,c,f,g)=>{this.hotMenu.view.isMouseDown()&&(g.value=!0),this.runLocalHooks("afterSelectionChange",this.getSelectedItem())},beforeOnCellMouseUp:o=>{this.hasSelectedItem()&&(s=!this.isCommandPassive(this.getSelectedItem()),this.executeCommand(o))},afterOnCellMouseUp:o=>{(!ZE()||!Vf(o))&&s&&this.hasSelectedItem()&&(_l()||CF()?this.hot._registerTimeout(()=>this.close(!0),325):this.close(!0))},afterUnlisten:()=>{!this.hasSelectedItem()&&this.isOpened()&&this.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new this.hot.constructor(this.container,a),this.hotMenu.addHook("afterInit",()=>this.onAfterInit()),this.hotMenu.init(),Q2(b0,this,KTe(this.hotMenu)),Q2(JC,this,QTe(this)),Gh(JC,this).listen(),this.focus(),this.isSubMenu()&&this.addLocalHook("afterOpen",()=>this.parentMenu.runLocalHooks("afterSubmenuOpen",this)),this.runLocalHooks("afterOpen",this)}close(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.isOpened()){if(e&&this.isSubMenu())this.parentMenu.close();else if(Gh(b0,this).clear(),this.closeAllSubMenus(),this.container.style.display="none",this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.isSubMenu()){if(this.hot.getSettings().ariaTags){const r=this.parentMenu.hotMenu.getSelectedLast();if(r){const n=this.parentMenu.hotMenu.getCell(r[0],0);bt(n,[Vo(!1)])}}this.parentMenu.hotMenu.listen()}}}openSubMenu(e){if(!this.hotMenu)return!1;const r=this.hotMenu.getCell(e,0);if(this.closeAllSubMenus(),!r||!WTe(r))return!1;const n=this.hotMenu.getSourceDataAtRow(e),i=new cv(this.hot,{parent:this,name:n.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return i.setMenuItems(n.submenu.items),i.open(),i.setPosition(r.getBoundingClientRect()),this.hotSubMenus[n.key]=i,this.hot.getSettings().ariaTags&&bt(r,[Vo(!0)]),i}closeSubMenu(e){const r=this.hotMenu.getSourceDataAtRow(e),n=this.hotSubMenus[r.key];if(n){n.destroy(),delete this.hotSubMenus[r.key];const i=this.hotMenu.getCell(e,0);this.hot.getSettings().ariaTags&&bt(i,[Vo(!1)])}}closeAllSubMenus(){he(this.hotMenu.getData(),(e,r)=>this.closeSubMenu(r))}isAllSubMenusClosed(){return Object.keys(this.hotSubMenus).length===0}focus(){this.isOpened()&&(this.hotMenu.rootElement.focus({preventScroll:!0}),this.getKeyboardShortcutsCtrl().listen(),this.hotMenu.listen())}destroy(){const e=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),e&&e.removeChild(this.container)}isOpened(){return this.hotMenu!==null}executeCommand(e){if(!this.isOpened()||!this.hasSelectedItem())return;const r=this.getSelectedItem();if(this.runLocalHooks("select",r,e),this.isCommandPassive(r))return;const n=this.hot.getSelectedRange(),i=n?BTe(n):[];this.runLocalHooks("executeCommand",r.key,i,e),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",r.key,i,e)}isCommandPassive(e){return e.isCommand===!1||AN(e)||_E(e,this.hot)||MN(e)}setOffset(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.positioner.setOffset(e,r)}setPosition(e){this.isSubMenu()&&this.positioner.setParentElement(this.parentMenu.container),this.positioner.setElement(this.container).updatePosition(e)}updateMenuDimensions(){const{wtTable:e}=this.hotMenu.view._wt,r=this.hotMenu.getSettings().data,n=e.hider.style,i=e.holder.style,s=parseInt(n.width,10),a=Ri(r,(o,u,c)=>{const g=this.hotMenu.getCell(c,0)?ai(this.hotMenu.getCell(c,0)):0;return o+(u.name===Yt?1:g)},0);this.hotMenu.stylesHandler.isClassicTheme()?(i.width=`${s+3}px`,i.height=`${a+3}px`):(i.width=`${s}px`,i.height=`${a}px`),n.height=i.height}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const r=this.options.container.ownerDocument;let n=e,i;return n&&(kr(n)&&(n=n.call(this.hot),n===null||gn(n)?n="":n=n.toString()),n=n.replace(/[^A-Za-z0-9]/g,"_"),n=`${this.options.className}Sub_${n}`,i=r.querySelector(`.${this.options.className}.${n}`)),i||(i=r.createElement("div"),Ve(i,`htMenu handsontable ${this.options.className}`),n&&Ve(i,n),this.options.container.appendChild(i)),i}onAfterInit(){this.updateMenuDimensions(),this.hot.getSettings().ariaTags&&bt(this.hotMenu.rootElement,[Cme(),Zf(-1)])}onDocumentMouseDown(e){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!kf(e.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!kf(e.target,".htMenu")&&this.close(!0))}onDocumentContextMenu(e){this.isOpened()&&Ct(e.target,"htCore")&&kf(e.target,this.hotMenu.rootElement)&&e.preventDefault()}}Lr(cv,as);function rMe(t,e){nMe(t,e),e.add(t)}function nMe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Z2(t,e,r){return(e=iMe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function iMe(t){var e=sMe(t,"string");return typeof e=="symbol"?e:e+""}function sMe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function tx(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const _y="contextMenu",aMe=70,hY=_y;Je.getSingleton().register("afterContextMenuDefaultOptions");Je.getSingleton().register("beforeContextMenuShow");Je.getSingleton().register("afterContextMenuShow");Je.getSingleton().register("afterContextMenuHide");Je.getSingleton().register("afterContextMenuExecute");var zw=new WeakSet;class vT extends ur{constructor(){super(...arguments),rMe(this,zw),Z2(this,"commandExecutor",new qJ(this.hot)),Z2(this,"itemsFactory",null),Z2(this,"menu",null)}static get PLUGIN_KEY(){return _y}static get PLUGIN_PRIORITY(){return aMe}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[dT,gT,Yt,DS,PS,Yt,fT,NS,Yt,mT,hT,Yt,IS,Yt,Mo]}isEnabled(){return!!this.hot.getSettings()[_y]}enablePlugin(){var e=this;if(this.enabled)return;const r=this.hot.getSettings()[_y];typeof r.callback=="function"&&this.commandExecutor.setCommonCallback(r.callback),this.menu=new cv(this.hot,{className:"htContextMenu",keepInViewport:!0,container:r.uiContainer||this.hot.rootPortalElement}),this.menu.addLocalHook("beforeOpen",()=>tx(zw,this,lMe).call(this)),this.menu.addLocalHook("afterOpen",()=>tx(zw,this,uMe).call(this)),this.menu.addLocalHook("afterClose",()=>tx(zw,this,cMe).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return e.executeCommand.call(e,...i)}),this.addHook("afterOnCellContextMenu",n=>tx(zw,this,oMe).call(this,n)),this.registerShortcuts(),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control/Meta","Shift","Backslash"],["Shift","F10"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();this.hot.scrollToFocusedCell();const r=this.hot.getCell(e.row,e.col,!0).getBoundingClientRect(),n=uT(this.menu.container,this.hot.rootDocument);this.open({left:r.left+n.left,top:r.top+n.top-1+r.height},{left:r.width,above:-r.height}),this.menu.getNavigator().toFirstItem()},runOnlyIf:()=>{var e;const r=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return r&&this.hot.selection.isCellVisible(r)&&!this.menu.isOpened()},group:hY})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(hY)}open(e){var r;let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};if((r=this.menu)!==null&&r!==void 0&&r.isOpened())return;this.prepareMenuItems(),this.menu.open();const i=this.menu.tableBorderWidth>0;Wt(n,(s,a)=>{const o=["below","right"].includes(a)?s+1:s-1;this.menu.setOffset(a,i?s:o)}),this.menu.setPosition(e)}close(){var e;(e=this.menu)===null||e===void 0||e.close(),this.itemsFactory=null}executeCommand(e){this.itemsFactory===null&&this.prepareMenuItems();for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];this.commandExecutor.execute(e,...n)}prepareMenuItems(){this.itemsFactory=new KJ(this.hot,vT.DEFAULT_ITEMS);const e=this.hot.getSettings()[_y],r={items:this.itemsFactory.getItems(e)};this.hot.runHooks("afterContextMenuDefaultOptions",r),this.itemsFactory.setPredefinedItems(r.items);const n=this.itemsFactory.getItems(e);this.hot.runHooks("beforeContextMenuSetItems",n),this.menu.setMenuItems(n),he(n,i=>this.commandExecutor.registerCommand(i.key,i))}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function oMe(t){const e=this.hot.getSettings(),r=e.rowHeaders,n=e.colHeaders;function i(o){return o.nodeName==="TD"||o.parentNode.nodeName==="TD"}const s=t.target;if(this.close(),Ct(s,"handsontableInput")||(t.preventDefault(),t.stopPropagation(),!(r||n)&&!i(s)&&!(Ct(s,"current")&&Ct(s,"wtBorder"))))return;const a=uT(this.menu.container,this.hot.rootDocument);this.open({top:t.clientY+a.top,left:t.clientX+a.left})}function lMe(){this.hot.runHooks("beforeContextMenuShow",this)}function uMe(){this.hot.runHooks("afterContextMenuShow",this)}function cMe(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}vT.SEPARATOR={name:Yt};function hMe(t){return{key:"copy",name(){return this.getTranslatedPhrase(CL)},callback(){t.copyCellsOnly()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const r=this.getSelected();return!r||r.length>1},hidden:!1}}function fMe(t){return{key:"copy_column_headers_only",name(){const e=this.getSelectedRangeLast(),r=e?ir(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(_L,r)},callback(){t.copyColumnHeadersOnly()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const r=this.getSelected();return!r||r.length>1},hidden:!1}}function dMe(t){return{key:"copy_with_column_group_headers",name(){const e=this.getSelectedRangeLast(),r=e?ir(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(EL,r)},callback(){t.copyWithAllColumnHeaders()},disabled(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const r=this.getSelected();return!r||r.length>1},hidden:!1}}function gMe(t){return{key:"copy_with_column_headers",name(){const e=this.getSelectedRangeLast(),r=e?ir(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(xL,r)},callback(){t.copyWithColumnHeaders()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const r=this.getSelected();return!r||r.length>1},hidden:!1}}function mMe(t){return{key:"cut",name(){return this.getTranslatedPhrase(RL)},callback(){t.cut()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const r=this.getSelected();return!r||r.length>1},hidden:!1}}class pMe{constructor(){this.data={}}setData(e,r){this.data[e]=r}getData(e){return this.data[e]||void 0}}class vMe{constructor(){this.clipboardData=new pMe}preventDefault(){}composedPath(){return[]}}function wMe(t,e){tee(t,e),e.add(t)}function C0(t,e,r){tee(t,e),e.set(t,r)}function tee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Bs(t,e){return t.get(np(t,e))}function x0(t,e,r){return t.set(np(t,e),r),r}function np(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var qh=new WeakMap,J2=new WeakMap,Gw=new WeakMap,ON=new WeakMap,kN=new WeakMap,qw=new WeakMap,Kw=new WeakSet;class yMe{constructor(e){let{countRows:r,countColumns:n,rowsLimit:i,columnsLimit:s,countColumnHeaders:a}=e;wMe(this,Kw),C0(this,qh,void 0),C0(this,J2,void 0),C0(this,Gw,void 0),C0(this,ON,void 0),C0(this,kN,void 0),C0(this,qw,void 0),x0(J2,this,r),x0(Gw,this,n),x0(ON,this,i),x0(kN,this,s),x0(qw,this,a)}setSelectedRange(e){x0(qh,this,e)}getCellsRange(){if(Bs(J2,this).call(this)===0||Bs(Gw,this).call(this)===0)return null;const{row:e,col:r}=Bs(qh,this).getTopStartCorner(),{row:n,col:i}=Bs(qh,this).getBottomEndCorner(),s=np(Kw,this,SMe).call(this,e,n),a=np(Kw,this,eP).call(this,r,i);return{isRangeTrimmed:n!==s||i!==a,startRow:e,startCol:r,endRow:s,endCol:a}}getMostBottomColumnHeadersRange(){if(Bs(Gw,this).call(this)===0||Bs(qw,this).call(this)===0)return null;const{col:e}=Bs(qh,this).getTopStartCorner(),{col:r}=Bs(qh,this).getBottomEndCorner(),n=np(Kw,this,eP).call(this,e,r);return{isRangeTrimmed:r!==n,startRow:-1,startCol:e,endRow:-1,endCol:n}}getAllColumnHeadersRange(){if(Bs(Gw,this).call(this)===0||Bs(qw,this).call(this)===0)return null;const{col:e}=Bs(qh,this).getTopStartCorner(),{col:r}=Bs(qh,this).getBottomEndCorner(),n=np(Kw,this,eP).call(this,e,r);return{isRangeTrimmed:r!==n,startRow:-Bs(qw,this).call(this),startCol:e,endRow:-1,endCol:n}}}function eP(t,e){return Math.min(e,Math.max(t+Bs(kN,this).call(this)-1,t))}function SMe(t,e){return Math.min(e,Math.max(t+Bs(ON,this).call(this)-1,t))}function ree(t){const e=[],r=[];return he(t,n=>{const i=Math.min(n.startRow,n.endRow),s=Math.max(n.startRow,n.endRow);ct(i,s,u=>{e.indexOf(u)===-1&&e.push(u)});const a=Math.min(n.startCol,n.endCol),o=Math.max(n.startCol,n.endCol);ct(a,o,u=>{r.indexOf(u)===-1&&r.push(u)})}),{rows:e,columns:r}}function bMe(t,e){nee(t,e),e.add(t)}function Kh(t,e,r){nee(t,e),e.set(t,r)}function nee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Xw(t,e,r){return(e=CMe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function CMe(t){var e=xMe(t,"string");return typeof e=="symbol"?e:e+""}function xMe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function fa(t,e){return t.get(ga(t,e))}function pl(t,e,r){return t.set(ga(t,e),r),r}function ga(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}Je.getSingleton().register("afterCopyLimit");Je.getSingleton().register("modifyCopyableRange");Je.getSingleton().register("beforeCut");Je.getSingleton().register("afterCut");Je.getSingleton().register("beforePaste");Je.getSingleton().register("afterPaste");Je.getSingleton().register("beforeCopy");Je.getSingleton().register("afterCopy");const tP="copyPaste",EMe=80,_Me=["fragmentSelection"],fY=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join("");var DN=new WeakMap,PN=new WeakMap,IN=new WeakMap,E0=new WeakMap,rx=new WeakMap,nx=new WeakMap,_0=new WeakMap,w_=new WeakMap,Wa=new WeakSet;class RMe extends ur{constructor(){super(...arguments),bMe(this,Wa),Xw(this,"columnsLimit",1/0),Xw(this,"rowsLimit",1/0),Xw(this,"pasteMode","overwrite"),Xw(this,"uiContainer",this.hot.rootDocument.body),Kh(this,DN,!1),Kh(this,PN,!1),Kh(this,IN,!1),Kh(this,E0,"cells-only"),Kh(this,rx,!1),Kh(this,nx,!1),Kh(this,_0,new yMe({countRows:()=>this.hot.countRows(),countColumns:()=>this.hot.countCols(),rowsLimit:()=>this.rowsLimit,columnsLimit:()=>this.columnsLimit,countColumnHeaders:()=>this.hot.view.getColumnHeadersCount()})),Kh(this,w_,!1),Xw(this,"copyableRanges",[])}static get PLUGIN_KEY(){return tP}static get SETTING_KEYS(){return[tP,..._Me]}static get PLUGIN_PRIORITY(){return EMe}static get DEFAULT_SETTINGS(){return{pasteMode:"overwrite",rowsLimit:1/0,columnsLimit:1/0,copyColumnHeaders:!1,copyColumnGroupHeaders:!1,copyColumnHeadersOnly:!1}}isEnabled(){return!!this.hot.getSettings()[tP]}enablePlugin(){var e,r,n=this;this.enabled||(this.pasteMode=(e=this.getSetting("pasteMode"))!==null&&e!==void 0?e:this.pasteMode,this.rowsLimit=isNaN(this.getSetting("rowsLimit"))?this.rowsLimit:this.getSetting("rowsLimit"),this.columnsLimit=isNaN(this.getSetting("columnsLimit"))?this.columnsLimit:this.getSetting("columnsLimit"),pl(DN,this,this.getSetting("copyColumnHeaders")),pl(PN,this,this.getSetting("copyColumnGroupHeaders")),pl(IN,this,this.getSetting("copyColumnHeadersOnly")),this.uiContainer=(r=this.getSetting("uiContainer"))!==null&&r!==void 0?r:this.uiContainer,this.addHook("afterContextMenuDefaultOptions",i=>ga(Wa,this,AMe).call(this,i)),this.addHook("afterSelection",function(){for(var i=arguments.length,s=new Array(i),a=0;a<i;a++)s[a]=arguments[a];return ga(Wa,n,OMe).call(n,...s)}),this.addHook("afterSelectionEnd",()=>ga(Wa,this,kMe).call(this)),this.eventManager.addEventListener(this.hot.rootDocument,"copy",function(){return n.onCopy(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"cut",function(){return n.onCut(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"paste",function(){return n.onPaste(...arguments)}),Mp()&&(this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseenter",function(){for(var i=arguments.length,s=new Array(i),a=0;a<i;a++)s[a]=arguments[a];return ga(Wa,n,DMe).call(n,...s)}),this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseleave",function(){for(var i=arguments.length,s=new Array(i),a=0;a<i;a++)s[a]=arguments[a];return ga(Wa,n,PMe).call(n,...s)}),this.addHook("afterSelection",()=>ga(Wa,this,IMe).call(this))),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin()}copy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"cells-only";pl(E0,this,e),pl(rx,this,!0),ga(Wa,this,dY).call(this,"copy")}copyCellsOnly(){this.copy("cells-only")}copyColumnHeadersOnly(){this.copy("column-headers-only")}copyWithAllColumnHeaders(){this.copy("with-column-group-headers")}copyWithColumnHeaders(){this.copy("with-column-headers")}cut(){pl(nx,this,!0),ga(Wa,this,dY).call(this,"cut")}getRangedCopyableData(e){return By(this.getRangedData(e))}getRangedData(e){const r=[],{rows:n,columns:i}=ree(e);return he(n,s=>{const a=[];he(i,o=>{s<0?a.push(this.hot.getColHeader(o,s)):a.push(this.hot.getCopyableData(s,o))}),r.push(a)}),r}paste(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;if(!e&&!r)return;const n=new vMe;e&&n.clipboardData.setData("text/plain",e),r&&n.clipboardData.setData("text/html",r),this.onPaste(n)}setCopyableText(){const e=this.hot.getSelectedRangeLast();if(!e)return;if(e.isSingleHeader()){this.copyableRanges=[];return}fa(_0,this).setSelectedRange(e);const r=new Map([["headers",null],["cells",null]]);fa(E0,this)==="column-headers-only"?r.set("headers",fa(_0,this).getMostBottomColumnHeadersRange()):(fa(E0,this)==="with-column-headers"?r.set("headers",fa(_0,this).getMostBottomColumnHeadersRange()):fa(E0,this)==="with-column-group-headers"&&r.set("headers",fa(_0,this).getAllColumnHeadersRange()),r.set("cells",fa(_0,this).getCellsRange())),this.copyableRanges=Array.from(r.values()).filter(i=>i!==null).map(i=>{let{startRow:s,startCol:a,endRow:o,endCol:u}=i;return{startRow:s,startCol:a,endRow:o,endCol:u}}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);const n=r.get("cells");if(n!==null&&n.isRangeTrimmed){const{startRow:i,startCol:s,endRow:a,endCol:o}=n;this.hot.runHooks("afterCopyLimit",a-i+1,o-s+1,this.rowsLimit,this.columnsLimit)}}isEditorOpened(){var e;return(e=this.hot.getActiveEditor())===null||e===void 0?void 0:e.isOpened()}populateValues(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.hot.getSelectedRangeLast();if(!e.length)return;const n=e.length,i=e[0].length,s=[],{row:a,col:o}=r.getTopStartCorner(),{row:u,col:c}=r.getBottomEndCorner();let f=a,g=o,m=a,v=o;for(;s.length<n||f<=u;){const{skipRowOnPaste:w,visualRow:y}=this.hot.getCellMeta(f,o);if(f=y+1,w===!0)continue;m=y,g=o;const b=[],x=s.length%n;for(;b.length<i||g<=c;){const{skipColumnOnPaste:_,visualCol:T}=this.hot.getCellMeta(a,g);if(g=T+1,_===!0)continue;v=T;const D=b.length%i;b.push(e[x][D])}s.push(b)}return pl(w_,this,!0),this.hot.populateFromArray(a,o,s,void 0,void 0,"CopyPaste.paste",this.pasteMode),[a,o,m,v]}onCopy(e){const r=e.composedPath()[0],n=this.hot.getFocusManager().getRefocusElement(),i=r?.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!fa(rx,this)||this.isEditorOpened()||Iu(r)&&(i&&r!==n||!i&&r!==this.hot.rootDocument.body&&!Hy(r,this.hot.rootElement)))return;e.preventDefault(),this.setCopyableText(),pl(rx,this,!1);const s=this.getRangedData(this.copyableRanges),a=ga(Wa,this,TMe).call(this,this.copyableRanges);if(!!this.hot.runHooks("beforeCopy",s,this.copyableRanges,a)){const u=By(s);if(e&&e.clipboardData){const c=aN(s,this.hot.rootDocument);e.clipboardData.setData("text/plain",u),e.clipboardData.setData("text/html",[fY,c].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",u);this.hot.runHooks("afterCopy",s,this.copyableRanges,a)}pl(E0,this,"cells-only")}onCut(e){const r=e.composedPath()[0],n=this.hot.getFocusManager().getRefocusElement(),i=r?.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!fa(nx,this)||this.isEditorOpened()||Iu(r)&&(i&&r!==n||!i&&r!==this.hot.rootDocument.body&&!Hy(r,this.hot.rootElement)))return;e.preventDefault(),this.setCopyableText(),pl(nx,this,!1);const s=this.getRangedData(this.copyableRanges);if(!!this.hot.runHooks("beforeCut",s,this.copyableRanges)){const o=By(s);if(e&&e.clipboardData){const u=aN(s,this.hot.rootDocument);e.clipboardData.setData("text/plain",o),e.clipboardData.setData("text/html",[fY,u].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",o);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",s,this.copyableRanges)}}onPaste(e){const r=e.composedPath()[0],n=this.hot.getFocusManager().getRefocusElement(),i=r?.hasAttribute("data-hot-input");if(!this.hot.isListening()||this.isEditorOpened()||!this.hot.getSelected()||Iu(r)&&(i&&r!==n||!i&&r!==this.hot.rootDocument.body&&!Hy(r,this.hot.rootElement)))return;e.preventDefault();let s;if(e&&typeof e.clipboardData<"u"){const f=LR(e.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});f&&/(<table)|(<TABLE)/g.test(f)?s=zQ(f,this.hot.rootDocument).data:s=e.clipboardData.getData("text/plain")}else typeof ClipboardEvent>"u"&&typeof this.hot.rootWindow.clipboardData<"u"&&(s=this.hot.rootWindow.clipboardData.getData("Text"));if(typeof s=="string"&&(s=N1e(s)),s===void 0||s&&s.length===0||this.hot.runHooks("beforePaste",s,this.copyableRanges)===!1)return;const[a,o,u,c]=this.populateValues(s);this.hot.selectCell(a,o,Math.min(this.hot.countRows()-1,u),Math.min(this.hot.countCols()-1,c)),this.hot.runHooks("afterPaste",s,this.copyableRanges)}destroy(){super.destroy()}}function dY(t){if(Mp()){const e=this.hot.getSelectedRangeLast();if(e){const{row:r,col:n}=e.highlight,i=this.hot.getCell(r,n,!0);i&&PQ(i,()=>{this.hot.rootDocument.execCommand(t)})}}else this.hot.rootDocument.execCommand(t)}function TMe(t){const{rows:e}=ree(t);let r=0;for(let n=0;n<e.length&&!(e[n]>=0);n++)r+=1;return{columnHeadersCount:r}}function MMe(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeLast();if(t){const{row:e,col:r}=t.highlight,n=this.hot.getCell(e,r,!0);n&&DF(n)}}}function iee(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeLast();if(t){const{row:e,col:r}=t.highlight,n=this.hot.getCell(e,r,!0);n!=null&&n.hasAttribute("contenteditable")&&PF(n)}}}function AMe(t){t.items.push({name:"---------"},hMe(this)),fa(DN,this)&&t.items.push(gMe(this)),fa(PN,this)&&t.items.push(dMe(this)),fa(IN,this)&&t.items.push(fMe(this)),t.items.push(mMe(this))}function OMe(t,e,r,n,i){fa(w_,this)&&(i.value=!0),pl(w_,this,!1)}function kMe(){this.isEditorOpened()||this.hot.getSettings().fragmentSelection||this.setCopyableText()}function DMe(){ga(Wa,this,iee).call(this)}function PMe(){ga(Wa,this,MMe).call(this)}function IMe(){ga(Wa,this,iee).call(this)}function see(t,e){return`border_row${t}col${e}`}function Ry(){return{width:1,color:"#000"}}function Bc(){return{hide:!0}}function NMe(){return{width:1,color:"#000",cornerVisible:!1}}function rP(t){if(it(t.start)||it(t.left)){var e;t.start=(e=t.start)!==null&&e!==void 0?e:t.left}if(it(t.end)||it(t.right)){var r;t.end=(r=t.end)!==null&&r!==void 0?r:t.right}return delete t.left,delete t.right,t}function Qw(t){return it(t.start)&&(t.left=t.start),it(t.end)&&(t.right=t.end),t}function nP(t,e){return{id:see(t,e),border:NMe(),row:t,col:e,top:Bc(),bottom:Bc(),start:Bc(),end:Bc()}}function HMe(t,e){return ni(e,"border")&&e.border&&(t.border=e.border),ni(e,"top")&&it(e.top)&&(e.top?(Vt(e.top)||(e.top=Ry()),t.top=e.top):(e.top=Bc(),t.top=e.top)),ni(e,"bottom")&&it(e.bottom)&&(e.bottom?(Vt(e.bottom)||(e.bottom=Ry()),t.bottom=e.bottom):(e.bottom=Bc(),t.bottom=e.bottom)),ni(e,"start")&&it(e.start)&&(e.start?(Vt(e.start)||(e.start=Ry()),t.start=e.start):(e.start=Bc(),t.start=e.start)),ni(e,"end")&&it(e.end)&&(e.end?(Vt(e.end)||(e.end=Ry()),t.end=e.end):(e.end=Bc(),t.end=e.end)),t}function nh(t,e){let r=!1;return he(t.getSelectedRange(),n=>{n.forAll((i,s)=>{if(i<0||s<0)return;const a=t.getCellMeta(i,s).borders;if(a)if(e){if(!ni(a[e],"hide")||a[e].hide===!1)return r=!0,!1}else return r=!0,!1})}),r}function wT(t){return`<span class="selected">✓</span>${t}`}function FMe(t){return t.some(e=>it(e.left)||it(e.right))}function LMe(t){return t.some(e=>it(e.start)||it(e.end))}const BMe=new Map([["left","start"],["right","end"]]);function VMe(t){var e;return(e=BMe.get(t))!==null&&e!==void 0?e:t}function WMe(t){return{key:"borders:bottom",name(){let e=this.getTranslatedPhrase(zL);return nh(this,"bottom")&&(e=wT(e)),e},callback(e,r){const n=nh(this,"bottom");t.prepareBorder(r,"bottom",n)}}}function $Me(t){const e=t.hot.isRtl()?"end":"start";return{key:"borders:left",name(){let r=this.getTranslatedPhrase(GL);return nh(this,e)&&(r=wT(r)),r},callback(r,n){const i=nh(this,e);t.prepareBorder(n,e,i)}}}function UMe(t){return{key:"borders:no_borders",name(){return this.getTranslatedPhrase(qL)},callback(e,r){t.prepareBorder(r,"noBorders")},disabled(){return!nh(this)}}}function jMe(t){const e=t.hot.isRtl()?"start":"end";return{key:"borders:right",name(){let r=this.getTranslatedPhrase(YL);return nh(this,e)&&(r=wT(r)),r},callback(r,n){const i=nh(this,e);t.prepareBorder(n,e,i)}}}function YMe(t){return{key:"borders:top",name(){let e=this.getTranslatedPhrase(jL);return nh(this,"top")&&(e=wT(e)),e},callback(e,r){const n=nh(this,"top");t.prepareBorder(r,"top",n)}}}function zMe(t,e){GMe(t,e),e.add(t)}function GMe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function qMe(t,e,r){return(e=KMe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function KMe(t){var e=XMe(t,"string");return typeof e=="symbol"?e:e+""}function XMe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function gY(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const RE="customBorders",QMe=90;var iP=new WeakSet;class ZMe extends ur{constructor(){super(...arguments),zMe(this,iP),qMe(this,"savedBorders",[])}static get PLUGIN_KEY(){return RE}static get PLUGIN_PRIORITY(){return QMe}isEnabled(){return!!this.hot.getSettings()[RE]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>gY(iP,this,JMe).call(this,e)),this.addHook("init",()=>gY(iP,this,eAe).call(this)),super.enablePlugin())}disablePlugin(){this.hideBorders(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),super.updatePlugin()}setBorders(e,r){let n=["top","bottom","start","end"],i=null;r&&(this.checkSettingsCohesion([r]),n=Object.keys(r),i=rP(r));const s=kp(e),a=T1(s,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)});he(e,o=>{a(o).forAll((u,c)=>{he(n,f=>{this.prepareBorderFromCustomAdded(u,c,i,VMe(f))})})}),this.hot.view.render()}getBorders(e){if(!Array.isArray(e))return this.savedBorders;const r=kp(e),n=T1(r,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)}),i=[];return he(e,s=>{n(s).forAll((a,o)=>{he(this.savedBorders,u=>{u.row===a&&u.col===o&&i.push(Qw(u))})})}),i}clearBorders(e){e?this.setBorders(e):(he(this.savedBorders,r=>{this.clearBordersFromSelectionSettings(r.id),this.clearNullCellRange(),this.hot.removeCellMeta(r.row,r.col,"borders")}),this.savedBorders.length=0)}insertBorderIntoSettings(e,r){this.checkSavedBorders(e)||this.savedBorders.push(e);const i=this.hot._createCellRange(this.hot._createCellCoords(e.row,e.col));this.checkCustomSelections(e,i,r)||this.hot.selection.highlight.addCustomSelection({border:e,visualCellRange:i})}prepareBorderFromCustomAdded(e,r,n,i){const s=this.hot.countRows(),a=this.hot.countCols();if(e>=s||r>=a)return;let o=nP(e,r);n&&(o=HMe(o,n),he(this.hot.selection.highlight.customSelections,u=>{if(o.id===u.settings.id)return Object.assign(u.settings,n),o.id=u.settings.id,o.top=u.settings.top,o.bottom=u.settings.bottom,o.start=u.settings.start,o.end=u.settings.end,!1})),this.hot.setCellMeta(e,r,"borders",Qw(o)),this.insertBorderIntoSettings(o,i)}prepareBorderFromCustomAddedRange(e,r){const n=Math.min(e.to.row,this.hot.countRows()-1),i=Math.min(e.to.col,this.hot.countCols()-1);ct(e.from.row,n,s=>{ct(e.from.col,i,a=>{const o=nP(s,a);let u=0;s===e.from.row&&ni(r,"top")&&(u+=1,o.top=r.top),s===e.to.row&&ni(r,"bottom")&&(u+=1,o.bottom=r.bottom),a===e.from.col&&ni(r,"start")&&(u+=1,o.start=r.start),a===e.to.col&&ni(r,"end")&&(u+=1,o.end=r.end),u>0&&(this.hot.setCellMeta(s,a,"borders",Qw(o)),this.insertBorderIntoSettings(o))})})}removeAllBorders(e,r){const n=see(e,r);this.spliceBorder(n),this.clearBordersFromSelectionSettings(n),this.clearNullCellRange(),this.hot.removeCellMeta(e,r,"borders")}setBorder(e,r,n,i){let s=this.hot.getCellMeta(e,r).borders;!s||s.border===void 0?s=nP(e,r):s=rP(s),i?(s[n]=Bc(),this.countHide(s)===4?this.removeAllBorders(e,r):(this.checkCustomSelectionsFromContextMenu(s,n,i)||this.insertBorderIntoSettings(s),this.hot.setCellMeta(e,r,"borders",Qw(s)))):(s[n]=Ry(),this.checkCustomSelectionsFromContextMenu(s,n,i)||this.insertBorderIntoSettings(s),this.hot.setCellMeta(e,r,"borders",Qw(s)))}prepareBorder(e,r,n){he(e,i=>{let{start:s,end:a}=i;if(s.row===a.row&&s.col===a.col)r==="noBorders"?this.removeAllBorders(s.row,s.col):this.setBorder(s.row,s.col,r,n);else switch(r){case"noBorders":ct(s.col,a.col,o=>{ct(s.row,a.row,u=>{this.removeAllBorders(u,o)})});break;case"top":ct(s.col,a.col,o=>{this.setBorder(s.row,o,r,n)});break;case"bottom":ct(s.col,a.col,o=>{this.setBorder(a.row,o,r,n)});break;case"start":ct(s.row,a.row,o=>{this.setBorder(o,s.col,r,n)});break;case"end":ct(s.row,a.row,o=>{this.setBorder(o,a.col,r,n)});break}})}createCustomBorders(e){he(e,r=>{const n=rP(r);r.range?this.prepareBorderFromCustomAddedRange(r.range,n):this.prepareBorderFromCustomAdded(r.row,r.col,n)})}countHide(e){const{top:r,bottom:n,start:i,end:s}=e;return Ri([r,n,i,s],(o,u)=>{let c=o;return u&&u.hide&&(c+=1),c},0)}clearBordersFromSelectionSettings(e){const r=nr(this.hot.selection.highlight.customSelections,n=>n.settings.id).indexOf(e);r>-1&&this.hot.selection.highlight.customSelections[r].clear()}clearNullCellRange(){he(this.hot.selection.highlight.customSelections,(e,r)=>{if(e.cellRange===null)return this.hot.selection.highlight.customSelections[r].destroy(),this.hot.selection.highlight.customSelections.splice(r,1),!1})}hideBorders(){he(this.savedBorders,e=>{this.clearBordersFromSelectionSettings(e.id),this.clearNullCellRange()})}spliceBorder(e){const r=nr(this.savedBorders,n=>n.id).indexOf(e);r>-1&&this.savedBorders.splice(r,1)}checkSavedBorders(e){let r=!1;return this.countHide(e)===4?(this.spliceBorder(e.id),r=!0):he(this.savedBorders,(i,s)=>{if(e.id===i.id)return this.savedBorders[s]=e,r=!0,!1}),r}checkCustomSelectionsFromContextMenu(e,r,n){let i=!1;return he(this.hot.selection.highlight.customSelections,s=>{if(e.id===s.settings.id){const a=this.hot.view._wt.selectionManager.getBorderInstances(s);return he(a,o=>{o.toggleHiddenClass(r,n)}),i=!0,!1}}),i}checkCustomSelections(e,r,n){const i=this.countHide(e);let s=!1;return i===4?(this.removeAllBorders(e.row,e.col),s=!0):he(this.hot.selection.highlight.customSelections,a=>{if(e.id===a.settings.id){if(a.visualCellRange=r,a.commit(),n){const o=this.hot.view._wt.selectionManager.getBorderInstances(a);he(o,u=>{u.changeBorderStyle(n,e)})}return s=!0,!1}}),s}changeBorderSettings(){const e=this.hot.getSettings()[RE];if(Array.isArray(e)){const r=As(e);this.checkSettingsCohesion(r),r.length||(this.savedBorders=r),this.createCustomBorders(r)}else e!==void 0&&this.createCustomBorders(this.savedBorders)}checkSettingsCohesion(e){const r=FMe(e),n=LMe(e);if(r&&n)throw new Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&r)throw new Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".')}destroy(){super.destroy()}}function JMe(t){this.hot.getSettings()[RE]&&t.items.push({name:"---------"},{key:"borders",name(){return this.getTranslatedPhrase(UL)},disabled(){const e=this.getSelectedRangeLast();return!e||e.isSingleHeader()?!0:this.selection.isSelectedByCorner()},submenu:{items:[YMe(this),jMe(this),WMe(this),$Me(this),UMe(this)]}})}function eAe(){this.changeBorderSettings()}function tAe(t,e){rAe(t,e),e.add(t)}function rAe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function sP(t,e,r){return(e=nAe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function nAe(t){var e=iAe(t,"string");return typeof e=="symbol"?e:e+""}function iAe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function mY(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const pY="dragToScroll",sAe=100;var aP=new WeakSet;class aAe extends ur{constructor(){super(...arguments),tAe(this,aP),sP(this,"boundaries",null),sP(this,"callback",null),sP(this,"listening",!1)}static get PLUGIN_KEY(){return pY}static get PLUGIN_PRIORITY(){return sAe}isEnabled(){return!!this.hot.getSettings()[pY]}enablePlugin(){this.enabled||(this.addHook("afterOnCellMouseDown",e=>mY(aP,this,vY).call(this,e)),this.addHook("afterOnCellCornerMouseDown",e=>mY(aP,this,vY).call(this,e)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.unregisterEvents(),super.disablePlugin()}setBoundaries(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{left:0,right:this.hot.rootWindow.innerWidth,top:0,bottom:this.hot.rootWindow.innerHeight};this.boundaries=e}setCallback(e){this.callback=e}check(e,r){let n=0,i=0;r<this.boundaries.top?i=r-this.boundaries.top:r>this.boundaries.bottom&&(i=r-this.boundaries.bottom),e<this.boundaries.left?n=e-this.boundaries.left:e>this.boundaries.right&&(n=e-this.boundaries.right),this.callback(n,i)}listen(){this.listening=!0}unlisten(){this.listening=!1}isListening(){return this.listening}registerEvents(){const{rootWindow:e}=this.hot;let r=e;for(;r;)this.eventManager.addEventListener(r.document,"contextmenu",()=>this.unlisten()),this.eventManager.addEventListener(r.document,"mouseup",()=>this.unlisten()),this.eventManager.addEventListener(r.document,"mousemove",n=>this.onMouseMove(n)),r=Pg(r)}unregisterEvents(){this.eventManager.clear()}onMouseMove(e){this.isListening()&&this.check(e.clientX,e.clientY)}destroy(){super.destroy()}}function vY(t){if(Vf(t))return;const e=this.hot.view._wt.wtOverlays.topOverlay.mainTableScrollableElement;this.setBoundaries(e!==this.hot.rootWindow?e.getBoundingClientRect():void 0),this.setCallback((r,n)=>{var i,s;const a=(i=e.scrollLeft)!==null&&i!==void 0?i:e.scrollX,o=(s=e.scrollTop)!==null&&s!==void 0?s:e.scrollY;e.scroll(a+Math.sign(r)*50,o+Math.sign(n)*20)}),this.listen()}function oAe(t,e){aee(t,e),e.add(t)}function lAe(t,e,r){aee(t,e),e.set(t,r)}function aee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function oP(t,e,r){return(e=uAe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function uAe(t){var e=cAe(t,"string");return typeof e=="symbol"?e:e+""}function cAe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function hAe(t,e){return t.get(Ao(t,e))}function oee(t,e,r){return t.set(Ao(t,e),r),r}function Ao(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}Je.getSingleton().register("afterDropdownMenuDefaultOptions");Je.getSingleton().register("beforeDropdownMenuShow");Je.getSingleton().register("afterDropdownMenuShow");Je.getSingleton().register("afterDropdownMenuHide");Je.getSingleton().register("afterDropdownMenuExecute");const TE="dropdownMenu",fAe=230,k1="changeType",lP=TE;var yT=new WeakMap,yl=new WeakSet;class ST extends ur{static get PLUGIN_KEY(){return TE}static get PLUGIN_PRIORITY(){return fAe}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[DS,PS,Yt,NS,Yt,cT,Yt,IS,Yt,Mo]}constructor(e){super(e),oAe(this,yl),oP(this,"commandExecutor",new qJ(this.hot)),oP(this,"itemsFactory",null),oP(this,"menu",null),lAe(this,yT,!1),this.hot.addHook("afterGetColHeader",(r,n)=>Ao(yl,this,gAe).call(this,r,n))}isEnabled(){return this.hot.getSettings()[TE]}enablePlugin(){var e=this;if(this.enabled)return;this.itemsFactory=new KJ(this.hot,ST.DEFAULT_ITEMS),this.addHook("beforeOnCellMouseDown",function(){for(var i=arguments.length,s=new Array(i),a=0;a<i;a++)s[a]=arguments[a];return Ao(yl,e,SAe).call(e,...s)}),this.addHook("beforeViewportScrollHorizontally",function(){for(var i=arguments.length,s=new Array(i),a=0;a<i;a++)s[a]=arguments[a];return Ao(yl,e,yAe).call(e,...s)});const r=this.hot.getSettings()[TE],n={items:this.itemsFactory.getItems(r)};this.registerEvents(),typeof r.callback=="function"&&this.commandExecutor.setCommonCallback(r.callback),this.registerShortcuts(),super.enablePlugin(),this.callOnPluginsReady(()=>{this.hot.runHooks("afterDropdownMenuDefaultOptions",n),this.itemsFactory.setPredefinedItems(n.items);const i=this.itemsFactory.getItems(r);this.menu&&this.menu.destroy(),this.menu=new cv(this.hot,{className:"htDropdownMenu",keepInViewport:!0,container:r.uiContainer||this.hot.rootPortalElement}),this.hot.runHooks("beforeDropdownMenuSetItems",i),this.menu.setMenuItems(i),this.menu.addLocalHook("beforeOpen",()=>Ao(yl,this,mAe).call(this)),this.menu.addLocalHook("afterOpen",()=>Ao(yl,this,pAe).call(this)),this.menu.addLocalHook("afterSubmenuOpen",s=>Ao(yl,this,vAe).call(this,s)),this.menu.addLocalHook("afterClose",()=>Ao(yl,this,wAe).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var s=arguments.length,a=new Array(s),o=0;o<s;o++)a[o]=arguments[o];return e.executeCommand.call(e,...a)}),he(i,s=>this.commandExecutor.registerCommand(s.key,s))})}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&this.menu.destroy(),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager().getContext("grid"),r=()=>{const{highlight:n}=this.hot.getSelectedRangeLast();if((n.isHeader()&&n.row===-1||n.isCell())&&n.col>=0){this.hot.selectColumns(n.col,n.col,-1);const{from:i}=this.hot.getSelectedRangeLast(),s=uT(this.menu.container,this.hot.rootDocument),a=this.hot.getCell(-1,i.col,!0).querySelector(`.${k1}`),o=a.getBoundingClientRect();this.open({left:o.left+s.left,top:o.top+a.offsetHeight+s.top},{left:o.width,right:0,above:0,below:3}),this.menu.getNavigator().toFirstItem()}};e.addShortcuts([{keys:[["Shift","Alt","ArrowDown"],["Control/Meta","Enter"]],callback:r,runOnlyIf:()=>{var n;const i=(n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.highlight;return i&&this.hot.selection.isCellVisible(i)&&i.isHeader()&&!this.menu.isOpened()},captureCtrl:!0,group:lP},{keys:[["Shift","Alt","ArrowDown"]],callback:r,runOnlyIf:()=>{var n;const i=(n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.highlight;return i&&this.hot.selection.isCellVisible(i)&&i.isCell()&&!this.menu.isOpened()},group:lP}])}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(lP)}registerEvents(){this.eventManager.addEventListener(this.hot.rootElement,"click",e=>Ao(yl,this,dAe).call(this,e))}open(e){var r;let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};(r=this.menu)!==null&&r!==void 0&&r.isOpened()||(this.menu.open(),Wt(n,(i,s)=>{this.menu.setOffset(s,i)}),this.menu.setPosition(e))}close(){var e;(e=this.menu)===null||e===void 0||e.close()}executeCommand(e){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];this.commandExecutor.execute(e,...n)}setListening(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.menu.isOpened()&&(e?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function lee(t){t.getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Control/Meta","A"]],callback:()=>!1}])}function dAe(t){if(Ct(t.target,k1)){const e=uT(this.menu.container,this.hot.rootDocument),r=t.target.getBoundingClientRect();t.stopPropagation(),oee(yT,this,!1),this.open({left:r.left+e.left,top:r.top+t.target.offsetHeight+e.top},{left:r.width,right:0,above:0,below:3})}}function gAe(t,e){const r=e.parentNode;if(!r)return;const n=r.parentNode.childNodes,i=Array.prototype.indexOf.call(n,r);if(t<0||i!==n.length-1)return;const s=e.querySelector(`.${k1}`);if(this.enabled&&s)return;if(!this.enabled){s&&s.parentNode.removeChild(s);return}const a=this.hot.rootDocument.createElement("button");a.className=k1,a.type="button",a.tabIndex=-1,this.hot.getSettings().ariaTags&&(bt(a,[sm(),Rp(" ")]),bt(e,[lQ("menu")])),a.onclick=function(){return!1},e.firstChild.insertBefore(a,e.firstChild.firstChild)}function mAe(){this.hot.runHooks("beforeDropdownMenuShow",this)}function pAe(){this.hot.runHooks("afterDropdownMenuShow",this),Ao(yl,this,lee).call(this,this.menu)}function vAe(t){Ao(yl,this,lee).call(this,t)}function wAe(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}function yAe(t){return hAe(yT,this)?null:t}function SAe(t){Ct(t.target,k1)&&oee(yT,this,!0)}ST.SEPARATOR={name:Yt};function wY(t,e,r){return(e=bAe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function bAe(t){var e=CAe(t,"string");return typeof e=="symbol"?e:e+""}function CAe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class xAe{constructor(e){wY(this,"hot",void 0),wY(this,"options",{}),this.hot=e}setOptions(e){this.options=e}getData(){const{startRow:e,startCol:r,endRow:n,endCol:i}=this._getDataRange(),s=this.options,a=[];return ct(e,n,o=>{const u=[];!s.exportHiddenRows&&this._isHiddenRow(o)||(ct(r,i,c=>{!s.exportHiddenColumns&&this._isHiddenColumn(c)||u.push(this.hot.getDataAtCell(o,c))}),a.push(u))}),a}getRowHeaders(){const e=[];if(this.options.rowHeaders){const{startRow:r,endRow:n}=this._getDataRange(),i=this.hot.getRowHeader();ct(r,n,s=>{!this.options.exportHiddenRows&&this._isHiddenRow(s)||e.push(i[s])})}return e}getColumnHeaders(){const e=[];if(this.options.columnHeaders){const{startCol:r,endCol:n}=this._getDataRange(),i=this.hot.getColHeader();ct(r,n,s=>{!this.options.exportHiddenColumns&&this._isHiddenColumn(s)||e.push(i[s])})}return e}_getDataRange(){const e=this.hot.countCols()-1,r=this.hot.countRows()-1;let[n=0,i=0,s=r,a=e]=this.options.range;return n=Math.max(n,0),i=Math.max(i,0),s=Math.min(s,r),a=Math.min(a,e),{startRow:n,startCol:i,endRow:s,endCol:a}}_isHiddenRow(e){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(e))}_isHiddenColumn(e){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(e))}}function yY(t,e,r){return(e=EAe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function EAe(t){var e=_Ae(t,"string");return typeof e=="symbol"?e:e+""}function _Ae(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class u3{static get DEFAULT_OPTIONS(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}constructor(e,r){yY(this,"dataProvider",void 0),yY(this,"options",void 0),this.dataProvider=e,this.options=this._mergeOptions(r),this.dataProvider.setOptions(this.options)}_mergeOptions(e){let r=Nl(this.constructor.DEFAULT_OPTIONS);const n=new Date;return r=oi(Nl(u3.DEFAULT_OPTIONS),r),r=oi(r,e),r.filename=pF(r.filename,{YYYY:n.getFullYear(),MM:`${n.getMonth()+1}`.padStart(2,"0"),DD:`${n.getDate()}`.padStart(2,"0")}),r}}function RAe(t,e){TAe(t,e),e.add(t)}function TAe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function SY(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const uee="\r",MAe='"',AAe=`
`,OAe="=",kAe="+",DAe="-",PAe="@",IAe="	";var uP=new WeakSet;class NAe extends u3{constructor(){super(...arguments),RAe(this,uP)}static get DEFAULT_OPTIONS(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:`\r
`,sanitizeValues:!1}}export(){const e=this.options,r=this.dataProvider.getData();let n=this.dataProvider.getColumnHeaders();const i=n.length>0,s=this.dataProvider.getRowHeaders(),a=s.length>0;let o=e.bom?"\uFEFF":"";return i&&(n=nr(n,u=>this._escapeCell(u,{force:!0,sanitizeValue:e.sanitizeValues})),a&&(o+=e.columnDelimiter),o+=n.join(e.columnDelimiter),o+=e.rowDelimiter),he(r,(u,c)=>{c>0&&(o+=e.rowDelimiter),a&&(o+=this._escapeCell(s[c],{sanitizeValue:e.sanitizeValues}),o+=e.columnDelimiter);const f=u.map(g=>this._escapeCell(g,{sanitizeValue:e.sanitizeValues})).join(e.columnDelimiter);o+=f}),o}_escapeCell(e){let{force:r=!1,sanitizeValue:n=!1}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=cn(e);return i===""||(n&&(r=!0),n instanceof RegExp?i=SY(uP,this,FAe).call(this,i,n):typeof n=="function"?i=n(i):n&&(i=SY(uP,this,HAe).call(this,i)),(r||i.indexOf(uee)>=0||i.indexOf(MAe)>=0||i.indexOf(AAe)>=0||i.indexOf(this.options.columnDelimiter)>=0)&&(i=i.replace(new RegExp('"',"g"),'""'),i=`"${i}"`)),i}}function HAe(t){return t.startsWith(OAe)||t.startsWith(kAe)||t.startsWith(DAe)||t.startsWith(PAe)||t.startsWith(IAe)||t.startsWith(uee)?`'${t}`:t}function FAe(t,e){return e.test(t)?`'${t}`:t}const LAe="csv",NN={[LAe]:NAe};function BAe(t,e,r){return typeof NN[t]=="function"?new NN[t](e,r):null}const VAe="exportFile",WAe=240;class $Ae extends ur{static get PLUGIN_KEY(){return VAe}static get PLUGIN_PRIORITY(){return WAe}isEnabled(){return!0}exportAsString(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createTypeFormatter(e,r).export()}exportAsBlob(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createBlob(this._createTypeFormatter(e,r))}downloadFile(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{rootDocument:n,rootWindow:i}=this.hot,s=this._createTypeFormatter(e,r),a=this._createBlob(s),o=i.URL||i.webkitURL,u=n.createElement("a"),c=`${s.options.filename}.${s.options.fileExtension}`;if(u.download!==void 0){const f=o.createObjectURL(a);u.style.display="none",u.setAttribute("href",f),u.setAttribute("download",c),n.body.appendChild(u),u.dispatchEvent(new MouseEvent("click")),n.body.removeChild(u),setTimeout(()=>{o.revokeObjectURL(f)},100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(a,c)}_createTypeFormatter(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!NN[e])throw new Error(`Export format type "${e}" is not supported.`);return BAe(e,new xAe(this.hot),r)}_createBlob(e){let r=null;return typeof Blob<"u"&&(r=new Blob([e.export()],{type:`${e.options.mimeType};charset=${e.options.encoding}`})),r}}function R0(t,e,r){return(e=UAe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function UAe(t){var e=jAe(t,"string");return typeof e=="symbol"?e:e+""}function jAe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class HS{constructor(e,r){let{id:n,stateless:i=!0}=r;R0(this,"hot",void 0),R0(this,"id",void 0),R0(this,"elements",[]),R0(this,"hidden",!1),R0(this,"stateId",""),R0(this,"state",void 0),this.hot=e,this.id=n,this.stateId=`Filters.component.${this.id}`,this.state=i?null:this.hot.columnIndexMapper.registerMap(this.stateId,new JR)}getElements(){return this.elements}reset(){he(this.elements,e=>e.reset())}hide(){this.hidden=!0}show(){this.hidden=!1}isHidden(){return this.hot===null||this.hidden}restoreState(e){this.state&&this.setState(this.state.getValueAtIndex(e))}setState(){throw new Error("The state setting logic is not implemented")}saveState(e){this.state&&this.state.setValueAtIndex(e,this.getState())}getState(){throw new Error("The state gathering logic is not implemented")}destroy(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),he(this.elements,e=>e.destroy()),this.state=null,this.elements=null,this.hot=null}}Lr(HS,as);const D1={};function Wf(t,e){if(!D1[t])throw Error(`Filter condition "${t}" does not exist.`);const{condition:r,descriptor:n}=D1[t];let i=e;return n.inputValuesDecorator&&(i=n.inputValuesDecorator(i)),function(s){return r.apply(s.meta.instance,[].concat([s],[i]))}}function yg(t){if(!D1[t])throw Error(`Filter condition "${t}" does not exist.`);return D1[t].descriptor}function ci(t,e,r){r.key=t,D1[t]={condition:e,descriptor:r}}const Ui="none";function YAe(){return!0}ci(Ui,YAe,{name:eT,inputsCount:0,showOperators:!1});const Uy="empty";function zAe(t){return In(t.value)}ci(Uy,zAe,{name:t4,inputsCount:0,showOperators:!0});const ME="not_empty";function GAe(t,e){return!Wf(Uy,e)(t)}ci(ME,GAe,{name:r4,inputsCount:0,showOperators:!0});const jy="eq";function qAe(t,e){let[r]=e;return cn(t.value).toLocaleLowerCase(t.meta.locale)===cn(r)}ci(jy,qAe,{name:n4,inputsCount:1,showOperators:!0});const AE="neq";function KAe(t,e){return!Wf(jy,e)(t)}ci(AE,KAe,{name:i4,inputsCount:1,showOperators:!0});const cee="gt";function XAe(t,e){let[r]=e,n=r;return t.meta.type==="numeric"&&(n=parseFloat(n,10)),t.value>n}ci(cee,XAe,{name:u4,inputsCount:1,showOperators:!0});const hee="gte";function QAe(t,e){let[r]=e,n=r;return t.meta.type==="numeric"&&(n=parseFloat(n,10)),t.value>=n}ci(hee,QAe,{name:c4,inputsCount:1,showOperators:!0});const fee="lt";function ZAe(t,e){let[r]=e,n=r;return t.meta.type==="numeric"&&(n=parseFloat(n,10)),t.value<n}ci(fee,ZAe,{name:h4,inputsCount:1,showOperators:!0});const dee="lte";function JAe(t,e){let[r]=e,n=r;return t.meta.type==="numeric"&&(n=parseFloat(n,10)),t.value<=n}ci(dee,JAe,{name:f4,inputsCount:1,showOperators:!0});const c3="date_after";function eOe(t,e){let[r]=e;const n=je(t.value,t.meta.dateFormat),i=je(r,t.meta.dateFormat);return!n.isValid()||!i.isValid()?!1:n.diff(i)>=0}ci(c3,eOe,{name:m4,inputsCount:1,showOperators:!0});const h3="date_before";function tOe(t,e){let[r]=e;const n=je(t.value,t.meta.dateFormat),i=je(r,t.meta.dateFormat);return!n.isValid()||!i.isValid()?!1:n.diff(i)<=0}ci(h3,tOe,{name:p4,inputsCount:1,showOperators:!0});const y_="between";function rOe(t,e){let[r,n]=e,i=r,s=n;if(t.meta.type==="numeric"){const a=parseFloat(i,10),o=parseFloat(s,10);i=Math.min(a,o),s=Math.max(a,o)}else if(t.meta.type==="date"){const a=Wf(h3,[s]),o=Wf(c3,[i]);return a(t)&&o(t)}return t.value>=i&&t.value<=s}ci(y_,rOe,{name:d4,inputsCount:2,showOperators:!0});const gee="not_between";function nOe(t,e){return!Wf(y_,e)(t)}ci(gee,nOe,{name:g4,inputsCount:2,showOperators:!0});const mee="begins_with";function iOe(t,e){let[r]=e;return cn(t.value).toLocaleLowerCase(t.meta.locale).startsWith(cn(r))}ci(mee,iOe,{name:s4,inputsCount:1,showOperators:!0});const pee="ends_with";function sOe(t,e){let[r]=e;return cn(t.value).toLocaleLowerCase(t.meta.locale).endsWith(cn(r))}ci(pee,sOe,{name:a4,inputsCount:1,showOperators:!0});const f3="contains";function aOe(t,e){let[r]=e;return cn(t.value).toLocaleLowerCase(t.meta.locale).indexOf(cn(r))>=0}ci(f3,aOe,{name:o4,inputsCount:1,showOperators:!0});const vee="not_contains";function oOe(t,e){return!Wf(f3,e)(t)}ci(vee,oOe,{name:l4,inputsCount:1,showOperators:!0});const wee="date_tomorrow";function lOe(t){const e=je(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(je().subtract(-1,"days").startOf("day"),"d"):!1}ci(wee,lOe,{name:w4,inputsCount:0});const yee="date_today";function uOe(t){const e=je(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(je().startOf("day"),"d"):!1}ci(yee,uOe,{name:v4,inputsCount:0});const See="date_yesterday";function cOe(t){const e=je(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(je().subtract(1,"days").startOf("day"),"d"):!1}ci(See,cOe,{name:y4,inputsCount:0});mQ();function hOe(t,e){let r=t;return r===""&&(r=`(${e})`),r}function FS(t){const e=new Set(t);return function(r){return e.has(r)}}function d3(t){return t??""}function HN(t){return Array.from(new Set(t)).map(e=>d3(e)).sort((e,r)=>typeof e=="number"&&typeof r=="number"?e-r:e===r?0:e>r?1:-1)}function bY(t,e,r,n){const i=[],s=t===e;let a;return s||(a=FS(e)),t.forEach(o=>{let u=!1;(s||a(o))&&(u=!0);const c={checked:u,value:o,visualValue:hOe(o,r)};n&&n(c),i.push(c)}),i}const Sg="by_value";function fOe(t,e){let[r]=e;return r(t.value)}ci(Sg,fOe,{name:"By value",inputsCount:0,inputValuesDecorator(t){let[e]=t;return[FS(e)]},showOperators:!1});const P1={};function dOe(t){if(!P1[t])throw Error(`Operation with id "${t}" does not exist.`);const e=P1[t].func;return function(r,n){return e(r,n)}}function gOe(t){return P1[t].name}function g3(t,e,r){P1[t]={name:e,func:r}}const Pf="conjunction",mOe=C4;function pOe(t,e){return t.every(r=>r.func(e))}g3(Pf,mOe,pOe);const S_="disjunction",vOe=tT;function wOe(t,e){return t.some(r=>r.func(e))}g3(S_,vOe,wOe);const m3="disjunctionWithExtraCondition",yOe=tT;function SOe(t,e){if(t.length<3)throw Error("Operation doesn't work on less then three conditions.");return t.slice(0,t.length-1).some(r=>r.func(e))&&t[t.length-1].func(e)}g3(m3,yOe,SOe);const bOe="numeric",bee="text",COe="date",CY={[bOe]:[Ui,Yt,Uy,ME,Yt,jy,AE,Yt,cee,hee,fee,dee,y_,gee],[bee]:[Ui,Yt,Uy,ME,Yt,jy,AE,Yt,mee,pee,Yt,f3,vee],[COe]:[Ui,Yt,Uy,ME,Yt,jy,AE,Yt,h3,c3,y_,Yt,wee,yee,See]};function xOe(t){const e=[];let r=t;return CY[r]||(r=bee),he(CY[r],n=>{let i;n===Yt?i={name:Yt}:i=Nl(yg(n)),e.push(i)}),e}function Zw(t,e,r){return(e=EOe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function EOe(t){var e=_Oe(t,"string");return typeof e=="symbol"?e:e+""}function _Oe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const cP="built",hP="building",xY=["click","input","keydown","keypress","keyup","focus","blur","change"];let Ml=class Cee{static get DEFAULTS(){return Nl({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}constructor(e,r){Zw(this,"hot",void 0),Zw(this,"eventManager",new Uo(this)),Zw(this,"options",void 0),Zw(this,"_element",void 0),Zw(this,"buildState",void 0),this.hot=e,this.options=oi(Cee.DEFAULTS,r),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName)}setValue(e){this.options.value=e,this.update()}getValue(){return this.options.value}get element(){return this.buildState===hP?this._element:this.buildState===cP?(this.update(),this._element):(this.buildState=hP,this.build(),this.buildState=cP,this._element)}isBuilt(){return this.buildState===cP}translateIfPossible(e){return typeof e=="string"&&e.startsWith(Xs)?this.hot.getTranslatedPhrase(e):e}build(){const e=(r,n)=>{this.eventManager.addEventListener(r,n,i=>this.runLocalHooks(n,i,this))};if(this.buildState||(this.buildState=hP),this._element.setAttribute("data-hot-input",!0),this.options.tabIndex!==void 0&&this._element.setAttribute("tabindex",this.options.tabIndex),this.options.role!==void 0&&this._element.setAttribute("role",this.options.role),this.options.className&&Ve(this._element,this.options.className),this.options.children.length)he(this.options.children,r=>this._element.appendChild(r.element));else if(this.options.wrapIt){const r=this.hot.rootDocument.createElement(this.options.tagName);r.setAttribute("data-hot-input",!0),Wt(this.options,(n,i)=>{r[i]!==void 0&&i!=="className"&&i!=="tagName"&&i!=="children"&&(r[i]=this.translateIfPossible(n))}),this._element.appendChild(r),he(xY,n=>e(r,n))}else he(xY,r=>e(this._element,r))}update(){}reset(){this.options.value="",this.update()}show(){this.element.style.display=""}hide(){this.element.style.display="none"}focus(){}destroy(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}};Lr(Ml,as);function ROe(t,e){xee(t,e),e.add(t)}function TOe(t,e,r){xee(t,e),e.set(t,r)}function xee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ix(t,e){return t.get(p3(t,e))}function MOe(t,e,r){return t.set(p3(t,e),r),r}function p3(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var T0=new WeakMap,EY=new WeakSet;class If extends Ml{static get DEFAULTS(){return Nl({placeholder:"",type:"text",tagName:"input",tabIndex:-1})}constructor(e,r){super(e,oi(If.DEFAULTS,r)),ROe(this,EY),TOe(this,T0,void 0),this.registerHooks()}registerHooks(){this.addLocalHook("keyup",e=>p3(EY,this,AOe).call(this,e))}build(){super.build();const e=this.hot.rootDocument.createElement("div");MOe(T0,this,this._element.firstChild),Ve(this._element,"htUIInput"),Ve(e,"htUIInputIcon"),this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(ix(T0,this).type=this.options.type,ix(T0,this).placeholder=this.translateIfPossible(this.options.placeholder),ix(T0,this).value=this.translateIfPossible(this.options.value))}focus(){this.isBuilt()&&ix(T0,this).focus()}}function AOe(t){this.options.value=t.target.value}function OOe(t,e){Eee(t,e),e.add(t)}function Jw(t,e,r){Eee(t,e),e.set(t,r)}function Eee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function M0(t,e,r){return t.set(Yy(t,e),r),r}function En(t,e){return t.get(Yy(t,e))}function Yy(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Oi=new WeakMap,sx=new WeakMap,ax=new WeakMap,fP=new WeakMap,ox=new WeakMap,lx=new WeakSet;class I1 extends Ml{static get DEFAULTS(){return Nl({className:"htUISelect",wrapIt:!1,tabIndex:-1})}constructor(e,r){super(e,oi(I1.DEFAULTS,r)),OOe(this,lx),Jw(this,Oi,null),Jw(this,sx,[]),Jw(this,ax,void 0),Jw(this,fP,void 0),Jw(this,ox,void 0),this.registerHooks()}getMenu(){return En(Oi,this)}registerHooks(){this.addLocalHook("click",()=>Yy(lx,this,POe).call(this))}setItems(e){M0(sx,this,this.translateNames(e)),En(Oi,this)&&En(Oi,this).setMenuItems(En(sx,this))}translateNames(e){return he(e,r=>{r.name=this.translateIfPossible(r.name)}),e}build(){super.build(),M0(Oi,this,new cv(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer})),En(Oi,this).setMenuItems(En(sx,this));const e=new Ml(this.hot,{className:"htUISelectCaption"}),r=new Ml(this.hot,{className:"htUISelectDropdown"});M0(ax,this,e),M0(fP,this,e.element),M0(ox,this,r),this.hot.getSettings().ariaTags&&(bt(r.element,[sm()]),bt(this._element,[oQ()])),he([e,r],n=>this._element.appendChild(n.element)),En(Oi,this).addLocalHook("select",n=>Yy(lx,this,kOe).call(this,n)),En(Oi,this).addLocalHook("afterClose",()=>Yy(lx,this,DOe).call(this)),this.update()}update(){if(!this.isBuilt())return;let e;this.options.value?e=this.options.value.name:e=En(Oi,this).hot.getTranslatedPhrase(eT),En(fP,this).textContent=e,super.update()}openOptions(){const e=this.element.getBoundingClientRect();En(Oi,this)&&(En(Oi,this).open(),En(Oi,this).setPosition({left:this.hot.isLtr()?e.left-5:e.left-31,top:e.top-1,width:e.width,height:e.height}),En(Oi,this).getNavigator().toFirstItem(),En(Oi,this).getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:r=>{this.closeOptions(),this.runLocalHooks("tabKeydown",r)}},{keys:[["Control/Meta","A"]],callback:()=>!1}]))}closeOptions(){En(Oi,this)&&En(Oi,this).close()}focus(){this.isBuilt()&&this.element.focus()}destroy(){En(Oi,this)&&(En(Oi,this).destroy(),M0(Oi,this,null)),En(ax,this)&&En(ax,this).destroy(),En(ox,this)&&En(ox,this).destroy(),super.destroy()}}function kOe(t){t.name!==Yt&&(this.options.value=t,this.update(),this.runLocalHooks("select",this.options.value))}function DOe(){this.runLocalHooks("afterClose")}function POe(){this.openOptions()}function IOe(t,e){NOe(t,e),e.add(t)}function NOe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _Y(t,e,r){return(e=HOe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function HOe(t){var e=FOe(t,"string");return typeof e=="symbol"?e:e+""}function FOe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function RY(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var dP=new WeakSet;class FN extends HS{constructor(e,r){super(e,{id:r.id,stateless:!1}),IOe(this,dP),_Y(this,"name",""),_Y(this,"addSeparator",!1),this.name=r.name,this.addSeparator=r.addSeparator,this.elements.push(new I1(this.hot,{menuContainer:r.menuContainer})),this.elements.push(new If(this.hot,{placeholder:M4})),this.elements.push(new If(this.hot,{placeholder:A4})),this.registerHooks()}registerHooks(){this.getSelectElement().addLocalHook("select",e=>RY(dP,this,LOe).call(this,e)).addLocalHook("afterClose",()=>this.runLocalHooks("afterClose")).addLocalHook("tabKeydown",e=>this.runLocalHooks("selectTabKeydown",e)),he(this.getInputElements(),e=>{e.addLocalHook("keydown",r=>RY(dP,this,BOe).call(this,r))})}setState(e){if(this.reset(),!e)return;const r=Nl(e.command);r.name.startsWith(Nn)&&(r.name=this.hot.getTranslatedPhrase(r.name)),this.getSelectElement().setValue(r),he(e.args,(n,i)=>{if(i>r.inputsCount-1)return!1;const s=this.getInputElement(i);s.setValue(n),s[r.inputsCount>i?"show":"hide"](),i||this.hot._registerTimeout(()=>s.focus(),10)})}getState(){const e=this.getSelectElement().getValue()||yg(Ui),r=[];return he(this.getInputElements(),(n,i)=>{e.inputsCount>i&&r.push(n.getValue())}),{command:e,args:r}}updateState(e,r){const n=yg(e?e.name:Ui);this.state.setValueAtIndex(r,{command:n,args:e?e.args:[]}),e||he(this.getInputElements(),i=>i.setValue(null))}getSelectElement(){return this.elements.filter(e=>e instanceof I1)[0]}getInputElement(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.getInputElements()[e]}getInputElements(){return this.elements.filter(e=>e instanceof If)}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,r,n,i,s,a)=>{Ve(r.parentNode,"htFiltersMenuCondition"),this.addSeparator&&Ve(r.parentNode,"border");const o=this.hot.rootDocument.createElement("div");return Ve(o,"htFiltersMenuLabel"),o.textContent=a,r.appendChild(o),r.parentElement.hasAttribute("ghost-table")||he(this.elements,u=>r.appendChild(u.element)),r}}}reset(){const e=this.hot.getPlugin("filters").getSelectedColumn();let r=[yg(Ui)];if(e!==null){const{visualIndex:n}=e;r=xOe(this.hot.getDataType(0,n,this.hot.countRows(),n))}he(this.getInputElements(),n=>n.hide()),this.getSelectElement().setItems(r),super.reset(),this.getSelectElement().setValue(r[0])}}function LOe(t){he(this.getInputElements(),(e,r)=>{e[t.inputsCount>r?"show":"hide"](),r===0&&this.hot._registerTimeout(()=>e.focus(),10)}),this.runLocalHooks("change",t)}function BOe(t){sv(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),Qo(t))}function TY(t,e,r){VOe(t,e),e.set(t,r)}function VOe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ey(t,e){return t.get(_ee(t,e))}function MY(t,e,r){return t.set(_ee(t,e),r),r}function _ee(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var A0=new WeakMap,gP=new WeakMap;class b_ extends Ml{static get DEFAULTS(){return Nl({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}constructor(e,r){super(e,oi(b_.DEFAULTS,r)),TY(this,A0,void 0),TY(this,gP,void 0)}build(){super.build();const e=this.hot.rootDocument.createElement("label");e.textContent=this.translateIfPossible(this.options.label.textContent),e.htmlFor=this.translateIfPossible(this.options.label.htmlFor),MY(gP,this,e),MY(A0,this,this._element.firstChild),ey(A0,this).checked=this.options.checked,this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(ey(gP,this).textContent=this.translateIfPossible(this.options.label.textContent))}isChecked(){return this.isBuilt()?ey(A0,this).checked:!1}setChecked(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isBuilt()&&(ey(A0,this).checked=e)}focus(){this.isBuilt()&&ey(A0,this).focus()}}function WOe(t,e){$Oe(t,e),e.add(t)}function $Oe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function UOe(t,e,r){return(e=jOe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function jOe(t){var e=YOe(t,"string");return typeof e=="symbol"?e:e+""}function YOe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function zOe(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const AY=0;var OY=new WeakSet;class GOe extends HS{constructor(e,r){super(e,{id:r.id,stateless:!1}),WOe(this,OY),UOe(this,"name",""),this.name=r.name,this.buildOperatorsElement()}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,r)=>(Ve(r.parentNode,"htFiltersMenuOperators"),he(this.elements,n=>r.appendChild(n.element)),r)}}buildOperatorsElement(){const e=[Pf,S_];he(e,r=>{const n=new b_(this.hot,{name:"operator",label:{htmlFor:r,textContent:gOe(r)},value:r,checked:r===e[AY],id:r});n.addLocalHook("change",i=>zOe(OY,this,qOe).call(this,i)),this.elements.push(n)})}setChecked(e){if(this.elements.length<e)throw Error(Dr`Radio button with index ${e} doesn't exist.`);he(this.elements,(r,n)=>{r.setChecked(n===e)})}getActiveOperationId(){const e=this.elements.find(r=>r instanceof b_&&r.isChecked());return e?e.getValue():Pf}getState(){return this.getActiveOperationId()}setState(e){this.reset(),e&&this.getActiveOperationId()!==e&&he(this.elements,r=>{r.setChecked(r.getValue()===e)})}updateState(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Pf,r=arguments.length>1?arguments[1]:void 0,n=e;n===m3&&(n=S_),this.state.setValueAtIndex(r,n)}reset(){this.setChecked(AY)}}function qOe(t){this.setState(t.target.value)}function KOe(t,e,r){XOe(t,e),e.set(t,r)}function XOe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function mP(t,e){return t.get(Ree(t,e))}function QOe(t,e,r){return t.set(Ree(t,e),r),r}function Ree(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var ty=new WeakMap;class N1 extends Ml{static get DEFAULTS(){return Nl({href:"#",tagName:"a",tabIndex:-1,role:"button"})}constructor(e,r){super(e,oi(N1.DEFAULTS,r)),KOe(this,ty,void 0)}build(){super.build(),QOe(ty,this,this._element.firstChild)}update(){this.isBuilt()&&(mP(ty,this).textContent=this.translateIfPossible(this.options.textContent))}focus(){this.isBuilt()&&mP(ty,this).focus()}activate(){mP(ty,this).click()}}function ZOe(t,e){Tee(t,e),e.add(t)}function O0(t,e,r){Tee(t,e),e.set(t,r)}function Tee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Nt(t,e){return t.get(ip(t,e))}function hl(t,e,r){return t.set(ip(t,e),r),r}function ip(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const kY="multipleSelect.itemBox";var Sl=new WeakMap,ti=new WeakMap,pP=new WeakMap,Cc=new WeakMap,Xh=new WeakMap,Qh=new WeakMap,ry=new WeakSet;class H1 extends Ml{static get DEFAULTS(){return Nl({className:"htUIMultipleSelect",value:[]})}constructor(e,r){super(e,oi(H1.DEFAULTS,r)),ZOe(this,ry),O0(this,Sl,[]),O0(this,ti,void 0),O0(this,pP,void 0),O0(this,Cc,void 0),O0(this,Xh,void 0),O0(this,Qh,void 0),hl(Cc,this,new If(this.hot,{placeholder:T4,className:"htUIMultipleSelectSearch"})),hl(Xh,this,new N1(this.hot,{textContent:x4,className:"htUISelectAll"})),hl(Qh,this,new N1(this.hot,{textContent:E4,className:"htUIClearAll"})),this.registerHooks()}getItemsBox(){return Nt(ti,this)}registerHooks(){Nt(Cc,this).addLocalHook("keydown",e=>ip(ry,this,eke).call(this,e)),Nt(Cc,this).addLocalHook("input",e=>ip(ry,this,JOe).call(this,e)),Nt(Xh,this).addLocalHook("click",e=>ip(ry,this,tke).call(this,e)),Nt(Qh,this).addLocalHook("click",e=>ip(ry,this,rke).call(this,e))}setItems(e){var r;hl(Sl,this,e),(r=Nt(ti,this))===null||r===void 0||r.loadData(Nt(Sl,this))}setLocale(e){hl(pP,this,e)}getLocale(){return Nt(pP,this)}getItems(){return[...Nt(Sl,this)]}getValue(){return ike(Nt(Sl,this))}getSearchInputElement(){return Nt(Cc,this)}getSelectAllElement(){return Nt(Xh,this)}getClearAllElement(){return Nt(Qh,this)}isSelectedAllValues(){return Nt(Sl,this).length===this.getValue().length}build(){super.build();const{rootDocument:e}=this.hot,r=e.createElement("div"),n=new Ml(this.hot,{className:"htUISelectionControls",children:[Nt(Xh,this),Nt(Qh,this)]});this._element.appendChild(Nt(Cc,this).element),this._element.appendChild(n.element),this._element.appendChild(r);const i=s=>{var a;if(!this._element)return;(a=Nt(ti,this))===null||a===void 0||a.destroy(),Ve(s,"htUIMultipleSelectHot"),hl(ti,this,new this.hot.constructor(s,{data:Nt(Sl,this),columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:(c,f,g,m,v,w)=>{c.title=w.instance.getDataAtRowProp(f,w.label.property)},afterListen:()=>{this.runLocalHooks("focus",this)},beforeOnCellMouseUp:()=>{Nt(ti,this).listen()},modifyColWidth:c=>{const f=Nt(ti,this).container.scrollWidth-Ni(e);return c!==void 0&&c<f?f:c},maxCols:1,autoWrapCol:!0,height:110,copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},themeName:this.hot.getCurrentThemeName(),layoutDirection:this.hot.isRtl()?"rtl":"ltr"})),Nt(ti,this).init();const u=Nt(ti,this).getShortcutManager().getContext("grid");u.removeShortcutsByKeys(["Tab"]),u.removeShortcutsByKeys(["Shift","Tab"]),u.addShortcut({keys:[["Escape"]],callback:c=>{this.runLocalHooks("keydown",c,this)},group:kY}),u.addShortcut({keys:[["Tab"],["Shift","Tab"]],callback:c=>{Nt(ti,this).deselectCell(),this.runLocalHooks("keydown",c,this),this.runLocalHooks("listTabKeydown",c,this)},group:kY})};i(r),this.hot._registerTimeout(()=>i(r),100)}focus(){this.isBuilt()&&Nt(ti,this).listen()}reset(){Nt(Cc,this).reset(),Nt(Xh,this).reset(),Nt(Qh,this).reset()}update(){this.isBuilt()&&(Nt(ti,this).loadData(nke(Nt(Sl,this),this.options.value)),super.update())}destroy(){var e;(e=Nt(ti,this))===null||e===void 0||e.destroy(),Nt(Cc,this).destroy(),Nt(Qh,this).destroy(),Nt(Xh,this).destroy(),hl(Cc,this,null),hl(Qh,this,null),hl(Xh,this,null),hl(ti,this,null),hl(Sl,this,null),super.destroy()}}function JOe(t){const e=t.target.value.toLocaleLowerCase(this.getLocale());let r;e===""?r=[...Nt(Sl,this)]:r=Nt(Sl,this).filter(n=>`${n.value}`.toLocaleLowerCase(this.getLocale()).indexOf(e)>=0),Nt(ti,this).loadData(r)}function eke(t){this.runLocalHooks("keydown",t,this),IF(sv,t.keyCode)("ARROW_DOWN")&&(t.preventDefault(),Qo(t),Nt(ti,this).listen(),Nt(ti,this).selectCell(0,0))}function tke(t){const e=[];t.preventDefault(),Nt(ti,this).getSourceData().forEach((r,n)=>{r.checked=!0,e.push(iL(r,n)[0])}),Nt(ti,this).setSourceDataAtCell(e)}function rke(t){const e=[];t.preventDefault(),Nt(ti,this).getSourceData().forEach((r,n)=>{r.checked=!1,e.push(iL(r,n)[0])}),Nt(ti,this).setSourceDataAtCell(e)}function nke(t,e){const r=FS(e);return t.map(n=>(n.checked=r(n.value),n))}function ike(t){const e=[];return t.forEach(r=>{r.checked&&e.push(r.value)}),e}function ske(t,e){ake(t,e),e.add(t)}function ake(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function oke(t,e,r){return(e=lke(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function lke(t){var e=uke(t,"string");return typeof e=="symbol"?e:e+""}function uke(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ux(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var ny=new WeakSet;class cke extends HS{constructor(e,r){super(e,{id:r.id,stateless:!1}),ske(this,ny),oke(this,"name",""),this.name=r.name,this.elements.push(new H1(this.hot)),this.registerHooks()}registerHooks(){this.getMultipleSelectElement().addLocalHook("keydown",e=>ux(ny,this,hke).call(this,e)).addLocalHook("listTabKeydown",e=>this.runLocalHooks("listTabKeydown",e)),this.hot.addHook("modifyFiltersMultiSelectValue",(e,r)=>ux(ny,this,fke).call(this,e,r))}getElements(){const e=this.getMultipleSelectElement();return[e.getSearchInputElement(),e.getSelectAllElement(),e.getClearAllElement(),this.getMultipleSelectElement()]}setState(e){if(this.reset(),e&&e.command.key===Sg){const r=this.getMultipleSelectElement();r.setItems(e.itemsSnapshot),r.setValue(e.args[0]),r.setLocale(e.locale)}}getState(){const e=this.getMultipleSelectElement(),r=e.getItems();return{command:{key:e.isSelectedAllValues()||!r.length?Ui:Sg},args:[e.getValue()],itemsSnapshot:r}}updateState(e){const r=(n,i,s,a,o)=>{const[u]=Ff(i,g=>g.name===Sg),c={},f=this.hot.getTranslatedPhrase(i_);if(u){const g=a(n,o),m=nr(g,_=>_.value),v=new Map(g.map(_=>[_.value,this.hot.getCellMeta(_.meta.visualRow,_.meta.visualCol)])),w=HN(m);s&&(u.args[0]=s);const y=[],b=bY(w,u.args[0],f,_=>{_.checked&&y.push(_.value),ux(ny,this,DY).call(this,_,v)}),x=e.editedConditionStack.column;c.locale=this.hot.getCellMeta(0,x).locale,c.args=[y],c.command=yg(Sg),c.itemsSnapshot=b}else c.args=[],c.command=yg(Ui);this.state.setValueAtIndex(n,c)};r(e.editedConditionStack.column,e.editedConditionStack.conditions,e.conditionArgsChange,e.filteredRowsFactory),e.dependentConditionStacks.length&&r(e.dependentConditionStacks[0].column,e.dependentConditionStacks[0].conditions,e.conditionArgsChange,e.filteredRowsFactory,e.editedConditionStack)}getMultipleSelectElement(){return this.elements.filter(e=>e instanceof H1)[0]}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,r,n,i,s,a)=>{Ve(r.parentNode,"htFiltersMenuValue");const o=this.hot.rootDocument.createElement("div");return Ve(o,"htFiltersMenuLabel"),o.textContent=a,r.appendChild(o),r.parentElement.hasAttribute("ghost-table")||he(this.elements,u=>r.appendChild(u.element)),r}}}reset(){const e=this.hot.getTranslatedPhrase(i_),r=this._getColumnVisibleValues(),n=r.map(u=>u.value),i=new Map(r.map(u=>[u.value,u.meta])),s=HN(n),a=bY(s,s,e,u=>{ux(ny,this,DY).call(this,u,i)});this.getMultipleSelectElement().setItems(a),super.reset(),this.getMultipleSelectElement().setValue(s);const o=this.hot.getPlugin("filters").getSelectedColumn();o!==null&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,o.visualIndex).locale)}_getColumnVisibleValues(){const e=this.hot.getPlugin("filters").getSelectedColumn();return e===null?[]:nr(this.hot.getDataAtCol(e.visualIndex),(r,n)=>({value:d3(r),meta:this.hot.getCellMeta(n,e.visualIndex)}))}}function hke(t){sv(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),Qo(t))}function DY(t,e){this.hot.hasHook("modifyFiltersMultiSelectValue")&&(t.visualValue=this.hot.runHooks("modifyFiltersMultiSelectValue",t.visualValue,e.get(t.value)))}function fke(t,e){switch(e.type){case"numeric":return gJ(t,e);default:return t}}var Mee;function dke(t,e){gke(t,e),e.add(t)}function gke(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function mke(t,e,r){return(e=pke(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function pke(t){var e=vke(t,"string");return typeof e=="symbol"?e:e+""}function vke(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function wke(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var PY=new WeakSet;class F1 extends HS{static get BUTTON_OK(){return"ok"}static get BUTTON_CANCEL(){return"cancel"}constructor(e,r){super(e,{id:r.id,stateless:!0}),dke(this,PY),mke(this,"name",""),this.name=r.name,this.elements.push(new If(this.hot,{type:"button",value:_4,className:"htUIButton htUIButtonOK",identifier:F1.BUTTON_OK})),this.elements.push(new If(this.hot,{type:"button",value:R4,className:"htUIButton htUIButtonCancel",identifier:F1.BUTTON_CANCEL})),this.registerHooks()}registerHooks(){he(this.elements,e=>{e.addLocalHook("click",(r,n)=>wke(PY,this,yke).call(this,r,n))})}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,r)=>(Ve(r.parentNode,"htFiltersMenuActionBar"),he(this.elements,n=>r.appendChild(n.element)),r)}}accept(){this.runLocalHooks("accept")}cancel(){this.runLocalHooks("cancel")}}Mee=F1;function yke(t,e){e.options.identifier===Mee.BUTTON_OK?this.accept():this.cancel()}function vP(t,e,r){return(e=Ske(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Ske(t){var e=bke(t,"string");return typeof e=="symbol"?e:e+""}function bke(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const IY="ConditionCollection.filteringStates";class v3{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;vP(this,"hot",void 0),vP(this,"isMapRegistrable",void 0),vP(this,"filteringStates",new JR),this.hot=e,this.isMapRegistrable=r,this.isMapRegistrable===!0?this.hot.columnIndexMapper.registerMap(IY,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}isEmpty(){return this.getFilteredColumns().length===0}isMatch(e,r){var n;const i=this.filteringStates.getValueAtIndex(r),s=(n=i?.conditions)!==null&&n!==void 0?n:[],a=i?.operation;return this.isMatchInConditions(s,e,a)}isMatchInConditions(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Pf;return e.length?dOe(n)(e,r):!0}addCondition(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Pf,i=arguments.length>3?arguments[3]:void 0;const s=this.hot.getCellMeta(0,e).locale,a=r.args.map(f=>typeof f=="string"?f.toLocaleLowerCase(s):f),o=r.name||r.command.key;this.runLocalHooks("beforeAdd",e);const u=this.getOperation(e);if(u){if(u!==n)throw Error(Dr`The column of index ${e} has been already applied with a \`${u}\`\x20
        filter operation. Use \`removeConditions\` to clear the current conditions and then add new ones.\x20
        Mind that you cannot mix different types of operations (for instance, if you use \`conjunction\`,\x20
        use it consequently for a particular column).`)}else if(gn(P1[n]))throw new Error(Dr`Unexpected operation named \`${n}\`. Possible ones are\x20
        \`disjunction\` and \`conjunction\`.`);const c=this.getConditions(e);c.length===0?this.filteringStates.setValueAtIndex(e,{operation:n,conditions:[{name:o,args:a,func:Wf(o,a)}]},i):c.push({name:o,args:a,func:Wf(o,a)}),this.runLocalHooks("afterAdd",e)}getConditions(e){var r,n;return(r=(n=this.filteringStates.getValueAtIndex(e))===null||n===void 0?void 0:n.conditions)!==null&&r!==void 0?r:[]}getOperation(e){var r;return(r=this.filteringStates.getValueAtIndex(e))===null||r===void 0?void 0:r.operation}getFilteredColumns(){return this.filteringStates.getEntries().map(e=>{let[r]=e;return r})}getColumnStackPosition(e){return this.getFilteredColumns().indexOf(e)}exportAllConditions(){return this.filteringStates.getEntries().reduce((e,r)=>{let[n,{operation:i,conditions:s}]=r;return e.push({column:n,operation:i,conditions:s.map(a=>{let{name:o,args:u}=a;return{name:o,args:[...u]}})}),e},[])}importAllConditions(e){this.clean(),e.forEach(r=>{r.conditions.forEach(n=>this.addCondition(r.column,n))})}removeConditions(e){this.runLocalHooks("beforeRemove",e),this.filteringStates.clearValue(e),this.runLocalHooks("afterRemove",e)}clean(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}hasConditions(e,r){const n=this.getConditions(e);return r?n.some(i=>i.name===r):n.length>0}destroy(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(IY),this.filteringStates=null,this.clearLocalHooks()}}Lr(v3,as);function NY(t,e,r){return(e=Cke(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Cke(t){var e=xke(t,"string");return typeof e=="symbol"?e:e+""}function xke(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Aee{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:()=>[];NY(this,"conditionCollection",void 0),NY(this,"columnDataFactory",void 0),this.conditionCollection=e,this.columnDataFactory=r}filter(){let e=[];return he(this.conditionCollection.getFilteredColumns(),(r,n)=>{let i=this.columnDataFactory(r);n&&(i=this._getIntersectData(i,e)),e=this.filterByColumn(r,i)}),e}filterByColumn(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const n=[];return he(r,i=>{i!==void 0&&this.conditionCollection.isMatch(i,e)&&n.push(i)}),n}_getIntersectData(e,r){const n=[];return he(r,i=>{const s=i.meta.visualRow;e[s]!==void 0&&(n[s]=e[s])}),n}}function Eke(t,e){_ke(t,e),e.add(t)}function _ke(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ud(t,e,r){return(e=Rke(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Rke(t){var e=Tke(t,"string");return typeof e=="symbol"?e:e+""}function Tke(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function wP(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var cx=new WeakSet;class Oee{constructor(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:()=>[];Eke(this,cx),Ud(this,"hot",void 0),Ud(this,"conditionCollection",void 0),Ud(this,"columnDataFactory",void 0),Ud(this,"changes",[]),Ud(this,"grouping",!1),Ud(this,"latestEditedColumnPosition",-1),Ud(this,"latestOrderStack",[]),this.hot=e,this.conditionCollection=r,this.columnDataFactory=n,this.conditionCollection.addLocalHook("beforeRemove",i=>wP(cx,this,Mke).call(this,i)),this.conditionCollection.addLocalHook("afterRemove",i=>this.updateStatesAtColumn(i)),this.conditionCollection.addLocalHook("afterAdd",i=>this.updateStatesAtColumn(i)),this.conditionCollection.addLocalHook("beforeClean",()=>wP(cx,this,Ake).call(this)),this.conditionCollection.addLocalHook("afterClean",()=>wP(cx,this,Oke).call(this))}groupChanges(){this.grouping=!0}flush(){this.grouping=!1,he(this.changes,e=>{this.updateStatesAtColumn(e)}),this.changes.length=0}updateStatesAtColumn(e,r){var n=this;if(this.grouping){this.changes.indexOf(e)===-1&&this.changes.push(e);return}const i=this.conditionCollection.exportAllConditions();let s=this.conditionCollection.getColumnStackPosition(e);s===-1&&(s=this.latestEditedColumnPosition);const a=i.slice(0,s),o=i.slice(s);o.length&&o[0].column===e&&o.shift();const u=NQ(function(f,g){let m=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];const v=new v3(n.hot,!1),w=[].concat(f,m);v.importAllConditions(w);const y=n.columnDataFactory(g);let b;v.isEmpty()?b=y:b=new Aee(v,_=>n.columnDataFactory(_)).filter(),b=nr(b,_=>_.meta.visualRow);const x=FS(b);return v.destroy(),Ff(y,_=>x(_.meta.visualRow))})(a),c=[].concat(this.conditionCollection.getConditions(e));this.runLocalHooks("update",{editedConditionStack:{column:e,conditions:c},dependentConditionStacks:o,filteredRowsFactory:u,conditionArgsChange:r})}destroy(){this.clearLocalHooks(),Wt(this,(e,r)=>{this[r]=null})}}function Mke(t){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(t)}function Ake(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}function Oke(){he(this.latestOrderStack,t=>{this.updateStatesAtColumn(t)})}Lr(Oee,as);function kke(t){return QJ({initialPage:0,size:()=>t.length,onItemSelect:(r,n)=>{const i=t[r];if(i instanceof H1)return n;if(i.element&&!Ig(i.element))return!1;i.focus()}})}const iy="filters";function Dke(t,e){let r=-1,n;const i=kke(e),s=g=>()=>{n.isOpened()&&n.getKeyboardShortcutsCtrl().listen(iy),i.setCurrentPage(e.indexOf(g))};e.forEach(g=>{g instanceof Ml&&(g.addLocalHook("click",s(g)),g.addLocalHook("focus",s(g)),g.addLocalHook("afterClose",s(g)))}),u(t);function a(g){const m=n.getKeyboardShortcutsCtrl(),v=g.getKeyboardShortcutsCtrl();i.clear(),v.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],forwardToContext:m.getContext(iy),callback:()=>{g.isSubMenu()&&g.close(),m.listen(iy)}}]),!g.isSubMenu()&&m.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:w=>{const y=n.getNavigator();y.getCurrentPage()>-1&&(r=y.getCurrentPage()),y.clear(),w.shiftKey?i.toPreviousItem():i.toNextItem()}},{keys:[["Escape"]],callback:()=>{n.close()}},{keys:[["Enter"],["Space"]],preventDefault:!1,callback:w=>{const y=e[i.getCurrentPage()];y instanceof I1&&(y.openOptions(),w.preventDefault()),y instanceof N1&&(y.activate(),w.preventDefault()),y instanceof Ml||w.preventDefault()}}],iy)}function o(){n.focus(),n.getKeyboardShortcutsCtrl().listen(iy)}function u(g){g.addLocalHook("afterSelectionChange",m=>{m.key.startsWith("filter_")||i.clear()}),g.addLocalHook("afterSubmenuOpen",a),g.addLocalHook("afterOpen",a),n=g}function c(){return n}function f(){return r}return{...i,listen:o,setMenu:u,getMenu:c,getLastMenuPage:f}}function Pke(t,e){kee(t,e),e.add(t)}function yP(t,e,r){kee(t,e),e.set(t,r)}function kee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function sy(t,e,r){return(e=Ike(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Ike(t){var e=Nke(t,"string");return typeof e=="symbol"?e:e+""}function Nke(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function OE(t,e,r){return t.set(la(t,e),r),r}function Oo(t,e){return t.get(la(t,e))}function la(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const LN="filters",Hke=250,HY=LN;var Mc=new WeakMap,BN=new WeakMap,dg=new WeakMap,Pa=new WeakSet;class Fke extends ur{static get PLUGIN_KEY(){return LN}static get PLUGIN_PRIORITY(){return Hke}static get PLUGIN_DEPS(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}constructor(e){var r;super(e),r=this,Pke(this,Pa),sy(this,"dropdownMenuPlugin",null),sy(this,"conditionCollection",null),sy(this,"conditionUpdateObserver",null),sy(this,"components",new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]])),sy(this,"filtersRowsMap",null),yP(this,Mc,void 0),yP(this,BN,new WeakSet),yP(this,dg,[]),this.hot.addHook("afterGetColHeader",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return la(Pa,r,jke).call(r,...i)})}isEnabled(){return!!this.hot.getSettings()[LN]}enablePlugin(){var e=this;if(this.enabled)return;this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new TS),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");const r=this.hot.getSettings().dropdownMenu,n=r&&r.uiContainer||this.hot.rootPortalElement,i=o=>(o.addLocalHook("accept",()=>la(Pa,this,FY).call(this,"accept")),o.addLocalHook("cancel",()=>la(Pa,this,FY).call(this,"cancel")),o.addLocalHook("change",u=>la(Pa,this,Uke).call(this,o,u)),o),s=()=>`${this.hot.getTranslatedPhrase(S4)}:`,a=()=>`${this.hot.getTranslatedPhrase(b4)}:`;if(!this.components.get("filter_by_condition")){const o=new FN(this.hot,{id:"filter_by_condition",name:s,addSeparator:!1,menuContainer:n});o.addLocalHook("afterClose",()=>la(Pa,this,LY).call(this)),this.components.set("filter_by_condition",i(o))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new GOe(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){const o=new FN(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:n});o.addLocalHook("afterClose",()=>la(Pa,this,LY).call(this)),this.components.set("filter_by_condition2",i(o))}if(this.components.get("filter_by_value")||this.components.set("filter_by_value",i(new cke(this.hot,{id:"filter_by_value",name:a}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",i(new F1(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new v3(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new Oee(this.hot,this.conditionCollection,o=>this.getDataMapAtColumn(o)),this.conditionUpdateObserver.addLocalHook("update",o=>la(Pa,this,Yke).call(this,o))),this.components.forEach(o=>o.show()),this.addHook("afterDropdownMenuDefaultOptions",function(){for(var o=arguments.length,u=new Array(o),c=0;c<o;c++)u[c]=arguments[c];return la(Pa,e,$ke).call(e,...u)}),this.addHook("beforeDropdownMenuShow",()=>la(Pa,this,Wke).call(this)),this.addHook("afterDropdownMenuShow",()=>la(Pa,this,Bke).call(this)),this.addHook("afterDropdownMenuHide",()=>la(Pa,this,Vke).call(this)),this.addHook("afterChange",o=>la(Pa,this,Lke).call(this,o)),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),!Oo(Mc,this)&&this.dropdownMenuPlugin.enabled){const o=[{focus:()=>{const c=Oo(Mc,this).getMenu(),f=c.getNavigator(),g=Oo(Mc,this).getLastMenuPage();c.focus(),g>0?f.setCurrentPage(g):f.toFirstItem()}},...Array.from(this.components).map(c=>{let[,f]=c;return f.getElements()}).flat()];OE(Mc,this,Dke(this.dropdownMenuPlugin.menu,o));const u=c=>{Oo(Mc,this).listen(),c.preventDefault(),sv(c.keyCode,"TAB")&&(c.shiftKey?Oo(Mc,this).toPreviousItem():Oo(Mc,this).toNextItem())};this.components.get("filter_by_value").addLocalHook("listTabKeydown",u),this.components.get("filter_by_condition").addLocalHook("selectTabKeydown",u)}this.registerShortcuts(),super.enablePlugin()}disablePlugin(){if(this.enabled){var e;(e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach((r,n)=>{r.destroy(),this.components.set(n,null)}),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName)}this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Alt","A"]],stopPropagation:!0,callback:()=>{const e=this.hot.getSelected();this.clearConditions(),this.filter(),e&&this.hot.selectCells(e)},group:HY})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(HY)}addCondition(e,r,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:Pf;const s=this.hot.toPhysicalColumn(e);this.conditionCollection.addCondition(s,{command:{key:r},args:n},i)}removeConditions(e){const r=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(r)}clearConditions(e){if(e===void 0)this.conditionCollection.clean();else{const r=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(r)}}importConditions(e){this.conditionCollection.importAllConditions(e)}exportConditions(){return this.conditionCollection.exportAllConditions()}filter(){const{navigableHeaders:e}=this.hot.getSettings(),r=this._createDataFilter(),n=!this.conditionCollection.isEmpty();let i=[];const s=this.exportConditions(),a=this.hot.runHooks("beforeFilter",s,Oo(dg,this));if(a!==!1&&n){const o=[];this.hot.batchExecution(()=>{this.filtersRowsMap.clear(),i=nr(r.filter(),c=>c.meta.visualRow);const u=FS(i);ct(this.hot.countSourceRows()-1,c=>{u(c)||o.push(c)}),he(o,c=>{this.filtersRowsMap.setValueAtIndex(c,!0)})},!0),!e&&!i.length&&this.hot.deselectCell(),OE(dg,this,this.exportConditions())}else a!==!1&&!n?(OE(dg,this,this.exportConditions()),this.filtersRowsMap.clear()):this.importConditions(Oo(dg,this));this.hot.selection.isSelected()&&this.hot.selectCell(e?-1:0,this.hot.getSelectedRangeLast().highlight.col),a!==!1&&(this.hot.runHooks("afterFilter",s),this.hot.view.adjustElementsSize(),this.hot.render())}getSelectedColumn(){var e;const r=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return r?{visualIndex:r.col,physicalIndex:this.hot.toPhysicalColumn(r.col)}:null}getDataMapAtColumn(e){const r=this.hot.toVisualColumn(e),n=[];return he(this.hot.getSourceDataAtCol(r),(i,s)=>{var a;const{row:o,col:u,visualCol:c,visualRow:f,type:g,instance:m,dateFormat:v,locale:w}=this.hot.getCellMeta(s,r),y=(a=this.hot.getDataAtCell(this.hot.toVisualRow(s),r))!==null&&a!==void 0?a:i;n.push({meta:{row:o,col:u,visualCol:c,visualRow:f,type:g,instance:m,dateFormat:v,locale:w},value:d3(y)})}),n}updateValueComponentCondition(e){const r=this.hot.getDataAtCol(e),n=HN(r);this.conditionUpdateObserver.updateStatesAtColumn(e,n)}restoreComponents(e){var r;const n=(r=this.getSelectedColumn())===null||r===void 0?void 0:r.physicalIndex;e.forEach(i=>{i.isHidden()||i.restoreState(n)}),this.updateDependentComponentsVisibility()}getOperationBasedOnArguments(e,r,n,i){let s=e;return s===S_&&r.command.key!==Ui&&n.command.key!==Ui&&i.command.key!==Ui?s=m3:i.command.key!==Ui&&(r.command.key===Ui||n.command.key===Ui)&&(s=Pf),s}setListeningDropdownMenu(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}updateDependentComponentsVisibility(){const e=this.components.get("filter_by_condition"),{command:r}=e.getState(),n=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];r.showOperators?this.showComponents(...n):this.hideComponents(...n)}_createDataFilter(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.conditionCollection;return new Aee(e,r=>this.getDataMapAtColumn(r))}getIndexesOfComponents(){const e=[];if(!this.dropdownMenuPlugin)return e;const r=this.dropdownMenuPlugin.menu;for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return he(i,a=>{he(r.menuItems,(o,u)=>{o.key===a.getMenuItemDescriptor().key&&e.push(u)})}),e}changeComponentsVisibility(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.dropdownMenuPlugin)return;const n=this.dropdownMenuPlugin.menu.hotMenu,i=n.getPlugin("hiddenRows");for(var s=arguments.length,a=new Array(s>1?s-1:0),o=1;o<s;o++)a[o-1]=arguments[o];const u=this.getIndexesOfComponents(...a);e?i.showRows(u):i.hideRows(u),n.render()}hideComponents(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];this.changeComponentsVisibility(!1,...r)}showComponents(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];this.changeComponentsVisibility(!0,...r)}destroy(){this.enabled&&(this.components.forEach((e,r)=>{e!==null&&(e.destroy(),this.components.set(r,null))}),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),super.destroy()}}function Lke(t){t&&he(t,e=>{const[,r]=e,n=this.hot.propToCol(r);this.conditionCollection.hasConditions(n)&&this.updateValueComponentCondition(n)})}function Bke(){const t=this.dropdownMenuPlugin.menu;this.restoreComponents(Array.from(this.components.values())),t.updateMenuDimensions()}function Vke(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}function Wke(){const t=this.dropdownMenuPlugin.menu;Oo(BN,this).has(t)||Oo(Mc,this).setMenu(t),Oo(BN,this).add(t)}function $ke(t){t.items.push({name:Yt}),this.components.forEach(e=>{t.items.push(e.getMenuItemDescriptor())})}function FY(t){var e;if(t==="accept"){const n=this.getSelectedColumn();if(n===null){var r;(r=this.dropdownMenuPlugin)===null||r===void 0||r.close();return}const{physicalIndex:i}=n,s=this.components.get("filter_by_condition").getState(),a=this.components.get("filter_by_condition2").getState(),o=this.components.get("filter_by_value").getState(),u=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),s,a,o);this.conditionUpdateObserver.groupChanges();let c=this.conditionCollection.getColumnStackPosition(i);c===-1&&(c=void 0),this.conditionCollection.removeConditions(i),s.command.key!==Ui&&(this.conditionCollection.addCondition(i,s,u,c),a.command.key!==Ui&&this.conditionCollection.addCondition(i,a,u,c)),o.command.key!==Ui&&this.conditionCollection.addCondition(i,o,u,c),this.conditionUpdateObserver.flush(),this.components.forEach(f=>f.saveState(i)),this.filter()}(e=this.dropdownMenuPlugin)===null||e===void 0||e.close()}function Uke(t,e){const r=this.dropdownMenuPlugin.menu;this.updateDependentComponentsVisibility(),t.constructor===FN&&!e.inputsCount&&this.setListeningDropdownMenu(),r.updateMenuDimensions()}function LY(){this.setListeningDropdownMenu()}function jke(t,e,r){const n=this.hot.toPhysicalColumn(t);this.enabled&&this.conditionCollection.hasConditions(n)&&r===this.hot.view.getColumnHeadersCount()-1?Ve(e,"htFiltersActive"):wt(e,"htFiltersActive")}function Yke(t){var e;if(!((e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled))return;const{editedConditionStack:{conditions:r,column:n},conditionArgsChange:i}=t;Array.isArray(i)&&OE(dg,this,Oo(dg,this).map(o=>(o.column===n&&r.length>0&&o.conditions.forEach(u=>{u.name==="by_value"&&(u.args=[[...i]])}),o)));const s=r.filter(o=>o.name===Sg),a=r.filter(o=>o.name!==Sg);if(s.length>=2||a.length>=3)br(Dr`The filter conditions have been applied properly, but couldn’t be displayed visually.\x20
        The overall amount of conditions exceed the capability of the dropdown menu.\x20
        For more details see the documentation.`);else{const o=this.conditionCollection.getOperation(n);this.components.get("filter_by_condition").updateState(a[0],n),this.components.get("filter_by_condition2").updateState(a[1],n),this.components.get("filter_operators").updateState(o,n),this.components.get("filter_by_value").updateState(t)}}const Dee="internal-use-in-handsontable",VN={licenseKey:Dee,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!1,nullDate:{year:1899,month:12,day:30},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function Pee(t){var e;return{maxColumns:t.maxColumns,maxRows:t.maxRows,language:(e=t[bs])===null||e===void 0||(e=e.language)===null||e===void 0?void 0:e.langCode}}function Iee(t){return Object.keys(t).reduce((e,r)=>(r!=="hyperformula"&&(e[r]=t[r]),e),{})}function zke(t){var e;const r=t[bs],n=Iee(r!=null&&(e=r.engine)!==null&&e!==void 0&&e.hyperformula?r.engine:{}),i=Pee(t);return{...VN,...n,...i}}function Gke(t){var e;const r=t[bs],n=Iee(r!=null&&(e=r.engine)!==null&&e!==void 0&&e.hyperformula?r.engine:{}),i=Pee(t);return{...n,...i}}function qke(t,e){return Object.keys(e).some(r=>e[r]!==void 0&&e[r]!==t[r])}function bT(){const t="engine_relationship",e=Zo(bs);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function w3(){const t="shared_engine_usage",e=Zo(bs);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function Kke(t){const e=t.getSettings(),r=e[bs],n=r?.engine;if(r===!0||gn(n))return null;if(typeof n.hyperformula=="function"||typeof n=="function"){var i;return Xke((i=n.hyperformula)!==null&&i!==void 0?i:n,e,t)}else if(typeof n=="object"&&gn(n.hyperformula)){const s=bT(),a=w3().get(n);return s.has(n)||s.set(n,[]),s.get(n).push(t),a&&a.push(t.guid),n.getConfig().licenseKey||n.updateConfig({licenseKey:Dee}),(n.getConfig().leapYear1900!==VN.leapYear1900||VR(n.getConfig().nullDate,VN.nullDate)===!1)&&br(Dr`If you use HyperFormula with Handsontable, keep the default \`leapYear1900\` and \`nullDate\` 
      settings. Otherwise, HyperFormula's dates may not sync correctly with Handsontable's dates.`),n}return null}function Xke(t,e,r){const n=e[bs],i=zke(e),s=bT(),a=w3();Qke(t,n.functions),Zke(t,n.language);const o=t.buildEmpty(i);return s.set(o,[r]),a.set(o,[r.guid]),Jke(o,n.namedExpressions),o.on("sheetAdded",()=>{o.rebuildAndRecalculate()}),o.on("sheetRemoved",()=>{o.rebuildAndRecalculate()}),o}function BY(t){var e;const r=bT(),n=r.size===0?[]:Array.from((e=r.get(t))!==null&&e!==void 0?e:[]);return new Map(n.map(i=>[i.getPlugin("formulas").sheetId,i]))}function VY(t,e){if(t){const r=bT(),n=r.get(t),i=w3(),s=i.get(t);n&&n.includes(e)&&(n.splice(n.indexOf(e),1),n.length===0&&r.delete(t)),s&&s.includes(e.guid)&&(s.splice(s.indexOf(e.guid),1),s.length===0&&(i.delete(t),t.destroy()))}}function Qke(t,e){e&&e.forEach(r=>{const{name:n,plugin:i,translations:s}=r;try{t.registerFunction(n,i,s)}catch(a){br(a.message)}})}function Zke(t,e){if(e){const{langCode:r}=e;try{t.registerLanguage(r,e)}catch(n){br(n.message)}}}function Jke(t,e){e&&(t.suspendEvaluation(),e.forEach(r=>{const{name:n,expression:i,scope:s,options:a}=r;try{t.addNamedExpression(n,i,s,a)}catch(o){br(o.message)}}),t.resumeEvaluation())}function eDe(t,e){return(gn(e)||!t.doesSheetExist(e))&&(e=t.addSheet(e)),e}const Nee="DD/MM/YYYY";function tDe(t){return typeof t=="string"&&t.charAt(0)==="'"&&t.charAt(1)==="="}function rDe(t){return tDe(t)?t.substr(1):t}function nDe(t){return typeof t=="string"&&t.startsWith("=")}function y3(t,e){return typeof t=="string"&&e==="date"}function Hee(t,e){return je(t,e,!0).isValid()}function Fee(t,e){return je(t,e,!0).format(Nee)}function iDe(t,e){return je(t,Nee,!0).format(e)}function Lee(t,e){const n=new Date(Date.UTC(0,0,t+-1));return je(n).format(e)}function sDe(t,e,r){const n=Array.from(Array(r).keys()).filter(s=>t.includes(s)===!1);if(e===0){var i;return(i=n[e])!==null&&i!==void 0?i:0}return n[e-1]+1}function aDe(t,e){const r=[];return t.forEach(n=>{const i={from:n,to:e};r.forEach(s=>{const a=s.from>s.to,o=s.to<=i.from;s.from>i.from&&o&&a&&(i.from+=1)}),i.from>=e&&(e+=1),r.push(i)}),r}function oDe(t){return t.forEach((e,r)=>{t.slice(r+1).forEach(i=>{const s=i.from<i.to;i.from>e.from&&s&&(i.from-=1)})}),t}function S3(t,e,r){const n=aDe(t,sDe(t,e,r));return oDe(n)}function jd(t,e,r){lDe(t,e),e.set(t,r)}function lDe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function fn(t,e){return t.get(Bee(t,e))}function Zh(t,e,r){return t.set(Bee(t,e),r),r}function Bee(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var ay=new WeakMap,Jh=new WeakMap,Ia=new WeakMap,hx=new WeakMap,SP=new WeakMap,bP=new WeakMap,fx=new WeakMap;class WY{constructor(e,r,n){jd(this,ay,void 0),jd(this,Jh,void 0),jd(this,Ia,void 0),jd(this,hx,[]),jd(this,SP,[]),jd(this,bP,void 0),jd(this,fx,[]),Zh(ay,this,e),Zh(Jh,this,r),Zh(Ia,this,n)}setRemovedHfIndexes(e){return Zh(fx,this,e.map(r=>{const n=fn(Jh,this).getVisualFromPhysicalIndex(r);return this.getHfIndexFromVisualIndex(n)})),fn(fx,this)}getRemovedHfIndexes(){return fn(fx,this)}getHfIndexFromVisualIndex(e){const r=fn(Jh,this).getIndexesSequence(),n=fn(Jh,this).getNotTrimmedIndexes();return r.indexOf(n[e],e)}syncMoves(e){const n=`move${Ms(fn(ay,this))}s`;fn(Ia,this).getEngine().batch(()=>{e.forEach(i=>{const s=i.from!==i.to,a=i.from+1!==i.to;s&&a&&fn(Ia,this).getEngine()[n](fn(Ia,this).getSheetId(),i.from,1,i.to)})})}storeMovesInformation(e,r,n){n!==!1&&(Zh(SP,this,e.map(i=>this.getHfIndexFromVisualIndex(i))),Zh(bP,this,this.getHfIndexFromVisualIndex(r)))}calculateAndSyncMoves(e,r){if(fn(Ia,this).isPerformingUndoRedo()||e===!1||r===!1)return;const n=S3(fn(SP,this),fn(bP,this),fn(Jh,this).getNumberOfIndexes());fn(Ia,this).getSheetId()===null?fn(Ia,this).getPostponeAction(()=>this.syncMoves(n)):this.syncMoves(n)}getIndexesChangeSyncMethod(){const e=`set${Ms(fn(ay,this))}Order`;return r=>{if(fn(Ia,this).isPerformingUndoRedo())return;const n=fn(Jh,this).getIndexesSequence();if(r==="update"&&n.length>0){const i=fn(hx,this).map(u=>n.indexOf(u)),s=fn(Ia,this).getEngine().getSheetDimensions(fn(Ia,this).getSheetId());let a;fn(ay,this)==="row"?a=s.height:a=s.width;const o=i.length;for(let u=o;u<a;u+=1)i.push(u);fn(Ia,this).getEngine()[e](fn(Ia,this).getSheetId(),i)}Zh(hx,this,n)}}init(){Zh(hx,this,fn(Jh,this).getIndexesSequence())}}function Yd(t,e,r){uDe(t,e),e.set(t,r)}function uDe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xc(t,e){return t.get(Vee(t,e))}function zd(t,e,r){return t.set(Vee(t,e),r),r}function Vee(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var dx=new WeakMap,gx=new WeakMap,CP=new WeakMap,xP=new WeakMap,EP=new WeakMap,_P=new WeakMap,RP=new WeakMap;class cDe{constructor(e,r,n){Yd(this,dx,void 0),Yd(this,gx,void 0),Yd(this,CP,void 0),Yd(this,xP,!1),Yd(this,EP,!1),Yd(this,_P,null),Yd(this,RP,null),zd(dx,this,new WY("row",e,this)),zd(gx,this,new WY("column",r,this)),zd(CP,this,n)}getForAxis(e){return e==="row"?xc(dx,this):xc(gx,this)}setPerformUndo(e){zd(xP,this,e)}setPerformRedo(e){zd(EP,this,e)}isPerformingUndoRedo(){return xc(xP,this)||xc(EP,this)}getSheetId(){return xc(RP,this)}getEngine(){return xc(_P,this)}getPostponeAction(){return xc(CP,this)}setupSyncEndpoint(e,r){zd(_P,this,e),zd(RP,this,r),xc(dx,this).init(),xc(gx,this).init()}}function hDe(t,e){Wee(t,e),e.add(t)}function Gd(t,e,r){return(e=fDe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function fDe(t){var e=dDe(t,"string");return typeof e=="symbol"?e:e+""}function dDe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function TP(t,e,r){Wee(t,e),e.set(t,r)}function Wee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function $f(t,e,r){return t.set(fr(t,e),r),r}function _g(t,e){return t.get(fr(t,e))}function fr(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const bs="formulas",gDe=["maxRows","maxColumns","language"],mDe=260;Je.getSingleton().register("afterNamedExpressionAdded");Je.getSingleton().register("afterNamedExpressionRemoved");Je.getSingleton().register("afterSheetAdded");Je.getSingleton().register("afterSheetRemoved");Je.getSingleton().register("afterSheetRenamed");Je.getSingleton().register("afterFormulasValuesUpdate");const hv=t=>t==="UndoRedo.undo"||t==="UndoRedo.redo"||t==="auto";var ih=new WeakMap,CT=new WeakMap,oy=new WeakMap,wr=new WeakSet;class pDe extends ur{constructor(){var e;super(...arguments),e=this,hDe(this,wr),TP(this,ih,!1),TP(this,CT,!1),TP(this,oy,[["valuesUpdated",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return fr(wr,e,DDe).call(e,...n)}],["namedExpressionAdded",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return fr(wr,e,PDe).call(e,...n)}],["namedExpressionRemoved",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return fr(wr,e,IDe).call(e,...n)}],["sheetAdded",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return fr(wr,e,NDe).call(e,...n)}],["sheetRenamed",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return fr(wr,e,HDe).call(e,...n)}],["sheetRemoved",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return fr(wr,e,FDe).call(e,...n)}]]),Gd(this,"staticRegister",Zo("formulas")),Gd(this,"engine",null),Gd(this,"sheetId",null),Gd(this,"sheetName",null),Gd(this,"indexSyncer",null),Gd(this,"rowAxisSyncer",null),Gd(this,"columnAxisSyncer",null)}static get PLUGIN_KEY(){return bs}static get PLUGIN_PRIORITY(){return mDe}static get SETTING_KEYS(){return[bs,...gDe]}isEnabled(){return!!this.hot.getSettings()[bs]}enablePlugin(){var e,r=this;if(!this.enabled){if(this.engine=(e=Kke(this.hot))!==null&&e!==void 0?e:this.engine,!this.engine){br("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.");return}if(this.sheetName!==null&&!this.engine.doesSheetExist(this.sheetName)){const n=this.addSheet(this.sheetName,this.hot.getSourceDataArray());n!==!1&&fr(wr,this,zy).call(this,n)}this.addHook("beforeLoadData",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return fr(wr,r,$Y).call(r,...i)}),this.addHook("afterLoadData",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return fr(wr,r,UY).call(r,...i)}),this.addHook("beforeUpdateData",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return fr(wr,r,$Y).call(r,...i)}),this.addHook("afterUpdateData",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return fr(wr,r,UY).call(r,...i)}),this.addHook("modifyData",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return fr(wr,r,SDe).call(r,...i)}),this.addHook("modifySourceData",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return fr(wr,r,bDe).call(r,...i)}),this.addHook("beforeValidate",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return fr(wr,r,vDe).call(r,...i)}),this.addHook("afterSetSourceDataAtCell",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return fr(wr,r,CDe).call(r,...i)}),this.addHook("afterSetDataAtCell",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return fr(wr,r,jY).call(r,...i)}),this.addHook("afterSetDataAtRowProp",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return fr(wr,r,jY).call(r,...i)}),this.addHook("beforeCreateRow",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return fr(wr,r,xDe).call(r,...i)}),this.addHook("beforeCreateCol",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return fr(wr,r,EDe).call(r,...i)}),this.addHook("afterCreateRow",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return fr(wr,r,TDe).call(r,...i)}),this.addHook("afterCreateCol",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return fr(wr,r,MDe).call(r,...i)}),this.addHook("beforeRemoveRow",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return fr(wr,r,_De).call(r,...i)}),this.addHook("beforeRemoveCol",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return fr(wr,r,RDe).call(r,...i)}),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return fr(wr,r,ADe).call(r,...i)}),this.addHook("afterRemoveCol",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return fr(wr,r,ODe).call(r,...i)}),this.indexSyncer=new cDe(this.hot.rowIndexMapper,this.hot.columnIndexMapper,n=>{this.hot.addHookOnce("init",()=>{n()})}),this.rowAxisSyncer=this.indexSyncer.getForAxis("row"),this.columnAxisSyncer=this.indexSyncer.getForAxis("column"),this.hot.addHook("afterRowSequenceChange",this.rowAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("afterColumnSequenceChange",this.columnAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("beforeRowMove",(n,i,s,a)=>{this.rowAxisSyncer.storeMovesInformation(n,i,a)}),this.hot.addHook("beforeColumnMove",(n,i,s,a)=>{this.columnAxisSyncer.storeMovesInformation(n,i,a)}),this.hot.addHook("afterRowMove",(n,i,s,a,o)=>{this.rowAxisSyncer.calculateAndSyncMoves(a,o)}),this.hot.addHook("afterColumnMove",(n,i,s,a,o)=>{this.columnAxisSyncer.calculateAndSyncMoves(a,o)}),this.hot.addHook("beforeColumnFreeze",(n,i)=>{this.columnAxisSyncer.storeMovesInformation([n],this.hot.getSettings().fixedColumnsStart,i)}),this.hot.addHook("afterColumnFreeze",(n,i)=>{this.columnAxisSyncer.calculateAndSyncMoves(i,i)}),this.hot.addHook("beforeColumnUnfreeze",(n,i)=>{this.columnAxisSyncer.storeMovesInformation([n],this.hot.getSettings().fixedColumnsStart-1,i)}),this.hot.addHook("afterColumnUnfreeze",(n,i)=>{this.columnAxisSyncer.calculateAndSyncMoves(i,i)}),this.addHook("afterCellMetaReset",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return fr(wr,r,yDe).call(r,...i)}),this.addHook("beforeUndo",()=>{this.indexSyncer.setPerformUndo(!0),this.engine.undo()}),this.addHook("beforeRedo",()=>{this.indexSyncer.setPerformRedo(!0),this.engine.redo()}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformUndo(!1)}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformRedo(!1)}),this.addHook("afterDetachChild",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return fr(wr,r,kDe).call(r,...i)}),this.addHook("beforeAutofill",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return fr(wr,r,wDe).call(r,...i)}),_g(oy,this).forEach(n=>{let[i,s]=n;return this.engine.on(i,s)}),super.enablePlugin()}}disablePlugin(){_g(oy,this).forEach(e=>{let[r,n]=e;return this.engine.off(r,n)}),VY(this.engine,this.hot),this.engine=null,super.disablePlugin()}updatePlugin(e){const r=Gke(this.hot.getSettings());qke(this.engine.getConfig(),r)&&this.engine.updateConfig(r);const n=this.hot.getSettings()[bs];if(it(n)&&it(n.sheetName)&&n.sheetName!==this.sheetName&&this.switchSheet(n.sheetName),!e.data&&this.sheetName===null){const i=this.hot.getSettings()[bs].sheetName;if(i&&this.engine.doesSheetExist(i))this.switchSheet(this.sheetName);else{const s=this.addSheet(i??void 0,this.hot.getSourceDataArray());fr(wr,this,zy).call(this,s)}}super.updatePlugin(e)}destroy(){_g(oy,this).forEach(e=>{var r;let[n,i]=e;return(r=this.engine)===null||r===void 0?void 0:r.off(n,i)}),$f(oy,this,null),VY(this.engine,this.hot),this.engine=null,super.destroy()}addSheet(e,r){if(it(r)&&!vZ(r))return br("The provided data should be an array of arrays."),!1;if(e!=null&&this.engine.doesSheetExist(e))return br("Sheet with the provided name already exists."),!1;try{const n=this.engine.addSheet(e??void 0);return r&&this.engine.setSheetContent(this.engine.getSheetId(n),r),n}catch(n){return br(n.message),!1}}switchSheet(e){if(!this.engine.doesSheetExist(e)){HF(`The sheet named \`${e}\` does not exist, switch aborted.`);return}fr(wr,this,zy).call(this,e);const r=this.engine.getSheetSerialized(this.sheetId);r.length>0&&this.hot.loadData(r,`${Ms(bs)}.switchSheet`)}getCellType(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;const i=this.hot.toPhysicalRow(e),s=this.hot.toPhysicalColumn(r);return i!==null&&s!==null?this.engine.getCellType({sheet:n,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(r)}):"EMPTY"}isFormulaCellType(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;return this.engine.doesCellHaveFormula({sheet:n,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(r)})}renderDependentSheets(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const n=new Set;e.forEach(i=>{var s;const a=i==null||(s=i.address)===null||s===void 0?void 0:s.sheet;a!==void 0&&(n.has(a)||n.add(a))}),BY(this.engine).forEach((i,s)=>{if((r||s!==this.sheetId)&&n.has(s)){var a;i.render(),(a=i.view)===null||a===void 0||a.adjustElementsSize()}})}validateDependentCells(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const n=s=>{var a;const{row:o,col:u,sheet:c}=(a=s?.address)!==null&&a!==void 0?a:{};return it(c)?`${c}:${o}x${u}`:""},i=new Set(r.map(s=>n(s)));e.forEach(s=>{var a,o;const{row:u,col:c}=(a=s.address)!==null&&a!==void 0?a:{};if(it(u)===!1||it(c)===!1||u>=this.hot.countRows()||c>=this.hot.countCols())return;const f=s==null||(o=s.address)===null||o===void 0?void 0:o.sheet,g=n(s);if(f!==void 0&&!i.has(g)){const m=BY(this.engine).get(f);if(!m)return;m.validateCell(m.getDataAtCell(u,c),m.getCellMeta(u,c),()=>{})}})}syncChangeWithEngine(e,r,n){const i={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(r),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(i)){br(`Not possible to set cell data at ${JSON.stringify(i)}`);return}const s=this.hot.getCellMeta(e,r);return y3(n,s.type)&&(Hee(n,s.dateFormat)?n=Fee(n,s.dateFormat):nDe(n)===!1&&(n=`'${n}`)),this.engine.setCellContents(i,n)}}function zy(t){this.sheetName=t,this.sheetId=this.engine.getSheetId(this.sheetName)}function vDe(t,e,r){const n=this.hot.propToCol(r);if(this.isFormulaCellType(e,n)){const i={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n),sheet:this.sheetId},s=this.hot.getCellMeta(e,n);let a=this.engine.getCellValue(i);return s.type==="date"&&Ss(a)&&(a=Lee(a,s.dateFormat)),typeof a=="object"&&a!==null?a.value:a}return t}function wDe(t,e,r){const{row:n,col:i}=e.getTopStartCorner(),{row:s,col:a}=e.getBottomEndCorner(),{row:o,col:u}=r.getTopStartCorner(),{row:c,col:f}=r.getBottomEndCorner(),g={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(n),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(a),sheet:this.sheetId}},m={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(u),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(c),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(f),sheet:this.sheetId}};if(this.engine.isItPossibleToSetCellContents(m)===!1)return!1;const v=this.engine.getFillRangeData(g,m),{row:w,col:y}=g.start,{row:b,col:x}=g.end,_=b-w+1,T=x-y+1;for(let D=0;D<v.length;D+=1)for(let P=0;P<v[D].length;P+=1){const O=v[D][P],A=w+D%_,W=y+P%T,L=this.hot.getCellMeta(A,W);y3(O,L.type)&&(O.startsWith("'")?v[D][P]=O.slice(1):this.isFormulaCellType(A,W,this.sheetId)===!1&&(v[D][P]=iDe(O,L.dateFormat)))}return v}function $Y(t,e){(arguments.length>2&&arguments[2]!==void 0?arguments[2]:"").includes(Ms(bs))||$f(CT,this,gn(this.hot.getSettings().data))}function yDe(){if(_g(CT,this)){this.switchSheet(this.sheetName);return}const t=this.hot.getSourceDataArray();t.forEach((r,n)=>{r.forEach((i,s)=>{const a=this.hot.getCellMeta(n,s,{skipMetaExtension:!0}),o=a.dateFormat;y3(i,a.type)&&(Hee(i,o)?t[n][s]=Fee(i,o):i.startsWith("=")||(t[n][s]=`'${i}`))})}),$f(ih,this,!0);const e=this.engine.setSheetContent(this.sheetId,t);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(e),$f(ih,this,!1)}function UY(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";if(r.includes(Ms(bs)))return;const n=eDe(this.engine,this.hot.getSettings()[bs].sheetName);if(fr(wr,this,zy).call(this,n),r!=="updateSettings")if(_g(CT,this))this.switchSheet(this.sheetName);else{const i=this.hot.getSourceDataArray();if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,i)){$f(ih,this,!0);const s=this.engine.setSheetContent(this.sheetId,i);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(s),$f(ih,this,!1)}}}function SDe(t,e,r,n){if(n!=="get"||_g(ih,this)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName)||t===null||e===null)return;const i=this.getCellType(t,e);if(i==="VALUE"||i==="EMPTY"){r.value=rDe(r.value);return}const s={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(t),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(e),sheet:this.sheetId};let a=this.engine.getCellValue(s);const o=this.hot.getCellMeta(t,e,{skipMetaExtension:!0});o.type==="date"&&Ss(a)&&(a=Lee(a,o.dateFormat)),r.value=typeof a=="object"&&a!==null?a.value:a}function bDe(t,e,r,n){if(n!=="get"||_g(ih,this)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const i=this.hot.toVisualRow(t),s=this.hot.propToCol(e);if(i===null||s===null)return;const a=this.getCellType(i,s);if(a==="VALUE"||a==="EMPTY")return;const o=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(o.width===0&&o.height===0)return;const u={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(s),sheet:this.sheetId};r.value=this.engine.getCellSerialized(u)}function jY(t,e){if(hv(e))return;const r=[],n=[],i=this.engine.batch(()=>{t.forEach(s=>{let[a,o,,u]=s;const c=this.hot.propToCol(o),f=this.hot.toPhysicalRow(a),g=this.hot.toPhysicalColumn(c),m={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(a),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(c),sheet:this.sheetId};f!==null&&g!==null?this.syncChangeWithEngine(a,c,u):r.push([a,c,u]),n.push({address:m})})});r.length&&this.hot.addHookOnce("afterChange",()=>{const s=this.engine.batch(()=>{r.forEach(a=>{let[o,u,c]=a;this.syncChangeWithEngine(o,u,c)})});this.renderDependentSheets(s,!0)}),this.renderDependentSheets(i),this.validateDependentCells(i,n)}function CDe(t,e){if(hv(e))return;const r=[],n=[];t.forEach(i=>{let[s,a,,o]=i;const u=this.hot.propToCol(a);if(!Ss(u))return;const c={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(u),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(c)){br(`Not possible to set source cell data at ${JSON.stringify(c)}`);return}n.push({address:c}),r.push(...this.engine.setCellContents(c,o))}),this.renderDependentSheets(r),this.validateDependentCells(r,n)}function xDe(t,e){let r=this.rowAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countRows()&&(r=t),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[r,e]))return!1}function EDe(t,e){let r=this.columnAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countCols()&&(r=t),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[r,e]))return!1}function _De(t,e,r){return this.rowAxisSyncer.setRemovedHfIndexes(r).every(s=>this.engine.isItPossibleToRemoveRows(this.sheetId,[s,1]))===!1?!1:void 0}function RDe(t,e,r){return this.columnAxisSyncer.setRemovedHfIndexes(r).every(s=>this.engine.isItPossibleToRemoveColumns(this.sheetId,[s,1]))===!1?!1:void 0}function TDe(t,e,r){if(hv(r))return;const n=this.engine.addRows(this.sheetId,[this.rowAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(n)}function MDe(t,e,r){if(hv(r))return;const n=this.engine.addColumns(this.sheetId,[this.columnAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(n)}function ADe(t,e,r,n){if(hv(n))return;const i=this.rowAxisSyncer.getRemovedHfIndexes().sort((a,o)=>o-a),s=this.engine.batch(()=>{i.forEach(a=>{this.engine.removeRows(this.sheetId,[a,1])})});this.renderDependentSheets(s)}function ODe(t,e,r,n){if(hv(n))return;const i=this.columnAxisSyncer.getRemovedHfIndexes().sort((a,o)=>o-a),s=this.engine.batch(()=>{i.forEach(a=>{this.engine.removeColumns(this.sheetId,[a,1])})});this.renderDependentSheets(s)}function kDe(t,e,r){var n;$f(ih,this,!0);const i=this.hot.getSourceDataArray(r,0,r+(((n=e.__children)===null||n===void 0?void 0:n.length)||0),this.hot.countSourceCols());$f(ih,this,!1),i.forEach((s,a)=>{s.forEach((o,u)=>{this.engine.setCellContents({col:u,row:r+a,sheet:this.sheetId},[[o]])})})}function DDe(t){this.hot.runHooks("afterFormulasValuesUpdate",t)}function PDe(t,e){this.hot.runHooks("afterNamedExpressionAdded",t,e)}function IDe(t,e){this.hot.runHooks("afterNamedExpressionRemoved",t,e)}function NDe(t){this.hot.runHooks("afterSheetAdded",t)}function HDe(t,e){fr(wr,this,zy).call(this,e),this.hot.runHooks("afterSheetRenamed",t,e)}function FDe(t,e){this.hot.runHooks("afterSheetRemoved",t,e)}function LDe(t){return{key:"hidden_columns_hide",name(){const e=this.getSelectedLast();let r=0;if(Array.isArray(e)){const[,n,,i]=e;n-i!==0&&(r=1)}return this.getTranslatedPhrase(QL,r)},callback(){const{from:e,to:r}=this.getSelectedRangeLast(),n=Math.max(Math.min(e.col,r.col),0),i=Math.max(e.col,r.col),s=[];for(let u=n;u<=i;u+=1)s.push(u);t.hideColumns(s);const a=s[s.length-1],o=this.columnIndexMapper.getNearestNotHiddenIndex(a,1,!0);Number.isInteger(o)&&o>=0?this.selectColumns(o):this.deselectCell(),this.render(),this.view.adjustElementsSize()},disabled:!1,hidden(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}}function BDe(t){const e=[];return{key:"hidden_columns_show",name(){const r=e.length>1?1:0;return this.getTranslatedPhrase(ZL,r)},callback(){var r,n;if(e.length===0)return;let i=e[0],s=e[e.length-1];i=(r=this.columnIndexMapper.getNearestNotHiddenIndex(i-1,-1))!==null&&r!==void 0?r:0,s=(n=this.columnIndexMapper.getNearestNotHiddenIndex(s+1,1))!==null&&n!==void 0?n:this.countCols()-1,t.showColumns(e),this.render(),this.view.adjustElementsSize(),s-i+1===this.countCols()||this.selectColumns(i,s)},disabled:!1,hidden(){const r=nr(t.getHiddenColumns(),g=>this.toPhysicalColumn(g));if(!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())||r.length<1)return!0;e.length=0;const n=this.getSelectedRangeLast(),i=n.getTopStartCorner().col,s=n.getBottomEndCorner().col,a=this.columnIndexMapper,o=a.getRenderableFromVisualIndex(i),u=a.getRenderableFromVisualIndex(s),c=a.getNotTrimmedIndexes(),f=[];if(i!==s){const g=s-i+1,m=u-o+1;if(g>m){const v=c.slice(i,s+1);f.push(...v.filter(w=>r.includes(w)))}}else if(o===0&&o<i)f.push(...c.slice(0,i));else if(o===null)f.push(...c.slice(0,this.countCols()));else{const g=this.countCols()-1,m=a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(g,-1));u===m&&g>s&&f.push(...c.slice(s+1))}return he(f,g=>{e.push(this.toVisualColumn(g))}),e.length===0}}}function VDe(t,e){$ee(t,e),e.add(t)}function WDe(t,e,r){$ee(t,e),e.set(t,r)}function $ee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function qd(t,e){return t.get(cf(t,e))}function YY(t,e,r){return t.set(cf(t,e),r),r}function cf(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}Je.getSingleton().register("beforeHideColumns");Je.getSingleton().register("afterHideColumns");Je.getSingleton().register("beforeUnhideColumns");Je.getSingleton().register("afterUnhideColumns");const zY="hiddenColumns",$De=310;var Jl=new WeakMap,Kd=new WeakSet;class UDe extends ur{constructor(){super(...arguments),VDe(this,Kd),WDe(this,Jl,null)}static get PLUGIN_KEY(){return zY}static get PLUGIN_PRIORITY(){return $De}static get DEFAULT_SETTINGS(){return{copyPasteEnabled:!0,indicators:!1,columns:[]}}isEnabled(){return!!this.hot.getSettings()[zY]}enablePlugin(){var e=this;this.enabled||(YY(Jl,this,new ZR),qd(Jl,this).addLocalHook("init",()=>cf(Kd,this,KDe).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,qd(Jl,this)),this.addHook("afterContextMenuDefaultOptions",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return cf(Kd,e,qDe).call(e,...n)}),this.addHook("afterGetCellMeta",(r,n,i)=>cf(Kd,this,YDe).call(this,r,n,i)),this.addHook("modifyColWidth",(r,n)=>cf(Kd,this,jDe).call(this,r,n),2),this.addHook("afterGetColHeader",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return cf(Kd,e,GDe).call(e,...n)}),this.addHook("modifyCopyableRange",r=>cf(Kd,this,zDe).call(this,r)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.hot.columnIndexMapper.unregisterMap(this.pluginName),this.resetCellsMeta()}showColumns(e){const r=this.getHiddenColumns(),n=this.isValidConfig(e);let i=r;const s=qd(Jl,this).getValues().slice(),a=e.length>0;if(n&&a){const u=e.map(c=>this.hot.toPhysicalColumn(c));he(u,c=>{s[c]=!1}),i=Ri(s,(c,f,g)=>(f&&c.push(this.hot.toVisualColumn(g)),c),[])}this.hot.runHooks("beforeUnhideColumns",r,i,n&&a)!==!1&&(n&&a&&qd(Jl,this).setValues(s),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",r,i,n&&a,n&&i.length<r.length))}showColumn(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];this.showColumns(r)}hideColumns(e){const r=this.getHiddenColumns(),n=this.isValidConfig(e);let i=r;n&&(i=Array.from(new Set(r.concat(e)))),this.hot.runHooks("beforeHideColumns",r,i,n)!==!1&&(n&&this.hot.batchExecution(()=>{he(e,a=>{qd(Jl,this).setValueAtIndex(this.hot.toPhysicalColumn(a),!0)})},!0),this.hot.runHooks("afterHideColumns",r,i,n,n&&i.length>r.length))}hideColumn(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];this.hideColumns(r)}getHiddenColumns(){return nr(qd(Jl,this).getHiddenIndexes(),e=>this.hot.toVisualColumn(e))}isHidden(e){return qd(Jl,this).getValueAtIndex(this.hot.toPhysicalColumn(e))||!1}isValidConfig(e){const r=this.hot.countCols();return Array.isArray(e)&&e.length>0?e.every(n=>Number.isInteger(n)&&n>=0&&n<r):!1}resetCellsMeta(){he(this.hot.getCellsMeta(),e=>{e.skipColumnOnPaste=!1})}destroy(){YY(Jl,this,null),super.destroy()}}function jDe(t,e){if(this.isHidden(e))return 0;if(this.getSetting("indicators")&&(this.isHidden(e+1)||this.isHidden(e-1))&&typeof t=="number"&&this.hot.hasColHeaders())return t+15}function YDe(t,e,r){if(this.getSetting("copyPasteEnabled")===!1&&this.isHidden(e)&&(r.skipColumnOnPaste=!0),this.isHidden(e-1))r.className=r.className||"",r.className.indexOf("afterHiddenColumn")===-1&&(r.className+=" afterHiddenColumn");else if(r.className){const n=r.className.split(" ");if(n.length>0){const i=n.indexOf("afterHiddenColumn");i>-1&&n.splice(i,1),r.className=n.join(" ")}}}function zDe(t){if(this.getSetting("copyPasteEnabled"))return t;const e=[],r=(n,i,s,a)=>{e.push({startRow:n,endRow:i,startCol:s,endCol:a})};return he(t,n=>{let i=!0,s=0;ct(n.startCol,n.endCol,a=>{this.isHidden(a)?(i||r(n.startRow,n.endRow,s,a-1),i=!0):(i&&(s=a),a===n.endCol&&r(n.startRow,n.endRow,s,a),i=!1)})}),e}function GDe(t,e){if(!this.getSetting("indicators")||t<0)return;const r=[];t>=1&&this.isHidden(t-1)&&r.push("afterHiddenColumn"),t<this.hot.countCols()-1&&this.isHidden(t+1)&&r.push("beforeHiddenColumn"),Ve(e,r)}function qDe(t){t.items.push({name:Yt},LDe(this),BDe(this))}function KDe(){const t=this.getSetting("columns");Array.isArray(t)&&this.hideColumns(t)}function XDe(t){return{key:"hidden_rows_hide",name(){const e=this.getSelectedLast();let r=0;if(Array.isArray(e)){const[n,,i]=e;n-i!==0&&(r=1)}return this.getTranslatedPhrase(JL,r)},callback(){const{from:e,to:r}=this.getSelectedRangeLast(),n=Math.max(Math.min(e.row,r.row),0),i=Math.max(e.row,r.row),s=[];for(let u=n;u<=i;u+=1)s.push(u);t.hideRows(s);const a=s[s.length-1],o=this.rowIndexMapper.getNearestNotHiddenIndex(a,1,!0);Number.isInteger(o)&&o>=0?this.selectRows(o):this.deselectCell(),this.render(),this.view.adjustElementsSize()},disabled:!1,hidden(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}}function QDe(t){const e=[];return{key:"hidden_rows_show",name(){const r=e.length>1?1:0;return this.getTranslatedPhrase(e4,r)},callback(){var r,n;if(e.length===0)return;let i=e[0],s=e[e.length-1];i=(r=this.rowIndexMapper.getNearestNotHiddenIndex(i-1,-1))!==null&&r!==void 0?r:0,s=(n=this.rowIndexMapper.getNearestNotHiddenIndex(s+1,1))!==null&&n!==void 0?n:this.countRows()-1,t.showRows(e),this.render(),this.view.adjustElementsSize(),s-i+1===this.countRows()||this.selectRows(i,s)},disabled:!1,hidden(){const r=nr(t.getHiddenRows(),g=>this.toPhysicalRow(g));if(!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())||r.length<1)return!0;e.length=0;const n=this.getSelectedRangeLast(),i=n.getTopStartCorner().row,s=n.getBottomEndCorner().row,a=this.rowIndexMapper,o=a.getRenderableFromVisualIndex(i),u=a.getRenderableFromVisualIndex(s),c=a.getNotTrimmedIndexes(),f=[];if(i!==s){const g=s-i+1,m=u-o+1;if(g>m){const v=c.slice(i,s+1);f.push(...v.filter(w=>r.includes(w)))}}else if(o===0&&o<i)f.push(...c.slice(0,i));else if(o===null)f.push(...c.slice(0,this.countRows()));else{const g=this.countRows()-1,m=a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(g,-1));u===m&&g>s&&f.push(...c.slice(s+1))}return he(f,g=>{e.push(this.toVisualRow(g))}),e.length===0}}}function ZDe(t,e){Uee(t,e),e.add(t)}function JDe(t,e,r){Uee(t,e),e.set(t,r)}function Uee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Xd(t,e){return t.get(hf(t,e))}function GY(t,e,r){return t.set(hf(t,e),r),r}function hf(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}Je.getSingleton().register("beforeHideRows");Je.getSingleton().register("afterHideRows");Je.getSingleton().register("beforeUnhideRows");Je.getSingleton().register("afterUnhideRows");const qY="hiddenRows",e2e=320;var eu=new WeakMap,Qd=new WeakSet;class t2e extends ur{constructor(){super(...arguments),ZDe(this,Qd),JDe(this,eu,null)}static get PLUGIN_KEY(){return qY}static get PLUGIN_PRIORITY(){return e2e}static get DEFAULT_SETTINGS(){return{copyPasteEnabled:!0,indicators:!1,rows:[]}}isEnabled(){return!!this.hot.getSettings()[qY]}enablePlugin(){var e=this;this.enabled||(GY(eu,this,new ZR),Xd(eu,this).addLocalHook("init",()=>hf(Qd,this,o2e).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,Xd(eu,this)),this.addHook("afterContextMenuDefaultOptions",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return hf(Qd,e,a2e).call(e,...n)}),this.addHook("afterGetCellMeta",(r,n,i)=>hf(Qd,this,n2e).call(this,r,n,i)),this.addHook("modifyRowHeight",(r,n)=>hf(Qd,this,r2e).call(this,r,n)),this.addHook("afterGetRowHeader",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return hf(Qd,e,s2e).call(e,...n)}),this.addHook("modifyCopyableRange",r=>hf(Qd,this,i2e).call(this,r)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.hot.rowIndexMapper.unregisterMap(this.pluginName),this.resetCellsMeta()}showRows(e){const r=this.getHiddenRows(),n=this.isValidConfig(e);let i=r;const s=Xd(eu,this).getValues().slice(),a=e.length>0;if(n&&a){const u=e.map(c=>this.hot.toPhysicalRow(c));he(u,c=>{s[c]=!1}),i=Ri(s,(c,f,g)=>(f&&c.push(this.hot.toVisualRow(g)),c),[])}this.hot.runHooks("beforeUnhideRows",r,i,n&&a)!==!1&&(n&&a&&Xd(eu,this).setValues(s),this.hot.runHooks("afterUnhideRows",r,i,n&&a,n&&i.length<r.length))}showRow(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];this.showRows(r)}hideRows(e){const r=this.getHiddenRows(),n=this.isValidConfig(e);let i=r;n&&(i=Array.from(new Set(r.concat(e)))),this.hot.runHooks("beforeHideRows",r,i,n)!==!1&&(n&&this.hot.batchExecution(()=>{he(e,a=>{Xd(eu,this).setValueAtIndex(this.hot.toPhysicalRow(a),!0)})},!0),this.hot.runHooks("afterHideRows",r,i,n,n&&i.length>r.length))}hideRow(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];this.hideRows(r)}getHiddenRows(){return nr(Xd(eu,this).getHiddenIndexes(),e=>this.hot.toVisualRow(e))}isHidden(e){return Xd(eu,this).getValueAtIndex(this.hot.toPhysicalRow(e))||!1}isValidConfig(e){const r=this.hot.countRows();return Array.isArray(e)&&e.length>0?e.every(n=>Number.isInteger(n)&&n>=0&&n<r):!1}resetCellsMeta(){he(this.hot.getCellsMeta(),e=>{e.skipRowOnPaste=!1})}destroy(){GY(eu,this,null),super.destroy()}}function r2e(t,e){return this.isHidden(e)?0:t}function n2e(t,e,r){if(this.getSetting("copyPasteEnabled")===!1&&this.isHidden(t)&&(r.skipRowOnPaste=!0),this.isHidden(t-1))r.className=r.className||"",r.className.indexOf("afterHiddenRow")===-1&&(r.className+=" afterHiddenRow");else if(r.className){const n=r.className.split(" ");if(n.length>0){const i=n.indexOf("afterHiddenRow");i>-1&&n.splice(i,1),r.className=n.join(" ")}}}function i2e(t){if(this.getSetting("copyPasteEnabled"))return t;const e=[],r=(n,i,s,a)=>{e.push({startRow:n,endRow:i,startCol:s,endCol:a})};return he(t,n=>{let i=!0,s=0;ct(n.startRow,n.endRow,a=>{this.isHidden(a)?(i||r(s,a-1,n.startCol,n.endCol),i=!0):(i&&(s=a),a===n.endRow&&r(s,a,n.startCol,n.endCol),i=!1)})}),e}function s2e(t,e){if(!this.getSetting("indicators")||t<0)return;const r=[];t>=1&&this.isHidden(t-1)&&r.push("afterHiddenRow"),t<this.hot.countRows()-1&&this.isHidden(t+1)&&r.push("beforeHiddenRow"),Ve(e,r)}function a2e(t){t.items.push({name:Yt},XDe(this),QDe(this))}function o2e(){const t=this.getSetting("rows");Array.isArray(t)&&this.hideRows(t)}function l2e(t){return{key:"freeze_column",name(){return this.getTranslatedPhrase(TL)},callback(e,r){const[{start:{col:n}}]=r;t.freezeColumn(n),this.render(),this.view.adjustElementsSize()},hidden(){const e=this.getSelectedRange();let r=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col<=this.getSettings().fixedColumnsStart-1)&&(r=!0),r}}}function u2e(t){return{key:"unfreeze_column",name(){return this.getTranslatedPhrase(ML)},callback(e,r){const[{start:{col:n}}]=r;t.unfreezeColumn(n),this.render(),this.view.adjustElementsSize()},hidden(){const e=this.getSelectedRange();let r=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col>=this.getSettings().fixedColumnsStart)&&(r=!0),r}}}function c2e(t,e){jee(t,e),e.add(t)}function h2e(t,e,r){jee(t,e),e.set(t,r)}function jee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function WN(t,e){return t.get(C_(t,e))}function MP(t,e,r){return t.set(C_(t,e),r),r}function C_(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}Je.getSingleton().register("beforeColumnFreeze");Je.getSingleton().register("afterColumnFreeze");Je.getSingleton().register("beforeColumnUnfreeze");Je.getSingleton().register("afterColumnUnfreeze");const KY="manualColumnFreeze",f2e=110;var ug=new WeakMap,AP=new WeakSet;class d2e extends ur{constructor(){super(...arguments),c2e(this,AP),h2e(this,ug,!1)}static get PLUGIN_KEY(){return KY}static get PLUGIN_PRIORITY(){return f2e}isEnabled(){return!!this.hot.getSettings()[KY]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>C_(AP,this,g2e).call(this,e)),this.addHook("beforeColumnMove",(e,r)=>C_(AP,this,m2e).call(this,e,r)),super.enablePlugin())}disablePlugin(){MP(ug,this,!1),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}freezeColumn(e){const r=this.hot.getSettings(),n=r.fixedColumnsStart<this.hot.countCols()&&e>r.fixedColumnsStart-1;WN(ug,this)||MP(ug,this,!0),this.hot.runHooks("beforeColumnFreeze",e,n)!==!1&&(n&&(this.hot.columnIndexMapper.moveIndexes(e,r.fixedColumnsStart),r._fixedColumnsStart+=1),this.hot.runHooks("afterColumnFreeze",e,n))}unfreezeColumn(e){const r=this.hot.getSettings(),n=r.fixedColumnsStart>0&&e<=r.fixedColumnsStart-1;WN(ug,this)||MP(ug,this,!0),this.hot.runHooks("beforeColumnUnfreeze",e,n)!==!1&&(n&&(r._fixedColumnsStart-=1,this.hot.columnIndexMapper.moveIndexes(e,r.fixedColumnsStart)),this.hot.runHooks("afterColumnUnfreeze",e,n))}}function g2e(t){t.items.push({name:"---------"},l2e(this),u2e(this))}function m2e(t,e){if(WN(ug,this)){const r=this.hot.getSettings().fixedColumnsStart;if(e<r||t.some(n=>n<r))return!1}}function mx(t,e,r){return(e=p2e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function p2e(t){var e=v2e(t,"string");return typeof e=="symbol"?e:e+""}function v2e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const OP=0,XY=1,QY=2,k0="px";let Yee=class{constructor(e){mx(this,"hot",void 0),mx(this,"_element",null),mx(this,"state",OP),mx(this,"inlineProperty",void 0),this.hot=e,this.inlineProperty=e.isRtl()?"right":"left"}appendTo(e){e.appendChild(this._element),this.state=QY}build(){this.state===OP&&(this._element=this.hot.rootDocument.createElement("div"),this.state=XY)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=OP}isAppended(){return this.state===QY}isBuilt(){return this.state>=XY}setPosition(e,r){Ss(e)&&(this._element.style.top=e+k0),Ss(r)&&(this._element.style[this.inlineProperty]=r+k0)}getPosition(){const e=this._element.style;return{top:e.top?parseInt(e.top,10):0,start:e[this.inlineProperty]?parseInt(e[this.inlineProperty],10):0}}setSize(e,r){Ss(e)&&(this._element.style.width=e+k0),Ss(r)&&(this._element.style.height=r+k0)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,r){Ss(e)&&(this._element.style.marginTop=e+k0),Ss(r)&&(this._element.style[`margin${Ms(this.inlineProperty)}`]=r+k0)}getOffset(){const e=this._element.style,r=`margin${Ms(this.inlineProperty)}`;return{top:e.marginTop?parseInt(e.marginTop,10):0,start:e[r]?parseInt(e[r],10):0}}};const w2e="ht__manualColumnMove--backlight";let y2e=class extends Yee{build(){super.build(),Ve(this._element,w2e)}};const S2e="ht__manualColumnMove--guideline";let b2e=class extends Yee{build(){super.build(),Ve(this._element,S2e)}};function C2e(t,e){zee(t,e),e.add(t)}function fl(t,e,r){zee(t,e),e.set(t,r)}function zee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ma(t,e,r){return t.set(ff(t,e),r),r}function ot(t,e){return t.get(ff(t,e))}function ff(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}Je.getSingleton().register("beforeColumnMove");Je.getSingleton().register("afterColumnMove");const kP="manualColumnMove",x2e=120,ZY="ht__manualColumnMove",x_="show-ui",$N="on-moving--columns",UN="after-selection--columns";var js=new WeakMap,mf=new WeakMap,Vc=new WeakMap,kE=new WeakMap,xf=new WeakMap,Vs=new WeakMap,px=new WeakMap,Eo=new WeakMap,X0=new WeakMap,E_=new WeakMap,Gy=new WeakMap,Zd=new WeakSet;class E2e extends ur{constructor(){super(...arguments),C2e(this,Zd),fl(this,js,new y2e(this.hot)),fl(this,mf,new b2e(this.hot)),fl(this,Vc,[]),fl(this,kE,0),fl(this,xf,!1),fl(this,Vs,{}),fl(this,px,void 0),fl(this,Eo,void 0),fl(this,X0,void 0),fl(this,E_,void 0),fl(this,Gy,void 0)}static get PLUGIN_KEY(){return kP}static get PLUGIN_PRIORITY(){return x2e}isEnabled(){return!!this.hot.getSettings()[kP]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return ff(Zd,e,_2e).call(e,...n)}),this.addHook("beforeOnCellMouseOver",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return ff(Zd,e,T2e).call(e,...n)}),this.addHook("afterScrollVertically",()=>ff(Zd,this,A2e).call(this)),this.addHook("afterLoadData",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return ff(Zd,e,O2e).call(e,...n)}),this.buildPluginUI(),this.registerEvents(),Ve(this.hot.rootElement,ZY),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){wt(this.hot.rootElement,ZY),this.unregisterEvents(),ot(js,this).destroy(),ot(mf,this).destroy(),super.disablePlugin()}moveColumn(e,r){return this.moveColumns([e],r)}moveColumns(e,r){const n=ot(px,this),i=this.isMovePossible(e,r),s=this.hot.runHooks("beforeColumnMove",e,r,n,i);if(ma(px,this,void 0),s===!1)return;i&&this.hot.columnIndexMapper.moveIndexes(e,r);const a=i&&this.isColumnOrderChanged(e,r);return this.hot.runHooks("afterColumnMove",e,r,n,i,a),a}dragColumn(e,r){return this.dragColumns([e],r)}dragColumns(e,r){const n=this.countFinalIndex(e,r);return ma(px,this,r),this.moveColumns(e,n)}isMovePossible(e,r){const n=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),i=e.length+r>n,s=r<0,a=e.some(u=>u<0),o=e.some(u=>u>=n);return!(i||s||a||o)}isColumnOrderChanged(e,r){return e.some((n,i)=>n-i!==r)}countFinalIndex(e,r){const n=Ri(e,(i,s)=>(s<r&&(i+=1),i),0);return r-n}getColumnsWidth(e,r){const n=this.hot.columnIndexMapper;let i=0;for(let s=e;s<=r;s+=1){const a=n.getRenderableFromVisualIndex(s);s<0?i+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:a!==null&&(i+=this.hot.view._wt.wtTable.getColumnWidth(a)||0)}return i}moveBySettingsOrLoad(){const e=this.hot.getSettings()[kP];if(Array.isArray(e))this.moveColumns(e,0);else if(e!==void 0){const r=this.persistentStateLoad();r.length&&this.moveColumns(r,0)}}isFixedColumnsStart(e){return e<this.hot.getSettings().fixedColumnsStart}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",e),e.value?e.value:[]}prepareColumnsToMoving(e,r){const n=[];return ct(e,r,i=>{n.push(i)}),n}refreshPositions(){const e=this.hot.view.getFirstFullyVisibleColumn();this.isFixedColumnsStart(ot(Eo,this))&&e>0&&this.hot.scrollViewportTo({col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(e-1,-1)});const r=this.hot.view._wt.wtTable,n=this.hot.view._wt.wtOverlays.scrollableElement,i=typeof n.scrollX=="number"?n.scrollX:n.scrollLeft;let s=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,ot(Eo,this)-1);const a=r.hider.offsetWidth,o=r.TBODY.offsetLeft,u=ot(js,this).getOffset().start,c=ot(js,this).getSize().width;let f=0,g=0;if(this.hot.isRtl()){const w=this.hot.rootWindow,y=Un(this.hot.rootElement),b=w.innerWidth-ot(X0,this)-y;g=w.innerWidth-ot(Vs,this).eventPageX-b-(n.scrollX===void 0?i:0)}else g=ot(Vs,this).eventPageX-(ot(X0,this)-(n.scrollX===void 0?i:0));if(ot(E_,this)&&(f=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(ot(Eo,this))&&(s+=i),s+=f,ot(Eo,this)<0)ot(Gy,this)>0?ot(Vs,this).col=0:ot(Vs,this).col=e>0?e-1:e;else if(ot(Vs,this).TD.offsetWidth/2+s<=g){const w=ot(Eo,this)>=ot(kE,this)?ot(kE,this)-1:ot(Eo,this);ot(Vs,this).col=w+1,s+=ot(Vs,this).TD.offsetWidth}else ot(Vs,this).col=ot(Eo,this);let m=g,v=s;g+c+u>=a?m=a-c-u:g+u<o+f&&(m=o+f+Math.abs(u)),s>=a-1?v=a-1:v===0?v=1:n.scrollX!==void 0&&ot(Eo,this)<ot(Gy,this)&&(v-=ot(X0,this)<=n.scrollX?ot(X0,this):0),ot(js,this).setPosition(null,m),ot(mf,this).setPosition(null,v)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",r=>ff(Zd,this,R2e).call(this,r)),this.eventManager.addEventListener(e,"mouseup",()=>ff(Zd,this,M2e).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){ot(js,this).build(),ot(mf,this).build()}destroy(){ot(js,this).destroy(),ot(mf,this).destroy(),super.destroy()}}function _2e(t,e,r,n){const i=this.hot.view._wt.wtTable,s=this.hot.selection.isSelectedByColumnHeader(),a=this.hot.getSelectedRangeLast(),o=Ct(t.target,"sortAction");if(!a||!s||ot(xf,this)||t.button!==0||o){ma(xf,this,!1),ot(Vc,this).length=0,wt(this.hot.rootElement,[$N,x_]);return}const u=ot(mf,this).isBuilt()&&!ot(mf,this).isAppended(),c=ot(js,this).isBuilt()&&!ot(js,this).isAppended();u&&c&&(ot(mf,this).appendTo(i.hider),ot(js,this).appendTo(i.hider));const{from:f,to:g}=a,m=Math.min(f.col,g.col),v=Math.max(f.col,g.col);if(e.row<0&&e.col>=m&&e.col<=v){n.column=!0,ma(xf,this,!0);const w=r.firstChild?BQ(t,r.firstChild).x:t.offsetX;ot(Vs,this).eventPageX=t.pageX,ma(Eo,this,e.col),ot(Vs,this).TD=r,ot(Vs,this).col=e.col,ma(Vc,this,this.prepareColumnsToMoving(m,v)),ma(E_,this,!!this.hot.getSettings().rowHeaders),ma(kE,this,this.hot.countCols()),ma(Gy,this,this.hot.getSettings().fixedColumnsStart),ma(X0,this,ns(this.hot.rootElement).left);const y=ot(E_,this)?-1:0,b=i.holder.scrollTop+i.getColumnHeaderHeight(0)+1,x=e.col<ot(Gy,this),_=this.hot.view._wt.wtOverlays.inlineStartOverlay.getOverlayOffset(),T=Math.abs(w-(this.hot.isRtl()?r.offsetWidth:0)),D=this.getColumnsWidth(m,e.col-1)+T,P=this.getColumnsWidth(y,m-1)+(x?_:0)+D;ot(js,this).setPosition(b,P),ot(js,this).setSize(this.getColumnsWidth(m,v),i.hider.offsetHeight-b),ot(js,this).setOffset(null,-D),Ve(this.hot.rootElement,$N)}else wt(this.hot.rootElement,UN),ma(xf,this,!1),ot(Vc,this).length=0}function R2e(t){ot(xf,this)&&(ot(Vs,this).eventPageX=t.pageX,this.refreshPositions())}function T2e(t,e,r,n){!this.hot.getSelectedRangeLast()||!ot(xf,this)||(ot(Vc,this).indexOf(e.col)>-1?wt(this.hot.rootElement,x_):Ve(this.hot.rootElement,x_),n.row=!0,n.column=!0,n.cell=!0,ma(Eo,this,e.col),ot(Vs,this).TD=r)}function M2e(){const t=ot(Vs,this).col,e=ot(Vc,this).length;if(ma(Eo,this,void 0),ma(xf,this,!1),wt(this.hot.rootElement,[$N,x_,UN]),this.hot.selection.isSelectedByColumnHeader()&&Ve(this.hot.rootElement,UN),e<1||t===void 0)return;const r=ot(Vc,this)[0],n=this.hot.toPhysicalColumn(r),i=this.dragColumns(ot(Vc,this),t);if(ot(Vc,this).length=0,i===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize();const s=this.hot.toVisualColumn(n),a=s+e-1;this.hot.selectColumns(s,a)}}function A2e(){const t=this.hot.view._wt.wtTable,e=t.getColumnHeaderHeight(0)+1,r=t.holder.scrollTop,n=e+r;ot(js,this).setPosition(n),ot(js,this).setSize(null,t.hider.offsetHeight-n)}function O2e(){this.moveBySettingsOrLoad()}function k2e(t,e){Gee(t,e),e.add(t)}function cs(t,e,r){Gee(t,e),e.set(t,r)}function Gee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Wn(t,e,r){return t.set(bl(t,e),r),r}function et(t,e){return t.get(bl(t,e))}function bl(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const __="manualColumnResize",D2e=130,JY="manualColumnWidths";var Pc=new WeakMap,vx=new WeakMap,Ua=new WeakMap,R_=new WeakMap,_u=new WeakMap,P2e=new WeakMap,pp=new WeakMap,wx=new WeakMap,oa=new WeakMap,Ac=new WeakMap,Bg=new WeakMap,T_=new WeakMap,qy=new WeakMap,Ky=new WeakMap,Ya=new WeakMap,Xy=new WeakMap,tu=new WeakSet;class I2e extends ur{static get PLUGIN_KEY(){return __}static get PLUGIN_PRIORITY(){return D2e}constructor(e){super(e),k2e(this,tu),cs(this,Pc,null),cs(this,vx,null),cs(this,Ua,[]),cs(this,R_,null),cs(this,_u,null),cs(this,P2e,null),cs(this,pp,null),cs(this,wx,null),cs(this,oa,this.hot.rootDocument.createElement("DIV")),cs(this,Ac,this.hot.rootDocument.createElement("DIV")),cs(this,Bg,null),cs(this,T_,!1),cs(this,qy,0),cs(this,Ky,null),cs(this,Ya,void 0),cs(this,Xy,void 0),Ve(et(oa,this),"manualColumnResizer"),Ve(et(Ac,this),"manualColumnResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[__]}enablePlugin(){var e=this;this.enabled||(Wn(Ya,this,new Jf),et(Ya,this).addLocalHook("init",()=>bl(tu,this,N2e).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,et(Ya,this)),this.addHook("modifyColWidth",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return bl(tu,e,W2e).call(e,...n)},1),this.addHook("beforeStretchingColumnWidth",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return bl(tu,e,$2e).call(e,...n)},1),this.addHook("beforeColumnResize",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return bl(tu,e,U2e).call(e,...n)}),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){Wn(Xy,this,et(Ya,this).getValues()),this.hot.columnIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualColumnWidths(){this.hot.runHooks("persistentStateSave",JY,et(Ya,this).getValues())}loadManualColumnWidths(){const e={};return this.hot.runHooks("persistentStateLoad",JY,e),e.value}setManualSize(e,r){const n=Math.max(r,20),i=this.hot.toPhysicalColumn(e);return et(Ya,this).setValueAtIndex(i,n),n}clearManualSize(e){const r=this.hot.toPhysicalColumn(e);et(Ya,this).setValueAtIndex(r,null)}setupHandlePosition(e){if(!e.parentNode)return;Wn(Pc,this,e);const{_wt:r}=this.hot.view,n=r.wtTable.getCoords(et(Pc,this)),i=n.col;if(i<0)return;const s=ai(et(Pc,this)),a=et(Pc,this).getBoundingClientRect(),o=i<r.getSetting("fixedColumnsStart");let u;o&&(u=r.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(et(Pc,this),n.row,n.col)),u||(u=r.wtOverlays.topOverlay.getRelativeCellPosition(et(Pc,this),n.row,n.col)),Wn(vx,this,this.hot.columnIndexMapper.getVisualFromRenderableIndex(i)),Wn(Ua,this,[]);const c=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();if(this.hot.selection.isSelected()&&c){const f=this.hot.getSelectedRange();he(f,g=>{const m=g.getTopStartCorner().col,v=g.getBottomEndCorner().col;ct(m,v,w=>{et(Ua,this).includes(w)||et(Ua,this).push(w)})})}et(Ua,this).includes(et(vx,this))||Wn(Ua,this,[et(vx,this)]),Wn(wx,this,u.start-6),Wn(pp,this,parseInt(a.width,10)),et(oa,this).style.top=`${u.top}px`,et(oa,this).style[this.inlineDir]=`${et(wx,this)+et(pp,this)}px`,et(oa,this).style.height=`${s}px`,this.hot.rootElement.appendChild(et(oa,this))}refreshHandlePosition(){et(oa,this).style[this.inlineDir]=`${et(wx,this)+et(R_,this)}px`}setupGuidePosition(){const e=parseInt(ai(et(oa,this)),10),r=parseInt(et(oa,this).style.top,10)+e,n=this.hot.view.getTableHeight();Ve(et(oa,this),"active"),Ve(et(Ac,this),"active"),et(Ac,this).style.top=`${r}px`,this.refreshGuidePosition(),et(Ac,this).style.height=`${n-e}px`,this.hot.rootElement.appendChild(et(Ac,this))}refreshGuidePosition(){et(Ac,this).style[this.inlineDir]=et(oa,this).style[this.inlineDir]}hideHandleAndGuide(){wt(et(oa,this),"active"),wt(et(Ac,this),"active")}checkIfColumnHeader(e){const r=Lf(e,["THEAD"],this.hot.rootElement),{topOverlay:n,topInlineStartCornerOverlay:i}=this.hot.view._wt.wtOverlays;return[n.clone.wtTable.THEAD,i.clone.wtTable.THEAD].includes(r)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}afterMouseDownTimeout(){const e=()=>{this.hot.render(),this.hot.view.adjustElementsSize()},r=(n,i)=>{const s=this.hot.runHooks("beforeColumnResize",et(_u,this),n,!0);s!==void 0&&Wn(_u,this,s),this.setManualSize(n,et(_u,this)),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",et(_u,this),n,!0),i&&e()};et(qy,this)>=2&&(et(Ua,this).length>1?(he(et(Ua,this),i=>{r(i)}),e()):he(et(Ua,this),i=>{r(i,!0)})),Wn(qy,this,0),Wn(Ky,this,null)}bindEvents(){const{rootWindow:e,rootElement:r}=this.hot;this.eventManager.addEventListener(r,"mouseover",n=>bl(tu,this,H2e).call(this,n)),this.eventManager.addEventListener(r,"mousedown",n=>bl(tu,this,F2e).call(this,n)),this.eventManager.addEventListener(e,"mousemove",n=>bl(tu,this,L2e).call(this,n)),this.eventManager.addEventListener(e,"mouseup",()=>bl(tu,this,B2e).call(this)),this.eventManager.addEventListener(et(oa,this),"contextmenu",()=>bl(tu,this,V2e).call(this))}destroy(){super.destroy()}}function N2e(){const t=this.hot.getSettings()[__],e=this.loadManualColumnWidths();typeof e<"u"?this.hot.batchExecution(()=>{e.forEach((r,n)=>{et(Ya,this).setValueAtIndex(n,r)})},!0):Array.isArray(t)?(this.hot.batchExecution(()=>{t.forEach((r,n)=>{et(Ya,this).setValueAtIndex(n,r)})},!0),Wn(Xy,this,t)):t===!0&&Array.isArray(et(Xy,this))&&this.hot.batchExecution(()=>{et(Xy,this).forEach((r,n)=>{et(Ya,this).setValueAtIndex(n,r)})},!0)}function H2e(t){if(!kF(t.target)&&et(T_,this)!==!0&&this.checkIfColumnHeader(t.target)){const e=this.getClosestTHParent(t.target);if(!e)return;const r=e.getAttribute("colspan");e&&(r===null||r==="1")&&(et(Bg,this)||this.setupHandlePosition(e))}}function F2e(t){t.target.parentNode===this.hot.rootElement&&Ct(t.target,"manualColumnResizer")&&(this.setupHandlePosition(et(Pc,this)),this.setupGuidePosition(),Wn(Bg,this,!0),et(Ky,this)===null&&(Wn(Ky,this,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(et(Ky,this))),Wn(qy,this,et(qy,this)+1),this.startX=t.pageX,Wn(_u,this,et(pp,this)))}function L2e(t){if(et(Bg,this)){const e=(t.pageX-this.startX)*this.hot.getDirectionFactor();Wn(R_,this,et(pp,this)+e),he(et(Ua,this),r=>{Wn(_u,this,this.setManualSize(r,et(R_,this)))}),this.refreshHandlePosition(),this.refreshGuidePosition()}}function B2e(){const t=()=>{this.hot.render(),this.hot.view.adjustElementsSize()},e=(r,n)=>{this.hot.runHooks("beforeColumnResize",et(_u,this),r,!1),n&&t(),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",et(_u,this),r,!1)};et(Bg,this)&&(this.hideHandleAndGuide(),Wn(Bg,this,!1),et(_u,this)!==et(pp,this)&&(et(Ua,this).length>1?(he(et(Ua,this),n=>{e(n)}),t()):he(et(Ua,this),n=>{e(n,!0)})),this.setupHandlePosition(et(Pc,this)))}function V2e(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(et(oa,this)),this.hot.rootElement.removeChild(et(Ac,this)),Wn(Bg,this,!1),Wn(T_,this,!0),this.hot._registerImmediate(()=>{Wn(T_,this,!1)})}function W2e(t,e){let r=t;if(this.enabled){const n=this.hot.toPhysicalColumn(e),i=et(Ya,this).getValueAtIndex(n);this.hot.getSettings()[__]&&i&&(r=i)}return r}function $2e(t,e){const r=et(Ya,this).getValueAtIndex(this.hot.toPhysicalColumn(e));return typeof r=="number"?r:t}function U2e(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}function DP(t,e,r){return(e=j2e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function j2e(t){var e=Y2e(t,"string");return typeof e=="symbol"?e:e+""}function Y2e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const PP=0,ez=1,tz=2,D0="px";let qee=class{constructor(e){DP(this,"hot",void 0),DP(this,"_element",null),DP(this,"state",PP),this.hot=e}appendTo(e){e.appendChild(this._element),this.state=tz}build(){this.state===PP&&(this._element=this.hot.rootDocument.createElement("div"),this.state=ez)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=PP}isAppended(){return this.state===tz}isBuilt(){return this.state>=ez}setPosition(e,r){e!==void 0&&(this._element.style.top=e+D0),r!==void 0&&(this._element.style.left=r+D0)}getPosition(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}setSize(e,r){e&&(this._element.style.width=e+D0),r&&(this._element.style.height=r+D0)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,r){e&&(this._element.style.marginTop=e+D0),r&&(this._element.style.marginLeft=r+D0)}getOffset(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}};const z2e="ht__manualRowMove--backlight";class G2e extends qee{build(){super.build(),Ve(this._element,z2e)}}const q2e="ht__manualRowMove--guideline";class K2e extends qee{build(){super.build(),Ve(this._element,q2e)}}function X2e(t,e){Kee(t,e),e.add(t)}function P0(t,e,r){Kee(t,e),e.set(t,r)}function Kee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function bg(t,e,r){return t.set(df(t,e),r),r}function kt(t,e){return t.get(df(t,e))}function df(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}Je.getSingleton().register("beforeRowMove");Je.getSingleton().register("afterRowMove");const IP="manualRowMove",Q2e=140,rz="ht__manualRowMove",M_="show-ui",jN="on-moving--rows",YN="after-selection--rows";var Ys=new WeakMap,pf=new WeakMap,Wc=new WeakMap,Ef=new WeakMap,va=new WeakMap,yx=new WeakMap,Jd=new WeakSet;class Z2e extends ur{constructor(){super(...arguments),X2e(this,Jd),P0(this,Ys,new G2e(this.hot)),P0(this,pf,new K2e(this.hot)),P0(this,Wc,[]),P0(this,Ef,void 0),P0(this,va,{}),P0(this,yx,void 0)}static get PLUGIN_KEY(){return IP}static get PLUGIN_PRIORITY(){return Q2e}isEnabled(){return!!this.hot.getSettings()[IP]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return df(Jd,e,J2e).call(e,...n)}),this.addHook("beforeOnCellMouseOver",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return df(Jd,e,tPe).call(e,...n)}),this.addHook("afterScrollHorizontally",()=>df(Jd,this,nPe).call(this)),this.addHook("afterLoadData",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return df(Jd,e,iPe).call(e,...n)}),this.buildPluginUI(),this.registerEvents(),Ve(this.hot.rootElement,rz),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){wt(this.hot.rootElement,rz),this.unregisterEvents(),kt(Ys,this).destroy(),kt(pf,this).destroy(),super.disablePlugin()}moveRow(e,r){return this.moveRows([e],r)}moveRows(e,r){const n=kt(yx,this),i=this.isMovePossible(e,r),s=this.hot.runHooks("beforeRowMove",e,r,n,i);if(bg(yx,this,void 0),s===!1)return;i&&this.hot.rowIndexMapper.moveIndexes(e,r);const a=i&&this.isRowOrderChanged(e,r);return this.hot.runHooks("afterRowMove",e,r,n,i,a),a}dragRow(e,r){return this.dragRows([e],r)}dragRows(e,r){const n=this.countFinalIndex(e,r);return bg(yx,this,r),this.moveRows(e,n)}isMovePossible(e,r){const n=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),i=e.length+r>n,s=r<0,a=e.some(u=>u<0),o=e.some(u=>u>=n);return!(i||s||a||o)}isRowOrderChanged(e,r){return e.some((n,i)=>n-i!==r)}countFinalIndex(e,r){const n=Ri(e,(i,s)=>(s<r&&(i+=1),i),0);return r-n}getRowsHeight(e,r){const n=this.hot.rowIndexMapper;let i=0;for(let s=e;s<=r;s++){const a=n.getRenderableFromVisualIndex(s);a!==null&&(i+=this.hot.view._wt.wtTable.getRowHeight(a)||this.hot.stylesHandler.getDefaultRowHeight())}return i}moveBySettingsOrLoad(){const e=this.hot.getSettings()[IP];if(Array.isArray(e))this.moveRows(e,0);else if(e!==void 0){const r=this.persistentStateLoad();r.length&&this.moveRows(r,0)}}isFixedRowTop(e){return e<this.hot.getSettings().fixedRowsTop}isFixedRowBottom(e){return e>this.hot.countRows()-1-this.hot.getSettings().fixedRowsBottom}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualRowMove",e),e.value?e.value:[]}prepareRowsToMoving(){const e=this.hot.getSelectedRangeLast(),r=[];if(!e)return r;const{from:n,to:i}=e,s=Math.min(n.row,i.row),a=Math.max(n.row,i.row);return ct(s,a,o=>{r.push(o)}),r}refreshPositions(){const e=kt(va,this).coords,r=this.hot.getFirstFullyVisibleRow(),n=this.hot.getLastFullyVisibleRow(),i=this.hot.countRows();this.isFixedRowTop(e.row)&&r>0&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(r-1,-1)),this.isFixedRowBottom(e.row)&&n<i&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(n+1,1),void 0,!0);const s=this.hot.view._wt.wtTable,a=kt(va,this).TD,o=this.hot.rootElement,u=ns(o),c=Ap(o),f=s.holder.scrollTop,g=this.hot.rootWindow!==c?c.scrollTop:0,m=u.top-g,v=kt(va,this).eventPageY-m+f,w=s.hider.offsetHeight,y=s.TBODY.offsetTop,b=kt(Ys,this).getOffset().top,x=kt(Ys,this).getSize().height,_=a.offsetHeight/2,T=a.offsetHeight;let D=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,e.row-1);const P=v>=D+_;this.isFixedRowTop(e.row)&&(D+=this.hot.view._wt.wtOverlays.topOverlay.getOverlayOffset()),e.row<0?kt(va,this).row=r>0?r-1:r:P?(kt(va,this).row=e.row+1,D+=e.row===0?T-1:T):kt(va,this).row=e.row;let O=v,A=D;v+x+b>=w?O=w-x-b:v+b<y&&(O=y+Math.abs(b)),D>=w-1&&(A=w-1),kt(Ys,this).setPosition(O),kt(pf,this).setPosition(A)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",r=>df(Jd,this,ePe).call(this,r)),this.eventManager.addEventListener(e,"mouseup",()=>df(Jd,this,rPe).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){kt(Ys,this).build(),kt(pf,this).build()}destroy(){kt(Ys,this).destroy(),kt(pf,this).destroy(),super.destroy()}}function J2e(t,e,r,n){const{wtTable:i,wtViewport:s}=this.hot.view._wt,a=this.hot.selection.isSelectedByRowHeader(),o=this.hot.getSelectedRangeLast();if(!o||!a||kt(Ef,this)||t.button!==0){bg(Ef,this,!1),kt(Wc,this).length=0,wt(this.hot.rootElement,[jN,M_]);return}const u=kt(pf,this).isBuilt()&&!kt(pf,this).isAppended(),c=kt(Ys,this).isBuilt()&&!kt(Ys,this).isAppended();u&&c&&(kt(pf,this).appendTo(i.hider),kt(Ys,this).appendTo(i.hider));const{from:f,to:g}=o,m=Math.min(f.row,g.row),v=Math.max(f.row,g.row);if(e.col<0&&e.row>=m&&e.row<=v){n.row=!0,bg(Ef,this,!0),kt(va,this).eventPageY=t.pageY,kt(va,this).coords=e,kt(va,this).TD=r,bg(Wc,this,this.prepareRowsToMoving());const w=i.holder.scrollLeft+s.getRowHeaderWidth(),y=this.getRowsHeight(m,e.row-1)+(t.clientY-r.getBoundingClientRect().top);kt(Ys,this).setPosition(null,w),kt(Ys,this).setSize(i.hider.offsetWidth-w,this.getRowsHeight(m,v)),kt(Ys,this).setOffset(-y,null),Ve(this.hot.rootElement,jN),this.refreshPositions()}else wt(this.hot.rootElement,YN),bg(Ef,this,!1),kt(Wc,this).length=0}function ePe(t){kt(Ef,this)&&(kt(va,this).eventPageY=t.pageY,this.refreshPositions())}function tPe(t,e,r,n){!this.hot.getSelectedRangeLast()||!kt(Ef,this)||(kt(Wc,this).indexOf(e.row)>-1?wt(this.hot.rootElement,M_):Ve(this.hot.rootElement,M_),n.row=!0,n.column=!0,n.cell=!0,kt(va,this).coords=e,kt(va,this).TD=r)}function rPe(){const t=kt(va,this).row,e=kt(Wc,this).length;if(bg(Ef,this,!1),wt(this.hot.rootElement,[jN,M_,YN]),this.hot.selection.isSelectedByRowHeader()&&Ve(this.hot.rootElement,YN),e<1||t===void 0)return;const r=kt(Wc,this)[0],n=this.hot.toPhysicalRow(r),i=this.dragRows(kt(Wc,this),t);if(kt(Wc,this).length=0,i===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize();const s=this.hot.toVisualRow(n),a=s+e-1;this.hot.selectRows(s,a)}}function nPe(){const t=this.hot.view._wt.wtTable,e=this.hot.view._wt.wtViewport.getRowHeaderWidth(),r=t.holder.scrollLeft,n=e+r;kt(Ys,this).setPosition(null,n),kt(Ys,this).setSize(t.hider.offsetWidth-n)}function iPe(){this.moveBySettingsOrLoad()}function sPe(t,e){Xee(t,e),e.add(t)}function hs(t,e,r){Xee(t,e),e.set(t,r)}function Xee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Mn(t,e,r){return t.set(Ic(t,e),r),r}function Ze(t,e){return t.get(Ic(t,e))}function Ic(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const A_="manualRowResize",aPe=30,nz="manualRowHeights";var mu=new WeakMap,Sx=new WeakMap,ja=new WeakMap,Qy=new WeakMap,vf=new WeakMap,b3=new WeakMap,vp=new WeakMap,bx=new WeakMap,Ls=new WeakMap,cu=new WeakMap,Vg=new WeakMap,O_=new WeakMap,Zy=new WeakMap,Jy=new WeakMap,xl=new WeakMap,e1=new WeakMap,ef=new WeakSet;class oPe extends ur{static get PLUGIN_KEY(){return A_}static get PLUGIN_PRIORITY(){return aPe}constructor(e){super(e),sPe(this,ef),hs(this,mu,null),hs(this,Sx,null),hs(this,ja,[]),hs(this,Qy,null),hs(this,vf,null),hs(this,b3,null),hs(this,vp,null),hs(this,bx,null),hs(this,Ls,this.hot.rootDocument.createElement("DIV")),hs(this,cu,this.hot.rootDocument.createElement("DIV")),hs(this,Vg,!1),hs(this,O_,!1),hs(this,Zy,0),hs(this,Jy,null),hs(this,xl,void 0),hs(this,e1,void 0),Ve(Ze(Ls,this),"manualRowResizer"),Ve(Ze(cu,this),"manualRowResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[A_]}enablePlugin(){this.enabled||(Mn(xl,this,new Jf),Ze(xl,this).addLocalHook("init",()=>Ic(ef,this,gPe).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,Ze(xl,this)),this.addHook("modifyRowHeight",(e,r)=>Ic(ef,this,dPe).call(this,e,r)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){Mn(e1,this,Ze(xl,this).getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualRowHeights(){this.hot.runHooks("persistentStateSave",nz,Ze(xl,this).getValues())}loadManualRowHeights(){const e={};return this.hot.runHooks("persistentStateLoad",nz,e),e.value}setManualSize(e,r){const n=this.hot.toPhysicalRow(e),i=Math.max(r,this.hot.stylesHandler.getDefaultRowHeight());return Ze(xl,this).setValueAtIndex(n,i),i}getLastDesiredRowHeight(){return Ze(Qy,this)}setupHandlePosition(e){Mn(mu,this,e);const{view:r}=this.hot,{_wt:n}=r,i=n.wtTable.getCoords(Ze(mu,this)),s=i.row;if(s<0)return;const a=Un(Ze(mu,this)),o=Ze(mu,this).getBoundingClientRect(),u=s<n.getSetting("fixedRowsTop"),c=s>=r.countNotHiddenRowIndexes(0,1)-n.getSetting("fixedRowsBottom");let f;u?f=n.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(Ze(mu,this),i.row,i.col):c&&(f=n.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(Ze(mu,this),i.row,i.col)),f||(f=n.wtOverlays.inlineStartOverlay.getRelativeCellPosition(Ze(mu,this),i.row,i.col)),Mn(Sx,this,this.hot.rowIndexMapper.getVisualFromRenderableIndex(s)),Mn(ja,this,[]);const g=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();if(this.hot.selection.isSelected()&&g){const m=this.hot.getSelectedRange();he(m,v=>{const w=v.getTopStartCorner().row,y=v.getBottomStartCorner().row;ct(w,y,b=>{Ze(ja,this).includes(b)||Ze(ja,this).push(b)})})}Ze(ja,this).includes(Ze(Sx,this))||Mn(ja,this,[Ze(Sx,this)]),Mn(bx,this,f.top-6),Mn(vp,this,parseInt(o.height,10)),Ze(Ls,this).style.top=`${Ze(bx,this)+Ze(vp,this)}px`,Ze(Ls,this).style[this.inlineDir]=`${f.start}px`,Ze(Ls,this).style.width=`${a}px`,this.hot.rootElement.appendChild(Ze(Ls,this))}refreshHandlePosition(){Ze(Ls,this).style.top=`${Ze(bx,this)+Ze(Qy,this)}px`}setupGuidePosition(){const e=parseInt(Un(Ze(Ls,this)),10),r=parseInt(Ze(Ls,this).style[this.inlineDir],10)+e,n=this.hot.view.getTableWidth();Ve(Ze(Ls,this),"active"),Ve(Ze(cu,this),"active"),Ze(cu,this).style.top=Ze(Ls,this).style.top,Ze(cu,this).style[this.inlineDir]=`${r}px`,Ze(cu,this).style.width=`${n-e}px`,this.hot.rootElement.appendChild(Ze(cu,this))}refreshGuidePosition(){Ze(cu,this).style.top=Ze(Ls,this).style.top}hideHandleAndGuide(){wt(Ze(Ls,this),"active"),wt(Ze(cu,this),"active")}checkIfRowHeader(e){const r=Lf(e,["TBODY"],this.hot.rootElement),{inlineStartOverlay:n,topInlineStartCornerOverlay:i,bottomInlineStartCornerOverlay:s}=this.hot.view._wt.wtOverlays;return[n.clone.wtTable.TBODY,i.clone.wtTable.TBODY,s.clone.wtTable.TBODY].includes(r)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}getActualRowHeight(e){const r=this.hot.view._wt.wtTable.getRowHeight(e);return r!==void 0&&Ze(vf,this)<r?r:Ze(vf,this)}afterMouseDownTimeout(){const e=()=>{this.hot.render(),this.hot.view.adjustElementsSize()},r=(n,i)=>{const s=this.hot.runHooks("beforeRowResize",this.getActualRowHeight(n),n,!0);s!==void 0&&Mn(vf,this,s),this.setManualSize(n,Ze(vf,this)),this.hot.runHooks("afterRowResize",this.getActualRowHeight(n),n,!0),i&&e()};Ze(Zy,this)>=2&&(Ze(ja,this).length>1?(he(Ze(ja,this),i=>{r(i)}),e()):he(Ze(ja,this),i=>{r(i,!0)})),Mn(Zy,this,0),Mn(Jy,this,null)}bindEvents(){const{rootElement:e,rootWindow:r}=this.hot;this.eventManager.addEventListener(e,"mouseover",n=>Ic(ef,this,lPe).call(this,n)),this.eventManager.addEventListener(e,"mousedown",n=>Ic(ef,this,uPe).call(this,n)),this.eventManager.addEventListener(r,"mousemove",n=>Ic(ef,this,cPe).call(this,n)),this.eventManager.addEventListener(r,"mouseup",()=>Ic(ef,this,hPe).call(this)),this.eventManager.addEventListener(Ze(Ls,this),"contextmenu",()=>Ic(ef,this,fPe).call(this))}destroy(){super.destroy()}}function lPe(t){if(!kF(t.target)&&Ze(O_,this)!==!0&&this.checkIfRowHeader(t.target)){const e=this.getClosestTHParent(t.target);e&&(Ze(Vg,this)||this.setupHandlePosition(e))}}function uPe(t){Ct(t.target,"manualRowResizer")&&(this.setupHandlePosition(Ze(mu,this)),this.setupGuidePosition(),Mn(Vg,this,!0),Ze(Jy,this)===null&&(Mn(Jy,this,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(Ze(Jy,this))),Mn(Zy,this,Ze(Zy,this)+1),Mn(b3,this,t.pageY),Mn(vf,this,Ze(vp,this)))}function cPe(t){Ze(Vg,this)&&(Mn(Qy,this,Ze(vp,this)+(t.pageY-Ze(b3,this))),he(Ze(ja,this),e=>{Mn(vf,this,this.setManualSize(e,Ze(Qy,this)))}),this.refreshHandlePosition(),this.refreshGuidePosition())}function hPe(){const t=()=>{this.hot.render(),this.hot.view.adjustElementsSize()},e=(r,n)=>{this.hot.runHooks("beforeRowResize",this.getActualRowHeight(r),r,!1),n&&t(),this.saveManualRowHeights(),this.hot.runHooks("afterRowResize",this.getActualRowHeight(r),r,!1)};Ze(Vg,this)&&(this.hideHandleAndGuide(),Mn(Vg,this,!1),Ze(vf,this)!==Ze(vp,this)&&(Ze(ja,this).length>1?(he(Ze(ja,this),n=>{e(n)}),t()):he(Ze(ja,this),n=>{e(n,!0)})),this.setupHandlePosition(Ze(mu,this)))}function fPe(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(Ze(Ls,this)),this.hot.rootElement.removeChild(Ze(cu,this)),Mn(Vg,this,!1),Mn(O_,this,!0),this.hot._registerImmediate(()=>{Mn(O_,this,!1)})}function dPe(t,e){let r=t;if(this.enabled){const n=this.hot.toPhysicalRow(e),i=Ze(xl,this).getValueAtIndex(n);this.hot.getSettings()[A_]&&i&&(r=i)}return r}function gPe(){const t=this.hot.getSettings()[A_],e=this.loadManualRowHeights();this.hot.batchExecution(()=>{typeof e<"u"?e.forEach((r,n)=>{Ze(xl,this).setValueAtIndex(n,r)}):Array.isArray(t)?(t.forEach((r,n)=>{Ze(xl,this).setValueAtIndex(n,r)}),Mn(e1,this,t)):t===!0&&Array.isArray(Ze(e1,this))&&Ze(e1,this).forEach((r,n)=>{Ze(xl,this).setValueAtIndex(n,r)})},!0)}var iz={},sz;function mPe(){if(sz)return iz;sz=1;var t=GR();return t("flatMap"),iz}mPe();var az={},oz={},NP,lz;function pPe(){if(lz)return NP;lz=1;var t=xi(),e=_i(),r=Yu(),n=VH();return NP=function(i,s){(!s||typeof i!="string")&&e(i);var a=n(i);return r(e(a!==void 0?t(a,i):i))},NP}var uz;function vPe(){if(uz)return oz;uz=1;var t=nn(),e=xi(),r=ba(),n=_i(),i=Yu(),s=pPe(),a=UH(),o=Ca(),u=Kf(),c=jH(),f=Qf(),g=!u&&!c("flatMap",function(){}),m=!u&&!g&&f("flatMap",TypeError),v=u||g||m,w=a(function(){for(var y=this.iterator,b=this.mapper,x,_;;){if(_=this.inner)try{if(x=n(e(_.next,_.iterator)),!x.done)return x.value;this.inner=null}catch(T){o(y,"throw",T)}if(x=n(e(this.next,y)),this.done=!!x.done)return;try{this.inner=s(b(x.value,this.counter++),!1)}catch(T){o(y,"throw",T)}}});return t({target:"Iterator",proto:!0,real:!0,forced:v},{flatMap:function(b){n(this);try{r(b)}catch(x){o(this,"throw",x)}return m?e(m,this,b):new w(i(this),{mapper:b,inner:null})}}),oz}var cz;function wPe(){return cz||(cz=1,vPe()),az}wPe();function yPe(t,e,r){SPe(t,e),e.set(t,r)}function SPe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function eg(t,e,r){return(e=bPe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function bPe(t){var e=CPe(t,"string");return typeof e=="symbol"?e:e+""}function CPe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function hz(t,e){return t.get(Qee(t,e))}function Cx(t,e,r){return t.set(Qee(t,e),r),r}function Qee(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var tg=new WeakMap;class pu{constructor(e,r,n,i,s,a){eg(this,"row",void 0),eg(this,"col",void 0),eg(this,"rowspan",void 0),eg(this,"colspan",void 0),eg(this,"removed",!1),eg(this,"cellCoordsFactory",void 0),eg(this,"cellRangeFactory",void 0),yPe(this,tg,null),this.row=e,this.col=r,this.rowspan=n,this.colspan=i,this.cellCoordsFactory=s,this.cellRangeFactory=a}static NEGATIVE_VALUES_WARNING(e){let{row:r,col:n,rowspan:i,colspan:s}=e;return Dr`The merged cell declared with {row: ${r}, col: ${n},\x20
      rowspan: ${i}, colspan: ${s}} contains negative values, which is\x20
      not supported. It will not be added to the collection.`}static IS_OUT_OF_BOUNDS_WARNING(e){let{row:r,col:n}=e;return Dr`The merged cell declared at [${r}, ${n}] is positioned\x20
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`}static IS_SINGLE_CELL(e){let{row:r,col:n}=e;return Dr`The merged cell declared at [${r}, ${n}] has both "rowspan"\x20
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`}static ZERO_SPAN_WARNING(e){let{row:r,col:n}=e;return Dr`The merged cell declared at [${r}, ${n}] has "rowspan"\x20
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`}static containsNegativeValues(e){let{row:r,col:n,rowspan:i,colspan:s}=e;return r<0||n<0||i<0||s<0}static isSingleCell(e){let{rowspan:r,colspan:n}=e;return n===1&&r===1}static containsZeroSpan(e){let{rowspan:r,colspan:n}=e;return n===0||r===0}static isOutOfBounds(e,r,n){return e.row<0||e.col<0||e.row>=r||e.row+e.rowspan-1>=r||e.col>=n||e.col+e.colspan-1>=n}normalize(e){const r=e.countRows(),n=e.countCols();this.row<0?this.row=0:this.row>r-1&&(this.row=r-1),this.col<0?this.col=0:this.col>n-1&&(this.col=n-1),this.row+this.rowspan>r-1&&(this.rowspan=r-this.row),this.col+this.colspan>n-1&&(this.colspan=n-this.col),Cx(tg,this,null)}includes(e,r){return this.row<=e&&this.col<=r&&this.row+this.rowspan-1>=e&&this.col+this.colspan-1>=r}includesHorizontally(e){return this.col<=e&&this.col+this.colspan-1>=e}includesVertically(e){return this.row<=e&&this.row+this.rowspan-1>=e}shift(e,r){const n=e[0]||e[1],i=r+Math.abs(e[0]||e[1])-1,s=e[0]?"colspan":"rowspan",a=e[0]?"col":"row",o=Math.min(r,i),u=Math.max(r,i),c=this[a],f=this[a]+this[s]-1;if(c>=r&&(this[a]+=n),n>0)r<=f&&r>c&&(this[s]+=n);else if(n<0){if(o<=c&&u>=f)return this.removed=!0,Cx(tg,this,null),!1;if(c>=o&&c<=u){const g=u-c+1,m=Math.abs(n)-g;this[a]-=m+n,this[s]-=g}else if(c<=o&&f>=u)this[s]+=n;else if(c<=o&&f>=o&&f<u){const g=f-o+1;this[s]-=g}}return Cx(tg,this,null),!0}isFarther(e,r){return e?r==="down"?e.row+e.rowspan-1<this.row+this.rowspan-1:r==="up"?e.row>this.row:r==="right"?e.col+e.colspan-1<this.col+this.colspan-1:r==="left"?e.col>this.col:null:!0}getLastRow(){return this.row+this.rowspan-1}getLastColumn(){return this.col+this.colspan-1}getRange(){return hz(tg,this)||Cx(tg,this,this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))),hz(tg,this)}}function xPe(t,e){EPe(t,e),e.add(t)}function EPe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xx(t,e,r){return(e=_Pe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _Pe(t){var e=RPe(t,"string");return typeof e=="symbol"?e:e+""}function RPe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function rg(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var tf=new WeakSet;class k_{constructor(e){xPe(this,tf),xx(this,"plugin",void 0),xx(this,"mergedCells",[]),xx(this,"mergedCellsMatrix",new Map),xx(this,"hot",void 0),this.plugin=e,this.hot=e.hot}static IS_OVERLAPPING_WARNING(e){let{row:r,col:n}=e;return Dr`The merged cell declared at [${r}, ${n}], overlaps\x20
      with the other declared merged cell. The overlapping merged cell was not added to the table, please\x20
      fix your setup.`}get(e,r){var n;return this.mergedCellsMatrix.has(e)&&(n=this.mergedCellsMatrix.get(e).get(r))!==null&&n!==void 0?n:!1}getByRange(e){const{row:r,col:n}=e.getTopStartCorner(),{row:i,col:s}=e.getBottomEndCorner(),a=this.mergedCells.length;let o=!1;for(let u=0;u<a;u++){const c=this.mergedCells[u],{row:f,col:g,rowspan:m,colspan:v}=c;if(f>=r&&f+m-1<=i&&g>=n&&g+v-1<=s){o=c;break}}return o}filterOverlappingMergeCells(e){const r=new Set;return this.mergedCells.forEach(i=>{const{row:s,col:a,colspan:o,rowspan:u}=i;for(let c=s;c<s+u;c++)for(let f=a;f<a+o;f++)r.add(`r${c},c${f}`)}),e.filter(i=>{const{row:s,col:a,colspan:o,rowspan:u}=i,c=new Set;let f=!1;for(let g=s;g<s+u;g++){for(let m=a;m<a+o;m++){const v=`r${g},c${m}`;if(r.has(v)){br(k_.IS_OVERLAPPING_WARNING(i)),f=!0;break}c.add(v)}if(f)break}return f||r.add(...c),!f})}getWithinRange(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{row:n,col:i}=e.getTopStartCorner(),{row:s,col:a}=e.getBottomEndCorner(),o=[];for(let u=n;u<=s;u++)for(let c=i;c<=a;c++){const f=this.get(u,c);f&&(r||!r&&f.row===u&&f.col===c)&&o.push(f)}return o}add(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const n=e.row,i=e.col,s=e.rowspan,a=e.colspan,o=new pu(n,i,s,a,this.hot._createCellCoords,this.hot._createCellRange),u=this.get(n,i),c=r?!1:this.isOverlapping(o);return!u&&!c?(this.hot&&o.normalize(this.hot),this.mergedCells.push(o),rg(tf,this,fz).call(this,o),o):(c&&br(k_.IS_OVERLAPPING_WARNING(o)),!1)}remove(e,r){const n=this.get(e,r),i=n?this.mergedCells.indexOf(n):-1;return n&&i!==-1?(this.mergedCells.splice(i,1),rg(tf,this,TPe).call(this,n),n):!1}clear(){he(this.mergedCells,e=>{let{row:r,col:n,rowspan:i,colspan:s}=e;ct(r,r+i,a=>{ct(n,n+s,o=>{const u=this.hot.getCell(a,o);u&&(u.removeAttribute("rowspan"),u.removeAttribute("colspan"),u.style.display="")})})}),this.mergedCells.length=0,this.mergedCellsMatrix=new Map}isOverlapping(e){const r=e.getRange();for(let n=0;n<this.mergedCells.length;n++)if(this.mergedCells[n].getRange().overlaps(r))return!0;return!1}isFirstRenderableMergedCell(e,r){const n=this.get(e,r);if(!n)return!1;const{row:i,col:s,rowspan:a,colspan:o}=n,u=this.hot.view.getActiveOverlayName(),c=["top","top_inline_start_corner"].includes(u)?0:this.hot.getFirstRenderedVisibleRow(),f=["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(u)?0:this.hot.getFirstRenderedVisibleColumn(),g=ir(c,i,i+a-1),m=ir(f,s,s+o-1);return this.hot.rowIndexMapper.getNearestNotHiddenIndex(g,1)===e&&this.hot.columnIndexMapper.getNearestNotHiddenIndex(m,1)===r}getFirstRenderableCoords(e,r){const n=this.get(e,r);if(!n||this.isFirstRenderableMergedCell(e,r))return this.hot._createCellCoords(e,r);const i=this.hot.rowIndexMapper.getNearestNotHiddenIndex(n.row,1),s=this.hot.columnIndexMapper.getNearestNotHiddenIndex(n.col,1);return this.hot._createCellCoords(i,s)}getStartMostColumnIndex(e,r){const n=rg(tf,this,Ex).call(this,e,"col",-1);let i=r;for(let s=0;s<n.length;s++)if(n[s]<=r){i=n[s];break}return i}getEndMostColumnIndex(e,r){const n=rg(tf,this,Ex).call(this,e,"col",1);let i=r;for(let s=0;s<n.length;s++)if(n[s]>=r){i=n[s];break}return i}getTopMostRowIndex(e,r){const n=rg(tf,this,Ex).call(this,e,"row",-1);let i=r;for(let s=0;s<n.length;s++)if(n[s]<=r){i=n[s];break}return i}getBottomMostRowIndex(e,r){const n=rg(tf,this,Ex).call(this,e,"row",1);let i=r;for(let s=0;s<n.length;s++)if(n[s]>=r){i=n[s];break}return i}shiftCollections(e,r,n){const i=[0,0];switch(e){case"right":i[0]+=n;break;case"left":i[0]-=n;break;case"down":i[1]+=n;break;case"up":i[1]-=n;break}const s=[];this.mergedCells.forEach(a=>{a.shift(i,r),a.removed&&s.push(a)}),s.forEach(a=>{this.mergedCells.splice(this.mergedCells.indexOf(a),1)}),this.mergedCellsMatrix.clear(),this.mergedCells.forEach(a=>{rg(tf,this,fz).call(this,a)})}}function Ex(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const n=new Map,i=r===1?t.getTopStartCorner():t.getBottomEndCorner(),s=r===1?t.getBottomEndCorner():t.getTopStartCorner();for(let a=i.row;r===1?a<=s.row:a>=s.row;a+=r)for(let o=i.col;r===1?o<=s.col:o>=s.col;o+=r){const u=e==="row"?a:o,c=this.get(a,o);let f=u;c&&(f=r===1?c[e]+c[`${e}span`]-1:c[e]),n.has(u)||n.set(u,new Set),n.get(u).add(f)}return Array.from(new Set(Array.from(n.entries()).filter(a=>{let[,o]=a;return o.size===1}).flatMap(a=>{let[,o]=a;return Array.from(o)})))}function fz(t){for(let e=t.row;e<t.row+t.rowspan;e++)for(let r=t.col;r<t.col+t.colspan;r++)this.mergedCellsMatrix.has(e)||this.mergedCellsMatrix.set(e,new Map),this.mergedCellsMatrix.get(e).set(r,t)}function TPe(t){for(let e=t.row;e<t.row+t.rowspan;e++)for(let r=t.col;r<t.col+t.colspan;r++)this.mergedCellsMatrix.get(e).delete(r)}function HP(t,e,r){return(e=MPe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function MPe(t){var e=APe(t,"string");return typeof e=="symbol"?e:e+""}function APe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class OPe{constructor(e){HP(this,"plugin",void 0),HP(this,"mergedCellsCollection",void 0),HP(this,"currentFillData",null),this.plugin=e,this.mergedCellsCollection=this.plugin.mergedCellsCollection}getDirection(e,r){let n=null;return r[0]===e[0]&&r[1]===e[1]&&r[3]===e[3]?n="down":r[2]===e[2]&&r[1]===e[1]&&r[3]===e[3]?n="up":r[1]===e[1]&&r[2]===e[2]?n="right":n="left",n}snapDragArea(e,r,n,i){const s=r.slice(0),a=this.getAutofillSize(e,r,n),[o,u,c,f]=e,m=["up","down"].indexOf(n)>-1?c-o+1:f-u+1,v=Math.floor(a/m)*m,w=a-v,y=this.getFarthestCollection(e,r,n,i);if(y){if(n==="down"){const b=y.row+y.rowspan-o-w;s[2]+b>=this.plugin.hot.countRows()?s[2]-=w:s[2]+=w?b:0}else if(n==="right"){const b=y.col+y.colspan-u-w;s[3]+b>=this.plugin.hot.countCols()?s[3]-=w:s[3]+=w?b:0}else if(n==="up"){const b=c-w-y.row+1;s[0]+b<0?s[0]+=w:s[0]-=w?b:0}else if(n==="left"){const b=f-w-y.col+1;s[1]+b<0?s[1]+=w:s[1]-=w?b:0}}return this.updateCurrentFillCache({baseArea:e,dragDirection:n,foundMergedCells:i,fillSize:a,dragArea:s,cycleLength:m}),s}updateCurrentFillCache(e){this.currentFillData||(this.currentFillData={}),oi(this.currentFillData,e)}getAutofillSize(e,r,n){const[i,s,a,o]=e,[u,c,f,g]=r;switch(n){case"up":return i-u;case"down":return f-a;case"left":return s-c;case"right":return g-o;default:return null}}getDragArea(e,r,n){const[i,s,a,o]=e,[u,c,f,g]=r;switch(n){case"up":return[u,c,i-1,o];case"down":{const m=this.mergedCellsCollection.get(f,o),v=m?m.rowspan-1:0;return[a+1,s,f+v,o]}case"left":return[u,c,a,s-1];case"right":{const m=this.mergedCellsCollection.get(f,o),v=m?m.colspan-1:0;return[i,o+v,f,g]}default:return null}}getFarthestCollection(e,r,n,i){const[s,a,o,u]=e,c=["up","down"].indexOf(n)>-1,f=c?o:u,g=c?s:a,m=this.getAutofillSize(e,r,n),v=c?o-s+1:u-a+1,w=Math.floor(m/v)*v,y=m-w;let b=null,x=null,_=null;switch(n){case"up":b="includesVertically",_=f-y+1;break;case"left":b="includesHorizontally",_=f-y+1;break;case"down":b="includesVertically",_=g+y-1;break;case"right":b="includesHorizontally",_=g+y-1;break}return he(i,T=>{T[b](_)&&T.isFarther(x,n)&&(x=T)}),x}recreateAfterDataPopulation(e){if(!this.currentFillData)return;const r=this.getRangeFromChanges(e),n=this.currentFillData.foundMergedCells,i=this.currentFillData.dragDirection,s=(c,f)=>{switch(i){case"up":return c.row-f>=r.from.row;case"down":return c.row+c.rowspan-1+f<=r.to.row;case"left":return c.col-f>=r.from.column;case"right":return c.col+c.colspan-1+f<=r.to.column;default:return null}};let a=0,o=null,u=1;do for(let c=0;c<n.length;c+=1){if(o=n[c],a=u*this.currentFillData.cycleLength,s(o,a))switch(i){case"up":this.plugin.mergedCellsCollection.add({row:o.row-a,rowspan:o.rowspan,col:o.col,colspan:o.colspan},!0);break;case"down":this.plugin.mergedCellsCollection.add({row:o.row+a,rowspan:o.rowspan,col:o.col,colspan:o.colspan},!0);break;case"left":this.plugin.mergedCellsCollection.add({row:o.row,rowspan:o.rowspan,col:o.col-a,colspan:o.colspan},!0);break;case"right":this.plugin.mergedCellsCollection.add({row:o.row,rowspan:o.rowspan,col:o.col+a,colspan:o.colspan},!0);break}c===n.length-1&&(u+=1)}while(s(o,a));this.currentFillData=null,this.plugin.hot.render(),n.length>0&&this.plugin.ifChromeForceRepaint()}getRangeFromChanges(e){const r={min:null,max:null},n={min:null,max:null};return he(e,i=>{const s=i[0],a=this.plugin.hot.propToCol(i[1]);(r.min===null||s<r.min)&&(r.min=s),(r.max===null||s>r.max)&&(r.max=s),(n.min===null||a<n.min)&&(n.min=a),(n.max===null||a>n.max)&&(n.max=a)}),{from:{row:r.min,column:n.min},to:{row:r.max,column:n.max}}}dragAreaOverlapsCollections(e,r,n){const i=this.getDragArea(e,r,n),[s,a,o,u]=i,c=this.plugin.hot._createCellCoords(s,a),f=this.plugin.hot._createCellCoords(o,u),g=this.plugin.hot._createCellRange(c,c,f);if(this.mergedCellsCollection.getWithinRange(g,!0).length===0)return!1;const v=this.mergedCellsCollection.getWithinRange(g,!1);return v.length===0?!0:n==="up"||n==="down"?!v.every(w=>{let{colspan:y}=w;return y===g.getWidth()}):!v.every(w=>{let{rowspan:y}=w;return y===g.getHeight()})}}function FP(t,e,r){return(e=kPe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function kPe(t){var e=DPe(t,"string");return typeof e=="symbol"?e:e+""}function DPe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class PPe{constructor(e){FP(this,"plugin",void 0),FP(this,"hot",void 0),FP(this,"fullySelectedMergedCellClassName","fullySelectedMergedCell"),this.plugin=e,this.hot=e.hot}getSelectedMergedCellClassName(e,r,n,i){const s=Math.min(n[0],n[2]),a=Math.min(n[1],n[3]),o=Math.max(n[0],n[2]),u=Math.max(n[1],n[3]);if(i===void 0||!this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(e,r))return;const f=this.plugin.mergedCellsCollection.get(e,r);if(!f)return;const g=f.getLastRow(),m=f.getLastColumn();if(s<=f.row&&a<=f.col&&o>=g&&u>=m)return`${this.fullySelectedMergedCellClassName}-${i}`;if(this.isMergeCellFullySelected(f,this.plugin.hot.getSelectedRange()))return`${this.fullySelectedMergedCellClassName}-multiple`}isMergeCellFullySelected(e,r){const n=[];if(!r||!e)return!1;for(let i=0;i<e.rowspan;i+=1)for(let s=0;s<e.colspan;s+=1)n.push(this.hot._createCellCoords(e.row+i,e.col+s));for(let i=0;i<n.length;i+=1){const s=[];for(let a=0;a<r.length;a+=1)s[a]=r[a].includes(n[i]);if(!s.includes(!0))return!1}return!0}getSelectedMergedCellClassNameToRemove(){const e=[];for(let r=0;r<=7;r+=1)e.push(`${this.fullySelectedMergedCellClassName}-${r}`);return e.push(`${this.fullySelectedMergedCellClassName}-multiple`),e}}function IPe(t){return{key:"mergeCells",name(){const e=this.getSelectedLast();if(e){const r=t.mergedCellsCollection.get(e[0],e[1]);if(r.row===e[0]&&r.col===e[1]&&r.row+r.rowspan-1===e[2]&&r.col+r.colspan-1===e[3])return this.getTranslatedPhrase(OL)}return this.getTranslatedPhrase(AL)},callback(){const e=this.getSelectedRangeLast();if(!e)return;e.setDirection(this.isRtl()?"NE-SW":"NW-SE");const{from:r,to:n}=e;t.toggleMerge(e),this.selectCell(r.row,r.col,n.row,n.col,!1)},disabled(){const e=this.getSelectedLast();return e?pu.isSingleCell({row:e[0],col:e[1],rowspan:e[2]-e[0]+1,colspan:e[3]-e[1]+1})||this.selection.isSelectedByCorner():!0},hidden:!1}}function t1(t,e,r){return(e=NPe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function NPe(t){var e=HPe(t,"string");return typeof e=="symbol"?e:e+""}function HPe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class dz{constructor(e){t1(this,"data",void 0),t1(this,"next",null),t1(this,"prev",null),this.data=e}}class _x{constructor(){t1(this,"first",null),t1(this,"last",null)}push(e){const r=new dz(e);if(this.first===null)this.first=r,this.last=r;else{const n=this.last;this.last=r,r.prev=n,n.next=r}return r}unshift(e){const r=new dz(e);if(this.first===null)this.first=r,this.last=r;else{const n=this.first;this.first=r,r.next=n,n.prev=r}}inorder(e){let r=this.first;for(;r;){const n=e(r);if(r===this.last||n===!0)break;r=r.next}}remove(e){if(this.first===null)return!1;let r=this.first,n,i;for(;r;){if(r.data===e)return n=r.next,i=r.prev,n&&(n.prev=i),i&&(i.next=n),r===this.first&&(this.first=n),r===this.last&&(this.last=i),!0;r=r.next}return!1}hasCycle(){let e=this.first,r=this.first;for(;;){if(e===null||(e=e.next,e===null))return!1;if(e=e.next,r=r.next,e===r)return!0}}pop(){if(this.last===null)return null;const e=this.last;return this.last=this.last.prev,e}shift(){if(this.first===null)return null;const e=this.first;return this.first=this.first.next,e}recursiveReverse(){function e(n,i){i&&(e(i,i.next),i.next=n)}if(!this.first)return;e(this.first,this.first.next),this.first.next=null;const r=this.first;this.first=this.last,this.last=r}reverse(){if(!this.first||!this.first.next)return;let e=this.first.next,r=this.first,n;for(;e;)n=e.next,e.next=r,r.prev=e,r=e,e=n;this.first.next=null,this.last.prev=null,n=this.first,this.first=r,this.last=n}}function FPe(t,e){Zee(t,e),e.add(t)}function ng(t,e,r){Zee(t,e),e.set(t,r)}function Zee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Mr(t,e){return t.get(D_(t,e))}function Na(t,e,r){return t.set(D_(t,e),r),r}function D_(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var ru=new WeakMap,nu=new WeakMap,iu=new WeakMap,su=new WeakMap,zN=new WeakMap,Rx=new WeakMap,Tx=new WeakMap,LP=new WeakSet;class LPe{constructor(e){let{mergedCellsGetter:r,rowIndexMapper:n,columnIndexMapper:i}=e;FPe(this,LP),ng(this,ru,new _x),ng(this,nu,new _x),ng(this,iu,null),ng(this,su,null),ng(this,zN,null),ng(this,Rx,null),ng(this,Tx,null),Na(zN,this,r),Na(Rx,this,n),Na(Tx,this,i)}getCurrentVerticalNode(){return Mr(su,this).data}getFirstVerticalNode(){return Mr(nu,this).first.data}getNextVerticalNode(){return Mr(su,this).next.data}getPrevVerticalNode(){return Mr(su,this).prev.data}getCurrentHorizontalNode(){return Mr(iu,this).data}getFirstHorizontalNode(){return Mr(ru,this).first.data}getNextHorizontalNode(){return Mr(iu,this).next.data}getPrevHorizontalNode(){return Mr(iu,this).prev.data}setPrevNodeAsActive(){Na(su,this,Mr(su,this).prev),Na(iu,this,Mr(iu,this).prev)}setNextNodeAsActive(){Na(su,this,Mr(su,this).next),Na(iu,this,Mr(iu,this).next)}buildFocusOrder(e){const r=e.getTopStartCorner(),n=e.getBottomEndCorner(),i=new WeakSet;Na(ru,this,new _x);for(let a=r.row;a<=n.row;a++)if(!Mr(Rx,this).isHidden(a))for(let o=r.col;o<=n.col;o++){if(Mr(Tx,this).isHidden(o))continue;const u=D_(LP,this,gz).call(this,e,Mr(ru,this),i,a,o);u&&Na(iu,this,u)}Mr(ru,this).first&&(Mr(ru,this).first.prev=Mr(ru,this).last,Mr(ru,this).last.next=Mr(ru,this).first);const s=new WeakSet;Na(nu,this,new _x);for(let a=r.col;a<=n.col;a++)if(!Mr(Tx,this).isHidden(a))for(let o=r.row;o<=n.row;o++){if(Mr(Rx,this).isHidden(o))continue;const u=D_(LP,this,gz).call(this,e,Mr(nu,this),s,o,a);u&&Na(su,this,u)}Mr(nu,this).first&&(Mr(nu,this).first.prev=Mr(nu,this).last,Mr(nu,this).last.next=Mr(nu,this).first)}setActiveNode(e,r){return Mr(ru,this).inorder(n=>{const{rowStart:i,rowEnd:s,colStart:a,colEnd:o}=n.data;if(e>=i&&e<=s&&r>=a&&r<=o)return Na(iu,this,n),!1}),Mr(nu,this).inorder(n=>{const{rowStart:i,rowEnd:s,colStart:a,colEnd:o}=n.data;if(e>=i&&e<=s&&r>=a&&r<=o)return Na(su,this,n),!1}),this}}function gz(t,e,r,n,i){const s=t.getTopStartCorner(),a=t.getBottomEndCorner(),o=t.highlight.clone().normalize(),u=Mr(zN,this).call(this,n,i);if(u&&r.has(u))return null;const c={colStart:i,colEnd:i,rowStart:n,rowEnd:n};if(u){if(r.add(u),u.row<s.row||u.row+u.rowspan-1>a.row||u.col<s.col||u.col+u.colspan-1>a.col)return null;c.colStart=u.col,c.colEnd=u.col+u.colspan-1,c.rowStart=u.row,c.rowEnd=u.row+u.rowspan-1}const f=e.push(c);return n===o.row&&i===o.col||u&&o.row>=u.row&&o.row<=u.row+u.rowspan-1&&o.col>=u.col&&o.col<=u.col+u.colspan-1?f:null}function Jee(t,e,r){const{rowIndexMapper:n,stylesHandler:i}=t,s=i.getDefaultRowHeight();let a=0;for(let u=e;u<e+r;u++)if(!n.isHidden(u)){var o;a+=(o=t.getRowHeight(u))!==null&&o!==void 0?o:s,u===0&&!i.isClassicTheme()&&(a+=1)}return a}function BPe(t){const{hot:e}=t,{rowIndexMapper:r,columnIndexMapper:n}=e,i=new Map;function s(){}function a(o,u,c){const f=t.mergedCellsCollection.get(u,c);if(!Vt(f)){o.removeAttribute("rowspan"),o.removeAttribute("colspan"),Mp()&&i.has(u)&&!e.getSettings().rowHeaders&&(o.style.height=`${i.get(u)}px`,i.delete(u)),o.style.display="";return}const{row:g,col:m,colspan:v,rowspan:w}=f,[y,b]=t.translateMergedCellToRenderable(g,w,m,v),x=t.getSetting("virtualized");if(Mp()&&m===0&&!e.getSettings().rowHeaders){const H=Jee(e,g,w);i.set(u,H/w)}const _=r.getRenderableFromVisualIndex(u),T=n.getRenderableFromVisualIndex(c),D=y-_+1,P=b-T+1;let O=r.getNearestNotHiddenIndex(g,1),A=n.getNearestNotHiddenIndex(m,1);if(x){const H=e.view.getActiveOverlayName();["top","top_inline_start_corner"].includes(H)||(O=Math.max(O,e.getFirstRenderedVisibleRow())),["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(H)||(A=Math.max(A,e.getFirstRenderedVisibleColumn()))}const W=Math.min(w,D),L=Math.min(v,P);O===u&&A===c?(o.setAttribute("rowspan",W),o.setAttribute("colspan",L)):(o.removeAttribute("rowspan"),o.removeAttribute("colspan"),o.style.display="none")}return{before:s,after:a}}function VPe(t,e){ete(t,e),e.add(t)}function Mx(t,e,r){ete(t,e),e.set(t,r)}function ete(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function BP(t,e,r){return(e=WPe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function WPe(t){var e=$Pe(t,"string");return typeof e=="symbol"?e:e+""}function $Pe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function L1(t,e,r){return t.set(Nr(t,e),r),r}function tn(t,e){return t.get(Nr(t,e))}function Nr(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}Je.getSingleton().register("beforeMergeCells");Je.getSingleton().register("afterMergeCells");Je.getSingleton().register("beforeUnmergeCells");Je.getSingleton().register("afterUnmergeCells");const GN="mergeCells",UPe=150,mz=GN;var Ho=new WeakMap,Lo=new WeakMap,Ru=new WeakMap,pz=new WeakMap,$r=new WeakSet;class jPe extends ur{constructor(){super(...arguments),VPe(this,$r),BP(this,"mergedCellsCollection",null),BP(this,"autofillCalculations",null),BP(this,"selectionCalculations",null),Mx(this,Ho,null),Mx(this,Lo,{row:0,col:0}),Mx(this,Ru,new LPe({mergedCellsGetter:(e,r)=>this.mergedCellsCollection.get(e,r),rowIndexMapper:this.hot.rowIndexMapper,columnIndexMapper:this.hot.columnIndexMapper})),Mx(this,pz,BPe(this))}static get PLUGIN_KEY(){return GN}static get PLUGIN_PRIORITY(){return UPe}static get DEFAULT_SETTINGS(){return{[SJ]:"cells",virtualized:!1,cells:[]}}isEnabled(){return!!this.hot.getSettings()[GN]}enablePlugin(){var e=this;this.enabled||(this.mergedCellsCollection=new k_(this),this.autofillCalculations=new OPe(this),this.selectionCalculations=new PPe(this),this.addHook("afterInit",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Nr($r,e,YPe).call(e,...n)}),this.addHook("modifyTransformFocus",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Nr($r,e,GPe).call(e,...n)}),this.addHook("modifyTransformStart",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Nr($r,e,qPe).call(e,...n)}),this.addHook("modifyTransformEnd",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Nr($r,e,KPe).call(e,...n)}),this.addHook("beforeSelectionHighlightSet",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Nr($r,e,XPe).call(e,...n)}),this.addHook("beforeSetRangeStart",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Nr($r,e,wz).call(e,...n)}),this.addHook("beforeSetRangeStartOnly",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Nr($r,e,wz).call(e,...n)}),this.addHook("beforeSelectionFocusSet",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Nr($r,e,ZPe).call(e,...n)}),this.addHook("afterSelectionFocusSet",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Nr($r,e,JPe).call(e,...n)}),this.addHook("afterSelectionEnd",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Nr($r,e,eIe).call(e,...n)}),this.addHook("modifyGetCellCoords",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Nr($r,e,vz).call(e,...n)}),this.addHook("modifyGetCoordsElement",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Nr($r,e,vz).call(e,...n)}),this.addHook("afterIsMultipleSelection",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Nr($r,e,zPe).call(e,...n)}),this.addHook("afterRenderer",function(){return tn(pz,e).after(...arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Nr($r,e,QPe).call(e,...n)}),this.addHook("afterGetCellMeta",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Nr($r,e,tIe).call(e,...n)}),this.addHook("afterViewportRowCalculatorOverride",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Nr($r,e,rIe).call(e,...n)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Nr($r,e,nIe).call(e,...n)}),this.addHook("modifyAutofillRange",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Nr($r,e,iIe).call(e,...n)}),this.addHook("afterCreateCol",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Nr($r,e,sIe).call(e,...n)}),this.addHook("afterRemoveCol",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Nr($r,e,aIe).call(e,...n)}),this.addHook("afterCreateRow",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Nr($r,e,oIe).call(e,...n)}),this.addHook("afterRemoveRow",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Nr($r,e,lIe).call(e,...n)}),this.addHook("afterChange",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Nr($r,e,uIe).call(e,...n)}),this.addHook("beforeDrawBorders",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Nr($r,e,cIe).call(e,...n)}),this.addHook("afterDrawSelection",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Nr($r,e,hIe).call(e,...n)}),this.addHook("beforeRemoveCellClassNames",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Nr($r,e,fIe).call(e,...n)}),this.addHook("beforeBeginEditing",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Nr($r,e,dIe).call(e,...n)}),this.addHook("modifyRowHeightByOverlayName",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Nr($r,e,gIe).call(e,...n)}),this.addHook("beforeUndoStackChange",(r,n)=>{if(n==="MergeCells")return!1}),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(),super.updatePlugin()}ifChromeForceRepaint(){if(!SF())return;const e=[];let r=[];this.mergedCellsCollection.mergedCells.forEach(n=>{const{row:i,rowspan:s}=n;for(let a=i+1;a<i+s;a++)r.push(a)}),r=[...new Set(r)],r.forEach(n=>{const i=this.hot.rowIndexMapper.getRenderableFromVisualIndex(n);this.hot.view._wt.wtOverlays.getOverlays(!0).map(s=>s?.name==="master"?s:s.clone.wtTable).forEach(s=>{const a=s.getRow(i);a&&(a.style.background=x1(a,"backgroundColor").replace(")",", 0.99)"),e.push(a))})}),this.hot._registerTimeout(()=>{e.forEach(n=>{var i;n.style.background=(i=x1(n,"backgroundColor"))===null||i===void 0?void 0:i.replace(", 0.99)",")")})},1)}validateSetting(e){return e?pu.containsNegativeValues(e)?(br(pu.NEGATIVE_VALUES_WARNING(e)),!1):pu.isOutOfBounds(e,this.hot.countRows(),this.hot.countCols())?(br(pu.IS_OUT_OF_BOUNDS_WARNING(e)),!1):pu.isSingleCell(e)?(br(pu.IS_SINGLE_CELL(e)),!1):pu.containsZeroSpan(e)?(br(pu.ZERO_SPAN_WARNING(e)),!1):!0:!1}generateFromSettings(){const e=this.getSetting("cells").filter(i=>this.validateSetting(i)),r=this.mergedCellsCollection.filterOverlappingMergeCells(e),n=[];r.forEach(i=>{const{row:s,col:a,rowspan:o,colspan:u}=i,c=this.hot._createCellCoords(s,a),f=this.hot._createCellCoords(s+o-1,a+u-1),g=this.hot._createCellRange(c,c,f);this.mergeRange(g,!0,!0);for(let m=s;m<s+o;m++)for(let v=a;v<a+u;v++)(m!==s||v!==a)&&n.push([m,v,null])}),n.length!==0&&this.hot.setDataAtCell(n,void 0,void 0,this.pluginName)}clearCollections(){this.mergedCellsCollection.clear()}canMergeRange(e){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1)?!0:this.validateSetting(e)}mergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;e.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");const{from:r,to:n}=e;this.unmergeRange(e,!0),this.mergeRange(e),this.hot.selectCell(r.row,r.col,n.row,n.col,!1)}unmergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;const{from:r,to:n}=e;this.unmergeRange(e,!0),this.hot.selectCell(r.row,r.col,n.row,n.col,!1)}mergeRange(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=e.getTopStartCorner(),s=e.getBottomEndCorner(),a={row:i.row,col:i.col,rowspan:s.row-i.row+1,colspan:s.col-i.col+1},o=[];let u=null;return this.canMergeRange(a,r)?(this.hot.runHooks("beforeMergeCells",e,r),ct(0,a.rowspan-1,f=>{ct(0,a.colspan-1,g=>{let m=null;o[f]||(o[f]=[]),f===0&&g===0?m=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(a.row),this.hot.toPhysicalColumn(a.col)):this.hot.setCellMeta(a.row+f,a.col+g,"hidden",!0),o[f][g]=m})}),this.hot.setCellMeta(a.row,a.col,"spanned",!0),this.mergedCellsCollection.add(a,r)?(n?u=[a.row,a.col,o]:this.hot.populateFromArray(a.row,a.col,o,void 0,void 0,this.pluginName),r||this.ifChromeForceRepaint(),this.hot.runHooks("afterMergeCells",e,a,r),u):!0):!1}unmergeRange(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const n=this.mergedCellsCollection.getWithinRange(e);n.length!==0&&(this.hot.runHooks("beforeUnmergeCells",e,r),he(n,i=>{this.mergedCellsCollection.remove(i.row,i.col),ct(0,i.rowspan-1,s=>{ct(0,i.colspan-1,a=>{this.hot.removeCellMeta(i.row+s,i.col+a,"hidden"),this.hot.removeCellMeta(i.row+s,i.col+a,"copyable")})}),this.hot.removeCellMeta(i.row,i.col,"spanned")}),this.hot.runHooks("afterUnmergeCells",e,r),this.hot.render())}toggleMerge(e){const{from:r,to:n}=e.clone().normalize(),i=this.mergedCellsCollection.get(r.row,r.col);i.row===r.row&&i.col===r.col&&i.row+i.rowspan-1===n.row&&i.col+i.colspan-1===n.col?this.unmergeRange(e):this.mergeSelection(e)}merge(e,r,n,i){const s=this.hot._createCellCoords(e,r),a=this.hot._createCellCoords(n,i);this.mergeRange(this.hot._createCellRange(s,s,a))}unmerge(e,r,n,i){const s=this.hot._createCellCoords(e,r),a=this.hot._createCellCoords(n,i);this.unmergeRange(this.hot._createCellRange(s,s,a))}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control","m"]],callback:()=>{const n=this.hot.getSelectedRangeLast();n&&!n.isSingleHeader()&&(this.toggleMerge(n),this.hot.render())},runOnlyIf:n=>!n.altKey,group:mz})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(mz)}modifyViewportRowStart(e,r){const n=this.hot.rowIndexMapper,i=n.getVisualFromRenderableIndex(e.startRow);for(let s=0;s<r;s+=1){const a=this.mergedCellsCollection.get(i,s);if(Vt(a)){const o=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(a.row,1));if(o<e.startRow){e.startRow=o,this.modifyViewportRowStart(e,r);return}}}}modifyViewportRowEnd(e,r){const n=this.hot.rowIndexMapper,i=n.getVisualFromRenderableIndex(e.endRow);for(let s=0;s<r;s+=1){const a=this.mergedCellsCollection.get(i,s);if(Vt(a)){const o=a.row+a.rowspan-1,u=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(o,-1));if(u>e.endRow){e.endRow=u,this.modifyViewportRowEnd(e,r);return}}}}modifyViewportColumnStart(e,r){const n=this.hot.columnIndexMapper,i=n.getVisualFromRenderableIndex(e.startColumn);for(let s=0;s<r;s+=1){const a=this.mergedCellsCollection.get(s,i);if(Vt(a)){const o=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(a.col,1));if(o<e.startColumn){e.startColumn=o,this.modifyViewportColumnStart(e,r);return}}}}modifyViewportColumnEnd(e,r){const n=this.hot.columnIndexMapper,i=n.getVisualFromRenderableIndex(e.endColumn);for(let s=0;s<r;s+=1){const a=this.mergedCellsCollection.get(s,i);if(Vt(a)){const o=a.col+a.colspan-1,u=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(o,-1));if(u>e.endColumn){e.endColumn=u,this.modifyViewportColumnEnd(e,r);return}}}}translateMergedCellToRenderable(e,r,n,i){const{rowIndexMapper:s,columnIndexMapper:a}=this.hot;let o,u;r===0?o=s.getNearestNotHiddenIndex(e,1):o=s.getNearestNotHiddenIndex(e+r-1,-1),i===0?u=a.getNearestNotHiddenIndex(n,1):u=a.getNearestNotHiddenIndex(n+i-1,-1);const c=e>=0?s.getRenderableFromVisualIndex(o):e,f=n>=0?a.getRenderableFromVisualIndex(u):n;return[c,f]}}function YPe(){this.generateFromSettings(),this.hot.render()}function zPe(t){if(t){const e=this.mergedCellsCollection.mergedCells,r=this.hot.getSelectedRangeLast(),n=r.getTopStartCorner(),i=r.getBottomEndCorner();for(let s=0;s<e.length;s+=1)if(n.row===e[s].row&&n.col===e[s].col&&i.row===e[s].row+e[s].rowspan-1&&i.col===e[s].col+e[s].colspan-1)return!1}return t}function GPe(t){tn(Lo,this).row=t.row,tn(Lo,this).col=t.col}function qPe(t){const e=this.hot.getSelectedRangeLast(),{highlight:r}=e,{columnIndexMapper:n,rowIndexMapper:i}=this.hot;tn(Ho,this)&&(i.getRenderableFromVisualIndex(tn(Ho,this).row)!==null&&(r.row=tn(Ho,this).row),n.getRenderableFromVisualIndex(tn(Ho,this).col)!==null&&(r.col=tn(Ho,this).col),L1(Ho,this,null));const s=this.mergedCellsCollection.get(r.row,r.col);if(!s)return;const a=s.col,o=s.col+s.colspan-1;if(t.col<0){const f=r.col>=a&&r.col<=o?a-1:o,g=n.getNearestNotHiddenIndex(f,-1);g===null?t.col=-this.hot.view.countRenderableColumnsInRange(0,r.col):t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(g,r.col)-1,1)}else if(t.col>0){const f=r.col>=a&&r.col<=o?o+1:a,g=n.getNearestNotHiddenIndex(f,1);g===null?t.col=this.hot.view.countRenderableColumnsInRange(r.col,this.hot.countCols()):t.col=Math.max(this.hot.view.countRenderableColumnsInRange(r.col,g)-1,1)}const u=s.row,c=s.row+s.rowspan-1;if(t.row<0){const f=r.row>=u&&r.row<=c?u-1:c,g=i.getNearestNotHiddenIndex(f,-1);g===null?t.row=-this.hot.view.countRenderableRowsInRange(0,r.row):t.row=-Math.max(this.hot.view.countRenderableRowsInRange(g,r.row)-1,1)}else if(t.row>0){const f=r.row>=u&&r.row<=c?c+1:u,g=i.getNearestNotHiddenIndex(f,1);g===null?t.row=this.hot.view.countRenderableRowsInRange(r.row,this.hot.countRows()):t.row=Math.max(this.hot.view.countRenderableRowsInRange(r.row,g)-1,1)}}function KPe(t){const e=this.hot.getSelectedRangeLast(),r=e.clone(),{to:n}=e,{columnIndexMapper:i,rowIndexMapper:s}=this.hot,a=(o,u)=>{r.expand(this.hot._createCellCoords(o,u));for(let c=0;c<this.mergedCellsCollection.mergedCells.length;c+=1)r.expandByRange(this.mergedCellsCollection.mergedCells[c].getRange())};if(t.col<0){let o=this.mergedCellsCollection.getStartMostColumnIndex(e,n.col)+t.col;a(n.row,o),e.getHorizontalDirection()==="E-W"&&r.getHorizontalDirection()==="E-W"&&(o=r.getTopStartCorner().col);const u=i.getNearestNotHiddenIndex(o,1);u!==null&&(t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(u,n.col)-1,1))}else if(t.col>0){let o=this.mergedCellsCollection.getEndMostColumnIndex(e,n.col)+t.col;a(n.row,o),e.getHorizontalDirection()==="W-E"&&r.getHorizontalDirection()==="W-E"&&(o=r.getBottomEndCorner().col);const u=i.getNearestNotHiddenIndex(o,-1);u!==null&&(t.col=Math.max(this.hot.view.countRenderableColumnsInRange(n.col,u)-1,1))}if(t.row<0){let o=this.mergedCellsCollection.getTopMostRowIndex(e,n.row)+t.row;a(o,n.col),e.getVerticalDirection()==="S-N"&&r.getVerticalDirection()==="S-N"&&(o=r.getTopStartCorner().row);const u=s.getNearestNotHiddenIndex(o,1);u!==null&&(t.row=-Math.max(this.hot.view.countRenderableRowsInRange(u,n.row)-1,1))}else if(t.row>0){let o=this.mergedCellsCollection.getBottomMostRowIndex(e,n.row)+t.row;a(o,n.col),e.getVerticalDirection()==="N-S"&&r.getVerticalDirection()==="N-S"&&(o=r.getBottomStartCorner().row);const u=s.getNearestNotHiddenIndex(o,-1);u!==null&&(t.row=Math.max(this.hot.view.countRenderableRowsInRange(n.row,u)-1,1))}}function XPe(){const t=this.hot.getSelectedRangeLast(),{highlight:e}=t;if(this.hot.selection.isSelectedByColumnHeader()||this.hot.selection.isSelectedByRowHeader()){L1(Ho,this,e.clone());return}for(let n=0;n<this.mergedCellsCollection.mergedCells.length;n+=1)t.expandByRange(this.mergedCellsCollection.mergedCells[n].getRange(),!1);for(let n=0;n<this.mergedCellsCollection.mergedCells.length;n+=1)t.expandByRange(this.mergedCellsCollection.mergedCells[n].getRange(),!1);const r=this.mergedCellsCollection.get(e.row,e.col);L1(Ho,this,e.clone()),r&&e.assign(r)}function vz(t,e,r,n){if(t<0||e<0)return;const i=this.mergedCellsCollection.get(t,e);if(!i)return;const{row:s,col:a,colspan:o,rowspan:u}=i,c=s,f=a,g=s+u-1,m=a+o-1;if(n==="render"&&this.getSetting("virtualized")){const v=this.hot.view.getActiveOverlayName(),w=["top","top_inline_start_corner"].includes(v)?0:this.hot.getFirstRenderedVisibleRow(),y=["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(v)?0:this.hot.getFirstRenderedVisibleColumn();return[ir(w,c,g),ir(y,f,m),ir(this.hot.getLastRenderedVisibleRow(),c,g),ir(this.hot.getLastRenderedVisibleColumn(),f,m)]}return[c,f,g,m]}function QPe(t){t.items.push({name:"---------"},IPe(this))}function wz(){L1(Ho,this,null)}function ZPe(){if(tn(Ho,this).isCell())return;const t=this.hot.getSelectedRangeLast(),e=t.getVerticalDirection(),r=t.getHorizontalDirection(),n=tn(Ho,this).clone().normalize();tn(Ru,this).setActiveNode(n.row,n.col),tn(Lo,this).row>0||tn(Lo,this).col>0?tn(Ru,this).setPrevNodeAsActive():(r==="E-W"&&tn(Lo,this).col<0||e==="S-N"&&tn(Lo,this).row<0)&&tn(Ru,this).setNextNodeAsActive()}function JPe(t,e){const r=this.hot.getSelectedRangeLast(),{columnIndexMapper:n,rowIndexMapper:i}=this.hot;let s=null,a=null;if(tn(Lo,this).col<0){const{rowEnd:o,colEnd:u}=tn(Ru,this).getPrevHorizontalNode();a=n.getNearestNotHiddenIndex(u,-1),s=i.getNearestNotHiddenIndex(o,-1)}else if(tn(Lo,this).col>0){const{rowStart:o,colStart:u}=tn(Ru,this).getNextHorizontalNode();a=n.getNearestNotHiddenIndex(u,1),s=i.getNearestNotHiddenIndex(o,1)}else if(tn(Lo,this).row<0){const{rowEnd:o,colEnd:u}=tn(Ru,this).getPrevVerticalNode();a=n.getNearestNotHiddenIndex(u,-1),s=i.getNearestNotHiddenIndex(o,-1)}else if(tn(Lo,this).row>0){const{rowStart:o,colStart:u}=tn(Ru,this).getNextVerticalNode();a=n.getNearestNotHiddenIndex(u,1),s=i.getNearestNotHiddenIndex(o,1)}if(s!==null||a!==null){const o=this.hot._createCellCoords(s,a),u=this.mergedCellsCollection.get(o.row,o.col),c=this.hot.selection.highlight.getFocus();t=o.row,e=o.col,u?r.highlight.assign({row:this.hot.rowIndexMapper.getNearestNotHiddenIndex(u.row,1),col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(u.col,1)}):r.highlight.assign(o),c.clear(),c.add(o).commit()}tn(Ru,this).setActiveNode(t,e),L1(Lo,this,{row:0,col:0})}function eIe(){this.hot.getSelectedRangeLast().isHeader()||tn(Ru,this).buildFocusOrder(this.hot.getSelectedRangeLast())}function tIe(t,e,r){const n=this.mergedCellsCollection.get(t,e);n&&(n.row!==t||n.col!==e?r.copyable=!1:(r.rowspan=n.rowspan,r.colspan=n.colspan))}function rIe(t){if(this.getSetting("virtualized"))return;const e=this.hot.countCols();this.modifyViewportRowStart(t,e),this.modifyViewportRowEnd(t,e)}function nIe(t){if(this.getSetting("virtualized"))return;const e=this.hot.countRows();this.modifyViewportColumnStart(t,e),this.modifyViewportColumnEnd(t,e)}function iIe(t,e){const r=this.autofillCalculations.getDirection(e,t);if(this.autofillCalculations.dragAreaOverlapsCollections(e,t,r))return e;const n=this.hot._createCellCoords(e[0],e[1]),i=this.hot._createCellCoords(e[2],e[3]),s=this.hot._createCellRange(n,n,i),a=this.mergedCellsCollection.getWithinRange(s);return a.length===0?t:this.autofillCalculations.snapDragArea(e,t,r,a)}function sIe(t,e){this.mergedCellsCollection.shiftCollections("right",t,e)}function aIe(t,e){this.mergedCellsCollection.shiftCollections("left",t,e)}function oIe(t,e,r){r!=="auto"&&this.mergedCellsCollection.shiftCollections("down",t,e)}function lIe(t,e){this.mergedCellsCollection.shiftCollections("up",t,e)}function uIe(t,e){e==="Autofill.fill"&&this.autofillCalculations.recreateAfterDataPopulation(t)}function cIe(t,e){if(e&&e==="area"){const r=this.hot.getSelectedRangeLast(),n=this.mergedCellsCollection.getWithinRange(r);he(n,i=>{r.getBottomEndCorner().row===i.getLastRow()&&r.getBottomEndCorner().col===i.getLastColumn()&&(t[2]=i.row,t[3]=i.col)})}}function hIe(t,e,r,n){if(r)return this.selectionCalculations.getSelectedMergedCellClassName(t,e,r,n)}function fIe(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}function dIe(t,e,r,n){if(!(n instanceof MouseEvent))return;const i=this.hot.getSelectedRangeLast(),s=this.mergedCellsCollection.getByRange(i);if(!s)return;const a=this.hot._createCellCoords(s.row,s.col),o=this.hot._createCellCoords(s.row+s.rowspan-1,s.col+s.colspan-1);return this.hot.selection.getLayerLevel()===0&&i.isEqual(this.hot._createCellRange(a,a,o))}function gIe(t,e,r){if(this.hot.getSettings().rowHeaders||r==="bottom"||r==="bottom_inline_start_corner")return t;let n,i;if(r==="master")n=this.hot.getFirstRenderedVisibleColumn(),i=this.hot.getLastRenderedVisibleColumn();else{const m=this.hot.view.getOverlayByName(r);n=this.hot.columnIndexMapper.getVisualFromRenderableIndex(m.clone.wtTable.getFirstRenderedColumn()),i=this.hot.columnIndexMapper.getVisualFromRenderableIndex(m.clone.wtTable.getLastRenderedColumn())}if(!this.mergedCellsCollection.get(e,n))return t;const a=this.hot._createCellCoords(e,n),o=this.hot._createCellCoords(e,i),u=this.hot._createCellRange(a,a,o),c=this.mergedCellsCollection.getWithinRange(u,!0),f=c.reduce((m,v)=>{let{rowspan:w}=v;return Math.max(m,w)},1);let g=0;return c.length>1&&c[0].rowspan<f&&(g=f-c[0].rowspan),c.forEach(m=>{let{rowspan:v}=m,w=0;r==="top"||r==="top_inline_start_corner"?w=Math.min(f,this.hot.view.countNotHiddenFixedRowsTop()-e):w=v-g,t=Math.max(t??0,Jee(this.hot,e,w))}),t}function mIe(t,e){return function(r,n){const[,...i]=r,[,...s]=n;return function a(o){const u=t[o],c=e[o],f=i[o],g=s[o],m=c.multiColumnSorting,w=(m.compareFunctionFactory?m.compareFunctionFactory:OJ(c.type))(u,c,m)(f,g);if(w===Nu){const y=o+1;if(typeof e[y]<"u")return a(y)}return w}(0)}}const tte="sort";function pIe(t,e,r){const n=[];return r===!1||t.isColumnSorted(e)&&t.getNumberOfSortedColumns()>1&&n.push(`${tte}-${t.getIndexOfColumnInSortQueue(e)+1}`),n}function vIe(t){const e=t.className.split(" "),r=new RegExp(`^${tte}-[0-9]{1,2}$`);return e.filter(n=>r.test(n))}function wIe(t,e,r){return(e=yIe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function yIe(t){var e=SIe(t,"string");return typeof e=="symbol"?e:e+""}function SIe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const P_="multiColumnSorting",bIe=170,yz=P_;AJ(P_,mIe);class CIe extends BJ{constructor(){super(...arguments),wIe(this,"pluginKey",P_)}static get PLUGIN_KEY(){return P_}static get PLUGIN_PRIORITY(){return bIe}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){super.enablePlugin()}disablePlugin(){super.disablePlugin()}registerShortcuts(){super.registerShortcuts(),this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Shift","Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();return e.row===-1&&e.col>=0&&this.sort(this.getNextSortConfig(e.col,g_)),!1},runOnlyIf:()=>{var e,r;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n&&((r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.isSingle())&&this.hot.selection.isCellVisible(n)&&n.isHeader()},relativeToGroup:ed,position:"before",group:yz})}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(yz)}sort(e){super.sort(e)}clearSort(){super.clearSort()}isSorted(){return super.isSorted()}getSortConfig(e){return super.getSortConfig(e)}setSortConfig(e){super.setSortConfig(e)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e:[e]}updateHeaderClasses(e){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];super.updateHeaderClasses(e,...n),wt(e,vIe(e)),this.enabled!==!1&&Ve(e,pIe(...n))}onAfterOnCellMouseDown(e,r){o3(r.row,r.col,e)!==!1&&this.wasClickableHeaderClicked(e,r.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(r.col),this.sort(this.getNextSortConfig(r.col,g_))):this.sort(this.getColumnNextConfig(r.col)))}}function Sz(t,e,r){return(e=xIe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function xIe(t){var e=EIe(t,"string");return typeof e=="symbol"?e:e+""}function EIe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const _Ie="multipleSelectionHandles",RIe=160;class TIe extends ur{constructor(){super(...arguments),Sz(this,"dragged",[]),Sz(this,"lastSetCell",null)}static get PLUGIN_KEY(){return _Ie}static get PLUGIN_PRIORITY(){return RIe}isEnabled(){return _l()}enablePlugin(){this.enabled||(this.registerListeners(),super.enablePlugin())}registerListeners(){const e=this,{rootElement:r}=this.hot;function n(i){if(e.dragged.length===1)return e.dragged.splice(0,e.dragged.length),!0;const s=e.dragged.indexOf(i);if(s===-1)return!1;s===0?e.dragged=e.dragged.slice(0,1):s===1&&(e.dragged=e.dragged.slice(-1))}this.eventManager.addEventListener(r,"touchstart",i=>{let s;if(Ct(i.target,"topSelectionHandle-HitArea"))return s=e.hot.getSelectedRangeLast(),e.dragged.push("top"),e.touchStartRange={width:s.getWidth(),height:s.getHeight(),direction:s.getDirection()},i.preventDefault(),!1;if(Ct(i.target,"bottomSelectionHandle-HitArea"))return s=e.hot.getSelectedRangeLast(),e.dragged.push("bottom"),e.touchStartRange={width:s.getWidth(),height:s.getHeight(),direction:s.getDirection()},i.preventDefault(),!1}),this.eventManager.addEventListener(r,"touchend",i=>{if(Ct(i.target,"topSelectionHandle-HitArea"))return n.call(e,"top"),e.touchStartRange=void 0,i.preventDefault(),!1;if(Ct(i.target,"bottomSelectionHandle-HitArea"))return n.call(e,"bottom"),e.touchStartRange=void 0,i.preventDefault(),!1}),this.eventManager.addEventListener(r,"touchmove",i=>{const{rootDocument:s}=this.hot;let a,o,u,c,f,g;if(e.dragged.length===0)return;const m=s.elementFromPoint(i.touches[0].clientX,i.touches[0].clientY);!m||m===e.lastSetCell||((m.nodeName==="TD"||m.nodeName==="TH")&&(a=e.hot.getCoords(m),a.col===-1&&(a.col=0),o=e.hot.getSelectedRangeLast(),u=o.getWidth(),c=o.getHeight(),f=o.getDirection(),u===1&&c===1&&e.hot.selection.setRangeEnd(a),g=e.getCurrentRangeCoords(o,a,e.touchStartRange.direction,f,e.dragged[0]),g.start!==null&&e.hot.selection.setRangeStart(g.start),e.hot.selection.setRangeEnd(g.end),e.lastSetCell=m),i.preventDefault())})}getCurrentRangeCoords(e,r,n,i,s){const a=e.getTopStartCorner(),o=e.getBottomEndCorner(),u=e.getBottomStartCorner(),c=e.getTopEndCorner();let f={start:null,end:null};switch(n){case"NE-SW":switch(i){case"NE-SW":case"NW-SE":s==="top"?f={start:this.hot._createCellCoords(r.row,e.highlight.col),end:this.hot._createCellCoords(u.row,r.col)}:f={start:this.hot._createCellCoords(e.highlight.row,r.col),end:this.hot._createCellCoords(r.row,a.col)};break;case"SE-NW":s==="bottom"&&(f={start:this.hot._createCellCoords(o.row,r.col),end:this.hot._createCellCoords(r.row,a.col)});break}break;case"NW-SE":switch(i){case"NE-SW":s==="top"?f={start:r,end:u}:f.end=r;break;case"NW-SE":s==="top"?f={start:r,end:o}:f.end=r;break;case"SE-NW":s==="top"?f={start:r,end:a}:f.end=r;break;case"SW-NE":s==="top"?f={start:r,end:c}:f.end=r;break}break;case"SW-NE":switch(i){case"NW-SE":s==="bottom"?f={start:this.hot._createCellCoords(r.row,a.col),end:this.hot._createCellCoords(u.row,r.col)}:f={start:this.hot._createCellCoords(a.row,r.col),end:this.hot._createCellCoords(r.row,o.col)};break;case"SW-NE":s==="top"?f={start:this.hot._createCellCoords(e.highlight.row,r.col),end:this.hot._createCellCoords(r.row,o.col)}:f={start:this.hot._createCellCoords(r.row,a.col),end:this.hot._createCellCoords(a.row,r.col)};break;case"SE-NW":s==="bottom"?f={start:this.hot._createCellCoords(r.row,c.col),end:this.hot._createCellCoords(a.row,r.col)}:s==="top"&&(f={start:u,end:r});break}break;case"SE-NW":switch(i){case"NW-SE":case"NE-SW":case"SW-NE":s==="top"&&(f.end=r);break;case"SE-NW":s==="top"?f.end=r:f={start:r,end:a};break}break}return f}isDragged(){return this.dragged.length>0}}function qN(){let{label:t="",colspan:e=1,origColspan:r=1,collapsible:n=!1,crossHiddenColumns:i=[],isCollapsed:s=!1,isHidden:a=!1,isRoot:o=!1,isPlaceholder:u=!1,headerClassNames:c=[]}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return{label:t,colspan:e,origColspan:r,collapsible:n,isCollapsed:s,crossHiddenColumns:i,isHidden:a,isRoot:o,isPlaceholder:u,headerClassNames:c}}function rte(){return{label:"",isPlaceholder:!0}}function MIe(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0;const r=[];if(e===0)return r;he(t,i=>{const s=[];let a=0;r.push(s),he(i,o=>{const u=qN();if(Vt(o)){const{label:f,colspan:g,headerClassName:m}=o;u.label=cn(f),typeof g=="number"&&g>1&&(u.colspan=g,u.origColspan=g),typeof m=="string"&&(u.headerClassNames=[...m.split(" ")])}else u.label=cn(o);a+=u.origColspan;let c=!1;if(a>=e&&(u.colspan=u.origColspan-(a-e),u.origColspan=u.colspan,c=!0),s.push(u),u.colspan>1)for(let f=0;f<u.colspan-1;f++)s.push(rte());return!c})});const n=Math.max(...nr(r,i=>i.length));return he(r,i=>{if(i.length<n){const s=nr(new Array(n-i.length),()=>qN());i.splice(i.length,0,...s)}}),r}function VP(t,e,r){AIe(t,e),e.set(t,r)}function AIe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function dl(t,e){return t.get(nte(t,e))}function ly(t,e,r){return t.set(nte(t,e),r),r}function nte(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const bz=["label","collapsible"];var Ec=new WeakMap,ig=new WeakMap,WP=new WeakMap;class OIe{constructor(){VP(this,Ec,[]),VP(this,ig,0),VP(this,WP,1/0)}setColumnsLimit(e){ly(WP,this,e)}setData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];ly(Ec,this,MIe(e,dl(WP,this))),ly(ig,this,dl(Ec,this).length)}getData(){return dl(Ec,this)}mergeWith(e){he(e,r=>{let{row:n,col:i,...s}=r;const a=this.getHeaderSettings(n,i);a!==null&&oi(a,s,bz)})}map(e){he(dl(Ec,this),r=>{he(r,n=>{const i=e({...n});Vt(i)&&oi(n,i,bz)})})}getHeaderSettings(e,r){var n;if(e>=dl(ig,this)||e<0)return null;const i=dl(Ec,this)[e];return Array.isArray(i)===!1||r>=i.length?null:(n=i[r])!==null&&n!==void 0?n:null}getHeadersSettings(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const i=[];if(e>=dl(ig,this)||e<0)return i;const s=dl(Ec,this)[e];let a=0;for(let o=r;o<s.length;o++){const u=s[o];if(u.isPlaceholder)throw new Error("The first column settings cannot overlap the other header layers");if(a+=u.colspan,i.push(u),u.colspan>1&&(o+=u.colspan-1),a===n)break;if(a>n)throw new Error("The last column settings cannot overlap the other header layers")}return i}getLayersCount(){return dl(ig,this)}getColumnsCount(){return dl(ig,this)>0?dl(Ec,this)[0].length:0}clear(){ly(Ec,this,[]),ly(ig,this,0)}}function $P(t,e,r){return(e=kIe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function kIe(t){var e=DIe(t,"string");return typeof e=="symbol"?e:e+""}function DIe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const ite="DF-pre-order";function ste(t,e){let r=t.call(e,this);for(let n=0;n<this.childs.length;n++){if(r===!1)return!1;r=ste.call(this.childs[n],t,e)}return r}const PIe="DF-post-order";function ate(t,e){for(let r=0;r<this.childs.length;r++)if(ate.call(this.childs[r],t,e)===!1)return!1;return t.call(e,this)}const ote="BF";function IIe(t,e){const r=[this];function n(){if(r.length===0)return;const i=r.shift();r.push(...i.childs),t.call(e,i)!==!1&&n()}n()}const NIe=ote,Cz=new Map([[ite,ste],[PIe,ate],[ote,IIe]]);class I_{constructor(e){$P(this,"data",{}),$P(this,"parent",null),$P(this,"childs",[]),this.data=e}addChild(e){e.parent=this,this.childs.push(e)}cloneTree(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this;const r=new I_({...e.data});for(let n=0;n<e.childs.length;n++)r.addChild(this.cloneTree(e.childs[n]));return r}replaceTreeWith(e){this.data={...e.data},this.childs=[];for(let r=0;r<e.childs.length;r++)this.addChild(e.childs[r])}walkDown(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:NIe;if(!Cz.has(r))throw new Error(`Traversal strategy "${r}" does not exist`);Cz.get(r).call(this,e,this)}walkUp(e){const r=this,n=i=>{e.call(r,i)!==!1&&i.parent!==null&&n(i.parent)};n(this)}}function UP(t,e,r){HIe(t,e),e.set(t,r)}function HIe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Fs(t,e){return t.get(lte(t,e))}function FIe(t,e,r){return t.set(lte(t,e),r),r}function lte(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var I0=new WeakMap,sg=new WeakMap,N0=new WeakMap;class LIe{constructor(e){UP(this,I0,new Map),UP(this,sg,new Map),UP(this,N0,null),FIe(N0,this,e)}getRoots(){return Array.from(Fs(I0,this).values())}getRootByColumn(e){let r;return Fs(sg,this).has(e)&&(r=Fs(I0,this).get(Fs(sg,this).get(e))),r}getNode(e,r){const n=this.getRootByColumn(r);if(!n)return;const i=r-Fs(sg,this).get(r);let s=0,a;return n.walkDown(o=>{const{data:{origColspan:u,headerLevel:c}}=o;if(e===c){if(i>=s&&i<=s+u-1)return a=o,a.data.isRoot=r===a.data.columnIndex,!1;s+=u}}),a}rebuildTreeIndex(){let e=0;Fs(sg,this).clear(),he(Fs(I0,this),r=>{let[,{data:{colspan:n}}]=r;for(let i=e;i<e+n;i++)Fs(sg,this).set(i,e);e+=n})}buildTree(){this.clear();const e=Fs(N0,this).getColumnsCount();let r=0;for(;r<e;){const n=Fs(N0,this).getHeaderSettings(0,r),i=new I_;Fs(I0,this).set(r,i),this.buildLeaves(i,r,0,n.origColspan),r+=n.origColspan}this.rebuildTreeIndex()}buildLeaves(e,r,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;const s=Fs(N0,this).getHeadersSettings(n,r,i);n+=1,he(s,a=>{const o={...a,headerLevel:n-1,columnIndex:r};let u;n===1?(e.data=o,u=e):(u=new I_(o),e.addChild(u)),n<Fs(N0,this).getLayersCount()&&this.buildLeaves(u,r,n,a.origColspan),r+=a.origColspan})}clear(){Fs(I0,this).clear(),Fs(sg,this).clear()}}function ute(t,e){t.walkDown(r=>{let{data:n,childs:i}=r;if(!n.isHidden&&(e(n.columnIndex),i.length===0))for(let s=1;s<n.colspan;s++)e(n.columnIndex+s)})}function N_(t,e){let{childs:r}=t;if(r.length!==0)return r[0].data[e]}function H_(t){return N_(t,"origColspan")===t.data.origColspan}function C3(t){const{data:e,childs:r}=t;if(!e.isCollapsed||e.isHidden||e.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(H_(t))return C3(r[0]);e.isCollapsed=!1;const i=r.slice(1),s=new Set;let a=0;if(i.length>0)he(i,o=>{o.replaceTreeWith(o.data.clonedTree),o.data.clonedTree=null;const u=o.data;a+=u.colspan,ute(o,c=>{s.add(c)})});else{const{colspan:o,origColspan:u,columnIndex:c}=e;a=u-o;for(let f=1;f<u;f++)s.add(c+f)}return t.walkUp(o=>{const{data:u}=o;u.colspan+=a,u.colspan>=u.origColspan?(u.colspan=u.origColspan,u.isCollapsed=!1):H_(o)&&(u.isCollapsed=N_(o,"isCollapsed"))}),{rollbackModification:()=>x3(t),affectedColumns:Array.from(s),colspanCompensation:a}}function x3(t){var e;const{data:r,childs:n}=t;if(r.isCollapsed||r.isHidden||r.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(H_(t))return x3(n[0]);r.isCollapsed=!0;const s=n.slice(1),a=new Set;if(s.length>0)he(s,u=>{ute(u,c=>{a.add(c)}),u.data.clonedTree=u.cloneTree(),u.walkDown(c=>{let{data:f}=c;f.isHidden=!0})});else{const{origColspan:u,columnIndex:c}=r;for(let f=1;f<u;f++){const g=c+f;a.add(g)}}const o=r.colspan-((e=N_(t,"colspan"))!==null&&e!==void 0?e:1);return t.walkUp(u=>{const{data:c}=u;c.colspan-=o,c.colspan<=1?(c.colspan=1,c.isCollapsed=!0):H_(u)&&(c.isCollapsed=N_(u,"isCollapsed"))}),{rollbackModification:()=>C3(t),affectedColumns:Array.from(a),colspanCompensation:o}}function BIe(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(Dr`The passed node is not the last node on the tree. Only for\x20
the last node, the hide column modification can be applied.`);const{crossHiddenColumns:r}=t.data;if(r.includes(e))return;let n=!1;t.walkUp(i=>{const{data:{collapsible:s}}=i;if(s)return n=!0,!1}),!n&&t.walkUp(i=>{const{data:s}=i;s.crossHiddenColumns.push(e),s.colspan>1?s.colspan-=1:s.isHidden=!0})}function VIe(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(Dr`The passed node is not the last node on the tree. Only for\x20
the last node, the show column modification can be applied.`);const{crossHiddenColumns:r}=t.data;if(!r.includes(e))return;let n=!1;t.walkUp(i=>{const{data:{collapsible:s}}=i;if(s)return n=!0,!1}),!n&&t.walkUp(i=>{const{data:s}=i;s.crossHiddenColumns.splice(s.crossHiddenColumns.indexOf(e),1),!s.isHidden&&s.colspan<s.origColspan&&(s.colspan+=1),s.isHidden=!1})}const xz=new Map([["collapse",x3],["expand",C3],["hide-column",BIe],["show-column",VIe]]);function WIe(t,e,r){if(!xz.has(t))throw new Error(`The node modifier action ("${t}") does not exist.`);return xz.get(t)(e,r)}function Ax(t){const e=[];return he(t,r=>{r.walkDown(n=>{const i=n.data,{origColspan:s,columnIndex:a,headerLevel:o,crossHiddenColumns:u}=i,c=UIe(e,o);let f=!1;for(let g=a;g<a+s;g++)if(u.includes(g)||f)c.push(rte());else{const v=$Ie(i);v.isRoot=!0,c.push(v),f=!0}})}),e}function $Ie(t){const{crossHiddenColumns:e,...r}=qN(t);return r}function UIe(t,e){let r;return Array.isArray(t[e])?r=t[e]:(r=[],t[e]=r),r}function jP(t,e,r){jIe(t,e),e.set(t,r)}function jIe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function uy(t,e,r){return t.set(cte(t,e),r),r}function _n(t,e){return t.get(cte(t,e))}function cte(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var au=new WeakMap,aa=new WeakMap,ag=new WeakMap;class YIe{constructor(){jP(this,au,new OIe),jP(this,aa,new LIe(_n(au,this))),jP(this,ag,[[]])}setState(e){_n(au,this).setData(e);let r=!1;try{_n(aa,this).buildTree()}catch{_n(aa,this).clear(),_n(au,this).clear(),r=!0}return uy(ag,this,Ax(_n(aa,this).getRoots())),r}setColumnsLimit(e){_n(au,this).setColumnsLimit(e)}mergeStateWith(e){const r=nr(e,n=>{let{row:i,...s}=n;return{row:i<0?this.rowCoordsToLevel(i):i,...s}});_n(au,this).mergeWith(r),_n(aa,this).buildTree(),uy(ag,this,Ax(_n(aa,this).getRoots()))}mapState(e){_n(au,this).map(e),_n(aa,this).buildTree(),uy(ag,this,Ax(_n(aa,this).getRoots()))}mapNodes(e){return Ri(_n(aa,this).getRoots(),(r,n)=>(n.walkDown(i=>{const s=e(i.data);s!==void 0&&r.push(s)}),r),[])}triggerNodeModification(e,r,n){r<0&&(r=this.rowCoordsToLevel(r));const i=_n(aa,this).getNode(r,n);let s;return i&&(s=WIe(e,i,n),uy(ag,this,Ax(_n(aa,this).getRoots()))),s}triggerColumnModification(e,r){return this.triggerNodeModification(e,-1,r)}rowCoordsToLevel(e){if(e>=0)return null;const r=e+Math.max(this.getLayersCount(),1);return r<0?null:r}levelToRowCoords(e){if(e<0)return null;const r=e-Math.max(this.getLayersCount(),1);return r>=0?null:r}getHeaderSettings(e,r){var n,i;return e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount()?null:(n=(i=_n(ag,this)[e])===null||i===void 0?void 0:i[r])!==null&&n!==void 0?n:null}getHeaderTreeNodeData(e,r){const n=this.getHeaderTreeNode(e,r);return n?{...n.data}:null}getHeaderTreeNode(e,r){if(e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount())return null;const n=_n(aa,this).getNode(e,r);return n||null}findTopMostEntireHeaderLevel(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;const n=r-e+1;let i=!1,s=null;for(let a=e;a<=r;a++){const o=_n(aa,this).getRootByColumn(a);if(!o)break;i=!0,o.walkDown(u=>{const{columnIndex:c,headerLevel:f,origColspan:g,isHidden:m}=u.data;m||g<=n&&c>=e&&c+g-1<=r&&(s===null||f<s)&&(s=f)},ite)}return i&&s===null?-1:this.levelToRowCoords(s??0)}findLeftMostColumnIndex(e,r){var n;const{isRoot:i}=(n=this.getHeaderSettings(e,r))!==null&&n!==void 0?n:{isRoot:!0};if(i)return r;let s=r-1;for(;s>=0;){var a;const{isRoot:o}=(a=this.getHeaderSettings(e,s))!==null&&a!==void 0?a:{isRoot:!0};if(o)break;s-=1}return s}findRightMostColumnIndex(e,r){var n;const{isRoot:i,origColspan:s}=(n=this.getHeaderSettings(e,r))!==null&&n!==void 0?n:{isRoot:!0,origColspan:1};if(i)return r+s-1;let a=r+1;for(;a<this.getColumnsCount();){var o;const{isRoot:u}=(o=this.getHeaderSettings(e,a))!==null&&o!==void 0?o:{isRoot:!0};if(u)break;a+=1}return a-1}getLayersCount(){return _n(au,this).getLayersCount()}getColumnsCount(){return _n(au,this).getColumnsCount()}clear(){uy(ag,this,[]),_n(au,this).clear(),_n(aa,this).clear()}}function cy(t,e,r){return(e=zIe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function zIe(t){var e=GIe(t,"string");return typeof e=="symbol"?e:e+""}function GIe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class qIe{constructor(e,r){cy(this,"hot",void 0),cy(this,"nestedHeaderSettingsGetter",void 0),cy(this,"layersCount",0),cy(this,"container",void 0),cy(this,"widthsMap",void 0),this.hot=e,this.nestedHeaderSettingsGetter=r,this.widthsMap=this.hot.columnIndexMapper.createAndRegisterIndexMap("nestedHeaders.widthsMap","physicalIndexToValue")}setLayersCount(e){return this.layersCount=e,this}getWidth(e){return this.widthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e))}buildWidthsMap(){const e=this.hot.getCurrentThemeName();this.container=this.hot.rootDocument.createElement("div"),this.container.classList.add("handsontable","htGhostTable","htAutoSize"),e&&this.container.classList.add(e),this._buildGhostTable(this.container),this.hot.rootDocument.body.appendChild(this.container);const r=this.container.querySelectorAll("tr:last-of-type th"),n=r.length;this.widthsMap.clear();for(let i=0;i<n;i++){const s=this.hot.columnIndexMapper.getVisualFromRenderableIndex(i),a=this.hot.toPhysicalColumn(s);this.widthsMap.setValueAtIndex(a,r[i].offsetWidth)}this.container.parentNode.removeChild(this.container),this.container=null}_buildGhostTable(e){const{rootDocument:r,columnIndexMapper:n}=this.hot,i=r.createDocumentFragment(),s=r.createElement("table"),a=!!this.hot.getSettings().dropdownMenu,o=n.getRenderableIndexesLength();for(let u=0;u<this.layersCount;u++){const c=r.createElement("tr");for(let f=0;f<o;f++){let g=n.getVisualFromRenderableIndex(f);g===null&&(g=f);const m=r.createElement("th"),v=this.nestedHeaderSettingsGetter(u,g);if(v&&(!v.isPlaceholder||v.isHidden)){let w=v.label;a&&(w+='<button class="changeType"></button>'),om(m,w),m.colSpan=v.colspan,c.appendChild(m)}}s.appendChild(c)}i.appendChild(s),e.appendChild(i)}clear(){this.widthsMap.clear(),this.container=null}}function KIe(t,e){hte(t,e),e.add(t)}function Ez(t,e,r){return(e=XIe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function XIe(t){var e=QIe(t,"string");return typeof e=="symbol"?e:e+""}function QIe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function hy(t,e,r){hte(t,e),e.set(t,r)}function hte(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function $c(t,e,r){return t.set(Rn(t,e),r),r}function rr(t,e){return t.get(Rn(t,e))}function Rn(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const _z="nestedHeaders",ZIe=280;var Hr=new WeakMap,rf=new WeakMap,r1=new WeakMap,xT=new WeakMap,F_=new WeakMap,Ln=new WeakSet;class JIe extends ur{constructor(){super(...arguments),KIe(this,Ln),hy(this,Hr,new YIe),hy(this,rf,null),hy(this,r1,null),hy(this,xT,!1),hy(this,F_,null),Ez(this,"ghostTable",new qIe(this.hot,(e,r)=>this.getHeaderSettings(e,r))),Ez(this,"detectedOverlappedHeaders",!1)}static get PLUGIN_KEY(){return _z}static get PLUGIN_PRIORITY(){return ZIe}isEnabled(){return!!this.hot.getSettings()[_z]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:r}=this.hot.getSettings();(!Array.isArray(r)||!Array.isArray(r[0]))&&br(Dr`Your Nested Headers plugin configuration is invalid. The settings has to be\x20
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`),this.addHook("init",()=>Rn(Ln,this,mNe).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Rn(Ln,e,pNe).call(e,...i)}),this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Rn(Ln,e,nNe).call(e,...i)}),this.addHook("afterOnCellMouseDown",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Rn(Ln,e,iNe).call(e,...i)}),this.addHook("beforeOnCellMouseOver",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Rn(Ln,e,sNe).call(e,...i)}),this.addHook("beforeOnCellMouseUp",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Rn(Ln,e,aNe).call(e,...i)}),this.addHook("beforeSelectionHighlightSet",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Rn(Ln,e,oNe).call(e,...i)}),this.addHook("modifyTransformStart",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Rn(Ln,e,lNe).call(e,...i)}),this.addHook("afterSelection",()=>Rn(Ln,this,Ox).call(this)),this.addHook("afterSelectionFocusSet",()=>Rn(Ln,this,Ox).call(this)),this.addHook("beforeViewportScrollHorizontally",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Rn(Ln,e,eNe).call(e,...i)}),this.addHook("afterGetColumnHeaderRenderers",n=>Rn(Ln,this,cNe).call(this,n)),this.addHook("modifyColWidth",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Rn(Ln,e,fNe).call(e,...i)}),this.addHook("modifyColumnHeaderValue",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Rn(Ln,e,dNe).call(e,...i)}),this.addHook("beforeHighlightingColumnHeader",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Rn(Ln,e,tNe).call(e,...i)}),this.addHook("beforeCopy",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Rn(Ln,e,rNe).call(e,...i)}),this.addHook("beforeSelectColumns",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Rn(Ln,e,uNe).call(e,...i)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Rn(Ln,e,hNe).call(e,...i)}),this.addHook("modifyFocusedElement",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Rn(Ln,e,gNe).call(e,...i)}),this.hot.columnIndexMapper.addLocalHook("cacheUpdated",()=>Rn(Ln,this,Ox).call(this)),this.hot.rowIndexMapper.addLocalHook("cacheUpdated",()=>Rn(Ln,this,Ox).call(this)),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(!this.hot.view)return;const{nestedHeaders:e}=this.hot.getSettings();rr(Hr,this).setColumnsLimit(this.hot.countCols()),Array.isArray(e)&&(this.detectedOverlappedHeaders=rr(Hr,this).setState(e)),this.detectedOverlappedHeaders&&br(Dr`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\x20
                        is currently not supported.`),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach((r,n)=>{const i=r===!0?"hide-column":"show-column";rr(Hr,this).triggerColumnModification(i,n)}),!rr(rf,this)&&this.enabled&&$c(rf,this,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe(r=>{r.forEach(n=>{let{op:i,index:s,newValue:a}=n;if(i==="replace"){const o=a===!0?"hide-column":"show-column";rr(Hr,this).triggerColumnModification(o,s)}}),this.ghostTable.buildWidthsMap()})),this.ghostTable.setLayersCount(this.getLayersCount()).buildWidthsMap(),super.updatePlugin()}disablePlugin(){this.clearColspans(),rr(Hr,this).clear(),rr(rf,this).unsubscribe(),$c(rf,this,null),this.ghostTable.clear(),super.disablePlugin()}getStateManager(){return rr(Hr,this)}getLayersCount(){return rr(Hr,this).getLayersCount()}getHeaderSettings(e,r){return rr(Hr,this).getHeaderSettings(e,r)}clearColspans(){if(!this.hot.view)return;const{_wt:e}=this.hot.view,r=e.getSetting("columnHeaders").length,n=e.wtTable.THEAD,i=e.wtOverlays.topOverlay.clone.wtTable.THEAD,s=e.wtOverlays.topInlineStartCornerOverlay?e.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null;for(let a=0;a<r;a++){const o=n.childNodes[a];if(!o)break;const u=i.childNodes[a],c=s?s.childNodes[a]:null;for(let f=0,g=o.childNodes.length;f<g;f++)o.childNodes[f].removeAttribute("colspan"),wt(o.childNodes[f],"hiddenHeader"),u&&u.childNodes[f]&&(u.childNodes[f].removeAttribute("colspan"),wt(u.childNodes[f],"hiddenHeader")),s&&c&&c.childNodes[f]&&(c.childNodes[f].removeAttribute("colspan"),wt(c.childNodes[f],"hiddenHeader"))}}headerRendererFactory(e){var r=this;const n=this.hot.view._wt.getSetting("fixedColumnsStart");return(i,s)=>{var a;const{columnIndexMapper:o,view:u}=this.hot;let c=o.getVisualFromRenderableIndex(i);c===null&&(c=i),s.removeAttribute("colspan"),wt(s,"hiddenHeader"),wt(s,"hiddenHeaderText");const{colspan:f,isHidden:g,isPlaceholder:m,headerClassNames:v}=(a=rr(Hr,this).getHeaderSettings(e,c))!==null&&a!==void 0?a:{};if(m||g)Ve(s,"hiddenHeader");else if(f>1){var w,y,b;const{wtOverlays:x}=u._wt,_=(w=x.topInlineStartCornerOverlay)===null||w===void 0?void 0:w.clone.wtTable.THEAD.contains(s),T=(y=x.inlineStartOverlay)===null||y===void 0?void 0:y.clone.wtTable.THEAD.contains(s);((b=x.topOverlay)===null||b===void 0?void 0:b.clone.wtTable.THEAD.contains(s))&&c<n&&Ve(s,"hiddenHeaderText");const P=_||T?Math.min(f,n-i):f;P>1&&s.setAttribute("colspan",P)}if(this.hot.view.appendColHeader(c,s,function(){return r.getColumnHeaderValue(...arguments)},e),!m&&!g){const x=s.querySelector("div.relative");x&&v&&v.length>0&&(wt(x,this.hot.getColumnMeta(c).headerClassName),Ve(x,v))}}}getColumnHeaderValue(e,r){var n;const{isHidden:i,isPlaceholder:s}=(n=rr(Hr,this).getHeaderSettings(r,e))!==null&&n!==void 0?n:{};return s||i?"":this.hot.getColHeader(e,r)}destroy(){$c(Hr,this,null),rr(rf,this)!==null&&(rr(rf,this).unsubscribe(),$c(rf,this,null)),super.destroy()}_getHeaderTreeNodeDataByCoords(e){if(!(e.row>=0||e.col<0))return rr(Hr,this).getHeaderTreeNodeData(e.row,e.col)}}function Ox(){var t;const e=(t=this.hot)===null||t===void 0?void 0:t.getSelectedRangeLast();if(!e)return;const{highlight:r}=e;if(r.isHeader()&&r.col>=0){const i=rr(Hr,this).findLeftMostColumnIndex(r.row,r.col),s=this.hot.selection.highlight.getFocus();s.visualCellRange.highlight.col=i,s.visualCellRange.from.col=i,s.visualCellRange.to.col=i,s.commit()}}function eNe(t,e){var r;const n=this.hot.getSelectedRangeLast();if(!n)return t;const{highlight:i}=n,{navigableHeaders:s}=this.hot.getSettings(),a=this.hot.selection.isSelectedByColumnHeader(),o=s?i.row:(r=rr(F_,this))===null||r===void 0?void 0:r.row,u=a?t:i.col,c=o<0&&u>=0;if($c(F_,this,null),!c)return t;const f=this.hot.getFirstFullyVisibleColumn(),g=this.hot.getLastFullyVisibleColumn(),m=g-f+1,v=rr(Hr,this).findLeftMostColumnIndex(o,u),w=rr(Hr,this).findRightMostColumnIndex(o,u),y=w-v+1;if(v<f&&w>g)return v;if(a){let b=null;return v>=f&&w>g?y>m?(e.value="start",b=v):(e.value="end",b=w):v<f&&w<=g&&(y>m?(e.value="end",b=w):(e.value="start",b=v)),b}return v<=f?v:w}function tNe(t,e,r){const n=rr(Hr,this).getHeaderTreeNodeData(e,t);if(!n)return t;const{columnCursor:i,selectionType:s,selectionWidth:a}=r,{isRoot:o,colspan:u}=rr(Hr,this).getHeaderSettings(e,t);if(s===qF){if(!o)return n.columnIndex}else if(s===uZ&&(u>a-i||!o))return null;return t}function rNe(t,e,r){let{columnHeadersCount:n}=r;if(n!==0)for(let s=0;s<e.length;s++){const{startRow:a,startCol:o,endRow:u,endCol:c}=e[s],f=u-a+1,g=o-c+1;if(a>=0||g===1)break;for(let m=o;m<=c;m++)for(let v=a;v<=u;v++){var i;const w=f+v,y=m-o;if(y===0)continue;((i=rr(Hr,this).getHeaderTreeNodeData(v,m))===null||i===void 0?void 0:i.isRoot)===!1&&(t[w][y]="")}}}function nNe(t,e,r,n){this._getHeaderTreeNodeDataByCoords(e)&&(n.column=!0)}function iNe(t,e){const r=this._getHeaderTreeNodeDataByCoords(e);if(!r)return;$c(r1,this,e.clone()),$c(xT,this,!0);const{selection:n}=this.hot,i=n.isSelected()?n.getSelectedRange().current():null,s=[],{columnIndex:a,origColspan:o}=r,u=!n.inInSelection(e);t.shiftKey&&i?e.col<i.from.col?s.push(i.getTopEndCorner().col,a,e.row):e.col>i.from.col?s.push(i.getTopStartCorner().col,a+o-1,e.row):s.push(a,a+o-1,e.row):(zR(t)||Vf(t)&&u||LQ(t))&&s.push(a,a+o-1,e.row),n.selectColumns(...s)}function sNe(t,e,r,n){if(!this.hot.view.isMouseDown()||n.column)return;const i=this._getHeaderTreeNodeDataByCoords(e);if(!i)return;const{columnIndex:s,origColspan:a}=i,o=this.hot.getSelectedRangeLast(),u=o.getTopStartCorner(),c=o.getBottomEndCorner(),{from:f}=o;n.column=!0,n.cell=!0;const g=[],m=ir(e.row,-1/0,-1);e.col<f.col?g.push(c.col,s,m):e.col>f.col?g.push(u.col,s+a-1,m):g.push(s,s+a-1,m),this.hot.selection.selectColumns(...g)}function aNe(){$c(xT,this,!1)}function oNe(){const{navigableHeaders:t}=this.hot.getSettings();if(!this.hot.view.isMouseDown()||!rr(xT,this)||!t)return;const e=this.hot.getSelectedRangeLast(),r=e.getTopStartCorner().col,n=e.getBottomEndCorner().col,{columnIndex:i,origColspan:s}=rr(Hr,this).getHeaderTreeNodeData(rr(r1,this).row,rr(r1,this).col);if(e.setHighlight(rr(r1,this)),s>e.getWidth()||i<r||i+s-1>n){const a=rr(Hr,this).findTopMostEntireHeaderLevel(ir(r,i,i+s-1),ir(n,i,i+s-1));e.highlight.row=a,e.highlight.col=e.from.col}}function lNe(t){const{highlight:e}=this.hot.getSelectedRangeLast(),r=this.hot._createCellCoords(e.row+t.row,e.col+t.col);if(!(r.isHeader()&&r.col>=0))return;const i=rr(Hr,this).findLeftMostColumnIndex(r.row,r.col),s=rr(Hr,this).findRightMostColumnIndex(r.row,r.col);if(t.col<0){const a=e.col>=i&&e.col<=s?i-1:s,o=this.hot.columnIndexMapper.getNearestNotHiddenIndex(a,-1);o===null?t.col=-this.hot.view.countRenderableColumnsInRange(0,e.col):t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(o,e.col)-1,1)}else if(t.col>0){const a=e.col>=i&&e.col<=s?s+1:i,o=this.hot.columnIndexMapper.getNearestNotHiddenIndex(a,1);o===null?t.col=this.hot.view.countRenderableColumnsInRange(e.col,this.hot.countCols()):t.col=Math.max(this.hot.view.countRenderableColumnsInRange(e.col,o)-1,1)}}function uNe(t,e,r){const n=t.row,i=this._getHeaderTreeNodeDataByCoords({row:n,col:t.col}),s=this._getHeaderTreeNodeDataByCoords({row:n,col:e.col});$c(F_,this,r.clone()),e.col<t.col?(i&&(t.col=i.columnIndex+i.origColspan-1),s&&(e.col=s.columnIndex)):e.col>=t.col&&(i&&(t.col=i.columnIndex),s&&(e.col=s.columnIndex+s.origColspan-1))}function cNe(t){if(rr(Hr,this).getLayersCount()>0){t.length=0;for(let e=0;e<rr(Hr,this).getLayersCount();e++)t.push(this.headerRendererFactory(e))}}function hNe(t){const e=rr(Hr,this).getLayersCount();let r=t.startColumn,n=!!e;for(let i=0;i<e;i++){const s=rr(Hr,this).findLeftMostColumnIndex(i,t.startColumn),a=this.hot.columnIndexMapper.getRenderableFromVisualIndex(s);if(s>=0&&(n=!1),Ss(a)&&a<t.startColumn){r=a;break}}t.startColumn=n?rr(Hr,this).getHeaderTreeNodeData(0,r).columnIndex:r}function fNe(t,e){const r=this.ghostTable.getWidth(e);return t>r?t:r}function dNe(t,e,r){var n;const{label:i}=(n=rr(Hr,this).getHeaderTreeNodeData(r,e))!==null&&n!==void 0?n:{label:""};return i}function gNe(t,e){if(t<0)return this.hot.getCell(t,rr(Hr,this).findLeftMostColumnIndex(t,e),!0)}function mNe(){this.updatePlugin()}function pNe(t,e){e||this.updatePlugin()}function fy(t,e,r){return(e=vNe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function vNe(t){var e=wNe(t,"string");return typeof e=="symbol"?e:e+""}function wNe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class yNe{constructor(e,r){fy(this,"hot",void 0),fy(this,"data",null),fy(this,"plugin",void 0),fy(this,"parentReference",new WeakMap),fy(this,"cache",{levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}),this.hot=r,this.plugin=e}setData(e){this.data=e}getData(){return this.data}getRawSourceData(){let e=null;return this.plugin.disableCoreAPIModifiers(),e=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),e}updateWithData(e){this.setData(e),this.rewriteCache()}rewriteCache(){this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},ct(0,this.data.length-1,e=>{this.cacheNode(this.data[e],0,null)})}cacheNode(e,r,n){this.cache.levels[r]||(this.cache.levels[r]=[],this.cache.levelCount+=1),this.cache.levels[r].push(e),this.cache.rows.push(e),this.cache.nodeInfo.set(e,{parent:n,row:this.cache.rows.length-1,level:r}),this.hasChildren(e)&&he(e.__children,i=>{this.cacheNode(i,r+1,e)})}getDataObject(e){return e==null?null:this.cache.rows[e]}readTreeNodes(e,r,n,i){let s=!1,a=r;if(isNaN(a)&&a.end)return a;let o=e;return o||(o={__children:this.data},s=!0,a-=1),n!=null&&a===n?{result:o,end:!0}:i!=null&&o===i?{result:a,end:!0}:(a+=1,o.__children&&he(o.__children,u=>{if(this.parentReference.set(u,s?null:o),a=this.readTreeNodes(u,a,n,i),isNaN(a)&&a.end)return!1}),a)}mockParent(){const e=this.mockNode();return e.__children=this.data,e}mockNode(){const e={};return Wt(this.data[0],(r,n)=>{e[n]=null}),e}getRowIndex(e){return e==null?null:this.cache.nodeInfo.get(e).row}getRowIndexWithinParent(e){let r=null;isNaN(e)?r=e:r=this.getDataObject(e);const n=this.getRowParent(e);return n==null?this.data.indexOf(r):n.__children.indexOf(r)}countAllRows(){const e={__children:this.data};return this.countChildren(e)}countChildren(e){let r=0,n=e;return isNaN(n)||(n=this.getDataObject(n)),!n||!n.__children?0:(he(n.__children,i=>{r+=1,i.__children&&(r+=this.countChildren(i))}),r)}getRowParent(e){let r;return isNaN(e)?r=e:r=this.getDataObject(e),this.getRowObjectParent(r)}getRowObjectParent(e){return!e||typeof e!="object"?null:this.cache.nodeInfo.get(e).parent}getRowLevel(e){let r=null;return isNaN(e)?r=e:r=this.getDataObject(e),r?this.getRowObjectLevel(r):null}getRowObjectLevel(e){return e==null?null:this.cache.nodeInfo.get(e).level}hasChildren(e){let r=e;return isNaN(r)||(r=this.getDataObject(r)),!!(r.__children&&r.__children.length)}isChild(e){return this.getRowParent(e)!==null}getChild(e,r){var n;return((n=e.__children)===null||n===void 0?void 0:n[r])||null}isRowHighestLevel(e){return!this.isChild(e)}isParent(e){var r;let n=e;return isNaN(n)||(n=this.getDataObject(n)),n&&!!n.__children&&((r=n.__children)===null||r===void 0?void 0:r.length)!==0}addChild(e,r){let n=r;this.hot.runHooks("beforeAddChild",e,n);let i=null;e&&(i=this.getRowIndex(e)),this.hot.runHooks("beforeCreateRow",i+this.countChildren(e)+1,1);let s=e;e||(s=this.mockParent()),s.__children||(s.__children=[]),n||(n=this.mockNode()),s.__children.push(n),this.rewriteCache();const a=this.getRowIndex(n);this.hot.rowIndexMapper.insertIndexes(a,1),this.hot.runHooks("afterCreateRow",a,1),this.hot.runHooks("afterAddChild",e,n)}addChildAtIndex(e,r,n){let i=n,s;if(i||(i=this.mockNode()),this.hot.runHooks("beforeAddChild",e,i,r),e){const o=this.getRowIndex(e)+r+1;this.hot.runHooks("beforeCreateRow",o,1),e.__children.splice(r,null,i),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(e),"__children",e.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(o,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",o,1),s=o}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row_above",r,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),s=this.getRowIndex(this.data[r]);i=this.getDataObject(s),this.hot.runHooks("afterAddChild",e,i,r)}addSibling(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"below";const n=this.translateTrimmedRow(e),i=this.getRowParent(n),s=this.getRowIndexWithinParent(n);switch(r){case"below":this.addChildAtIndex(i,s+1,null);break;case"above":this.addChildAtIndex(i,s,null);break}}detachFromParent(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=null;const i=[];Array.isArray(e)?(ct(e[0],e[2],m=>{const v=this.translateTrimmedRow(m);i.push(this.getDataObject(v))}),ct(0,i.length-2,m=>{this.detachFromParent(i[m],!1)}),n=i[i.length-1]):n=e;const s=this.getRowIndex(n),a=this.countChildren(n),o=this.getRowIndexWithinParent(n),u=this.getRowParent(n),c=this.getRowParent(u),f=this.getRowIndex(c);let g=null;if(this.hot.runHooks("beforeDetachChild",u,n),o!=null){const m=Array.from(new Array(s+a+1).keys()).splice(-1*(a+1));if(this.hot.runHooks("beforeRemoveRow",s,a+1,m,this.plugin.pluginName),u.__children.splice(o,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",s,a+1,m,this.plugin.pluginName),c){g=f+this.countChildren(c);const v=this.getChild(c,this.countChildren(c)-1),w=this.getRowIndex(v);this.hot.runHooks("beforeCreateRow",w+1,a+1,this.plugin.pluginName),c.__children.push(n)}else g=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",g-2,a+1,this.plugin.pluginName),this.data.push(n)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",g-2,a+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",u,n,this.getRowIndex(n)),r&&this.hot.render()}filterData(e,r,n){const i=[];he(n,s=>{i.push(this.getDataObject(s))}),he(i,s=>{const a=this.getRowIndexWithinParent(s),o=this.getRowParent(s);o===null?this.data.splice(a,1):o.__children.splice(a,1)}),this.rewriteCache()}spliceData(e,r,n){const i=this.getDataObject(e-1);let s=null,a=e;i&&i.__children&&i.__children.length===0?(s=i,a=0):e<this.countAllRows()&&(s=this.getRowParent(e),a=this.getRowIndexWithinParent(e)),s?n?s.__children.splice(a,r,...n):s.__children.splice(a,r):n?this.data.splice(a,r,...n):this.data.splice(a,r),this.rewriteCache()}syncRowWithRawSource(e){let r=e,n=r;do n=this.getRowParent(n),n!==null&&(r=n);while(n!==null);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(r),"__children",r.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}moveRow(e,r,n,i){const s=r===this.hot.countRows(),a=this.getRowParent(e),o=this.getRowIndexWithinParent(e),u=a.__children.slice(o,o+1),c=e>r;let f=s?this.getRowParent(r-1):this.getRowParent(r);f==null&&(f=this.getRowParent(r-1)),f==null&&(f=this.getDataObject(r-1)),f?f.__children||(f.__children=[]):(f=this.getDataObject(r),f.__children=[]);const g=s||n||i?f.__children.length:this.getRowIndexWithinParent(r),m=a===f;f.__children.splice(g,0,u[0]),a.__children.splice(o+(c&&m?1:0),1),this.syncRowWithRawSource(a),m||this.syncRowWithRawSource(f)}translateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(e):e}untranslateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(e):e}}function Rz(t,e,r){return(e=SNe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function SNe(t){var e=bNe(t,"string");return typeof e=="symbol"?e:e+""}function bNe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class E3{constructor(e,r){Rz(this,"hot",void 0),Rz(this,"plugin",void 0),this.hot=r,this.plugin=e}}class wu extends E3{static get CSS_CLASSES(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}constructor(e,r){super(e,r),this.dataManager=this.plugin.dataManager,this.collapsingUI=this.plugin.collapsingUI,this.rowHeaderWidthCache=null}appendLevelIndicators(e,r){const n=this.hot.toPhysicalRow(e),i=this.dataManager.getRowLevel(n),s=this.dataManager.getDataObject(n),a=r.getElementsByTagName("DIV")[0],o=a.querySelector("span.rowHeader"),u=a.querySelectorAll('[class^="ht_nesting"]'),c=this.hot.getSettings().ariaTags;if(he(u,f=>{f&&a.removeChild(f)}),Ve(r,wu.CSS_CLASSES.indicatorContainer),i){const{rootDocument:f}=this.hot,g=o.cloneNode(!0);a.innerHTML="",ct(0,i-1,()=>{const m=f.createElement("SPAN");Ve(m,wu.CSS_CLASSES.emptyIndicator),a.appendChild(m)}),a.appendChild(g)}if(this.dataManager.hasChildren(s)){const f=this.hot.rootDocument.createElement("DIV");c&&bt(f,[sm()]),Ve(r,wu.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(n)?(Ve(f,`${wu.CSS_CLASSES.button} ${wu.CSS_CLASSES.expandButton}`),c&&bt(r,[Vo(!1)])):(Ve(f,`${wu.CSS_CLASSES.button} ${wu.CSS_CLASSES.collapseButton}`),c&&bt(r,[Vo(!0)])),a.appendChild(f)}}updateRowHeaderWidth(e){let r=e;r||(r=this.dataManager.cache.levelCount);let n=11;this.hot.stylesHandler.isClassicTheme()||(n=this.hot.stylesHandler.getCSSVariableValue("cell-horizontal-padding")*2),this.rowHeaderWidthCache=Math.max(50,n+10*r+25),this.hot.render()}}class CNe extends E3{constructor(e,r){var n;super(e,r),n=this,this.dataManager=this.plugin.dataManager,this.collapsedRows=[],this.collapsedRowsStash={stash:function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;n.lastCollapsedRows=n.collapsedRows.slice(0),n.expandMultipleChildren(n.lastCollapsedRows,i)},shiftStash:function(i,s){let a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;s==null&&(s=1/0),he(n.lastCollapsedRows,(o,u)=>{o>=i&&o<s&&(n.lastCollapsedRows[u]=o+a)})},applyStash:function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;n.collapseMultipleChildren(n.lastCollapsedRows,i),n.lastCollapsedRows=void 0},trimStash:(i,s)=>{ct(i,i+s-1,a=>{const o=this.lastCollapsedRows.indexOf(a);o>-1&&this.lastCollapsedRows.splice(o,1)})}}}collapseChildren(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];let s=null,a=null,o=null;return isNaN(e)?(s=e,a=this.dataManager.getRowIndex(s)):(s=this.dataManager.getDataObject(e),a=e),this.dataManager.hasChildren(s)&&he(s.__children,u=>{i.push(this.dataManager.getRowIndex(u))}),o=this.collapseRows(i,!0,!1),n&&this.trimRows(o),r&&this.renderAndAdjust(),this.collapsedRows.indexOf(a)===-1&&this.collapsedRows.push(a),o}collapseMultipleChildren(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];he(e,s=>{i.push(...this.collapseChildren(s,!1,!1))}),n&&this.trimRows(i),r&&this.renderAndAdjust()}collapseRow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.collapseRows([e],r)}collapseRows(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=[];return he(e,s=>{i.push(s),r&&this.collapseChildRows(s,i)}),n&&this.trimRows(i),i}collapseChildRows(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const i=this.dataManager.getDataObject(e);he(i.__children,s=>{const a=this.dataManager.getRowIndex(s);r.push(a),this.collapseChildRows(a,r)})}n&&this.trimRows(r)}expandRow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.expandRows([e],r)}expandRows(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=[];return he(e,s=>{i.push(s),r&&this.expandChildRows(s,i)}),n&&this.untrimRows(i),i}expandChildRows(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const i=this.dataManager.getDataObject(e);he(i.__children,s=>{if(!this.isAnyParentCollapsed(s)){const a=this.dataManager.getRowIndex(s);r.push(a),this.expandChildRows(a,r)}})}n&&this.untrimRows(r)}expandChildren(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];let s=null,a=null,o=null;return isNaN(e)?(s=e,a=this.dataManager.getRowIndex(e)):(s=this.dataManager.getDataObject(e),a=e),this.collapsedRows.splice(this.collapsedRows.indexOf(a),1),this.dataManager.hasChildren(s)&&he(s.__children,u=>{const c=this.dataManager.getRowIndex(u);i.push(c)}),o=this.expandRows(i,!0,!1),n&&this.untrimRows(o),r&&this.renderAndAdjust(),o}expandMultipleChildren(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];he(e,s=>{i.push(...this.expandChildren(s,!1,!1))}),n&&this.untrimRows(i),r&&this.renderAndAdjust()}collapseAll(){const e=this.dataManager.getData(),r=[];he(e,n=>{this.dataManager.hasChildren(n)&&r.push(n)}),this.collapseMultipleChildren(r),this.renderAndAdjust()}expandAll(){const e=this.dataManager.getData(),r=[];he(e,n=>{this.dataManager.hasChildren(n)&&r.push(n)}),this.expandMultipleChildren(r),this.renderAndAdjust()}trimRows(e){this.hot.batchExecution(()=>{he(e,r=>{this.plugin.collapsedRowsMap.setValueAtIndex(r,!0)})},!0)}untrimRows(e){this.hot.batchExecution(()=>{he(e,r=>{this.plugin.collapsedRowsMap.setValueAtIndex(r,!1)})},!0)}areChildrenCollapsed(e){let r=isNaN(e)?e:this.dataManager.getDataObject(e),n=!0;return r===null&&(r={__children:this.dataManager.data}),this.dataManager.hasChildren(r)&&he(r.__children,i=>{const s=this.dataManager.getRowIndex(i);if(!this.plugin.collapsedRowsMap.getValueAtIndex(s))return n=!1,!1}),n}isAnyParentCollapsed(e){let r=e;for(;r!==null;){r=this.dataManager.getRowParent(r);const n=this.dataManager.getRowIndex(r);if(this.collapsedRows.indexOf(n)>-1)return!0}return!1}toggleState(e,r){if(r.col>=0)return;const n=this.translateTrimmedRow(r.row);Ct(e.target,wu.CSS_CLASSES.button)&&(this.areChildrenCollapsed(n)?this.expandChildren(n):this.collapseChildren(n),Qo(e))}translateTrimmedRow(e){return this.hot.toPhysicalRow(e)}untranslateTrimmedRow(e){return this.hot.toVisualRow(e)}renderAndAdjust(){this.hot.render(),this.hot.view.adjustElementsSize()}}function xNe(t,e,r){ENe(t,e),e.set(t,r)}function ENe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _Ne(t,e,r){return(e=RNe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function RNe(t){var e=TNe(t,"string");return typeof e=="symbol"?e:e+""}function TNe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function MNe(t,e){return t.get(ANe(t,e))}function ANe(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Tz=new WeakMap;class ONe extends E3{constructor(){super(...arguments),_Ne(this,"dataManager",this.plugin.dataManager),xNe(this,Tz,{row_above:(e,r)=>{const n=r[r.length-1];this.dataManager.addSibling(n.start.row,"above")},row_below:(e,r)=>{const n=r[r.length-1];this.dataManager.addSibling(n.start.row,"below")}})}appendOptions(e){const r=[{key:"add_child",name(){return this.getTranslatedPhrase(KL)},callback:()=>{const n=this.dataManager.translateTrimmedRow(this.hot.getSelectedLast()[0]),i=this.dataManager.getDataObject(n);this.dataManager.addChild(i)},disabled:()=>{const n=this.hot.getSelectedLast();return!n||n[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{key:"detach_from_parent",name(){return this.getTranslatedPhrase(XL)},callback:()=>{this.dataManager.detachFromParent(this.hot.getSelectedLast())},disabled:()=>{const n=this.hot.getSelectedLast(),i=this.dataManager.translateTrimmedRow(n[0]);return!this.dataManager.getRowParent(i)||!n||n[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{name:"---------"}];return ct(0,e.items.length-1,n=>{if(n===0)return he(r,(i,s)=>{e.items.splice(n+s,0,i)}),!1}),this.modifyRowInsertingOptions(e)}modifyRowInsertingOptions(e){return ct(0,e.items.length-1,r=>{const n=MNe(Tz,this)[e.items[r].key];n!=null&&(e.items[r].callback=n)}),e}}function kx(t,e,r){return(e=kNe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function kNe(t){var e=DNe(t,"string");return typeof e=="symbol"?e:e+""}function DNe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class PNe{constructor(e){kx(this,"plugin",void 0),kx(this,"hot",void 0),kx(this,"dataManager",void 0),kx(this,"collapsingUI",void 0),this.plugin=e,this.hot=e.hot,this.dataManager=e.dataManager,this.collapsingUI=e.collapsingUI}onBeforeRowMove(e,r,n,i){if(this.displayAPICompatibilityWarning({rows:e,finalIndex:r,dropIndex:n,movePossible:i}))return!1;this.movedToCollapsed=!1;const a=n===this.hot.countRows(),o=a?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(n);let u=!0;const c=e.map(w=>{if(!u)return!1;const y=this.dataManager.translateTrimmedRow(w);return u=this.shouldAllowMoving(y,o),y}),f=c.indexOf(o)===-1;if(!u||!f)return!1;const g=this.getBaseParent(c),m=this.getTargetParent(a,o),v=g===m;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(m),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(c,o,v),this.moveRows(c,o,m),this.dataManager.rewriteCache(),this.moveCellsMeta(c,o),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",e,r,n,i,i&&this.isRowOrderChanged(e,r)),this.hot.render(),this.selectCells(e,n),!1}displayAPICompatibilityWarning(e){const{rows:r,finalIndex:n,dropIndex:i,movePossible:s}=e;let a=!1;return gn(i)&&(br(Dr`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\x20
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`),this.hot.runHooks("afterRowMove",r,n,i,s,!1),a=!0),a}shouldAllowMoving(e,r){return!(this.dataManager.isParent(e)||this.dataManager.isRowHighestLevel(e)||e===r||r===0)}getBaseParent(e){return this.dataManager.getRowParent(e[0])}getTargetParent(e,r){let n=this.dataManager.getRowParent(e?r-1:r);return n==null&&(n=this.dataManager.getRowParent(r-1)),n}shiftCollapsibleParentsLocations(e,r,n){n||(Math.max(...e)<=r?this.collapsingUI.collapsedRowsStash.shiftStash(e[0],r,-1*e.length):this.collapsingUI.collapsedRowsStash.shiftStash(r,e[0],e.length))}moveRows(e,r,n){const i=r===this.dataManager.getRowIndex(n)+this.dataManager.countChildren(n)+1;this.hot.batchRender(()=>{e.forEach(s=>{this.dataManager.moveRow(s,r,this.movedToCollapsed,i)})})}moveCellsMeta(e,r){const n=[],i=Math.max(...e)<r;e.forEach(s=>{n.push(this.hot.getCellMetaAtRow(s))}),this.hot.spliceCellsMeta(e[0],e.length),this.hot.spliceCellsMeta(r-(i?n.length:0),0,...n)}selectCells(e,r){const n=e.length;let i=0,s=0;if(this.movedToCollapsed){let a=null;e[n-1]<r?a=this.dataManager.translateTrimmedRow(r-n):a=this.dataManager.translateTrimmedRow(r);const o=this.dataManager.getRowParent(a===null?this.hot.countSourceRows()-1:a-1),u=this.dataManager.getRowIndex(o);i=this.dataManager.untranslateTrimmedRow(u),s=i}else e[n-1]<r?(s=r-1,i=s-n+1):(i=r,s=i+n-1);this.hot.selectCells([[i,0,s,this.hot.countCols()-1]],!1)}isRowOrderChanged(e,r){return e.some((n,i)=>n-i!==r)}}function INe(t,e){fte(t,e),e.add(t)}function Mz(t,e,r){fte(t,e),e.set(t,r)}function fte(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function YP(t,e,r){return(e=NNe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function NNe(t){var e=HNe(t,"string");return typeof e=="symbol"?e:e+""}function HNe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function DE(t,e){return t.get(Di(t,e))}function L_(t,e,r){return t.set(Di(t,e),r),r}function Di(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const B_="nestedRows",FNe=300,Az=B_,LNe="The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled.";var ET=new WeakMap,H0=new WeakMap,Wi=new WeakSet;class BNe extends ur{constructor(){super(...arguments),INe(this,Wi),YP(this,"dataManager",null),YP(this,"headersUI",null),YP(this,"collapsedRowsMap",null),Mz(this,ET,!1),Mz(this,H0,!1)}static get PLUGIN_KEY(){return B_}static get PLUGIN_PRIORITY(){return FNe}isEnabled(){return!!this.hot.getSettings()[B_]}enablePlugin(){var e=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new TS),this.dataManager=new yNe(this,this.hot),this.collapsingUI=new CNe(this,this.hot),this.headersUI=new wu(this,this.hot),this.contextMenuUI=new ONe(this,this.hot),this.rowMoveController=new PNe(this),this.addHook("afterInit",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Di(Wi,e,JNe).call(e,...n)}),this.addHook("beforeViewRender",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Di(Wi,e,eHe).call(e,...n)}),this.addHook("modifyRowData",function(){return e.onModifyRowData(...arguments)}),this.addHook("modifySourceLength",function(){return e.onModifySourceLength(...arguments)}),this.addHook("beforeDataSplice",function(){return e.onBeforeDataSplice(...arguments)}),this.addHook("filterData",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Di(Wi,e,$Ne).call(e,...n)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Di(Wi,e,UNe).call(e,...n)}),this.addHook("afterGetRowHeader",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Di(Wi,e,jNe).call(e,...n)}),this.addHook("beforeOnCellMouseDown",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Di(Wi,e,WNe).call(e,...n)}),this.addHook("beforeRemoveRow",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Di(Wi,e,GNe).call(e,...n)}),this.addHook("afterRemoveRow",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Di(Wi,e,zNe).call(e,...n)}),this.addHook("beforeAddChild",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Di(Wi,e,qNe).call(e,...n)}),this.addHook("afterAddChild",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Di(Wi,e,KNe).call(e,...n)}),this.addHook("beforeDetachChild",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Di(Wi,e,XNe).call(e,...n)}),this.addHook("afterDetachChild",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Di(Wi,e,QNe).call(e,...n)}),this.addHook("modifyRowHeaderWidth",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Di(Wi,e,YNe).call(e,...n)}),this.addHook("afterCreateRow",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Di(Wi,e,ZNe).call(e,...n)}),this.addHook("beforeRowMove",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Di(Wi,e,VNe).call(e,...n)}),this.addHook("beforeLoadData",r=>Di(Wi,this,Oz).call(this,r)),this.addHook("beforeUpdateData",r=>Di(Wi,this,Oz).call(this,r)),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),this.unregisterShortcuts(),super.disablePlugin()}updatePlugin(){this.disablePlugin();const e=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(e),super.updatePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast(),r=this.collapsingUI.translateTrimmedRow(e.row);return this.collapsingUI.areChildrenCollapsed(r)?this.collapsingUI.expandChildren(r):this.collapsingUI.collapseChildren(r),!1},runOnlyIf:()=>{var e,r;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n&&((r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.isSingle())&&this.hot.selection.isCellVisible(n)&&n.col===-1&&n.row>=0},group:Az,relativeToGroup:ed,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(Az)}disableCoreAPIModifiers(){L_(H0,this,!0)}enableCoreAPIModifiers(){L_(H0,this,!1)}onModifyRowData(e){if(!DE(H0,this))return this.dataManager.getDataObject(e)}onModifySourceLength(){if(!DE(H0,this))return this.dataManager.countAllRows()}onBeforeDataSplice(e,r,n){return DE(H0,this)||this.dataManager.isRowHighestLevel(e)?!0:(this.dataManager.spliceData(e,r,n),!1)}destroy(){super.destroy()}}function VNe(t,e,r,n){return this.rowMoveController.onBeforeRowMove(t,e,r,n)}function WNe(t,e,r){this.collapsingUI.toggleState(t,e,r)}function $Ne(t,e,r){return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(r[0],e),this.collapsingUI.collapsedRowsStash.shiftStash(r[0],null,-1*e),this.dataManager.filterData(t,e,r),L_(ET,this,!0),this.dataManager.getData().slice()}function UNe(t){return this.contextMenuUI.appendOptions(t)}function jNe(t,e){this.headersUI.appendLevelIndicators(t,e)}function YNe(t){return Math.max(this.headersUI.rowHeaderWidthCache,t)}function zNe(t,e,r,n){n!==this.pluginName&&this.hot._registerTimeout(()=>{L_(ET,this,!1),this.headersUI.updateRowHeaderWidth(),this.collapsingUI.collapsedRowsStash.applyStash()})}function GNe(t,e,r){const n=Array.from(r.reduce((i,s)=>{if(this.dataManager.isParent(s)){const a=this.dataManager.getDataObject(s).__children;return i.add(s),Array.isArray(a)&&a.forEach(o=>i.add(this.dataManager.getRowIndex(o))),i}return i.add(s)},new Set));r.length=0,r.push(...n)}function qNe(){this.collapsingUI.collapsedRowsStash.stash()}function KNe(t,e){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(e)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function XNe(){this.collapsingUI.collapsedRowsStash.stash()}function QNe(t,e,r){this.collapsingUI.collapsedRowsStash.shiftStash(r,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function ZNe(){this.dataManager.rewriteCache()}function JNe(){this.headersUI.updateRowHeaderWidth()}function eHe(t,e){DE(ET,this)&&(e.skipRender=!0)}function Oz(t){if(!wZ(t)){HF(LNe),this.hot.getSettings()[B_]=!1,this.disablePlugin();return}this.dataManager.setData(t),this.dataManager.rewriteCache()}function zP(t,e,r){return(e=tHe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function tHe(t){var e=rHe(t,"string");return typeof e=="symbol"?e:e+""}function rHe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class nHe{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;zP(this,"rootWindow",void 0),zP(this,"prefix",void 0),zP(this,"savedKeys",[]),this.rootWindow=r,this.prefix=e,this.loadSavedKeys()}saveValue(e,r){this.rootWindow.localStorage.setItem(`${this.prefix}_${e}`,JSON.stringify(r)),this.savedKeys.indexOf(e)===-1&&(this.savedKeys.push(e),this.saveSavedKeys())}loadValue(e,r){const n=typeof e>"u"?r:e,i=this.rootWindow.localStorage.getItem(`${this.prefix}_${n}`);return i===null?void 0:JSON.parse(i)}reset(e){this.rootWindow.localStorage.removeItem(`${this.prefix}_${e}`)}resetAll(){he(this.savedKeys,(e,r)=>{this.rootWindow.localStorage.removeItem(`${this.prefix}_${this.savedKeys[r]}`)}),this.clearSavedKeys()}loadSavedKeys(){const e=this.rootWindow.localStorage.getItem(`${this.prefix}__persistentStateKeys`),r=typeof e=="string"?JSON.parse(e):void 0;this.savedKeys=r||[]}saveSavedKeys(){this.rootWindow.localStorage.setItem(`${this.prefix}__persistentStateKeys`,JSON.stringify(this.savedKeys))}clearSavedKeys(){this.savedKeys.length=0,this.saveSavedKeys()}}function iHe(t,e,r){return(e=sHe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function sHe(t){var e=aHe(t,"string");return typeof e=="symbol"?e:e+""}function aHe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}Je.getSingleton().register("persistentStateSave");Je.getSingleton().register("persistentStateLoad");Je.getSingleton().register("persistentStateReset");const kz="persistentState",oHe=0;class lHe extends ur{constructor(){super(...arguments),iHe(this,"storage",void 0)}static get PLUGIN_KEY(){return kz}static get PLUGIN_PRIORITY(){return oHe}isEnabled(){return!!this.hot.getSettings()[kz]}enablePlugin(){this.enabled||(this.storage||(this.storage=new nHe(this.hot.rootContainer.id||this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",(e,r)=>this.saveValue(e,r)),this.addHook("persistentStateLoad",(e,r)=>this.loadValue(e,r)),this.addHook("persistentStateReset",()=>this.resetValue()),super.enablePlugin())}disablePlugin(){this.storage=void 0,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}loadValue(e,r){r.value=this.storage.loadValue(e)}saveValue(e,r){this.storage.saveValue(e,r)}resetValue(e){typeof e>"u"?this.storage.resetAll():this.storage.reset(e)}destroy(){super.destroy()}}function uHe(t,e){cHe(t,e),e.add(t)}function cHe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function GP(t,e,r){return(e=hHe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function hHe(t){var e=fHe(t,"string");return typeof e=="symbol"?e:e+""}function fHe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Dz(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const qP="search",dHe=190,gHe="htSearchResult",mHe=function(t,e,r,n,i){t.getCellMeta(e,r).isSearchResult=i},pHe=function(t,e,r){return gn(t)||t===null||!t.toLocaleLowerCase||t.length===0||gn(e)||e===null?!1:e.toString().toLocaleLowerCase(r.locale).indexOf(t.toLocaleLowerCase(r.locale))!==-1};var KP=new WeakSet;class vHe extends ur{constructor(){super(...arguments),uHe(this,KP),GP(this,"callback",mHe),GP(this,"queryMethod",pHe),GP(this,"searchResultClass",gHe)}static get PLUGIN_KEY(){return qP}static get PLUGIN_PRIORITY(){return dHe}isEnabled(){return this.hot.getSettings()[qP]}enablePlugin(){var e=this;if(this.enabled)return;const r=this.hot.getSettings()[qP];this.updatePluginSettings(r),this.addHook("beforeRenderer",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Dz(KP,e,Pz).call(e,...i)}),super.enablePlugin()}disablePlugin(){var e=this;const r=function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Dz(KP,e,Pz).call(e,...i)};this.hot.addHook("beforeRenderer",r),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("beforeRenderer",r)}),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}query(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getCallback(),n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getQueryMethod();const i=this.hot.countRows(),s=this.hot.countCols(),a=[],o=this.hot;return ct(0,i-1,u=>{ct(0,s-1,c=>{const f=this.hot.getDataAtCell(u,c),g=this.hot.getCellMeta(u,c),m=g.search.callback||r,w=(g.search.queryMethod||n)(e,f,g);if(w){const y={row:u,col:c,data:f};a.push(y)}m&&m(o,u,c,f,w)})}),a}getCallback(){return this.callback}setCallback(e){this.callback=e}getQueryMethod(){return this.queryMethod}setQueryMethod(e){this.queryMethod=e}getSearchResultClass(){return this.searchResultClass}setSearchResultClass(e){this.searchResultClass=e}updatePluginSettings(e){Vt(e)&&(e.searchResultClass&&this.setSearchResultClass(e.searchResultClass),e.queryMethod&&this.setQueryMethod(e.queryMethod),e.callback&&this.setCallback(e.callback))}destroy(){super.destroy()}}function Pz(t,e,r,n,i,s){const a=s.className||[];let o=[];typeof a=="string"?o=a.split(" "):o.push(...a),this.isEnabled()&&s.isSearchResult?o.includes(this.searchResultClass)||o.push(`${this.searchResultClass}`):o.includes(this.searchResultClass)&&o.splice(o.indexOf(this.searchResultClass),1),s.className=o.join(" ")}function Dx(t,e,r){return(e=wHe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function wHe(t){var e=yHe(t,"string");return typeof e=="symbol"?e:e+""}function yHe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class dte{constructor(e){Dx(this,"viewportWidth",void 0),Dx(this,"overwriteColumnWidthFn",void 0),Dx(this,"baseWidths",new Map),Dx(this,"stretchedWidths",new Map),this.overwriteColumnWidthFn=e}prepare(e){let{viewportWidth:r}=e;this.viewportWidth=r,this.baseWidths.clear(),this.stretchedWidths.clear()}setColumnBaseWidth(e,r){this.baseWidths.set(e,r)}calculate(){}getWidths(){return Array.from(this.stretchedWidths)}}class SHe extends dte{calculate(){const e=Array.from(this.baseWidths).reduce((g,m)=>{let[,v]=m;return g+v},0);if(this.viewportWidth-e<0){this.stretchedWidths.clear();return}const n=this.viewportWidth/e,i=[],s=[];let a=this.viewportWidth,o=0;if(this.baseWidths.forEach((g,m)=>{const v=Math.round(g*n),w=this.overwriteColumnWidthFn(v,m);v===w&&v>=Op?(i.push([m,w]),o+=w):v!==w&&(i.push([m,w]),s.push(m),a-=w)}),a<=Op){this.stretchedWidths.clear();return}const u=a/o;let c=-1,f=0;i.forEach((g,m)=>{let[v,w]=g,y=w;s.includes(v)||(y=Math.round(w*u)),this.stretchedWidths.set(v,y),c=v,m<i.length-1&&(f+=y)}),this.stretchedWidths.size>1&&this.stretchedWidths.set(c,Math.round(this.viewportWidth-f))}}function Iz(t,e,r){bHe(t,e),e.set(t,r)}function bHe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function XP(t,e){return t.get(gte(t,e))}function Px(t,e,r){return t.set(gte(t,e),r),r}function gte(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Ix=new WeakMap,dy=new WeakMap;class CHe extends dte{constructor(){super(...arguments),Iz(this,Ix,0),Iz(this,dy,-1)}prepare(e){super.prepare(e),Px(Ix,this,0),Px(dy,this,-1)}setColumnBaseWidth(e,r){super.setColumnBaseWidth(e,r),Px(dy,this,e),Px(Ix,this,r)}calculate(){if(XP(dy,this)===-1)return;const e=Array.from(this.baseWidths).reduce((n,i)=>{let[,s]=i;return n+s},0),r=Math.max(this.viewportWidth-e+XP(Ix,this),0);this.stretchedWidths.set(XP(dy,this),r)}}function xHe(t,e){mte(t,e),e.add(t)}function Nx(t,e,r){mte(t,e),e.set(t,r)}function mte(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Bn(t,e){return t.get(sp(t,e))}function QP(t,e,r){return t.set(sp(t,e),r),r}function sp(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const EHe="stretchColumns";var ps=new WeakMap,F0=new WeakMap,ZP=new WeakMap,Hx=new WeakMap,gy=new WeakSet;class _He{constructor(e){xHe(this,gy),Nx(this,ps,void 0),Nx(this,F0,void 0),Nx(this,ZP,new Map([["all",new SHe(sp(gy,this,Nz).bind(this))],["last",new CHe(sp(gy,this,Nz).bind(this))]])),Nx(this,Hx,"none"),QP(ps,this,e),QP(F0,this,Bn(ps,this).columnIndexMapper.createAndRegisterIndexMap(EHe,"physicalIndexToValue"))}useStrategy(e){QP(Hx,this,Bn(ZP,this).has(e)?e:"none")}refreshStretching(){if(Bn(Hx,this)==="none"){Bn(F0,this).clear();return}Bn(ps,this).batchExecution(()=>{Bn(F0,this).clear();const e=Bn(ZP,this).get(Bn(Hx,this));let n=Bn(ps,this).view.getViewportWidth();sp(gy,this,RHe).call(this)&&(n-=Ni(Bn(ps,this).rootDocument)),e.prepare({viewportWidth:n});for(let i=0;i<Bn(ps,this).countCols();i++)Bn(ps,this).columnIndexMapper.isHidden(Bn(ps,this).toPhysicalColumn(i))||e.setColumnBaseWidth(i,sp(gy,this,THe).call(this,i));e.calculate(),e.getWidths().forEach(i=>{let[s,a]=i;Bn(F0,this).setValueAtIndex(Bn(ps,this).toPhysicalColumn(s),a)})},!0)}getStretchedWidth(e){return Bn(F0,this).getValueAtIndex(Bn(ps,this).toPhysicalColumn(e))}}function RHe(){const{view:t,stylesHandler:e}=Bn(ps,this);if(t.isVerticallyScrollableByWindow())return!1;const r=t.getViewportHeight(),n=Bn(ps,this).countRows(),i=e.getDefaultRowHeight();let s=0,a=!1;for(let u=0;u<n;u++){var o;if(s+=((o=Bn(ps,this).getRowHeight(u))!==null&&o!==void 0?o:i)+(u===0?1:0),s>r){a=!0;break}}return a}function THe(t){var e;return(e=Bn(ps,this).getColWidth(t,"StretchColumns"))!==null&&e!==void 0?e:Op}function Nz(t,e){return Bn(ps,this).runHooks("beforeStretchingColumnWidth",t,e)}function MHe(t,e){pte(t,e),e.add(t)}function JP(t,e,r){pte(t,e),e.set(t,r)}function pte(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function eI(t,e,r){return t.set(V_(t,e),r),r}function Oc(t,e){return t.get(V_(t,e))}function V_(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const AHe="stretchColumns",OHe=155;var Q0=new WeakMap,Fx=new WeakMap,my=new WeakMap,tI=new WeakSet;class kHe extends ur{constructor(){super(...arguments),MHe(this,tI),JP(this,Q0,new _He(this.hot)),JP(this,Fx,null),JP(this,my,new ResizeObserver(e=>{requestAnimationFrame(()=>{var r;(r=this.hot)!==null&&r!==void 0&&r.view.isHorizontallyScrollableByWindow()&&e.forEach(n=>{let{contentRect:i}=n;Oc(Fx,this)!==null&&Oc(Fx,this)!==i.width&&(this.hot.refreshDimensions(),this.hot.view.adjustElementsSize()),eI(Fx,this,i.width)})})}))}static get PLUGIN_KEY(){return AHe}static get PLUGIN_PRIORITY(){return OHe}static get SETTING_KEYS(){return!0}isEnabled(){return["all","last"].includes(this.hot.getSettings().stretchH)}enablePlugin(){var e=this;this.enabled||(Oc(Q0,this).useStrategy(this.hot.getSettings().stretchH),Oc(my,this).observe(this.hot.rootElement),this.addHook("beforeRender",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return V_(tI,e,PHe).call(e,...n)}),this.addHook("modifyColWidth",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return V_(tI,e,DHe).call(e,...n)},10),super.enablePlugin())}updatePlugin(){Oc(Q0,this).useStrategy(this.hot.getSettings().stretchH),super.updatePlugin()}disablePlugin(){super.disablePlugin(),Oc(my,this).unobserve(this.hot.rootElement)}getColumnWidth(e){return Oc(Q0,this).getStretchedWidth(e)}destroy(){Oc(my,this).disconnect(),eI(my,this,null),eI(Q0,this,null),super.destroy()}}function DHe(t,e,r){if(r===this.pluginName)return;const n=this.getColumnWidth(e);return typeof n=="number"?n:t}function PHe(t){t&&Oc(Q0,this).refreshStretching()}function IHe(t,e){NHe(t,e),e.add(t)}function NHe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Lx(t,e,r){return(e=HHe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function HHe(t){var e=FHe(t,"string");return typeof e=="symbol"?e:e+""}function FHe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function rI(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const LHe="touchScroll",BHe=200;var Bx=new WeakSet;class VHe extends ur{constructor(){super(...arguments),IHe(this,Bx),Lx(this,"scrollbars",[]),Lx(this,"clones",[]),Lx(this,"lockedCollection",!1),Lx(this,"freezeOverlays",!1)}static get PLUGIN_KEY(){return LHe}static get PLUGIN_PRIORITY(){return BHe}static get SETTING_KEYS(){return!0}isEnabled(){return yF()}enablePlugin(){this.enabled||(this.addHook("afterViewRender",()=>rI(Bx,this,WHe).call(this)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.lockedCollection=!1,super.updatePlugin()}disablePlugin(){super.disablePlugin()}registerEvents(){this.addHook("beforeTouchScroll",()=>rI(Bx,this,$He).call(this)),this.addHook("afterMomentumScroll",()=>rI(Bx,this,UHe).call(this))}}function WHe(){if(this.lockedCollection)return;const{topOverlay:t,bottomOverlay:e,inlineStartOverlay:r,topInlineStartCornerOverlay:n,bottomInlineStartCornerOverlay:i}=this.hot.view._wt.wtOverlays;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(t),e.clone&&this.scrollbars.push(e),this.scrollbars.push(r),n&&this.scrollbars.push(n),i&&i.clone&&this.scrollbars.push(i),this.clones=[],t.needFullRender&&this.clones.push(t.clone.wtTable.holder.parentNode),e.needFullRender&&this.clones.push(e.clone.wtTable.holder.parentNode),r.needFullRender&&this.clones.push(r.clone.wtTable.holder.parentNode),n&&this.clones.push(n.clone.wtTable.holder.parentNode),i&&i.clone&&this.clones.push(i.clone.wtTable.holder.parentNode)}function $He(){this.freezeOverlays=!0,he(this.clones,t=>{Ve(t,"hide-tween")})}function UHe(){this.freezeOverlays=!1,he(this.clones,t=>{wt(t,"hide-tween"),Ve(t,"show-tween")}),this.hot._registerTimeout(()=>{he(this.clones,t=>{wt(t,"show-tween")})},400),he(this.scrollbars,t=>{t.refresh(),t.resetFixedPosition()}),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}function jHe(t,e){YHe(t,e),e.add(t)}function YHe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function zHe(t,e,r){return(e=GHe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function GHe(t){var e=qHe(t,"string");return typeof e=="symbol"?e:e+""}function qHe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function KHe(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const PE="trimRows",XHe=330;var Hz=new WeakSet;class QHe extends ur{constructor(){super(...arguments),jHe(this,Hz),zHe(this,"trimmedRowsMap",null)}static get PLUGIN_KEY(){return PE}static get PLUGIN_PRIORITY(){return XHe}isEnabled(){return!!this.hot.getSettings()[PE]}enablePlugin(){this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new TS),this.trimmedRowsMap.addLocalHook("init",()=>KHe(Hz,this,ZHe).call(this)),super.enablePlugin())}updatePlugin(){const e=this.hot.getSettings()[PE];Array.isArray(e)&&this.hot.batchExecution(()=>{this.trimmedRowsMap.clear(),he(e,r=>{this.trimmedRowsMap.setValueAtIndex(r,!0)})},!0),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("trimRows"),super.disablePlugin()}getTrimmedRows(){return this.trimmedRowsMap.getTrimmedIndexes()}trimRows(e){const r=this.getTrimmedRows(),n=this.isValidConfig(e);let i=r;n&&(i=Array.from(new Set(r.concat(e)))),this.hot.runHooks("beforeTrimRow",r,i,n)!==!1&&(n&&this.hot.batchExecution(()=>{he(e,a=>{this.trimmedRowsMap.setValueAtIndex(a,!0)})},!0),this.hot.runHooks("afterTrimRow",r,i,n,n&&i.length>r.length))}trimRow(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];this.trimRows(r)}untrimRows(e){const r=this.getTrimmedRows(),n=this.isValidConfig(e);let i=r;const s=this.trimmedRowsMap.getValues().slice(),a=e.length>0;n&&a&&(he(e,u=>{s[u]=!1}),i=Ri(s,(u,c,f)=>(c&&u.push(f),u),[])),this.hot.runHooks("beforeUntrimRow",r,i,n&&a)!==!1&&(n&&a&&this.trimmedRowsMap.setValues(s),this.hot.runHooks("afterUntrimRow",r,i,n&&a,n&&i.length<r.length))}untrimRow(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];this.untrimRows(r)}isTrimmed(e){return this.trimmedRowsMap.getValueAtIndex(e)||!1}untrimAll(){this.untrimRows(this.getTrimmedRows())}isValidConfig(e){const r=this.hot.countSourceRows();return e.every(n=>Number.isInteger(n)&&n>=0&&n<r)}destroy(){super.destroy()}}function ZHe(){const t=this.hot.getSettings()[PE];Array.isArray(t)&&this.hot.batchExecution(()=>{he(t,e=>{this.trimmedRowsMap.setValueAtIndex(e,!0)})},!0)}function JHe(t,e,r){return(e=eFe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function eFe(t){var e=tFe(t,"string");return typeof e=="symbol"?e:e+""}function tFe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Jo{constructor(e){JHe(this,"actionType",""),this.actionType=e}undo(){throw new Error("Not implemented")}redo(){throw new Error("Not implemented")}}function Vx(t,e,r){return(e=rFe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function rFe(t){var e=nFe(t,"string");return typeof e=="symbol"?e:e+""}function nFe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class _3 extends Jo{constructor(e){let{stateBefore:r,range:n,type:i,alignment:s}=e;super("cell_alignment"),Vx(this,"stateBefore",void 0),Vx(this,"range",void 0),Vx(this,"type",void 0),Vx(this,"alignment",void 0),this.stateBefore=r,this.range=n,this.type=i,this.alignment=s}static startRegisteringEvents(e,r){e.addHook("beforeCellAlignment",(n,i,s,a)=>{r.done(()=>new _3({stateBefore:n,range:i,type:s,alignment:a}))})}undo(e,r){he(this.range,n=>{n.forAll((i,s)=>{i>=0&&s>=0&&e.setCellMeta(i,s,"className",this.stateBefore[i][s]||" htLeft")})}),e.addHookOnce("afterViewRender",r),e.render()}redo(e,r){lf(this.range,this.type,this.alignment,(n,i)=>e.getCellMeta(n,i),(n,i,s,a)=>e.setCellMeta(n,i,s,a)),e.addHookOnce("afterViewRender",r),e.render()}}function Fz(t,e,r){return(e=iFe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function iFe(t){var e=sFe(t,"string");return typeof e=="symbol"?e:e+""}function sFe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class R3 extends Jo{constructor(e){let{columns:r,finalIndex:n}=e;super("col_move"),Fz(this,"columns",void 0),Fz(this,"finalColumnIndex",void 0),this.columns=r.slice(),this.finalColumnIndex=n}static startRegisteringEvents(e,r){e.addHook("beforeColumnMove",(n,i)=>{n!==!1&&r.done(()=>new R3({columns:n,finalIndex:i}))})}undo(e,r){const n=e.getPlugin("manualColumnMove");e.addHookOnce("afterViewRender",r),S3(this.columns,this.finalColumnIndex,e.columnIndexMapper.getNumberOfIndexes()).reverse().forEach(s=>{let{from:a,to:o}=s;a<o&&(o-=1),n.moveColumn(o,a)}),e.render(),e.deselectCell(),e.selectColumns(this.columns[0],this.columns[0]+this.columns.length-1)}redo(e,r){const n=e.getPlugin("manualColumnMove");e.addHookOnce("afterViewRender",r),n.moveColumns(this.columns.slice(),this.finalColumnIndex),e.render(),e.deselectCell(),e.selectColumns(this.finalColumnIndex,this.finalColumnIndex+this.columns.length-1)}}function Lz(t,e,r){return(e=aFe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function aFe(t){var e=oFe(t,"string");return typeof e=="symbol"?e:e+""}function oFe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class T3 extends Jo{constructor(e){let{currentSortState:r,newSortState:n}=e;super("col_sort"),Lz(this,"previousSortState",void 0),Lz(this,"nextSortState",void 0),this.previousSortState=r,this.nextSortState=n}static startRegisteringEvents(e,r){e.addHook("beforeColumnSort",(n,i,s)=>{s&&r.done(()=>new T3({currentSortState:n,newSortState:i}))})}undo(e,r){const n=e.getPlugin("columnSorting"),i=e.getPlugin("multiColumnSorting"),s=i.isEnabled()?i:n;this.previousSortState.length?s.sort(this.previousSortState):s.clearSort(),r()}redo(e,r){const n=e.getPlugin("columnSorting"),i=e.getPlugin("multiColumnSorting");(i.isEnabled()?i:n).sort(this.nextSortState),r()}}function Bz(t,e,r){return(e=lFe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function lFe(t){var e=uFe(t,"string");return typeof e=="symbol"?e:e+""}function uFe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class M3 extends Jo{constructor(e){let{index:r,amount:n}=e;super("insert_col"),Bz(this,"index",void 0),Bz(this,"amount",void 0),this.index=r,this.amount=n}static startRegisteringEvents(e,r){e.addHook("afterCreateCol",(n,i,s)=>{r.done(()=>new M3({index:n,amount:i}),s)})}undo(e,r){e.addHookOnce("afterRemoveCol",r),e.alter("remove_col",this.index,this.amount,"UndoRedo.undo")}redo(e,r){e.addHookOnce("afterCreateCol",r),e.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")}}function Vz(t,e,r){return(e=cFe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function cFe(t){var e=hFe(t,"string");return typeof e=="symbol"?e:e+""}function hFe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class A3 extends Jo{constructor(e){let{index:r,amount:n}=e;super("insert_row"),Vz(this,"index",void 0),Vz(this,"amount",void 0),this.index=r,this.amount=n}static startRegisteringEvents(e,r){e.addHook("afterCreateRow",(n,i,s)=>{r.done(()=>new A3({index:n,amount:i}),s)})}undo(e,r){const n=e.countRows(),i=e.getSettings().minSpareRows;this.index>=n&&this.index-i<n&&(this.index-=i),e.addHookOnce("afterRemoveRow",r),e.alter("remove_row",this.index,this.amount,"UndoRedo.undo")}redo(e,r){e.addHookOnce("afterCreateRow",r),e.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")}}function Wx(t,e,r){return(e=fFe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function fFe(t){var e=dFe(t,"string");return typeof e=="symbol"?e:e+""}function dFe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class O3 extends Jo{constructor(e){let{changes:r,selected:n,countCols:i,countRows:s}=e;super("change"),Wx(this,"changes",void 0),Wx(this,"selected",void 0),Wx(this,"countCols",void 0),Wx(this,"countRows",void 0),this.changes=r,this.selected=n,this.countCols=i,this.countRows=s}static startRegisteringEvents(e,r){e.addHook("beforeChange",function(n,i){const s=n&&n.length;if(!s||!n.find(u=>{const[,,c,f]=u;return c!==f}))return;const o=()=>{const u=n.reduce((f,g)=>(f.push([...g]),f),[]);u.forEach(f=>{f[1]=e.propToCol(f[1])});const c=s>1?this.getSelected():[[u[0][0],u[0][1]]];return new O3({changes:u,selected:c,countCols:e.countCols(),countRows:e.countRows()})};r.done(o,i)})}undo(e,r){const n=As(this.changes);for(let a=0,o=n.length;a<o;a++)n[a].splice(3,1);e.addHookOnce("afterChange",r),e.setDataAtCell(n,null,null,"UndoRedo.undo");const i=e.countRows()-this.countRows;i>0&&e.alter("remove_row",null,i,"UndoRedo.undo");const s=e.countCols()-this.countCols;s>0&&e.isColumnModificationAllowed()&&e.alter("remove_col",null,s,"UndoRedo.undo"),e.scrollToFocusedCell(),e.selectCells(this.selected,!1,!1)}redo(e,r){const n=As(this.changes);for(let i=0,s=n.length;i<s;i++)n[i].splice(2,1);e.addHookOnce("afterChange",r),e.setDataAtCell(n,null,null,"UndoRedo.redo"),this.selected&&e.selectCells(this.selected,!1,!1)}}function Wz(t,e,r){return(e=gFe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function gFe(t){var e=mFe(t,"string");return typeof e=="symbol"?e:e+""}function mFe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class k3 extends Jo{constructor(e){let{conditionsStack:r,previousConditionsStack:n}=e;super("filter"),Wz(this,"conditionsStack",void 0),Wz(this,"previousConditionsStack",void 0),this.conditionsStack=r,this.previousConditionsStack=n}static startRegisteringEvents(e,r){e.addHook("beforeFilter",(n,i)=>{r.done(()=>new k3({conditionsStack:n,previousConditionsStack:i}))})}undo(e,r){const n=e.getPlugin("filters");e.addHookOnce("afterViewRender",r),n.importConditions(this.previousConditionsStack),n.filter()}redo(e,r){const n=e.getPlugin("filters");e.addHookOnce("afterViewRender",r),n.importConditions(this.conditionsStack),n.filter()}}function pFe(t,e,r){return(e=vFe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function vFe(t){var e=wFe(t,"string");return typeof e=="symbol"?e:e+""}function wFe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class D3 extends Jo{constructor(e){let{data:r,cellRange:n}=e;super("merge_cells"),pFe(this,"cellRange",void 0),this.cellRange=n,this.data=r}static startRegisteringEvents(e,r){e.addHook("beforeMergeCells",(n,i)=>{if(i)return;const s=n.getTopStartCorner(),a=n.getBottomEndCorner(),o=e.getData(s.row,s.col,a.row,a.col);r.done(()=>new D3({data:o,cellRange:n}))})}undo(e,r){const n=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",r),n.unmergeRange(this.cellRange,!0);const i=this.cellRange.getTopStartCorner();e.populateFromArray(i.row,i.col,this.data,void 0,void 0,"MergeCells")}redo(e,r){const n=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",r),n.mergeRange(this.cellRange)}}function vte(t,e,r,n,i){const s=["visualRow","visualCol","row","col","prop"],a=s.length,o=[];return ct(n,i,u=>{ct(e,r,c=>{const f=t.getCellMeta(c,u);if(Object.keys(f).length!==a){const g=Object.fromEntries(Object.entries(f).filter(m=>{let[v]=m;return s.includes(v)===!1}));o.push([f.visualRow,f.visualCol,g])}})}),o}function _c(t,e,r){return(e=yFe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function yFe(t){var e=SFe(t,"string");return typeof e=="symbol"?e:e+""}function SFe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class P3 extends Jo{constructor(e){let{index:r,indexes:n,data:i,amount:s,headers:a,columnPositions:o,rowPositions:u,fixedColumnsStart:c,removedCellMetas:f}=e;super("remove_col"),_c(this,"index",void 0),_c(this,"indexes",void 0),_c(this,"data",void 0),_c(this,"amount",void 0),_c(this,"headers",void 0),_c(this,"columnPositions",void 0),_c(this,"rowPositions",void 0),_c(this,"fixedColumnsStart",void 0),_c(this,"removedCellMetas",void 0),this.index=r,this.indexes=n,this.data=i,this.amount=s,this.headers=a,this.columnPositions=o.slice(0),this.rowPositions=u.slice(0),this.fixedColumnsStart=c,this.removedCellMetas=f}static startRegisteringEvents(e,r){e.addHook("beforeRemoveCol",(n,i,s,a)=>{const o=()=>{const u=e.getSourceDataArray(),c=(e.countCols()+n)%e.countCols(),f=c+i-1,g=[],m=[],v=[];return ct(u.length-1,w=>{const y=[],b=u[w];ct(c,f,x=>{y.push(b[e.toPhysicalColumn(x)])}),g.push(y)}),ct(i-1,w=>{v.push(e.toPhysicalColumn(c+w))}),Array.isArray(e.getSettings().colHeaders)&&ct(i-1,w=>{m.push(e.getSettings().colHeaders[e.toPhysicalColumn(c+w)]||null)}),new P3({index:c,indexes:v,data:g,amount:i,headers:m,columnPositions:e.columnIndexMapper.getIndexesSequence(),rowPositions:e.rowIndexMapper.getIndexesSequence(),fixedColumnsStart:e.getSettings().fixedColumnsStart,removedCellMetas:vte(e,0,e.countRows(),c,f)})};r.done(o,a)})}undo(e,r){const n=e.getSettings();n.fixedColumnsStart=this.fixedColumnsStart;const i=this.indexes.slice(0).sort(),s=(f,g,m)=>m[this.indexes.indexOf(i[g])],a=this.data.length,o=[];for(let f=0;f<a;f++)o.push(nr(this.data[f],s));const u=nr(this.headers,s),c=[];e.columnIndexMapper.setIndexesSequence(this.columnPositions),e.alter("insert_col_start",e.toVisualColumn(this.indexes[0]),this.indexes.length,"UndoRedo.undo"),e.batchExecution(()=>{e.rowIndexMapper.setIndexesSequence(this.rowPositions),e.columnIndexMapper.setIndexesSequence(this.columnPositions)},!0),he(e.getSourceDataArray(),(f,g)=>{he(i,(m,v)=>{f[m]=o[g][v],c.push([g,m,f[m]])})}),typeof this.headers<"u"&&he(u,(f,g)=>{e.getSettings().colHeaders[i[g]]=f}),this.removedCellMetas.forEach(f=>{let[g,m,v]=f;e.setCellMetaObject(g,m,v)}),e.addHookOnce("afterViewRender",r),e.setSourceDataAtCell(c,null,null,"UndoRedo.undo")}redo(e,r){e.addHookOnce("afterRemoveCol",r),e.alter("remove_col",this.index,this.amount,"UndoRedo.redo")}}function L0(t,e,r){return(e=bFe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function bFe(t){var e=CFe(t,"string");return typeof e=="symbol"?e:e+""}function CFe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class I3 extends Jo{constructor(e){let{index:r,data:n,fixedRowsBottom:i,fixedRowsTop:s,rowIndexesSequence:a,removedCellMetas:o}=e;super("remove_row"),L0(this,"index",void 0),L0(this,"data",void 0),L0(this,"fixedRowsBottom",void 0),L0(this,"fixedRowsTop",void 0),L0(this,"rowIndexesSequence",void 0),L0(this,"removedCellMetas",void 0),this.index=r,this.data=n,this.fixedRowsBottom=i,this.fixedRowsTop=s,this.rowIndexesSequence=a,this.removedCellMetas=o}static startRegisteringEvents(e,r){e.addHook("beforeRemoveRow",(n,i,s,a)=>{const o=()=>{const u=e.toPhysicalRow(n),c=u+i-1,f=As(e.getSourceData(u,0,u+i-1,e.countSourceCols()-1));return new I3({index:u,data:f,fixedRowsBottom:e.getSettings().fixedRowsBottom,fixedRowsTop:e.getSettings().fixedRowsTop,rowIndexesSequence:e.rowIndexMapper.getIndexesSequence(),removedCellMetas:vte(e,u,c,0,e.countCols()-1)})};r.done(o,a)})}undo(e,r){const n=e.getSettings(),i=[];n.fixedRowsBottom=this.fixedRowsBottom,n.fixedRowsTop=this.fixedRowsTop,this.data.forEach((s,a)=>{Object.keys(s).forEach(o=>{const u=parseInt(o,10);i.push([this.index+a,isNaN(u)?o:u,s[o]])})}),e.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence),e.alter("insert_row_above",e.toVisualRow(this.index),this.data.length,"UndoRedo.undo"),e.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence),this.removedCellMetas.forEach(s=>{let[a,o,u]=s;e.setCellMetaObject(a,o,u)}),e.addHookOnce("afterViewRender",r),e.setSourceDataAtCell(i,null,null,"UndoRedo.undo")}redo(e,r){e.addHookOnce("afterRemoveRow",r),e.alter("remove_row",e.toVisualRow(this.index),this.data.length,"UndoRedo.redo")}}function $z(t,e,r){return(e=xFe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function xFe(t){var e=EFe(t,"string");return typeof e=="symbol"?e:e+""}function EFe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class N3 extends Jo{constructor(e){let{rows:r,finalIndex:n}=e;super("row_move"),$z(this,"rows",void 0),$z(this,"finalRowIndex",void 0),this.rows=r.slice(),this.finalRowIndex=n}static startRegisteringEvents(e,r){e.addHook("beforeRowMove",(n,i)=>{n!==!1&&r.done(()=>new N3({rows:n,finalIndex:i}))})}undo(e,r){const n=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",r),S3(this.rows,this.finalRowIndex,e.rowIndexMapper.getNumberOfIndexes()).reverse().forEach(s=>{let{from:a,to:o}=s;a<o&&(o-=1),n.moveRow(o,a)}),e.render(),e.deselectCell(),e.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)}redo(e,r){const n=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",r),n.moveRows(this.rows.slice(),this.finalRowIndex),e.render(),e.deselectCell(),e.selectRows(this.finalRowIndex,this.finalRowIndex+this.rows.length-1)}}function _Fe(t,e,r){return(e=RFe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function RFe(t){var e=TFe(t,"string");return typeof e=="symbol"?e:e+""}function TFe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class H3 extends Jo{constructor(e){let{cellRange:r}=e;super("unmerge_cells"),_Fe(this,"cellRange",void 0),this.cellRange=r}static startRegisteringEvents(e,r){e.addHook("afterUnmergeCells",(n,i)=>{i||r.done(()=>new H3({cellRange:n}))})}undo(e,r){const n=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",r),n.mergeRange(this.cellRange,!0)}redo(e,r){const n=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",r),n.unmergeRange(this.cellRange,!0),e.render()}}function MFe(t,e){[_3,R3,T3,M3,A3,O3,k3,D3,P3,I3,N3,H3].forEach(r=>r.startRegisteringEvents(t,e))}function AFe(t,e){OFe(t,e),e.add(t)}function OFe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function nI(t,e,r){return(e=kFe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function kFe(t){var e=DFe(t,"string");return typeof e=="symbol"?e:e+""}function DFe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function iI(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const Uz="undoRedo",PFe="undoRedo",IFe=1e3;Je.getSingleton().register("beforeUndo");Je.getSingleton().register("afterUndo");Je.getSingleton().register("beforeRedo");Je.getSingleton().register("afterRedo");const jz=new Set;var $x=new WeakSet;class NFe extends ur{static get PLUGIN_KEY(){return PFe}static get PLUGIN_PRIORITY(){return IFe}static get SETTING_KEYS(){return!0}constructor(e){super(e),AFe(this,$x),nI(this,"doneActions",[]),nI(this,"undoneActions",[]),nI(this,"ignoreNewActions",!1),MFe(e,this)}isEnabled(){return!!this.hot.getSettings().undo}enablePlugin(){var e=this;this.enabled||(this.addHook("afterChange",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return iI($x,e,HFe).call(e,...n)}),this.registerShortcuts(),iI($x,this,FFe).call(this),super.enablePlugin())}disablePlugin(){super.disablePlugin(),this.clear(),this.unregisterShortcuts(),iI($x,this,LFe).call(this)}registerShortcuts(){const r=this.hot.getShortcutManager().getContext("grid"),i={runOnlyIf:s=>!s.altKey,group:Uz};r.addShortcuts([{keys:[["Control/Meta","z"]],callback:()=>{this.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:()=>{this.redo()}}],i)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(Uz)}done(e,r){if(this.ignoreNewActions||r==="UndoRedo.undo"||r==="UndoRedo.redo"||r==="auto")return;const i=this.doneActions.slice();if(this.hot.runHooks("beforeUndoStackChange",i,r)===!1)return;const a=e(),o=this.undoneActions.slice();this.doneActions.push(a),this.hot.runHooks("afterUndoStackChange",i,this.doneActions.slice()),this.hot.runHooks("beforeRedoStackChange",o),this.undoneActions.length=0,this.hot.runHooks("afterRedoStackChange",o,this.undoneActions.slice())}undo(){if(!this.isUndoAvailable())return;const e=this.doneActions.slice();this.hot.runHooks("beforeUndoStackChange",e);const r=this.doneActions.pop();this.hot.runHooks("afterUndoStackChange",e,this.doneActions.slice());const n=As(r);if(this.hot.runHooks("beforeUndo",n)===!1)return;this.ignoreNewActions=!0;const s=this.undoneActions.slice();this.hot.runHooks("beforeRedoStackChange",s),r.undo(this.hot,()=>{this.ignoreNewActions=!1,this.undoneActions.push(r)}),this.hot.runHooks("afterRedoStackChange",s,this.undoneActions.slice()),this.hot.runHooks("afterUndo",n)}redo(){if(!this.isRedoAvailable())return;const e=this.undoneActions.slice();this.hot.runHooks("beforeRedoStackChange",e);const r=this.undoneActions.pop();this.hot.runHooks("afterRedoStackChange",e,this.undoneActions.slice());const n=As(r);if(this.hot.runHooks("beforeRedo",n)===!1)return;this.ignoreNewActions=!0;const s=this.doneActions.slice();this.hot.runHooks("beforeUndoStackChange",s),r.redo(this.hot,()=>{this.ignoreNewActions=!1,this.doneActions.push(r)}),this.hot.runHooks("afterUndoStackChange",s,this.doneActions.slice()),this.hot.runHooks("afterRedo",n)}isUndoAvailable(){return this.doneActions.length>0}isRedoAvailable(){return this.undoneActions.length>0}clear(){this.doneActions.length=0,this.undoneActions.length=0}destroy(){this.clear(),this.doneActions=null,this.undoneActions=null,super.destroy()}}function HFe(t,e){e==="loadData"&&this.clear()}function FFe(){const t=e=>{jz.has(e)||(br(Dr`The "${e}" method is deprecated and it will be removed\x20
          from the Core API in the future. Please use the method from the UndoRedo plugin\x20
          (e.g. \`hotInstance.getPlugin("undoRedo").${e}()\`).`),jz.add(e))};this.hot.undo=()=>{t("undo"),this.undo()},this.hot.redo=()=>{t("redo"),this.redo()},this.hot.isUndoAvailable=()=>(t("isUndoAvailable"),this.isUndoAvailable()),this.hot.isRedoAvailable=()=>(t("isRedoAvailable"),this.isRedoAvailable()),this.hot.clearUndo=()=>{t("clear"),this.clear()},this.hot.undoRedo=this}function LFe(){delete this.hot.undo,delete this.hot.redo,delete this.hot.isUndoAvailable,delete this.hot.isRedoAvailable,delete this.hot.clearUndo,delete this.hot.undoRedo}function BFe(){lr(Wy),lr(e_e),lr($y),lr(k_e),lr(B_e),lr(BJ),lr(IRe),lr(wTe),lr(vT),lr(RMe),lr(ZMe),lr(aAe),lr(ST),lr($Ae),lr(Fke),lr(pDe),lr(UDe),lr(t2e),lr(d2e),lr(E2e),lr(I2e),lr(Z2e),lr(oPe),lr(jPe),lr(CIe),lr(TIe),lr(JIe),lr(BNe),lr(lHe),lr(vHe),lr(kHe),lr(VHe),lr(QHe),lr(NFe)}function VFe(){_Ce(),qxe(),nEe(),CEe(),BFe()}function WFe(t){const e=typeof window>"u"?!1:window.jQuery;e&&(e.fn.handsontable=function(r){const n=this.first();let i=n.data("handsontable");if(typeof r!="string"){const c=r||{};return i?i.updateSettings(c):(i=new t.Core(n[0],c),n.data("handsontable",i),i.init()),n}let s;if(i)if(typeof i[r]<"u"){for(var a=arguments.length,o=new Array(a>1?a-1:0),u=1;u<a;u++)o[u-1]=arguments[u];s=i[r].call(i,...o),r==="destroy"&&n.removeData()}else throw new Error(`Handsontable do not provide action: ${r}`);return s})}var sI,aI,oI,lI,uI;VFe();WFe(tt);tt.__GhostTable=i3;tt._getListenersCounter=D0e;tt._getRegisteredMapsCounter=Hye;tt.EventManager=Uo;const $Fe=[cme,Gme,bye,Xxe,jme,a0e,gme,J0e,Ume,pme,u0e,Z0e],UFe=[r0e,c0e];tt.helper={};tt.dom={};he($Fe,t=>{he(Object.getOwnPropertyNames(t),e=>{e.charAt(0)!=="_"&&(tt.helper[e]=t[e])})});he(UFe,t=>{he(Object.getOwnPropertyNames(t),e=>{e.charAt(0)!=="_"&&(tt.dom[e]=t[e])})});tt.cellTypes=(sI=tt.cellTypes)!==null&&sI!==void 0?sI:{};he(V1e(),t=>{tt.cellTypes[t]=H4(t)});tt.cellTypes.registerCellType=xo;tt.cellTypes.getCellType=H4;tt.editors=(aI=tt.editors)!==null&&aI!==void 0?aI:{};he(R0e(),t=>{tt.editors[`${Ms(t)}Editor`]=E1(t)});tt.editors.registerEditor=ca;tt.editors.getEditor=E1;tt.renderers=(oI=tt.renderers)!==null&&oI!==void 0?oI:{};he(gpe(),t=>{const e=_1(t);t==="base"&&(tt.renderers.cellDecorator=e),tt.renderers[`${Ms(t)}Renderer`]=e});tt.renderers.registerRenderer=La;tt.renderers.getRenderer=_1;tt.validators=(lI=tt.validators)!==null&&lI!==void 0?lI:{};he(vpe(),t=>{tt.validators[`${Ms(t)}Validator`]=WF(t)});tt.validators.registerValidator=fg;tt.validators.getValidator=WF;tt.plugins=(uI=tt.plugins)!==null&&uI!==void 0?uI:{};he(VF(),t=>{tt.plugins[t]=xS(t)});tt.plugins[`${Ms(ur.PLUGIN_KEY)}Plugin`]=ur;tt.plugins.registerPlugin=lr;tt.plugins.getPlugin=xS;function KN(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function jFe(t){if(Array.isArray(t))return KN(t)}function YFe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function B1(t,e,r){return e=W_(e),ZFe(t,wte()?Reflect.construct(e,r||[],W_(t).constructor):e.apply(t,r))}function Hp(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Yz(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,yte(n.key),n)}}function Fp(t,e,r){return e&&Yz(t.prototype,e),r&&Yz(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function zFe(t,e,r){return(e=yte(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function W_(t){return W_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},W_(t)}function V1(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&XN(t,e)}function wte(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(wte=function(){return!!t})()}function GFe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function qFe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function zz(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function KFe(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?zz(Object(r),!0).forEach(function(n){zFe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):zz(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function XFe(t,e){if(t==null)return{};var r,n,i=QFe(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(n=0;n<s.length;n++)r=s[n],e.indexOf(r)===-1&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}function QFe(t,e){if(t==null)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;r[n]=t[n]}return r}function ZFe(t,e){if(e&&(typeof e=="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return YFe(t)}function XN(t,e){return XN=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},XN(t,e)}function JFe(t){return jFe(t)||GFe(t)||tLe(t)||qFe()}function eLe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function yte(t){var e=eLe(t,"string");return typeof e=="symbol"?e:e+""}function tLe(t,e){if(t){if(typeof t=="string")return KN(t,e);var r={}.toString.call(t).slice(8,-1);return r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set"?Array.from(t):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?KN(t,e):void 0}}var cI=null,rLe="Your `HotTable` configuration includes `autoRowSize`/`autoColumnSize` options, which are not compatible with  the component-based renderers`. Disable `autoRowSize` and `autoColumnSize` to prevent row and column misalignment.",nLe="The Handsontable instance bound to this component was destroyed and cannot be used properly.",$_="global",iLe="hot-wrapper-editor-container";function sLe(){if(typeof console<"u"){var t;(t=console).warn.apply(t,arguments)}}function QN(t,e){var r=Ie.Children.toArray(t),n=Ie.Children.count(t),i=null;return n!==0&&(n===1&&r[0].props[e]?i=r[0]:i=r.find(function(s){return s.props[e]!==void 0})),i||null}function Ste(t){return t?t.type.WrappedComponent?t.type.WrappedComponent:t.type:null}function bte(t,e){if(typeof t>"u"||e===null)return null;var r=xte(e.props,!1);return r.className="".concat(iLe," ").concat(r.className),_H.createPortal(Ie.createElement("div",Object.assign({},r),e),t.body)}function Cte(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:$_,n=QN(t,"hot-editor"),i=Ste(n);return n?Ie.cloneElement(n,{emitEditorInstance:function(a,o){e.get(i)||e.set(i,new Map);var u=e.get(i);u.set(o??$_,a)},editorColumnScope:r,isEditor:!0}):null}function aLe(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:document,n=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0;r||(r=document),cI||(cI=r.createDocumentFragment());var s=i??r.createElement("DIV");cI.appendChild(s);var a=Ie.cloneElement(t,KFe({key:"".concat(e.row,"-").concat(e.col)},e));return{portal:_H.createPortal(a,s,n),portalContainer:s}}function xte(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return{id:t.id||(e?"hot-"+Math.random().toString(36).substring(5):void 0),className:t.className||"",style:t.style||{}}}function oLe(){return typeof window<"u"}var Ete=function(){function t(){Hp(this,t)}return Fp(t,null,[{key:"getSettings",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=n.prevProps,s=i===void 0?{}:i,a=n.isInit,o=a===void 0?!1:a,u=n.initOnlySettingKeys,c=u===void 0?[]:u,f=function(b){return!o&&c.includes(b)?s[b]===r[b]:!1},g={};if(r.settings){var m=r.settings;for(var v in m)m.hasOwnProperty(v)&&!f(v)&&(g[v]=m[v])}for(var w in r)w!=="settings"&&w!=="children"&&!f(w)&&r.hasOwnProperty(w)&&(g[w]=r[w]);return g}}])}(),lLe=function(t){function e(){return Hp(this,e),B1(this,e,arguments)}return V1(e,t),Fp(e,[{key:"getSettingsProps",value:function(){var n=this;return this.internalProps=["_componentRendererColumns","_emitColumnSettings","_columnIndex","_getChildElementByType","_getRendererWrapper","_getEditorClass","_getEditorCache","_getOwnerDocument","hot-renderer","hot-editor","children"],Object.keys(this.props).filter(function(i){return!n.internalProps.includes(i)}).reduce(function(i,s){return i[s]=n.props[s],i},{})}},{key:"getLocalEditorElement",value:function(){return Cte(this.props.children,this.props._getEditorCache(),this.props._columnIndex)}},{key:"createColumnSettings",value:function(){var n=this.props._getChildElementByType(this.props.children,"hot-renderer"),i=this.getLocalEditorElement();this.columnSettings=Ete.getSettings(this.getSettingsProps()),n!==null&&(this.columnSettings.renderer=this.props._getRendererWrapper(n),this.props._componentRendererColumns.set(this.props._columnIndex,!0)),i!==null&&(this.columnSettings.editor=this.props._getEditorClass(i,this.props._columnIndex))}},{key:"emitColumnSettings",value:function(){this.props._emitColumnSettings(this.columnSettings,this.props._columnIndex)}},{key:"componentDidMount",value:function(){this.createColumnSettings(),this.emitColumnSettings()}},{key:"componentDidUpdate",value:function(){this.createColumnSettings(),this.emitColumnSettings()}},{key:"render",value:function(){var n=this.props._getOwnerDocument(),i=bte(n,this.getLocalEditorElement());return Ie.createElement(Ie.Fragment,null,i)}}])}(Ie.Component),uLe=function(t){function e(){var r;return Hp(this,e),r=B1(this,e,arguments),r.state={portals:[]},r}return V1(e,t),Fp(e,[{key:"render",value:function(){return Ie.createElement(Ie.Fragment,null,this.state.portals)}}])}(Ie.Component),cLe="16.0.1";function hLe(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var _te={exports:{}},hI,Gz;function fLe(){if(Gz)return hI;Gz=1;var t="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return hI=t,hI}var fI,qz;function dLe(){if(qz)return fI;qz=1;var t=fLe();function e(){}function r(){}return r.resetWarningCache=e,fI=function(){function i(o,u,c,f,g,m){if(m!==t){var v=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw v.name="Invariant Violation",v}}i.isRequired=i;function s(){return i}var a={array:i,bigint:i,bool:i,func:i,number:i,object:i,string:i,symbol:i,any:i,arrayOf:s,element:i,elementType:i,instanceOf:s,node:i,objectOf:s,oneOf:s,oneOfType:s,shape:s,exact:s,checkPropTypes:r,resetWarningCache:e};return a.PropTypes=a,a},fI}_te.exports=dLe()();var gLe=_te.exports,dI=hLe(gLe),F3=function(t){function e(){var r;return Hp(this,e),r=B1(this,e,arguments),r.id=null,r.__hotInstance=null,r.hotElementRef=null,r.columnSettings=[],r.renderersPortalManager=null,r.portalCache=new Map,r.portalContainerCache=new Map,r.renderedCellCache=new Map,r.editorCache=new Map,r.componentRendererColumns=new Map,r}return V1(e,t),Fp(e,[{key:"hotInstance",get:function(){return!this.__hotInstance||this.__hotInstance&&!this.__hotInstance.isDestroyed?this.__hotInstance:(console.warn(nLe),null)},set:function(n){this.__hotInstance=n}},{key:"_isHotInstanceDestroyed",value:function(){return this.__hotInstance&&this.__hotInstance.isDestroyed}},{key:"getPortalContainerCache",value:function(){return this.portalContainerCache}},{key:"getRenderedCellCache",value:function(){return this.renderedCellCache}},{key:"getEditorCache",value:function(){return this.editorCache}},{key:"clearCache",value:function(){this.getRenderedCellCache().clear(),this.componentRendererColumns.clear()}},{key:"getOwnerDocument",value:function(){return oLe()?this.hotElementRef?this.hotElementRef.ownerDocument:document:null}},{key:"setHotElementRef",value:function(n){this.hotElementRef=n}},{key:"getRendererWrapper",value:function(n){var i=this;return function(a,o,u,c,f,g,m){var v=i.getRenderedCellCache(),w=i.getPortalContainerCache(),y="".concat(u,"-").concat(c),b=a.guid,x="".concat(b,"-").concat(y),_="".concat(y,"-").concat(b);if(v.has(y)&&(o.innerHTML=v.get(y).innerHTML),o&&!o.getAttribute("ghost-table")){for(var T=i.portalCache.get(_),D=w.get(x);o.firstChild;)o.removeChild(o.firstChild);if(T&&D)o.appendChild(D);else{var P=aLe(n,{TD:o,row:u,col:c,prop:f,value:g,cellProperties:m,isRenderer:!0},o.ownerDocument,_,D),O=P.portal,A=P.portalContainer;w.set(x,A),o.appendChild(A),i.portalCache.set(_,O)}}return v.set(y,o),o}}},{key:"getEditorClass",value:function(n){var i,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:$_,a=Ste(n),o=(i=this.getEditorCache().get(a))===null||i===void 0?void 0:i.get(s);return this.makeEditorClass(o)}},{key:"makeEditorClass",value:function(n){var i=function(s){function a(o){var u;return Hp(this,a),u=B1(this,a,[o]),n.hotCustomEditorInstance=u,u.editorComponent=n,u}return V1(a,s),Fp(a,[{key:"focus",value:function(){}},{key:"getValue",value:function(){}},{key:"setValue",value:function(){}},{key:"open",value:function(){}},{key:"close",value:function(){}}])}(tt.editors.BaseEditor);return Object.getOwnPropertyNames(tt.editors.BaseEditor.prototype).forEach(function(s){s!=="constructor"&&(i.prototype[s]=function(){for(var a,o=arguments.length,u=new Array(o),c=0;c<o;c++)u[c]=arguments[c];return(a=n[s]).call.apply(a,[n].concat(u))})}),i}},{key:"getGlobalRendererElement",value:function(){return QN(this.props.children,"hot-renderer")}},{key:"getGlobalEditorElement",value:function(){return Cte(this.props.children,this.getEditorCache())}},{key:"createNewGlobalSettings",value:function(){var n,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=this._isHotInstanceDestroyed()?[]:((n=this.hotInstance)===null||n===void 0||(n=n.getSettings())===null||n===void 0?void 0:n._initOnlySettings)||[],o=Ete.getSettings(this.props,{prevProps:s,isInit:i,initOnlySettingKeys:a}),u=this.getGlobalRendererElement(),c=this.getGlobalEditorElement();if(o.columns=this.columnSettings.length?this.columnSettings:o.columns,c)o.editor=this.getEditorClass(c,$_);else{var f;this.props.editor||(f=this.props.settings)!==null&&f!==void 0&&f.editor?o.editor=this.props.editor||this.props.settings.editor:o.editor=E1("text")}if(u)o.renderer=this.getRendererWrapper(u),this.componentRendererColumns.set("global",!0);else{var g;this.props.renderer||(g=this.props.settings)!==null&&g!==void 0&&g.renderer?o.renderer=this.props.renderer||this.props.settings.renderer:o.renderer=_1("text")}return o}},{key:"displayAutoSizeWarning",value:function(n){var i,s;this.hotInstance&&((i=this.hotInstance.getPlugin("autoRowSize"))!==null&&i!==void 0&&i.enabled||(s=this.hotInstance.getPlugin("autoColumnSize"))!==null&&s!==void 0&&s.enabled)&&this.componentRendererColumns.size>0&&sLe(rLe)}},{key:"setHotColumnSettings",value:function(n,i){this.columnSettings[i]=n}},{key:"handsontableBeforeViewRender",value:function(){this.portalCache.clear(),this.getRenderedCellCache().clear()}},{key:"handsontableAfterViewRender",value:function(){this.renderersPortalManager.setState({portals:JFe(this.portalCache.values())})}},{key:"updateHot",value:function(n){this.hotInstance&&this.hotInstance.updateSettings(n,!1)}},{key:"setRenderersPortalManagerRef",value:function(n){this.renderersPortalManager=n}},{key:"componentDidMount",value:function(){var n=this,i=this.createNewGlobalSettings(!0);this.hotInstance=new tt.Core(this.hotElementRef,i),this.hotInstance.addHook("beforeViewRender",function(){return n.handsontableBeforeViewRender()}),this.hotInstance.addHook("afterViewRender",function(){return n.handsontableAfterViewRender()}),this.hotInstance.init(),this.displayAutoSizeWarning(i)}},{key:"componentDidUpdate",value:function(n){this.clearCache();var i=this.createNewGlobalSettings(!1,n);this.updateHot(i),this.displayAutoSizeWarning(i)}},{key:"componentWillUnmount",value:function(){this.clearCache(),this.hotInstance&&this.hotInstance.destroy()}},{key:"render",value:function(){var n=this,i=function(f){return f.type===lLe},s=Ie.Children.toArray(this.props.children),a=s.filter(function(c){return i(c)}).map(function(c,f){return Ie.cloneElement(c,{_componentRendererColumns:n.componentRendererColumns,_emitColumnSettings:n.setHotColumnSettings.bind(n),_columnIndex:f,_getChildElementByType:QN.bind(n),_getRendererWrapper:n.getRendererWrapper.bind(n),_getEditorClass:n.getEditorClass.bind(n),_getOwnerDocument:n.getOwnerDocument.bind(n),_getEditorCache:n.getEditorCache.bind(n),children:c.props.children})}),o=xte(this.props),u=bte(this.getOwnerDocument(),this.getGlobalEditorElement());return Ie.createElement(Ie.Fragment,null,Ie.createElement("div",Object.assign({ref:this.setHotElementRef.bind(this)},o),a),Ie.createElement(uLe,{ref:this.setRenderersPortalManagerRef.bind(this)}),u)}}],[{key:"version",get:function(){return cLe}}])}(Ie.Component);F3.propTypes={style:dI.object,id:dI.string,className:dI.string};var mLe=["children"],Rte=Ie.forwardRef(function(t,e){var r,n=t.children,i=XFe(t,mLe),s=typeof Ie.useId=="function"?Ie.useId():void 0,a=(r=i.id)!==null&&r!==void 0?r:s;return Ie.createElement(F3,Object.assign({id:a},i,{ref:e}),n)});Rte.version=F3.version;Ie.Component;tt.cellTypes.registerCellType("dropdown",vJ);const Tte=[{id:1,number:"12가3456"},{id:2,number:"34나7890"},{id:3,number:"56다1234"},{id:4,number:"78라5678"},{id:5,number:"90마9012"},{id:6,number:"11바3456"},{id:7,number:"22사7890"},{id:8,number:"33아1234"},{id:9,number:"44자5678"},{id:10,number:"55차9012"},{id:11,number:"123가3456"}],pLe=[{code:"01",name:"렌트"},{code:"02",name:"리스"},{code:"03",name:"개인"}],vLe=[{code:"001",name:"CARBANG"},{code:"002",name:"BMW 성수점"},{code:"003",name:"KIA 건대점"},{code:"004",name:"BMW 방이점"},{code:"005",name:"KIA 잠실점"},{code:"006",name:"HYUNDAI 강남점"},{code:"007",name:"HYUNDAI 강서점"},{code:"008",name:"HYUNDAI 강북점"},{code:"009",name:"HYUNDAI 강동점"},{code:"010",name:"HYUNDAI 강원점"},{code:"011",name:"HYUNDAI 경기점"},{code:"012",name:"HYUNDAI 충청점"}];function wLe(t,e){return e==="plateRegisterEditor"?t.filter(r=>r.차량번호||r.고객사):e==="carRegisterEditor"?t.filter(r=>Tte.some(n=>n.number===r.차량번호)):t}function yLe({isOpen:t,onClose:e,rows:r,excelColumns:n,handleRowsChange:i,editorType:s="plateRegisterEditor"}){const[a,o]=ie.useState([]),[u,c]=ie.useState(!1),[f,g]=ie.useState(null),m=ie.useRef(null);console.log("excelColumns rows: ",n,r),ie.useEffect(()=>{if(t){const T=Array.from({length:2e3},(D,P)=>{const O=r[P]||{};return{index:P+1,...O}});o(T),setTimeout(()=>{m.current&&m.current.hotInstance.render()},100)}},[t,r]);const v=n.map(T=>s==="carRegisterEditor"&&T.key==="차량번호"?{data:T.key,renderer:function(D,P,O,A,W,L,H){P.innerHTML=L||"차량번호 선택",P.style.cursor="pointer"}}:s==="carRegisterEditor"&&T.key==="업무구분"?{data:T.key,type:"dropdown",source:pLe.map(D=>D.name),allowInvalid:!1}:s==="carRegisterEditor"&&T.key==="사용본거지"?{data:T.key,type:"dropdown",source:vLe.map(D=>D.name),allowInvalid:!1}:{data:T.key}),w=(T,D,P)=>{s==="carRegisterEditor"&&D.col>=0&&n[D.col].key==="차량번호"&&(g(D.row),c(!0),T.stopImmediatePropagation())},y=ie.useCallback(()=>{c(!1),g(null)},[]),b=ie.useCallback(T=>{o(D=>D.map((P,O)=>O===f?{...P,차량번호:T.number}:P)),y()},[f,y]),x=ie.useCallback(()=>a.map(T=>T.차량번호).filter(Boolean),[a]),_=ie.useCallback(()=>{const T=wLe(a,s).map((D,P)=>({...D,index:P+1}));i(T),e()},[a,i,e,s]);return Y.jsx(MK,{isOpen:t,onClose:e,children:Y.jsxs("div",{className:"excel-editor-content",children:[Y.jsx("h2",{className:"excel-editor-title",children:"엑셀 데이터 편집"}),Y.jsx("div",{className:"excel-editor-grid-container",style:{height:500},children:Y.jsx(Rte,{ref:m,data:a,colHeaders:n.map(T=>T.name),columns:v,rowHeaders:!0,height:500,width:"100%",licenseKey:"non-commercial-and-evaluation",afterOnCellMouseDown:w,stretchH:"all",manualColumnResize:!0,manualRowResize:!0,outsideClickDeselects:!1,className:"htCore",afterChange:(T,D)=>{(D==="edit"||D==="Autofill.fill")&&o([...a])}})}),u&&Y.jsx(WI,{isOpen:u,onClose:y,onSelect:b,plates:Tte,selectedPlateNumbers:x()}),Y.jsxs("div",{className:"excel-editor-button-group",children:[Y.jsx("button",{onClick:_,className:"excel-editor-save-btn",children:"확인"}),Y.jsx("button",{onClick:e,className:"excel-editor-cancel-btn",children:"취소"})]})]})})}const SLe=async()=>{const t=await RH(()=>Promise.resolve().then(()=>OB),[]),e=["차량번호","고객사"],r=t.utils.aoa_to_sheet([e]),n=t.utils.book_new();t.utils.book_append_sheet(n,r,"차량번호등록"),t.writeFile(n,"차량번호_등록_양식.xlsx")},bLe=t=>{const e=[];return t.forEach((r,n)=>{r.차량번호||e.push(`${n+1}번: 차량번호가 누락되었습니다.`),r.고객사||e.push(`${n+1}번: 고객사가 누락되었습니다.`)}),e},CLe=["HYUNDAI","KIA","GENESIS"];function xLe(){const[t,e]=ie.useState(!1),[r,n]=ie.useState(""),[i,s]=ie.useState(null),[a,o]=ie.useState([]),[u,c]=ie.useState(!1),[f,g]=ie.useState(0),[m,v]=ie.useState([]),[w,y]=ie.useState(!1),b=Yo(),{user:x}=oh(),[_,T]=ie.useState(!1),[D,P]=ie.useState([]),[O,A]=ie.useState(!1),[W,L]=ie.useState("");if(ie.useEffect(()=>{x||T(!0)},[x,b]),!x||!x.username)return Y.jsx(Zg,{open:_});const H=async le=>{const Te=le.target.files[0];s(Te);const ce=await RH(()=>Promise.resolve().then(()=>OB),void 0),K=new FileReader;K.onload=Se=>{const B=Se.target.result,E=ce.read(B,{type:"binary"}),R=E.SheetNames[0],M=E.Sheets[R],F=ce.utils.sheet_to_json(M,{header:0});console.log("PlateRegisterPage.Excel Data:",F);const Z=F.map((te,fe)=>({index:fe+1,...te}));console.log("PlateRegisterPage.Rows with index:",Z),P(Z),console.log("PlateRegisterPage.rowWithIndex",Z),o(F),console.log("PlateRegisterPage.data",F),A(!0)},K.readAsArrayBuffer(Te)},J=le=>{console.log("변경된 행:",le),P(le),o(le.map(({index:Te,...ce})=>ce))},G=()=>{A(!0)},ve=async le=>{if(le.preventDefault(),!a.length){v(["업로드된 데이터가 없습니다."]),y(!0);return}const Te=bLe(a);if(Te.length>0){v(Te),y(!0);return}console.log("등록할 데이터:",a),g(a.length),c(!0),s(null),o([]),document.getElementById("bulkUploadForm").reset()},be=le=>{le.preventDefault(),r&&(g(1),c(!0),n(""),L(""))},we=()=>{s(null),o([]),document.getElementById("bulkUploadForm").reset()},ae=[{key:"index",name:"번호",width:80,frozen:!0},{key:"차량번호",name:"차량번호",width:150,editable:!0},{key:"고객사",name:"고객사",width:200,editable:!0}];return Y.jsxs("div",{className:"wrap",children:[Y.jsxs("div",{className:"register_box",children:[Y.jsx("h1",{className:"title",children:"차량번호 등록"}),Y.jsxs("div",{className:"register-tabs",children:[Y.jsx("button",{className:`tab-button ${t?"":"active"}`,onClick:()=>e(!1),children:"개별 등록"}),Y.jsx("button",{className:`tab-button ${t?"active":""}`,onClick:()=>e(!0),children:"일괄 등록"})]}),t?Y.jsxs("div",{className:"bulk-register",children:[Y.jsxs("div",{className:"bulk-instructions",children:[Y.jsx("h3",{children:"일괄 등록 방법"}),Y.jsxs("ol",{children:[Y.jsx("li",{children:"아래 양식 파일을 다운로드합니다."}),Y.jsx("li",{children:"양식에 맞춰 데이터를 입력합니다."}),Y.jsx("li",{children:"작성된 파일을 업로드합니다."})]}),Y.jsx("button",{onClick:SLe,className:"template-download",children:"양식 다운로드"})]}),Y.jsx("form",{id:"bulkUploadForm",onSubmit:ve,children:Y.jsxs("div",{className:"file-upload-container",children:[Y.jsxs("div",{className:"file-input-group",children:[Y.jsx("input",{type:"file",accept:".xlsx,.xls",onChange:H,required:!0}),i&&Y.jsxs(Y.Fragment,{children:[Y.jsx("button",{type:"button",onClick:we,className:"clear-file-btn",children:"✕"}),Y.jsx("button",{type:"button",onClick:G,className:"edit-excel-btn",children:"엑셀편집"})]})]}),a.length>0&&Y.jsxs("div",{className:"file-info",children:[Y.jsxs("p",{children:[a.length,"개의 데이터가 확인되었습니다."]}),Y.jsx("button",{type:"submit",children:"일괄 등록"})]})]})}),Y.jsx(yLe,{isOpen:O,onClose:()=>A(!1),rows:D,excelColumns:ae,handleRowsChange:J,rowsKeyGetter:le=>le.index,editorType:"plateRegisterEditor"})]}):Y.jsxs("form",{id:"registerForm",onSubmit:be,className:"single-register-form",children:[Y.jsxs("div",{className:"input-group-vertical",children:[Y.jsxs("div",{className:"input-field",children:[Y.jsx("label",{htmlFor:"plateNumber",children:"차량번호"}),Y.jsx("input",{id:"plateNumber",type:"text",placeholder:"차량번호 입력",value:r,onChange:le=>n(le.target.value),required:!0})]}),Y.jsxs("div",{className:"input-field",children:[Y.jsx("label",{htmlFor:"customer",children:"고객사"}),Y.jsxs("select",{id:"customer",value:W,onChange:le=>L(le.target.value),required:!0,children:[Y.jsx("option",{value:"",children:"선택하세요"}),CLe.map(le=>Y.jsx("option",{value:le,children:le},le))]})]})]}),Y.jsx("button",{type:"submit",className:"register-button",children:"등록"})]})]}),Y.jsx(pK,{isOpen:w,onClose:()=>y(!1),errors:m}),Y.jsxs(mK,{isOpen:u,onClose:()=>{c(!1),g(0)},children:[Y.jsx("h2",{children:"요청 완료"}),Y.jsxs("p",{children:[t?`${f}개의 차량번호가`:"차량번호가"," 성공적으로 등록되었습니다."]})]})]})}const Mte="/react_test/assets/puppy-BMjiuPoe.png";function ELe(){const t=Yo(),{user:e,logout:r}=oh(),[n,i]=ie.useState(!1);if(ie.useEffect(()=>{e||i(!0)},[e,t]),!e||!e.username)return Y.jsx(Zg,{open:n});const s=()=>{r(),t("/login")};return Y.jsx("div",{id:"mypage-container",children:Y.jsxs("div",{id:"mypage-content",children:[Y.jsxs("div",{id:"profile-section",children:[Y.jsx("img",{src:Mte,alt:"프로필",id:"profile-image"}),Y.jsxs("div",{id:"user-info",children:[Y.jsxs("div",{id:"user-id",children:["아이디: ",e.username]}),Y.jsxs("div",{id:"user-name",children:["이름: ",e.name]})]})]}),Y.jsx("button",{onClick:s,id:"logout-button",children:"로그아웃"})]})})}const _Le=[{username:"dlruddnjs1",password:"dlruddnjs",name:"CARBANG",company:"CARBANG"},{username:"dlruddnjs2",password:"dlruddnjs",name:"AUTOPLUS",company:"AUTOPLUS"},{username:"dlruddnjs3",password:"dlruddnjs",name:"HYUNDAI",company:"HYUNDAI"},{username:"dlruddnjs4",password:"dlruddnjs",name:"KIA",company:"KIA"},{username:"dlruddnjs5",password:"dlruddnjs",name:"GENESIS",company:"GENESIS"}],RLe=["CARBANG","AUTOPLUS","HYUNDAI","KIA","GENESIS"];function TLe(){const[t,e]=ie.useState(""),[r,n]=ie.useState(""),[i,s]=ie.useState(""),[a,o]=ie.useState(!1),[u,c]=ie.useState(!1),f=Yo(),{setUser:g}=oh();ie.useEffect(()=>{const v=localStorage.getItem("rememberedUsername"),w=localStorage.getItem("rememberMe")==="true";v&&w&&(e(v),o(!0))},[]);const m=()=>{const v=_Le.find(w=>w.username===t&&w.password===r&&w.company===i);if(v)switch(a?(localStorage.setItem("rememberedUsername",t),localStorage.setItem("rememberMe","true")):(localStorage.removeItem("rememberedUsername"),localStorage.setItem("rememberMe","false")),g(v),g({...v,company:v.company}),v.company){case"CARBANG":f("/customer/plate/status");break;case"AUTOPLUS":f("/autoplus/plate/add");break;default:f("/customer/plate/register");break}else c(!0)};return Y.jsxs("div",{className:"wrap",children:[Y.jsx(gle,{open:u,onClose:()=>c(!1)}),Y.jsxs("div",{className:"login_box",children:[Y.jsx("h1",{className:"logo",children:i}),Y.jsxs("form",{id:"loginForm",children:[Y.jsxs("select",{value:i,onChange:v=>s(v.target.value),className:"company-select",children:[Y.jsx("option",{value:"",children:"고객사 선택"}),RLe.map(v=>Y.jsx("option",{value:v,children:v},v))]}),Y.jsx("input",{type:"text",placeholder:"아이디",value:t,onChange:v=>e(v.target.value),onKeyDown:v=>{v.key==="Enter"&&m()}}),Y.jsx("input",{type:"password",placeholder:"비밀번호",value:r,onChange:v=>n(v.target.value),onKeyDown:v=>{v.key==="Enter"&&m()}}),Y.jsxs("div",{className:"remember-me",children:[Y.jsx("input",{type:"checkbox",id:"rememberMe",checked:a,onChange:v=>o(v.target.checked)}),Y.jsx("label",{htmlFor:"rememberMe",children:"아이디 저장"})]}),Y.jsx("button",{type:"button",onClick:m,children:"로그인"})]})]})]})}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var W1={};W1.version="0.18.5";var Xa=1200,Wg=1252,MLe=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],L3={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},_T=function(t){MLe.indexOf(t)!=-1&&(Wg=L3[0]=t)};function ALe(){_T(1252)}var Bo=function(t){Xa=t,_T(t)};function RT(){Bo(1200),ALe()}function U_(t){for(var e=[],r=0,n=t.length;r<n;++r)e[r]=t.charCodeAt(r);return e}function OLe(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r)+(t.charCodeAt(2*r+1)<<8));return e.join("")}function Ate(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r+1)+(t.charCodeAt(2*r)<<8));return e.join("")}var ap=function(t){var e=t.charCodeAt(0),r=t.charCodeAt(1);return e==255&&r==254?OLe(t.slice(2)):e==254&&r==255?Ate(t.slice(2)):e==65279?t.slice(1):t},Ty=function(e){return String.fromCharCode(e)},ZN=function(e){return String.fromCharCode(e)},gr;function kLe(t){gr=t,Bo=function(e){Xa=e,_T(e)},ap=function(e){return e.charCodeAt(0)===255&&e.charCodeAt(1)===254?gr.utils.decode(1200,U_(e.slice(2))):e},Ty=function(r){return Xa===1200?String.fromCharCode(r):gr.utils.decode(Xa,[r&255,r>>8])[0]},ZN=function(r){return gr.utils.decode(Wg,[r])[0]},ire()}var _f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function $1(t){for(var e="",r=0,n=0,i=0,s=0,a=0,o=0,u=0,c=0;c<t.length;)r=t.charCodeAt(c++),s=r>>2,n=t.charCodeAt(c++),a=(r&3)<<4|n>>4,i=t.charCodeAt(c++),o=(n&15)<<2|i>>6,u=i&63,isNaN(n)?o=u=64:isNaN(i)&&(u=64),e+=_f.charAt(s)+_f.charAt(a)+_f.charAt(o)+_f.charAt(u);return e}function Za(t){var e="",r=0,n=0,i=0,s=0,a=0,o=0,u=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var c=0;c<t.length;)s=_f.indexOf(t.charAt(c++)),a=_f.indexOf(t.charAt(c++)),r=s<<2|a>>4,e+=String.fromCharCode(r),o=_f.indexOf(t.charAt(c++)),n=(a&15)<<4|o>>2,o!==64&&(e+=String.fromCharCode(n)),u=_f.indexOf(t.charAt(c++)),i=(o&3)<<6|u,u!==64&&(e+=String.fromCharCode(i));return e}var Gt=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),dh=function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(e,r){return r?new Buffer(e,r):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function Uf(t){return Gt?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function Kz(t){return Gt?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var Ga=function(e){return Gt?dh(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)&255})};function LS(t){if(typeof ArrayBuffer>"u")return Ga(t);for(var e=new ArrayBuffer(t.length),r=new Uint8Array(e),n=0;n!=t.length;++n)r[n]=t.charCodeAt(n)&255;return e}function td(t){if(Array.isArray(t))return t.map(function(n){return String.fromCharCode(n)}).join("");for(var e=[],r=0;r<t.length;++r)e[r]=String.fromCharCode(t[r]);return e.join("")}function DLe(t){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(t)}function B3(t){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(t instanceof ArrayBuffer)return B3(new Uint8Array(t));for(var e=new Array(t.length),r=0;r<t.length;++r)e[r]=t[r];return e}var Yi=Gt?function(t){return Buffer.concat(t.map(function(e){return Buffer.isBuffer(e)?e:dh(e)}))}:function(t){if(typeof Uint8Array<"u"){var e=0,r=0;for(e=0;e<t.length;++e)r+=t[e].length;var n=new Uint8Array(r),i=0;for(e=0,r=0;e<t.length;r+=i,++e)if(i=t[e].length,t[e]instanceof Uint8Array)n.set(t[e],r);else{if(typeof t[e]=="string")throw"wtf";n.set(new Uint8Array(t[e]),r)}return n}return[].concat.apply([],t.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function PLe(t){for(var e=[],r=0,n=t.length+250,i=Uf(t.length+255),s=0;s<t.length;++s){var a=t.charCodeAt(s);if(a<128)i[r++]=a;else if(a<2048)i[r++]=192|a>>6&31,i[r++]=128|a&63;else if(a>=55296&&a<57344){a=(a&1023)+64;var o=t.charCodeAt(++s)&1023;i[r++]=240|a>>8&7,i[r++]=128|a>>2&63,i[r++]=128|o>>6&15|(a&3)<<4,i[r++]=128|o&63}else i[r++]=224|a>>12&15,i[r++]=128|a>>6&63,i[r++]=128|a&63;r>n&&(e.push(i.slice(0,r)),r=0,i=Uf(65535),n=65530)}return e.push(i.slice(0,r)),Yi(e)}var Rs=/\u0000/g,My=/[\u0001-\u0006]/g;function wp(t){for(var e="",r=t.length-1;r>=0;)e+=t.charAt(r--);return e}function Rl(t,e){var r=""+t;return r.length>=e?r:$n("0",e-r.length)+r}function V3(t,e){var r=""+t;return r.length>=e?r:$n(" ",e-r.length)+r}function j_(t,e){var r=""+t;return r.length>=e?r:r+$n(" ",e-r.length)}function ILe(t,e){var r=""+Math.round(t);return r.length>=e?r:$n("0",e-r.length)+r}function NLe(t,e){var r=""+t;return r.length>=e?r:$n("0",e-r.length)+r}var Xz=Math.pow(2,32);function B0(t,e){if(t>Xz||t<-Xz)return ILe(t,e);var r=Math.round(t);return NLe(r,e)}function Y_(t,e){return e=e||0,t.length>=7+e&&(t.charCodeAt(e)|32)===103&&(t.charCodeAt(e+1)|32)===101&&(t.charCodeAt(e+2)|32)===110&&(t.charCodeAt(e+3)|32)===101&&(t.charCodeAt(e+4)|32)===114&&(t.charCodeAt(e+5)|32)===97&&(t.charCodeAt(e+6)|32)===108}var Qz=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],gI=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function HLe(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',t}var xt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"上午/下午 "hh"時"mm"分"ss"秒 "'},Zz={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},FLe={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function z_(t,e,r){for(var n=t<0?-1:1,i=t*n,s=0,a=1,o=0,u=1,c=0,f=0,g=Math.floor(i);c<e&&(g=Math.floor(i),o=g*a+s,f=g*c+u,!(i-g<5e-8));)i=1/(i-g),s=a,a=o,u=c,c=f;if(f>e&&(c>e?(f=u,o=s):(f=c,o=a)),!r)return[0,n*o,f];var m=Math.floor(n*o/f);return[m,n*o-m*f,f]}function Rf(t,e,r){if(t>2958465||t<0)return null;var n=t|0,i=Math.floor(86400*(t-n)),s=0,a=[],o={D:n,T:i,u:86400*(t-n)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),e&&e.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++i==86400&&(o.T=i=0,++n,++o.D)),n===60)a=r?[1317,10,29]:[1900,2,29],s=3;else if(n===0)a=r?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var u=new Date(1900,0,1);u.setDate(u.getDate()+n-1),a=[u.getFullYear(),u.getMonth()+1,u.getDate()],s=u.getDay(),n<60&&(s=(s+6)%7),r&&(s=ULe(u,a))}return o.y=a[0],o.m=a[1],o.d=a[2],o.S=i%60,i=Math.floor(i/60),o.M=i%60,i=Math.floor(i/60),o.H=i,o.q=s,o}var Ote=new Date(1899,11,31,0,0,0),LLe=Ote.getTime(),BLe=new Date(1900,2,1,0,0,0);function kte(t,e){var r=t.getTime();return e?r-=1461*24*60*60*1e3:t>=BLe&&(r+=1440*60*1e3),(r-(LLe+(t.getTimezoneOffset()-Ote.getTimezoneOffset())*6e4))/(1440*60*1e3)}function W3(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function VLe(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function WLe(t){var e=t<0?12:11,r=W3(t.toFixed(12));return r.length<=e||(r=t.toPrecision(10),r.length<=e)?r:t.toExponential(5)}function $Le(t){var e=W3(t.toFixed(11));return e.length>(t<0?12:11)||e==="0"||e==="-0"?t.toPrecision(6):e}function U1(t){var e=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),r;return e>=-4&&e<=-1?r=t.toPrecision(10+e):Math.abs(e)<=9?r=WLe(t):e===10?r=t.toFixed(10).substr(0,12):r=$Le(t),W3(VLe(r.toUpperCase()))}function $g(t,e){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):U1(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return Ja(14,kte(t,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+t)}function ULe(t,e){e[0]-=581;var r=t.getDay();return t<60&&(r=(r+6)%7),r}function jLe(t,e,r,n){var i="",s=0,a=0,o=r.y,u,c=0;switch(t){case 98:o=r.y+543;case 121:switch(e.length){case 1:case 2:u=o%100,c=2;break;default:u=o%1e4,c=4;break}break;case 109:switch(e.length){case 1:case 2:u=r.m,c=e.length;break;case 3:return gI[r.m-1][1];case 5:return gI[r.m-1][0];default:return gI[r.m-1][2]}break;case 100:switch(e.length){case 1:case 2:u=r.d,c=e.length;break;case 3:return Qz[r.q][0];default:return Qz[r.q][1]}break;case 104:switch(e.length){case 1:case 2:u=1+(r.H+11)%12,c=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:u=r.H,c=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:u=r.M,c=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return r.u===0&&(e=="s"||e=="ss")?Rl(r.S,e.length):(n>=2?a=n===3?1e3:100:a=n===1?10:1,s=Math.round(a*(r.S+r.u)),s>=60*a&&(s=0),e==="s"?s===0?"0":""+s/a:(i=Rl(s,2+n),e==="ss"?i.substr(0,2):"."+i.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":u=r.D*24+r.H;break;case"[m]":case"[mm]":u=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":u=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+e}c=e.length===3?1:2;break;case 101:u=o,c=1;break}var f=c>0?Rl(u,c):"";return f}function Tf(t){var e=3;if(t.length<=e)return t;for(var r=t.length%e,n=t.substr(0,r);r!=t.length;r+=e)n+=(n.length>0?",":"")+t.substr(r,e);return n}var Dte=/%/g;function YLe(t,e,r){var n=e.replace(Dte,""),i=e.length-n.length;return Gc(t,n,r*Math.pow(10,2*i))+$n("%",i)}function zLe(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return Gc(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function Pte(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+Pte(t,-e);var i=t.indexOf(".");i===-1&&(i=t.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(e/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),r.indexOf("e")===-1){var a=Math.floor(Math.log(e)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+s):r+="E+"+(a-s);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,i)+"."+r.substr(2+i),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,u,c,f){return u+c+f.substr(0,(i+s)%i)+"."+f.substr(s)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var Ite=/# (\?+)( ?)\/( ?)(\d+)/;function GLe(t,e,r){var n=parseInt(t[4],10),i=Math.round(e*n),s=Math.floor(i/n),a=i-s*n,o=n;return r+(s===0?"":""+s)+" "+(a===0?$n(" ",t[1].length+1+t[4].length):V3(a,t[1].length)+t[2]+"/"+t[3]+Rl(o,t[4].length))}function qLe(t,e,r){return r+(e===0?"":""+e)+$n(" ",t[1].length+2+t[4].length)}var Nte=/^#*0*\.([0#]+)/,Hte=/\).*[0#]/,Fte=/\(###\) ###\\?-####/;function Ws(t){for(var e="",r,n=0;n!=t.length;++n)switch(r=t.charCodeAt(n)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(r)}return e}function Jz(t,e){var r=Math.pow(10,e);return""+Math.round(t*r)/r}function eG(t,e){var r=t-Math.floor(t),n=Math.pow(10,e);return e<(""+Math.round(r*n)).length?0:Math.round(r*n)}function KLe(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?1:0}function XLe(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function So(t,e,r){if(t.charCodeAt(0)===40&&!e.match(Hte)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?So("n",n,r):"("+So("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return zLe(t,e,r);if(e.indexOf("%")!==-1)return YLe(t,e,r);if(e.indexOf("E")!==-1)return Pte(e,r);if(e.charCodeAt(0)===36)return"$"+So(t,e.substr(e.charAt(1)==" "?2:1),r);var i,s,a,o,u=Math.abs(r),c=r<0?"-":"";if(e.match(/^00+$/))return c+B0(u,e.length);if(e.match(/^[#?]+$/))return i=B0(r,0),i==="0"&&(i=""),i.length>e.length?i:Ws(e.substr(0,e.length-i.length))+i;if(s=e.match(Ite))return GLe(s,u,c);if(e.match(/^#+0+$/))return c+B0(u,e.length-e.indexOf("0"));if(s=e.match(Nte))return i=Jz(r,s[1].length).replace(/^([^\.]+)$/,"$1."+Ws(s[1])).replace(/\.$/,"."+Ws(s[1])).replace(/\.(\d*)$/,function(w,y){return"."+y+$n("0",Ws(s[1]).length-y.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return c+Jz(u,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return c+Tf(B0(u,0));if(s=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+So(t,e,-r):Tf(""+(Math.floor(r)+KLe(r,s[1].length)))+"."+Rl(eG(r,s[1].length),s[1].length);if(s=e.match(/^#,#*,#0/))return So(t,e.replace(/^#,#*,/,""),r);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=wp(So(t,e.replace(/[\\-]/g,""),r)),a=0,wp(wp(e.replace(/\\/g,"")).replace(/[0#]/g,function(w){return a<i.length?i.charAt(a++):w==="0"?"0":""}));if(e.match(Fte))return i=So(t,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var f="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=z_(u,Math.pow(10,a)-1,!1),i=""+c,f=Gc("n",s[1],o[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),i+=f+s[2]+"/"+s[3],f=j_(o[2],a),f.length<s[4].length&&(f=Ws(s[4].substr(s[4].length-f.length))+f),i+=f,i;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=z_(u,Math.pow(10,a)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?V3(o[1],a)+s[2]+"/"+s[3]+j_(o[2],a):$n(" ",2*a+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return i=B0(r,0),e.length<=i.length?i:Ws(e.substr(0,e.length-i.length))+i;if(s=e.match(/^([#0?]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var g=e.indexOf(".")-a,m=e.length-i.length-g;return Ws(e.substr(0,g)+i+e.substr(e.length-m))}if(s=e.match(/^00,000\.([#0]*0)$/))return a=eG(r,s[1].length),r<0?"-"+So(t,e,-r):Tf(XLe(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(w){return"00,"+(w.length<3?Rl(0,3-w.length):"")+w})+"."+Rl(a,s[1].length);switch(e){case"###,##0.00":return So(t,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var v=Tf(B0(u,0));return v!=="0"?c+v:"";case"###,###.00":return So(t,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return So(t,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function QLe(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return Gc(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function ZLe(t,e,r){var n=e.replace(Dte,""),i=e.length-n.length;return Gc(t,n,r*Math.pow(10,2*i))+$n("%",i)}function Lte(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+Lte(t,-e);var i=t.indexOf(".");i===-1&&(i=t.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(e/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),!r.match(/[Ee]/)){var a=Math.floor(Math.log(e)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+s):r+="E+"+(a-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,u,c,f){return u+c+f.substr(0,(i+s)%i)+"."+f.substr(s)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function hu(t,e,r){if(t.charCodeAt(0)===40&&!e.match(Hte)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?hu("n",n,r):"("+hu("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return QLe(t,e,r);if(e.indexOf("%")!==-1)return ZLe(t,e,r);if(e.indexOf("E")!==-1)return Lte(e,r);if(e.charCodeAt(0)===36)return"$"+hu(t,e.substr(e.charAt(1)==" "?2:1),r);var i,s,a,o,u=Math.abs(r),c=r<0?"-":"";if(e.match(/^00+$/))return c+Rl(u,e.length);if(e.match(/^[#?]+$/))return i=""+r,r===0&&(i=""),i.length>e.length?i:Ws(e.substr(0,e.length-i.length))+i;if(s=e.match(Ite))return qLe(s,u,c);if(e.match(/^#+0+$/))return c+Rl(u,e.length-e.indexOf("0"));if(s=e.match(Nte))return i=(""+r).replace(/^([^\.]+)$/,"$1."+Ws(s[1])).replace(/\.$/,"."+Ws(s[1])),i=i.replace(/\.(\d*)$/,function(w,y){return"."+y+$n("0",Ws(s[1]).length-y.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return c+(""+u).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return c+Tf(""+u);if(s=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+hu(t,e,-r):Tf(""+r)+"."+$n("0",s[1].length);if(s=e.match(/^#,#*,#0/))return hu(t,e.replace(/^#,#*,/,""),r);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=wp(hu(t,e.replace(/[\\-]/g,""),r)),a=0,wp(wp(e.replace(/\\/g,"")).replace(/[0#]/g,function(w){return a<i.length?i.charAt(a++):w==="0"?"0":""}));if(e.match(Fte))return i=hu(t,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var f="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=z_(u,Math.pow(10,a)-1,!1),i=""+c,f=Gc("n",s[1],o[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),i+=f+s[2]+"/"+s[3],f=j_(o[2],a),f.length<s[4].length&&(f=Ws(s[4].substr(s[4].length-f.length))+f),i+=f,i;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=z_(u,Math.pow(10,a)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?V3(o[1],a)+s[2]+"/"+s[3]+j_(o[2],a):$n(" ",2*a+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return i=""+r,e.length<=i.length?i:Ws(e.substr(0,e.length-i.length))+i;if(s=e.match(/^([#0]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var g=e.indexOf(".")-a,m=e.length-i.length-g;return Ws(e.substr(0,g)+i+e.substr(e.length-m))}if(s=e.match(/^00,000\.([#0]*0)$/))return r<0?"-"+hu(t,e,-r):Tf(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(w){return"00,"+(w.length<3?Rl(0,3-w.length):"")+w})+"."+Rl(0,s[1].length);switch(e){case"###,###":case"##,###":case"#,###":var v=Tf(""+u);return v!=="0"?c+v:"";default:if(e.match(/\.[0#?]*$/))return hu(t,e.slice(0,e.lastIndexOf(".")),r)+Ws(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function Gc(t,e,r){return(r|0)===r?hu(t,e,r):So(t,e,r)}function JLe(t){for(var e=[],r=!1,n=0,i=0;n<t.length;++n)switch(t.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:e[e.length]=t.substr(i,n-i),i=n+1}if(e[e.length]=t.substr(i),r===!0)throw new Error("Format |"+t+"| unterminated string ");return e}var Bte=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function cm(t){for(var e=0,r="",n="";e<t.length;)switch(r=t.charAt(e)){case"G":Y_(t,e)&&(e+=6),e++;break;case'"':for(;t.charCodeAt(++e)!==34&&e<t.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(t.charAt(e+1)==="1"||t.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"上":if(t.substr(e,3).toUpperCase()==="A/P"||t.substr(e,5).toUpperCase()==="AM/PM"||t.substr(e,5).toUpperCase()==="上午/下午")return!0;++e;break;case"[":for(n=r;t.charAt(e++)!=="]"&&e<t.length;)n+=t.charAt(e);if(n.match(Bte))return!0;break;case".":case"0":case"#":for(;e<t.length&&("0#?.,E+-%".indexOf(r=t.charAt(++e))>-1||r=="\\"&&t.charAt(e+1)=="-"&&"0#".indexOf(t.charAt(e+2))>-1););break;case"?":for(;t.charAt(++e)===r;);break;case"*":++e,(t.charAt(e)==" "||t.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<t.length&&"0123456789".indexOf(t.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function e4e(t,e,r,n){for(var i=[],s="",a=0,o="",u="t",c,f,g,m="H";a<t.length;)switch(o=t.charAt(a)){case"G":if(!Y_(t,a))throw new Error("unrecognized character "+o+" in "+t);i[i.length]={t:"G",v:"General"},a+=7;break;case'"':for(s="";(g=t.charCodeAt(++a))!==34&&a<t.length;)s+=String.fromCharCode(g);i[i.length]={t:"t",v:s},++a;break;case"\\":var v=t.charAt(++a),w=v==="("||v===")"?v:"t";i[i.length]={t:w,v},++a;break;case"_":i[i.length]={t:"t",v:" "},a+=2;break;case"@":i[i.length]={t:"T",v:e},++a;break;case"B":case"b":if(t.charAt(a+1)==="1"||t.charAt(a+1)==="2"){if(c==null&&(c=Rf(e,r,t.charAt(a+1)==="2"),c==null))return"";i[i.length]={t:"X",v:t.substr(a,2)},u=o,a+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||c==null&&(c=Rf(e,r),c==null))return"";for(s=o;++a<t.length&&t.charAt(a).toLowerCase()===o;)s+=o;o==="m"&&u.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=m),i[i.length]={t:o,v:s},u=o;break;case"A":case"a":case"上":var y={t:o,v:o};if(c==null&&(c=Rf(e,r)),t.substr(a,3).toUpperCase()==="A/P"?(c!=null&&(y.v=c.H>=12?"P":"A"),y.t="T",m="h",a+=3):t.substr(a,5).toUpperCase()==="AM/PM"?(c!=null&&(y.v=c.H>=12?"PM":"AM"),y.t="T",a+=5,m="h"):t.substr(a,5).toUpperCase()==="上午/下午"?(c!=null&&(y.v=c.H>=12?"下午":"上午"),y.t="T",a+=5,m="h"):(y.t="t",++a),c==null&&y.t==="T")return"";i[i.length]=y,u=o;break;case"[":for(s=o;t.charAt(a++)!=="]"&&a<t.length;)s+=t.charAt(a);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(Bte)){if(c==null&&(c=Rf(e,r),c==null))return"";i[i.length]={t:"Z",v:s.toLowerCase()},u=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",cm(t)||(i[i.length]={t:"t",v:s}));break;case".":if(c!=null){for(s=o;++a<t.length&&(o=t.charAt(a))==="0";)s+=o;i[i.length]={t:"s",v:s};break}case"0":case"#":for(s=o;++a<t.length&&"0#?.,E+-%".indexOf(o=t.charAt(a))>-1;)s+=o;i[i.length]={t:"n",v:s};break;case"?":for(s=o;t.charAt(++a)===o;)s+=o;i[i.length]={t:o,v:s},u=o;break;case"*":++a,(t.charAt(a)==" "||t.charAt(a)=="*")&&++a;break;case"(":case")":i[i.length]={t:n===1?"t":o,v:o},++a;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=o;a<t.length&&"0123456789".indexOf(t.charAt(++a))>-1;)s+=t.charAt(a);i[i.length]={t:"D",v:s};break;case" ":i[i.length]={t:o,v:o},++a;break;case"$":i[i.length]={t:"t",v:"$"},++a;break;default:if(",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+t);i[i.length]={t:"t",v:o},++a;break}var b=0,x=0,_;for(a=i.length-1,u="t";a>=0;--a)switch(i[a].t){case"h":case"H":i[a].t=m,u="h",b<1&&(b=1);break;case"s":(_=i[a].v.match(/\.0+$/))&&(x=Math.max(x,_[0].length-1)),b<3&&(b=3);case"d":case"y":case"M":case"e":u=i[a].t;break;case"m":u==="s"&&(i[a].t="M",b<2&&(b=2));break;case"X":break;case"Z":b<1&&i[a].v.match(/[Hh]/)&&(b=1),b<2&&i[a].v.match(/[Mm]/)&&(b=2),b<3&&i[a].v.match(/[Ss]/)&&(b=3)}switch(b){case 0:break;case 1:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M),c.M>=60&&(c.M=0,++c.H);break;case 2:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M);break}var T="",D;for(a=0;a<i.length;++a)switch(i[a].t){case"t":case"T":case" ":case"D":break;case"X":i[a].v="",i[a].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[a].v=jLe(i[a].t.charCodeAt(0),i[a].v,c,x),i[a].t="t";break;case"n":case"?":for(D=a+1;i[D]!=null&&((o=i[D].t)==="?"||o==="D"||(o===" "||o==="t")&&i[D+1]!=null&&(i[D+1].t==="?"||i[D+1].t==="t"&&i[D+1].v==="/")||i[a].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(i[D].v==="/"||i[D].v===" "&&i[D+1]!=null&&i[D+1].t=="?"));)i[a].v+=i[D].v,i[D]={v:"",t:";"},++D;T+=i[a].v,a=D-1;break;case"G":i[a].t="t",i[a].v=$g(e,r);break}var P="",O,A;if(T.length>0){T.charCodeAt(0)==40?(O=e<0&&T.charCodeAt(0)===45?-e:e,A=Gc("n",T,O)):(O=e<0&&n>1?-e:e,A=Gc("n",T,O),O<0&&i[0]&&i[0].t=="t"&&(A=A.substr(1),i[0].v="-"+i[0].v)),D=A.length-1;var W=i.length;for(a=0;a<i.length;++a)if(i[a]!=null&&i[a].t!="t"&&i[a].v.indexOf(".")>-1){W=a;break}var L=i.length;if(W===i.length&&A.indexOf("E")===-1){for(a=i.length-1;a>=0;--a)i[a]==null||"n?".indexOf(i[a].t)===-1||(D>=i[a].v.length-1?(D-=i[a].v.length,i[a].v=A.substr(D+1,i[a].v.length)):D<0?i[a].v="":(i[a].v=A.substr(0,D+1),D=-1),i[a].t="t",L=a);D>=0&&L<i.length&&(i[L].v=A.substr(0,D+1)+i[L].v)}else if(W!==i.length&&A.indexOf("E")===-1){for(D=A.indexOf(".")-1,a=W;a>=0;--a)if(!(i[a]==null||"n?".indexOf(i[a].t)===-1)){for(f=i[a].v.indexOf(".")>-1&&a===W?i[a].v.indexOf(".")-1:i[a].v.length-1,P=i[a].v.substr(f+1);f>=0;--f)D>=0&&(i[a].v.charAt(f)==="0"||i[a].v.charAt(f)==="#")&&(P=A.charAt(D--)+P);i[a].v=P,i[a].t="t",L=a}for(D>=0&&L<i.length&&(i[L].v=A.substr(0,D+1)+i[L].v),D=A.indexOf(".")+1,a=W;a<i.length;++a)if(!(i[a]==null||"n?(".indexOf(i[a].t)===-1&&a!==W)){for(f=i[a].v.indexOf(".")>-1&&a===W?i[a].v.indexOf(".")+1:0,P=i[a].v.substr(0,f);f<i[a].v.length;++f)D<A.length&&(P+=A.charAt(D++));i[a].v=P,i[a].t="t",L=a}}}for(a=0;a<i.length;++a)i[a]!=null&&"n?".indexOf(i[a].t)>-1&&(O=n>1&&e<0&&a>0&&i[a-1].v==="-"?-e:e,i[a].v=Gc(i[a].t,i[a].v,O),i[a].t="t");var H="";for(a=0;a!==i.length;++a)i[a]!=null&&(H+=i[a].v);return H}var tG=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function rG(t,e){if(e==null)return!1;var r=parseFloat(e[2]);switch(e[1]){case"=":if(t==r)return!0;break;case">":if(t>r)return!0;break;case"<":if(t<r)return!0;break;case"<>":if(t!=r)return!0;break;case">=":if(t>=r)return!0;break;case"<=":if(t<=r)return!0;break}return!1}function t4e(t,e){var r=JLe(t),n=r.length,i=r[n-1].indexOf("@");if(n<4&&i>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof e!="number")return[4,r.length===4||i>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=i>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=i>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=i>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var s=e>0?r[0]:e<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,s];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var a=r[0].match(tG),o=r[1].match(tG);return rG(e,a)?[n,r[0]]:rG(e,o)?[n,r[1]]:[n,r[a!=null&&o!=null?2:1]]}return[n,s]}function Ja(t,e,r){r==null&&(r={});var n="";switch(typeof t){case"string":t=="m/d/yy"&&r.dateNF?n=r.dateNF:n=t;break;case"number":t==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:xt)[t],n==null&&(n=r.table&&r.table[Zz[t]]||xt[Zz[t]]),n==null&&(n=FLe[t]||"General");break}if(Y_(n,0))return $g(e,r);e instanceof Date&&(e=kte(e,r.date1904));var i=t4e(n,e);if(Y_(i[1]))return $g(e,r);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return e4e(i[1],e,r,i[0])}function Hu(t,e){if(typeof e!="number"){e=+e||-1;for(var r=0;r<392;++r){if(xt[r]==null){e<0&&(e=r);continue}if(xt[r]==t){e=r;break}}e<0&&(e=391)}return xt[e]=t,e}function BS(t){for(var e=0;e!=392;++e)t[e]!==void 0&&Hu(t[e],e)}function fv(){xt=HLe()}var Vte={format:Ja,load:Hu,_table:xt,load_table:BS,parse_date_code:Rf,is_date:cm,get_table:function(){return Vte._table=xt}},r4e={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},Wte=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function n4e(t){var e=typeof t=="number"?xt[t]:t;return e=e.replace(Wte,"(\\d+)"),new RegExp("^"+e+"$")}function i4e(t,e,r){var n=-1,i=-1,s=-1,a=-1,o=-1,u=-1;(e.match(Wte)||[]).forEach(function(g,m){var v=parseInt(r[m+1],10);switch(g.toLowerCase().charAt(0)){case"y":n=v;break;case"d":s=v;break;case"h":a=v;break;case"s":u=v;break;case"m":a>=0?o=v:i=v;break}}),u>=0&&o==-1&&i>=0&&(o=i,i=-1);var c=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);c.length==7&&(c="0"+c),c.length==8&&(c="20"+c);var f=("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(u>=0?u:0)).slice(-2);return a==-1&&o==-1&&u==-1?c:n==-1&&i==-1&&s==-1?f:c+"T"+f}var s4e=function(){var t={};t.version="1.2.0";function e(){for(var A=0,W=new Array(256),L=0;L!=256;++L)A=L,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,W[L]=A;return typeof Int32Array<"u"?new Int32Array(W):W}var r=e();function n(A){var W=0,L=0,H=0,J=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(H=0;H!=256;++H)J[H]=A[H];for(H=0;H!=256;++H)for(L=A[H],W=256+H;W<4096;W+=256)L=J[W]=L>>>8^A[L&255];var G=[];for(H=1;H!=16;++H)G[H-1]=typeof Int32Array<"u"?J.subarray(H*256,H*256+256):J.slice(H*256,H*256+256);return G}var i=n(r),s=i[0],a=i[1],o=i[2],u=i[3],c=i[4],f=i[5],g=i[6],m=i[7],v=i[8],w=i[9],y=i[10],b=i[11],x=i[12],_=i[13],T=i[14];function D(A,W){for(var L=W^-1,H=0,J=A.length;H<J;)L=L>>>8^r[(L^A.charCodeAt(H++))&255];return~L}function P(A,W){for(var L=W^-1,H=A.length-15,J=0;J<H;)L=T[A[J++]^L&255]^_[A[J++]^L>>8&255]^x[A[J++]^L>>16&255]^b[A[J++]^L>>>24]^y[A[J++]]^w[A[J++]]^v[A[J++]]^m[A[J++]]^g[A[J++]]^f[A[J++]]^c[A[J++]]^u[A[J++]]^o[A[J++]]^a[A[J++]]^s[A[J++]]^r[A[J++]];for(H+=15;J<H;)L=L>>>8^r[(L^A[J++])&255];return~L}function O(A,W){for(var L=W^-1,H=0,J=A.length,G=0,ve=0;H<J;)G=A.charCodeAt(H++),G<128?L=L>>>8^r[(L^G)&255]:G<2048?(L=L>>>8^r[(L^(192|G>>6&31))&255],L=L>>>8^r[(L^(128|G&63))&255]):G>=55296&&G<57344?(G=(G&1023)+64,ve=A.charCodeAt(H++)&1023,L=L>>>8^r[(L^(240|G>>8&7))&255],L=L>>>8^r[(L^(128|G>>2&63))&255],L=L>>>8^r[(L^(128|ve>>6&15|(G&3)<<4))&255],L=L>>>8^r[(L^(128|ve&63))&255]):(L=L>>>8^r[(L^(224|G>>12&15))&255],L=L>>>8^r[(L^(128|G>>6&63))&255],L=L>>>8^r[(L^(128|G&63))&255]);return~L}return t.table=r,t.bstr=D,t.buf=P,t.str=O,t}(),vt=function(){var e={};e.version="1.2.1";function r(V,re){for(var q=V.split("/"),X=re.split("/"),ne=0,se=0,Ae=Math.min(q.length,X.length);ne<Ae;++ne){if(se=q[ne].length-X[ne].length)return se;if(q[ne]!=X[ne])return q[ne]<X[ne]?-1:1}return q.length-X.length}function n(V){if(V.charAt(V.length-1)=="/")return V.slice(0,-1).indexOf("/")===-1?V:n(V.slice(0,-1));var re=V.lastIndexOf("/");return re===-1?V:V.slice(0,re+1)}function i(V){if(V.charAt(V.length-1)=="/")return i(V.slice(0,-1));var re=V.lastIndexOf("/");return re===-1?V:V.slice(re+1)}function s(V,re){typeof re=="string"&&(re=new Date(re));var q=re.getHours();q=q<<6|re.getMinutes(),q=q<<5|re.getSeconds()>>>1,V.write_shift(2,q);var X=re.getFullYear()-1980;X=X<<4|re.getMonth()+1,X=X<<5|re.getDate(),V.write_shift(2,X)}function a(V){var re=V.read_shift(2)&65535,q=V.read_shift(2)&65535,X=new Date,ne=q&31;q>>>=5;var se=q&15;q>>>=4,X.setMilliseconds(0),X.setFullYear(q+1980),X.setMonth(se-1),X.setDate(ne);var Ae=re&31;re>>>=5;var He=re&63;return re>>>=6,X.setHours(re),X.setMinutes(He),X.setSeconds(Ae<<1),X}function o(V){rs(V,0);for(var re={},q=0;V.l<=V.length-4;){var X=V.read_shift(2),ne=V.read_shift(2),se=V.l+ne,Ae={};switch(X){case 21589:q=V.read_shift(1),q&1&&(Ae.mtime=V.read_shift(4)),ne>5&&(q&2&&(Ae.atime=V.read_shift(4)),q&4&&(Ae.ctime=V.read_shift(4))),Ae.mtime&&(Ae.mt=new Date(Ae.mtime*1e3));break}V.l=se,re[X]=Ae}return re}var u;function c(){return u||(u={})}function f(V,re){if(V[0]==80&&V[1]==75)return xa(V,re);if((V[0]|32)==109&&(V[1]|32)==105)return ad(V,re);if(V.length<512)throw new Error("CFB file size "+V.length+" < 512");var q=3,X=512,ne=0,se=0,Ae=0,He=0,Re=0,me=[],z=V.slice(0,512);rs(z,0);var Ce=g(z);switch(q=Ce[0],q){case 3:X=512;break;case 4:X=4096;break;case 0:if(Ce[1]==0)return xa(V,re);default:throw new Error("Major Version: Expected 3 or 4 saw "+q)}X!==512&&(z=V.slice(0,X),rs(z,28));var Pe=V.slice(0,X);m(z,q);var Ye=z.read_shift(4,"i");if(q===3&&Ye!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Ye);z.l+=4,Ae=z.read_shift(4,"i"),z.l+=4,z.chk("00100000","Mini Stream Cutoff Size: "),He=z.read_shift(4,"i"),ne=z.read_shift(4,"i"),Re=z.read_shift(4,"i"),se=z.read_shift(4,"i");for(var $e=-1,ze=0;ze<109&&($e=z.read_shift(4,"i"),!($e<0));++ze)me[ze]=$e;var dt=v(V,X);b(Re,se,dt,X,me);var Xt=_(dt,Ae,me,X);Xt[Ae].name="!Directory",ne>0&&He!==ve&&(Xt[He].name="!MiniFAT"),Xt[me[0]].name="!FAT",Xt.fat_addrs=me,Xt.ssz=X;var cr={},Ir=[],an=[],tl=[];T(Ae,Xt,dt,Ir,ne,cr,an,He),w(an,tl,Ir),Ir.shift();var Ds={FileIndex:an,FullPaths:tl};return re&&re.raw&&(Ds.raw={header:Pe,sectors:dt}),Ds}function g(V){if(V[V.l]==80&&V[V.l+1]==75)return[0,0];V.chk(be,"Header Signature: "),V.l+=16;var re=V.read_shift(2,"u");return[V.read_shift(2,"u"),re]}function m(V,re){var q=9;switch(V.l+=2,q=V.read_shift(2)){case 9:if(re!=3)throw new Error("Sector Shift: Expected 9 saw "+q);break;case 12:if(re!=4)throw new Error("Sector Shift: Expected 12 saw "+q);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+q)}V.chk("0600","Mini Sector Shift: "),V.chk("000000000000","Reserved: ")}function v(V,re){for(var q=Math.ceil(V.length/re)-1,X=[],ne=1;ne<q;++ne)X[ne-1]=V.slice(ne*re,(ne+1)*re);return X[q-1]=V.slice(q*re),X}function w(V,re,q){for(var X=0,ne=0,se=0,Ae=0,He=0,Re=q.length,me=[],z=[];X<Re;++X)me[X]=z[X]=X,re[X]=q[X];for(;He<z.length;++He)X=z[He],ne=V[X].L,se=V[X].R,Ae=V[X].C,me[X]===X&&(ne!==-1&&me[ne]!==ne&&(me[X]=me[ne]),se!==-1&&me[se]!==se&&(me[X]=me[se])),Ae!==-1&&(me[Ae]=X),ne!==-1&&X!=me[X]&&(me[ne]=me[X],z.lastIndexOf(ne)<He&&z.push(ne)),se!==-1&&X!=me[X]&&(me[se]=me[X],z.lastIndexOf(se)<He&&z.push(se));for(X=1;X<Re;++X)me[X]===X&&(se!==-1&&me[se]!==se?me[X]=me[se]:ne!==-1&&me[ne]!==ne&&(me[X]=me[ne]));for(X=1;X<Re;++X)if(V[X].type!==0){if(He=X,He!=me[He])do He=me[He],re[X]=re[He]+"/"+re[X];while(He!==0&&me[He]!==-1&&He!=me[He]);me[X]=-1}for(re[0]+="/",X=1;X<Re;++X)V[X].type!==2&&(re[X]+="/")}function y(V,re,q){for(var X=V.start,ne=V.size,se=[],Ae=X;q&&ne>0&&Ae>=0;)se.push(re.slice(Ae*G,Ae*G+G)),ne-=G,Ae=gg(q,Ae*4);return se.length===0?Fe(0):Yi(se).slice(0,V.size)}function b(V,re,q,X,ne){var se=ve;if(V===ve){if(re!==0)throw new Error("DIFAT chain shorter than expected")}else if(V!==-1){var Ae=q[V],He=(X>>>2)-1;if(!Ae)return;for(var Re=0;Re<He&&(se=gg(Ae,Re*4))!==ve;++Re)ne.push(se);b(gg(Ae,X-4),re-1,q,X,ne)}}function x(V,re,q,X,ne){var se=[],Ae=[];ne||(ne=[]);var He=X-1,Re=0,me=0;for(Re=re;Re>=0;){ne[Re]=!0,se[se.length]=Re,Ae.push(V[Re]);var z=q[Math.floor(Re*4/X)];if(me=Re*4&He,X<4+me)throw new Error("FAT boundary crossed: "+Re+" 4 "+X);if(!V[z])break;Re=gg(V[z],me)}return{nodes:se,data:gG([Ae])}}function _(V,re,q,X){var ne=V.length,se=[],Ae=[],He=[],Re=[],me=X-1,z=0,Ce=0,Pe=0,Ye=0;for(z=0;z<ne;++z)if(He=[],Pe=z+re,Pe>=ne&&(Pe-=ne),!Ae[Pe]){Re=[];var $e=[];for(Ce=Pe;Ce>=0;){$e[Ce]=!0,Ae[Ce]=!0,He[He.length]=Ce,Re.push(V[Ce]);var ze=q[Math.floor(Ce*4/X)];if(Ye=Ce*4&me,X<4+Ye)throw new Error("FAT boundary crossed: "+Ce+" 4 "+X);if(!V[ze]||(Ce=gg(V[ze],Ye),$e[Ce]))break}se[Pe]={nodes:He,data:gG([Re])}}return se}function T(V,re,q,X,ne,se,Ae,He){for(var Re=0,me=X.length?2:0,z=re[V].data,Ce=0,Pe=0,Ye;Ce<z.length;Ce+=128){var $e=z.slice(Ce,Ce+128);rs($e,64),Pe=$e.read_shift(2),Ye=OT($e,0,Pe-me),X.push(Ye);var ze={name:Ye,type:$e.read_shift(1),color:$e.read_shift(1),L:$e.read_shift(4,"i"),R:$e.read_shift(4,"i"),C:$e.read_shift(4,"i"),clsid:$e.read_shift(16),state:$e.read_shift(4,"i"),start:0,size:0},dt=$e.read_shift(2)+$e.read_shift(2)+$e.read_shift(2)+$e.read_shift(2);dt!==0&&(ze.ct=D($e,$e.l-8));var Xt=$e.read_shift(2)+$e.read_shift(2)+$e.read_shift(2)+$e.read_shift(2);Xt!==0&&(ze.mt=D($e,$e.l-8)),ze.start=$e.read_shift(4,"i"),ze.size=$e.read_shift(4,"i"),ze.size<0&&ze.start<0&&(ze.size=ze.type=0,ze.start=ve,ze.name=""),ze.type===5?(Re=ze.start,ne>0&&Re!==ve&&(re[Re].name="!StreamData")):ze.size>=4096?(ze.storage="fat",re[ze.start]===void 0&&(re[ze.start]=x(q,ze.start,re.fat_addrs,re.ssz)),re[ze.start].name=ze.name,ze.content=re[ze.start].data.slice(0,ze.size)):(ze.storage="minifat",ze.size<0?ze.size=0:Re!==ve&&ze.start!==ve&&re[Re]&&(ze.content=y(ze,re[Re].data,(re[He]||{}).data))),ze.content&&rs(ze.content,0),se[Ye]=ze,Ae.push(ze)}}function D(V,re){return new Date((ji(V,re+4)/1e7*Math.pow(2,32)+ji(V,re)/1e7-11644473600)*1e3)}function P(V,re){return c(),f(u.readFileSync(V),re)}function O(V,re){var q=re&&re.type;switch(q||Gt&&Buffer.isBuffer(V)&&(q="buffer"),q||"base64"){case"file":return P(V,re);case"base64":return f(Ga(Za(V)),re);case"binary":return f(Ga(V),re)}return f(V,re)}function A(V,re){var q=re||{},X=q.root||"Root Entry";if(V.FullPaths||(V.FullPaths=[]),V.FileIndex||(V.FileIndex=[]),V.FullPaths.length!==V.FileIndex.length)throw new Error("inconsistent CFB structure");V.FullPaths.length===0&&(V.FullPaths[0]=X+"/",V.FileIndex[0]={name:X,type:5}),q.CLSID&&(V.FileIndex[0].clsid=q.CLSID),W(V)}function W(V){var re="Sh33tJ5";if(!vt.find(V,"/"+re)){var q=Fe(4);q[0]=55,q[1]=q[3]=50,q[2]=54,V.FileIndex.push({name:re,type:2,content:q,size:4,L:69,R:69,C:69}),V.FullPaths.push(V.FullPaths[0]+re),L(V)}}function L(V,re){A(V);for(var q=!1,X=!1,ne=V.FullPaths.length-1;ne>=0;--ne){var se=V.FileIndex[ne];switch(se.type){case 0:X?q=!0:(V.FileIndex.pop(),V.FullPaths.pop());break;case 1:case 2:case 5:X=!0,isNaN(se.R*se.L*se.C)&&(q=!0),se.R>-1&&se.L>-1&&se.R==se.L&&(q=!0);break;default:q=!0;break}}if(!(!q&&!re)){var Ae=new Date(1987,1,19),He=0,Re=Object.create?Object.create(null):{},me=[];for(ne=0;ne<V.FullPaths.length;++ne)Re[V.FullPaths[ne]]=!0,V.FileIndex[ne].type!==0&&me.push([V.FullPaths[ne],V.FileIndex[ne]]);for(ne=0;ne<me.length;++ne){var z=n(me[ne][0]);X=Re[z],X||(me.push([z,{name:i(z).replace("/",""),type:1,clsid:ae,ct:Ae,mt:Ae,content:null}]),Re[z]=!0)}for(me.sort(function(Ye,$e){return r(Ye[0],$e[0])}),V.FullPaths=[],V.FileIndex=[],ne=0;ne<me.length;++ne)V.FullPaths[ne]=me[ne][0],V.FileIndex[ne]=me[ne][1];for(ne=0;ne<me.length;++ne){var Ce=V.FileIndex[ne],Pe=V.FullPaths[ne];if(Ce.name=i(Pe).replace("/",""),Ce.L=Ce.R=Ce.C=-(Ce.color=1),Ce.size=Ce.content?Ce.content.length:0,Ce.start=0,Ce.clsid=Ce.clsid||ae,ne===0)Ce.C=me.length>1?1:-1,Ce.size=0,Ce.type=5;else if(Pe.slice(-1)=="/"){for(He=ne+1;He<me.length&&n(V.FullPaths[He])!=Pe;++He);for(Ce.C=He>=me.length?-1:He,He=ne+1;He<me.length&&n(V.FullPaths[He])!=n(Pe);++He);Ce.R=He>=me.length?-1:He,Ce.type=1}else n(V.FullPaths[ne+1]||"")==n(Pe)&&(Ce.R=ne+1),Ce.type=2}}}function H(V,re){var q=re||{};if(q.fileType=="mad")return _a(V,q);switch(L(V),q.fileType){case"zip":return Ea(V,q)}var X=function(Ye){for(var $e=0,ze=0,dt=0;dt<Ye.FileIndex.length;++dt){var Xt=Ye.FileIndex[dt];if(Xt.content){var cr=Xt.content.length;cr>0&&(cr<4096?$e+=cr+63>>6:ze+=cr+511>>9)}}for(var Ir=Ye.FullPaths.length+3>>2,an=$e+7>>3,tl=$e+127>>7,Ds=an+ze+Ir+tl,rl=Ds+127>>7,od=rl<=109?0:Math.ceil((rl-109)/127);Ds+rl+od+127>>7>rl;)od=++rl<=109?0:Math.ceil((rl-109)/127);var nl=[1,od,rl,tl,Ir,ze,$e,0];return Ye.FileIndex[0].size=$e<<6,nl[7]=(Ye.FileIndex[0].start=nl[0]+nl[1]+nl[2]+nl[3]+nl[4]+nl[5])+(nl[6]+7>>3),nl}(V),ne=Fe(X[7]<<9),se=0,Ae=0;{for(se=0;se<8;++se)ne.write_shift(1,we[se]);for(se=0;se<8;++se)ne.write_shift(2,0);for(ne.write_shift(2,62),ne.write_shift(2,3),ne.write_shift(2,65534),ne.write_shift(2,9),ne.write_shift(2,6),se=0;se<3;++se)ne.write_shift(2,0);for(ne.write_shift(4,0),ne.write_shift(4,X[2]),ne.write_shift(4,X[0]+X[1]+X[2]+X[3]-1),ne.write_shift(4,0),ne.write_shift(4,4096),ne.write_shift(4,X[3]?X[0]+X[1]+X[2]-1:ve),ne.write_shift(4,X[3]),ne.write_shift(-4,X[1]?X[0]-1:ve),ne.write_shift(4,X[1]),se=0;se<109;++se)ne.write_shift(-4,se<X[2]?X[1]+se:-1)}if(X[1])for(Ae=0;Ae<X[1];++Ae){for(;se<236+Ae*127;++se)ne.write_shift(-4,se<X[2]?X[1]+se:-1);ne.write_shift(-4,Ae===X[1]-1?ve:Ae+1)}var He=function(Ye){for(Ae+=Ye;se<Ae-1;++se)ne.write_shift(-4,se+1);Ye&&(++se,ne.write_shift(-4,ve))};for(Ae=se=0,Ae+=X[1];se<Ae;++se)ne.write_shift(-4,le.DIFSECT);for(Ae+=X[2];se<Ae;++se)ne.write_shift(-4,le.FATSECT);He(X[3]),He(X[4]);for(var Re=0,me=0,z=V.FileIndex[0];Re<V.FileIndex.length;++Re)z=V.FileIndex[Re],z.content&&(me=z.content.length,!(me<4096)&&(z.start=Ae,He(me+511>>9)));for(He(X[6]+7>>3);ne.l&511;)ne.write_shift(-4,le.ENDOFCHAIN);for(Ae=se=0,Re=0;Re<V.FileIndex.length;++Re)z=V.FileIndex[Re],z.content&&(me=z.content.length,!(!me||me>=4096)&&(z.start=Ae,He(me+63>>6)));for(;ne.l&511;)ne.write_shift(-4,le.ENDOFCHAIN);for(se=0;se<X[4]<<2;++se){var Ce=V.FullPaths[se];if(!Ce||Ce.length===0){for(Re=0;Re<17;++Re)ne.write_shift(4,0);for(Re=0;Re<3;++Re)ne.write_shift(4,-1);for(Re=0;Re<12;++Re)ne.write_shift(4,0);continue}z=V.FileIndex[se],se===0&&(z.start=z.size?z.start-1:ve);var Pe=se===0&&q.root||z.name;if(me=2*(Pe.length+1),ne.write_shift(64,Pe,"utf16le"),ne.write_shift(2,me),ne.write_shift(1,z.type),ne.write_shift(1,z.color),ne.write_shift(-4,z.L),ne.write_shift(-4,z.R),ne.write_shift(-4,z.C),z.clsid)ne.write_shift(16,z.clsid,"hex");else for(Re=0;Re<4;++Re)ne.write_shift(4,0);ne.write_shift(4,z.state||0),ne.write_shift(4,0),ne.write_shift(4,0),ne.write_shift(4,0),ne.write_shift(4,0),ne.write_shift(4,z.start),ne.write_shift(4,z.size),ne.write_shift(4,0)}for(se=1;se<V.FileIndex.length;++se)if(z=V.FileIndex[se],z.size>=4096)if(ne.l=z.start+1<<9,Gt&&Buffer.isBuffer(z.content))z.content.copy(ne,ne.l,0,z.size),ne.l+=z.size+511&-512;else{for(Re=0;Re<z.size;++Re)ne.write_shift(1,z.content[Re]);for(;Re&511;++Re)ne.write_shift(1,0)}for(se=1;se<V.FileIndex.length;++se)if(z=V.FileIndex[se],z.size>0&&z.size<4096)if(Gt&&Buffer.isBuffer(z.content))z.content.copy(ne,ne.l,0,z.size),ne.l+=z.size+63&-64;else{for(Re=0;Re<z.size;++Re)ne.write_shift(1,z.content[Re]);for(;Re&63;++Re)ne.write_shift(1,0)}if(Gt)ne.l=ne.length;else for(;ne.l<ne.length;)ne.write_shift(1,0);return ne}function J(V,re){var q=V.FullPaths.map(function(Re){return Re.toUpperCase()}),X=q.map(function(Re){var me=Re.split("/");return me[me.length-(Re.slice(-1)=="/"?2:1)]}),ne=!1;re.charCodeAt(0)===47?(ne=!0,re=q[0].slice(0,-1)+re):ne=re.indexOf("/")!==-1;var se=re.toUpperCase(),Ae=ne===!0?q.indexOf(se):X.indexOf(se);if(Ae!==-1)return V.FileIndex[Ae];var He=!se.match(My);for(se=se.replace(Rs,""),He&&(se=se.replace(My,"!")),Ae=0;Ae<q.length;++Ae)if((He?q[Ae].replace(My,"!"):q[Ae]).replace(Rs,"")==se||(He?X[Ae].replace(My,"!"):X[Ae]).replace(Rs,"")==se)return V.FileIndex[Ae];return null}var G=64,ve=-2,be="d0cf11e0a1b11ae1",we=[208,207,17,224,161,177,26,225],ae="00000000000000000000000000000000",le={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:ve,FREESECT:-1,HEADER_SIGNATURE:be,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:ae,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function Te(V,re,q){c();var X=H(V,q);u.writeFileSync(re,X)}function ce(V){for(var re=new Array(V.length),q=0;q<V.length;++q)re[q]=String.fromCharCode(V[q]);return re.join("")}function K(V,re){var q=H(V,re);switch(re&&re.type||"buffer"){case"file":return c(),u.writeFileSync(re.filename,q),q;case"binary":return typeof q=="string"?q:ce(q);case"base64":return $1(typeof q=="string"?q:ce(q));case"buffer":if(Gt)return Buffer.isBuffer(q)?q:dh(q);case"array":return typeof q=="string"?Ga(q):q}return q}var Se;function B(V){try{var re=V.InflateRaw,q=new re;if(q._processChunk(new Uint8Array([3,0]),q._finishFlushFlag),q.bytesRead)Se=V;else throw new Error("zlib does not expose bytesRead")}catch(X){console.error("cannot use native zlib: "+(X.message||X))}}function E(V,re){if(!Se)return qi(V,re);var q=Se.InflateRaw,X=new q,ne=X._processChunk(V.slice(V.l),X._finishFlushFlag);return V.l+=X.bytesRead,ne}function R(V){return Se?Se.deflateRawSync(V):yt(V)}var M=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],F=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],Z=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function te(V){var re=(V<<1|V<<11)&139536|(V<<5|V<<15)&558144;return(re>>16|re>>8|re)&255}for(var fe=typeof Uint8Array<"u",I=fe?new Uint8Array(256):[],U=0;U<256;++U)I[U]=te(U);function k(V,re){var q=I[V&255];return re<=8?q>>>8-re:(q=q<<8|I[V>>8&255],re<=16?q>>>16-re:(q=q<<8|I[V>>16&255],q>>>24-re))}function ee(V,re){var q=re&7,X=re>>>3;return(V[X]|(q<=6?0:V[X+1]<<8))>>>q&3}function oe(V,re){var q=re&7,X=re>>>3;return(V[X]|(q<=5?0:V[X+1]<<8))>>>q&7}function de(V,re){var q=re&7,X=re>>>3;return(V[X]|(q<=4?0:V[X+1]<<8))>>>q&15}function pe(V,re){var q=re&7,X=re>>>3;return(V[X]|(q<=3?0:V[X+1]<<8))>>>q&31}function Q(V,re){var q=re&7,X=re>>>3;return(V[X]|(q<=1?0:V[X+1]<<8))>>>q&127}function ge(V,re,q){var X=re&7,ne=re>>>3,se=(1<<q)-1,Ae=V[ne]>>>X;return q<8-X||(Ae|=V[ne+1]<<8-X,q<16-X)||(Ae|=V[ne+2]<<16-X,q<24-X)||(Ae|=V[ne+3]<<24-X),Ae&se}function xe(V,re,q){var X=re&7,ne=re>>>3;return X<=5?V[ne]|=(q&7)<<X:(V[ne]|=q<<X&255,V[ne+1]=(q&7)>>8-X),re+3}function _e(V,re,q){var X=re&7,ne=re>>>3;return q=(q&1)<<X,V[ne]|=q,re+1}function Ne(V,re,q){var X=re&7,ne=re>>>3;return q<<=X,V[ne]|=q&255,q>>>=8,V[ne+1]=q,re+8}function Xe(V,re,q){var X=re&7,ne=re>>>3;return q<<=X,V[ne]|=q&255,q>>>=8,V[ne+1]=q&255,V[ne+2]=q>>>8,re+16}function Qe(V,re){var q=V.length,X=2*q>re?2*q:re+5,ne=0;if(q>=re)return V;if(Gt){var se=Kz(X);if(V.copy)V.copy(se);else for(;ne<V.length;++ne)se[ne]=V[ne];return se}else if(fe){var Ae=new Uint8Array(X);if(Ae.set)Ae.set(V);else for(;ne<q;++ne)Ae[ne]=V[ne];return Ae}return V.length=X,V}function ht(V){for(var re=new Array(V),q=0;q<V;++q)re[q]=0;return re}function Mt(V,re,q){var X=1,ne=0,se=0,Ae=0,He=0,Re=V.length,me=fe?new Uint16Array(32):ht(32);for(se=0;se<32;++se)me[se]=0;for(se=Re;se<q;++se)V[se]=0;Re=V.length;var z=fe?new Uint16Array(Re):ht(Re);for(se=0;se<Re;++se)me[ne=V[se]]++,X<ne&&(X=ne),z[se]=0;for(me[0]=0,se=1;se<=X;++se)me[se+16]=He=He+me[se-1]<<1;for(se=0;se<Re;++se)He=V[se],He!=0&&(z[se]=me[He+16]++);var Ce=0;for(se=0;se<Re;++se)if(Ce=V[se],Ce!=0)for(He=k(z[se],X)>>X-Ce,Ae=(1<<X+4-Ce)-1;Ae>=0;--Ae)re[He|Ae<<Ce]=Ce&15|se<<4;return X}var Et=fe?new Uint16Array(512):ht(512),at=fe?new Uint16Array(32):ht(32);if(!fe){for(var nt=0;nt<512;++nt)Et[nt]=0;for(nt=0;nt<32;++nt)at[nt]=0}(function(){for(var V=[],re=0;re<32;re++)V.push(5);Mt(V,at,32);var q=[];for(re=0;re<=143;re++)q.push(8);for(;re<=255;re++)q.push(9);for(;re<=279;re++)q.push(7);for(;re<=287;re++)q.push(8);Mt(q,Et,288)})();var pt=function(){for(var re=fe?new Uint8Array(32768):[],q=0,X=0;q<Z.length-1;++q)for(;X<Z[q+1];++X)re[X]=q;for(;X<32768;++X)re[X]=29;var ne=fe?new Uint8Array(259):[];for(q=0,X=0;q<F.length-1;++q)for(;X<F[q+1];++X)ne[X]=q;function se(He,Re){for(var me=0;me<He.length;){var z=Math.min(65535,He.length-me),Ce=me+z==He.length;for(Re.write_shift(1,+Ce),Re.write_shift(2,z),Re.write_shift(2,~z&65535);z-- >0;)Re[Re.l++]=He[me++]}return Re.l}function Ae(He,Re){for(var me=0,z=0,Ce=fe?new Uint16Array(32768):[];z<He.length;){var Pe=Math.min(65535,He.length-z);if(Pe<10){for(me=xe(Re,me,+(z+Pe==He.length)),me&7&&(me+=8-(me&7)),Re.l=me/8|0,Re.write_shift(2,Pe),Re.write_shift(2,~Pe&65535);Pe-- >0;)Re[Re.l++]=He[z++];me=Re.l*8;continue}me=xe(Re,me,+(z+Pe==He.length)+2);for(var Ye=0;Pe-- >0;){var $e=He[z];Ye=(Ye<<5^$e)&32767;var ze=-1,dt=0;if((ze=Ce[Ye])&&(ze|=z&-32768,ze>z&&(ze-=32768),ze<z))for(;He[ze+dt]==He[z+dt]&&dt<250;)++dt;if(dt>2){$e=ne[dt],$e<=22?me=Ne(Re,me,I[$e+1]>>1)-1:(Ne(Re,me,3),me+=5,Ne(Re,me,I[$e-23]>>5),me+=3);var Xt=$e<8?0:$e-4>>2;Xt>0&&(Xe(Re,me,dt-F[$e]),me+=Xt),$e=re[z-ze],me=Ne(Re,me,I[$e]>>3),me-=3;var cr=$e<4?0:$e-2>>1;cr>0&&(Xe(Re,me,z-ze-Z[$e]),me+=cr);for(var Ir=0;Ir<dt;++Ir)Ce[Ye]=z&32767,Ye=(Ye<<5^He[z])&32767,++z;Pe-=dt-1}else $e<=143?$e=$e+48:me=_e(Re,me,1),me=Ne(Re,me,I[$e]),Ce[Ye]=z&32767,++z}me=Ne(Re,me,0)-1}return Re.l=(me+7)/8|0,Re.l}return function(Re,me){return Re.length<8?se(Re,me):Ae(Re,me)}}();function yt(V){var re=Fe(50+Math.floor(V.length*1.1)),q=pt(V,re);return re.slice(0,q)}var pr=fe?new Uint16Array(32768):ht(32768),sn=fe?new Uint16Array(32768):ht(32768),Dt=fe?new Uint16Array(128):ht(128),Kt=1,or=1;function vr(V,re){var q=pe(V,re)+257;re+=5;var X=pe(V,re)+1;re+=5;var ne=de(V,re)+4;re+=4;for(var se=0,Ae=fe?new Uint8Array(19):ht(19),He=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Re=1,me=fe?new Uint8Array(8):ht(8),z=fe?new Uint8Array(8):ht(8),Ce=Ae.length,Pe=0;Pe<ne;++Pe)Ae[M[Pe]]=se=oe(V,re),Re<se&&(Re=se),me[se]++,re+=3;var Ye=0;for(me[0]=0,Pe=1;Pe<=Re;++Pe)z[Pe]=Ye=Ye+me[Pe-1]<<1;for(Pe=0;Pe<Ce;++Pe)(Ye=Ae[Pe])!=0&&(He[Pe]=z[Ye]++);var $e=0;for(Pe=0;Pe<Ce;++Pe)if($e=Ae[Pe],$e!=0){Ye=I[He[Pe]]>>8-$e;for(var ze=(1<<7-$e)-1;ze>=0;--ze)Dt[Ye|ze<<$e]=$e&7|Pe<<3}var dt=[];for(Re=1;dt.length<q+X;)switch(Ye=Dt[Q(V,re)],re+=Ye&7,Ye>>>=3){case 16:for(se=3+ee(V,re),re+=2,Ye=dt[dt.length-1];se-- >0;)dt.push(Ye);break;case 17:for(se=3+oe(V,re),re+=3;se-- >0;)dt.push(0);break;case 18:for(se=11+Q(V,re),re+=7;se-- >0;)dt.push(0);break;default:dt.push(Ye),Re<Ye&&(Re=Ye);break}var Xt=dt.slice(0,q),cr=dt.slice(q);for(Pe=q;Pe<286;++Pe)Xt[Pe]=0;for(Pe=X;Pe<30;++Pe)cr[Pe]=0;return Kt=Mt(Xt,pr,286),or=Mt(cr,sn,30),re}function $t(V,re){if(V[0]==3&&!(V[1]&3))return[Uf(re),2];for(var q=0,X=0,ne=Kz(re||1<<18),se=0,Ae=ne.length>>>0,He=0,Re=0;(X&1)==0;){if(X=oe(V,q),q+=3,X>>>1)X>>1==1?(He=9,Re=5):(q=vr(V,q),He=Kt,Re=or);else{q&7&&(q+=8-(q&7));var me=V[q>>>3]|V[(q>>>3)+1]<<8;if(q+=32,me>0)for(!re&&Ae<se+me&&(ne=Qe(ne,se+me),Ae=ne.length);me-- >0;)ne[se++]=V[q>>>3],q+=8;continue}for(;;){!re&&Ae<se+32767&&(ne=Qe(ne,se+32767),Ae=ne.length);var z=ge(V,q,He),Ce=X>>>1==1?Et[z]:pr[z];if(q+=Ce&15,Ce>>>=4,(Ce>>>8&255)===0)ne[se++]=Ce;else{if(Ce==256)break;Ce-=257;var Pe=Ce<8?0:Ce-4>>2;Pe>5&&(Pe=0);var Ye=se+F[Ce];Pe>0&&(Ye+=ge(V,q,Pe),q+=Pe),z=ge(V,q,Re),Ce=X>>>1==1?at[z]:sn[z],q+=Ce&15,Ce>>>=4;var $e=Ce<4?0:Ce-2>>1,ze=Z[Ce];for($e>0&&(ze+=ge(V,q,$e),q+=$e),!re&&Ae<Ye&&(ne=Qe(ne,Ye+100),Ae=ne.length);se<Ye;)ne[se]=ne[se-ze],++se}}}return re?[ne,q+7>>>3]:[ne.slice(0,se),q+7>>>3]}function qi(V,re){var q=V.slice(V.l||0),X=$t(q,re);return V.l+=X[1],X[0]}function Kn(V,re){if(V)typeof console<"u"&&console.error(re);else throw new Error(re)}function xa(V,re){var q=V;rs(q,0);var X=[],ne=[],se={FileIndex:X,FullPaths:ne};A(se,{root:re.root});for(var Ae=q.length-4;(q[Ae]!=80||q[Ae+1]!=75||q[Ae+2]!=5||q[Ae+3]!=6)&&Ae>=0;)--Ae;q.l=Ae+4,q.l+=4;var He=q.read_shift(2);q.l+=6;var Re=q.read_shift(4);for(q.l=Re,Ae=0;Ae<He;++Ae){q.l+=20;var me=q.read_shift(4),z=q.read_shift(4),Ce=q.read_shift(2),Pe=q.read_shift(2),Ye=q.read_shift(2);q.l+=8;var $e=q.read_shift(4),ze=o(q.slice(q.l+Ce,q.l+Ce+Pe));q.l+=Ce+Pe+Ye;var dt=q.l;q.l=$e+4,Bl(q,me,z,se,ze),q.l=dt}return se}function Bl(V,re,q,X,ne){V.l+=2;var se=V.read_shift(2),Ae=V.read_shift(2),He=a(V);if(se&8257)throw new Error("Unsupported ZIP encryption");for(var Re=V.read_shift(4),me=V.read_shift(4),z=V.read_shift(4),Ce=V.read_shift(2),Pe=V.read_shift(2),Ye="",$e=0;$e<Ce;++$e)Ye+=String.fromCharCode(V[V.l++]);if(Pe){var ze=o(V.slice(V.l,V.l+Pe));(ze[21589]||{}).mt&&(He=ze[21589].mt),((ne||{})[21589]||{}).mt&&(He=ne[21589].mt)}V.l+=Pe;var dt=V.slice(V.l,V.l+me);switch(Ae){case 8:dt=E(V,z);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+Ae)}var Xt=!1;se&8&&(Re=V.read_shift(4),Re==134695760&&(Re=V.read_shift(4),Xt=!0),me=V.read_shift(4),z=V.read_shift(4)),me!=re&&Kn(Xt,"Bad compressed size: "+re+" != "+me),z!=q&&Kn(Xt,"Bad uncompressed size: "+q+" != "+z),fi(X,Ye,dt,{unsafe:!0,mt:He})}function Ea(V,re){var q=re||{},X=[],ne=[],se=Fe(1),Ae=q.compression?8:0,He=0,Re=0,me=0,z=0,Ce=0,Pe=V.FullPaths[0],Ye=Pe,$e=V.FileIndex[0],ze=[],dt=0;for(Re=1;Re<V.FullPaths.length;++Re)if(Ye=V.FullPaths[Re].slice(Pe.length),$e=V.FileIndex[Re],!(!$e.size||!$e.content||Ye=="Sh33tJ5")){var Xt=z,cr=Fe(Ye.length);for(me=0;me<Ye.length;++me)cr.write_shift(1,Ye.charCodeAt(me)&127);cr=cr.slice(0,cr.l),ze[Ce]=s4e.buf($e.content,0);var Ir=$e.content;Ae==8&&(Ir=R(Ir)),se=Fe(30),se.write_shift(4,67324752),se.write_shift(2,20),se.write_shift(2,He),se.write_shift(2,Ae),$e.mt?s(se,$e.mt):se.write_shift(4,0),se.write_shift(-4,ze[Ce]),se.write_shift(4,Ir.length),se.write_shift(4,$e.content.length),se.write_shift(2,cr.length),se.write_shift(2,0),z+=se.length,X.push(se),z+=cr.length,X.push(cr),z+=Ir.length,X.push(Ir),se=Fe(46),se.write_shift(4,33639248),se.write_shift(2,0),se.write_shift(2,20),se.write_shift(2,He),se.write_shift(2,Ae),se.write_shift(4,0),se.write_shift(-4,ze[Ce]),se.write_shift(4,Ir.length),se.write_shift(4,$e.content.length),se.write_shift(2,cr.length),se.write_shift(2,0),se.write_shift(2,0),se.write_shift(2,0),se.write_shift(2,0),se.write_shift(4,0),se.write_shift(4,Xt),dt+=se.l,ne.push(se),dt+=cr.length,ne.push(cr),++Ce}return se=Fe(22),se.write_shift(4,101010256),se.write_shift(2,0),se.write_shift(2,0),se.write_shift(2,Ce),se.write_shift(2,Ce),se.write_shift(4,dt),se.write_shift(4,z),se.write_shift(2,0),Yi([Yi(X),Yi(ne),se])}var vh={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function wm(V,re){if(V.ctype)return V.ctype;var q=V.name||"",X=q.match(/\.([^\.]+)$/);return X&&vh[X[1]]||re&&(X=(q=re).match(/[\.\\]([^\.\\])+$/),X&&vh[X[1]])?vh[X[1]]:"application/octet-stream"}function Cn(V){for(var re=$1(V),q=[],X=0;X<re.length;X+=76)q.push(re.slice(X,X+76));return q.join(`\r
`)+`\r
`}function to(V){var re=V.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(me){var z=me.charCodeAt(0).toString(16).toUpperCase();return"="+(z.length==1?"0"+z:z)});re=re.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),re.charAt(0)==`
`&&(re="=0D"+re.slice(1)),re=re.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var q=[],X=re.split(`\r
`),ne=0;ne<X.length;++ne){var se=X[ne];if(se.length==0){q.push("");continue}for(var Ae=0;Ae<se.length;){var He=76,Re=se.slice(Ae,Ae+He);Re.charAt(He-1)=="="?He--:Re.charAt(He-2)=="="?He-=2:Re.charAt(He-3)=="="&&(He-=3),Re=se.slice(Ae,Ae+He),Ae+=He,Ae<se.length&&(Re+="="),q.push(Re)}}return q.join(`\r
`)}function id(V){for(var re=[],q=0;q<V.length;++q){for(var X=V[q];q<=V.length&&X.charAt(X.length-1)=="=";)X=X.slice(0,X.length-1)+V[++q];re.push(X)}for(var ne=0;ne<re.length;++ne)re[ne]=re[ne].replace(/[=][0-9A-Fa-f]{2}/g,function(se){return String.fromCharCode(parseInt(se.slice(1),16))});return Ga(re.join(`\r
`))}function sd(V,re,q){for(var X="",ne="",se="",Ae,He=0;He<10;++He){var Re=re[He];if(!Re||Re.match(/^\s*$/))break;var me=Re.match(/^(.*?):\s*([^\s].*)$/);if(me)switch(me[1].toLowerCase()){case"content-location":X=me[2].trim();break;case"content-type":se=me[2].trim();break;case"content-transfer-encoding":ne=me[2].trim();break}}switch(++He,ne.toLowerCase()){case"base64":Ae=Ga(Za(re.slice(He).join("")));break;case"quoted-printable":Ae=id(re.slice(He));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+ne)}var z=fi(V,X.slice(q.length),Ae,{unsafe:!0});se&&(z.ctype=se)}function ad(V,re){if(ce(V.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var q=re&&re.root||"",X=(Gt&&Buffer.isBuffer(V)?V.toString("binary"):ce(V)).split(`\r
`),ne=0,se="";for(ne=0;ne<X.length;++ne)if(se=X[ne],!!/^Content-Location:/i.test(se)&&(se=se.slice(se.indexOf("file")),q||(q=se.slice(0,se.lastIndexOf("/")+1)),se.slice(0,q.length)!=q))for(;q.length>0&&(q=q.slice(0,q.length-1),q=q.slice(0,q.lastIndexOf("/")+1),se.slice(0,q.length)!=q););var Ae=(X[1]||"").match(/boundary="(.*?)"/);if(!Ae)throw new Error("MAD cannot find boundary");var He="--"+(Ae[1]||""),Re=[],me=[],z={FileIndex:Re,FullPaths:me};A(z);var Ce,Pe=0;for(ne=0;ne<X.length;++ne){var Ye=X[ne];Ye!==He&&Ye!==He+"--"||(Pe++&&sd(z,X.slice(Ce,ne),q),Ce=ne)}return z}function _a(V,re){var q=re||{},X=q.boundary||"SheetJS";X="------="+X;for(var ne=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+X.slice(2)+'"',"","",""],se=V.FullPaths[0],Ae=se,He=V.FileIndex[0],Re=1;Re<V.FullPaths.length;++Re)if(Ae=V.FullPaths[Re].slice(se.length),He=V.FileIndex[Re],!(!He.size||!He.content||Ae=="Sh33tJ5")){Ae=Ae.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(dt){return"_x"+dt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(dt){return"_u"+dt.charCodeAt(0).toString(16)+"_"});for(var me=He.content,z=Gt&&Buffer.isBuffer(me)?me.toString("binary"):ce(me),Ce=0,Pe=Math.min(1024,z.length),Ye=0,$e=0;$e<=Pe;++$e)(Ye=z.charCodeAt($e))>=32&&Ye<128&&++Ce;var ze=Ce>=Pe*4/5;ne.push(X),ne.push("Content-Location: "+(q.root||"file:///C:/SheetJS/")+Ae),ne.push("Content-Transfer-Encoding: "+(ze?"quoted-printable":"base64")),ne.push("Content-Type: "+wm(He,Ae)),ne.push(""),ne.push(ze?to(z):Cn(z))}return ne.push(X+`--\r
`),ne.join(`\r
`)}function Xn(V){var re={};return A(re,V),re}function fi(V,re,q,X){var ne=X&&X.unsafe;ne||A(V);var se=!ne&&vt.find(V,re);if(!se){var Ae=V.FullPaths[0];re.slice(0,Ae.length)==Ae?Ae=re:(Ae.slice(-1)!="/"&&(Ae+="/"),Ae=(Ae+re).replace("//","/")),se={name:i(re),type:2},V.FileIndex.push(se),V.FullPaths.push(Ae),ne||vt.utils.cfb_gc(V)}return se.content=q,se.size=q?q.length:0,X&&(X.CLSID&&(se.clsid=X.CLSID),X.mt&&(se.mt=X.mt),X.ct&&(se.ct=X.ct)),se}function Ti(V,re){A(V);var q=vt.find(V,re);if(q){for(var X=0;X<V.FileIndex.length;++X)if(V.FileIndex[X]==q)return V.FileIndex.splice(X,1),V.FullPaths.splice(X,1),!0}return!1}function ro(V,re,q){A(V);var X=vt.find(V,re);if(X){for(var ne=0;ne<V.FileIndex.length;++ne)if(V.FileIndex[ne]==X)return V.FileIndex[ne].name=i(q),V.FullPaths[ne]=q,!0}return!1}function ym(V){L(V,!0)}return e.find=J,e.read=O,e.parse=f,e.write=K,e.writeFile=Te,e.utils={cfb_new:Xn,cfb_add:fi,cfb_del:Ti,cfb_mov:ro,cfb_gc:ym,ReadShift:n1,CheckField:sre,prep_blob:rs,bconcat:Yi,use_zlib:B,_deflateRaw:yt,_inflateRaw:qi,consts:le},e}();let Mf;function a4e(t){Mf=t}function o4e(t){return typeof t=="string"?LS(t):Array.isArray(t)?DLe(t):t}function VS(t,e,r){if(typeof Mf<"u"&&Mf.writeFileSync)return r?Mf.writeFileSync(t,e,r):Mf.writeFileSync(t,e);if(typeof Deno<"u"){if(r&&typeof e=="string")switch(r){case"utf8":e=new TextEncoder(r).encode(e);break;case"binary":e=LS(e);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(t,e)}var n=r=="utf8"?ku(e):e;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,t);if(typeof Blob<"u"){var i=new Blob([o4e(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(i,t);if(typeof saveAs<"u")return saveAs(i,t);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(i);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:t,saveAs:!0});var a=document.createElement("a");if(a.download!=null)return a.download=t,a.href=s,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(t);return o.open("w"),o.encoding="binary",Array.isArray(e)&&(e=td(e)),o.write(e),o.close(),e}catch(u){if(!u.message||!u.message.match(/onstruct/))throw u}throw new Error("cannot save file "+t)}function l4e(t){if(typeof Mf<"u")return Mf.readFileSync(t);if(typeof Deno<"u")return Deno.readFileSync(t);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var e=File(t);e.open("r"),e.encoding="binary";var r=e.read();return e.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+t)}function Gn(t){for(var e=Object.keys(t),r=[],n=0;n<e.length;++n)Object.prototype.hasOwnProperty.call(t,e[n])&&r.push(e[n]);return r}function nG(t,e){for(var r=[],n=Gn(t),i=0;i!==n.length;++i)r[t[n[i]][e]]==null&&(r[t[n[i]][e]]=n[i]);return r}function TT(t){for(var e=[],r=Gn(t),n=0;n!==r.length;++n)e[t[r[n]]]=r[n];return e}function MT(t){for(var e=[],r=Gn(t),n=0;n!==r.length;++n)e[t[r[n]]]=parseInt(r[n],10);return e}function u4e(t){for(var e=[],r=Gn(t),n=0;n!==r.length;++n)e[t[r[n]]]==null&&(e[t[r[n]]]=[]),e[t[r[n]]].push(r[n]);return e}var G_=new Date(1899,11,30,0,0,0);function Hi(t,e){var r=t.getTime(),n=G_.getTime()+(t.getTimezoneOffset()-G_.getTimezoneOffset())*6e4;return(r-n)/(1440*60*1e3)}var $te=new Date,c4e=G_.getTime()+($te.getTimezoneOffset()-G_.getTimezoneOffset())*6e4,iG=$te.getTimezoneOffset();function AT(t){var e=new Date;return e.setTime(t*24*60*60*1e3+c4e),e.getTimezoneOffset()!==iG&&e.setTime(e.getTime()+(e.getTimezoneOffset()-iG)*6e4),e}function h4e(t){var e=0,r=0,n=!1,i=t.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!i)throw new Error("|"+t+"| is not an ISO8601 Duration");for(var s=1;s!=i.length;++s)if(i[s]){switch(r=1,s>3&&(n=!0),i[s].slice(i[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+i[s].slice(i[s].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}e+=r*parseInt(i[s],10)}return e}var sG=new Date("2017-02-19T19:06:09.000Z"),Ute=isNaN(sG.getFullYear())?new Date("2/19/17"):sG,f4e=Ute.getFullYear()==2017;function pn(t,e){var r=new Date(t);if(f4e)return e>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):e<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(t instanceof Date)return t;if(Ute.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return t.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var i=t.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return t.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function Ug(t,e){if(Gt&&Buffer.isBuffer(t)){if(e){if(t[0]==255&&t[1]==254)return ku(t.slice(2).toString("utf16le"));if(t[1]==254&&t[2]==255)return ku(Ate(t.slice(2).toString("binary")))}return t.toString("binary")}if(typeof TextDecoder<"u")try{if(e){if(t[0]==255&&t[1]==254)return ku(new TextDecoder("utf-16le").decode(t.slice(2)));if(t[0]==254&&t[1]==255)return ku(new TextDecoder("utf-16be").decode(t.slice(2)))}var r={"€":"","‚":"",ƒ:"","„":"","…":"","†":"","‡":"","ˆ":"","‰":"",Š:"","‹":"",Œ:"",Ž:"","‘":"","’":"","“":"","”":"","•":"","–":"","—":"","˜":"","™":"",š:"","›":"",œ:"",ž:"",Ÿ:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(s){return r[s]||s})}catch{}for(var n=[],i=0;i!=t.length;++i)n.push(String.fromCharCode(t[i]));return n.join("")}function rn(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=rn(t[r]));return e}function $n(t,e){for(var r="";r.length<e;)r+=t;return r}function Al(t){var e=Number(t);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(t))return e;var r=1,n=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(e=Number(n))||(n=n.replace(/[(](.*)[)]/,function(i,s){return r=-r,s}),!isNaN(e=Number(n)))?e/r:e}var d4e=["january","february","march","april","may","june","july","august","september","october","november","december"];function Lp(t){var e=new Date(t),r=new Date(NaN),n=e.getYear(),i=e.getMonth(),s=e.getDate();if(isNaN(s))return r;var a=t.toLowerCase();if(a.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(a=a.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),a.length>3&&d4e.indexOf(a)==-1)return r}else if(a.match(/[a-z]/))return r;return n<0||n>8099?r:(i>0||s>1)&&n!=101?e:t.match(/[^-0-9:,\/\\]/)?r:e}var g4e=function(){var t="abacaba".split(/(:?b)/i).length==5;return function(r,n,i){if(t||typeof n=="string")return r.split(n);for(var s=r.split(n),a=[s[0]],o=1;o<s.length;++o)a.push(i),a.push(s[o]);return a}}();function jte(t){return t?t.content&&t.type?Ug(t.content,!0):t.data?ap(t.data):t.asNodeBuffer&&Gt?ap(t.asNodeBuffer().toString("binary")):t.asBinary?ap(t.asBinary()):t._data&&t._data.getContent?ap(Ug(Array.prototype.slice.call(t._data.getContent(),0))):null:null}function Yte(t){if(!t)return null;if(t.data)return U_(t.data);if(t.asNodeBuffer&&Gt)return t.asNodeBuffer();if(t._data&&t._data.getContent){var e=t._data.getContent();return typeof e=="string"?U_(e):Array.prototype.slice.call(e)}return t.content&&t.type?t.content:null}function m4e(t){return t&&t.name.slice(-4)===".bin"?Yte(t):jte(t)}function _o(t,e){for(var r=t.FullPaths||Gn(t.files),n=e.toLowerCase().replace(/[\/]/g,"\\"),i=n.replace(/\\/g,"/"),s=0;s<r.length;++s){var a=r[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==a||i==a)return t.files?t.files[r[s]]:t.FileIndex[s]}return null}function $3(t,e){var r=_o(t,e);if(r==null)throw new Error("Cannot find file "+e+" in zip");return r}function yi(t,e,r){if(!r)return m4e($3(t,e));if(!e)return null;try{return yi(t,e)}catch{return null}}function qa(t,e,r){if(!r)return jte($3(t,e));if(!e)return null;try{return qa(t,e)}catch{return null}}function p4e(t,e,r){return Yte($3(t,e))}function aG(t){for(var e=t.FullPaths||Gn(t.files),r=[],n=0;n<e.length;++n)e[n].slice(-1)!="/"&&r.push(e[n].replace(/^Root Entry[\/]/,""));return r.sort()}function Lt(t,e,r){if(t.FullPaths){if(typeof r=="string"){var n;return Gt?n=dh(r):n=PLe(r),vt.utils.cfb_add(t,e,n)}vt.utils.cfb_add(t,e,r)}else t.file(e,r)}function U3(){return vt.utils.cfb_new()}function zte(t,e){switch(e.type){case"base64":return vt.read(t,{type:"base64"});case"binary":return vt.read(t,{type:"binary"});case"buffer":case"array":return vt.read(t,{type:"buffer"})}throw new Error("Unrecognized type "+e.type)}function Ay(t,e){if(t.charAt(0)=="/")return t.slice(1);var r=e.split("/");e.slice(-1)!="/"&&r.pop();for(var n=t.split("/");n.length!==0;){var i=n.shift();i===".."?r.pop():i!=="."&&r.push(i)}return r.join("/")}var hi=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,v4e=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,oG=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,w4e=/<[^>]*>/g,ks=hi.match(oG)?oG:w4e,y4e=/<\w*:/,S4e=/<(\/?)\w+:/;function Ot(t,e,r){for(var n={},i=0,s=0;i!==t.length&&!((s=t.charCodeAt(i))===32||s===10||s===13);++i);if(e||(n[0]=t.slice(0,i)),i===t.length)return n;var a=t.match(v4e),o=0,u="",c=0,f="",g="",m=1;if(a)for(c=0;c!=a.length;++c){for(g=a[c],s=0;s!=g.length&&g.charCodeAt(s)!==61;++s);for(f=g.slice(0,s).trim();g.charCodeAt(s+1)==32;)++s;for(m=(i=g.charCodeAt(s+1))==34||i==39?1:0,u=g.slice(s+1+m,g.length-m),o=0;o!=f.length&&f.charCodeAt(o)!==58;++o);if(o===f.length)f.indexOf("_")>0&&(f=f.slice(0,f.indexOf("_"))),n[f]=u,n[f.toLowerCase()]=u;else{var v=(o===5&&f.slice(0,5)==="xmlns"?"xmlns":"")+f.slice(o+1);if(n[v]&&f.slice(o-3,o)=="ext")continue;n[v]=u,n[v.toLowerCase()]=u}}return n}function Xu(t){return t.replace(S4e,"<$1")}var Gte={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},j3=TT(Gte),Cr=function(){var t=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,e=/_x([\da-fA-F]{4})_/ig;return function r(n){var i=n+"",s=i.indexOf("<![CDATA[");if(s==-1)return i.replace(t,function(o,u){return Gte[o]||String.fromCharCode(parseInt(u,o.indexOf("x")>-1?16:10))||o}).replace(e,function(o,u){return String.fromCharCode(parseInt(u,16))});var a=i.indexOf("]]>");return r(i.slice(0,s))+i.slice(s+9,a)+r(i.slice(a+3))}}(),Y3=/[&<>'"]/g,b4e=/[\u0000-\u0008\u000b-\u001f]/g;function Gr(t){var e=t+"";return e.replace(Y3,function(r){return j3[r]}).replace(b4e,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function lG(t){return Gr(t).replace(/ /g,"_x0020_")}var qte=/[\u0000-\u001f]/g;function z3(t){var e=t+"";return e.replace(Y3,function(r){return j3[r]}).replace(/\n/g,"<br/>").replace(qte,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function C4e(t){var e=t+"";return e.replace(Y3,function(r){return j3[r]}).replace(qte,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var uG=function(){var t=/&#(\d+);/g;function e(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(t,e)}}();function x4e(t){return t.replace(/(\r\n|[\r\n])/g,"&#10;")}function dn(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function mI(t){for(var e="",r=0,n=0,i=0,s=0,a=0,o=0;r<t.length;){if(n=t.charCodeAt(r++),n<128){e+=String.fromCharCode(n);continue}if(i=t.charCodeAt(r++),n>191&&n<224){a=(n&31)<<6,a|=i&63,e+=String.fromCharCode(a);continue}if(s=t.charCodeAt(r++),n<240){e+=String.fromCharCode((n&15)<<12|(i&63)<<6|s&63);continue}a=t.charCodeAt(r++),o=((n&7)<<18|(i&63)<<12|(s&63)<<6|a&63)-65536,e+=String.fromCharCode(55296+(o>>>10&1023)),e+=String.fromCharCode(56320+(o&1023))}return e}function cG(t){var e=Uf(2*t.length),r,n,i=1,s=0,a=0,o;for(n=0;n<t.length;n+=i)i=1,(o=t.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(t.charCodeAt(n+1)&63),i=2):o<240?(r=(o&15)*4096+(t.charCodeAt(n+1)&63)*64+(t.charCodeAt(n+2)&63),i=3):(i=4,r=(o&7)*262144+(t.charCodeAt(n+1)&63)*4096+(t.charCodeAt(n+2)&63)*64+(t.charCodeAt(n+3)&63),r-=65536,a=55296+(r>>>10&1023),r=56320+(r&1023)),a!==0&&(e[s++]=a&255,e[s++]=a>>>8,a=0),e[s++]=r%256,e[s++]=r>>>8;return e.slice(0,s).toString("ucs2")}function hG(t){return dh(t,"binary").toString("utf8")}var Ux="foo bar bazâð£",Zr=Gt&&(hG(Ux)==mI(Ux)&&hG||cG(Ux)==mI(Ux)&&cG)||mI,ku=Gt?function(t){return dh(t,"utf8").toString("binary")}:function(t){for(var e=[],r=0,n=0,i=0;r<t.length;)switch(n=t.charCodeAt(r++),!0){case n<128:e.push(String.fromCharCode(n));break;case n<2048:e.push(String.fromCharCode(192+(n>>6))),e.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,i=t.charCodeAt(r++)-56320+(n<<10),e.push(String.fromCharCode(240+(i>>18&7))),e.push(String.fromCharCode(144+(i>>12&63))),e.push(String.fromCharCode(128+(i>>6&63))),e.push(String.fromCharCode(128+(i&63)));break;default:e.push(String.fromCharCode(224+(n>>12))),e.push(String.fromCharCode(128+(n>>6&63))),e.push(String.fromCharCode(128+(n&63)))}return e.join("")},j1=function(){var t={};return function(r,n){var i=r+"|"+(n||"");return t[i]?t[i]:t[i]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),Kte=function(){var t=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<t.length;++i)n=n.replace(t[i][0],t[i][1]);return n}}(),E4e=function(){var t={};return function(r){return t[r]!==void 0?t[r]:t[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),_4e=/<\/?(?:vt:)?variant>/g,R4e=/<(?:vt:)([^>]*)>([\s\S]*)</;function fG(t,e){var r=Ot(t),n=t.match(E4e(r.baseType))||[],i=[];if(n.length!=r.size){if(e.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return i}return n.forEach(function(s){var a=s.replace(_4e,"").match(R4e);a&&i.push({v:Zr(a[2]),t:a[1]})}),i}var Xte=/(^\s|\s$|\n)/;function is(t,e){return"<"+t+(e.match(Xte)?' xml:space="preserve"':"")+">"+e+"</"+t+">"}function Y1(t){return Gn(t).map(function(e){return" "+e+'="'+t[e]+'"'}).join("")}function qe(t,e,r){return"<"+t+(r!=null?Y1(r):"")+(e!=null?(e.match(Xte)?' xml:space="preserve"':"")+">"+e+"</"+t:"/")+">"}function JN(t,e){try{return t.toISOString().replace(/\.\d*/,"")}catch(r){if(e)throw r}return""}function T4e(t,e){switch(typeof t){case"string":var r=qe("vt:lpwstr",Gr(t));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return qe((t|0)==t?"vt:i4":"vt:r8",Gr(String(t)));case"boolean":return qe("vt:bool",t?"true":"false")}if(t instanceof Date)return qe("vt:filetime",JN(t));throw new Error("Unable to serialize "+t)}function G3(t){if(Gt&&Buffer.isBuffer(t))return t.toString("utf8");if(typeof t=="string")return t;if(typeof Uint8Array<"u"&&t instanceof Uint8Array)return Zr(td(B3(t)));throw new Error("Bad input format: expected Buffer or string")}var z1=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,Pi={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},hm=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],za={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function M4e(t,e){for(var r=1-2*(t[e+7]>>>7),n=((t[e+7]&127)<<4)+(t[e+6]>>>4&15),i=t[e+6]&15,s=5;s>=0;--s)i=i*256+t[e+s];return n==2047?i==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,i+=Math.pow(2,52)),r*Math.pow(2,n-52)*i)}function A4e(t,e,r){var n=(e<0||1/e==-1/0?1:0)<<7,i=0,s=0,a=n?-e:e;isFinite(a)?a==0?i=s=0:(i=Math.floor(Math.log(a)/Math.LN2),s=a*Math.pow(2,52-i),i<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?i=-1022:(s-=Math.pow(2,52),i+=1023)):(i=2047,s=isNaN(e)?26985:0);for(var o=0;o<=5;++o,s/=256)t[r+o]=s&255;t[r+6]=(i&15)<<4|s&15,t[r+7]=i>>4|n}var dG=function(t){for(var e=[],r=10240,n=0;n<t[0].length;++n)if(t[0][n])for(var i=0,s=t[0][n].length;i<s;i+=r)e.push.apply(e,t[0][n].slice(i,i+r));return e},gG=Gt?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(e){return Buffer.isBuffer(e)?e:dh(e)})):dG(t)}:dG,mG=function(t,e,r){for(var n=[],i=e;i<r;i+=2)n.push(String.fromCharCode(Uc(t,i)));return n.join("").replace(Rs,"")},OT=Gt?function(t,e,r){return Buffer.isBuffer(t)?t.toString("utf16le",e,r).replace(Rs,""):mG(t,e,r)}:mG,pG=function(t,e,r){for(var n=[],i=e;i<e+r;++i)n.push(("0"+t[i].toString(16)).slice(-2));return n.join("")},Qte=Gt?function(t,e,r){return Buffer.isBuffer(t)?t.toString("hex",e,e+r):pG(t,e,r)}:pG,vG=function(t,e,r){for(var n=[],i=e;i<r;i++)n.push(String.fromCharCode(Z0(t,i)));return n.join("")},dv=Gt?function(e,r,n){return Buffer.isBuffer(e)?e.toString("utf8",r,n):vG(e,r,n)}:vG,Zte=function(t,e){var r=ji(t,e);return r>0?dv(t,e+4,e+4+r-1):""},q3=Zte,Jte=function(t,e){var r=ji(t,e);return r>0?dv(t,e+4,e+4+r-1):""},K3=Jte,ere=function(t,e){var r=2*ji(t,e);return r>0?dv(t,e+4,e+4+r-1):""},X3=ere,tre=function(e,r){var n=ji(e,r);return n>0?OT(e,r+4,r+4+n):""},Q3=tre,rre=function(t,e){var r=ji(t,e);return r>0?dv(t,e+4,e+4+r):""},Z3=rre,nre=function(t,e){return M4e(t,e)},q_=nre,J3=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};Gt&&(q3=function(e,r){if(!Buffer.isBuffer(e))return Zte(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},K3=function(e,r){if(!Buffer.isBuffer(e))return Jte(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},X3=function(e,r){if(!Buffer.isBuffer(e))return ere(e,r);var n=2*e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n-1)},Q3=function(e,r){if(!Buffer.isBuffer(e))return tre(e,r);var n=e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n)},Z3=function(e,r){if(!Buffer.isBuffer(e))return rre(e,r);var n=e.readUInt32LE(r);return e.toString("utf8",r+4,r+4+n)},q_=function(e,r){return Buffer.isBuffer(e)?e.readDoubleLE(r):nre(e,r)},J3=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});function ire(){OT=function(t,e,r){return gr.utils.decode(1200,t.slice(e,r)).replace(Rs,"")},dv=function(t,e,r){return gr.utils.decode(65001,t.slice(e,r))},q3=function(t,e){var r=ji(t,e);return r>0?gr.utils.decode(Wg,t.slice(e+4,e+4+r-1)):""},K3=function(t,e){var r=ji(t,e);return r>0?gr.utils.decode(Xa,t.slice(e+4,e+4+r-1)):""},X3=function(t,e){var r=2*ji(t,e);return r>0?gr.utils.decode(1200,t.slice(e+4,e+4+r-1)):""},Q3=function(t,e){var r=ji(t,e);return r>0?gr.utils.decode(1200,t.slice(e+4,e+4+r)):""},Z3=function(t,e){var r=ji(t,e);return r>0?gr.utils.decode(65001,t.slice(e+4,e+4+r)):""}}typeof gr<"u"&&ire();var Z0=function(t,e){return t[e]},Uc=function(t,e){return t[e+1]*256+t[e]},O4e=function(t,e){var r=t[e+1]*256+t[e];return r<32768?r:(65535-r+1)*-1},ji=function(t,e){return t[e+3]*(1<<24)+(t[e+2]<<16)+(t[e+1]<<8)+t[e]},gg=function(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]},k4e=function(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]};function n1(t,e){var r="",n,i,s=[],a,o,u,c;switch(e){case"dbcs":if(c=this.l,Gt&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*t).toString("utf16le");else for(u=0;u<t;++u)r+=String.fromCharCode(Uc(this,c)),c+=2;t*=2;break;case"utf8":r=dv(this,this.l,this.l+t);break;case"utf16le":t*=2,r=OT(this,this.l,this.l+t);break;case"wstr":if(typeof gr<"u")r=gr.utils.decode(Xa,this.slice(this.l,this.l+2*t));else return n1.call(this,t,"dbcs");t=2*t;break;case"lpstr-ansi":r=q3(this,this.l),t=4+ji(this,this.l);break;case"lpstr-cp":r=K3(this,this.l),t=4+ji(this,this.l);break;case"lpwstr":r=X3(this,this.l),t=4+2*ji(this,this.l);break;case"lpp4":t=4+ji(this,this.l),r=Q3(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+ji(this,this.l),r=Z3(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,r="";(a=Z0(this,this.l+t++))!==0;)s.push(Ty(a));r=s.join("");break;case"_wstr":for(t=0,r="";(a=Uc(this,this.l+t))!==0;)s.push(Ty(a)),t+=2;t+=2,r=s.join("");break;case"dbcs-cont":for(r="",c=this.l,u=0;u<t;++u){if(this.lens&&this.lens.indexOf(c)!==-1)return a=Z0(this,c),this.l=c+1,o=n1.call(this,t-u,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(Ty(Uc(this,c))),c+=2}r=s.join(""),t*=2;break;case"cpstr":if(typeof gr<"u"){r=gr.utils.decode(Xa,this.slice(this.l,this.l+t));break}case"sbcs-cont":for(r="",c=this.l,u=0;u!=t;++u){if(this.lens&&this.lens.indexOf(c)!==-1)return a=Z0(this,c),this.l=c+1,o=n1.call(this,t-u,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(Ty(Z0(this,c))),c+=1}r=s.join("");break;default:switch(t){case 1:return n=Z0(this,this.l),this.l++,n;case 2:return n=(e==="i"?O4e:Uc)(this,this.l),this.l+=2,n;case 4:case-4:return e==="i"||(this[this.l+3]&128)===0?(n=(t>0?gg:k4e)(this,this.l),this.l+=4,n):(i=ji(this,this.l),this.l+=4,i);case 8:case-8:if(e==="f")return t==8?i=q_(this,this.l):i=q_([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;t=8;case 16:r=Qte(this,this.l,t);break}}return this.l+=t,r}var D4e=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24&255},P4e=function(t,e,r){t[r]=e&255,t[r+1]=e>>8&255,t[r+2]=e>>16&255,t[r+3]=e>>24&255},I4e=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255};function N4e(t,e,r){var n=0,i=0;if(r==="dbcs"){for(i=0;i!=e.length;++i)I4e(this,e.charCodeAt(i),this.l+2*i);n=2*e.length}else if(r==="sbcs"){if(typeof gr<"u"&&Wg==874)for(i=0;i!=e.length;++i){var s=gr.utils.encode(Wg,e.charAt(i));this[this.l+i]=s[0]}else for(e=e.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=e.length;++i)this[this.l+i]=e.charCodeAt(i)&255;n=e.length}else if(r==="hex"){for(;i<t;++i)this[this.l++]=parseInt(e.slice(2*i,2*i+2),16)||0;return this}else if(r==="utf16le"){var a=Math.min(this.l+t,this.length);for(i=0;i<Math.min(e.length,t);++i){var o=e.charCodeAt(i);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<a;)this[this.l++]=0;return this}else switch(t){case 1:n=1,this[this.l]=e&255;break;case 2:n=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:n=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:n=4,D4e(this,e,this.l);break;case 8:if(n=8,r==="f"){A4e(this,e,this.l);break}case 16:break;case-4:n=4,P4e(this,e,this.l);break}return this.l+=n,this}function sre(t,e){var r=Qte(this,this.l,t.length>>1);if(r!==t)throw new Error(e+"Expected "+t+" saw "+r);this.l+=t.length>>1}function rs(t,e){t.l=e,t.read_shift=n1,t.chk=sre,t.write_shift=N4e}function Os(t,e){t.l+=e}function Fe(t){var e=Uf(t);return rs(e,0),e}function gh(t,e,r){if(t){var n,i,s;rs(t,t.l||0);for(var a=t.length,o=0,u=0;t.l<a;){o=t.read_shift(1),o&128&&(o=(o&127)+((t.read_shift(1)&127)<<7));var c=Z1[o]||Z1[65535];for(n=t.read_shift(1),s=n&127,i=1;i<4&&n&128;++i)s+=((n=t.read_shift(1))&127)<<7*i;u=t.l+s;var f=c.f&&c.f(t,s,r);if(t.l=u,e(f,c,o))return}}}function ya(){var t=[],e=Gt?256:2048,r=function(c){var f=Fe(c);return rs(f,0),f},n=r(e),i=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&t.push(n),n=null)},s=function(c){return n&&c<n.length-n.l?n:(i(),n=r(Math.max(c+1,e)))},a=function(){return i(),Yi(t)},o=function(c){i(),n=c,n.l==null&&(n.l=n.length),s(e)};return{next:s,push:o,end:a,_bufs:t}}function Ue(t,e,r,n){var i=+e,s;if(!isNaN(i)){n||(n=Z1[i].p||(r||[]).length||0),s=1+(i>=128?1:0)+1,n>=128&&++s,n>=16384&&++s,n>=2097152&&++s;var a=t.next(s);i<=127?a.write_shift(1,i):(a.write_shift(1,(i&127)+128),a.write_shift(1,i>>7));for(var o=0;o!=4;++o)if(n>=128)a.write_shift(1,(n&127)+128),n>>=7;else{a.write_shift(1,n);break}n>0&&J3(r)&&t.push(r)}}function i1(t,e,r){var n=rn(t);if(e.s?(n.cRel&&(n.c+=e.s.c),n.rRel&&(n.r+=e.s.r)):(n.cRel&&(n.c+=e.c),n.rRel&&(n.r+=e.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function wG(t,e,r){var n=rn(t);return n.s=i1(n.s,e.s,r),n.e=i1(n.e,e.s,r),n}function s1(t,e){if(t.cRel&&t.c<0)for(t=rn(t);t.c<0;)t.c+=e>8?16384:256;if(t.rRel&&t.r<0)for(t=rn(t);t.r<0;)t.r+=e>8?1048576:e>5?65536:16384;var r=Tt(t);return!t.cRel&&t.cRel!=null&&(r=L4e(r)),!t.rRel&&t.rRel!=null&&(r=H4e(r)),r}function pI(t,e){return t.s.r==0&&!t.s.rRel&&t.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+mn(t.s.c)+":"+(t.e.cRel?"":"$")+mn(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(e.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+jn(t.s.r)+":"+(t.e.rRel?"":"$")+jn(t.e.r):s1(t.s,e.biff)+":"+s1(t.e,e.biff)}function eB(t){return parseInt(F4e(t),10)-1}function jn(t){return""+(t+1)}function H4e(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function F4e(t){return t.replace(/\$(\d+)$/,"$1")}function tB(t){for(var e=B4e(t),r=0,n=0;n!==e.length;++n)r=26*r+e.charCodeAt(n)-64;return r-1}function mn(t){if(t<0)throw new Error("invalid column "+t);var e="";for(++t;t;t=Math.floor((t-1)/26))e=String.fromCharCode((t-1)%26+65)+e;return e}function L4e(t){return t.replace(/^([A-Z])/,"$$$1")}function B4e(t){return t.replace(/^\$([A-Z])/,"$1")}function V4e(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Dn(t){for(var e=0,r=0,n=0;n<t.length;++n){var i=t.charCodeAt(n);i>=48&&i<=57?e=10*e+(i-48):i>=65&&i<=90&&(r=26*r+(i-64))}return{c:r-1,r:e-1}}function Tt(t){for(var e=t.c+1,r="";e;e=(e-1)/26|0)r=String.fromCharCode((e-1)%26+65)+r;return r+(t.r+1)}function Ks(t){var e=t.indexOf(":");return e==-1?{s:Dn(t),e:Dn(t)}:{s:Dn(t.slice(0,e)),e:Dn(t.slice(e+1))}}function Ht(t,e){return typeof e>"u"||typeof e=="number"?Ht(t.s,t.e):(typeof t!="string"&&(t=Tt(t)),typeof e!="string"&&(e=Tt(e)),t==e?t:t+":"+e)}function ar(t){var e={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,i=0,s=t.length;for(r=0;n<s&&!((i=t.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(e.s.c=--r,r=0;n<s&&!((i=t.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;if(e.s.r=--r,n===s||i!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++n,r=0;n!=s&&!((i=t.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(e.e.c=--r,r=0;n!=s&&!((i=t.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;return e.e.r=--r,e}function yG(t,e){var r=t.t=="d"&&e instanceof Date;if(t.z!=null)try{return t.w=Ja(t.z,r?Hi(e):e)}catch{}try{return t.w=Ja((t.XF||{}).numFmtId||(r?14:0),r?Hi(e):e)}catch{return""+e}}function Vu(t,e,r){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&r&&r.dateNF&&(t.z=r.dateNF),t.t=="e"?mh[t.v]||t.v:e==null?yG(t,t.v):yG(t,e))}function rd(t,e){var r=e&&e.sheet?e.sheet:"Sheet1",n={};return n[r]=t,{SheetNames:[r],Sheets:n}}function are(t,e,r){var n=r||{},i=t?Array.isArray(t):n.dense,s=t||(i?[]:{}),a=0,o=0;if(s&&n.origin!=null){if(typeof n.origin=="number")a=n.origin;else{var u=typeof n.origin=="string"?Dn(n.origin):n.origin;a=u.r,o=u.c}s["!ref"]||(s["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var f=ar(s["!ref"]);c.s.c=f.s.c,c.s.r=f.s.r,c.e.c=Math.max(c.e.c,f.e.c),c.e.r=Math.max(c.e.r,f.e.r),a==-1&&(c.e.r=a=f.e.r+1)}for(var g=0;g!=e.length;++g)if(e[g]){if(!Array.isArray(e[g]))throw new Error("aoa_to_sheet expects an array of arrays");for(var m=0;m!=e[g].length;++m)if(!(typeof e[g][m]>"u")){var v={v:e[g][m]},w=a+g,y=o+m;if(c.s.r>w&&(c.s.r=w),c.s.c>y&&(c.s.c=y),c.e.r<w&&(c.e.r=w),c.e.c<y&&(c.e.c=y),e[g][m]&&typeof e[g][m]=="object"&&!Array.isArray(e[g][m])&&!(e[g][m]instanceof Date))v=e[g][m];else if(Array.isArray(v.v)&&(v.f=e[g][m][1],v.v=v.v[0]),v.v===null)if(v.f)v.t="n";else if(n.nullError)v.t="e",v.v=0;else if(n.sheetStubs)v.t="z";else continue;else typeof v.v=="number"?v.t="n":typeof v.v=="boolean"?v.t="b":v.v instanceof Date?(v.z=n.dateNF||xt[14],n.cellDates?(v.t="d",v.w=Ja(v.z,Hi(v.v))):(v.t="n",v.v=Hi(v.v),v.w=Ja(v.z,v.v))):v.t="s";if(i)s[w]||(s[w]=[]),s[w][y]&&s[w][y].z&&(v.z=s[w][y].z),s[w][y]=v;else{var b=Tt({c:y,r:w});s[b]&&s[b].z&&(v.z=s[b].z),s[b]=v}}}return c.s.c<1e7&&(s["!ref"]=Ht(c)),s}function gv(t,e){return are(null,t,e)}function W4e(t){return t.read_shift(4,"i")}function Ol(t,e){return e||(e=Fe(4)),e.write_shift(4,t),e}function Ts(t){var e=t.read_shift(4);return e===0?"":t.read_shift(e,"dbcs")}function zi(t,e){var r=!1;return e==null&&(r=!0,e=Fe(4+2*t.length)),e.write_shift(4,t.length),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}function $4e(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function U4e(t,e){return e||(e=Fe(4)),e.write_shift(2,0),e.write_shift(2,0),e}function rB(t,e){var r=t.l,n=t.read_shift(1),i=Ts(t),s=[],a={t:i,h:i};if((n&1)!==0){for(var o=t.read_shift(4),u=0;u!=o;++u)s.push($4e(t));a.r=s}else a.r=[{ich:0,ifnt:0}];return t.l=r+e,a}function j4e(t,e){var r=!1;return e==null&&(r=!0,e=Fe(15+4*t.t.length)),e.write_shift(1,0),zi(t.t,e),r?e.slice(0,e.l):e}var Y4e=rB;function z4e(t,e){var r=!1;return e==null&&(r=!0,e=Fe(23+4*t.t.length)),e.write_shift(1,1),zi(t.t,e),e.write_shift(4,1),U4e({},e),r?e.slice(0,e.l):e}function el(t){var e=t.read_shift(4),r=t.read_shift(2);return r+=t.read_shift(1)<<16,t.l++,{c:e,iStyleRef:r}}function fm(t,e){return e==null&&(e=Fe(8)),e.write_shift(-4,t.c),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}function dm(t){var e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:e}}function gm(t,e){return e==null&&(e=Fe(4)),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}var G4e=Ts,ore=zi;function nB(t){var e=t.read_shift(4);return e===0||e===4294967295?"":t.read_shift(e,"dbcs")}function K_(t,e){var r=!1;return e==null&&(r=!0,e=Fe(127)),e.write_shift(4,t.length>0?t.length:4294967295),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}var q4e=Ts,eH=nB,iB=K_;function sB(t){var e=t.slice(t.l,t.l+4),r=e[0]&1,n=e[0]&2;t.l+=4;var i=n===0?q_([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):gg(e,0)>>2;return r?i/100:i}function lre(t,e){e==null&&(e=Fe(4));var r=0,n=0,i=t*100;if(t==(t|0)&&t>=-536870912&&t<1<<29?n=1:i==(i|0)&&i>=-536870912&&i<1<<29&&(n=1,r=1),n)e.write_shift(-4,((r?i:t)<<2)+(r+2));else throw new Error("unsupported RkNumber "+t)}function ure(t){var e={s:{},e:{}};return e.s.r=t.read_shift(4),e.e.r=t.read_shift(4),e.s.c=t.read_shift(4),e.e.c=t.read_shift(4),e}function K4e(t,e){return e||(e=Fe(16)),e.write_shift(4,t.s.r),e.write_shift(4,t.e.r),e.write_shift(4,t.s.c),e.write_shift(4,t.e.c),e}var mm=ure,mv=K4e;function xs(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function jg(t,e){return(e||Fe(8)).write_shift(8,t,"f")}function X4e(t){var e={},r=t.read_shift(1),n=r>>>1,i=t.read_shift(1),s=t.read_shift(2,"i"),a=t.read_shift(1),o=t.read_shift(1),u=t.read_shift(1);switch(t.l++,n){case 0:e.auto=1;break;case 1:e.index=i;var c=Rg[i];c&&(e.rgb=q1(c));break;case 2:e.rgb=q1([a,o,u]);break;case 3:e.theme=i;break}return s!=0&&(e.tint=s>0?s/32767:s/32768),e}function X_(t,e){if(e||(e=Fe(8)),!t||t.auto)return e.write_shift(4,0),e.write_shift(4,0),e;t.index!=null?(e.write_shift(1,2),e.write_shift(1,t.index)):t.theme!=null?(e.write_shift(1,6),e.write_shift(1,t.theme)):(e.write_shift(1,5),e.write_shift(1,0));var r=t.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),e.write_shift(2,r),!t.rgb||t.theme!=null)e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);else{var n=t.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),e.write_shift(1,parseInt(n.slice(0,2),16)),e.write_shift(1,parseInt(n.slice(2,4),16)),e.write_shift(1,parseInt(n.slice(4,6),16)),e.write_shift(1,255)}return e}function Q4e(t){var e=t.read_shift(1);t.l++;var r={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return r}function Z4e(t,e){e||(e=Fe(2));var r=(t.italic?2:0)|(t.strike?8:0)|(t.outline?16:0)|(t.shadow?32:0)|(t.condense?64:0)|(t.extend?128:0);return e.write_shift(1,r),e.write_shift(1,0),e}function cre(t,e){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=t.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[t.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return t.l-=4,t.read_shift(0,e==1?"lpstr":"lpwstr")}function J4e(t){return cre(t,1)}function e3e(t){return cre(t,2)}var aB=2,pa=3,jx=11,SG=12,Q_=19,Yx=64,t3e=65,r3e=71,n3e=4108,i3e=4126,$i=80,hre=81,s3e=[$i,hre],tH={1:{n:"CodePage",t:aB},2:{n:"Category",t:$i},3:{n:"PresentationFormat",t:$i},4:{n:"ByteCount",t:pa},5:{n:"LineCount",t:pa},6:{n:"ParagraphCount",t:pa},7:{n:"SlideCount",t:pa},8:{n:"NoteCount",t:pa},9:{n:"HiddenCount",t:pa},10:{n:"MultimediaClipCount",t:pa},11:{n:"ScaleCrop",t:jx},12:{n:"HeadingPairs",t:n3e},13:{n:"TitlesOfParts",t:i3e},14:{n:"Manager",t:$i},15:{n:"Company",t:$i},16:{n:"LinksUpToDate",t:jx},17:{n:"CharacterCount",t:pa},19:{n:"SharedDoc",t:jx},22:{n:"HyperlinksChanged",t:jx},23:{n:"AppVersion",t:pa,p:"version"},24:{n:"DigSig",t:t3e},26:{n:"ContentType",t:$i},27:{n:"ContentStatus",t:$i},28:{n:"Language",t:$i},29:{n:"Version",t:$i},255:{},2147483648:{n:"Locale",t:Q_},2147483651:{n:"Behavior",t:Q_},1919054434:{}},rH={1:{n:"CodePage",t:aB},2:{n:"Title",t:$i},3:{n:"Subject",t:$i},4:{n:"Author",t:$i},5:{n:"Keywords",t:$i},6:{n:"Comments",t:$i},7:{n:"Template",t:$i},8:{n:"LastAuthor",t:$i},9:{n:"RevNumber",t:$i},10:{n:"EditTime",t:Yx},11:{n:"LastPrinted",t:Yx},12:{n:"CreatedDate",t:Yx},13:{n:"ModifiedDate",t:Yx},14:{n:"PageCount",t:pa},15:{n:"WordCount",t:pa},16:{n:"CharCount",t:pa},17:{n:"Thumbnail",t:r3e},18:{n:"Application",t:$i},19:{n:"DocSecurity",t:pa},255:{},2147483648:{n:"Locale",t:Q_},2147483651:{n:"Behavior",t:Q_},1919054434:{}},bG={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},a3e=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function o3e(t){return t.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var l3e=o3e([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Rg=rn(l3e),mh={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},fre={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},nH={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},zx={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function oB(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function u3e(t){var e=oB();if(!t||!t.match)return e;var r={};if((t.match(ks)||[]).forEach(function(n){var i=Ot(n);switch(i[0].replace(y4e,"<")){case"<?xml":break;case"<Types":e.xmlns=i["xmlns"+(i[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[i.Extension]=i.ContentType;break;case"<Override":e[nH[i.ContentType]]!==void 0&&e[nH[i.ContentType]].push(i.PartName);break}}),e.xmlns!==Pi.CT)throw new Error("Unknown Namespace: "+e.xmlns);return e.calcchain=e.calcchains.length>0?e.calcchains[0]:"",e.sst=e.strs.length>0?e.strs[0]:"",e.style=e.styles.length>0?e.styles[0]:"",e.defaults=r,delete e.calcchains,e}function dre(t,e){var r=u4e(nH),n=[],i;n[n.length]=hi,n[n.length]=qe("Types",null,{xmlns:Pi.CT,"xmlns:xsd":Pi.xsd,"xmlns:xsi":Pi.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(u){return qe("Default",null,{Extension:u[0],ContentType:u[1]})}));var s=function(u){t[u]&&t[u].length>0&&(i=t[u][0],n[n.length]=qe("Override",null,{PartName:(i[0]=="/"?"":"/")+i,ContentType:zx[u][e.bookType]||zx[u].xlsx}))},a=function(u){(t[u]||[]).forEach(function(c){n[n.length]=qe("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:zx[u][e.bookType]||zx[u].xlsx})})},o=function(u){(t[u]||[]).forEach(function(c){n[n.length]=qe("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:r[u][0]})})};return s("workbooks"),a("sheets"),a("charts"),o("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),a("metadata"),o("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var Zt={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function G1(t){var e=t.lastIndexOf("/");return t.slice(0,e+1)+"_rels/"+t.slice(e+1)+".rels"}function a1(t,e){var r={"!id":{}};if(!t)return r;e.charAt(0)!=="/"&&(e="/"+e);var n={};return(t.match(ks)||[]).forEach(function(i){var s=Ot(i);if(s[0]==="<Relationship"){var a={};a.Type=s.Type,a.Target=s.Target,a.Id=s.Id,s.TargetMode&&(a.TargetMode=s.TargetMode);var o=s.TargetMode==="External"?s.Target:Ay(s.Target,e);r[o]=a,n[s.Id]=a}}),r["!id"]=n,r}function yp(t){var e=[hi,qe("Relationships",null,{xmlns:Pi.RELS})];return Gn(t["!id"]).forEach(function(r){e[e.length]=qe("Relationship",null,t["!id"][r])}),e.length>2&&(e[e.length]="</Relationships>",e[1]=e[1].replace("/>",">")),e.join("")}function zr(t,e,r,n,i,s){if(i||(i={}),t["!id"]||(t["!id"]={}),t["!idx"]||(t["!idx"]=1),e<0)for(e=t["!idx"];t["!id"]["rId"+e];++e);if(t["!idx"]=e+1,i.Id="rId"+e,i.Type=n,i.Target=r,[Zt.HLINK,Zt.XPATH,Zt.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),t["!id"][i.Id])throw new Error("Cannot rewrite rId "+e);return t["!id"][i.Id]=i,t[("/"+i.Target).replace("//","/")]=i,e}var c3e="application/vnd.oasis.opendocument.spreadsheet";function h3e(t,e){for(var r=G3(t),n,i;n=z1.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(i=Ot(n[0],!1),i.path=="/"&&i.type!==c3e)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(e&&e.WTF)throw n}}function f3e(t){var e=[hi];e.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),e.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<t.length;++r)e.push('  <manifest:file-entry manifest:full-path="'+t[r][0]+'" manifest:media-type="'+t[r][1]+`"/>
`);return e.push("</manifest:manifest>"),e.join("")}function CG(t,e,r){return['  <rdf:Description rdf:about="'+t+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+e+`"/>
`,`  </rdf:Description>
`].join("")}function d3e(t,e){return['  <rdf:Description rdf:about="'+t+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e+`"/>
`,`  </rdf:Description>
`].join("")}function g3e(t){var e=[hi];e.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=t.length;++r)e.push(CG(t[r][0],t[r][1])),e.push(d3e("",t[r][0]));return e.push(CG("","Document","pkg")),e.push("</rdf:RDF>"),e.join("")}function gre(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+W1.version+"</meta:generator></office:meta></office:document-meta>"}var Wo=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],m3e=function(){for(var t=new Array(Wo.length),e=0;e<Wo.length;++e){var r=Wo[e],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);t[e]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return t}();function mre(t){var e={};t=Zr(t);for(var r=0;r<Wo.length;++r){var n=Wo[r],i=t.match(m3e[r]);i!=null&&i.length>0&&(e[n[1]]=Cr(i[1])),n[2]==="date"&&e[n[1]]&&(e[n[1]]=pn(e[n[1]]))}return e}function vI(t,e,r,n,i){i[t]!=null||e==null||e===""||(i[t]=e,e=Gr(e),n[n.length]=r?qe(t,e,r):is(t,e))}function pre(t,e){var r=e||{},n=[hi,qe("cp:coreProperties",null,{"xmlns:cp":Pi.CORE_PROPS,"xmlns:dc":Pi.dc,"xmlns:dcterms":Pi.dcterms,"xmlns:dcmitype":Pi.dcmitype,"xmlns:xsi":Pi.xsi})],i={};if(!t&&!r.Props)return n.join("");t&&(t.CreatedDate!=null&&vI("dcterms:created",typeof t.CreatedDate=="string"?t.CreatedDate:JN(t.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i),t.ModifiedDate!=null&&vI("dcterms:modified",typeof t.ModifiedDate=="string"?t.ModifiedDate:JN(t.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i));for(var s=0;s!=Wo.length;++s){var a=Wo[s],o=r.Props&&r.Props[a[1]]!=null?r.Props[a[1]]:t?t[a[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&vI(a[0],o,null,n,i)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var Tg=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],vre=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function wre(t,e,r,n){var i=[];if(typeof t=="string")i=fG(t,n);else for(var s=0;s<t.length;++s)i=i.concat(t[s].map(function(f){return{v:f}}));var a=typeof e=="string"?fG(e,n).map(function(f){return f.v}):e,o=0,u=0;if(a.length>0)for(var c=0;c!==i.length;c+=2){switch(u=+i[c+1].v,i[c].v){case"Worksheets":case"工作表":case"Листы":case"أوراق العمل":case"ワークシート":case"גליונות עבודה":case"Arbeitsblätter":case"Çalışma Sayfaları":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de cálculo":case"Planilhas":case"Regneark":case"Hojas de cálculo":case"Werkbladen":r.Worksheets=u,r.SheetNames=a.slice(o,o+u);break;case"Named Ranges":case"Rangos con nombre":case"名前付き一覧":case"Benannte Bereiche":case"Navngivne områder":r.NamedRanges=u,r.DefinedNames=a.slice(o,o+u);break;case"Charts":case"Diagramme":r.Chartsheets=u,r.ChartNames=a.slice(o,o+u);break}o+=u}}function p3e(t,e,r){var n={};return e||(e={}),t=Zr(t),Tg.forEach(function(i){var s=(t.match(j1(i[0]))||[])[1];switch(i[2]){case"string":s&&(e[i[1]]=Cr(s));break;case"bool":e[i[1]]=s==="true";break;case"raw":var a=t.match(new RegExp("<"+i[0]+"[^>]*>([\\s\\S]*?)</"+i[0]+">"));a&&a.length>0&&(n[i[1]]=a[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&wre(n.HeadingPairs,n.TitlesOfParts,e,r),e}function yre(t){var e=[],r=qe;return t||(t={}),t.Application="SheetJS",e[e.length]=hi,e[e.length]=qe("Properties",null,{xmlns:Pi.EXT_PROPS,"xmlns:vt":Pi.vt}),Tg.forEach(function(n){if(t[n[1]]!==void 0){var i;switch(n[2]){case"string":i=Gr(String(t[n[1]]));break;case"bool":i=t[n[1]]?"true":"false";break}i!==void 0&&(e[e.length]=r(n[0],i))}}),e[e.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(t.Worksheets))),{size:2,baseType:"variant"})),e[e.length]=r("TitlesOfParts",r("vt:vector",t.SheetNames.map(function(n){return"<vt:lpstr>"+Gr(n)+"</vt:lpstr>"}).join(""),{size:t.Worksheets,baseType:"lpstr"})),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var v3e=/<[^>]+>[^<]*/g;function w3e(t,e){var r={},n="",i=t.match(v3e);if(i)for(var s=0;s!=i.length;++s){var a=i[s],o=Ot(a);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":n=Cr(o.name);break;case"</property>":n=null;break;default:if(a.indexOf("<vt:")===0){var u=a.split(">"),c=u[0].slice(4),f=u[1];switch(c){case"lpstr":case"bstr":case"lpwstr":r[n]=Cr(f);break;case"bool":r[n]=dn(f);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(f,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(f);break;case"filetime":case"date":r[n]=pn(f);break;case"cy":case"error":r[n]=Cr(f);break;default:if(c.slice(-1)=="/")break;e.WTF&&typeof console<"u"&&console.warn("Unexpected",a,c,u)}}else if(a.slice(0,2)!=="</"){if(e.WTF)throw new Error(a)}}}return r}function Sre(t){var e=[hi,qe("Properties",null,{xmlns:Pi.CUST_PROPS,"xmlns:vt":Pi.vt})];if(!t)return e.join("");var r=1;return Gn(t).forEach(function(i){++r,e[e.length]=qe("property",T4e(t[i]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:Gr(i)})}),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var iH={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},wI;function y3e(t,e,r){wI||(wI=TT(iH)),e=wI[e]||e,t[e]=r}function S3e(t,e){var r=[];return Gn(iH).map(function(n){for(var i=0;i<Wo.length;++i)if(Wo[i][1]==n)return Wo[i];for(i=0;i<Tg.length;++i)if(Tg[i][1]==n)return Tg[i];throw n}).forEach(function(n){if(t[n[1]]!=null){var i=e&&e.Props&&e.Props[n[1]]!=null?e.Props[n[1]]:t[n[1]];switch(n[2]){case"date":i=new Date(i).toISOString().replace(/\.\d*Z/,"Z");break}typeof i=="number"?i=String(i):i===!0||i===!1?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),r.push(is(iH[n[1]]||n[1],i))}}),qe("DocumentProperties",r.join(""),{xmlns:za.o})}function b3e(t,e){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",i=[];return t&&Gn(t).forEach(function(s){if(Object.prototype.hasOwnProperty.call(t,s)){for(var a=0;a<Wo.length;++a)if(s==Wo[a][1])return;for(a=0;a<Tg.length;++a)if(s==Tg[a][1])return;for(a=0;a<r.length;++a)if(s==r[a])return;var o=t[s],u="string";typeof o=="number"?(u="float",o=String(o)):o===!0||o===!1?(u="boolean",o=o?"1":"0"):o=String(o),i.push(qe(lG(s),o,{"dt:dt":u}))}}),e&&Gn(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)&&!(t&&Object.prototype.hasOwnProperty.call(t,s))){var a=e[s],o="string";typeof a=="number"?(o="float",a=String(a)):a===!0||a===!1?(o="boolean",a=a?"1":"0"):a instanceof Date?(o="dateTime.tz",a=a.toISOString()):a=String(a),i.push(qe(lG(s),a,{"dt:dt":o}))}}),"<"+n+' xmlns="'+za.o+'">'+i.join("")+"</"+n+">"}function lB(t){var e=t.read_shift(4),r=t.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+e/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function C3e(t){var e=typeof t=="string"?new Date(Date.parse(t)):t,r=e.getTime()/1e3+11644473600,n=r%Math.pow(2,32),i=(r-n)/Math.pow(2,32);n*=1e7,i*=1e7;var s=n/Math.pow(2,32)|0;s>0&&(n=n%Math.pow(2,32),i+=s);var a=Fe(8);return a.write_shift(4,n),a.write_shift(4,i),a}function bre(t,e,r){var n=t.l,i=t.read_shift(0,"lpstr-cp");if(r)for(;t.l-n&3;)++t.l;return i}function Cre(t,e,r){var n=t.read_shift(0,"lpwstr");return n}function xre(t,e,r){return e===31?Cre(t):bre(t,e,r)}function sH(t,e,r){return xre(t,e,r===!1?0:4)}function x3e(t,e){if(!e)throw new Error("VtUnalignedString must have positive length");return xre(t,e,0)}function E3e(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n){var i=t.l;r[n]=t.read_shift(0,"lpwstr").replace(Rs,""),t.l-i&2&&(t.l+=2)}return r}function _3e(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n)r[n]=t.read_shift(0,"lpstr-cp").replace(Rs,"");return r}function R3e(t){var e=t.l,r=Z_(t,hre);t[t.l]==0&&t[t.l+1]==0&&t.l-e&2&&(t.l+=2);var n=Z_(t,pa);return[r,n]}function T3e(t){for(var e=t.read_shift(4),r=[],n=0;n<e/2;++n)r.push(R3e(t));return r}function xG(t,e){for(var r=t.read_shift(4),n={},i=0;i!=r;++i){var s=t.read_shift(4),a=t.read_shift(4);n[s]=t.read_shift(a,e===1200?"utf16le":"utf8").replace(Rs,"").replace(My,"!"),e===1200&&a%2&&(t.l+=2)}return t.l&3&&(t.l=t.l>>3<<2),n}function Ere(t){var e=t.read_shift(4),r=t.slice(t.l,t.l+e);return t.l+=e,(e&3)>0&&(t.l+=4-(e&3)&3),r}function M3e(t){var e={};return e.Size=t.read_shift(4),t.l+=e.Size+3-(e.Size-1)%4,e}function Z_(t,e,r){var n=t.read_shift(2),i,s=r||{};if(t.l+=2,e!==SG&&n!==e&&s3e.indexOf(e)===-1&&!((e&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+e+" saw "+n);switch(e===SG?n:e){case 2:return i=t.read_shift(2,"i"),s.raw||(t.l+=2),i;case 3:return i=t.read_shift(4,"i"),i;case 11:return t.read_shift(4)!==0;case 19:return i=t.read_shift(4),i;case 30:return bre(t,n,4).replace(Rs,"");case 31:return Cre(t);case 64:return lB(t);case 65:return Ere(t);case 71:return M3e(t);case 80:return sH(t,n,!s.raw).replace(Rs,"");case 81:return x3e(t,n).replace(Rs,"");case 4108:return T3e(t);case 4126:case 4127:return n==4127?E3e(t):_3e(t);default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+n)}}function EG(t,e){var r=Fe(4),n=Fe(4);switch(r.write_shift(4,t==80?31:t),t){case 3:n.write_shift(-4,e);break;case 5:n=Fe(8),n.write_shift(8,e,"f");break;case 11:n.write_shift(4,e?1:0);break;case 64:n=C3e(e);break;case 31:case 80:for(n=Fe(4+2*(e.length+1)+(e.length%2?0:2)),n.write_shift(4,e.length+1),n.write_shift(0,e,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+e)}return Yi([r,n])}function _G(t,e){var r=t.l,n=t.read_shift(4),i=t.read_shift(4),s=[],a=0,o=0,u=-1,c={};for(a=0;a!=i;++a){var f=t.read_shift(4),g=t.read_shift(4);s[a]=[f,g+r]}s.sort(function(_,T){return _[1]-T[1]});var m={};for(a=0;a!=i;++a){if(t.l!==s[a][1]){var v=!0;if(a>0&&e)switch(e[s[a-1][0]].t){case 2:t.l+2===s[a][1]&&(t.l+=2,v=!1);break;case 80:t.l<=s[a][1]&&(t.l=s[a][1],v=!1);break;case 4108:t.l<=s[a][1]&&(t.l=s[a][1],v=!1);break}if((!e||a==0)&&t.l<=s[a][1]&&(v=!1,t.l=s[a][1]),v)throw new Error("Read Error: Expected address "+s[a][1]+" at "+t.l+" :"+a)}if(e){var w=e[s[a][0]];if(m[w.n]=Z_(t,w.t,{raw:!0}),w.p==="version"&&(m[w.n]=String(m[w.n]>>16)+"."+("0000"+String(m[w.n]&65535)).slice(-4)),w.n=="CodePage")switch(m[w.n]){case 0:m[w.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Bo(o=m[w.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+m[w.n])}}else if(s[a][0]===1){if(o=m.CodePage=Z_(t,aB),Bo(o),u!==-1){var y=t.l;t.l=s[u][1],c=xG(t,o),t.l=y}}else if(s[a][0]===0){if(o===0){u=a,t.l=s[a+1][1];continue}c=xG(t,o)}else{var b=c[s[a][0]],x;switch(t[t.l]){case 65:t.l+=4,x=Ere(t);break;case 30:t.l+=4,x=sH(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 31:t.l+=4,x=sH(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 3:t.l+=4,x=t.read_shift(4,"i");break;case 19:t.l+=4,x=t.read_shift(4);break;case 5:t.l+=4,x=t.read_shift(8,"f");break;case 11:t.l+=4,x=ei(t,4);break;case 64:t.l+=4,x=pn(lB(t));break;default:throw new Error("unparsed value: "+t[t.l])}m[b]=x}}return t.l=r+n,m}var _re=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function A3e(t){switch(typeof t){case"boolean":return 11;case"number":return(t|0)==t?3:5;case"string":return 31;case"object":if(t instanceof Date)return 64;break}return-1}function RG(t,e,r){var n=Fe(8),i=[],s=[],a=8,o=0,u=Fe(8),c=Fe(8);if(u.write_shift(4,2),u.write_shift(4,1200),c.write_shift(4,1),s.push(u),i.push(c),a+=8+u.length,!e){c=Fe(8),c.write_shift(4,0),i.unshift(c);var f=[Fe(4)];for(f[0].write_shift(4,t.length),o=0;o<t.length;++o){var g=t[o][0];for(u=Fe(8+2*(g.length+1)+(g.length%2?0:2)),u.write_shift(4,o+2),u.write_shift(4,g.length+1),u.write_shift(0,g,"dbcs");u.l!=u.length;)u.write_shift(1,0);f.push(u)}u=Yi(f),s.unshift(u),a+=8+u.length}for(o=0;o<t.length;++o)if(!(e&&!e[t[o][0]])&&!(_re.indexOf(t[o][0])>-1||vre.indexOf(t[o][0])>-1)&&t[o][1]!=null){var m=t[o][1],v=0;if(e){v=+e[t[o][0]];var w=r[v];if(w.p=="version"&&typeof m=="string"){var y=m.split(".");m=(+y[0]<<16)+(+y[1]||0)}u=EG(w.t,m)}else{var b=A3e(m);b==-1&&(b=31,m=String(m)),u=EG(b,m)}s.push(u),c=Fe(8),c.write_shift(4,e?v:2+o),i.push(c),a+=8+u.length}var x=8*(s.length+1);for(o=0;o<s.length;++o)i[o].write_shift(4,x),x+=s[o].length;return n.write_shift(4,a),n.write_shift(4,s.length),Yi([n].concat(i).concat(s))}function TG(t,e,r){var n=t.content;if(!n)return{};rs(n,0);var i,s,a,o,u=0;n.chk("feff","Byte Order: "),n.read_shift(2);var c=n.read_shift(4),f=n.read_shift(16);if(f!==vt.utils.consts.HEADER_CLSID&&f!==r)throw new Error("Bad PropertySet CLSID "+f);if(i=n.read_shift(4),i!==1&&i!==2)throw new Error("Unrecognized #Sets: "+i);if(s=n.read_shift(16),o=n.read_shift(4),i===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);i===2&&(a=n.read_shift(16),u=n.read_shift(4));var g=_G(n,e),m={SystemIdentifier:c};for(var v in g)m[v]=g[v];if(m.FMTID=s,i===1)return m;if(u-n.l==2&&(n.l+=2),n.l!==u)throw new Error("Length mismatch 2: "+n.l+" !== "+u);var w;try{w=_G(n,null)}catch{}for(v in w)m[v]=w[v];return m.FMTID=[s,a],m}function MG(t,e,r,n,i,s){var a=Fe(i?68:48),o=[a];a.write_shift(2,65534),a.write_shift(2,0),a.write_shift(4,842412599),a.write_shift(16,vt.utils.consts.HEADER_CLSID,"hex"),a.write_shift(4,i?2:1),a.write_shift(16,e,"hex"),a.write_shift(4,i?68:48);var u=RG(t,r,n);if(o.push(u),i){var c=RG(i,null,null);a.write_shift(16,s,"hex"),a.write_shift(4,68+u.length),o.push(c)}return Yi(o)}function nf(t,e){return t.read_shift(e),null}function O3e(t,e){e||(e=Fe(t));for(var r=0;r<t;++r)e.write_shift(1,0);return e}function k3e(t,e,r){for(var n=[],i=t.l+e;t.l<i;)n.push(r(t,i-t.l));if(i!==t.l)throw new Error("Slurp error");return n}function ei(t,e){return t.read_shift(e)===1}function $s(t,e){return e||(e=Fe(2)),e.write_shift(2,+!!t),e}function Si(t){return t.read_shift(2,"u")}function ko(t,e){return e||(e=Fe(2)),e.write_shift(2,t),e}function Rre(t,e){return k3e(t,e,Si)}function D3e(t){var e=t.read_shift(1),r=t.read_shift(1);return r===1?e:e===1}function Tre(t,e,r){return r||(r=Fe(2)),r.write_shift(1,e=="e"?+t:+!!t),r.write_shift(1,e=="e"?1:0),r}function WS(t,e,r){var n=t.read_shift(r&&r.biff>=12?2:1),i="sbcs-cont",s=Xa;if(r&&r.biff>=8&&(Xa=1200),!r||r.biff==8){var a=t.read_shift(1);a&&(i="dbcs-cont")}else r.biff==12&&(i="wstr");r.biff>=2&&r.biff<=5&&(i="cpstr");var o=n?t.read_shift(n,i):"";return Xa=s,o}function P3e(t){var e=Xa;Xa=1200;var r=t.read_shift(2),n=t.read_shift(1),i=n&4,s=n&8,a=1+(n&1),o=0,u,c={};s&&(o=t.read_shift(2)),i&&(u=t.read_shift(4));var f=a==2?"dbcs-cont":"sbcs-cont",g=r===0?"":t.read_shift(r,f);return s&&(t.l+=4*o),i&&(t.l+=u),c.t=g,s||(c.raw="<t>"+c.t+"</t>",c.r=c.t),Xa=e,c}function I3e(t){var e=t.t||"",r=Fe(3);r.write_shift(2,e.length),r.write_shift(1,1);var n=Fe(2*e.length);n.write_shift(2*e.length,e,"utf16le");var i=[r,n];return Yi(i)}function Yg(t,e,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return t.read_shift(e,"cpstr");if(r.biff>=12)return t.read_shift(e,"dbcs-cont")}var i=t.read_shift(1);return i===0?n=t.read_shift(e,"sbcs-cont"):n=t.read_shift(e,"dbcs-cont"),n}function $S(t,e,r){var n=t.read_shift(r&&r.biff==2?1:2);return n===0?(t.l++,""):Yg(t,n,r)}function pm(t,e,r){if(r.biff>5)return $S(t,e,r);var n=t.read_shift(1);return n===0?(t.l++,""):t.read_shift(n,r.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function Mre(t,e,r){return r||(r=Fe(3+2*t.length)),r.write_shift(2,t.length),r.write_shift(1,1),r.write_shift(31,t,"utf16le"),r}function N3e(t){var e=t.read_shift(1);t.l++;var r=t.read_shift(2);return t.l+=2,[e,r]}function H3e(t){var e=t.read_shift(4),r=t.l,n=!1;e>24&&(t.l+=e-24,t.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),t.l=r);var i=t.read_shift((n?e-24:e)>>1,"utf16le").replace(Rs,"");return n&&(t.l+=24),i}function F3e(t){for(var e=t.read_shift(2),r="";e-- >0;)r+="../";var n=t.read_shift(0,"lpstr-ansi");if(t.l+=2,t.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var i=t.read_shift(4);if(i===0)return r+n.replace(/\\/g,"/");var s=t.read_shift(4);if(t.read_shift(2)!=3)throw new Error("Bad FileMoniker");var a=t.read_shift(s>>1,"utf16le").replace(Rs,"");return r+a}function L3e(t,e){var r=t.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return H3e(t);case"0303000000000000c000000000000046":return F3e(t);default:throw new Error("Unsupported Moniker "+r)}}function Gx(t){var e=t.read_shift(4),r=e>0?t.read_shift(e,"utf16le").replace(Rs,""):"";return r}function AG(t,e){e||(e=Fe(6+t.length*2)),e.write_shift(4,1+t.length);for(var r=0;r<t.length;++r)e.write_shift(2,t.charCodeAt(r));return e.write_shift(2,0),e}function B3e(t,e){var r=t.l+e,n=t.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var i=t.read_shift(2);t.l+=2;var s,a,o,u,c="",f,g;i&16&&(s=Gx(t,r-t.l)),i&128&&(a=Gx(t,r-t.l)),(i&257)===257&&(o=Gx(t,r-t.l)),(i&257)===1&&(u=L3e(t,r-t.l)),i&8&&(c=Gx(t,r-t.l)),i&32&&(f=t.read_shift(16)),i&64&&(g=lB(t)),t.l=r;var m=a||o||u||"";m&&c&&(m+="#"+c),m||(m="#"+c),i&2&&m.charAt(0)=="/"&&m.charAt(1)!="/"&&(m="file://"+m);var v={Target:m};return f&&(v.guid=f),g&&(v.time=g),s&&(v.Tooltip=s),v}function V3e(t){var e=Fe(512),r=0,n=t.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var i=n.indexOf("#"),s=i>-1?31:23;switch(n.charAt(0)){case"#":s=28;break;case".":s&=-3;break}e.write_shift(4,2),e.write_shift(4,s);var a=[8,6815827,6619237,4849780,83];for(r=0;r<a.length;++r)e.write_shift(4,a[r]);if(s==28)n=n.slice(1),AG(n,e);else if(s&2){for(a="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<a.length;++r)e.write_shift(1,parseInt(a[r],16));var o=i>-1?n.slice(0,i):n;for(e.write_shift(4,2*(o.length+1)),r=0;r<o.length;++r)e.write_shift(2,o.charCodeAt(r));e.write_shift(2,0),s&8&&AG(i>-1?n.slice(i+1):"",e)}else{for(a="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<a.length;++r)e.write_shift(1,parseInt(a[r],16));for(var u=0;n.slice(u*3,u*3+3)=="../"||n.slice(u*3,u*3+3)=="..\\";)++u;for(e.write_shift(2,u),e.write_shift(4,n.length-3*u+1),r=0;r<n.length-3*u;++r)e.write_shift(1,n.charCodeAt(r+3*u)&255);for(e.write_shift(1,0),e.write_shift(2,65535),e.write_shift(2,57005),r=0;r<6;++r)e.write_shift(4,0)}return e.slice(0,e.l)}function Are(t){var e=t.read_shift(1),r=t.read_shift(1),n=t.read_shift(1),i=t.read_shift(1);return[e,r,n,i]}function Ore(t,e){var r=Are(t);return r[3]=0,r}function Qu(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return{r:e,c:r,ixfe:n}}function zg(t,e,r,n){return n||(n=Fe(6)),n.write_shift(2,t),n.write_shift(2,e),n.write_shift(2,r||0),n}function W3e(t){var e=t.read_shift(2),r=t.read_shift(2);return t.l+=8,{type:e,flags:r}}function $3e(t,e,r){return e===0?"":pm(t,e,r)}function U3e(t,e,r){var n=r.biff>8?4:2,i=t.read_shift(n),s=t.read_shift(n,"i"),a=t.read_shift(n,"i");return[i,s,a]}function kre(t){var e=t.read_shift(2),r=sB(t);return[e,r]}function j3e(t,e,r){t.l+=4,e-=4;var n=t.l+e,i=WS(t,e,r),s=t.read_shift(2);if(n-=t.l,s!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+s);return t.l+=s,i}function kT(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),i=t.read_shift(2);return{s:{c:n,r:e},e:{c:i,r}}}function Dre(t,e){return e||(e=Fe(8)),e.write_shift(2,t.s.r),e.write_shift(2,t.e.r),e.write_shift(2,t.s.c),e.write_shift(2,t.e.c),e}function Pre(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(1),i=t.read_shift(1);return{s:{c:n,r:e},e:{c:i,r}}}var Y3e=Pre;function Ire(t){t.l+=4;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return t.l+=12,[r,e,n]}function z3e(t){var e={};return t.l+=4,t.l+=16,e.fSharedNote=t.read_shift(2),t.l+=4,e}function G3e(t){var e={};return t.l+=4,t.cf=t.read_shift(2),e}function fs(t){t.l+=2,t.l+=t.read_shift(2)}var q3e={0:fs,4:fs,5:fs,6:fs,7:G3e,8:fs,9:fs,10:fs,11:fs,12:fs,13:z3e,14:fs,15:fs,16:fs,17:fs,18:fs,19:fs,20:fs,21:Ire};function K3e(t,e){for(var r=t.l+e,n=[];t.l<r;){var i=t.read_shift(2);t.l-=2;try{n.push(q3e[i](t,r-t.l))}catch{return t.l=r,n}}return t.l!=r&&(t.l=r),n}function qx(t,e){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=t.read_shift(2),e-=2,e>=2&&(r.dt=t.read_shift(2),t.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(e>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return t.read_shift(e),r}function uB(t,e,r){var n=1536,i=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,i=8;break;case"biff4":n=4,i=6;break;case"biff3":n=3,i=6;break;case"biff2":n=2,i=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=Fe(i);return s.write_shift(2,n),s.write_shift(2,e),i>4&&s.write_shift(2,29282),i>6&&s.write_shift(2,1997),i>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function X3e(t,e){return e===0||t.read_shift(2),1200}function Q3e(t,e,r){if(r.enc)return t.l+=e,"";var n=t.l,i=pm(t,0,r);return t.read_shift(e+n-t.l),i}function Z3e(t,e){var r=!e||e.biff==8,n=Fe(r?112:54);for(n.write_shift(e.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function J3e(t,e,r){var n=r&&r.biff==8||e==2?t.read_shift(2):(t.l+=e,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function eBe(t,e,r){var n=t.read_shift(4),i=t.read_shift(1)&3,s=t.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule";break}var a=WS(t,0,r);return a.length===0&&(a="Sheet1"),{pos:n,hs:i,dt:s,name:a}}function tBe(t,e){var r=!e||e.biff>=8?2:1,n=Fe(8+r*t.name.length);n.write_shift(4,t.pos),n.write_shift(1,t.hs||0),n.write_shift(1,t.dt),n.write_shift(1,t.name.length),e.biff>=8&&n.write_shift(1,1),n.write_shift(r*t.name.length,t.name,e.biff<8?"sbcs":"utf16le");var i=n.slice(0,n.l);return i.l=n.l,i}function rBe(t,e){for(var r=t.l+e,n=t.read_shift(4),i=t.read_shift(4),s=[],a=0;a!=i&&t.l<r;++a)s.push(P3e(t));return s.Count=n,s.Unique=i,s}function nBe(t,e){var r=Fe(8);r.write_shift(4,t.Count),r.write_shift(4,t.Unique);for(var n=[],i=0;i<t.length;++i)n[i]=I3e(t[i]);var s=Yi([r].concat(n));return s.parts=[r.length].concat(n.map(function(a){return a.length})),s}function iBe(t,e){var r={};return r.dsst=t.read_shift(2),t.l+=e-2,r}function sBe(t){var e={};e.r=t.read_shift(2),e.c=t.read_shift(2),e.cnt=t.read_shift(2)-e.c;var r=t.read_shift(2);t.l+=4;var n=t.read_shift(1);return t.l+=3,n&7&&(e.level=n&7),n&32&&(e.hidden=!0),n&64&&(e.hpt=r/20),e}function aBe(t){var e=W3e(t);if(e.type!=2211)throw new Error("Invalid Future Record "+e.type);var r=t.read_shift(4);return r!==0}function oBe(t){return t.read_shift(2),t.read_shift(4)}function OG(t,e,r){var n=0;r&&r.biff==2||(n=t.read_shift(2));var i=t.read_shift(2);r&&r.biff==2&&(n=1-(i>>15),i&=32767);var s={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[s,i]}function lBe(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),i=t.read_shift(2),s=t.read_shift(2),a=t.read_shift(2),o=t.read_shift(2),u=t.read_shift(2),c=t.read_shift(2);return{Pos:[e,r],Dim:[n,i],Flags:s,CurTab:a,FirstTab:o,Selected:u,TabRatio:c}}function uBe(){var t=Fe(18);return t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,29280),t.write_shift(2,17600),t.write_shift(2,56),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,1),t.write_shift(2,500),t}function cBe(t,e,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=t.read_shift(2);return{RTL:n&64}}function hBe(t){var e=Fe(18),r=1718;return t&&t.RTL&&(r|=64),e.write_shift(2,r),e.write_shift(4,0),e.write_shift(4,64),e.write_shift(4,0),e.write_shift(4,0),e}function fBe(){}function dBe(t,e,r){var n={dyHeight:t.read_shift(2),fl:t.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:t.l+=2;break;default:t.l+=10;break}return n.name=WS(t,0,r),n}function gBe(t,e){var r=t.name||"Arial",n=e&&e.biff==5,i=n?15+r.length:16+2*r.length,s=Fe(i);return s.write_shift(2,t.sz*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,r.length),n||s.write_shift(1,1),s.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),s}function mBe(t){var e=Qu(t);return e.isst=t.read_shift(4),e}function pBe(t,e,r,n){var i=Fe(10);return zg(t,e,n,i),i.write_shift(4,r),i}function vBe(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=t.l+e,i=Qu(t);r.biff==2&&t.l++;var s=$S(t,n-t.l,r);return i.val=s,i}function wBe(t,e,r,n,i){var s=!i||i.biff==8,a=Fe(8+ +s+(1+s)*r.length);return zg(t,e,n,a),a.write_shift(2,r.length),s&&a.write_shift(1,1),a.write_shift((1+s)*r.length,r,s?"utf16le":"sbcs"),a}function yBe(t,e,r){var n=t.read_shift(2),i=pm(t,0,r);return[n,i]}function SBe(t,e,r,n){var i=r&&r.biff==5;n||(n=Fe(i?3+e.length:5+2*e.length)),n.write_shift(2,t),n.write_shift(i?1:2,e.length),i||n.write_shift(1,1),n.write_shift((i?1:2)*e.length,e,i?"sbcs":"utf16le");var s=n.length>n.l?n.slice(0,n.l):n;return s.l==null&&(s.l=s.length),s}var bBe=pm;function kG(t,e,r){var n=t.l+e,i=r.biff==8||!r.biff?4:2,s=t.read_shift(i),a=t.read_shift(i),o=t.read_shift(2),u=t.read_shift(2);return t.l=n,{s:{r:s,c:o},e:{r:a,c:u}}}function CBe(t,e){var r=e.biff==8||!e.biff?4:2,n=Fe(2*r+6);return n.write_shift(r,t.s.r),n.write_shift(r,t.e.r+1),n.write_shift(2,t.s.c),n.write_shift(2,t.e.c+1),n.write_shift(2,0),n}function xBe(t){var e=t.read_shift(2),r=t.read_shift(2),n=kre(t);return{r:e,c:r,ixfe:n[0],rknum:n[1]}}function EBe(t,e){for(var r=t.l+e-2,n=t.read_shift(2),i=t.read_shift(2),s=[];t.l<r;)s.push(kre(t));if(t.l!==r)throw new Error("MulRK read error");var a=t.read_shift(2);if(s.length!=a-i+1)throw new Error("MulRK length mismatch");return{r:n,c:i,C:a,rkrec:s}}function _Be(t,e){for(var r=t.l+e-2,n=t.read_shift(2),i=t.read_shift(2),s=[];t.l<r;)s.push(t.read_shift(2));if(t.l!==r)throw new Error("MulBlank read error");var a=t.read_shift(2);if(s.length!=a-i+1)throw new Error("MulBlank length mismatch");return{r:n,c:i,C:a,ixfe:s}}function RBe(t,e,r,n){var i={},s=t.read_shift(4),a=t.read_shift(4),o=t.read_shift(4),u=t.read_shift(2);return i.patternType=a3e[o>>26],n.cellStyles&&(i.alc=s&7,i.fWrap=s>>3&1,i.alcV=s>>4&7,i.fJustLast=s>>7&1,i.trot=s>>8&255,i.cIndent=s>>16&15,i.fShrinkToFit=s>>20&1,i.iReadOrder=s>>22&2,i.fAtrNum=s>>26&1,i.fAtrFnt=s>>27&1,i.fAtrAlc=s>>28&1,i.fAtrBdr=s>>29&1,i.fAtrPat=s>>30&1,i.fAtrProt=s>>31&1,i.dgLeft=a&15,i.dgRight=a>>4&15,i.dgTop=a>>8&15,i.dgBottom=a>>12&15,i.icvLeft=a>>16&127,i.icvRight=a>>23&127,i.grbitDiag=a>>30&3,i.icvTop=o&127,i.icvBottom=o>>7&127,i.icvDiag=o>>14&127,i.dgDiag=o>>21&15,i.icvFore=u&127,i.icvBack=u>>7&127,i.fsxButton=u>>14&1),i}function TBe(t,e,r){var n={};return n.ifnt=t.read_shift(2),n.numFmtId=t.read_shift(2),n.flags=t.read_shift(2),n.fStyle=n.flags>>2&1,e-=6,n.data=RBe(t,e,n.fStyle,r),n}function DG(t,e,r,n){var i=r&&r.biff==5;n||(n=Fe(i?16:20)),n.write_shift(2,0),t.style?(n.write_shift(2,t.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,t.numFmtId||0),n.write_shift(2,e<<4));var s=0;return t.numFmtId>0&&i&&(s|=1024),n.write_shift(4,s),n.write_shift(4,0),i||n.write_shift(4,0),n.write_shift(2,0),n}function MBe(t){t.l+=4;var e=[t.read_shift(2),t.read_shift(2)];if(e[0]!==0&&e[0]--,e[1]!==0&&e[1]--,e[0]>7||e[1]>7)throw new Error("Bad Gutters: "+e.join("|"));return e}function ABe(t){var e=Fe(8);return e.write_shift(4,0),e.write_shift(2,0),e.write_shift(2,0),e}function PG(t,e,r){var n=Qu(t);(r.biff==2||e==9)&&++t.l;var i=D3e(t);return n.val=i,n.t=i===!0||i===!1?"b":"e",n}function OBe(t,e,r,n,i,s){var a=Fe(8);return zg(t,e,n,a),Tre(r,s,a),a}function kBe(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=Qu(t),i=xs(t);return n.val=i,n}function DBe(t,e,r,n){var i=Fe(14);return zg(t,e,n,i),jg(r,i),i}var IG=$3e;function PBe(t,e,r){var n=t.l+e,i=t.read_shift(2),s=t.read_shift(2);if(r.sbcch=s,s==1025||s==14849)return[s,i];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var a=Yg(t,s),o=[];n>t.l;)o.push($S(t));return[s,i,a,o]}function NG(t,e,r){var n=t.read_shift(2),i,s={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(i=j3e(t,e-2,r)),s.body=i||t.read_shift(e-2),typeof i=="string"&&(s.Name=i),s}var IBe=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function HG(t,e,r){var n=t.l+e,i=t.read_shift(2),s=t.read_shift(1),a=t.read_shift(1),o=t.read_shift(r&&r.biff==2?1:2),u=0;(!r||r.biff>=5)&&(r.biff!=5&&(t.l+=2),u=t.read_shift(2),r.biff==5&&(t.l+=2),t.l+=4);var c=Yg(t,a,r);i&32&&(c=IBe[c.charCodeAt(0)]);var f=n-t.l;r&&r.biff==2&&--f;var g=n==t.l||o===0||!(f>0)?[]:KWe(t,f,r,o);return{chKey:s,Name:c,itab:u,rgce:g}}function Nre(t,e,r){if(r.biff<8)return NBe(t,e,r);for(var n=[],i=t.l+e,s=t.read_shift(r.biff>8?4:2);s--!==0;)n.push(U3e(t,r.biff>8?12:6,r));if(t.l!=i)throw new Error("Bad ExternSheet: "+t.l+" != "+i);return n}function NBe(t,e,r){t[t.l+1]==3&&t[t.l]++;var n=WS(t,e,r);return n.charCodeAt(0)==3?n.slice(1):n}function HBe(t,e,r){if(r.biff<8){t.l+=e;return}var n=t.read_shift(2),i=t.read_shift(2),s=Yg(t,n,r),a=Yg(t,i,r);return[s,a]}function FBe(t,e,r){var n=Pre(t);t.l++;var i=t.read_shift(1);return e-=8,[XWe(t,e,r),i,n]}function FG(t,e,r){var n=Y3e(t);switch(r.biff){case 2:t.l++,e-=7;break;case 3:case 4:t.l+=2,e-=8;break;default:t.l+=6,e-=12}return[n,GWe(t,e,r)]}function LBe(t){var e=t.read_shift(4)!==0,r=t.read_shift(4)!==0,n=t.read_shift(4);return[e,r,n]}function BBe(t,e,r){if(!(r.biff<8)){var n=t.read_shift(2),i=t.read_shift(2),s=t.read_shift(2),a=t.read_shift(2),o=pm(t,0,r);return r.biff<8&&t.read_shift(1),[{r:n,c:i},o,a,s]}}function VBe(t,e,r){return BBe(t,e,r)}function WBe(t,e){for(var r=[],n=t.read_shift(2);n--;)r.push(kT(t));return r}function $Be(t){var e=Fe(2+t.length*8);e.write_shift(2,t.length);for(var r=0;r<t.length;++r)Dre(t[r],e);return e}function UBe(t,e,r){if(r&&r.biff<8)return YBe(t,e,r);var n=Ire(t),i=K3e(t,e-22,n[1]);return{cmo:n,ft:i}}var jBe={8:function(t,e){var r=t.l+e;t.l+=10;var n=t.read_shift(2);t.l+=4,t.l+=2,t.l+=2,t.l+=2,t.l+=4;var i=t.read_shift(1);return t.l+=i,t.l=r,{fmt:n}}};function YBe(t,e,r){t.l+=4;var n=t.read_shift(2),i=t.read_shift(2),s=t.read_shift(2);t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=6,e-=36;var a=[];return a.push((jBe[n]||Os)(t,e,r)),{cmo:[i,n,s],ft:a}}function zBe(t,e,r){var n=t.l,i="";try{t.l+=4;var s=(r.lastobj||{cmo:[0,0]}).cmo[1],a;[0,5,7,11,12,14].indexOf(s)==-1?t.l+=6:a=N3e(t,6,r);var o=t.read_shift(2);t.read_shift(2),Si(t,2);var u=t.read_shift(2);t.l+=u;for(var c=1;c<t.lens.length-1;++c){if(t.l-n!=t.lens[c])throw new Error("TxO: bad continue record");var f=t[t.l],g=Yg(t,t.lens[c+1]-t.lens[c]-1);if(i+=g,i.length>=(f?o:2*o))break}if(i.length!==o&&i.length!==o*2)throw new Error("cchText: "+o+" != "+i.length);return t.l=n+e,{t:i}}catch{return t.l=n+e,{t:i}}}function GBe(t,e){var r=kT(t);t.l+=16;var n=B3e(t,e-24);return[r,n]}function qBe(t){var e=Fe(24),r=Dn(t[0]);e.write_shift(2,r.r),e.write_shift(2,r.r),e.write_shift(2,r.c),e.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)e.write_shift(1,parseInt(n[i],16));return Yi([e,V3e(t[1])])}function KBe(t,e){t.read_shift(2);var r=kT(t),n=t.read_shift((e-10)/2,"dbcs-cont");return n=n.replace(Rs,""),[r,n]}function XBe(t){var e=t[1].Tooltip,r=Fe(10+2*(e.length+1));r.write_shift(2,2048);var n=Dn(t[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var i=0;i<e.length;++i)r.write_shift(2,e.charCodeAt(i));return r.write_shift(2,0),r}function QBe(t){var e=[0,0],r;return r=t.read_shift(2),e[0]=bG[r]||r,r=t.read_shift(2),e[1]=bG[r]||r,e}function ZBe(t){return t||(t=Fe(4)),t.write_shift(2,1),t.write_shift(2,1),t}function JBe(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(Ore(t));return r}function eVe(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(Ore(t));return r}function tVe(t){t.l+=2;var e={cxfs:0,crc:0};return e.cxfs=t.read_shift(2),e.crc=t.read_shift(4),e}function Hre(t,e,r){if(!r.cellStyles)return Os(t,e);var n=r&&r.biff>=12?4:2,i=t.read_shift(n),s=t.read_shift(n),a=t.read_shift(n),o=t.read_shift(n),u=t.read_shift(2);n==2&&(t.l+=2);var c={s:i,e:s,w:a,ixfe:o,flags:u};return(r.biff>=5||!r.biff)&&(c.level=u>>8&7),c}function rVe(t,e){var r=Fe(12);r.write_shift(2,e),r.write_shift(2,e),r.write_shift(2,t.width*256),r.write_shift(2,0);var n=0;return t.hidden&&(n|=1),r.write_shift(1,n),n=t.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function nVe(t,e){var r={};return e<32||(t.l+=16,r.header=xs(t),r.footer=xs(t),t.l+=2),r}function iVe(t,e,r){var n={area:!1};if(r.biff!=5)return t.l+=e,n;var i=t.read_shift(1);return t.l+=3,i&16&&(n.area=!0),n}function sVe(t){for(var e=Fe(2*t),r=0;r<t;++r)e.write_shift(2,r+1);return e}var aVe=Qu,oVe=Rre,lVe=$S;function uVe(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),i={fmt:e,env:r,len:n,data:t.slice(t.l,t.l+n)};return t.l+=n,i}function cVe(t,e,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=Qu(t);++t.l;var i=pm(t,e-7,r);return n.t="str",n.val=i,n}function hVe(t){var e=Qu(t);++t.l;var r=xs(t);return e.t="n",e.val=r,e}function fVe(t,e,r){var n=Fe(15);return zS(n,t,e),n.write_shift(8,r,"f"),n}function dVe(t){var e=Qu(t);++t.l;var r=t.read_shift(2);return e.t="n",e.val=r,e}function gVe(t,e,r){var n=Fe(9);return zS(n,t,e),n.write_shift(2,r),n}function mVe(t){var e=t.read_shift(1);return e===0?(t.l++,""):t.read_shift(e,"sbcs-cont")}function pVe(t,e){t.l+=6,t.l+=2,t.l+=1,t.l+=3,t.l+=1,t.l+=e-13}function vVe(t,e,r){var n=t.l+e,i=Qu(t),s=t.read_shift(2),a=Yg(t,s,r);return t.l=n,i.t="str",i.val=a,i}var wVe=[2,3,48,49,131,139,140,245],aH=function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=TT({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,u){var c=[],f=Uf(1);switch(u.type){case"base64":f=Ga(Za(o));break;case"binary":f=Ga(o);break;case"buffer":case"array":f=o;break}rs(f,0);var g=f.read_shift(1),m=!!(g&136),v=!1,w=!1;switch(g){case 2:break;case 3:break;case 48:v=!0,m=!0;break;case 49:v=!0,m=!0;break;case 131:break;case 139:break;case 140:w=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+g.toString(16))}var y=0,b=521;g==2&&(y=f.read_shift(2)),f.l+=3,g!=2&&(y=f.read_shift(4)),y>1048576&&(y=1e6),g!=2&&(b=f.read_shift(2));var x=f.read_shift(2),_=u.codepage||1252;g!=2&&(f.l+=16,f.read_shift(1),f[f.l]!==0&&(_=t[f[f.l]]),f.l+=1,f.l+=2),w&&(f.l+=36);for(var T=[],D={},P=Math.min(f.length,g==2?521:b-10-(v?264:0)),O=w?32:11;f.l<P&&f[f.l]!=13;)switch(D={},D.name=gr.utils.decode(_,f.slice(f.l,f.l+O)).replace(/[\u0000\r\n].*$/g,""),f.l+=O,D.type=String.fromCharCode(f.read_shift(1)),g!=2&&!w&&(D.offset=f.read_shift(4)),D.len=f.read_shift(1),g==2&&(D.offset=f.read_shift(2)),D.dec=f.read_shift(1),D.name.length&&T.push(D),g!=2&&(f.l+=w?13:14),D.type){case"B":(!v||D.len!=8)&&u.WTF&&console.log("Skipping "+D.name+":"+D.type);break;case"G":case"P":u.WTF&&console.log("Skipping "+D.name+":"+D.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+D.type)}if(f[f.l]!==13&&(f.l=b-1),f.read_shift(1)!==13)throw new Error("DBF Terminator not found "+f.l+" "+f[f.l]);f.l=b;var A=0,W=0;for(c[0]=[],W=0;W!=T.length;++W)c[0][W]=T[W].name;for(;y-- >0;){if(f[f.l]===42){f.l+=x;continue}for(++f.l,c[++A]=[],W=0,W=0;W!=T.length;++W){var L=f.slice(f.l,f.l+T[W].len);f.l+=T[W].len,rs(L,0);var H=gr.utils.decode(_,L);switch(T[W].type){case"C":H.trim().length&&(c[A][W]=H.replace(/\s+$/,""));break;case"D":H.length===8?c[A][W]=new Date(+H.slice(0,4),+H.slice(4,6)-1,+H.slice(6,8)):c[A][W]=H;break;case"F":c[A][W]=parseFloat(H.trim());break;case"+":case"I":c[A][W]=w?L.read_shift(-4,"i")^2147483648:L.read_shift(4,"i");break;case"L":switch(H.trim().toUpperCase()){case"Y":case"T":c[A][W]=!0;break;case"N":case"F":c[A][W]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+H+"|")}break;case"M":if(!m)throw new Error("DBF Unexpected MEMO for type "+g.toString(16));c[A][W]="##MEMO##"+(w?parseInt(H.trim(),10):L.read_shift(4));break;case"N":H=H.replace(/\u0000/g,"").trim(),H&&H!="."&&(c[A][W]=+H||0);break;case"@":c[A][W]=new Date(L.read_shift(-8,"f")-621356832e5);break;case"T":c[A][W]=new Date((L.read_shift(4)-2440588)*864e5+L.read_shift(4));break;case"Y":c[A][W]=L.read_shift(4,"i")/1e4+L.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":c[A][W]=-L.read_shift(-8,"f");break;case"B":if(v&&T[W].len==8){c[A][W]=L.read_shift(8,"f");break}case"G":case"P":L.l+=T[W].len;break;case"0":if(T[W].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+T[W].type)}}}if(g!=2&&f.l<f.length&&f[f.l++]!=26)throw new Error("DBF EOF Marker missing "+(f.l-1)+" of "+f.length+" "+f[f.l-1].toString(16));return u&&u.sheetRows&&(c=c.slice(0,u.sheetRows)),u.DBF=T,c}function n(o,u){var c=u||{};c.dateNF||(c.dateNF="yyyymmdd");var f=gv(r(o,c),c);return f["!cols"]=c.DBF.map(function(g){return{wch:g.len,DBF:g}}),delete c.DBF,f}function i(o,u){try{return rd(n(o,u),u)}catch(c){if(u&&u.WTF)throw c}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function a(o,u){var c=u||{};if(+c.codepage>=0&&Bo(+c.codepage),c.type=="string")throw new Error("Cannot write DBF to JS string");var f=ya(),g=rR(o,{header:1,raw:!0,cellDates:!0}),m=g[0],v=g.slice(1),w=o["!cols"]||[],y=0,b=0,x=0,_=1;for(y=0;y<m.length;++y){if(((w[y]||{}).DBF||{}).name){m[y]=w[y].DBF.name,++x;continue}if(m[y]!=null){if(++x,typeof m[y]=="number"&&(m[y]=m[y].toString(10)),typeof m[y]!="string")throw new Error("DBF Invalid column name "+m[y]+" |"+typeof m[y]+"|");if(m.indexOf(m[y])!==y){for(b=0;b<1024;++b)if(m.indexOf(m[y]+"_"+b)==-1){m[y]+="_"+b;break}}}}var T=ar(o["!ref"]),D=[],P=[],O=[];for(y=0;y<=T.e.c-T.s.c;++y){var A="",W="",L=0,H=[];for(b=0;b<v.length;++b)v[b][y]!=null&&H.push(v[b][y]);if(H.length==0||m[y]==null){D[y]="?";continue}for(b=0;b<H.length;++b){switch(typeof H[b]){case"number":W="B";break;case"string":W="C";break;case"boolean":W="L";break;case"object":W=H[b]instanceof Date?"D":"C";break;default:W="C"}L=Math.max(L,String(H[b]).length),A=A&&A!=W?"C":W}L>250&&(L=250),W=((w[y]||{}).DBF||{}).type,W=="C"&&w[y].DBF.len>L&&(L=w[y].DBF.len),A=="B"&&W=="N"&&(A="N",O[y]=w[y].DBF.dec,L=w[y].DBF.len),P[y]=A=="C"||W=="N"?L:s[A]||0,_+=P[y],D[y]=A}var J=f.next(32);for(J.write_shift(4,318902576),J.write_shift(4,v.length),J.write_shift(2,296+32*x),J.write_shift(2,_),y=0;y<4;++y)J.write_shift(4,0);for(J.write_shift(4,0|(+e[Wg]||3)<<8),y=0,b=0;y<m.length;++y)if(m[y]!=null){var G=f.next(32),ve=(m[y].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);G.write_shift(1,ve,"sbcs"),G.write_shift(1,D[y]=="?"?"C":D[y],"sbcs"),G.write_shift(4,b),G.write_shift(1,P[y]||s[D[y]]||0),G.write_shift(1,O[y]||0),G.write_shift(1,2),G.write_shift(4,0),G.write_shift(1,0),G.write_shift(4,0),G.write_shift(4,0),b+=P[y]||s[D[y]]||0}var be=f.next(264);for(be.write_shift(4,13),y=0;y<65;++y)be.write_shift(4,0);for(y=0;y<v.length;++y){var we=f.next(_);for(we.write_shift(1,0),b=0;b<m.length;++b)if(m[b]!=null)switch(D[b]){case"L":we.write_shift(1,v[y][b]==null?63:v[y][b]?84:70);break;case"B":we.write_shift(8,v[y][b]||0,"f");break;case"N":var ae="0";for(typeof v[y][b]=="number"&&(ae=v[y][b].toFixed(O[b]||0)),x=0;x<P[b]-ae.length;++x)we.write_shift(1,32);we.write_shift(1,ae,"sbcs");break;case"D":v[y][b]?(we.write_shift(4,("0000"+v[y][b].getFullYear()).slice(-4),"sbcs"),we.write_shift(2,("00"+(v[y][b].getMonth()+1)).slice(-2),"sbcs"),we.write_shift(2,("00"+v[y][b].getDate()).slice(-2),"sbcs")):we.write_shift(8,"00000000","sbcs");break;case"C":var le=String(v[y][b]!=null?v[y][b]:"").slice(0,P[b]);for(we.write_shift(1,le,"sbcs"),x=0;x<P[b]-le.length;++x)we.write_shift(1,32);break}}return f.next(1).write_shift(1,26),f.end()}return{to_workbook:i,to_sheet:n,from_sheet:a}}(),Fre=function(){var t={AA:"À",BA:"Á",CA:"Â",DA:195,HA:"Ä",JA:197,AE:"È",BE:"É",CE:"Ê",HE:"Ë",AI:"Ì",BI:"Í",CI:"Î",HI:"Ï",AO:"Ò",BO:"Ó",CO:"Ô",DO:213,HO:"Ö",AU:"Ù",BU:"Ú",CU:"Û",HU:"Ü",Aa:"à",Ba:"á",Ca:"â",Da:227,Ha:"ä",Ja:229,Ae:"è",Be:"é",Ce:"ê",He:"ë",Ai:"ì",Bi:"í",Ci:"î",Hi:"ï",Ao:"ò",Bo:"ó",Co:"ô",Do:245,Ho:"ö",Au:"ù",Bu:"ú",Cu:"û",Hu:"ü",KC:"Ç",Kc:"ç",q:"æ",z:"œ",a:"Æ",j:"Œ",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+Gn(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(m,v){var w=t[v];return typeof w=="number"?ZN(w):w},n=function(m,v,w){var y=v.charCodeAt(0)-32<<4|w.charCodeAt(0)-48;return y==59?m:ZN(y)};t["|"]=254;function i(m,v){switch(v.type){case"base64":return s(Za(m),v);case"binary":return s(m,v);case"buffer":return s(Gt&&Buffer.isBuffer(m)?m.toString("binary"):td(m),v);case"array":return s(Ug(m),v)}throw new Error("Unrecognized type "+v.type)}function s(m,v){var w=m.split(/[\n\r]+/),y=-1,b=-1,x=0,_=0,T=[],D=[],P=null,O={},A=[],W=[],L=[],H=0,J;for(+v.codepage>=0&&Bo(+v.codepage);x!==w.length;++x){H=0;var G=w[x].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(e,r),ve=G.replace(/;;/g,"\0").split(";").map(function(M){return M.replace(/\u0000/g,";")}),be=ve[0],we;if(G.length>0)switch(be){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":ve[1].charAt(0)=="P"&&D.push(G.slice(3).replace(/;;/g,";"));break;case"C":var ae=!1,le=!1,Te=!1,ce=!1,K=-1,Se=-1;for(_=1;_<ve.length;++_)switch(ve[_].charAt(0)){case"A":break;case"X":b=parseInt(ve[_].slice(1))-1,le=!0;break;case"Y":for(y=parseInt(ve[_].slice(1))-1,le||(b=0),J=T.length;J<=y;++J)T[J]=[];break;case"K":we=ve[_].slice(1),we.charAt(0)==='"'?we=we.slice(1,we.length-1):we==="TRUE"?we=!0:we==="FALSE"?we=!1:isNaN(Al(we))?isNaN(Lp(we).getDate())||(we=pn(we)):(we=Al(we),P!==null&&cm(P)&&(we=AT(we))),typeof gr<"u"&&typeof we=="string"&&(v||{}).type!="string"&&(v||{}).codepage&&(we=gr.utils.decode(v.codepage,we)),ae=!0;break;case"E":ce=!0;var B=Sp(ve[_].slice(1),{r:y,c:b});T[y][b]=[T[y][b],B];break;case"S":Te=!0,T[y][b]=[T[y][b],"S5S"];break;case"G":break;case"R":K=parseInt(ve[_].slice(1))-1;break;case"C":Se=parseInt(ve[_].slice(1))-1;break;default:if(v&&v.WTF)throw new Error("SYLK bad record "+G)}if(ae&&(T[y][b]&&T[y][b].length==2?T[y][b][0]=we:T[y][b]=we,P=null),Te){if(ce)throw new Error("SYLK shared formula cannot have own formula");var E=K>-1&&T[K][Se];if(!E||!E[1])throw new Error("SYLK shared formula cannot find base");T[y][b][1]=tne(E[1],{r:y-K,c:b-Se})}break;case"F":var R=0;for(_=1;_<ve.length;++_)switch(ve[_].charAt(0)){case"X":b=parseInt(ve[_].slice(1))-1,++R;break;case"Y":for(y=parseInt(ve[_].slice(1))-1,J=T.length;J<=y;++J)T[J]=[];break;case"M":H=parseInt(ve[_].slice(1))/20;break;case"F":break;case"G":break;case"P":P=D[parseInt(ve[_].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(L=ve[_].slice(1).split(" "),J=parseInt(L[0],10);J<=parseInt(L[1],10);++J)H=parseInt(L[2],10),W[J-1]=H===0?{hidden:!0}:{wch:H},jf(W[J-1]);break;case"C":b=parseInt(ve[_].slice(1))-1,W[b]||(W[b]={});break;case"R":y=parseInt(ve[_].slice(1))-1,A[y]||(A[y]={}),H>0?(A[y].hpt=H,A[y].hpx=Vp(H)):H===0&&(A[y].hidden=!0);break;default:if(v&&v.WTF)throw new Error("SYLK bad record "+G)}R<1&&(P=null);break;default:if(v&&v.WTF)throw new Error("SYLK bad record "+G)}}return A.length>0&&(O["!rows"]=A),W.length>0&&(O["!cols"]=W),v&&v.sheetRows&&(T=T.slice(0,v.sheetRows)),[T,O]}function a(m,v){var w=i(m,v),y=w[0],b=w[1],x=gv(y,v);return Gn(b).forEach(function(_){x[_]=b[_]}),x}function o(m,v){return rd(a(m,v),v)}function u(m,v,w,y){var b="C;Y"+(w+1)+";X"+(y+1)+";K";switch(m.t){case"n":b+=m.v||0,m.f&&!m.F&&(b+=";E"+mB(m.f,{r:w,c:y}));break;case"b":b+=m.v?"TRUE":"FALSE";break;case"e":b+=m.w||m.v;break;case"d":b+='"'+(m.w||m.v)+'"';break;case"s":b+='"'+m.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return b}function c(m,v){v.forEach(function(w,y){var b="F;W"+(y+1)+" "+(y+1)+" ";w.hidden?b+="0":(typeof w.width=="number"&&!w.wpx&&(w.wpx=K1(w.width)),typeof w.wpx=="number"&&!w.wch&&(w.wch=X1(w.wpx)),typeof w.wch=="number"&&(b+=Math.round(w.wch))),b.charAt(b.length-1)!=" "&&m.push(b)})}function f(m,v){v.forEach(function(w,y){var b="F;";w.hidden?b+="M0;":w.hpt?b+="M"+20*w.hpt+";":w.hpx&&(b+="M"+20*Q1(w.hpx)+";"),b.length>2&&m.push(b+"R"+(y+1))})}function g(m,v){var w=["ID;PWXL;N;E"],y=[],b=ar(m["!ref"]),x,_=Array.isArray(m),T=`\r
`;w.push("P;PGeneral"),w.push("F;P0;DG0G8;M255"),m["!cols"]&&c(w,m["!cols"]),m["!rows"]&&f(w,m["!rows"]),w.push("B;Y"+(b.e.r-b.s.r+1)+";X"+(b.e.c-b.s.c+1)+";D"+[b.s.c,b.s.r,b.e.c,b.e.r].join(" "));for(var D=b.s.r;D<=b.e.r;++D)for(var P=b.s.c;P<=b.e.c;++P){var O=Tt({r:D,c:P});x=_?(m[D]||[])[P]:m[O],!(!x||x.v==null&&(!x.f||x.F))&&y.push(u(x,m,D,P))}return w.join(T)+T+y.join(T)+T+"E"+T}return{to_workbook:o,to_sheet:a,from_sheet:g}}(),Lre=function(){function t(s,a){switch(a.type){case"base64":return e(Za(s),a);case"binary":return e(s,a);case"buffer":return e(Gt&&Buffer.isBuffer(s)?s.toString("binary"):td(s),a);case"array":return e(Ug(s),a)}throw new Error("Unrecognized type "+a.type)}function e(s,a){for(var o=s.split(`
`),u=-1,c=-1,f=0,g=[];f!==o.length;++f){if(o[f].trim()==="BOT"){g[++u]=[],c=0;continue}if(!(u<0)){var m=o[f].trim().split(","),v=m[0],w=m[1];++f;for(var y=o[f]||"";(y.match(/["]/g)||[]).length&1&&f<o.length-1;)y+=`
`+o[++f];switch(y=y.trim(),+v){case-1:if(y==="BOT"){g[++u]=[],c=0;continue}else if(y!=="EOD")throw new Error("Unrecognized DIF special command "+y);break;case 0:y==="TRUE"?g[u][c]=!0:y==="FALSE"?g[u][c]=!1:isNaN(Al(w))?isNaN(Lp(w).getDate())?g[u][c]=w:g[u][c]=pn(w):g[u][c]=Al(w),++c;break;case 1:y=y.slice(1,y.length-1),y=y.replace(/""/g,'"'),y&&y.match(/^=".*"$/)&&(y=y.slice(2,-1)),g[u][c++]=y!==""?y:null;break}if(y==="EOD")break}}return a&&a.sheetRows&&(g=g.slice(0,a.sheetRows)),g}function r(s,a){return gv(t(s,a),a)}function n(s,a){return rd(r(s,a),a)}var i=function(){var s=function(u,c,f,g,m){u.push(c),u.push(f+","+g),u.push('"'+m.replace(/"/g,'""')+'"')},a=function(u,c,f,g){u.push(c+","+f),u.push(c==1?'"'+g.replace(/"/g,'""')+'"':g)};return function(u){var c=[],f=ar(u["!ref"]),g,m=Array.isArray(u);s(c,"TABLE",0,1,"sheetjs"),s(c,"VECTORS",0,f.e.r-f.s.r+1,""),s(c,"TUPLES",0,f.e.c-f.s.c+1,""),s(c,"DATA",0,0,"");for(var v=f.s.r;v<=f.e.r;++v){a(c,-1,0,"BOT");for(var w=f.s.c;w<=f.e.c;++w){var y=Tt({r:v,c:w});if(g=m?(u[v]||[])[w]:u[y],!g){a(c,1,0,"");continue}switch(g.t){case"n":var b=g.w;!b&&g.v!=null&&(b=g.v),b==null?g.f&&!g.F?a(c,1,0,"="+g.f):a(c,1,0,""):a(c,0,b,"V");break;case"b":a(c,0,g.v?1:0,g.v?"TRUE":"FALSE");break;case"s":a(c,1,0,isNaN(g.v)?g.v:'="'+g.v+'"');break;case"d":g.w||(g.w=Ja(g.z||xt[14],Hi(pn(g.v)))),a(c,0,g.w,"V");break;default:a(c,1,0,"")}}}a(c,-1,0,"EOD");var x=`\r
`,_=c.join(x);return _}}();return{to_workbook:n,to_sheet:r,from_sheet:i}}(),Bre=function(){function t(g){return g.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(g){return g.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(g,m){for(var v=g.split(`
`),w=-1,y=-1,b=0,x=[];b!==v.length;++b){var _=v[b].trim().split(":");if(_[0]==="cell"){var T=Dn(_[1]);if(x.length<=T.r)for(w=x.length;w<=T.r;++w)x[w]||(x[w]=[]);switch(w=T.r,y=T.c,_[2]){case"t":x[w][y]=t(_[3]);break;case"v":x[w][y]=+_[3];break;case"vtf":var D=_[_.length-1];case"vtc":switch(_[3]){case"nl":x[w][y]=!!+_[4];break;default:x[w][y]=+_[4];break}_[2]=="vtf"&&(x[w][y]=[x[w][y],D])}}}return m&&m.sheetRows&&(x=x.slice(0,m.sheetRows)),x}function n(g,m){return gv(r(g,m),m)}function i(g,m){return rd(n(g,m),m)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),a=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),u="--SocialCalcSpreadsheetControlSave--";function c(g){if(!g||!g["!ref"])return"";for(var m=[],v=[],w,y="",b=Ks(g["!ref"]),x=Array.isArray(g),_=b.s.r;_<=b.e.r;++_)for(var T=b.s.c;T<=b.e.c;++T)if(y=Tt({r:_,c:T}),w=x?(g[_]||[])[T]:g[y],!(!w||w.v==null||w.t==="z")){switch(v=["cell",y,"t"],w.t){case"s":case"str":v.push(e(w.v));break;case"n":w.f?(v[2]="vtf",v[3]="n",v[4]=w.v,v[5]=e(w.f)):(v[2]="v",v[3]=w.v);break;case"b":v[2]="vt"+(w.f?"f":"c"),v[3]="nl",v[4]=w.v?"1":"0",v[5]=e(w.f||(w.v?"TRUE":"FALSE"));break;case"d":var D=Hi(pn(w.v));v[2]="vtc",v[3]="nd",v[4]=""+D,v[5]=w.w||Ja(w.z||xt[14],D);break;case"e":continue}m.push(v.join(":"))}return m.push("sheet:c:"+(b.e.c-b.s.c+1)+":r:"+(b.e.r-b.s.r+1)+":tvf:1"),m.push("valueformat:1:text-wiki"),m.join(`
`)}function f(g){return[s,a,o,a,c(g),u].join(`
`)}return{to_workbook:i,to_sheet:n,from_sheet:f}}(),Bp=function(){function t(f,g,m,v,w){w.raw?g[m][v]=f:f===""||(f==="TRUE"?g[m][v]=!0:f==="FALSE"?g[m][v]=!1:isNaN(Al(f))?isNaN(Lp(f).getDate())?g[m][v]=f:g[m][v]=pn(f):g[m][v]=Al(f))}function e(f,g){var m=g||{},v=[];if(!f||f.length===0)return v;for(var w=f.split(/[\r\n]/),y=w.length-1;y>=0&&w[y].length===0;)--y;for(var b=10,x=0,_=0;_<=y;++_)x=w[_].indexOf(" "),x==-1?x=w[_].length:x++,b=Math.max(b,x);for(_=0;_<=y;++_){v[_]=[];var T=0;for(t(w[_].slice(0,b).trim(),v,_,T,m),T=1;T<=(w[_].length-b)/10+1;++T)t(w[_].slice(b+(T-1)*10,b+T*10).trim(),v,_,T,m)}return m.sheetRows&&(v=v.slice(0,m.sheetRows)),v}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function i(f){for(var g={},m=!1,v=0,w=0;v<f.length;++v)(w=f.charCodeAt(v))==34?m=!m:!m&&w in r&&(g[w]=(g[w]||0)+1);w=[];for(v in g)Object.prototype.hasOwnProperty.call(g,v)&&w.push([g[v],v]);if(!w.length){g=n;for(v in g)Object.prototype.hasOwnProperty.call(g,v)&&w.push([g[v],v])}return w.sort(function(y,b){return y[0]-b[0]||n[y[1]]-n[b[1]]}),r[w.pop()[1]]||44}function s(f,g){var m=g||{},v="",w=m.dense?[]:{},y={s:{c:0,r:0},e:{c:0,r:0}};f.slice(0,4)=="sep="?f.charCodeAt(5)==13&&f.charCodeAt(6)==10?(v=f.charAt(4),f=f.slice(7)):f.charCodeAt(5)==13||f.charCodeAt(5)==10?(v=f.charAt(4),f=f.slice(6)):v=i(f.slice(0,1024)):m&&m.FS?v=m.FS:v=i(f.slice(0,1024));var b=0,x=0,_=0,T=0,D=0,P=v.charCodeAt(0),O=!1,A=0,W=f.charCodeAt(0);f=f.replace(/\r\n/mg,`
`);var L=m.dateNF!=null?n4e(m.dateNF):null;function H(){var J=f.slice(T,D),G={};if(J.charAt(0)=='"'&&J.charAt(J.length-1)=='"'&&(J=J.slice(1,-1).replace(/""/g,'"')),J.length===0)G.t="z";else if(m.raw)G.t="s",G.v=J;else if(J.trim().length===0)G.t="s",G.v=J;else if(J.charCodeAt(0)==61)J.charCodeAt(1)==34&&J.charCodeAt(J.length-1)==34?(G.t="s",G.v=J.slice(2,-1).replace(/""/g,'"')):P8e(J)?(G.t="n",G.f=J.slice(1)):(G.t="s",G.v=J);else if(J=="TRUE")G.t="b",G.v=!0;else if(J=="FALSE")G.t="b",G.v=!1;else if(!isNaN(_=Al(J)))G.t="n",m.cellText!==!1&&(G.w=J),G.v=_;else if(!isNaN(Lp(J).getDate())||L&&J.match(L)){G.z=m.dateNF||xt[14];var ve=0;L&&J.match(L)&&(J=i4e(J,m.dateNF,J.match(L)||[]),ve=1),m.cellDates?(G.t="d",G.v=pn(J,ve)):(G.t="n",G.v=Hi(pn(J,ve))),m.cellText!==!1&&(G.w=Ja(G.z,G.v instanceof Date?Hi(G.v):G.v)),m.cellNF||delete G.z}else G.t="s",G.v=J;if(G.t=="z"||(m.dense?(w[b]||(w[b]=[]),w[b][x]=G):w[Tt({c:x,r:b})]=G),T=D+1,W=f.charCodeAt(T),y.e.c<x&&(y.e.c=x),y.e.r<b&&(y.e.r=b),A==P)++x;else if(x=0,++b,m.sheetRows&&m.sheetRows<=b)return!0}e:for(;D<f.length;++D)switch(A=f.charCodeAt(D)){case 34:W===34&&(O=!O);break;case P:case 10:case 13:if(!O&&H())break e;break}return D-T>0&&H(),w["!ref"]=Ht(y),w}function a(f,g){return!(g&&g.PRN)||g.FS||f.slice(0,4)=="sep="||f.indexOf("	")>=0||f.indexOf(",")>=0||f.indexOf(";")>=0?s(f,g):gv(e(f,g),g)}function o(f,g){var m="",v=g.type=="string"?[0,0,0,0]:EB(f,g);switch(g.type){case"base64":m=Za(f);break;case"binary":m=f;break;case"buffer":g.codepage==65001?m=f.toString("utf8"):g.codepage&&typeof gr<"u"?m=gr.utils.decode(g.codepage,f):m=Gt&&Buffer.isBuffer(f)?f.toString("binary"):td(f);break;case"array":m=Ug(f);break;case"string":m=f;break;default:throw new Error("Unrecognized type "+g.type)}return v[0]==239&&v[1]==187&&v[2]==191?m=Zr(m.slice(3)):g.type!="string"&&g.type!="buffer"&&g.codepage==65001?m=Zr(m):g.type=="binary"&&typeof gr<"u"&&g.codepage&&(m=gr.utils.decode(g.codepage,gr.utils.encode(28591,m))),m.slice(0,19)=="socialcalc:version:"?Bre.to_sheet(g.type=="string"?m:Zr(m),g):a(m,g)}function u(f,g){return rd(o(f,g),g)}function c(f){for(var g=[],m=ar(f["!ref"]),v,w=Array.isArray(f),y=m.s.r;y<=m.e.r;++y){for(var b=[],x=m.s.c;x<=m.e.c;++x){var _=Tt({r:y,c:x});if(v=w?(f[y]||[])[x]:f[_],!v||v.v==null){b.push("          ");continue}for(var T=(v.w||(Vu(v),v.w)||"").slice(0,10);T.length<10;)T+=" ";b.push(T+(x===0?" ":""))}g.push(b.join(""))}return g.join(`
`)}return{to_workbook:u,to_sheet:o,from_sheet:c}}();function yVe(t,e){var r=e||{},n=!!r.WTF;r.WTF=!0;try{var i=Fre.to_workbook(t,r);return r.WTF=n,i}catch(s){if(r.WTF=n,!s.message.match(/SYLK bad record ID/)&&n)throw s;return Bp.to_workbook(t,e)}}var Mg=function(){function t(B,E,R){if(B){rs(B,B.l||0);for(var M=R.Enum||K;B.l<B.length;){var F=B.read_shift(2),Z=M[F]||M[65535],te=B.read_shift(2),fe=B.l+te,I=Z.f&&Z.f(B,te,R);if(B.l=fe,E(I,Z,F))return}}}function e(B,E){switch(E.type){case"base64":return r(Ga(Za(B)),E);case"binary":return r(Ga(B),E);case"buffer":case"array":return r(B,E)}throw"Unsupported type "+E.type}function r(B,E){if(!B)return B;var R=E||{},M=R.dense?[]:{},F="Sheet1",Z="",te=0,fe={},I=[],U=[],k={s:{r:0,c:0},e:{r:0,c:0}},ee=R.sheetRows||0;if(B[2]==0&&(B[3]==8||B[3]==9)&&B.length>=16&&B[14]==5&&B[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(B[2]==2)R.Enum=K,t(B,function(Q,ge,xe){switch(xe){case 0:R.vers=Q,Q>=4096&&(R.qpro=!0);break;case 6:k=Q;break;case 204:Q&&(Z=Q);break;case 222:Z=Q;break;case 15:case 51:R.qpro||(Q[1].v=Q[1].v.slice(1));case 13:case 14:case 16:xe==14&&(Q[2]&112)==112&&(Q[2]&15)>1&&(Q[2]&15)<15&&(Q[1].z=R.dateNF||xt[14],R.cellDates&&(Q[1].t="d",Q[1].v=AT(Q[1].v))),R.qpro&&Q[3]>te&&(M["!ref"]=Ht(k),fe[F]=M,I.push(F),M=R.dense?[]:{},k={s:{r:0,c:0},e:{r:0,c:0}},te=Q[3],F=Z||"Sheet"+(te+1),Z="");var _e=R.dense?(M[Q[0].r]||[])[Q[0].c]:M[Tt(Q[0])];if(_e){_e.t=Q[1].t,_e.v=Q[1].v,Q[1].z!=null&&(_e.z=Q[1].z),Q[1].f!=null&&(_e.f=Q[1].f);break}R.dense?(M[Q[0].r]||(M[Q[0].r]=[]),M[Q[0].r][Q[0].c]=Q[1]):M[Tt(Q[0])]=Q[1];break}},R);else if(B[2]==26||B[2]==14)R.Enum=Se,B[2]==14&&(R.qpro=!0,B.l=0),t(B,function(Q,ge,xe){switch(xe){case 204:F=Q;break;case 22:Q[1].v=Q[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Q[3]>te&&(M["!ref"]=Ht(k),fe[F]=M,I.push(F),M=R.dense?[]:{},k={s:{r:0,c:0},e:{r:0,c:0}},te=Q[3],F="Sheet"+(te+1)),ee>0&&Q[0].r>=ee)break;R.dense?(M[Q[0].r]||(M[Q[0].r]=[]),M[Q[0].r][Q[0].c]=Q[1]):M[Tt(Q[0])]=Q[1],k.e.c<Q[0].c&&(k.e.c=Q[0].c),k.e.r<Q[0].r&&(k.e.r=Q[0].r);break;case 27:Q[14e3]&&(U[Q[14e3][0]]=Q[14e3][1]);break;case 1537:U[Q[0]]=Q[1],Q[0]==te&&(F=Q[1]);break}},R);else throw new Error("Unrecognized LOTUS BOF "+B[2]);if(M["!ref"]=Ht(k),fe[Z||F]=M,I.push(Z||F),!U.length)return{SheetNames:I,Sheets:fe};for(var oe={},de=[],pe=0;pe<U.length;++pe)fe[I[pe]]?(de.push(U[pe]||I[pe]),oe[U[pe]]=fe[U[pe]]||fe[I[pe]]):(de.push(U[pe]),oe[U[pe]]={"!ref":"A1"});return{SheetNames:de,Sheets:oe}}function n(B,E){var R=E||{};if(+R.codepage>=0&&Bo(+R.codepage),R.type=="string")throw new Error("Cannot write WK1 to JS string");var M=ya(),F=ar(B["!ref"]),Z=Array.isArray(B),te=[];Ke(M,0,s(1030)),Ke(M,6,u(F));for(var fe=Math.min(F.e.r,8191),I=F.s.r;I<=fe;++I)for(var U=jn(I),k=F.s.c;k<=F.e.c;++k){I===F.s.r&&(te[k]=mn(k));var ee=te[k]+U,oe=Z?(B[I]||[])[k]:B[ee];if(!(!oe||oe.t=="z"))if(oe.t=="n")(oe.v|0)==oe.v&&oe.v>=-32768&&oe.v<=32767?Ke(M,13,v(I,k,oe.v)):Ke(M,14,y(I,k,oe.v));else{var de=Vu(oe);Ke(M,15,g(I,k,de.slice(0,239)))}}return Ke(M,1),M.end()}function i(B,E){var R=E||{};if(+R.codepage>=0&&Bo(+R.codepage),R.type=="string")throw new Error("Cannot write WK3 to JS string");var M=ya();Ke(M,0,a(B));for(var F=0,Z=0;F<B.SheetNames.length;++F)(B.Sheets[B.SheetNames[F]]||{})["!ref"]&&Ke(M,27,ce(B.SheetNames[F],Z++));var te=0;for(F=0;F<B.SheetNames.length;++F){var fe=B.Sheets[B.SheetNames[F]];if(!(!fe||!fe["!ref"])){for(var I=ar(fe["!ref"]),U=Array.isArray(fe),k=[],ee=Math.min(I.e.r,8191),oe=I.s.r;oe<=ee;++oe)for(var de=jn(oe),pe=I.s.c;pe<=I.e.c;++pe){oe===I.s.r&&(k[pe]=mn(pe));var Q=k[pe]+de,ge=U?(fe[oe]||[])[pe]:fe[Q];if(!(!ge||ge.t=="z"))if(ge.t=="n")Ke(M,23,H(oe,pe,te,ge.v));else{var xe=Vu(ge);Ke(M,22,A(oe,pe,te,xe.slice(0,239)))}}++te}}return Ke(M,1),M.end()}function s(B){var E=Fe(2);return E.write_shift(2,B),E}function a(B){var E=Fe(26);E.write_shift(2,4096),E.write_shift(2,4),E.write_shift(4,0);for(var R=0,M=0,F=0,Z=0;Z<B.SheetNames.length;++Z){var te=B.SheetNames[Z],fe=B.Sheets[te];if(!(!fe||!fe["!ref"])){++F;var I=Ks(fe["!ref"]);R<I.e.r&&(R=I.e.r),M<I.e.c&&(M=I.e.c)}}return R>8191&&(R=8191),E.write_shift(2,R),E.write_shift(1,F),E.write_shift(1,M),E.write_shift(2,0),E.write_shift(2,0),E.write_shift(1,1),E.write_shift(1,2),E.write_shift(4,0),E.write_shift(4,0),E}function o(B,E,R){var M={s:{c:0,r:0},e:{c:0,r:0}};return E==8&&R.qpro?(M.s.c=B.read_shift(1),B.l++,M.s.r=B.read_shift(2),M.e.c=B.read_shift(1),B.l++,M.e.r=B.read_shift(2),M):(M.s.c=B.read_shift(2),M.s.r=B.read_shift(2),E==12&&R.qpro&&(B.l+=2),M.e.c=B.read_shift(2),M.e.r=B.read_shift(2),E==12&&R.qpro&&(B.l+=2),M.s.c==65535&&(M.s.c=M.e.c=M.s.r=M.e.r=0),M)}function u(B){var E=Fe(8);return E.write_shift(2,B.s.c),E.write_shift(2,B.s.r),E.write_shift(2,B.e.c),E.write_shift(2,B.e.r),E}function c(B,E,R){var M=[{c:0,r:0},{t:"n",v:0},0,0];return R.qpro&&R.vers!=20768?(M[0].c=B.read_shift(1),M[3]=B.read_shift(1),M[0].r=B.read_shift(2),B.l+=2):(M[2]=B.read_shift(1),M[0].c=B.read_shift(2),M[0].r=B.read_shift(2)),M}function f(B,E,R){var M=B.l+E,F=c(B,E,R);if(F[1].t="s",R.vers==20768){B.l++;var Z=B.read_shift(1);return F[1].v=B.read_shift(Z,"utf8"),F}return R.qpro&&B.l++,F[1].v=B.read_shift(M-B.l,"cstr"),F}function g(B,E,R){var M=Fe(7+R.length);M.write_shift(1,255),M.write_shift(2,E),M.write_shift(2,B),M.write_shift(1,39);for(var F=0;F<M.length;++F){var Z=R.charCodeAt(F);M.write_shift(1,Z>=128?95:Z)}return M.write_shift(1,0),M}function m(B,E,R){var M=c(B,E,R);return M[1].v=B.read_shift(2,"i"),M}function v(B,E,R){var M=Fe(7);return M.write_shift(1,255),M.write_shift(2,E),M.write_shift(2,B),M.write_shift(2,R,"i"),M}function w(B,E,R){var M=c(B,E,R);return M[1].v=B.read_shift(8,"f"),M}function y(B,E,R){var M=Fe(13);return M.write_shift(1,255),M.write_shift(2,E),M.write_shift(2,B),M.write_shift(8,R,"f"),M}function b(B,E,R){var M=B.l+E,F=c(B,E,R);if(F[1].v=B.read_shift(8,"f"),R.qpro)B.l=M;else{var Z=B.read_shift(2);D(B.slice(B.l,B.l+Z),F),B.l+=Z}return F}function x(B,E,R){var M=E&32768;return E&=-32769,E=(M?B:0)+(E>=8192?E-16384:E),(M?"":"$")+(R?mn(E):jn(E))}var _={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},T=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function D(B,E){rs(B,0);for(var R=[],M=0,F="",Z="",te="",fe="";B.l<B.length;){var I=B[B.l++];switch(I){case 0:R.push(B.read_shift(8,"f"));break;case 1:Z=x(E[0].c,B.read_shift(2),!0),F=x(E[0].r,B.read_shift(2),!1),R.push(Z+F);break;case 2:{var U=x(E[0].c,B.read_shift(2),!0),k=x(E[0].r,B.read_shift(2),!1);Z=x(E[0].c,B.read_shift(2),!0),F=x(E[0].r,B.read_shift(2),!1),R.push(U+k+":"+Z+F)}break;case 3:if(B.l<B.length){console.error("WK1 premature formula end");return}break;case 4:R.push("("+R.pop()+")");break;case 5:R.push(B.read_shift(2));break;case 6:{for(var ee="";I=B[B.l++];)ee+=String.fromCharCode(I);R.push('"'+ee.replace(/"/g,'""')+'"')}break;case 8:R.push("-"+R.pop());break;case 23:R.push("+"+R.pop());break;case 22:R.push("NOT("+R.pop()+")");break;case 20:case 21:fe=R.pop(),te=R.pop(),R.push(["AND","OR"][I-20]+"("+te+","+fe+")");break;default:if(I<32&&T[I])fe=R.pop(),te=R.pop(),R.push(te+T[I]+fe);else if(_[I]){if(M=_[I][1],M==69&&(M=B[B.l++]),M>R.length){console.error("WK1 bad formula parse 0x"+I.toString(16)+":|"+R.join("|")+"|");return}var oe=R.slice(-M);R.length-=M,R.push(_[I][0]+"("+oe.join(",")+")")}else return I<=7?console.error("WK1 invalid opcode "+I.toString(16)):I<=24?console.error("WK1 unsupported op "+I.toString(16)):I<=30?console.error("WK1 invalid opcode "+I.toString(16)):I<=115?console.error("WK1 unsupported function opcode "+I.toString(16)):console.error("WK1 unrecognized opcode "+I.toString(16))}}R.length==1?E[1].f=""+R[0]:console.error("WK1 bad formula parse |"+R.join("|")+"|")}function P(B){var E=[{c:0,r:0},{t:"n",v:0},0];return E[0].r=B.read_shift(2),E[3]=B[B.l++],E[0].c=B[B.l++],E}function O(B,E){var R=P(B);return R[1].t="s",R[1].v=B.read_shift(E-4,"cstr"),R}function A(B,E,R,M){var F=Fe(6+M.length);F.write_shift(2,B),F.write_shift(1,R),F.write_shift(1,E),F.write_shift(1,39);for(var Z=0;Z<M.length;++Z){var te=M.charCodeAt(Z);F.write_shift(1,te>=128?95:te)}return F.write_shift(1,0),F}function W(B,E){var R=P(B);R[1].v=B.read_shift(2);var M=R[1].v>>1;if(R[1].v&1)switch(M&7){case 0:M=(M>>3)*5e3;break;case 1:M=(M>>3)*500;break;case 2:M=(M>>3)/20;break;case 3:M=(M>>3)/200;break;case 4:M=(M>>3)/2e3;break;case 5:M=(M>>3)/2e4;break;case 6:M=(M>>3)/16;break;case 7:M=(M>>3)/64;break}return R[1].v=M,R}function L(B,E){var R=P(B),M=B.read_shift(4),F=B.read_shift(4),Z=B.read_shift(2);if(Z==65535)return M===0&&F===3221225472?(R[1].t="e",R[1].v=15):M===0&&F===3489660928?(R[1].t="e",R[1].v=42):R[1].v=0,R;var te=Z&32768;return Z=(Z&32767)-16446,R[1].v=(1-te*2)*(F*Math.pow(2,Z+32)+M*Math.pow(2,Z)),R}function H(B,E,R,M){var F=Fe(14);if(F.write_shift(2,B),F.write_shift(1,R),F.write_shift(1,E),M==0)return F.write_shift(4,0),F.write_shift(4,0),F.write_shift(2,65535),F;var Z=0,te=0,fe=0,I=0;return M<0&&(Z=1,M=-M),te=Math.log2(M)|0,M/=Math.pow(2,te-31),I=M>>>0,(I&2147483648)==0&&(M/=2,++te,I=M>>>0),M-=I,I|=2147483648,I>>>=0,M*=Math.pow(2,32),fe=M>>>0,F.write_shift(4,fe),F.write_shift(4,I),te+=16383+(Z?32768:0),F.write_shift(2,te),F}function J(B,E){var R=L(B);return B.l+=E-14,R}function G(B,E){var R=P(B),M=B.read_shift(4);return R[1].v=M>>6,R}function ve(B,E){var R=P(B),M=B.read_shift(8,"f");return R[1].v=M,R}function be(B,E){var R=ve(B);return B.l+=E-10,R}function we(B,E){return B[B.l+E-1]==0?B.read_shift(E,"cstr"):""}function ae(B,E){var R=B[B.l++];R>E-1&&(R=E-1);for(var M="";M.length<R;)M+=String.fromCharCode(B[B.l++]);return M}function le(B,E,R){if(!(!R.qpro||E<21)){var M=B.read_shift(1);B.l+=17,B.l+=1,B.l+=2;var F=B.read_shift(E-21,"cstr");return[M,F]}}function Te(B,E){for(var R={},M=B.l+E;B.l<M;){var F=B.read_shift(2);if(F==14e3){for(R[F]=[0,""],R[F][0]=B.read_shift(2);B[B.l];)R[F][1]+=String.fromCharCode(B[B.l]),B.l++;B.l++}}return R}function ce(B,E){var R=Fe(5+B.length);R.write_shift(2,14e3),R.write_shift(2,E);for(var M=0;M<B.length;++M){var F=B.charCodeAt(M);R[R.l++]=F>127?95:F}return R[R.l++]=0,R}var K={0:{n:"BOF",f:Si},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:m},14:{n:"NUMBER",f:w},15:{n:"LABEL",f},16:{n:"FORMULA",f:b},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:we},222:{n:"SHEETNAMELP",f:ae},65535:{n:""}},Se={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:O},23:{n:"NUMBER17",f:L},24:{n:"NUMBER18",f:W},25:{n:"FORMULA19",f:J},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:Te},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:G},38:{n:"??"},39:{n:"NUMBER27",f:ve},40:{n:"FORMULA28",f:be},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:we},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:le},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:i,to_workbook:e}}();function SVe(t){var e={},r=t.match(ks),n=0,i=!1;if(r)for(;n!=r.length;++n){var s=Ot(r[n]);switch(s[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":e.shadow=1;break;case"</shadow>":break;case"<charset":if(s.val=="1")break;e.cp=L3[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":e.outline=1;break;case"</outline>":break;case"<rFont":e.name=s.val;break;case"<sz":e.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":e.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":e.uval="double";break;case"singleAccounting":e.uval="single-accounting";break;case"doubleAccounting":e.uval="double-accounting";break}case"<u>":case"<u/>":e.u=1;break;case"</u>":break;case"<b":if(s.val=="0")break;case"<b>":case"<b/>":e.b=1;break;case"</b>":break;case"<i":if(s.val=="0")break;case"<i>":case"<i/>":e.i=1;break;case"</i>":break;case"<color":s.rgb&&(e.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":e.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":e.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(s[0].charCodeAt(1)!==47&&!i)throw new Error("Unrecognized rich format "+s[0])}}return e}var bVe=function(){var t=j1("t"),e=j1("rPr");function r(s){var a=s.match(t);if(!a)return{t:"s",v:""};var o={t:"s",v:Cr(a[1])},u=s.match(e);return u&&(o.s=SVe(u[1])),o}var n=/<(?:\w+:)?r>/g,i=/<\/(?:\w+:)?r>/;return function(a){return a.replace(n,"").split(i).map(r).filter(function(o){return o.v})}}(),CVe=function(){var e=/(\r\n|\n)/g;function r(i,s,a){var o=[];i.u&&o.push("text-decoration: underline;"),i.uval&&o.push("text-underline-style:"+i.uval+";"),i.sz&&o.push("font-size:"+i.sz+"pt;"),i.outline&&o.push("text-effect: outline;"),i.shadow&&o.push("text-shadow: auto;"),s.push('<span style="'+o.join("")+'">'),i.b&&(s.push("<b>"),a.push("</b>")),i.i&&(s.push("<i>"),a.push("</i>")),i.strike&&(s.push("<s>"),a.push("</s>"));var u=i.valign||"";return u=="superscript"||u=="super"?u="sup":u=="subscript"&&(u="sub"),u!=""&&(s.push("<"+u+">"),a.push("</"+u+">")),a.push("</span>"),i}function n(i){var s=[[],i.v,[]];return i.v?(i.s&&r(i.s,s[0],s[2]),s[0].join("")+s[1].replace(e,"<br/>")+s[2].join("")):""}return function(s){return s.map(n).join("")}}(),xVe=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,EVe=/<(?:\w+:)?r>/,_Ve=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function cB(t,e){var r=e?e.cellHTML:!0,n={};return t?(t.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=Cr(Zr(t.slice(t.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=Zr(t),r&&(n.h=z3(n.t))):t.match(EVe)&&(n.r=Zr(t),n.t=Cr(Zr((t.replace(_Ve,"").match(xVe)||[]).join("").replace(ks,""))),r&&(n.h=CVe(bVe(n.r)))),n):{t:""}}var RVe=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,TVe=/<(?:\w+:)?(?:si|sstItem)>/g,MVe=/<\/(?:\w+:)?(?:si|sstItem)>/;function AVe(t,e){var r=[],n="";if(!t)return r;var i=t.match(RVe);if(i){n=i[2].replace(TVe,"").split(MVe);for(var s=0;s!=n.length;++s){var a=cB(n[s].trim(),e);a!=null&&(r[r.length]=a)}i=Ot(i[1]),r.Count=i.count,r.Unique=i.uniqueCount}return r}var OVe=/^\s|\s$|[\t\n\r]/;function Vre(t,e){if(!e.bookSST)return"";var r=[hi];r[r.length]=qe("sst",null,{xmlns:hm[0],count:t.Count,uniqueCount:t.Unique});for(var n=0;n!=t.length;++n)if(t[n]!=null){var i=t[n],s="<si>";i.r?s+=i.r:(s+="<t",i.t||(i.t=""),i.t.match(OVe)&&(s+=' xml:space="preserve"'),s+=">"+Gr(i.t)+"</t>"),s+="</si>",r[r.length]=s}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function kVe(t){return[t.read_shift(4),t.read_shift(4)]}function DVe(t,e){var r=[],n=!1;return gh(t,function(s,a,o){switch(o){case 159:r.Count=s[0],r.Unique=s[1];break;case 19:r.push(s);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(a.T,!n||e.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function PVe(t,e){return e||(e=Fe(8)),e.write_shift(4,t.Count),e.write_shift(4,t.Unique),e}var IVe=j4e;function NVe(t){var e=ya();Ue(e,159,PVe(t));for(var r=0;r<t.length;++r)Ue(e,19,IVe(t[r]));return Ue(e,160),e.end()}function Wre(t){if(typeof gr<"u")return gr.utils.encode(Wg,t);for(var e=[],r=t.split(""),n=0;n<r.length;++n)e[n]=r[n].charCodeAt(0);return e}function qc(t,e){var r={};return r.Major=t.read_shift(2),r.Minor=t.read_shift(2),e>=4&&(t.l+=e-4),r}function HVe(t){var e={};return e.id=t.read_shift(0,"lpp4"),e.R=qc(t,4),e.U=qc(t,4),e.W=qc(t,4),e}function FVe(t){for(var e=t.read_shift(4),r=t.l+e-4,n={},i=t.read_shift(4),s=[];i-- >0;)s.push({t:t.read_shift(4),v:t.read_shift(0,"lpp4")});if(n.name=t.read_shift(0,"lpp4"),n.comps=s,t.l!=r)throw new Error("Bad DataSpaceMapEntry: "+t.l+" != "+r);return n}function LVe(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(FVe(t));return e}function BVe(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(t.read_shift(0,"lpp4"));return e}function VVe(t){var e={};return t.read_shift(4),t.l+=4,e.id=t.read_shift(0,"lpp4"),e.name=t.read_shift(0,"lpp4"),e.R=qc(t,4),e.U=qc(t,4),e.W=qc(t,4),e}function WVe(t){var e=VVe(t);if(e.ename=t.read_shift(0,"8lpp4"),e.blksz=t.read_shift(4),e.cmode=t.read_shift(4),t.read_shift(4)!=4)throw new Error("Bad !Primary record");return e}function $re(t,e){var r=t.l+e,n={};n.Flags=t.read_shift(4)&63,t.l+=4,n.AlgID=t.read_shift(4);var i=!1;switch(n.AlgID){case 26126:case 26127:case 26128:i=n.Flags==36;break;case 26625:i=n.Flags==4;break;case 0:i=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!i)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=t.read_shift(4),n.KeySize=t.read_shift(4),n.ProviderType=t.read_shift(4),t.l+=8,n.CSPName=t.read_shift(r-t.l>>1,"utf16le"),t.l=r,n}function Ure(t,e){var r={},n=t.l+e;return t.l+=4,r.Salt=t.slice(t.l,t.l+16),t.l+=16,r.Verifier=t.slice(t.l,t.l+16),t.l+=16,t.read_shift(4),r.VerifierHash=t.slice(t.l,n),t.l=n,r}function $Ve(t){var e=qc(t);switch(e.Minor){case 2:return[e.Minor,UVe(t)];case 3:return[e.Minor,jVe()];case 4:return[e.Minor,YVe(t)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+e.Minor)}function UVe(t){var e=t.read_shift(4);if((e&63)!=36)throw new Error("EncryptionInfo mismatch");var r=t.read_shift(4),n=$re(t,r),i=Ure(t,t.length-t.l);return{t:"Std",h:n,v:i}}function jVe(){throw new Error("File is password-protected: ECMA-376 Extensible")}function YVe(t){var e=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];t.l+=4;var r=t.read_shift(t.length-t.l,"utf8"),n={};return r.replace(ks,function(s){var a=Ot(s);switch(Xu(a[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":e.forEach(function(o){n[o]=a[o]});break;case"<dataIntegrity":n.encryptedHmacKey=a.encryptedHmacKey,n.encryptedHmacValue=a.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=a.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(a);break;default:throw a[0]}}),n}function zVe(t,e){var r={},n=r.EncryptionVersionInfo=qc(t,4);if(e-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=t.read_shift(4),e-=4;var i=t.read_shift(4);return e-=4,r.EncryptionHeader=$re(t,i),e-=i,r.EncryptionVerifier=Ure(t,e),r}function GVe(t){var e={},r=e.EncryptionVersionInfo=qc(t,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return e.Salt=t.read_shift(16),e.EncryptedVerifier=t.read_shift(16),e.EncryptedVerifierHash=t.read_shift(16),e}function hB(t){var e=0,r,n=Wre(t),i=n.length+1,s,a,o,u,c;for(r=Uf(i),r[0]=n.length,s=1;s!=i;++s)r[s]=n[s-1];for(s=i-1;s>=0;--s)a=r[s],o=(e&16384)===0?0:1,u=e<<1&32767,c=o|u,e=c^a;return e^52811}var jre=function(){var t=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],e=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(a){return(a/2|a*128)&255},i=function(a,o){return n(a^o)},s=function(a){for(var o=e[a.length-1],u=104,c=a.length-1;c>=0;--c)for(var f=a[c],g=0;g!=7;++g)f&64&&(o^=r[u]),f*=2,--u;return o};return function(a){for(var o=Wre(a),u=s(o),c=o.length,f=Uf(16),g=0;g!=16;++g)f[g]=0;var m,v,w;for((c&1)===1&&(m=u>>8,f[c]=i(t[0],m),--c,m=u&255,v=o[o.length-1],f[c]=i(v,m));c>0;)--c,m=u>>8,f[c]=i(o[c],m),--c,m=u&255,f[c]=i(o[c],m);for(c=15,w=15-o.length;w>0;)m=u>>8,f[c]=i(t[w],m),--c,--w,m=u&255,f[c]=i(o[c],m),--c,--w;return f}}(),qVe=function(t,e,r,n,i){i||(i=e),n||(n=jre(t));var s,a;for(s=0;s!=e.length;++s)a=e[s],a^=n[r],a=(a>>5|a<<3)&255,i[s]=a,++r;return[i,r,n]},KVe=function(t){var e=0,r=jre(t);return function(n){var i=qVe("",n,e,r);return e=i[1],i[0]}};function XVe(t,e,r,n){var i={key:Si(t),verificationBytes:Si(t)};return r.password&&(i.verifier=hB(r.password)),n.valid=i.verificationBytes===i.verifier,n.valid&&(n.insitu=KVe(r.password)),i}function QVe(t,e,r){var n=r||{};return n.Info=t.read_shift(2),t.l-=2,n.Info===1?n.Data=GVe(t):n.Data=zVe(t,e),n}function ZVe(t,e,r){var n={Type:r.biff>=8?t.read_shift(2):0};return n.Type?QVe(t,e-2,n):XVe(t,r.biff>=8?e:e-2,r,n),n}var Yre=function(){function t(i,s){switch(s.type){case"base64":return e(Za(i),s);case"binary":return e(i,s);case"buffer":return e(Gt&&Buffer.isBuffer(i)?i.toString("binary"):td(i),s);case"array":return e(Ug(i),s)}throw new Error("Unrecognized type "+s.type)}function e(i,s){var a=s||{},o=a.dense?[]:{},u=i.match(/\\trowd.*?\\row\b/g);if(!u.length)throw new Error("RTF missing table");var c={s:{c:0,r:0},e:{c:0,r:u.length-1}};return u.forEach(function(f,g){Array.isArray(o)&&(o[g]=[]);for(var m=/\\\w+\b/g,v=0,w,y=-1;w=m.exec(f);){switch(w[0]){case"\\cell":var b=f.slice(v,m.lastIndex-w[0].length);if(b[0]==" "&&(b=b.slice(1)),++y,b.length){var x={v:b,t:"s"};Array.isArray(o)?o[g][y]=x:o[Tt({r:g,c:y})]=x}break}v=m.lastIndex}y>c.e.c&&(c.e.c=y)}),o["!ref"]=Ht(c),o}function r(i,s){return rd(t(i,s),s)}function n(i){for(var s=["{\\rtf1\\ansi"],a=ar(i["!ref"]),o,u=Array.isArray(i),c=a.s.r;c<=a.e.r;++c){s.push("\\trowd\\trautofit1");for(var f=a.s.c;f<=a.e.c;++f)s.push("\\cellx"+(f+1));for(s.push("\\pard\\intbl"),f=a.s.c;f<=a.e.c;++f){var g=Tt({r:c,c:f});o=u?(i[c]||[])[f]:i[g],!(!o||o.v==null&&(!o.f||o.F))&&(s.push(" "+(o.w||(Vu(o),o.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:r,to_sheet:t,from_sheet:n}}();function JVe(t){var e=t.slice(t[0]==="#"?1:0).slice(0,6);return[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)]}function q1(t){for(var e=0,r=1;e!=3;++e)r=r*256+(t[e]>255?255:t[e]<0?0:t[e]);return r.toString(16).toUpperCase().slice(1)}function e6e(t){var e=t[0]/255,r=t[1]/255,n=t[2]/255,i=Math.max(e,r,n),s=Math.min(e,r,n),a=i-s;if(a===0)return[0,0,e];var o=0,u=0,c=i+s;switch(u=a/(c>1?2-c:c),i){case e:o=((r-n)/a+6)%6;break;case r:o=(n-e)/a+2;break;case n:o=(e-r)/a+4;break}return[o/6,u,c/2]}function t6e(t){var e=t[0],r=t[1],n=t[2],i=r*2*(n<.5?n:1-n),s=n-i/2,a=[s,s,s],o=6*e,u;if(r!==0)switch(o|0){case 0:case 6:u=i*o,a[0]+=i,a[1]+=u;break;case 1:u=i*(2-o),a[0]+=u,a[1]+=i;break;case 2:u=i*(o-2),a[1]+=i,a[2]+=u;break;case 3:u=i*(4-o),a[1]+=u,a[2]+=i;break;case 4:u=i*(o-4),a[2]+=i,a[0]+=u;break;case 5:u=i*(6-o),a[2]+=u,a[0]+=i;break}for(var c=0;c!=3;++c)a[c]=Math.round(a[c]*255);return a}function J_(t,e){if(e===0)return t;var r=e6e(JVe(t));return e<0?r[2]=r[2]*(1+e):r[2]=1-(1-r[2])*(1-e),q1(t6e(r))}var zre=6,r6e=15,n6e=1,Cs=zre;function K1(t){return Math.floor((t+Math.round(128/Cs)/256)*Cs)}function X1(t){return Math.floor((t-5)/Cs*100+.5)/100}function eR(t){return Math.round((t*Cs+5)/Cs*256)/256}function yI(t){return eR(X1(K1(t)))}function fB(t){var e=Math.abs(t-yI(t)),r=Cs;if(e>.005)for(Cs=n6e;Cs<r6e;++Cs)Math.abs(t-yI(t))<=e&&(e=Math.abs(t-yI(t)),r=Cs);Cs=r}function jf(t){t.width?(t.wpx=K1(t.width),t.wch=X1(t.wpx),t.MDW=Cs):t.wpx?(t.wch=X1(t.wpx),t.width=eR(t.wch),t.MDW=Cs):typeof t.wch=="number"&&(t.width=eR(t.wch),t.wpx=K1(t.width),t.MDW=Cs),t.customWidth&&delete t.customWidth}var i6e=96,Gre=i6e;function Q1(t){return t*96/Gre}function Vp(t){return t*Gre/96}var s6e={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function a6e(t,e,r,n){e.Borders=[];var i={},s=!1;(t[0].match(ks)||[]).forEach(function(a){var o=Ot(a);switch(Xu(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":i={},o.diagonalUp&&(i.diagonalUp=dn(o.diagonalUp)),o.diagonalDown&&(i.diagonalDown=dn(o.diagonalDown)),e.Borders.push(i);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in borders")}})}function o6e(t,e,r,n){e.Fills=[];var i={},s=!1;(t[0].match(ks)||[]).forEach(function(a){var o=Ot(a);switch(Xu(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":i={},e.Fills.push(i);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":e.Fills.push(i),i={};break;case"<patternFill":case"<patternFill>":o.patternType&&(i.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":i.bgColor||(i.bgColor={}),o.indexed&&(i.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(i.bgColor.theme=parseInt(o.theme,10)),o.tint&&(i.bgColor.tint=parseFloat(o.tint)),o.rgb&&(i.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":i.fgColor||(i.fgColor={}),o.theme&&(i.fgColor.theme=parseInt(o.theme,10)),o.tint&&(i.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(i.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fills")}})}function l6e(t,e,r,n){e.Fonts=[];var i={},s=!1;(t[0].match(ks)||[]).forEach(function(a){var o=Ot(a);switch(Xu(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":e.Fonts.push(i),i={};break;case"<name":o.val&&(i.name=Zr(o.val));break;case"<name/>":case"</name>":break;case"<b":i.bold=o.val?dn(o.val):1;break;case"<b/>":i.bold=1;break;case"<i":i.italic=o.val?dn(o.val):1;break;case"<i/>":i.italic=1;break;case"<u":switch(o.val){case"none":i.underline=0;break;case"single":i.underline=1;break;case"double":i.underline=2;break;case"singleAccounting":i.underline=33;break;case"doubleAccounting":i.underline=34;break}break;case"<u/>":i.underline=1;break;case"<strike":i.strike=o.val?dn(o.val):1;break;case"<strike/>":i.strike=1;break;case"<outline":i.outline=o.val?dn(o.val):1;break;case"<outline/>":i.outline=1;break;case"<shadow":i.shadow=o.val?dn(o.val):1;break;case"<shadow/>":i.shadow=1;break;case"<condense":i.condense=o.val?dn(o.val):1;break;case"<condense/>":i.condense=1;break;case"<extend":i.extend=o.val?dn(o.val):1;break;case"<extend/>":i.extend=1;break;case"<sz":o.val&&(i.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(i.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(i.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(i.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=L3[parseInt(o.val,10)];break;case"<color":if(i.color||(i.color={}),o.auto&&(i.color.auto=dn(o.auto)),o.rgb)i.color.rgb=o.rgb.slice(-6);else if(o.indexed){i.color.index=parseInt(o.indexed,10);var u=Rg[i.color.index];i.color.index==81&&(u=Rg[1]),u||(u=Rg[1]),i.color.rgb=u[0].toString(16)+u[1].toString(16)+u[2].toString(16)}else o.theme&&(i.color.theme=parseInt(o.theme,10),o.tint&&(i.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(i.color.rgb=J_(r.themeElements.clrScheme[i.color.theme].rgb,i.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fonts")}})}function u6e(t,e,r){e.NumberFmt=[];for(var n=Gn(xt),i=0;i<n.length;++i)e.NumberFmt[n[i]]=xt[n[i]];var s=t[0].match(ks);if(s)for(i=0;i<s.length;++i){var a=Ot(s[i]);switch(Xu(a[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=Cr(Zr(a.formatCode)),u=parseInt(a.numFmtId,10);if(e.NumberFmt[u]=o,u>0){if(u>392){for(u=392;u>60&&e.NumberFmt[u]!=null;--u);e.NumberFmt[u]=o}Hu(o,u)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+a[0]+" in numFmts")}}}function c6e(t){var e=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)t[n]!=null&&(e[e.length]=qe("numFmt",null,{numFmtId:n,formatCode:Gr(t[n])}))}),e.length===1?"":(e[e.length]="</numFmts>",e[0]=qe("numFmts",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var Kx=["numFmtId","fillId","fontId","borderId","xfId"],Xx=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function h6e(t,e,r){e.CellXf=[];var n,i=!1;(t[0].match(ks)||[]).forEach(function(s){var a=Ot(s),o=0;switch(Xu(a[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=a,delete n[0],o=0;o<Kx.length;++o)n[Kx[o]]&&(n[Kx[o]]=parseInt(n[Kx[o]],10));for(o=0;o<Xx.length;++o)n[Xx[o]]&&(n[Xx[o]]=dn(n[Xx[o]]));if(e.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(e.NumberFmt[n.numFmtId]==e.NumberFmt[o]){n.numFmtId=o;break}}e.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var u={};a.vertical&&(u.vertical=a.vertical),a.horizontal&&(u.horizontal=a.horizontal),a.textRotation!=null&&(u.textRotation=a.textRotation),a.indent&&(u.indent=a.indent),a.wrapText&&(u.wrapText=dn(a.wrapText)),n.alignment=u;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(r&&r.WTF&&!i)throw new Error("unrecognized "+a[0]+" in cellXfs")}})}function f6e(t){var e=[];return e[e.length]=qe("cellXfs",null),t.forEach(function(r){e[e.length]=qe("xf",null,r)}),e[e.length]="</cellXfs>",e.length===2?"":(e[0]=qe("cellXfs",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var d6e=function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,i=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,s=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,u,c){var f={};if(!o)return f;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var g;return(g=o.match(e))&&u6e(g,f,c),(g=o.match(i))&&l6e(g,f,u,c),(g=o.match(n))&&o6e(g,f,u,c),(g=o.match(s))&&a6e(g,f,u,c),(g=o.match(r))&&h6e(g,f,c),f}}();function qre(t,e){var r=[hi,qe("styleSheet",null,{xmlns:hm[0],"xmlns:vt":Pi.vt})],n;return t.SSF&&(n=c6e(t.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=f6e(e.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function g6e(t,e){var r=t.read_shift(2),n=Ts(t);return[r,n]}function m6e(t,e,r){r||(r=Fe(6+4*e.length)),r.write_shift(2,t),zi(e,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function p6e(t,e,r){var n={};n.sz=t.read_shift(2)/20;var i=Q4e(t);i.fItalic&&(n.italic=1),i.fCondense&&(n.condense=1),i.fExtend&&(n.extend=1),i.fShadow&&(n.shadow=1),i.fOutline&&(n.outline=1),i.fStrikeout&&(n.strike=1);var s=t.read_shift(2);switch(s===700&&(n.bold=1),t.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var a=t.read_shift(1);a!=0&&(n.underline=a);var o=t.read_shift(1);o>0&&(n.family=o);var u=t.read_shift(1);switch(u>0&&(n.charset=u),t.l++,n.color=X4e(t),t.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Ts(t),n}function v6e(t,e){e||(e=Fe(153)),e.write_shift(2,t.sz*20),Z4e(t,e),e.write_shift(2,t.bold?700:400);var r=0;t.vertAlign=="superscript"?r=1:t.vertAlign=="subscript"&&(r=2),e.write_shift(2,r),e.write_shift(1,t.underline||0),e.write_shift(1,t.family||0),e.write_shift(1,t.charset||0),e.write_shift(1,0),X_(t.color,e);var n=0;return n=2,e.write_shift(1,n),zi(t.name,e),e.length>e.l?e.slice(0,e.l):e}var w6e=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],SI,y6e=Os;function LG(t,e){e||(e=Fe(84)),SI||(SI=TT(w6e));var r=SI[t.patternType];r==null&&(r=40),e.write_shift(4,r);var n=0;if(r!=40)for(X_({auto:1},e),X_({auto:1},e);n<12;++n)e.write_shift(4,0);else{for(;n<4;++n)e.write_shift(4,0);for(;n<12;++n)e.write_shift(4,0)}return e.length>e.l?e.slice(0,e.l):e}function S6e(t,e){var r=t.l+e,n=t.read_shift(2),i=t.read_shift(2);return t.l=r,{ixfe:n,numFmtId:i}}function Kre(t,e,r){r||(r=Fe(16)),r.write_shift(2,e||0),r.write_shift(2,t.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function py(t,e){return e||(e=Fe(10)),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(4,0),e}var b6e=Os;function C6e(t,e){return e||(e=Fe(51)),e.write_shift(1,0),py(null,e),py(null,e),py(null,e),py(null,e),py(null,e),e.length>e.l?e.slice(0,e.l):e}function x6e(t,e){return e||(e=Fe(52)),e.write_shift(4,t.xfId),e.write_shift(2,1),e.write_shift(1,0),e.write_shift(1,0),K_(t.name||"",e),e.length>e.l?e.slice(0,e.l):e}function E6e(t,e,r){var n=Fe(2052);return n.write_shift(4,t),K_(e,n),K_(r,n),n.length>n.l?n.slice(0,n.l):n}function _6e(t,e,r){var n={};n.NumberFmt=[];for(var i in xt)n.NumberFmt[i]=xt[i];n.CellXf=[],n.Fonts=[];var s=[],a=!1;return gh(t,function(u,c,f){switch(f){case 44:n.NumberFmt[u[0]]=u[1],Hu(u[1],u[0]);break;case 43:n.Fonts.push(u),u.color.theme!=null&&e&&e.themeElements&&e.themeElements.clrScheme&&(u.color.rgb=J_(e.themeElements.clrScheme[u.color.theme].rgb,u.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:s[s.length-1]==617&&n.CellXf.push(u);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:s.push(f),a=!0;break;case 38:s.pop(),a=!1;break;default:if(c.T>0)s.push(f);else if(c.T<0)s.pop();else if(!a||r.WTF&&s[s.length-1]!=37)throw new Error("Unexpected record 0x"+f.toString(16))}}),n}function R6e(t,e){if(e){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&++r}),r!=0&&(Ue(t,615,Ol(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&Ue(t,44,m6e(i,e[i]))}),Ue(t,616))}}function T6e(t){var e=1;Ue(t,611,Ol(e)),Ue(t,43,v6e({sz:12,color:{theme:1},name:"Calibri",family:2})),Ue(t,612)}function M6e(t){var e=2;Ue(t,603,Ol(e)),Ue(t,45,LG({patternType:"none"})),Ue(t,45,LG({patternType:"gray125"})),Ue(t,604)}function A6e(t){var e=1;Ue(t,613,Ol(e)),Ue(t,46,C6e()),Ue(t,614)}function O6e(t){var e=1;Ue(t,626,Ol(e)),Ue(t,47,Kre({numFmtId:0},65535)),Ue(t,627)}function k6e(t,e){Ue(t,617,Ol(e.length)),e.forEach(function(r){Ue(t,47,Kre(r,0))}),Ue(t,618)}function D6e(t){var e=1;Ue(t,619,Ol(e)),Ue(t,48,x6e({xfId:0,name:"Normal"})),Ue(t,620)}function P6e(t){var e=0;Ue(t,505,Ol(e)),Ue(t,506)}function I6e(t){var e=0;Ue(t,508,E6e(e,"TableStyleMedium9","PivotStyleMedium4")),Ue(t,509)}function N6e(t,e){var r=ya();return Ue(r,278),R6e(r,t.SSF),T6e(r),M6e(r),A6e(r),O6e(r),k6e(r,e.cellXfs),D6e(r),P6e(r),I6e(r),Ue(r,279),r.end()}var H6e=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function F6e(t,e,r){e.themeElements.clrScheme=[];var n={};(t[0].match(ks)||[]).forEach(function(i){var s=Ot(i);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=s.val;break;case"<a:sysClr":n.rgb=s.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":s[0].charAt(1)==="/"?(e.themeElements.clrScheme[H6e.indexOf(s[0])]=n,n={}):n.name=s[0].slice(3,s[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}function L6e(){}function B6e(){}var V6e=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,W6e=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,$6e=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function U6e(t,e,r){e.themeElements={};var n;[["clrScheme",V6e,F6e],["fontScheme",W6e,L6e],["fmtScheme",$6e,B6e]].forEach(function(i){if(!(n=t.match(i[1])))throw new Error(i[0]+" not found in themeElements");i[2](n,e,r)})}var j6e=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function Xre(t,e){(!t||t.length===0)&&(t=dB());var r,n={};if(!(r=t.match(j6e)))throw new Error("themeElements not found in theme");return U6e(r[0],n,e),n.raw=t,n}function dB(t,e){if(e&&e.themeXLSX)return e.themeXLSX;if(t&&typeof t.raw=="string")return t.raw;var r=[hi];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function Y6e(t,e,r){var n=t.l+e,i=t.read_shift(4);if(i!==124226){if(!r.cellStyles){t.l=n;return}var s=t.slice(t.l);t.l=n;var a;try{a=zte(s,{type:"array"})}catch{return}var o=qa(a,"theme/theme/theme1.xml",!0);if(o)return Xre(o,r)}}function z6e(t){return t.read_shift(4)}function G6e(t){var e={};switch(e.xclrType=t.read_shift(2),e.nTintShade=t.read_shift(2),e.xclrType){case 0:t.l+=4;break;case 1:e.xclrValue=q6e(t,4);break;case 2:e.xclrValue=Are(t);break;case 3:e.xclrValue=z6e(t);break;case 4:t.l+=4;break}return t.l+=8,e}function q6e(t,e){return Os(t,e)}function K6e(t,e){return Os(t,e)}function X6e(t){var e=t.read_shift(2),r=t.read_shift(2)-4,n=[e];switch(e){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=G6e(t);break;case 6:n[1]=K6e(t,r);break;case 14:case 15:n[1]=t.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+e+" "+r)}return n}function Q6e(t,e){var r=t.l+e;t.l+=2;var n=t.read_shift(2);t.l+=2;for(var i=t.read_shift(2),s=[];i-- >0;)s.push(X6e(t,r-t.l));return{ixfe:n,ext:s}}function Z6e(t,e){e.forEach(function(r){r[0]})}function J6e(t,e){return{flags:t.read_shift(4),version:t.read_shift(4),name:Ts(t)}}function e8e(t){var e=Fe(12+2*t.name.length);return e.write_shift(4,t.flags),e.write_shift(4,t.version),zi(t.name,e),e.slice(0,e.l)}function t8e(t){for(var e=[],r=t.read_shift(4);r-- >0;)e.push([t.read_shift(4),t.read_shift(4)]);return e}function r8e(t){var e=Fe(4+8*t.length);e.write_shift(4,t.length);for(var r=0;r<t.length;++r)e.write_shift(4,t[r][0]),e.write_shift(4,t[r][1]);return e}function n8e(t,e){var r=Fe(8+2*e.length);return r.write_shift(4,t),zi(e,r),r.slice(0,r.l)}function i8e(t){return t.l+=4,t.read_shift(4)!=0}function s8e(t,e){var r=Fe(8);return r.write_shift(4,t),r.write_shift(4,1),r}function a8e(t,e,r){var n={Types:[],Cell:[],Value:[]},i=r||{},s=[],a=!1,o=2;return gh(t,function(u,c,f){switch(f){case 335:n.Types.push({name:u.name});break;case 51:u.forEach(function(g){o==1?n.Cell.push({type:n.Types[g[0]-1].name,index:g[1]}):o==0&&n.Value.push({type:n.Types[g[0]-1].name,index:g[1]})});break;case 337:o=u?1:0;break;case 338:o=2;break;case 35:s.push(f),a=!0;break;case 36:s.pop(),a=!1;break;default:if(!c.T){if(!a||i.WTF&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}}),n}function o8e(){var t=ya();return Ue(t,332),Ue(t,334,Ol(1)),Ue(t,335,e8e({name:"XLDAPR",version:12e4,flags:3496657072})),Ue(t,336),Ue(t,339,n8e(1,"XLDAPR")),Ue(t,52),Ue(t,35,Ol(514)),Ue(t,4096,Ol(0)),Ue(t,4097,ko(1)),Ue(t,36),Ue(t,53),Ue(t,340),Ue(t,337,s8e(1)),Ue(t,51,r8e([[1,0]])),Ue(t,338),Ue(t,333),t.end()}function l8e(t,e,r){var n={Types:[],Cell:[],Value:[]};if(!t)return n;var i=!1,s=2,a;return t.replace(ks,function(o){var u=Ot(o);switch(Xu(u[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:u.name});break;case"</metadataType>":break;case"<futureMetadata":for(var c=0;c<n.Types.length;++c)n.Types[c].name==u.name&&(a=n.Types[c]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":s==1?n.Cell.push({type:n.Types[u.t-1].name,index:+u.v}):s==0&&n.Value.push({type:n.Types[u.t-1].name,index:+u.v});break;case"</rc>":break;case"<cellMetadata":s=1;break;case"</cellMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"</valueMetadata>":s=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;case"<rvb":if(!a)break;a.offsets||(a.offsets=[]),a.offsets.push(+u.i);break;default:if(!i&&r.WTF)throw new Error("unrecognized "+u[0]+" in metadata")}return o}),n}function Qre(){var t=[hi];return t.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),t.join("")}function u8e(t){var e=[];if(!t)return e;var r=1;return(t.match(ks)||[]).forEach(function(n){var i=Ot(n);switch(i[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete i[0],i.i?r=i.i:i.i=r,e.push(i);break}}),e}function c8e(t){var e={};e.i=t.read_shift(4);var r={};r.r=t.read_shift(4),r.c=t.read_shift(4),e.r=Tt(r);var n=t.read_shift(1);return n&2&&(e.l="1"),n&8&&(e.a="1"),e}function h8e(t,e,r){var n=[];return gh(t,function(s,a,o){switch(o){case 63:n.push(s);break;default:if(!a.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}function f8e(t,e,r,n){if(!t)return t;var i=n||{},s=!1;gh(t,function(o,u,c){switch(c){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!u.T){if(!s||i.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}},i)}function d8e(t,e){if(!t)return"??";var r=(t.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return e["!id"][r].Target}var op=1024;function Zre(t,e){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),i=[qe("xml",null,{"xmlns:v":za.v,"xmlns:o":za.o,"xmlns:x":za.x,"xmlns:mv":za.mv}).replace(/\/>/,">"),qe("o:shapelayout",qe("o:idmap",null,{"v:ext":"edit",data:t}),{"v:ext":"edit"}),qe("v:shapetype",[qe("v:stroke",null,{joinstyle:"miter"}),qe("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];op<t*1e3;)op+=1e3;return e.forEach(function(s){var a=Dn(s[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var u=o.type=="gradient"?qe("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,c=qe("v:fill",u,o),f={on:"t",obscured:"t"};++op,i=i.concat(["<v:shape"+Y1({id:"_x0000_s"+op,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",c,qe("v:shadow",null,f),qe("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",is("x:Anchor",[a.c+1,0,a.r+1,0,a.c+3,20,a.r+5,20].join(",")),is("x:AutoFill","False"),is("x:Row",String(a.r)),is("x:Column",String(a.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),i.push("</xml>"),i.join("")}function BG(t,e,r,n){var i=Array.isArray(t),s;e.forEach(function(a){var o=Dn(a.ref);if(i?(t[o.r]||(t[o.r]=[]),s=t[o.r][o.c]):s=t[a.ref],!s){s={t:"z"},i?t[o.r][o.c]=s:t[a.ref]=s;var u=ar(t["!ref"]||"BDWGO1000001:A1");u.s.r>o.r&&(u.s.r=o.r),u.e.r<o.r&&(u.e.r=o.r),u.s.c>o.c&&(u.s.c=o.c),u.e.c<o.c&&(u.e.c=o.c);var c=Ht(u);c!==t["!ref"]&&(t["!ref"]=c)}s.c||(s.c=[]);var f={a:a.author,t:a.t,r:a.r,T:r};a.h&&(f.h=a.h);for(var g=s.c.length-1;g>=0;--g){if(!r&&s.c[g].T)return;r&&!s.c[g].T&&s.c.splice(g,1)}if(r&&n){for(g=0;g<n.length;++g)if(f.a==n[g].id){f.a=n[g].name||f.a;break}}s.c.push(f)})}function g8e(t,e){if(t.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],i=t.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);i&&i[1]&&i[1].split(/<\/\w*:?author>/).forEach(function(a){if(!(a===""||a.trim()==="")){var o=a.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&r.push(o[1])}});var s=t.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(a){if(!(a===""||a.trim()==="")){var o=a.match(/<(?:\w+:)?comment[^>]*>/);if(o){var u=Ot(o[0]),c={author:u.authorId&&r[u.authorId]||"sheetjsghost",ref:u.ref,guid:u.guid},f=Dn(u.ref);if(!(e.sheetRows&&e.sheetRows<=f.r)){var g=a.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),m=!!g&&!!g[1]&&cB(g[1])||{r:"",t:"",h:""};c.r=m.r,m.r=="<t></t>"&&(m.t=m.h=""),c.t=(m.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.cellHTML&&(c.h=m.h),n.push(c)}}}}),n}function Jre(t){var e=[hi,qe("comments",null,{xmlns:hm[0]})],r=[];return e.push("<authors>"),t.forEach(function(n){n[1].forEach(function(i){var s=Gr(i.a);r.indexOf(s)==-1&&(r.push(s),e.push("<author>"+s+"</author>")),i.T&&i.ID&&r.indexOf("tc="+i.ID)==-1&&(r.push("tc="+i.ID),e.push("<author>tc="+i.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),e.push("<author>SheetJ5</author>")),e.push("</authors>"),e.push("<commentList>"),t.forEach(function(n){var i=0,s=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?i=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(u){u.a&&(i=r.indexOf(Gr(u.a))),s.push(u.t||"")}),e.push('<comment ref="'+n[0]+'" authorId="'+i+'"><text>'),s.length<=1)e.push(is("t",Gr(s[0]||"")));else{for(var a=`Comment:
    `+s[0]+`
`,o=1;o<s.length;++o)a+=`Reply:
    `+s[o]+`
`;e.push(is("t",Gr(a)))}e.push("</text></comment>")}),e.push("</commentList>"),e.length>2&&(e[e.length]="</comments>",e[1]=e[1].replace("/>",">")),e.join("")}function m8e(t,e){var r=[],n=!1,i={},s=0;return t.replace(ks,function(o,u){var c=Ot(o);switch(Xu(c[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":i={author:c.personId,guid:c.id,ref:c.ref,T:1};break;case"</threadedComment>":i.t!=null&&r.push(i);break;case"<text>":case"<text":s=u+o.length;break;case"</text>":i.t=t.slice(s,u).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+c[0]+" in threaded comments")}return o}),r}function p8e(t,e,r){var n=[hi,qe("ThreadedComments",null,{xmlns:Pi.TCMNT}).replace(/[\/]>/,">")];return t.forEach(function(i){var s="";(i[1]||[]).forEach(function(a,o){if(!a.T){delete a.ID;return}a.a&&e.indexOf(a.a)==-1&&e.push(a.a);var u={ref:i[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};o==0?s=u.id:u.parentId=s,a.ID=u.id,a.a&&(u.personId="{54EE7950-7262-4200-6969-"+("000000000000"+e.indexOf(a.a)).slice(-12)+"}"),n.push(qe("threadedComment",is("text",a.t||""),u))})}),n.push("</ThreadedComments>"),n.join("")}function v8e(t,e){var r=[],n=!1;return t.replace(ks,function(s){var a=Ot(s);switch(Xu(a[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:a.displayname,id:a.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+a[0]+" in threaded comments")}return s}),r}function w8e(t){var e=[hi,qe("personList",null,{xmlns:Pi.TCMNT,"xmlns:x":hm[0]}).replace(/[\/]>/,">")];return t.forEach(function(r,n){e.push(qe("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),e.push("</personList>"),e.join("")}function y8e(t){var e={};e.iauthor=t.read_shift(4);var r=mm(t);return e.rfx=r.s,e.ref=Tt(r.s),t.l+=16,e}function S8e(t,e){return e==null&&(e=Fe(36)),e.write_shift(4,t[1].iauthor),mv(t[0],e),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e}var b8e=Ts;function C8e(t){return zi(t.slice(0,54))}function x8e(t,e){var r=[],n=[],i={},s=!1;return gh(t,function(o,u,c){switch(c){case 632:n.push(o);break;case 635:i=o;break;case 637:i.t=o.t,i.h=o.h,i.r=o.r;break;case 636:if(i.author=n[i.iauthor],delete i.iauthor,e.sheetRows&&i.rfx&&e.sheetRows<=i.rfx.r)break;i.t||(i.t=""),delete i.rfx,r.push(i);break;case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!u.T){if(!s||e.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}}),r}function E8e(t){var e=ya(),r=[];return Ue(e,628),Ue(e,630),t.forEach(function(n){n[1].forEach(function(i){r.indexOf(i.a)>-1||(r.push(i.a.slice(0,54)),Ue(e,632,C8e(i.a)))})}),Ue(e,631),Ue(e,633),t.forEach(function(n){n[1].forEach(function(i){i.iauthor=r.indexOf(i.a);var s={s:Dn(n[0]),e:Dn(n[0])};Ue(e,635,S8e([s,i])),i.t&&i.t.length>0&&Ue(e,637,z4e(i)),Ue(e,636),delete i.iauthor})}),Ue(e,634),Ue(e,629),e.end()}var _8e="application/vnd.ms-office.vbaProject";function R8e(t){var e=vt.utils.cfb_new({root:"R"});return t.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var i=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");vt.utils.cfb_add(e,i,t.FileIndex[n].content)}}),vt.write(e)}function T8e(t,e){e.FullPaths.forEach(function(r,n){if(n!=0){var i=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");i.slice(-1)!=="/"&&vt.utils.cfb_add(t,i,e.FileIndex[n].content)}})}var ene=["xlsb","xlsm","xlam","biff8","xla"];function M8e(){return{"!type":"dialog"}}function A8e(){return{"!type":"dialog"}}function O8e(){return{"!type":"macro"}}function k8e(){return{"!type":"macro"}}var Sp=function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function r(n,i,s,a){var o=!1,u=!1;s.length==0?u=!0:s.charAt(0)=="["&&(u=!0,s=s.slice(1,-1)),a.length==0?o=!0:a.charAt(0)=="["&&(o=!0,a=a.slice(1,-1));var c=s.length>0?parseInt(s,10)|0:0,f=a.length>0?parseInt(a,10)|0:0;return o?f+=e.c:--f,u?c+=e.r:--c,i+(o?"":"$")+mn(f)+(u?"":"$")+jn(c)}return function(i,s){return e=s,i.replace(t,r)}}(),gB=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,mB=function(){return function(e,r){return e.replace(gB,function(n,i,s,a,o,u){var c=tB(a)-(s?0:r.c),f=eB(u)-(o?0:r.r),g=f==0?"":o?f+1:"["+f+"]",m=c==0?"":s?c+1:"["+c+"]";return i+"R"+g+"C"+m})}}();function tne(t,e){return t.replace(gB,function(r,n,i,s,a,o){return n+(i=="$"?i+s:mn(tB(s)+e.c))+(a=="$"?a+o:jn(eB(o)+e.r))})}function D8e(t,e,r){var n=Ks(e),i=n.s,s=Dn(r),a={r:s.r-i.r,c:s.c-i.c};return tne(t,a)}function P8e(t){return t.length!=1}function VG(t){return t.replace(/_xlfn\./g,"")}function pi(t){t.l+=1}function Yf(t,e){var r=t.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function rne(t,e,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return nne(t);r.biff==12&&(n=4)}var i=t.read_shift(n),s=t.read_shift(n),a=Yf(t),o=Yf(t);return{s:{r:i,c:a[0],cRel:a[1],rRel:a[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function nne(t){var e=Yf(t),r=Yf(t),n=t.read_shift(1),i=t.read_shift(1);return{s:{r:e[0],c:n,cRel:e[1],rRel:e[2]},e:{r:r[0],c:i,cRel:r[1],rRel:r[2]}}}function I8e(t,e,r){if(r.biff<8)return nne(t);var n=t.read_shift(r.biff==12?4:2),i=t.read_shift(r.biff==12?4:2),s=Yf(t),a=Yf(t);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:a[0],cRel:a[1],rRel:a[2]}}}function ine(t,e,r){if(r&&r.biff>=2&&r.biff<=5)return N8e(t);var n=t.read_shift(r&&r.biff==12?4:2),i=Yf(t);return{r:n,c:i[0],cRel:i[1],rRel:i[2]}}function N8e(t){var e=Yf(t),r=t.read_shift(1);return{r:e[0],c:r,cRel:e[1],rRel:e[2]}}function H8e(t){var e=t.read_shift(2),r=t.read_shift(2);return{r:e,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function F8e(t,e,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return L8e(t);var i=t.read_shift(n>=12?4:2),s=t.read_shift(2),a=(s&16384)>>14,o=(s&32768)>>15;if(s&=16383,o==1)for(;i>524287;)i-=1048576;if(a==1)for(;s>8191;)s=s-16384;return{r:i,c:s,cRel:a,rRel:o}}function L8e(t){var e=t.read_shift(2),r=t.read_shift(1),n=(e&32768)>>15,i=(e&16384)>>14;return e&=16383,n==1&&e>=8192&&(e=e-16384),i==1&&r>=128&&(r=r-256),{r:e,c:r,cRel:i,rRel:n}}function B8e(t,e,r){var n=(t[t.l++]&96)>>5,i=rne(t,r.biff>=2&&r.biff<=5?6:8,r);return[n,i]}function V8e(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2,"i"),s=8;if(r)switch(r.biff){case 5:t.l+=12,s=6;break;case 12:s=12;break}var a=rne(t,s,r);return[n,i,a]}function W8e(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function $8e(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2),s=8;if(r)switch(r.biff){case 5:t.l+=12,s=6;break;case 12:s=12;break}return t.l+=s,[n,i]}function U8e(t,e,r){var n=(t[t.l++]&96)>>5,i=I8e(t,e-1,r);return[n,i]}function j8e(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r.biff==2?6:r.biff==12?14:7,[n]}function WG(t){var e=t[t.l+1]&1,r=1;return t.l+=4,[e,r]}function Y8e(t,e,r){t.l+=2;for(var n=t.read_shift(r&&r.biff==2?1:2),i=[],s=0;s<=n;++s)i.push(t.read_shift(r&&r.biff==2?1:2));return i}function z8e(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function G8e(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function q8e(t){var e=t[t.l+1]&255?1:0;return t.l+=2,[e,t.read_shift(2)]}function K8e(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=r&&r.biff==2?3:4,[n]}function sne(t){var e=t.read_shift(1),r=t.read_shift(1);return[e,r]}function X8e(t){return t.read_shift(2),sne(t)}function Q8e(t){return t.read_shift(2),sne(t)}function Z8e(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=ine(t,0,r);return[n,i]}function J8e(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=F8e(t,0,r);return[n,i]}function eWe(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=t.read_shift(2);r&&r.biff==5&&(t.l+=12);var s=ine(t,0,r);return[n,i,s]}function tWe(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=t.read_shift(r&&r.biff<=3?1:2);return[i$e[i],lne[i],n]}function rWe(t,e,r){var n=t[t.l++],i=t.read_shift(1),s=r&&r.biff<=3?[n==88?-1:0,t.read_shift(1)]:nWe(t);return[i,(s[0]===0?lne:n$e)[s[1]]]}function nWe(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function iWe(t,e,r){t.l+=r&&r.biff==2?3:4}function sWe(t,e,r){if(t.l++,r&&r.biff==12)return[t.read_shift(4,"i"),0];var n=t.read_shift(2),i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function aWe(t){return t.l++,mh[t.read_shift(1)]}function oWe(t){return t.l++,t.read_shift(2)}function lWe(t){return t.l++,t.read_shift(1)!==0}function uWe(t){return t.l++,xs(t)}function cWe(t,e,r){return t.l++,WS(t,e-1,r)}function hWe(t,e){var r=[t.read_shift(1)];if(e==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=ei(t,1)?"TRUE":"FALSE",e!=12&&(t.l+=7);break;case 37:case 16:r[1]=mh[t[t.l]],t.l+=e==12?4:8;break;case 0:t.l+=8;break;case 1:r[1]=xs(t);break;case 2:r[1]=pm(t,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function fWe(t,e,r){for(var n=t.read_shift(r.biff==12?4:2),i=[],s=0;s!=n;++s)i.push((r.biff==12?mm:kT)(t));return i}function dWe(t,e,r){var n=0,i=0;r.biff==12?(n=t.read_shift(4),i=t.read_shift(4)):(i=1+t.read_shift(1),n=1+t.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--i==0&&(i=256));for(var s=0,a=[];s!=n&&(a[s]=[]);++s)for(var o=0;o!=i;++o)a[s][o]=hWe(t,r.biff);return a}function gWe(t,e,r){var n=t.read_shift(1)>>>5&3,i=!r||r.biff>=8?4:2,s=t.read_shift(i);switch(r.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[n,0,s]}function mWe(t,e,r){if(r.biff==5)return pWe(t);var n=t.read_shift(1)>>>5&3,i=t.read_shift(2),s=t.read_shift(4);return[n,i,s]}function pWe(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2,"i");t.l+=8;var n=t.read_shift(2);return t.l+=12,[e,r,n]}function vWe(t,e,r){var n=t.read_shift(1)>>>5&3;t.l+=r&&r.biff==2?3:4;var i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function wWe(t,e,r){var n=t.read_shift(1)>>>5&3,i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function yWe(t,e,r){var n=t.read_shift(1)>>>5&3;return t.l+=4,r.biff<8&&t.l--,r.biff==12&&(t.l+=2),[n]}function SWe(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6;break}return t.l+=s,[n,i]}var bWe=Os,CWe=Os,xWe=Os;function US(t,e,r){return t.l+=2,[H8e(t)]}function pB(t){return t.l+=6,[]}var EWe=US,_We=pB,RWe=pB,TWe=US;function ane(t){return t.l+=2,[Si(t),t.read_shift(2)&1]}var MWe=US,AWe=ane,OWe=pB,kWe=US,DWe=US,PWe=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function IWe(t){t.l+=2;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),i=t.read_shift(2),s=t.read_shift(2),a=PWe[r>>2&31];return{ixti:e,coltype:r&3,rt:a,idx:n,c:i,C:s}}function NWe(t){return t.l+=2,[t.read_shift(4)]}function HWe(t,e,r){return t.l+=5,t.l+=2,t.l+=r.biff==2?1:4,["PTGSHEET"]}function FWe(t,e,r){return t.l+=r.biff==2?4:5,["PTGENDSHEET"]}function LWe(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function BWe(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function VWe(t){return t.l+=4,[0,0]}var $G={1:{n:"PtgExp",f:sWe},2:{n:"PtgTbl",f:xWe},3:{n:"PtgAdd",f:pi},4:{n:"PtgSub",f:pi},5:{n:"PtgMul",f:pi},6:{n:"PtgDiv",f:pi},7:{n:"PtgPower",f:pi},8:{n:"PtgConcat",f:pi},9:{n:"PtgLt",f:pi},10:{n:"PtgLe",f:pi},11:{n:"PtgEq",f:pi},12:{n:"PtgGe",f:pi},13:{n:"PtgGt",f:pi},14:{n:"PtgNe",f:pi},15:{n:"PtgIsect",f:pi},16:{n:"PtgUnion",f:pi},17:{n:"PtgRange",f:pi},18:{n:"PtgUplus",f:pi},19:{n:"PtgUminus",f:pi},20:{n:"PtgPercent",f:pi},21:{n:"PtgParen",f:pi},22:{n:"PtgMissArg",f:pi},23:{n:"PtgStr",f:cWe},26:{n:"PtgSheet",f:HWe},27:{n:"PtgEndSheet",f:FWe},28:{n:"PtgErr",f:aWe},29:{n:"PtgBool",f:lWe},30:{n:"PtgInt",f:oWe},31:{n:"PtgNum",f:uWe},32:{n:"PtgArray",f:j8e},33:{n:"PtgFunc",f:tWe},34:{n:"PtgFuncVar",f:rWe},35:{n:"PtgName",f:gWe},36:{n:"PtgRef",f:Z8e},37:{n:"PtgArea",f:B8e},38:{n:"PtgMemArea",f:vWe},39:{n:"PtgMemErr",f:bWe},40:{n:"PtgMemNoMem",f:CWe},41:{n:"PtgMemFunc",f:wWe},42:{n:"PtgRefErr",f:yWe},43:{n:"PtgAreaErr",f:W8e},44:{n:"PtgRefN",f:J8e},45:{n:"PtgAreaN",f:U8e},46:{n:"PtgMemAreaN",f:LWe},47:{n:"PtgMemNoMemN",f:BWe},57:{n:"PtgNameX",f:mWe},58:{n:"PtgRef3d",f:eWe},59:{n:"PtgArea3d",f:V8e},60:{n:"PtgRefErr3d",f:SWe},61:{n:"PtgAreaErr3d",f:$8e},255:{}},WWe={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},$We={1:{n:"PtgElfLel",f:ane},2:{n:"PtgElfRw",f:kWe},3:{n:"PtgElfCol",f:EWe},6:{n:"PtgElfRwV",f:DWe},7:{n:"PtgElfColV",f:TWe},10:{n:"PtgElfRadical",f:MWe},11:{n:"PtgElfRadicalS",f:OWe},13:{n:"PtgElfColS",f:_We},15:{n:"PtgElfColSV",f:RWe},16:{n:"PtgElfRadicalLel",f:AWe},25:{n:"PtgList",f:IWe},29:{n:"PtgSxName",f:NWe},255:{}},UWe={0:{n:"PtgAttrNoop",f:VWe},1:{n:"PtgAttrSemi",f:K8e},2:{n:"PtgAttrIf",f:G8e},4:{n:"PtgAttrChoose",f:Y8e},8:{n:"PtgAttrGoto",f:z8e},16:{n:"PtgAttrSum",f:iWe},32:{n:"PtgAttrBaxcel",f:WG},33:{n:"PtgAttrBaxcel",f:WG},64:{n:"PtgAttrSpace",f:X8e},65:{n:"PtgAttrSpaceSemi",f:Q8e},128:{n:"PtgAttrIfError",f:q8e},255:{}};function jS(t,e,r,n){if(n.biff<8)return Os(t,e);for(var i=t.l+e,s=[],a=0;a!==r.length;++a)switch(r[a][0]){case"PtgArray":r[a][1]=dWe(t,0,n),s.push(r[a][1]);break;case"PtgMemArea":r[a][2]=fWe(t,r[a][1],n),s.push(r[a][2]);break;case"PtgExp":n&&n.biff==12&&(r[a][1][1]=t.read_shift(4),s.push(r[a][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[a][0]}return e=i-t.l,e!==0&&s.push(Os(t,e)),s}function YS(t,e,r){for(var n=t.l+e,i,s,a=[];n!=t.l;)e=n-t.l,s=t[t.l],i=$G[s]||$G[WWe[s]],(s===24||s===25)&&(i=(s===24?$We:UWe)[t[t.l+1]]),!i||!i.f?Os(t,e):a.push([i.n,i.f(t,e,r)]);return a}function jWe(t){for(var e=[],r=0;r<t.length;++r){for(var n=t[r],i=[],s=0;s<n.length;++s){var a=n[s];if(a)switch(a[0]){case 2:i.push('"'+a[1].replace(/"/g,'""')+'"');break;default:i.push(a[1])}else i.push("")}e.push(i.join(","))}return e.join(";")}var YWe={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function zWe(t,e){if(!t&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function one(t,e,r){if(!t)return"SH33TJSERR0";if(r.biff>8&&(!t.XTI||!t.XTI[e]))return t.SheetNames[e];if(!t.XTI)return"SH33TJSERR6";var n=t.XTI[e];if(r.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":t.XTI[e-1];if(!n)return"SH33TJSERR1";var i="";if(r.biff>8)switch(t[n[0]][0]){case 357:return i=n[1]==-1?"#REF":t.SheetNames[n[1]],n[1]==n[2]?i:i+":"+t.SheetNames[n[2]];case 358:return r.SID!=null?t.SheetNames[r.SID]:"SH33TJSSAME"+t[n[0]][0];case 355:default:return"SH33TJSSRC"+t[n[0]][0]}switch(t[n[0]][0][0]){case 1025:return i=n[1]==-1?"#REF":t.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?i:i+":"+t.SheetNames[n[2]];case 14849:return t[n[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return t[n[0]][0][3]?(i=n[1]==-1?"#REF":t[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?i:i+":"+t[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function UG(t,e,r){var n=one(t,e,r);return n=="#REF"?n:zWe(n,r)}function ys(t,e,r,n,i){var s=i&&i.biff||8,a={s:{c:0,r:0}},o=[],u,c,f,g=0,m=0,v,w="";if(!t[0]||!t[0][0])return"";for(var y=-1,b="",x=0,_=t[0].length;x<_;++x){var T=t[0][x];switch(T[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(u=o.pop(),c=o.pop(),y>=0){switch(t[0][y][1][0]){case 0:b=$n(" ",t[0][y][1][1]);break;case 1:b=$n("\r",t[0][y][1][1]);break;default:if(b="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][y][1][0])}c=c+b,y=-1}o.push(c+YWe[T[0]]+u);break;case"PtgIsect":u=o.pop(),c=o.pop(),o.push(c+" "+u);break;case"PtgUnion":u=o.pop(),c=o.pop(),o.push(c+","+u);break;case"PtgRange":u=o.pop(),c=o.pop(),o.push(c+":"+u);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":f=i1(T[1][1],a,i),o.push(s1(f,s));break;case"PtgRefN":f=r?i1(T[1][1],r,i):T[1][1],o.push(s1(f,s));break;case"PtgRef3d":g=T[1][1],f=i1(T[1][2],a,i),w=UG(n,g,i),o.push(w+"!"+s1(f,s));break;case"PtgFunc":case"PtgFuncVar":var D=T[1][0],P=T[1][1];D||(D=0),D&=127;var O=D==0?[]:o.slice(-D);o.length-=D,P==="User"&&(P=O.shift()),o.push(P+"("+O.join(",")+")");break;case"PtgBool":o.push(T[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(T[1]);break;case"PtgNum":o.push(String(T[1]));break;case"PtgStr":o.push('"'+T[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(T[1]);break;case"PtgAreaN":v=wG(T[1][1],r?{s:r}:a,i),o.push(pI(v,i));break;case"PtgArea":v=wG(T[1][1],a,i),o.push(pI(v,i));break;case"PtgArea3d":g=T[1][1],v=T[1][2],w=UG(n,g,i),o.push(w+"!"+pI(v,i));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":m=T[1][2];var A=(n.names||[])[m-1]||(n[0]||[])[m],W=A?A.Name:"SH33TJSNAME"+String(m);W&&W.slice(0,6)=="_xlfn."&&!i.xlfn&&(W=W.slice(6)),o.push(W);break;case"PtgNameX":var L=T[1][1];m=T[1][2];var H;if(i.biff<=5)L<0&&(L=-L),n[L]&&(H=n[L][m]);else{var J="";if(((n[L]||[])[0]||[])[0]==14849||(((n[L]||[])[0]||[])[0]==1025?n[L][m]&&n[L][m].itab>0&&(J=n.SheetNames[n[L][m].itab-1]+"!"):J=n.SheetNames[m-1]+"!"),n[L]&&n[L][m])J+=n[L][m].Name;else if(n[0]&&n[0][m])J+=n[0][m].Name;else{var G=(one(n,L,i)||"").split(";;");G[m-1]?J=G[m-1]:J+="SH33TJSERRX"}o.push(J);break}H||(H={Name:"SH33TJSERRY"}),o.push(H.Name);break;case"PtgParen":var ve="(",be=")";if(y>=0){switch(b="",t[0][y][1][0]){case 2:ve=$n(" ",t[0][y][1][1])+ve;break;case 3:ve=$n("\r",t[0][y][1][1])+ve;break;case 4:be=$n(" ",t[0][y][1][1])+be;break;case 5:be=$n("\r",t[0][y][1][1])+be;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][y][1][0])}y=-1}o.push(ve+o.pop()+be);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":f={c:T[1][1],r:T[1][0]};var we={c:r.c,r:r.r};if(n.sharedf[Tt(f)]){var ae=n.sharedf[Tt(f)];o.push(ys(ae,a,we,n,i))}else{var le=!1;for(u=0;u!=n.arrayf.length;++u)if(c=n.arrayf[u],!(f.c<c[0].s.c||f.c>c[0].e.c)&&!(f.r<c[0].s.r||f.r>c[0].e.r)){o.push(ys(c[1],a,we,n,i)),le=!0;break}le||o.push(T[1])}break;case"PtgArray":o.push("{"+jWe(T[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":y=x;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+T[1].idx+"[#"+T[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(T));default:throw new Error("Unrecognized Formula Token: "+String(T))}var Te=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&y>=0&&Te.indexOf(t[0][x][0])==-1){T=t[0][y];var ce=!0;switch(T[1][0]){case 4:ce=!1;case 0:b=$n(" ",T[1][1]);break;case 5:ce=!1;case 1:b=$n("\r",T[1][1]);break;default:if(b="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+T[1][0])}o.push((ce?b:"")+o.pop()+(ce?"":b)),y=-1}}if(o.length>1&&i.WTF)throw new Error("bad formula stack");return o[0]}function GWe(t,e,r){var n=t.l+e,i=r.biff==2?1:2,s,a=t.read_shift(i);if(a==65535)return[[],Os(t,e-2)];var o=YS(t,a,r);return e!==a+i&&(s=jS(t,e-a-i,o,r)),t.l=n,[o,s]}function qWe(t,e,r){var n=t.l+e,i=r.biff==2?1:2,s,a=t.read_shift(i);if(a==65535)return[[],Os(t,e-2)];var o=YS(t,a,r);return e!==a+i&&(s=jS(t,e-a-i,o,r)),t.l=n,[o,s]}function KWe(t,e,r,n){var i=t.l+e,s=YS(t,n,r),a;return i!==t.l&&(a=jS(t,i-t.l,s,r)),[s,a]}function XWe(t,e,r){var n=t.l+e,i,s=t.read_shift(2),a=YS(t,s,r);return s==65535?[[],Os(t,e-2)]:(e!==s+2&&(i=jS(t,n-s-2,a,r)),[a,i])}function QWe(t){var e;if(Uc(t,t.l+6)!==65535)return[xs(t),"n"];switch(t[t.l]){case 0:return t.l+=8,["String","s"];case 1:return e=t[t.l+2]===1,t.l+=8,[e,"b"];case 2:return e=t[t.l+2],t.l+=8,[e,"e"];case 3:return t.l+=8,["","s"]}return[]}function ZWe(t){if(t==null){var e=Fe(8);return e.write_shift(1,3),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,65535),e}else if(typeof t=="number")return jg(t);return jg(0)}function bI(t,e,r){var n=t.l+e,i=Qu(t);r.biff==2&&++t.l;var s=QWe(t),a=t.read_shift(1);r.biff!=2&&(t.read_shift(1),r.biff>=5&&t.read_shift(4));var o=qWe(t,n-t.l,r);return{cell:i,val:s[0],formula:o,shared:a>>3&1,tt:s[1]}}function JWe(t,e,r,n,i){var s=zg(e,r,i),a=ZWe(t.v),o=Fe(6),u=33;o.write_shift(2,u),o.write_shift(4,0);for(var c=Fe(t.bf.length),f=0;f<t.bf.length;++f)c[f]=t.bf[f];var g=Yi([s,a,o,c]);return g}function DT(t,e,r){var n=t.read_shift(4),i=YS(t,n,r),s=t.read_shift(4),a=s>0?jS(t,s,i,r):null;return[i,a]}var e$e=DT,PT=DT,t$e=DT,r$e=DT,n$e={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},lne={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},i$e={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function jG(t){return t.slice(0,3)=="of:"&&(t=t.slice(3)),t.charCodeAt(0)==61&&(t=t.slice(1),t.charCodeAt(0)==61&&(t=t.slice(1))),t=t.replace(/COM\.MICROSOFT\./g,""),t=t.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,r){return r.replace(/\./g,"")}),t=t.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),t.replace(/[;~]/g,",").replace(/\|/g,";")}function s$e(t){var e="of:="+t.replace(gB,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return e.replace(/;/g,"|").replace(/,/g,";")}function CI(t){var e=t.split(":"),r=e[0].split(".")[0];return[r,e[0].split(".")[1]+(e.length>1?":"+(e[1].split(".")[1]||e[1].split(".")[0]):"")]}function a$e(t){return t.replace(/\./,"!")}var o1={},bp={},l1=typeof Map<"u";function vB(t,e,r){var n=0,i=t.length;if(r){if(l1?r.has(e):Object.prototype.hasOwnProperty.call(r,e)){for(var s=l1?r.get(e):r[e];n<s.length;++n)if(t[s[n]].t===e)return t.Count++,s[n]}}else for(;n<i;++n)if(t[n].t===e)return t.Count++,n;return t[i]={t:e},t.Count++,t.Unique++,r&&(l1?(r.has(e)||r.set(e,[]),r.get(e).push(i)):(Object.prototype.hasOwnProperty.call(r,e)||(r[e]=[]),r[e].push(i))),i}function IT(t,e){var r={min:t+1,max:t+1},n=-1;return e.MDW&&(Cs=e.MDW),e.width!=null?r.customWidth=1:e.wpx!=null?n=X1(e.wpx):e.wch!=null&&(n=e.wch),n>-1?(r.width=eR(n),r.customWidth=1):e.width!=null&&(r.width=e.width),e.hidden&&(r.hidden=!0),e.level!=null&&(r.outlineLevel=r.level=e.level),r}function Ag(t,e){if(t){var r=[.7,.7,.75,.75,.3,.3];e=="xlml"&&(r=[1,1,1,1,.5,.5]),t.left==null&&(t.left=r[0]),t.right==null&&(t.right=r[1]),t.top==null&&(t.top=r[2]),t.bottom==null&&(t.bottom=r[3]),t.header==null&&(t.header=r[4]),t.footer==null&&(t.footer=r[5])}}function nd(t,e,r){var n=r.revssf[e.z!=null?e.z:"General"],i=60,s=t.length;if(n==null&&r.ssf){for(;i<392;++i)if(r.ssf[i]==null){Hu(e.z,i),r.ssf[i]=e.z,r.revssf[e.z]=n=i;break}}for(i=0;i!=s;++i)if(t[i].numFmtId===n)return i;return t[s]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function une(t,e,r,n,i,s){try{n.cellNF&&(t.z=xt[e])}catch(o){if(n.WTF)throw o}if(!(t.t==="z"&&!n.cellStyles)){if(t.t==="d"&&typeof t.v=="string"&&(t.v=pn(t.v)),(!n||n.cellText!==!1)&&t.t!=="z")try{if(xt[e]==null&&Hu(r4e[e]||"General",e),t.t==="e")t.w=t.w||mh[t.v];else if(e===0)if(t.t==="n")(t.v|0)===t.v?t.w=t.v.toString(10):t.w=U1(t.v);else if(t.t==="d"){var a=Hi(t.v);(a|0)===a?t.w=a.toString(10):t.w=U1(a)}else{if(t.v===void 0)return"";t.w=$g(t.v,bp)}else t.t==="d"?t.w=Ja(e,Hi(t.v),bp):t.w=Ja(e,t.v,bp)}catch(o){if(n.WTF)throw o}if(n.cellStyles&&r!=null)try{t.s=s.Fills[r],t.s.fgColor&&t.s.fgColor.theme&&!t.s.fgColor.rgb&&(t.s.fgColor.rgb=J_(i.themeElements.clrScheme[t.s.fgColor.theme].rgb,t.s.fgColor.tint||0),n.WTF&&(t.s.fgColor.raw_rgb=i.themeElements.clrScheme[t.s.fgColor.theme].rgb)),t.s.bgColor&&t.s.bgColor.theme&&(t.s.bgColor.rgb=J_(i.themeElements.clrScheme[t.s.bgColor.theme].rgb,t.s.bgColor.tint||0),n.WTF&&(t.s.bgColor.raw_rgb=i.themeElements.clrScheme[t.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&s.Fills)throw o}}}function o$e(t,e,r){if(t&&t["!ref"]){var n=ar(t["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+t["!ref"])}}function l$e(t,e){var r=ar(e);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(t["!ref"]=Ht(r))}var u$e=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,c$e=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,h$e=/<(?:\w:)?hyperlink [^>]*>/mg,f$e=/"(\w*:\w*)"/,d$e=/<(?:\w:)?col\b[^>]*[\/]?>/g,g$e=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,m$e=/<(?:\w:)?pageMargins[^>]*\/>/g,cne=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,p$e=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,v$e=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function w$e(t,e,r,n,i,s,a){if(!t)return t;n||(n={"!id":{}});var o=e.dense?[]:{},u={s:{r:2e6,c:2e6},e:{r:0,c:0}},c="",f="",g=t.match(c$e);g?(c=t.slice(0,g.index),f=t.slice(g.index+g[0].length)):c=f=t;var m=c.match(cne);m?wB(m[0],o,i,r):(m=c.match(p$e))&&S$e(m[0],m[1]||"",o,i,r);var v=(c.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(v>0){var w=c.slice(v,v+50).match(f$e);w&&l$e(o,w[1])}var y=c.match(v$e);y&&y[1]&&P$e(y[1],i);var b=[];if(e.cellStyles){var x=c.match(d$e);x&&M$e(b,x)}g&&H$e(g[1],o,e,u,s,a);var _=f.match(g$e);_&&(o["!autofilter"]=O$e(_[0]));var T=[],D=f.match(u$e);if(D)for(v=0;v!=D.length;++v)T[v]=ar(D[v].slice(D[v].indexOf('"')+1));var P=f.match(h$e);P&&_$e(o,P,n);var O=f.match(m$e);if(O&&(o["!margins"]=R$e(Ot(O[0]))),!o["!ref"]&&u.e.c>=u.s.c&&u.e.r>=u.s.r&&(o["!ref"]=Ht(u)),e.sheetRows>0&&o["!ref"]){var A=ar(o["!ref"]);e.sheetRows<=+A.e.r&&(A.e.r=e.sheetRows-1,A.e.r>u.e.r&&(A.e.r=u.e.r),A.e.r<A.s.r&&(A.s.r=A.e.r),A.e.c>u.e.c&&(A.e.c=u.e.c),A.e.c<A.s.c&&(A.s.c=A.e.c),o["!fullref"]=o["!ref"],o["!ref"]=Ht(A))}return b.length>0&&(o["!cols"]=b),T.length>0&&(o["!merges"]=T),o}function y$e(t){if(t.length===0)return"";for(var e='<mergeCells count="'+t.length+'">',r=0;r!=t.length;++r)e+='<mergeCell ref="'+Ht(t[r])+'"/>';return e+"</mergeCells>"}function wB(t,e,r,n){var i=Ot(t);r.Sheets[n]||(r.Sheets[n]={}),i.codeName&&(r.Sheets[n].CodeName=Cr(Zr(i.codeName)))}function S$e(t,e,r,n,i){wB(t.slice(0,t.indexOf(">")),r,n,i)}function b$e(t,e,r,n,i){var s=!1,a={},o=null;if(n.bookType!=="xlsx"&&e.vbaraw){var u=e.SheetNames[r];try{e.Workbook&&(u=e.Workbook.Sheets[r].CodeName||u)}catch{}s=!0,a.codeName=ku(Gr(u))}if(t&&t["!outline"]){var c={summaryBelow:1,summaryRight:1};t["!outline"].above&&(c.summaryBelow=0),t["!outline"].left&&(c.summaryRight=0),o=(o||"")+qe("outlinePr",null,c)}!s&&!o||(i[i.length]=qe("sheetPr",o,a))}var C$e=["objects","scenarios","selectLockedCells","selectUnlockedCells"],x$e=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function E$e(t){var e={sheet:1};return C$e.forEach(function(r){t[r]!=null&&t[r]&&(e[r]="1")}),x$e.forEach(function(r){t[r]!=null&&!t[r]&&(e[r]="0")}),t.password&&(e.password=hB(t.password).toString(16).toUpperCase()),qe("sheetProtection",null,e)}function _$e(t,e,r){for(var n=Array.isArray(t),i=0;i!=e.length;++i){var s=Ot(Zr(e[i]),!0);if(!s.ref)return;var a=((r||{})["!id"]||[])[s.id];a?(s.Target=a.Target,s.location&&(s.Target+="#"+Cr(s.location))):(s.Target="#"+Cr(s.location),a={Target:s.Target,TargetMode:"Internal"}),s.Rel=a,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var o=ar(s.ref),u=o.s.r;u<=o.e.r;++u)for(var c=o.s.c;c<=o.e.c;++c){var f=Tt({c,r:u});n?(t[u]||(t[u]=[]),t[u][c]||(t[u][c]={t:"z",v:void 0}),t[u][c].l=s):(t[f]||(t[f]={t:"z",v:void 0}),t[f].l=s)}}}function R$e(t){var e={};return["left","right","top","bottom","header","footer"].forEach(function(r){t[r]&&(e[r]=parseFloat(t[r]))}),e}function T$e(t){return Ag(t),qe("pageMargins",null,t)}function M$e(t,e){for(var r=!1,n=0;n!=e.length;++n){var i=Ot(e[n],!0);i.hidden&&(i.hidden=dn(i.hidden));var s=parseInt(i.min,10)-1,a=parseInt(i.max,10)-1;for(i.outlineLevel&&(i.level=+i.outlineLevel||0),delete i.min,delete i.max,i.width=+i.width,!r&&i.width&&(r=!0,fB(i.width)),jf(i);s<=a;)t[s++]=rn(i)}}function A$e(t,e){for(var r=["<cols>"],n,i=0;i!=e.length;++i)(n=e[i])&&(r[r.length]=qe("col",null,IT(i,n)));return r[r.length]="</cols>",r.join("")}function O$e(t){var e={ref:(t.match(/ref="([^"]*)"/)||[])[1]};return e}function k$e(t,e,r,n){var i=typeof t.ref=="string"?t.ref:Ht(t.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,a=Ks(i);a.s.r==a.e.r&&(a.e.r=Ks(e["!ref"]).e.r,i=Ht(a));for(var o=0;o<s.length;++o){var u=s[o];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==n){u.Ref="'"+r.SheetNames[n]+"'!"+i;break}}return o==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+i}),qe("autoFilter",null,{ref:i})}var D$e=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function P$e(t,e){e.Views||(e.Views=[{}]),(t.match(D$e)||[]).forEach(function(r,n){var i=Ot(r);e.Views[n]||(e.Views[n]={}),+i.zoomScale&&(e.Views[n].zoom=+i.zoomScale),dn(i.rightToLeft)&&(e.Views[n].RTL=!0)})}function I$e(t,e,r,n){var i={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),qe("sheetViews",qe("sheetView",null,i),{})}function N$e(t,e,r,n){if(t.c&&r["!comments"].push([e,t.c]),t.v===void 0&&typeof t.f!="string"||t.t==="z"&&!t.f)return"";var i="",s=t.t,a=t.v;if(t.t!=="z")switch(t.t){case"b":i=t.v?"1":"0";break;case"n":i=""+t.v;break;case"e":i=mh[t.v];break;case"d":n&&n.cellDates?i=pn(t.v,-1).toISOString():(t=rn(t),t.t="n",i=""+(t.v=Hi(pn(t.v)))),typeof t.z>"u"&&(t.z=xt[14]);break;default:i=t.v;break}var o=is("v",Gr(i)),u={r:e},c=nd(n.cellXfs,t,n);switch(c!==0&&(u.s=c),t.t){case"n":break;case"d":u.t="d";break;case"b":u.t="b";break;case"e":u.t="e";break;case"z":break;default:if(t.v==null){delete t.t;break}if(t.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){o=is("v",""+vB(n.Strings,t.v,n.revStrings)),u.t="s";break}u.t="str";break}if(t.t!=s&&(t.t=s,t.v=a),typeof t.f=="string"&&t.f){var f=t.F&&t.F.slice(0,e.length)==e?{t:"array",ref:t.F}:null;o=qe("f",Gr(t.f),f)+(t.v!=null?o:"")}return t.l&&r["!links"].push([e,t.l]),t.D&&(u.cm=1),qe("c",o,u)}var H$e=function(){var t=/<(?:\w+:)?c[ \/>]/,e=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,i=/ref=["']([^"']*)["']/,s=j1("v"),a=j1("f");return function(u,c,f,g,m,v){for(var w=0,y="",b=[],x=[],_=0,T=0,D=0,P="",O,A,W=0,L=0,H,J,G=0,ve=0,be=Array.isArray(v.CellXf),we,ae=[],le=[],Te=Array.isArray(c),ce=[],K={},Se=!1,B=!!f.sheetStubs,E=u.split(e),R=0,M=E.length;R!=M;++R){y=E[R].trim();var F=y.length;if(F!==0){var Z=0;e:for(w=0;w<F;++w)switch(y[w]){case">":if(y[w-1]!="/"){++w;break e}if(f&&f.cellStyles){if(A=Ot(y.slice(Z,w),!0),W=A.r!=null?parseInt(A.r,10):W+1,L=-1,f.sheetRows&&f.sheetRows<W)continue;K={},Se=!1,A.ht&&(Se=!0,K.hpt=parseFloat(A.ht),K.hpx=Vp(K.hpt)),A.hidden=="1"&&(Se=!0,K.hidden=!0),A.outlineLevel!=null&&(Se=!0,K.level=+A.outlineLevel),Se&&(ce[W-1]=K)}break;case"<":Z=w;break}if(Z>=w)break;if(A=Ot(y.slice(Z,w),!0),W=A.r!=null?parseInt(A.r,10):W+1,L=-1,!(f.sheetRows&&f.sheetRows<W)){g.s.r>W-1&&(g.s.r=W-1),g.e.r<W-1&&(g.e.r=W-1),f&&f.cellStyles&&(K={},Se=!1,A.ht&&(Se=!0,K.hpt=parseFloat(A.ht),K.hpx=Vp(K.hpt)),A.hidden=="1"&&(Se=!0,K.hidden=!0),A.outlineLevel!=null&&(Se=!0,K.level=+A.outlineLevel),Se&&(ce[W-1]=K)),b=y.slice(w).split(t);for(var te=0;te!=b.length&&b[te].trim().charAt(0)=="<";++te);for(b=b.slice(te),w=0;w!=b.length;++w)if(y=b[w].trim(),y.length!==0){if(x=y.match(r),_=w,T=0,D=0,y="<c "+(y.slice(0,1)=="<"?">":"")+y,x!=null&&x.length===2){for(_=0,P=x[1],T=0;T!=P.length&&!((D=P.charCodeAt(T)-64)<1||D>26);++T)_=26*_+D;--_,L=_}else++L;for(T=0;T!=y.length&&y.charCodeAt(T)!==62;++T);if(++T,A=Ot(y.slice(0,T),!0),A.r||(A.r=Tt({r:W-1,c:L})),P=y.slice(T),O={t:""},(x=P.match(s))!=null&&x[1]!==""&&(O.v=Cr(x[1])),f.cellFormula){if((x=P.match(a))!=null&&x[1]!==""){if(O.f=Cr(Zr(x[1])).replace(/\r\n/g,`
`),f.xlfn||(O.f=VG(O.f)),x[0].indexOf('t="array"')>-1)O.F=(P.match(i)||[])[1],O.F.indexOf(":")>-1&&ae.push([ar(O.F),O.F]);else if(x[0].indexOf('t="shared"')>-1){J=Ot(x[0]);var fe=Cr(Zr(x[1]));f.xlfn||(fe=VG(fe)),le[parseInt(J.si,10)]=[J,fe,A.r]}}else(x=P.match(/<f[^>]*\/>/))&&(J=Ot(x[0]),le[J.si]&&(O.f=D8e(le[J.si][1],le[J.si][2],A.r)));var I=Dn(A.r);for(T=0;T<ae.length;++T)I.r>=ae[T][0].s.r&&I.r<=ae[T][0].e.r&&I.c>=ae[T][0].s.c&&I.c<=ae[T][0].e.c&&(O.F=ae[T][1])}if(A.t==null&&O.v===void 0)if(O.f||O.F)O.v=0,O.t="n";else if(B)O.t="z";else continue;else O.t=A.t||"n";switch(g.s.c>L&&(g.s.c=L),g.e.c<L&&(g.e.c=L),O.t){case"n":if(O.v==""||O.v==null){if(!B)continue;O.t="z"}else O.v=parseFloat(O.v);break;case"s":if(typeof O.v>"u"){if(!B)continue;O.t="z"}else H=o1[parseInt(O.v,10)],O.v=H.t,O.r=H.r,f.cellHTML&&(O.h=H.h);break;case"str":O.t="s",O.v=O.v!=null?Zr(O.v):"",f.cellHTML&&(O.h=z3(O.v));break;case"inlineStr":x=P.match(n),O.t="s",x!=null&&(H=cB(x[1]))?(O.v=H.t,f.cellHTML&&(O.h=H.h)):O.v="";break;case"b":O.v=dn(O.v);break;case"d":f.cellDates?O.v=pn(O.v,1):(O.v=Hi(pn(O.v,1)),O.t="n");break;case"e":(!f||f.cellText!==!1)&&(O.w=O.v),O.v=fre[O.v];break}if(G=ve=0,we=null,be&&A.s!==void 0&&(we=v.CellXf[A.s],we!=null&&(we.numFmtId!=null&&(G=we.numFmtId),f.cellStyles&&we.fillId!=null&&(ve=we.fillId))),une(O,G,ve,f,m,v),f.cellDates&&be&&O.t=="n"&&cm(xt[G])&&(O.t="d",O.v=AT(O.v)),A.cm&&f.xlmeta){var U=(f.xlmeta.Cell||[])[+A.cm-1];U&&U.type=="XLDAPR"&&(O.D=!0)}if(Te){var k=Dn(A.r);c[k.r]||(c[k.r]=[]),c[k.r][k.c]=O}else c[A.r]=O}}}}ce.length>0&&(c["!rows"]=ce)}}();function F$e(t,e,r,n){var i=[],s=[],a=ar(t["!ref"]),o="",u,c="",f=[],g=0,m=0,v=t["!rows"],w=Array.isArray(t),y={r:c},b,x=-1;for(m=a.s.c;m<=a.e.c;++m)f[m]=mn(m);for(g=a.s.r;g<=a.e.r;++g){for(s=[],c=jn(g),m=a.s.c;m<=a.e.c;++m){u=f[m]+c;var _=w?(t[g]||[])[m]:t[u];_!==void 0&&(o=N$e(_,u,t,e))!=null&&s.push(o)}(s.length>0||v&&v[g])&&(y={r:c},v&&v[g]&&(b=v[g],b.hidden&&(y.hidden=1),x=-1,b.hpx?x=Q1(b.hpx):b.hpt&&(x=b.hpt),x>-1&&(y.ht=x,y.customHeight=1),b.level&&(y.outlineLevel=b.level)),i[i.length]=qe("row",s.join(""),y))}if(v)for(;g<v.length;++g)v&&v[g]&&(y={r:g+1},b=v[g],b.hidden&&(y.hidden=1),x=-1,b.hpx?x=Q1(b.hpx):b.hpt&&(x=b.hpt),x>-1&&(y.ht=x,y.customHeight=1),b.level&&(y.outlineLevel=b.level),i[i.length]=qe("row","",y));return i.join("")}function hne(t,e,r,n){var i=[hi,qe("worksheet",null,{xmlns:hm[0],"xmlns:r":Pi.r})],s=r.SheetNames[t],a=0,o="",u=r.Sheets[s];u==null&&(u={});var c=u["!ref"]||"A1",f=ar(c);if(f.e.c>16383||f.e.r>1048575){if(e.WTF)throw new Error("Range "+c+" exceeds format limit A1:XFD1048576");f.e.c=Math.min(f.e.c,16383),f.e.r=Math.min(f.e.c,1048575),c=Ht(f)}n||(n={}),u["!comments"]=[];var g=[];b$e(u,r,t,e,i),i[i.length]=qe("dimension",null,{ref:c}),i[i.length]=I$e(u,e,t,r),e.sheetFormat&&(i[i.length]=qe("sheetFormatPr",null,{defaultRowHeight:e.sheetFormat.defaultRowHeight||"16",baseColWidth:e.sheetFormat.baseColWidth||"10",outlineLevelRow:e.sheetFormat.outlineLevelRow||"7"})),u["!cols"]!=null&&u["!cols"].length>0&&(i[i.length]=A$e(u,u["!cols"])),i[a=i.length]="<sheetData/>",u["!links"]=[],u["!ref"]!=null&&(o=F$e(u,e),o.length>0&&(i[i.length]=o)),i.length>a+1&&(i[i.length]="</sheetData>",i[a]=i[a].replace("/>",">")),u["!protect"]&&(i[i.length]=E$e(u["!protect"])),u["!autofilter"]!=null&&(i[i.length]=k$e(u["!autofilter"],u,r,t)),u["!merges"]!=null&&u["!merges"].length>0&&(i[i.length]=y$e(u["!merges"]));var m=-1,v,w=-1;return u["!links"].length>0&&(i[i.length]="<hyperlinks>",u["!links"].forEach(function(y){y[1].Target&&(v={ref:y[0]},y[1].Target.charAt(0)!="#"&&(w=zr(n,-1,Gr(y[1].Target).replace(/#.*$/,""),Zt.HLINK),v["r:id"]="rId"+w),(m=y[1].Target.indexOf("#"))>-1&&(v.location=Gr(y[1].Target.slice(m+1))),y[1].Tooltip&&(v.tooltip=Gr(y[1].Tooltip)),i[i.length]=qe("hyperlink",null,v))}),i[i.length]="</hyperlinks>"),delete u["!links"],u["!margins"]!=null&&(i[i.length]=T$e(u["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&(i[i.length]=is("ignoredErrors",qe("ignoredError",null,{numberStoredAsText:1,sqref:c}))),g.length>0&&(w=zr(n,-1,"../drawings/drawing"+(t+1)+".xml",Zt.DRAW),i[i.length]=qe("drawing",null,{"r:id":"rId"+w}),u["!drawing"]=g),u["!comments"].length>0&&(w=zr(n,-1,"../drawings/vmlDrawing"+(t+1)+".vml",Zt.VML),i[i.length]=qe("legacyDrawing",null,{"r:id":"rId"+w}),u["!legacy"]=w),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function L$e(t,e){var r={},n=t.l+e;r.r=t.read_shift(4),t.l+=4;var i=t.read_shift(2);t.l+=1;var s=t.read_shift(1);return t.l=n,s&7&&(r.level=s&7),s&16&&(r.hidden=!0),s&32&&(r.hpt=i/20),r}function B$e(t,e,r){var n=Fe(145),i=(r["!rows"]||[])[t]||{};n.write_shift(4,t),n.write_shift(4,0);var s=320;i.hpx?s=Q1(i.hpx)*20:i.hpt&&(s=i.hpt*20),n.write_shift(2,s),n.write_shift(1,0);var a=0;i.level&&(a|=i.level),i.hidden&&(a|=16),(i.hpx||i.hpt)&&(a|=32),n.write_shift(1,a),n.write_shift(1,0);var o=0,u=n.l;n.l+=4;for(var c={r:t,c:0},f=0;f<16;++f)if(!(e.s.c>f+1<<10||e.e.c<f<<10)){for(var g=-1,m=-1,v=f<<10;v<f+1<<10;++v){c.c=v;var w=Array.isArray(r)?(r[c.r]||[])[c.c]:r[Tt(c)];w&&(g<0&&(g=v),m=v)}g<0||(++o,n.write_shift(4,g),n.write_shift(4,m))}var y=n.l;return n.l=u,n.write_shift(4,o),n.l=y,n.length>n.l?n.slice(0,n.l):n}function V$e(t,e,r,n){var i=B$e(n,r,e);(i.length>17||(e["!rows"]||[])[n])&&Ue(t,0,i)}var W$e=mm,$$e=mv;function U$e(){}function j$e(t,e){var r={},n=t[t.l];return++t.l,r.above=!(n&64),r.left=!(n&128),t.l+=18,r.name=G4e(t),r}function Y$e(t,e,r){r==null&&(r=Fe(84+4*t.length));var n=192;e&&(e.above&&(n&=-65),e.left&&(n&=-129)),r.write_shift(1,n);for(var i=1;i<3;++i)r.write_shift(1,0);return X_({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),ore(t,r),r.slice(0,r.l)}function z$e(t){var e=el(t);return[e]}function G$e(t,e,r){return r==null&&(r=Fe(8)),fm(e,r)}function q$e(t){var e=dm(t);return[e]}function K$e(t,e,r){return r==null&&(r=Fe(4)),gm(e,r)}function X$e(t){var e=el(t),r=t.read_shift(1);return[e,r,"b"]}function Q$e(t,e,r){return r==null&&(r=Fe(9)),fm(e,r),r.write_shift(1,t.v?1:0),r}function Z$e(t){var e=dm(t),r=t.read_shift(1);return[e,r,"b"]}function J$e(t,e,r){return r==null&&(r=Fe(5)),gm(e,r),r.write_shift(1,t.v?1:0),r}function eUe(t){var e=el(t),r=t.read_shift(1);return[e,r,"e"]}function tUe(t,e,r){return r==null&&(r=Fe(9)),fm(e,r),r.write_shift(1,t.v),r}function rUe(t){var e=dm(t),r=t.read_shift(1);return[e,r,"e"]}function nUe(t,e,r){return r==null&&(r=Fe(8)),gm(e,r),r.write_shift(1,t.v),r.write_shift(2,0),r.write_shift(1,0),r}function iUe(t){var e=el(t),r=t.read_shift(4);return[e,r,"s"]}function sUe(t,e,r){return r==null&&(r=Fe(12)),fm(e,r),r.write_shift(4,e.v),r}function aUe(t){var e=dm(t),r=t.read_shift(4);return[e,r,"s"]}function oUe(t,e,r){return r==null&&(r=Fe(8)),gm(e,r),r.write_shift(4,e.v),r}function lUe(t){var e=el(t),r=xs(t);return[e,r,"n"]}function uUe(t,e,r){return r==null&&(r=Fe(16)),fm(e,r),jg(t.v,r),r}function fne(t){var e=dm(t),r=xs(t);return[e,r,"n"]}function cUe(t,e,r){return r==null&&(r=Fe(12)),gm(e,r),jg(t.v,r),r}function hUe(t){var e=el(t),r=sB(t);return[e,r,"n"]}function fUe(t,e,r){return r==null&&(r=Fe(12)),fm(e,r),lre(t.v,r),r}function dUe(t){var e=dm(t),r=sB(t);return[e,r,"n"]}function gUe(t,e,r){return r==null&&(r=Fe(8)),gm(e,r),lre(t.v,r),r}function mUe(t){var e=el(t),r=rB(t);return[e,r,"is"]}function pUe(t){var e=el(t),r=Ts(t);return[e,r,"str"]}function vUe(t,e,r){return r==null&&(r=Fe(12+4*t.v.length)),fm(e,r),zi(t.v,r),r.length>r.l?r.slice(0,r.l):r}function wUe(t){var e=dm(t),r=Ts(t);return[e,r,"str"]}function yUe(t,e,r){return r==null&&(r=Fe(8+4*t.v.length)),gm(e,r),zi(t.v,r),r.length>r.l?r.slice(0,r.l):r}function SUe(t,e,r){var n=t.l+e,i=el(t);i.r=r["!row"];var s=t.read_shift(1),a=[i,s,"b"];if(r.cellFormula){t.l+=2;var o=PT(t,n-t.l,r);a[3]=ys(o,null,i,r.supbooks,r)}else t.l=n;return a}function bUe(t,e,r){var n=t.l+e,i=el(t);i.r=r["!row"];var s=t.read_shift(1),a=[i,s,"e"];if(r.cellFormula){t.l+=2;var o=PT(t,n-t.l,r);a[3]=ys(o,null,i,r.supbooks,r)}else t.l=n;return a}function CUe(t,e,r){var n=t.l+e,i=el(t);i.r=r["!row"];var s=xs(t),a=[i,s,"n"];if(r.cellFormula){t.l+=2;var o=PT(t,n-t.l,r);a[3]=ys(o,null,i,r.supbooks,r)}else t.l=n;return a}function xUe(t,e,r){var n=t.l+e,i=el(t);i.r=r["!row"];var s=Ts(t),a=[i,s,"str"];if(r.cellFormula){t.l+=2;var o=PT(t,n-t.l,r);a[3]=ys(o,null,i,r.supbooks,r)}else t.l=n;return a}var EUe=mm,_Ue=mv;function RUe(t,e){return e==null&&(e=Fe(4)),e.write_shift(4,t),e}function TUe(t,e){var r=t.l+e,n=mm(t),i=nB(t),s=Ts(t),a=Ts(t),o=Ts(t);t.l=r;var u={rfx:n,relId:i,loc:s,display:o};return a&&(u.Tooltip=a),u}function MUe(t,e){var r=Fe(50+4*(t[1].Target.length+(t[1].Tooltip||"").length));mv({s:Dn(t[0]),e:Dn(t[0])},r),iB("rId"+e,r);var n=t[1].Target.indexOf("#"),i=n==-1?"":t[1].Target.slice(n+1);return zi(i||"",r),zi(t[1].Tooltip||"",r),zi("",r),r.slice(0,r.l)}function AUe(){}function OUe(t,e,r){var n=t.l+e,i=ure(t),s=t.read_shift(1),a=[i];if(a[2]=s,r.cellFormula){var o=e$e(t,n-t.l,r);a[1]=o}else t.l=n;return a}function kUe(t,e,r){var n=t.l+e,i=mm(t),s=[i];if(r.cellFormula){var a=r$e(t,n-t.l,r);s[1]=a,t.l=n}else t.l=n;return s}function DUe(t,e,r){r==null&&(r=Fe(18));var n=IT(t,e);r.write_shift(-4,t),r.write_shift(-4,t),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var i=0;return e.hidden&&(i|=1),typeof n.width=="number"&&(i|=2),e.level&&(i|=e.level<<8),r.write_shift(2,i),r}var dne=["left","right","top","bottom","header","footer"];function PUe(t){var e={};return dne.forEach(function(r){e[r]=xs(t)}),e}function IUe(t,e){return e==null&&(e=Fe(48)),Ag(t),dne.forEach(function(r){jg(t[r],e)}),e}function NUe(t){var e=t.read_shift(2);return t.l+=28,{RTL:e&32}}function HUe(t,e,r){r==null&&(r=Fe(30));var n=924;return(((e||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function FUe(t){var e=Fe(24);return e.write_shift(4,4),e.write_shift(4,1),mv(t,e),e}function LUe(t,e){return e==null&&(e=Fe(66)),e.write_shift(2,t.password?hB(t.password):0),e.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?e.write_shift(4,t[r[0]]!=null&&!t[r[0]]?1:0):e.write_shift(4,t[r[0]]!=null&&t[r[0]]?0:1)}),e}function BUe(){}function VUe(){}function WUe(t,e,r,n,i,s,a){if(!t)return t;var o=e||{};n||(n={"!id":{}});var u=o.dense?[]:{},c,f={s:{r:2e6,c:2e6},e:{r:0,c:0}},g=!1,m=!1,v,w,y,b,x,_,T,D,P,O=[];o.biff=12,o["!row"]=0;var A=0,W=!1,L=[],H={},J=o.supbooks||i.supbooks||[[]];if(J.sharedf=H,J.arrayf=L,J.SheetNames=i.SheetNames||i.Sheets.map(function(Te){return Te.name}),!o.supbooks&&(o.supbooks=J,i.Names))for(var G=0;G<i.Names.length;++G)J[0][G+1]=i.Names[G];var ve=[],be=[],we=!1;Z1[16]={n:"BrtShortReal",f:fne};var ae;if(gh(t,function(ce,K,Se){if(!m)switch(Se){case 148:c=ce;break;case 0:v=ce,o.sheetRows&&o.sheetRows<=v.r&&(m=!0),D=jn(b=v.r),o["!row"]=v.r,(ce.hidden||ce.hpt||ce.level!=null)&&(ce.hpt&&(ce.hpx=Vp(ce.hpt)),be[ce.r]=ce);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(w={t:ce[2]},ce[2]){case"n":w.v=ce[1];break;case"s":T=o1[ce[1]],w.v=T.t,w.r=T.r;break;case"b":w.v=!!ce[1];break;case"e":w.v=ce[1],o.cellText!==!1&&(w.w=mh[w.v]);break;case"str":w.t="s",w.v=ce[1];break;case"is":w.t="s",w.v=ce[1].t;break}if((y=a.CellXf[ce[0].iStyleRef])&&une(w,y.numFmtId,null,o,s,a),x=ce[0].c==-1?x+1:ce[0].c,o.dense?(u[b]||(u[b]=[]),u[b][x]=w):u[mn(x)+D]=w,o.cellFormula){for(W=!1,A=0;A<L.length;++A){var B=L[A];v.r>=B[0].s.r&&v.r<=B[0].e.r&&x>=B[0].s.c&&x<=B[0].e.c&&(w.F=Ht(B[0]),W=!0)}!W&&ce.length>3&&(w.f=ce[3])}if(f.s.r>v.r&&(f.s.r=v.r),f.s.c>x&&(f.s.c=x),f.e.r<v.r&&(f.e.r=v.r),f.e.c<x&&(f.e.c=x),o.cellDates&&y&&w.t=="n"&&cm(xt[y.numFmtId])){var E=Rf(w.v);E&&(w.t="d",w.v=new Date(E.y,E.m-1,E.d,E.H,E.M,E.S,E.u))}ae&&(ae.type=="XLDAPR"&&(w.D=!0),ae=void 0);break;case 1:case 12:if(!o.sheetStubs||g)break;w={t:"z",v:void 0},x=ce[0].c==-1?x+1:ce[0].c,o.dense?(u[b]||(u[b]=[]),u[b][x]=w):u[mn(x)+D]=w,f.s.r>v.r&&(f.s.r=v.r),f.s.c>x&&(f.s.c=x),f.e.r<v.r&&(f.e.r=v.r),f.e.c<x&&(f.e.c=x),ae&&(ae.type=="XLDAPR"&&(w.D=!0),ae=void 0);break;case 176:O.push(ce);break;case 49:ae=((o.xlmeta||{}).Cell||[])[ce-1];break;case 494:var R=n["!id"][ce.relId];for(R?(ce.Target=R.Target,ce.loc&&(ce.Target+="#"+ce.loc),ce.Rel=R):ce.relId==""&&(ce.Target="#"+ce.loc),b=ce.rfx.s.r;b<=ce.rfx.e.r;++b)for(x=ce.rfx.s.c;x<=ce.rfx.e.c;++x)o.dense?(u[b]||(u[b]=[]),u[b][x]||(u[b][x]={t:"z",v:void 0}),u[b][x].l=ce):(_=Tt({c:x,r:b}),u[_]||(u[_]={t:"z",v:void 0}),u[_].l=ce);break;case 426:if(!o.cellFormula)break;L.push(ce),P=o.dense?u[b][x]:u[mn(x)+D],P.f=ys(ce[1],f,{r:v.r,c:x},J,o),P.F=Ht(ce[0]);break;case 427:if(!o.cellFormula)break;H[Tt(ce[0].s)]=ce[1],P=o.dense?u[b][x]:u[mn(x)+D],P.f=ys(ce[1],f,{r:v.r,c:x},J,o);break;case 60:if(!o.cellStyles)break;for(;ce.e>=ce.s;)ve[ce.e--]={width:ce.w/256,hidden:!!(ce.flags&1),level:ce.level},we||(we=!0,fB(ce.w/256)),jf(ve[ce.e+1]);break;case 161:u["!autofilter"]={ref:Ht(ce)};break;case 476:u["!margins"]=ce;break;case 147:i.Sheets[r]||(i.Sheets[r]={}),ce.name&&(i.Sheets[r].CodeName=ce.name),(ce.above||ce.left)&&(u["!outline"]={above:ce.above,left:ce.left});break;case 137:i.Views||(i.Views=[{}]),i.Views[0]||(i.Views[0]={}),ce.RTL&&(i.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:g=!0;break;case 36:g=!1;break;case 37:g=!0;break;case 38:g=!1;break;default:if(!K.T){if(!g||o.WTF)throw new Error("Unexpected record 0x"+Se.toString(16))}}},o),delete o.supbooks,delete o["!row"],!u["!ref"]&&(f.s.r<2e6||c&&(c.e.r>0||c.e.c>0||c.s.r>0||c.s.c>0))&&(u["!ref"]=Ht(c||f)),o.sheetRows&&u["!ref"]){var le=ar(u["!ref"]);o.sheetRows<=+le.e.r&&(le.e.r=o.sheetRows-1,le.e.r>f.e.r&&(le.e.r=f.e.r),le.e.r<le.s.r&&(le.s.r=le.e.r),le.e.c>f.e.c&&(le.e.c=f.e.c),le.e.c<le.s.c&&(le.s.c=le.e.c),u["!fullref"]=u["!ref"],u["!ref"]=Ht(le))}return O.length>0&&(u["!merges"]=O),ve.length>0&&(u["!cols"]=ve),be.length>0&&(u["!rows"]=be),u}function $Ue(t,e,r,n,i,s,a){if(e.v===void 0)return!1;var o="";switch(e.t){case"b":o=e.v?"1":"0";break;case"d":e=rn(e),e.z=e.z||xt[14],e.v=Hi(pn(e.v)),e.t="n";break;case"n":case"e":o=""+e.v;break;default:o=e.v;break}var u={r,c:n};switch(u.s=nd(i.cellXfs,e,i),e.l&&s["!links"].push([Tt(u),e.l]),e.c&&s["!comments"].push([Tt(u),e.c]),e.t){case"s":case"str":return i.bookSST?(o=vB(i.Strings,e.v,i.revStrings),u.t="s",u.v=o,a?Ue(t,18,oUe(e,u)):Ue(t,7,sUe(e,u))):(u.t="str",a?Ue(t,17,yUe(e,u)):Ue(t,6,vUe(e,u))),!0;case"n":return e.v==(e.v|0)&&e.v>-1e3&&e.v<1e3?a?Ue(t,13,gUe(e,u)):Ue(t,2,fUe(e,u)):a?Ue(t,16,cUe(e,u)):Ue(t,5,uUe(e,u)),!0;case"b":return u.t="b",a?Ue(t,15,J$e(e,u)):Ue(t,4,Q$e(e,u)),!0;case"e":return u.t="e",a?Ue(t,14,nUe(e,u)):Ue(t,3,tUe(e,u)),!0}return a?Ue(t,12,K$e(e,u)):Ue(t,1,G$e(e,u)),!0}function UUe(t,e,r,n){var i=ar(e["!ref"]||"A1"),s,a="",o=[];Ue(t,145);var u=Array.isArray(e),c=i.e.r;e["!rows"]&&(c=Math.max(i.e.r,e["!rows"].length-1));for(var f=i.s.r;f<=c;++f){a=jn(f),V$e(t,e,i,f);var g=!1;if(f<=i.e.r)for(var m=i.s.c;m<=i.e.c;++m){f===i.s.r&&(o[m]=mn(m)),s=o[m]+a;var v=u?(e[f]||[])[m]:e[s];if(!v){g=!1;continue}g=$Ue(t,v,f,m,n,e,g)}}Ue(t,146)}function jUe(t,e){!e||!e["!merges"]||(Ue(t,177,RUe(e["!merges"].length)),e["!merges"].forEach(function(r){Ue(t,176,_Ue(r))}),Ue(t,178))}function YUe(t,e){!e||!e["!cols"]||(Ue(t,390),e["!cols"].forEach(function(r,n){r&&Ue(t,60,DUe(n,r))}),Ue(t,391))}function zUe(t,e){!e||!e["!ref"]||(Ue(t,648),Ue(t,649,FUe(ar(e["!ref"]))),Ue(t,650))}function GUe(t,e,r){e["!links"].forEach(function(n){if(n[1].Target){var i=zr(r,-1,n[1].Target.replace(/#.*$/,""),Zt.HLINK);Ue(t,494,MUe(n,i))}}),delete e["!links"]}function qUe(t,e,r,n){if(e["!comments"].length>0){var i=zr(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",Zt.VML);Ue(t,551,iB("rId"+i)),e["!legacy"]=i}}function KUe(t,e,r,n){if(e["!autofilter"]){var i=e["!autofilter"],s=typeof i.ref=="string"?i.ref:Ht(i.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var a=r.Workbook.Names,o=Ks(s);o.s.r==o.e.r&&(o.e.r=Ks(e["!ref"]).e.r,s=Ht(o));for(var u=0;u<a.length;++u){var c=a[u];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref="'"+r.SheetNames[n]+"'!"+s;break}}u==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),Ue(t,161,mv(ar(s))),Ue(t,162)}}function XUe(t,e,r){Ue(t,133),Ue(t,137,HUe(e,r)),Ue(t,138),Ue(t,134)}function QUe(t,e){e["!protect"]&&Ue(t,535,LUe(e["!protect"]))}function ZUe(t,e,r,n){var i=ya(),s=r.SheetNames[t],a=r.Sheets[s]||{},o=s;try{r&&r.Workbook&&(o=r.Workbook.Sheets[t].CodeName||o)}catch{}var u=ar(a["!ref"]||"A1");if(u.e.c>16383||u.e.r>1048575){if(e.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");u.e.c=Math.min(u.e.c,16383),u.e.r=Math.min(u.e.c,1048575)}return a["!links"]=[],a["!comments"]=[],Ue(i,129),(r.vbaraw||a["!outline"])&&Ue(i,147,Y$e(o,a["!outline"])),Ue(i,148,$$e(u)),XUe(i,a,r.Workbook),YUe(i,a),UUe(i,a,t,e),QUe(i,a),KUe(i,a,r,t),jUe(i,a),GUe(i,a,n),a["!margins"]&&Ue(i,476,IUe(a["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&zUe(i,a),qUe(i,a,t,n),Ue(i,130),i.end()}function JUe(t){var e=[],r=t.match(/^<c:numCache>/),n;(t.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(s){var a=s.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);a&&(e[+a[1]]=r?+a[2]:a[2])});var i=Cr((t.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(t.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(s){n=s.replace(/<.*?>/g,"")}),[e,i,n]}function e5e(t,e,r,n,i,s){var a=s||{"!type":"chart"};if(!t)return s;var o=0,u=0,c="A",f={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(t.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(g){var m=JUe(g);f.s.r=f.s.c=0,f.e.c=o,c=mn(o),m[0].forEach(function(v,w){a[c+jn(w)]={t:"n",v,z:m[1]},u=w}),f.e.r<u&&(f.e.r=u),++o}),o>0&&(a["!ref"]=Ht(f)),a}function t5e(t,e,r,n,i){if(!t)return t;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},a,o=t.match(cne);return o&&wB(o[0],s,i,r),(a=t.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=a[1]),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}function r5e(t,e){t.l+=10;var r=Ts(t);return{name:r}}function n5e(t,e,r,n,i){if(!t)return t;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},a=!1;return gh(t,function(u,c,f){switch(f){case 550:s["!rel"]=u;break;case 651:i.Sheets[r]||(i.Sheets[r]={}),u.name&&(i.Sheets[r].CodeName=u.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:break;case 38:break;default:if(!(c.T>0)){if(!(c.T<0)){if(!a||e.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}}},e),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}var yB=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],i5e=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],s5e=[],a5e=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function YG(t,e){for(var r=0;r!=t.length;++r)for(var n=t[r],i=0;i!=e.length;++i){var s=e[i];if(n[s[0]]==null)n[s[0]]=s[1];else switch(s[2]){case"bool":typeof n[s[0]]=="string"&&(n[s[0]]=dn(n[s[0]]));break;case"int":typeof n[s[0]]=="string"&&(n[s[0]]=parseInt(n[s[0]],10));break}}}function zG(t,e){for(var r=0;r!=e.length;++r){var n=e[r];if(t[n[0]]==null)t[n[0]]=n[1];else switch(n[2]){case"bool":typeof t[n[0]]=="string"&&(t[n[0]]=dn(t[n[0]]));break;case"int":typeof t[n[0]]=="string"&&(t[n[0]]=parseInt(t[n[0]],10));break}}}function gne(t){zG(t.WBProps,yB),zG(t.CalcPr,a5e),YG(t.WBView,i5e),YG(t.Sheets,s5e),bp.date1904=dn(t.WBProps.date1904)}function o5e(t){return!t.Workbook||!t.Workbook.WBProps?"false":dn(t.Workbook.WBProps.date1904)?"true":"false"}var l5e="][*?/\\".split("");function mne(t,e){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return l5e.forEach(function(n){if(t.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function u5e(t,e,r){t.forEach(function(n,i){mne(n);for(var s=0;s<i;++s)if(n==t[s])throw new Error("Duplicate Sheet Name: "+n);if(r){var a=e&&e[i]&&e[i].CodeName||n;if(a.charCodeAt(0)==95&&a.length>22)throw new Error("Bad Code Name: Worksheet"+a)}})}function pne(t){if(!t||!t.SheetNames||!t.Sheets)throw new Error("Invalid Workbook");if(!t.SheetNames.length)throw new Error("Workbook is empty");var e=t.Workbook&&t.Workbook.Sheets||[];u5e(t.SheetNames,e,!!t.vbaraw);for(var r=0;r<t.SheetNames.length;++r)o$e(t.Sheets[t.SheetNames[r]],t.SheetNames[r],r)}var c5e=/<\w+:workbook/;function h5e(t,e){if(!t)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,i="xmlns",s={},a=0;if(t.replace(ks,function(u,c){var f=Ot(u);switch(Xu(f[0])){case"<?xml":break;case"<workbook":u.match(c5e)&&(i="xmlns"+u.match(/<(\w+):/)[1]),r.xmlns=f[i];break;case"</workbook>":break;case"<fileVersion":delete f[0],r.AppVersion=f;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":yB.forEach(function(g){if(f[g[0]]!=null)switch(g[2]){case"bool":r.WBProps[g[0]]=dn(f[g[0]]);break;case"int":r.WBProps[g[0]]=parseInt(f[g[0]],10);break;default:r.WBProps[g[0]]=f[g[0]]}}),f.codeName&&(r.WBProps.CodeName=Zr(f.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete f[0],r.WBView.push(f);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(f.state){case"hidden":f.Hidden=1;break;case"veryHidden":f.Hidden=2;break;default:f.Hidden=0}delete f.state,f.name=Cr(Zr(f.name)),delete f[0],r.Sheets.push(f);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":s={},s.Name=Zr(f.name),f.comment&&(s.Comment=f.comment),f.localSheetId&&(s.Sheet=+f.localSheetId),dn(f.hidden||"0")&&(s.Hidden=!0),a=c+u.length;break;case"</definedName>":s.Ref=Cr(Zr(t.slice(a,c))),r.Names.push(s);break;case"<definedName/>":break;case"<calcPr":delete f[0],r.CalcPr=f;break;case"<calcPr/>":delete f[0],r.CalcPr=f;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&e.WTF)throw new Error("unrecognized "+f[0]+" in workbook")}return u}),hm.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return gne(r),r}function vne(t){var e=[hi];e[e.length]=qe("workbook",null,{xmlns:hm[0],"xmlns:r":Pi.r});var r=t.Workbook&&(t.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};t.Workbook&&t.Workbook.WBProps&&(yB.forEach(function(o){t.Workbook.WBProps[o[0]]!=null&&t.Workbook.WBProps[o[0]]!=o[1]&&(n[o[0]]=t.Workbook.WBProps[o[0]])}),t.Workbook.WBProps.CodeName&&(n.codeName=t.Workbook.WBProps.CodeName,delete n.CodeName)),e[e.length]=qe("workbookPr",null,n);var i=t.Workbook&&t.Workbook.Sheets||[],s=0;if(i&&i[0]&&i[0].Hidden){for(e[e.length]="<bookViews>",s=0;s!=t.SheetNames.length&&!(!i[s]||!i[s].Hidden);++s);s==t.SheetNames.length&&(s=0),e[e.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',e[e.length]="</bookViews>"}for(e[e.length]="<sheets>",s=0;s!=t.SheetNames.length;++s){var a={name:Gr(t.SheetNames[s].slice(0,31))};if(a.sheetId=""+(s+1),a["r:id"]="rId"+(s+1),i[s])switch(i[s].Hidden){case 1:a.state="hidden";break;case 2:a.state="veryHidden";break}e[e.length]=qe("sheet",null,a)}return e[e.length]="</sheets>",r&&(e[e.length]="<definedNames>",t.Workbook&&t.Workbook.Names&&t.Workbook.Names.forEach(function(o){var u={name:o.Name};o.Comment&&(u.comment=o.Comment),o.Sheet!=null&&(u.localSheetId=""+o.Sheet),o.Hidden&&(u.hidden="1"),o.Ref&&(e[e.length]=qe("definedName",Gr(o.Ref),u))}),e[e.length]="</definedNames>"),e.length>2&&(e[e.length]="</workbook>",e[1]=e[1].replace("/>",">")),e.join("")}function f5e(t,e){var r={};return r.Hidden=t.read_shift(4),r.iTabID=t.read_shift(4),r.strRelID=eH(t),r.name=Ts(t),r}function d5e(t,e){return e||(e=Fe(127)),e.write_shift(4,t.Hidden),e.write_shift(4,t.iTabID),iB(t.strRelID,e),zi(t.name.slice(0,31),e),e.length>e.l?e.slice(0,e.l):e}function g5e(t,e){var r={},n=t.read_shift(4);r.defaultThemeVersion=t.read_shift(4);var i=e>8?Ts(t):"";return i.length>0&&(r.CodeName=i),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function m5e(t,e){e||(e=Fe(72));var r=0;return t&&t.filterPrivacy&&(r|=8),e.write_shift(4,r),e.write_shift(4,0),ore(t&&t.CodeName||"ThisWorkbook",e),e.slice(0,e.l)}function p5e(t,e){var r={};return t.read_shift(4),r.ArchID=t.read_shift(4),t.l+=e-8,r}function v5e(t,e,r){var n=t.l+e;t.l+=4,t.l+=1;var i=t.read_shift(4),s=q4e(t),a=t$e(t,0,r),o=nB(t);t.l=n;var u={Name:s,Ptg:a};return i<268435455&&(u.Sheet=i),o&&(u.Comment=o),u}function w5e(t,e){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],i=!1;e||(e={}),e.biff=12;var s=[],a=[[]];return a.SheetNames=[],a.XTI=[],Z1[16]={n:"BrtFRTArchID$",f:p5e},gh(t,function(u,c,f){switch(f){case 156:a.SheetNames.push(u.name),r.Sheets.push(u);break;case 153:r.WBProps=u;break;case 39:u.Sheet!=null&&(e.SID=u.Sheet),u.Ref=ys(u.Ptg,null,null,a,e),delete e.SID,delete u.Ptg,s.push(u);break;case 1036:break;case 357:case 358:case 355:case 667:a[0].length?a.push([f,u]):a[0]=[f,u],a[a.length-1].XTI=[];break;case 362:a.length===0&&(a[0]=[],a[0].XTI=[]),a[a.length-1].XTI=a[a.length-1].XTI.concat(u),a.XTI=a.XTI.concat(u);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(f),i=!0;break;case 36:n.pop(),i=!1;break;case 37:n.push(f),i=!0;break;case 38:n.pop(),i=!1;break;case 16:break;default:if(!c.T){if(!i||e.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}},e),gne(r),r.Names=s,r.supbooks=a,r}function y5e(t,e){Ue(t,143);for(var r=0;r!=e.SheetNames.length;++r){var n=e.Workbook&&e.Workbook.Sheets&&e.Workbook.Sheets[r]&&e.Workbook.Sheets[r].Hidden||0,i={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:e.SheetNames[r]};Ue(t,156,d5e(i))}Ue(t,144)}function S5e(t,e){e||(e=Fe(127));for(var r=0;r!=4;++r)e.write_shift(4,0);return zi("SheetJS",e),zi(W1.version,e),zi(W1.version,e),zi("7262",e),e.length>e.l?e.slice(0,e.l):e}function b5e(t,e){e||(e=Fe(29)),e.write_shift(-4,0),e.write_shift(-4,460),e.write_shift(4,28800),e.write_shift(4,17600),e.write_shift(4,500),e.write_shift(4,t),e.write_shift(4,t);var r=120;return e.write_shift(1,r),e.length>e.l?e.slice(0,e.l):e}function C5e(t,e){if(!(!e.Workbook||!e.Workbook.Sheets)){for(var r=e.Workbook.Sheets,n=0,i=-1,s=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&i==-1?i=n:r[n].Hidden==1&&s==-1&&(s=n);s>i||(Ue(t,135),Ue(t,158,b5e(i)),Ue(t,136))}}function x5e(t,e){var r=ya();return Ue(r,131),Ue(r,128,S5e()),Ue(r,153,m5e(t.Workbook&&t.Workbook.WBProps||null)),C5e(r,t),y5e(r,t),Ue(r,132),r.end()}function E5e(t,e,r){return e.slice(-4)===".bin"?w5e(t,r):h5e(t,r)}function _5e(t,e,r,n,i,s,a,o){return e.slice(-4)===".bin"?WUe(t,n,r,i,s,a,o):w$e(t,n,r,i,s,a,o)}function R5e(t,e,r,n,i,s,a,o){return e.slice(-4)===".bin"?n5e(t,n,r,i,s):t5e(t,n,r,i,s)}function T5e(t,e,r,n,i,s,a,o){return e.slice(-4)===".bin"?O8e():k8e()}function M5e(t,e,r,n,i,s,a,o){return e.slice(-4)===".bin"?M8e():A8e()}function A5e(t,e,r,n){return e.slice(-4)===".bin"?_6e(t,r,n):d6e(t,r,n)}function O5e(t,e,r){return Xre(t,r)}function k5e(t,e,r){return e.slice(-4)===".bin"?DVe(t,r):AVe(t,r)}function D5e(t,e,r){return e.slice(-4)===".bin"?x8e(t,r):g8e(t,r)}function P5e(t,e,r){return e.slice(-4)===".bin"?h8e(t):u8e(t)}function I5e(t,e,r,n){return r.slice(-4)===".bin"?f8e(t,e,r,n):void 0}function N5e(t,e,r){return e.slice(-4)===".bin"?a8e(t,e,r):l8e(t,e,r)}function H5e(t,e,r){return(e.slice(-4)===".bin"?x5e:vne)(t)}function F5e(t,e,r,n,i){return(e.slice(-4)===".bin"?ZUe:hne)(t,r,n,i)}function L5e(t,e,r){return(e.slice(-4)===".bin"?N6e:qre)(t,r)}function B5e(t,e,r){return(e.slice(-4)===".bin"?NVe:Vre)(t,r)}function V5e(t,e,r){return(e.slice(-4)===".bin"?E8e:Jre)(t)}function W5e(t){return(t.slice(-4)===".bin"?o8e:Qre)()}var wne=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,yne=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function gl(t,e){var r=t.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var i=t.match(wne),s,a,o,u;if(i)for(u=0;u!=i.length;++u)s=i[u].match(yne),(a=s[1].indexOf(":"))===-1?n[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?o="xmlns"+s[1].slice(6):o=s[1].slice(a+1),n[o]=s[2].slice(1,s[2].length-1));return n}function $5e(t){var e=t.split(/\s+/),r={};if(e.length===1)return r;var n=t.match(wne),i,s,a,o;if(n)for(o=0;o!=n.length;++o)i=n[o].match(yne),(s=i[1].indexOf(":"))===-1?r[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?a="xmlns"+i[1].slice(6):a=i[1].slice(s+1),r[a]=i[2].slice(1,i[2].length-1));return r}var u1;function U5e(t,e){var r=u1[t]||Cr(t);return r==="General"?$g(e):Ja(r,e)}function j5e(t,e,r,n){var i=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":i=dn(n);break;case"i2":case"int":i=parseInt(n,10);break;case"r4":case"float":i=parseFloat(n);break;case"date":case"dateTime.tz":i=pn(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}t[Cr(e)]=i}function Y5e(t,e,r){if(t.t!=="z"){if(!r||r.cellText!==!1)try{t.t==="e"?t.w=t.w||mh[t.v]:e==="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=U1(t.v):t.w=$g(t.v):t.w=U5e(e||"General",t.v)}catch(s){if(r.WTF)throw s}try{var n=u1[e]||e||"General";if(r.cellNF&&(t.z=n),r.cellDates&&t.t=="n"&&cm(n)){var i=Rf(t.v);i&&(t.t="d",t.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}catch(s){if(r.WTF)throw s}}}function z5e(t,e,r){if(r.cellStyles&&e.Interior){var n=e.Interior;n.Pattern&&(n.patternType=s6e[n.Pattern]||n.Pattern)}t[e.ID]=e}function G5e(t,e,r,n,i,s,a,o,u,c){var f="General",g=n.StyleID,m={};c=c||{};var v=[],w=0;for(g===void 0&&o&&(g=o.StyleID),g===void 0&&a&&(g=a.StyleID);s[g]!==void 0&&(s[g].nf&&(f=s[g].nf),s[g].Interior&&v.push(s[g].Interior),!!s[g].Parent);)g=s[g].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=dn(t);break;case"String":n.t="s",n.r=uG(Cr(t)),n.v=t.indexOf("<")>-1?Cr(e||t).replace(/<.*?>/g,""):n.r;break;case"DateTime":t.slice(-1)!="Z"&&(t+="Z"),n.v=(pn(t)-new Date(Date.UTC(1899,11,30)))/(1440*60*1e3),n.v!==n.v?n.v=Cr(t):n.v<60&&(n.v=n.v-1),(!f||f=="General")&&(f="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+t),n.t||(n.t="n");break;case"Error":n.t="e",n.v=fre[t],c.cellText!==!1&&(n.w=t);break;default:t==""&&e==""?n.t="z":(n.t="s",n.v=uG(e||t));break}if(Y5e(n,f,c),c.cellFormula!==!1)if(n.Formula){var y=Cr(n.Formula);y.charCodeAt(0)==61&&(y=y.slice(1)),n.f=Sp(y,i),delete n.Formula,n.ArrayRange=="RC"?n.F=Sp("RC:RC",i):n.ArrayRange&&(n.F=Sp(n.ArrayRange,i),u.push([ar(n.F),n.F]))}else for(w=0;w<u.length;++w)i.r>=u[w][0].s.r&&i.r<=u[w][0].e.r&&i.c>=u[w][0].s.c&&i.c<=u[w][0].e.c&&(n.F=u[w][1]);c.cellStyles&&(v.forEach(function(b){!m.patternType&&b.patternType&&(m.patternType=b.patternType)}),n.s=m),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function q5e(t){t.t=t.v||"",t.t=t.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.v=t.w=t.ixfe=void 0}function xI(t,e){var r=e||{};fv();var n=ap(G3(t));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(typeof gr<"u"?n=gr.utils.decode(65001,U_(n)):n=Zr(n));var i=n.slice(0,1024).toLowerCase(),s=!1;if(i=i.replace(/".*?"/g,""),(i.indexOf(">")&1023)>Math.min(i.indexOf(",")&1023,i.indexOf(";")&1023)){var a=rn(r);return a.type="string",Bp.to_workbook(n,a)}if(i.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(ge){i.indexOf("<"+ge)>=0&&(s=!0)}),s)return Oje(n,r);u1={"General Number":"General","General Date":xt[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":xt[15],"Short Date":xt[14],"Long Time":xt[19],"Medium Time":xt[18],"Short Time":xt[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:xt[2],Standard:xt[4],Percent:xt[10],Scientific:xt[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,u=[],c,f={},g=[],m=r.dense?[]:{},v="",w={},y={},b=gl('<Data ss:Type="String">'),x=0,_=0,T=0,D={s:{r:2e6,c:2e6},e:{r:0,c:0}},P={},O={},A="",W=0,L=[],H={},J={},G=0,ve=[],be=[],we={},ae=[],le,Te=!1,ce=[],K=[],Se={},B=0,E=0,R={Sheets:[],WBProps:{date1904:!1}},M={};z1.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var F="";o=z1.exec(n);)switch(o[3]=(F=o[3]).toLowerCase()){case"data":if(F=="data"){if(o[1]==="/"){if((c=u.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&u.push([o[3],!0]);break}if(u[u.length-1][1])break;o[1]==="/"?G5e(n.slice(x,o.index),A,b,u[u.length-1][0]=="comment"?we:w,{c:_,r:T},P,ae[_],y,ce,r):(A="",b=gl(o[0]),x=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(be.length>0&&(w.c=be),(!r.sheetRows||r.sheetRows>T)&&w.v!==void 0&&(r.dense?(m[T]||(m[T]=[]),m[T][_]=w):m[mn(_)+jn(T)]=w),w.HRef&&(w.l={Target:Cr(w.HRef)},w.HRefScreenTip&&(w.l.Tooltip=w.HRefScreenTip),delete w.HRef,delete w.HRefScreenTip),(w.MergeAcross||w.MergeDown)&&(B=_+(parseInt(w.MergeAcross,10)|0),E=T+(parseInt(w.MergeDown,10)|0),L.push({s:{c:_,r:T},e:{c:B,r:E}})),!r.sheetStubs)w.MergeAcross?_=B+1:++_;else if(w.MergeAcross||w.MergeDown){for(var Z=_;Z<=B;++Z)for(var te=T;te<=E;++te)(Z>_||te>T)&&(r.dense?(m[te]||(m[te]=[]),m[te][Z]={t:"z"}):m[mn(Z)+jn(te)]={t:"z"});_=B+1}else++_;else w=$5e(o[0]),w.Index&&(_=+w.Index-1),_<D.s.c&&(D.s.c=_),_>D.e.c&&(D.e.c=_),o[0].slice(-2)==="/>"&&++_,be=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(T<D.s.r&&(D.s.r=T),T>D.e.r&&(D.e.r=T),o[0].slice(-2)==="/>"&&(y=gl(o[0]),y.Index&&(T=+y.Index-1)),_=0,++T):(y=gl(o[0]),y.Index&&(T=+y.Index-1),Se={},(y.AutoFitHeight=="0"||y.Height)&&(Se.hpx=parseInt(y.Height,10),Se.hpt=Q1(Se.hpx),K[T]=Se),y.Hidden=="1"&&(Se.hidden=!0,K[T]=Se));break;case"worksheet":if(o[1]==="/"){if((c=u.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));g.push(v),D.s.r<=D.e.r&&D.s.c<=D.e.c&&(m["!ref"]=Ht(D),r.sheetRows&&r.sheetRows<=D.e.r&&(m["!fullref"]=m["!ref"],D.e.r=r.sheetRows-1,m["!ref"]=Ht(D))),L.length&&(m["!merges"]=L),ae.length>0&&(m["!cols"]=ae),K.length>0&&(m["!rows"]=K),f[v]=m}else D={s:{r:2e6,c:2e6},e:{r:0,c:0}},T=_=0,u.push([o[3],!1]),c=gl(o[0]),v=Cr(c.Name),m=r.dense?[]:{},L=[],ce=[],K=[],M={name:v,Hidden:0},R.Sheets.push(M);break;case"table":if(o[1]==="/"){if((c=u.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else{if(o[0].slice(-2)=="/>")break;u.push([o[3],!1]),ae=[],Te=!1}break;case"style":o[1]==="/"?z5e(P,O,r):O=gl(o[0]);break;case"numberformat":O.nf=Cr(gl(o[0]).Format||"General"),u1[O.nf]&&(O.nf=u1[O.nf]);for(var fe=0;fe!=392&&xt[fe]!=O.nf;++fe);if(fe==392){for(fe=57;fe!=392;++fe)if(xt[fe]==null){Hu(O.nf,fe);break}}break;case"column":if(u[u.length-1][0]!=="table")break;if(le=gl(o[0]),le.Hidden&&(le.hidden=!0,delete le.Hidden),le.Width&&(le.wpx=parseInt(le.Width,10)),!Te&&le.wpx>10){Te=!0,Cs=zre;for(var I=0;I<ae.length;++I)ae[I]&&jf(ae[I])}Te&&jf(le),ae[le.Index-1||ae.length]=le;for(var U=0;U<+le.Span;++U)ae[ae.length]=rn(le);break;case"namedrange":if(o[1]==="/")break;R.Names||(R.Names=[]);var k=Ot(o[0]),ee={Name:k.Name,Ref:Sp(k.RefersTo.slice(1),{r:0,c:0})};R.Sheets.length>0&&(ee.Sheet=R.Sheets.length-1),R.Names.push(ee);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?A+=n.slice(W,o.index):W=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;O.Interior=gl(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?y3e(H,F,n.slice(G,o.index)):G=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((c=u.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else u.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((c=u.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));q5e(we),be.push(we)}else u.push([o[3],!1]),c=gl(o[0]),we={a:c.Author};break;case"autofilter":if(o[1]==="/"){if((c=u.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var oe=gl(o[0]);m["!autofilter"]={ref:Sp(oe.Range).replace(/\$/g,"")},u.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((c=u.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&u.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((c=u.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&u.push([o[3],!0]);break;case"null":break;default:if(u.length==0&&o[3]=="document"||u.length==0&&o[3]=="uof")return QG(n,r);var de=!0;switch(u[u.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:de=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:de=!1}break;case"excelworkbook":switch(o[3]){case"date1904":R.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:de=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:de=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(G,o.index)){case"SheetHidden":M.Hidden=1;break;case"SheetVeryHidden":M.Hidden=2;break}else G=o.index+o[0].length;break;case"header":m["!margins"]||Ag(m["!margins"]={},"xlml"),isNaN(+Ot(o[0]).Margin)||(m["!margins"].header=+Ot(o[0]).Margin);break;case"footer":m["!margins"]||Ag(m["!margins"]={},"xlml"),isNaN(+Ot(o[0]).Margin)||(m["!margins"].footer=+Ot(o[0]).Margin);break;case"pagemargins":var pe=Ot(o[0]);m["!margins"]||Ag(m["!margins"]={},"xlml"),isNaN(+pe.Top)||(m["!margins"].top=+pe.Top),isNaN(+pe.Left)||(m["!margins"].left=+pe.Left),isNaN(+pe.Right)||(m["!margins"].right=+pe.Right),isNaN(+pe.Bottom)||(m["!margins"].bottom=+pe.Bottom);break;case"displayrighttoleft":R.Views||(R.Views=[]),R.Views[0]||(R.Views[0]={}),R.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":m["!outline"]||(m["!outline"]={}),m["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":m["!outline"]||(m["!outline"]={}),m["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:de=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:de=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:de=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:de=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:de=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:de=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:de=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:de=!1}break;case"smarttags":break;default:de=!1;break}if(de||o[3].match(/!\[CDATA/))break;if(!u[u.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+u.join("|");if(u[u.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?j5e(J,F,ve,n.slice(G,o.index)):(ve=o,G=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+u.join("|")}var Q={};return!r.bookSheets&&!r.bookProps&&(Q.Sheets=f),Q.SheetNames=g,Q.Workbook=R,Q.SSF=rn(xt),Q.Props=H,Q.Custprops=J,Q}function oH(t,e){switch(CB(e=e||{}),e.type||"base64"){case"base64":return xI(Za(t),e);case"binary":case"buffer":case"file":return xI(t,e);case"array":return xI(td(t),e)}}function K5e(t,e){var r=[];return t.Props&&r.push(S3e(t.Props,e)),t.Custprops&&r.push(b3e(t.Props,t.Custprops)),r.join("")}function X5e(){return""}function Q5e(t,e){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return e.cellXfs.forEach(function(n,i){var s=[];s.push(qe("NumberFormat",null,{"ss:Format":Gr(xt[n.numFmtId])}));var a={"ss:ID":"s"+(21+i)};r.push(qe("Style",s.join(""),a))}),qe("Styles",r.join(""))}function Sne(t){return qe("NamedRange",null,{"ss:Name":t.Name,"ss:RefersTo":"="+mB(t.Ref,{r:0,c:0})})}function Z5e(t){if(!((t||{}).Workbook||{}).Names)return"";for(var e=t.Workbook.Names,r=[],n=0;n<e.length;++n){var i=e[n];i.Sheet==null&&(i.Name.match(/^_xlfn\./)||r.push(Sne(i)))}return qe("Names",r.join(""))}function J5e(t,e,r,n){if(!t||!((n||{}).Workbook||{}).Names)return"";for(var i=n.Workbook.Names,s=[],a=0;a<i.length;++a){var o=i[a];o.Sheet==r&&(o.Name.match(/^_xlfn\./)||s.push(Sne(o)))}return s.join("")}function eje(t,e,r,n){if(!t)return"";var i=[];if(t["!margins"]&&(i.push("<PageSetup>"),t["!margins"].header&&i.push(qe("Header",null,{"x:Margin":t["!margins"].header})),t["!margins"].footer&&i.push(qe("Footer",null,{"x:Margin":t["!margins"].footer})),i.push(qe("PageMargins",null,{"x:Bottom":t["!margins"].bottom||"0.75","x:Left":t["!margins"].left||"0.7","x:Right":t["!margins"].right||"0.7","x:Top":t["!margins"].top||"0.75"})),i.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)i.push(qe("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<r&&!(n.Workbook.Sheets[s]&&!n.Workbook.Sheets[s].Hidden);++s);s==r&&i.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),t["!protect"]&&(i.push(is("ProtectContents","True")),t["!protect"].objects&&i.push(is("ProtectObjects","True")),t["!protect"].scenarios&&i.push(is("ProtectScenarios","True")),t["!protect"].selectLockedCells!=null&&!t["!protect"].selectLockedCells?i.push(is("EnableSelection","NoSelection")):t["!protect"].selectUnlockedCells!=null&&!t["!protect"].selectUnlockedCells&&i.push(is("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(a){t["!protect"][a[0]]&&i.push("<"+a[1]+"/>")})),i.length==0?"":qe("WorksheetOptions",i.join(""),{xmlns:za.x})}function tje(t){return t.map(function(e){var r=x4e(e.t||""),n=qe("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return qe("Comment",n,{"ss:Author":e.a})}).join("")}function rje(t,e,r,n,i,s,a){if(!t||t.v==null&&t.f==null)return"";var o={};if(t.f&&(o["ss:Formula"]="="+Gr(mB(t.f,a))),t.F&&t.F.slice(0,e.length)==e){var u=Dn(t.F.slice(e.length+1));o["ss:ArrayRange"]="RC:R"+(u.r==a.r?"":"["+(u.r-a.r)+"]")+"C"+(u.c==a.c?"":"["+(u.c-a.c)+"]")}if(t.l&&t.l.Target&&(o["ss:HRef"]=Gr(t.l.Target),t.l.Tooltip&&(o["x:HRefScreenTip"]=Gr(t.l.Tooltip))),r["!merges"])for(var c=r["!merges"],f=0;f!=c.length;++f)c[f].s.c!=a.c||c[f].s.r!=a.r||(c[f].e.c>c[f].s.c&&(o["ss:MergeAcross"]=c[f].e.c-c[f].s.c),c[f].e.r>c[f].s.r&&(o["ss:MergeDown"]=c[f].e.r-c[f].s.r));var g="",m="";switch(t.t){case"z":if(!n.sheetStubs)return"";break;case"n":g="Number",m=String(t.v);break;case"b":g="Boolean",m=t.v?"1":"0";break;case"e":g="Error",m=mh[t.v];break;case"d":g="DateTime",m=new Date(t.v).toISOString(),t.z==null&&(t.z=t.z||xt[14]);break;case"s":g="String",m=C4e(t.v||"");break}var v=nd(n.cellXfs,t,n);o["ss:StyleID"]="s"+(21+v),o["ss:Index"]=a.c+1;var w=t.v!=null?m:"",y=t.t=="z"?"":'<Data ss:Type="'+g+'">'+w+"</Data>";return(t.c||[]).length>0&&(y+=tje(t.c)),qe("Cell",y,o)}function nje(t,e){var r='<Row ss:Index="'+(t+1)+'"';return e&&(e.hpt&&!e.hpx&&(e.hpx=Vp(e.hpt)),e.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+e.hpx+'"'),e.hidden&&(r+=' ss:Hidden="1"')),r+">"}function ije(t,e,r,n){if(!t["!ref"])return"";var i=ar(t["!ref"]),s=t["!merges"]||[],a=0,o=[];t["!cols"]&&t["!cols"].forEach(function(b,x){jf(b);var _=!!b.width,T=IT(x,b),D={"ss:Index":x+1};_&&(D["ss:Width"]=K1(T.width)),b.hidden&&(D["ss:Hidden"]="1"),o.push(qe("Column",null,D))});for(var u=Array.isArray(t),c=i.s.r;c<=i.e.r;++c){for(var f=[nje(c,(t["!rows"]||[])[c])],g=i.s.c;g<=i.e.c;++g){var m=!1;for(a=0;a!=s.length;++a)if(!(s[a].s.c>g)&&!(s[a].s.r>c)&&!(s[a].e.c<g)&&!(s[a].e.r<c)){(s[a].s.c!=g||s[a].s.r!=c)&&(m=!0);break}if(!m){var v={r:c,c:g},w=Tt(v),y=u?(t[c]||[])[g]:t[w];f.push(rje(y,w,t,e,r,n,v))}}f.push("</Row>"),f.length>2&&o.push(f.join(""))}return o.join("")}function sje(t,e,r){var n=[],i=r.SheetNames[t],s=r.Sheets[i],a=s?J5e(s,e,t,r):"";return a.length>0&&n.push("<Names>"+a+"</Names>"),a=s?ije(s,e,t,r):"",a.length>0&&n.push("<Table>"+a+"</Table>"),n.push(eje(s,e,t,r)),n.join("")}function aje(t,e){e||(e={}),t.SSF||(t.SSF=rn(xt)),t.SSF&&(fv(),BS(t.SSF),e.revssf=MT(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF,e.cellXfs=[],nd(e.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(K5e(t,e)),r.push(X5e()),r.push(""),r.push("");for(var n=0;n<t.SheetNames.length;++n)r.push(qe("Worksheet",sje(n,e,t),{"ss:Name":Gr(t.SheetNames[n])}));return r[2]=Q5e(t,e),r[3]=Z5e(t),hi+qe("Workbook",r.join(""),{xmlns:za.ss,"xmlns:o":za.o,"xmlns:x":za.x,"xmlns:ss":za.ss,"xmlns:dt":za.dt,"xmlns:html":za.html})}function oje(t){var e={},r=t.content;if(r.l=28,e.AnsiUserType=r.read_shift(0,"lpstr-ansi"),e.AnsiClipboardFormat=J4e(r),r.length-r.l<=4)return e;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,e.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(e.UnicodeClipboardFormat=e3e(r),n=r.read_shift(4),n==0||n>40))return e;r.l-=4,e.Reserved2=r.read_shift(0,"lpwstr")}var lje=[60,1084,2066,2165,2175];function uje(t,e,r,n,i){var s=n,a=[],o=r.slice(r.l,r.l+s);if(i&&i.enc&&i.enc.insitu&&o.length>0)switch(t){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:i.enc.insitu(o)}a.push(o),r.l+=s;for(var u=Uc(r,r.l),c=lH[u],f=0;c!=null&&lje.indexOf(u)>-1;)s=Uc(r,r.l+2),f=r.l+4,u==2066?f+=4:(u==2165||u==2175)&&(f+=12),o=r.slice(f,r.l+4+s),a.push(o),r.l+=4+s,c=lH[u=Uc(r,r.l)];var g=Yi(a);rs(g,0);var m=0;g.lens=[];for(var v=0;v<a.length;++v)g.lens.push(m),m+=a[v].length;if(g.length<n)throw"XLS Record 0x"+t.toString(16)+" Truncated: "+g.length+" < "+n;return e.f(g,g.length,i)}function ou(t,e,r){if(t.t!=="z"&&t.XF){var n=0;try{n=t.z||t.XF.numFmtId||0,e.cellNF&&(t.z=xt[n])}catch(s){if(e.WTF)throw s}if(!e||e.cellText!==!1)try{t.t==="e"?t.w=t.w||mh[t.v]:n===0||n=="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=U1(t.v):t.w=$g(t.v):t.w=Ja(n,t.v,{date1904:!!r,dateNF:e&&e.dateNF})}catch(s){if(e.WTF)throw s}if(e.cellDates&&n&&t.t=="n"&&cm(xt[n]||String(n))){var i=Rf(t.v);i&&(t.t="d",t.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}}function Qx(t,e,r){return{v:t,ixfe:e,t:r}}function cje(t,e){var r={opts:{}},n={},i=e.dense?[]:{},s={},a={},o=null,u=[],c="",f={},g,m="",v,w,y,b,x={},_=[],T,D,P=[],O=[],A={Sheets:[],WBProps:{date1904:!1},Views:[{}]},W={},L=function(yt){return yt<8?Rg[yt]:yt<64&&O[yt-8]||Rg[yt]},H=function(yt,pr,sn){var Dt=pr.XF.data;if(!(!Dt||!Dt.patternType||!sn||!sn.cellStyles)){pr.s={},pr.s.patternType=Dt.patternType;var Kt;(Kt=q1(L(Dt.icvFore)))&&(pr.s.fgColor={rgb:Kt}),(Kt=q1(L(Dt.icvBack)))&&(pr.s.bgColor={rgb:Kt})}},J=function(yt,pr,sn){if(!(Se>1)&&!(sn.sheetRows&&yt.r>=sn.sheetRows)){if(sn.cellStyles&&pr.XF&&pr.XF.data&&H(yt,pr,sn),delete pr.ixfe,delete pr.XF,g=yt,m=Tt(yt),(!a||!a.s||!a.e)&&(a={s:{r:0,c:0},e:{r:0,c:0}}),yt.r<a.s.r&&(a.s.r=yt.r),yt.c<a.s.c&&(a.s.c=yt.c),yt.r+1>a.e.r&&(a.e.r=yt.r+1),yt.c+1>a.e.c&&(a.e.c=yt.c+1),sn.cellFormula&&pr.f){for(var Dt=0;Dt<_.length;++Dt)if(!(_[Dt][0].s.c>yt.c||_[Dt][0].s.r>yt.r)&&!(_[Dt][0].e.c<yt.c||_[Dt][0].e.r<yt.r)){pr.F=Ht(_[Dt][0]),(_[Dt][0].s.c!=yt.c||_[Dt][0].s.r!=yt.r)&&delete pr.f,pr.f&&(pr.f=""+ys(_[Dt][1],a,yt,ce,G));break}}sn.dense?(i[yt.r]||(i[yt.r]=[]),i[yt.r][yt.c]=pr):i[m]=pr}},G={enc:!1,sbcch:0,snames:[],sharedf:x,arrayf:_,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!e&&!!e.cellStyles,WTF:!!e&&!!e.wtf};e.password&&(G.password=e.password);var ve,be=[],we=[],ae=[],le=[],Te=!1,ce=[];ce.SheetNames=G.snames,ce.sharedf=G.sharedf,ce.arrayf=G.arrayf,ce.names=[],ce.XTI=[];var K=0,Se=0,B=0,E=[],R=[],M;G.codepage=1200,Bo(1200);for(var F=!1;t.l<t.length-1;){var Z=t.l,te=t.read_shift(2);if(te===0&&K===10)break;var fe=t.l===t.length?0:t.read_shift(2),I=lH[te];if(I&&I.f){if(e.bookSheets&&K===133&&te!==133)break;if(K=te,I.r===2||I.r==12){var U=t.read_shift(2);if(fe-=2,!G.enc&&U!==te&&((U&255)<<8|U>>8)!==te)throw new Error("rt mismatch: "+U+"!="+te);I.r==12&&(t.l+=10,fe-=10)}var k={};if(te===10?k=I.f(t,fe,G):k=uje(te,I,t,fe,G),Se==0&&[9,521,1033,2057].indexOf(K)===-1)continue;switch(te){case 34:r.opts.Date1904=A.WBProps.date1904=k;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(G.enc||(t.l=0),G.enc=k,!e.password)throw new Error("File is password-protected");if(k.valid==null)throw new Error("Encryption scheme unsupported");if(!k.valid)throw new Error("Password is incorrect");break;case 92:G.lastuser=k;break;case 66:var ee=Number(k);switch(ee){case 21010:ee=1200;break;case 32768:ee=1e4;break;case 32769:ee=1252;break}Bo(G.codepage=ee),F=!0;break;case 317:G.rrtabid=k;break;case 25:G.winlocked=k;break;case 439:r.opts.RefreshAll=k;break;case 12:r.opts.CalcCount=k;break;case 16:r.opts.CalcDelta=k;break;case 17:r.opts.CalcIter=k;break;case 13:r.opts.CalcMode=k;break;case 14:r.opts.CalcPrecision=k;break;case 95:r.opts.CalcSaveRecalc=k;break;case 15:G.CalcRefMode=k;break;case 2211:r.opts.FullCalc=k;break;case 129:k.fDialog&&(i["!type"]="dialog"),k.fBelow||((i["!outline"]||(i["!outline"]={})).above=!0),k.fRight||((i["!outline"]||(i["!outline"]={})).left=!0);break;case 224:P.push(k);break;case 430:ce.push([k]),ce[ce.length-1].XTI=[];break;case 35:case 547:ce[ce.length-1].push(k);break;case 24:case 536:M={Name:k.Name,Ref:ys(k.rgce,a,null,ce,G)},k.itab>0&&(M.Sheet=k.itab-1),ce.names.push(M),ce[0]||(ce[0]=[],ce[0].XTI=[]),ce[ce.length-1].push(k),k.Name=="_xlnm._FilterDatabase"&&k.itab>0&&k.rgce&&k.rgce[0]&&k.rgce[0][0]&&k.rgce[0][0][0]=="PtgArea3d"&&(R[k.itab-1]={ref:Ht(k.rgce[0][0][1][2])});break;case 22:G.ExternCount=k;break;case 23:ce.length==0&&(ce[0]=[],ce[0].XTI=[]),ce[ce.length-1].XTI=ce[ce.length-1].XTI.concat(k),ce.XTI=ce.XTI.concat(k);break;case 2196:if(G.biff<8)break;M!=null&&(M.Comment=k[1]);break;case 18:i["!protect"]=k;break;case 19:k!==0&&G.WTF&&console.error("Password verifier: "+k);break;case 133:s[k.pos]=k,G.snames.push(k.name);break;case 10:{if(--Se)break;if(a.e){if(a.e.r>0&&a.e.c>0){if(a.e.r--,a.e.c--,i["!ref"]=Ht(a),e.sheetRows&&e.sheetRows<=a.e.r){var oe=a.e.r;a.e.r=e.sheetRows-1,i["!fullref"]=i["!ref"],i["!ref"]=Ht(a),a.e.r=oe}a.e.r++,a.e.c++}be.length>0&&(i["!merges"]=be),we.length>0&&(i["!objects"]=we),ae.length>0&&(i["!cols"]=ae),le.length>0&&(i["!rows"]=le),A.Sheets.push(W)}c===""?f=i:n[c]=i,i=e.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(G.biff===8&&(G.biff={9:2,521:3,1033:4}[te]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[k.BIFFVer]||8),G.biffguess=k.BIFFVer==0,k.BIFFVer==0&&k.dt==4096&&(G.biff=5,F=!0,Bo(G.codepage=28591)),G.biff==8&&k.BIFFVer==0&&k.dt==16&&(G.biff=2),Se++)break;if(i=e.dense?[]:{},G.biff<8&&!F&&(F=!0,Bo(G.codepage=e.codepage||1252)),G.biff<5||k.BIFFVer==0&&k.dt==4096){c===""&&(c="Sheet1"),a={s:{r:0,c:0},e:{r:0,c:0}};var de={pos:t.l-fe,name:c};s[de.pos]=de,G.snames.push(c)}else c=(s[Z]||{name:""}).name;k.dt==32&&(i["!type"]="chart"),k.dt==64&&(i["!type"]="macro"),be=[],we=[],G.arrayf=_=[],ae=[],le=[],Te=!1,W={Hidden:(s[Z]||{hs:0}).hs,name:c}}break;case 515:case 3:case 2:i["!type"]=="chart"&&(e.dense?(i[k.r]||[])[k.c]:i[Tt({c:k.c,r:k.r})])&&++k.c,T={ixfe:k.ixfe,XF:P[k.ixfe]||{},v:k.val,t:"n"},B>0&&(T.z=E[T.ixfe>>8&63]),ou(T,e,r.opts.Date1904),J({c:k.c,r:k.r},T,e);break;case 5:case 517:T={ixfe:k.ixfe,XF:P[k.ixfe],v:k.val,t:k.t},B>0&&(T.z=E[T.ixfe>>8&63]),ou(T,e,r.opts.Date1904),J({c:k.c,r:k.r},T,e);break;case 638:T={ixfe:k.ixfe,XF:P[k.ixfe],v:k.rknum,t:"n"},B>0&&(T.z=E[T.ixfe>>8&63]),ou(T,e,r.opts.Date1904),J({c:k.c,r:k.r},T,e);break;case 189:for(var pe=k.c;pe<=k.C;++pe){var Q=k.rkrec[pe-k.c][0];T={ixfe:Q,XF:P[Q],v:k.rkrec[pe-k.c][1],t:"n"},B>0&&(T.z=E[T.ixfe>>8&63]),ou(T,e,r.opts.Date1904),J({c:pe,r:k.r},T,e)}break;case 6:case 518:case 1030:{if(k.val=="String"){o=k;break}if(T=Qx(k.val,k.cell.ixfe,k.tt),T.XF=P[T.ixfe],e.cellFormula){var ge=k.formula;if(ge&&ge[0]&&ge[0][0]&&ge[0][0][0]=="PtgExp"){var xe=ge[0][0][1][0],_e=ge[0][0][1][1],Ne=Tt({r:xe,c:_e});x[Ne]?T.f=""+ys(k.formula,a,k.cell,ce,G):T.F=((e.dense?(i[xe]||[])[_e]:i[Ne])||{}).F}else T.f=""+ys(k.formula,a,k.cell,ce,G)}B>0&&(T.z=E[T.ixfe>>8&63]),ou(T,e,r.opts.Date1904),J(k.cell,T,e),o=k}break;case 7:case 519:if(o)o.val=k,T=Qx(k,o.cell.ixfe,"s"),T.XF=P[T.ixfe],e.cellFormula&&(T.f=""+ys(o.formula,a,o.cell,ce,G)),B>0&&(T.z=E[T.ixfe>>8&63]),ou(T,e,r.opts.Date1904),J(o.cell,T,e),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{_.push(k);var Xe=Tt(k[0].s);if(v=e.dense?(i[k[0].s.r]||[])[k[0].s.c]:i[Xe],e.cellFormula&&v){if(!o||!Xe||!v)break;v.f=""+ys(k[1],a,k[0],ce,G),v.F=Ht(k[0])}}break;case 1212:{if(!e.cellFormula)break;if(m){if(!o)break;x[Tt(o.cell)]=k[0],v=e.dense?(i[o.cell.r]||[])[o.cell.c]:i[Tt(o.cell)],(v||{}).f=""+ys(k[0],a,g,ce,G)}}break;case 253:T=Qx(u[k.isst].t,k.ixfe,"s"),u[k.isst].h&&(T.h=u[k.isst].h),T.XF=P[T.ixfe],B>0&&(T.z=E[T.ixfe>>8&63]),ou(T,e,r.opts.Date1904),J({c:k.c,r:k.r},T,e);break;case 513:e.sheetStubs&&(T={ixfe:k.ixfe,XF:P[k.ixfe],t:"z"},B>0&&(T.z=E[T.ixfe>>8&63]),ou(T,e,r.opts.Date1904),J({c:k.c,r:k.r},T,e));break;case 190:if(e.sheetStubs)for(var Qe=k.c;Qe<=k.C;++Qe){var ht=k.ixfe[Qe-k.c];T={ixfe:ht,XF:P[ht],t:"z"},B>0&&(T.z=E[T.ixfe>>8&63]),ou(T,e,r.opts.Date1904),J({c:Qe,r:k.r},T,e)}break;case 214:case 516:case 4:T=Qx(k.val,k.ixfe,"s"),T.XF=P[T.ixfe],B>0&&(T.z=E[T.ixfe>>8&63]),ou(T,e,r.opts.Date1904),J({c:k.c,r:k.r},T,e);break;case 0:case 512:Se===1&&(a=k);break;case 252:u=k;break;case 1054:if(G.biff==4){E[B++]=k[1];for(var Mt=0;Mt<B+163&&xt[Mt]!=k[1];++Mt);Mt>=163&&Hu(k[1],B+163)}else Hu(k[1],k[0]);break;case 30:{E[B++]=k;for(var Et=0;Et<B+163&&xt[Et]!=k;++Et);Et>=163&&Hu(k,B+163)}break;case 229:be=be.concat(k);break;case 93:we[k.cmo[0]]=G.lastobj=k;break;case 438:G.lastobj.TxO=k;break;case 127:G.lastobj.ImData=k;break;case 440:for(b=k[0].s.r;b<=k[0].e.r;++b)for(y=k[0].s.c;y<=k[0].e.c;++y)v=e.dense?(i[b]||[])[y]:i[Tt({c:y,r:b})],v&&(v.l=k[1]);break;case 2048:for(b=k[0].s.r;b<=k[0].e.r;++b)for(y=k[0].s.c;y<=k[0].e.c;++y)v=e.dense?(i[b]||[])[y]:i[Tt({c:y,r:b})],v&&v.l&&(v.l.Tooltip=k[1]);break;case 28:{if(G.biff<=5&&G.biff>=2)break;v=e.dense?(i[k[0].r]||[])[k[0].c]:i[Tt(k[0])];var at=we[k[2]];v||(e.dense?(i[k[0].r]||(i[k[0].r]=[]),v=i[k[0].r][k[0].c]={t:"z"}):v=i[Tt(k[0])]={t:"z"},a.e.r=Math.max(a.e.r,k[0].r),a.s.r=Math.min(a.s.r,k[0].r),a.e.c=Math.max(a.e.c,k[0].c),a.s.c=Math.min(a.s.c,k[0].c)),v.c||(v.c=[]),w={a:k[1],t:at.TxO.t},v.c.push(w)}break;case 2173:Z6e(P[k.ixfe],k.ext);break;case 125:{if(!G.cellStyles)break;for(;k.e>=k.s;)ae[k.e--]={width:k.w/256,level:k.level||0,hidden:!!(k.flags&1)},Te||(Te=!0,fB(k.w/256)),jf(ae[k.e+1])}break;case 520:{var nt={};k.level!=null&&(le[k.r]=nt,nt.level=k.level),k.hidden&&(le[k.r]=nt,nt.hidden=!0),k.hpt&&(le[k.r]=nt,nt.hpt=k.hpt,nt.hpx=Vp(k.hpt))}break;case 38:case 39:case 40:case 41:i["!margins"]||Ag(i["!margins"]={}),i["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[te]]=k;break;case 161:i["!margins"]||Ag(i["!margins"]={}),i["!margins"].header=k.header,i["!margins"].footer=k.footer;break;case 574:k.RTL&&(A.Views[0].RTL=!0);break;case 146:O=k;break;case 2198:ve=k;break;case 140:D=k;break;case 442:c?W.CodeName=k||W.name:A.WBProps.CodeName=k||"ThisWorkbook";break}}else I||console.error("Missing Info for XLS Record 0x"+te.toString(16)),t.l+=fe}return r.SheetNames=Gn(s).sort(function(pt,yt){return Number(pt)-Number(yt)}).map(function(pt){return s[pt].name}),e.bookSheets||(r.Sheets=n),!r.SheetNames.length&&f["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=f)):r.Preamble=f,r.Sheets&&R.forEach(function(pt,yt){r.Sheets[r.SheetNames[yt]]["!autofilter"]=pt}),r.Strings=u,r.SSF=rn(xt),G.enc&&(r.Encryption=G.enc),ve&&(r.Themes=ve),r.Metadata={},D!==void 0&&(r.Metadata.Country=D),ce.names.length>0&&(A.Names=ce.names),r.Workbook=A,r}var c1={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function hje(t,e,r){var n=vt.find(t,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var i=TG(n,tH,c1.DSI);for(var s in i)e[s]=i[s]}catch(c){if(r.WTF)throw c}var a=vt.find(t,"/!SummaryInformation");if(a&&a.size>0)try{var o=TG(a,rH,c1.SI);for(var u in o)e[u]==null&&(e[u]=o[u])}catch(c){if(r.WTF)throw c}e.HeadingPairs&&e.TitlesOfParts&&(wre(e.HeadingPairs,e.TitlesOfParts,e,r),delete e.HeadingPairs,delete e.TitlesOfParts)}function fje(t,e){var r=[],n=[],i=[],s=0,a,o=nG(tH,"n"),u=nG(rH,"n");if(t.Props)for(a=Gn(t.Props),s=0;s<a.length;++s)(Object.prototype.hasOwnProperty.call(o,a[s])?r:Object.prototype.hasOwnProperty.call(u,a[s])?n:i).push([a[s],t.Props[a[s]]]);if(t.Custprops)for(a=Gn(t.Custprops),s=0;s<a.length;++s)Object.prototype.hasOwnProperty.call(t.Props||{},a[s])||(Object.prototype.hasOwnProperty.call(o,a[s])?r:Object.prototype.hasOwnProperty.call(u,a[s])?n:i).push([a[s],t.Custprops[a[s]]]);var c=[];for(s=0;s<i.length;++s)_re.indexOf(i[s][0])>-1||vre.indexOf(i[s][0])>-1||i[s][1]!=null&&c.push(i[s]);n.length&&vt.utils.cfb_add(e,"/SummaryInformation",MG(n,c1.SI,u,rH)),(r.length||c.length)&&vt.utils.cfb_add(e,"/DocumentSummaryInformation",MG(r,c1.DSI,o,tH,c.length?c:null,c1.UDI))}function SB(t,e){e||(e={}),CB(e),RT(),e.codepage&&_T(e.codepage);var r,n;if(t.FullPaths){if(vt.find(t,"/encryption"))throw new Error("File is password-protected");r=vt.find(t,"!CompObj"),n=vt.find(t,"/Workbook")||vt.find(t,"/Book")}else{switch(e.type){case"base64":t=Ga(Za(t));break;case"binary":t=Ga(t);break;case"buffer":break;case"array":Array.isArray(t)||(t=Array.prototype.slice.call(t));break}rs(t,0),n={content:t}}var i,s;if(r&&oje(r),e.bookProps&&!e.bookSheets)i={};else{var a=Gt?"buffer":"array";if(n&&n.content)i=cje(n.content,e);else if((s=vt.find(t,"PerfectOffice_MAIN"))&&s.content)i=Mg.to_workbook(s.content,(e.type=a,e));else if((s=vt.find(t,"NativeContent_MAIN"))&&s.content)i=Mg.to_workbook(s.content,(e.type=a,e));else throw(s=vt.find(t,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");e.bookVBA&&t.FullPaths&&vt.find(t,"/_VBA_PROJECT_CUR/VBA/dir")&&(i.vbaraw=R8e(t))}var o={};return t.FullPaths&&hje(t,o,e),i.Props=i.Custprops=o,e.bookFiles&&(i.cfb=t),i}function dje(t,e){var r=e||{},n=vt.utils.cfb_new({root:"R"}),i="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":i="/Workbook",r.biff=8;break;case"biff5":i="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return vt.utils.cfb_add(n,i,bne(t,r)),r.biff==8&&(t.Props||t.Custprops)&&fje(t,n),r.biff==8&&t.vbaraw&&T8e(n,vt.read(t.vbaraw,{type:typeof t.vbaraw=="string"?"binary":"buffer"})),n}var Z1={0:{f:L$e},1:{f:z$e},2:{f:hUe},3:{f:eUe},4:{f:X$e},5:{f:lUe},6:{f:pUe},7:{f:iUe},8:{f:xUe},9:{f:CUe},10:{f:SUe},11:{f:bUe},12:{f:q$e},13:{f:dUe},14:{f:rUe},15:{f:Z$e},16:{f:fne},17:{f:wUe},18:{f:aUe},19:{f:rB},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:v5e},40:{},42:{},43:{f:p6e},44:{f:g6e},45:{f:y6e},46:{f:b6e},47:{f:S6e},48:{},49:{f:W4e},50:{},51:{f:t8e},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:Hre},62:{f:mUe},63:{f:c8e},64:{f:BUe},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Os,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:NUe},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:j$e},148:{f:W$e,p:16},151:{f:AUe},152:{},153:{f:g5e},154:{},155:{},156:{f:f5e},157:{},158:{},159:{T:1,f:kVe},160:{T:-1},161:{T:1,f:mm},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:EUe},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:J6e},336:{T:-1},337:{f:i8e,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:eH},357:{},358:{},359:{},360:{T:1},361:{},362:{f:Nre},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:OUe},427:{f:kUe},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:PUe},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:U$e},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:TUe},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:eH},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:b8e},633:{T:1},634:{T:-1},635:{T:1,f:y8e},636:{T:-1},637:{f:Y4e},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:r5e},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:VUe},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},lH={6:{f:bI},10:{f:nf},12:{f:Si},13:{f:Si},14:{f:ei},15:{f:ei},16:{f:xs},17:{f:ei},18:{f:ei},19:{f:Si},20:{f:IG},21:{f:IG},23:{f:Nre},24:{f:HG},25:{f:ei},26:{},27:{},28:{f:VBe},29:{},34:{f:ei},35:{f:NG},38:{f:xs},39:{f:xs},40:{f:xs},41:{f:xs},42:{f:ei},43:{f:ei},47:{f:ZVe},49:{f:dBe},51:{f:Si},60:{},61:{f:lBe},64:{f:ei},65:{f:fBe},66:{f:Si},77:{},80:{},81:{},82:{},85:{f:Si},89:{},90:{},91:{},92:{f:Q3e},93:{f:UBe},94:{},95:{f:ei},96:{},97:{},99:{f:ei},125:{f:Hre},128:{f:MBe},129:{f:J3e},130:{f:Si},131:{f:ei},132:{f:ei},133:{f:eBe},134:{},140:{f:QBe},141:{f:Si},144:{},146:{f:eVe},151:{},152:{},153:{},154:{},155:{},156:{f:Si},157:{},158:{},160:{f:oVe},161:{f:nVe},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:EBe},190:{f:_Be},193:{f:nf},197:{},198:{},199:{},200:{},201:{},202:{f:ei},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Si},220:{},221:{f:ei},222:{},224:{f:TBe},225:{f:X3e},226:{f:nf},227:{},229:{f:WBe},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:rBe},253:{f:mBe},255:{f:iBe},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:Rre},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:ei},353:{f:nf},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:PBe},431:{f:ei},432:{},433:{},434:{},437:{},438:{f:zBe},439:{f:ei},440:{f:GBe},441:{},442:{f:$S},443:{},444:{f:Si},445:{},446:{},448:{f:nf},449:{f:oBe,r:2},450:{f:nf},512:{f:kG},513:{f:aVe},515:{f:kBe},516:{f:vBe},517:{f:PG},519:{f:lVe},520:{f:sBe},523:{},545:{f:FG},549:{f:OG},566:{},574:{f:cBe},638:{f:xBe},659:{},1048:{},1054:{f:yBe},1084:{},1212:{f:FBe},2048:{f:KBe},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:qx},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:nf},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:tVe,r:12},2173:{f:Q6e,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:ei,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:HBe,r:12},2197:{},2198:{f:Y6e,r:12},2199:{},2200:{},2201:{},2202:{f:LBe,r:12},2203:{f:nf},2204:{},2205:{},2206:{},2207:{},2211:{f:aBe},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Si},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:iVe},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:JBe},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:kG},1:{},2:{f:dVe},3:{f:hVe},4:{f:cVe},5:{f:PG},7:{f:mVe},8:{},9:{f:qx},11:{},22:{f:Si},30:{f:bBe},31:{},32:{},33:{f:FG},36:{},37:{f:OG},50:{f:pVe},62:{},52:{},67:{},68:{f:Si},69:{},86:{},126:{},127:{f:uVe},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:vVe},223:{},234:{},354:{},421:{},518:{f:bI},521:{f:qx},536:{f:HG},547:{f:NG},561:{},579:{},1030:{f:bI},1033:{f:qx},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Ke(t,e,r,n){var i=e;if(!isNaN(i)){var s=n||(r||[]).length||0,a=t.next(4);a.write_shift(2,i),a.write_shift(2,s),s>0&&J3(r)&&t.push(r)}}function gje(t,e,r,n){var i=(r||[]).length||0;if(i<=8224)return Ke(t,e,r,i);var s=e;if(!isNaN(s)){for(var a=r.parts||[],o=0,u=0,c=0;c+(a[o]||8224)<=8224;)c+=a[o]||8224,o++;var f=t.next(4);for(f.write_shift(2,s),f.write_shift(2,c),t.push(r.slice(u,u+c)),u+=c;u<i;){for(f=t.next(4),f.write_shift(2,60),c=0;c+(a[o]||8224)<=8224;)c+=a[o]||8224,o++;f.write_shift(2,c),t.push(r.slice(u,u+c)),u+=c}}}function zS(t,e,r){return t||(t=Fe(7)),t.write_shift(2,e),t.write_shift(2,r),t.write_shift(2,0),t.write_shift(1,0),t}function mje(t,e,r,n){var i=Fe(9);return zS(i,t,e),Tre(r,n||"b",i),i}function pje(t,e,r){var n=Fe(8+2*r.length);return zS(n,t,e),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function vje(t,e,r,n){if(e.v!=null)switch(e.t){case"d":case"n":var i=e.t=="d"?Hi(pn(e.v)):e.v;i==(i|0)&&i>=0&&i<65536?Ke(t,2,gVe(r,n,i)):Ke(t,3,fVe(r,n,i));return;case"b":case"e":Ke(t,5,mje(r,n,e.v,e.t));return;case"s":case"str":Ke(t,4,pje(r,n,(e.v||"").slice(0,255)));return}Ke(t,1,zS(null,r,n))}function wje(t,e,r,n){var i=Array.isArray(e),s=ar(e["!ref"]||"A1"),a,o="",u=[];if(s.e.c>255||s.e.r>16383){if(n.WTF)throw new Error("Range "+(e["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),a=Ht(s)}for(var c=s.s.r;c<=s.e.r;++c){o=jn(c);for(var f=s.s.c;f<=s.e.c;++f){c===s.s.r&&(u[f]=mn(f)),a=u[f]+o;var g=i?(e[c]||[])[f]:e[a];g&&vje(t,g,c,f)}}}function yje(t,e){for(var r=e||{},n=ya(),i=0,s=0;s<t.SheetNames.length;++s)t.SheetNames[s]==r.sheet&&(i=s);if(i==0&&r.sheet&&t.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return Ke(n,r.biff==4?1033:r.biff==3?521:9,uB(t,16,r)),wje(n,t.Sheets[t.SheetNames[i]],i,r),Ke(n,10),n.end()}function Sje(t,e,r){Ke(t,49,gBe({sz:12,name:"Arial"},r))}function bje(t,e,r){e&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&Ke(t,1054,SBe(i,e[i],r))})}function Cje(t,e){var r=Fe(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),Ke(t,2151,r),r=Fe(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),Dre(ar(e["!ref"]||"A1"),r),r.write_shift(4,4),Ke(t,2152,r)}function xje(t,e){for(var r=0;r<16;++r)Ke(t,224,DG({numFmtId:0,style:!0},0,e));e.cellXfs.forEach(function(n){Ke(t,224,DG(n,0,e))})}function Eje(t,e){for(var r=0;r<e["!links"].length;++r){var n=e["!links"][r];Ke(t,440,qBe(n)),n[1].Tooltip&&Ke(t,2048,XBe(n))}delete e["!links"]}function _je(t,e){if(e){var r=0;e.forEach(function(n,i){++r<=256&&n&&Ke(t,125,rVe(IT(i,n),i))})}}function Rje(t,e,r,n,i){var s=16+nd(i.cellXfs,e,i);if(e.v==null&&!e.bf){Ke(t,513,zg(r,n,s));return}if(e.bf)Ke(t,6,JWe(e,r,n,i,s));else switch(e.t){case"d":case"n":var a=e.t=="d"?Hi(pn(e.v)):e.v;Ke(t,515,DBe(r,n,a,s));break;case"b":case"e":Ke(t,517,OBe(r,n,e.v,s,i,e.t));break;case"s":case"str":if(i.bookSST){var o=vB(i.Strings,e.v,i.revStrings);Ke(t,253,pBe(r,n,o,s))}else Ke(t,516,wBe(r,n,(e.v||"").slice(0,255),s,i));break;default:Ke(t,513,zg(r,n,s))}}function Tje(t,e,r){var n=ya(),i=r.SheetNames[t],s=r.Sheets[i]||{},a=(r||{}).Workbook||{},o=(a.Sheets||[])[t]||{},u=Array.isArray(s),c=e.biff==8,f,g="",m=[],v=ar(s["!ref"]||"A1"),w=c?65536:16384;if(v.e.c>255||v.e.r>=w){if(e.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");v.e.c=Math.min(v.e.c,255),v.e.r=Math.min(v.e.c,w-1)}Ke(n,2057,uB(r,16,e)),Ke(n,13,ko(1)),Ke(n,12,ko(100)),Ke(n,15,$s(!0)),Ke(n,17,$s(!1)),Ke(n,16,jg(.001)),Ke(n,95,$s(!0)),Ke(n,42,$s(!1)),Ke(n,43,$s(!1)),Ke(n,130,ko(1)),Ke(n,128,ABe()),Ke(n,131,$s(!1)),Ke(n,132,$s(!1)),c&&_je(n,s["!cols"]),Ke(n,512,CBe(v,e)),c&&(s["!links"]=[]);for(var y=v.s.r;y<=v.e.r;++y){g=jn(y);for(var b=v.s.c;b<=v.e.c;++b){y===v.s.r&&(m[b]=mn(b)),f=m[b]+g;var x=u?(s[y]||[])[b]:s[f];x&&(Rje(n,x,y,b,e),c&&x.l&&s["!links"].push([f,x.l]))}}var _=o.CodeName||o.name||i;return c&&Ke(n,574,hBe((a.Views||[])[0])),c&&(s["!merges"]||[]).length&&Ke(n,229,$Be(s["!merges"])),c&&Eje(n,s),Ke(n,442,Mre(_)),c&&Cje(n,s),Ke(n,10),n.end()}function Mje(t,e,r){var n=ya(),i=(t||{}).Workbook||{},s=i.Sheets||[],a=i.WBProps||{},o=r.biff==8,u=r.biff==5;if(Ke(n,2057,uB(t,5,r)),r.bookType=="xla"&&Ke(n,135),Ke(n,225,o?ko(1200):null),Ke(n,193,O3e(2)),u&&Ke(n,191),u&&Ke(n,192),Ke(n,226),Ke(n,92,Z3e("SheetJS",r)),Ke(n,66,ko(o?1200:1252)),o&&Ke(n,353,ko(0)),o&&Ke(n,448),Ke(n,317,sVe(t.SheetNames.length)),o&&t.vbaraw&&Ke(n,211),o&&t.vbaraw){var c=a.CodeName||"ThisWorkbook";Ke(n,442,Mre(c))}Ke(n,156,ko(17)),Ke(n,25,$s(!1)),Ke(n,18,$s(!1)),Ke(n,19,ko(0)),o&&Ke(n,431,$s(!1)),o&&Ke(n,444,ko(0)),Ke(n,61,uBe()),Ke(n,64,$s(!1)),Ke(n,141,ko(0)),Ke(n,34,$s(o5e(t)=="true")),Ke(n,14,$s(!0)),o&&Ke(n,439,$s(!1)),Ke(n,218,ko(0)),Sje(n,t,r),bje(n,t.SSF,r),xje(n,r),o&&Ke(n,352,$s(!1));var f=n.end(),g=ya();o&&Ke(g,140,ZBe()),o&&r.Strings&&gje(g,252,nBe(r.Strings)),Ke(g,10);var m=g.end(),v=ya(),w=0,y=0;for(y=0;y<t.SheetNames.length;++y)w+=(o?12:11)+(o?2:1)*t.SheetNames[y].length;var b=f.length+w+m.length;for(y=0;y<t.SheetNames.length;++y){var x=s[y]||{};Ke(v,133,tBe({pos:b,hs:x.Hidden||0,dt:0,name:t.SheetNames[y]},r)),b+=e[y].length}var _=v.end();if(w!=_.length)throw new Error("BS8 "+w+" != "+_.length);var T=[];return f.length&&T.push(f),_.length&&T.push(_),m.length&&T.push(m),Yi(T)}function Aje(t,e){var r=e||{},n=[];t&&!t.SSF&&(t.SSF=rn(xt)),t&&t.SSF&&(fv(),BS(t.SSF),r.revssf=MT(t.SSF),r.revssf[t.SSF[65535]]=0,r.ssf=t.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,xB(r),r.cellXfs=[],nd(r.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={});for(var i=0;i<t.SheetNames.length;++i)n[n.length]=Tje(i,r,t);return n.unshift(Mje(t,n,r)),Yi(n)}function bne(t,e){for(var r=0;r<=t.SheetNames.length;++r){var n=t.Sheets[t.SheetNames[r]];if(!(!n||!n["!ref"])){var i=Ks(n["!ref"]);i.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+t.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var s=e||{};switch(s.biff||2){case 8:case 5:return Aje(t,e);case 4:case 3:case 2:return yje(t,e)}throw new Error("invalid type "+s.bookType+" for BIFF")}function GG(t,e){var r=e||{},n=r.dense?[]:{};t=t.replace(/<!--.*?-->/g,"");var i=t.match(/<table/i);if(!i)throw new Error("Invalid HTML: could not find <table>");var s=t.match(/<\/table/i),a=i.index,o=s&&s.index||t.length,u=g4e(t.slice(a,o),/(:?<tr[^>]*>)/i,"<tr>"),c=-1,f=0,g=0,m=0,v={s:{r:1e7,c:1e7},e:{r:0,c:0}},w=[];for(a=0;a<u.length;++a){var y=u[a].trim(),b=y.slice(0,3).toLowerCase();if(b=="<tr"){if(++c,r.sheetRows&&r.sheetRows<=c){--c;break}f=0;continue}if(!(b!="<td"&&b!="<th")){var x=y.split(/<\/t[dh]>/i);for(o=0;o<x.length;++o){var _=x[o].trim();if(_.match(/<t[dh]/i)){for(var T=_,D=0;T.charAt(0)=="<"&&(D=T.indexOf(">"))>-1;)T=T.slice(D+1);for(var P=0;P<w.length;++P){var O=w[P];O.s.c==f&&O.s.r<c&&c<=O.e.r&&(f=O.e.c+1,P=-1)}var A=Ot(_.slice(0,_.indexOf(">")));m=A.colspan?+A.colspan:1,((g=+A.rowspan)>1||m>1)&&w.push({s:{r:c,c:f},e:{r:c+(g||1)-1,c:f+m-1}});var W=A.t||A["data-t"]||"";if(!T.length){f+=m;continue}if(T=Kte(T),v.s.r>c&&(v.s.r=c),v.e.r<c&&(v.e.r=c),v.s.c>f&&(v.s.c=f),v.e.c<f&&(v.e.c=f),!T.length){f+=m;continue}var L={t:"s",v:T};r.raw||!T.trim().length||W=="s"||(T==="TRUE"?L={t:"b",v:!0}:T==="FALSE"?L={t:"b",v:!1}:isNaN(Al(T))?isNaN(Lp(T).getDate())||(L={t:"d",v:pn(T)},r.cellDates||(L={t:"n",v:Hi(L.v)}),L.z=r.dateNF||xt[14]):L={t:"n",v:Al(T)}),r.dense?(n[c]||(n[c]=[]),n[c][f]=L):n[Tt({r:c,c:f})]=L,f+=m}}}}return n["!ref"]=Ht(v),w.length&&(n["!merges"]=w),n}function Cne(t,e,r,n){for(var i=t["!merges"]||[],s=[],a=e.s.c;a<=e.e.c;++a){for(var o=0,u=0,c=0;c<i.length;++c)if(!(i[c].s.r>r||i[c].s.c>a)&&!(i[c].e.r<r||i[c].e.c<a)){if(i[c].s.r<r||i[c].s.c<a){o=-1;break}o=i[c].e.r-i[c].s.r+1,u=i[c].e.c-i[c].s.c+1;break}if(!(o<0)){var f=Tt({r,c:a}),g=n.dense?(t[r]||[])[a]:t[f],m=g&&g.v!=null&&(g.h||z3(g.w||(Vu(g),g.w)||""))||"",v={};o>1&&(v.rowspan=o),u>1&&(v.colspan=u),n.editable?m='<span contenteditable="true">'+m+"</span>":g&&(v["data-t"]=g&&g.t||"z",g.v!=null&&(v["data-v"]=g.v),g.z!=null&&(v["data-z"]=g.z),g.l&&(g.l.Target||"#").charAt(0)!="#"&&(m='<a href="'+g.l.Target+'">'+m+"</a>")),v.id=(n.id||"sjs")+"-"+f,s.push(qe("td",m,v))}}var w="<tr>";return w+s.join("")+"</tr>"}var xne='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',Ene="</body></html>";function Oje(t,e){var r=t.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return rd(GG(r[0],e),e);var n=MB();return r.forEach(function(i,s){AB(n,GG(i,e),"Sheet"+(s+1))}),n}function _ne(t,e,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function Rne(t,e){var r=e||{},n=r.header!=null?r.header:xne,i=r.footer!=null?r.footer:Ene,s=[n],a=Ks(t["!ref"]);r.dense=Array.isArray(t),s.push(_ne(t,a,r));for(var o=a.s.r;o<=a.e.r;++o)s.push(Cne(t,a,o,r));return s.push("</table>"+i),s.join("")}function Tne(t,e,r){var n=r||{},i=0,s=0;if(n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var a=typeof n.origin=="string"?Dn(n.origin):n.origin;i=a.r,s=a.c}var o=e.getElementsByTagName("tr"),u=Math.min(n.sheetRows||1e7,o.length),c={s:{r:0,c:0},e:{r:i,c:s}};if(t["!ref"]){var f=Ks(t["!ref"]);c.s.r=Math.min(c.s.r,f.s.r),c.s.c=Math.min(c.s.c,f.s.c),c.e.r=Math.max(c.e.r,f.e.r),c.e.c=Math.max(c.e.c,f.e.c),i==-1&&(c.e.r=i=f.e.r+1)}var g=[],m=0,v=t["!rows"]||(t["!rows"]=[]),w=0,y=0,b=0,x=0,_=0,T=0;for(t["!cols"]||(t["!cols"]=[]);w<o.length&&y<u;++w){var D=o[w];if(qG(D)){if(n.display)continue;v[y]={hidden:!0}}var P=D.children;for(b=x=0;b<P.length;++b){var O=P[b];if(!(n.display&&qG(O))){var A=O.hasAttribute("data-v")?O.getAttribute("data-v"):O.hasAttribute("v")?O.getAttribute("v"):Kte(O.innerHTML),W=O.getAttribute("data-z")||O.getAttribute("z");for(m=0;m<g.length;++m){var L=g[m];L.s.c==x+s&&L.s.r<y+i&&y+i<=L.e.r&&(x=L.e.c+1-s,m=-1)}T=+O.getAttribute("colspan")||1,((_=+O.getAttribute("rowspan")||1)>1||T>1)&&g.push({s:{r:y+i,c:x+s},e:{r:y+i+(_||1)-1,c:x+s+(T||1)-1}});var H={t:"s",v:A},J=O.getAttribute("data-t")||O.getAttribute("t")||"";A!=null&&(A.length==0?H.t=J||"z":n.raw||A.trim().length==0||J=="s"||(A==="TRUE"?H={t:"b",v:!0}:A==="FALSE"?H={t:"b",v:!1}:isNaN(Al(A))?isNaN(Lp(A).getDate())||(H={t:"d",v:pn(A)},n.cellDates||(H={t:"n",v:Hi(H.v)}),H.z=n.dateNF||xt[14]):H={t:"n",v:Al(A)})),H.z===void 0&&W!=null&&(H.z=W);var G="",ve=O.getElementsByTagName("A");if(ve&&ve.length)for(var be=0;be<ve.length&&!(ve[be].hasAttribute("href")&&(G=ve[be].getAttribute("href"),G.charAt(0)!="#"));++be);G&&G.charAt(0)!="#"&&(H.l={Target:G}),n.dense?(t[y+i]||(t[y+i]=[]),t[y+i][x+s]=H):t[Tt({c:x+s,r:y+i})]=H,c.e.c<x+s&&(c.e.c=x+s),x+=T}}++y}return g.length&&(t["!merges"]=(t["!merges"]||[]).concat(g)),c.e.r=Math.max(c.e.r,y-1+i),t["!ref"]=Ht(c),y>=u&&(t["!fullref"]=Ht((c.e.r=o.length-w+y-1+i,c))),t}function Mne(t,e){var r=e||{},n=r.dense?[]:{};return Tne(n,t,e)}function kje(t,e){return rd(Mne(t,e),e)}function qG(t){var e="",r=Dje(t);return r&&(e=r(t).getPropertyValue("display")),e||(e=t.style&&t.style.display),e==="none"}function Dje(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function Pje(t){var e=t.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,i){return Array(parseInt(i,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=Cr(e.replace(/<[^>]*>/g,""));return[r]}var KG={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function Ane(t,e){var r=e||{},n=G3(t),i=[],s,a,o={name:""},u="",c=0,f,g,m={},v=[],w=r.dense?[]:{},y,b,x={value:""},_="",T=0,D=[],P=-1,O=-1,A={s:{r:1e6,c:1e7},e:{r:0,c:0}},W=0,L={},H=[],J={},G=0,ve=0,be=[],we=1,ae=1,le=[],Te={Names:[]},ce={},K=["",""],Se=[],B={},E="",R=0,M=!1,F=!1,Z=0;for(z1.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");y=z1.exec(n);)switch(y[3]=y[3].replace(/_.*$/,"")){case"table":case"工作表":y[1]==="/"?(A.e.c>=A.s.c&&A.e.r>=A.s.r?w["!ref"]=Ht(A):w["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=A.e.r&&(w["!fullref"]=w["!ref"],A.e.r=r.sheetRows-1,w["!ref"]=Ht(A)),H.length&&(w["!merges"]=H),be.length&&(w["!rows"]=be),f.name=f.名称||f.name,typeof JSON<"u"&&JSON.stringify(f),v.push(f.name),m[f.name]=w,F=!1):y[0].charAt(y[0].length-2)!=="/"&&(f=Ot(y[0],!1),P=O=-1,A.s.r=A.s.c=1e7,A.e.r=A.e.c=0,w=r.dense?[]:{},H=[],be=[],F=!0);break;case"table-row-group":y[1]==="/"?--W:++W;break;case"table-row":case"行":if(y[1]==="/"){P+=we,we=1;break}if(g=Ot(y[0],!1),g.行号?P=g.行号-1:P==-1&&(P=0),we=+g["number-rows-repeated"]||1,we<10)for(Z=0;Z<we;++Z)W>0&&(be[P+Z]={level:W});O=-1;break;case"covered-table-cell":y[1]!=="/"&&++O,r.sheetStubs&&(r.dense?(w[P]||(w[P]=[]),w[P][O]={t:"z"}):w[Tt({r:P,c:O})]={t:"z"}),_="",D=[];break;case"table-cell":case"数据":if(y[0].charAt(y[0].length-2)==="/")++O,x=Ot(y[0],!1),ae=parseInt(x["number-columns-repeated"]||"1",10),b={t:"z",v:null},x.formula&&r.cellFormula!=!1&&(b.f=jG(Cr(x.formula))),(x.数据类型||x["value-type"])=="string"&&(b.t="s",b.v=Cr(x["string-value"]||""),r.dense?(w[P]||(w[P]=[]),w[P][O]=b):w[Tt({r:P,c:O})]=b),O+=ae-1;else if(y[1]!=="/"){++O,_="",T=0,D=[],ae=1;var te=we?P+we-1:P;if(O>A.e.c&&(A.e.c=O),O<A.s.c&&(A.s.c=O),P<A.s.r&&(A.s.r=P),te>A.e.r&&(A.e.r=te),x=Ot(y[0],!1),Se=[],B={},b={t:x.数据类型||x["value-type"],v:null},r.cellFormula)if(x.formula&&(x.formula=Cr(x.formula)),x["number-matrix-columns-spanned"]&&x["number-matrix-rows-spanned"]&&(G=parseInt(x["number-matrix-rows-spanned"],10)||0,ve=parseInt(x["number-matrix-columns-spanned"],10)||0,J={s:{r:P,c:O},e:{r:P+G-1,c:O+ve-1}},b.F=Ht(J),le.push([J,b.F])),x.formula)b.f=jG(x.formula);else for(Z=0;Z<le.length;++Z)P>=le[Z][0].s.r&&P<=le[Z][0].e.r&&O>=le[Z][0].s.c&&O<=le[Z][0].e.c&&(b.F=le[Z][1]);switch((x["number-columns-spanned"]||x["number-rows-spanned"])&&(G=parseInt(x["number-rows-spanned"],10)||0,ve=parseInt(x["number-columns-spanned"],10)||0,J={s:{r:P,c:O},e:{r:P+G-1,c:O+ve-1}},H.push(J)),x["number-columns-repeated"]&&(ae=parseInt(x["number-columns-repeated"],10)),b.t){case"boolean":b.t="b",b.v=dn(x["boolean-value"]);break;case"float":b.t="n",b.v=parseFloat(x.value);break;case"percentage":b.t="n",b.v=parseFloat(x.value);break;case"currency":b.t="n",b.v=parseFloat(x.value);break;case"date":b.t="d",b.v=pn(x["date-value"]),r.cellDates||(b.t="n",b.v=Hi(b.v)),b.z="m/d/yy";break;case"time":b.t="n",b.v=h4e(x["time-value"])/86400,r.cellDates&&(b.t="d",b.v=AT(b.v)),b.z="HH:MM:SS";break;case"number":b.t="n",b.v=parseFloat(x.数据数值);break;default:if(b.t==="string"||b.t==="text"||!b.t)b.t="s",x["string-value"]!=null&&(_=Cr(x["string-value"]),D=[]);else throw new Error("Unsupported value type "+b.t)}}else{if(M=!1,b.t==="s"&&(b.v=_||"",D.length&&(b.R=D),M=T==0),ce.Target&&(b.l=ce),Se.length>0&&(b.c=Se,Se=[]),_&&r.cellText!==!1&&(b.w=_),M&&(b.t="z",delete b.v),(!M||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=P))for(var fe=0;fe<we;++fe){if(ae=parseInt(x["number-columns-repeated"]||"1",10),r.dense)for(w[P+fe]||(w[P+fe]=[]),w[P+fe][O]=fe==0?b:rn(b);--ae>0;)w[P+fe][O+ae]=rn(b);else for(w[Tt({r:P+fe,c:O})]=b;--ae>0;)w[Tt({r:P+fe,c:O+ae})]=rn(b);A.e.c<=O&&(A.e.c=O)}ae=parseInt(x["number-columns-repeated"]||"1",10),O+=ae-1,ae=0,b={},_="",D=[]}ce={};break;case"document":case"document-content":case"电子表格文档":case"spreadsheet":case"主体":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(y[1]==="/"){if((s=i.pop())[0]!==y[3])throw"Bad state: "+s}else y[0].charAt(y[0].length-2)!=="/"&&i.push([y[3],!0]);break;case"annotation":if(y[1]==="/"){if((s=i.pop())[0]!==y[3])throw"Bad state: "+s;B.t=_,D.length&&(B.R=D),B.a=E,Se.push(B)}else y[0].charAt(y[0].length-2)!=="/"&&i.push([y[3],!1]);E="",R=0,_="",T=0,D=[];break;case"creator":y[1]==="/"?E=n.slice(R,y.index):R=y.index+y[0].length;break;case"meta":case"元数据":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(y[1]==="/"){if((s=i.pop())[0]!==y[3])throw"Bad state: "+s}else y[0].charAt(y[0].length-2)!=="/"&&i.push([y[3],!1]);_="",T=0,D=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(y[1]==="/"){if(L[o.name]=u,(s=i.pop())[0]!==y[3])throw"Bad state: "+s}else y[0].charAt(y[0].length-2)!=="/"&&(u="",o=Ot(y[0],!1),i.push([y[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(i[i.length-1][0]){case"time-style":case"date-style":a=Ot(y[0],!1),u+=KG[y[3]][a.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(i[i.length-1][0]){case"time-style":case"date-style":a=Ot(y[0],!1),u+=KG[y[3]][a.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(y[0].slice(-2)==="/>")break;if(y[1]==="/")switch(i[i.length-1][0]){case"number-style":case"date-style":case"time-style":u+=n.slice(c,y.index);break}else c=y.index+y[0].length;break;case"named-range":a=Ot(y[0],!1),K=CI(a["cell-range-address"]);var I={Name:a.name,Ref:K[0]+"!"+K[1]};F&&(I.Sheet=v.length),Te.Names.push(I);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"电子表格":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"文本串":if(["master-styles"].indexOf(i[i.length-1][0])>-1)break;if(y[1]==="/"&&(!x||!x["string-value"])){var U=Pje(n.slice(T,y.index));_=(_.length>0?_+`
`:"")+U[0]}else Ot(y[0],!1),T=y.index+y[0].length;break;case"s":break;case"database-range":if(y[1]==="/")break;try{K=CI(Ot(y[0])["target-range-address"]),m[K[0]]["!autofilter"]={ref:K[1]}}catch{}break;case"date":break;case"object":break;case"title":case"标题":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(y[1]!=="/"){if(ce=Ot(y[0],!1),!ce.href)break;ce.Target=Cr(ce.href),delete ce.href,ce.Target.charAt(0)=="#"&&ce.Target.indexOf(".")>-1?(K=CI(ce.Target.slice(1)),ce.Target="#"+K[0]+"!"+K[1]):ce.Target.match(/^\.\.[\\\/]/)&&(ce.Target=ce.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(y[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"表:":case"字:":break;default:if(r.WTF)throw new Error(y)}}var k={Sheets:m,SheetNames:v,Workbook:Te};return r.bookSheets&&delete k.Sheets,k}function XG(t,e){e=e||{},_o(t,"META-INF/manifest.xml")&&h3e(yi(t,"META-INF/manifest.xml"),e);var r=qa(t,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=Ane(Zr(r),e);return _o(t,"meta.xml")&&(n.Props=mre(yi(t,"meta.xml"))),n}function QG(t,e){return Ane(t,e)}var Ije=function(){var t=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),e="<office:document-styles "+Y1({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+t+"</office:document-styles>";return function(){return hi+e}}(),ZG=function(){var t=function(s){return Gr(s).replace(/  +/g,function(a){return'<text:s text:c="'+a.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},e=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(s,a,o){var u=[];u.push('      <table:table table:name="'+Gr(a.SheetNames[o])+`" table:style-name="ta1">
`);var c=0,f=0,g=Ks(s["!ref"]||"A1"),m=s["!merges"]||[],v=0,w=Array.isArray(s);if(s["!cols"])for(f=0;f<=g.e.c;++f)u.push("        <table:table-column"+(s["!cols"][f]?' table:style-name="co'+s["!cols"][f].ods+'"':"")+`></table:table-column>
`);var y="",b=s["!rows"]||[];for(c=0;c<g.s.r;++c)y=b[c]?' table:style-name="ro'+b[c].ods+'"':"",u.push("        <table:table-row"+y+`></table:table-row>
`);for(;c<=g.e.r;++c){for(y=b[c]?' table:style-name="ro'+b[c].ods+'"':"",u.push("        <table:table-row"+y+`>
`),f=0;f<g.s.c;++f)u.push(e);for(;f<=g.e.c;++f){var x=!1,_={},T="";for(v=0;v!=m.length;++v)if(!(m[v].s.c>f)&&!(m[v].s.r>c)&&!(m[v].e.c<f)&&!(m[v].e.r<c)){(m[v].s.c!=f||m[v].s.r!=c)&&(x=!0),_["table:number-columns-spanned"]=m[v].e.c-m[v].s.c+1,_["table:number-rows-spanned"]=m[v].e.r-m[v].s.r+1;break}if(x){u.push(r);continue}var D=Tt({r:c,c:f}),P=w?(s[c]||[])[f]:s[D];if(P&&P.f&&(_["table:formula"]=Gr(s$e(P.f)),P.F&&P.F.slice(0,D.length)==D)){var O=Ks(P.F);_["table:number-matrix-columns-spanned"]=O.e.c-O.s.c+1,_["table:number-matrix-rows-spanned"]=O.e.r-O.s.r+1}if(!P){u.push(e);continue}switch(P.t){case"b":T=P.v?"TRUE":"FALSE",_["office:value-type"]="boolean",_["office:boolean-value"]=P.v?"true":"false";break;case"n":T=P.w||String(P.v||0),_["office:value-type"]="float",_["office:value"]=P.v||0;break;case"s":case"str":T=P.v==null?"":P.v,_["office:value-type"]="string";break;case"d":T=P.w||pn(P.v).toISOString(),_["office:value-type"]="date",_["office:date-value"]=pn(P.v).toISOString(),_["table:style-name"]="ce1";break;default:u.push(e);continue}var A=t(T);if(P.l&&P.l.Target){var W=P.l.Target;W=W.charAt(0)=="#"?"#"+a$e(W.slice(1)):W,W.charAt(0)!="#"&&!W.match(/^\w+:/)&&(W="../"+W),A=qe("text:a",A,{"xlink:href":W.replace(/&/g,"&amp;")})}u.push("          "+qe("table:table-cell",qe("text:p",A,{}),_)+`
`)}u.push(`        </table:table-row>
`)}return u.push(`      </table:table>
`),u.join("")},i=function(s,a){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var o=0;a.SheetNames.map(function(c){return a.Sheets[c]}).forEach(function(c){if(c&&c["!cols"]){for(var f=0;f<c["!cols"].length;++f)if(c["!cols"][f]){var g=c["!cols"][f];if(g.width==null&&g.wpx==null&&g.wch==null)continue;jf(g),g.ods=o;var m=c["!cols"][f].wpx+"px";s.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+m+`"/>
`),s.push(`  </style:style>
`),++o}}});var u=0;a.SheetNames.map(function(c){return a.Sheets[c]}).forEach(function(c){if(c&&c["!rows"]){for(var f=0;f<c["!rows"].length;++f)if(c["!rows"][f]){c["!rows"][f].ods=u;var g=c["!rows"][f].hpx+"px";s.push('  <style:style style:name="ro'+u+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+g+`"/>
`),s.push(`  </style:style>
`),++u}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(a,o){var u=[hi],c=Y1({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),f=Y1({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(u.push("<office:document"+c+f+`>
`),u.push(gre().replace(/office:document-meta/g,"office:meta"))):u.push("<office:document-content"+c+`>
`),i(u,a),u.push(`  <office:body>
`),u.push(`    <office:spreadsheet>
`);for(var g=0;g!=a.SheetNames.length;++g)u.push(n(a.Sheets[a.SheetNames[g]],a,g));return u.push(`    </office:spreadsheet>
`),u.push(`  </office:body>
`),o.bookType=="fods"?u.push("</office:document>"):u.push("</office:document-content>"),u.join("")}}();function One(t,e){if(e.bookType=="fods")return ZG(t,e);var r=U3(),n="",i=[],s=[];return n="mimetype",Lt(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",Lt(r,n,ZG(t,e)),i.push([n,"text/xml"]),s.push([n,"ContentFile"]),n="styles.xml",Lt(r,n,Ije(t,e)),i.push([n,"text/xml"]),s.push([n,"StylesFile"]),n="meta.xml",Lt(r,n,hi+gre()),i.push([n,"text/xml"]),s.push([n,"MetadataFile"]),n="manifest.rdf",Lt(r,n,g3e(s)),i.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",Lt(r,n,f3e(i)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Gg(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function uH(t){return typeof TextDecoder<"u"?new TextDecoder().decode(t):Zr(td(t))}function Nje(t){return typeof TextEncoder<"u"?new TextEncoder().encode(t):Ga(ku(t))}function Hje(t,e){e:for(var r=0;r<=t.length-e.length;++r){for(var n=0;n<e.length;++n)if(t[r+n]!=e[n])continue e;return!0}return!1}function zf(t){var e=t.reduce(function(i,s){return i+s.length},0),r=new Uint8Array(e),n=0;return t.forEach(function(i){r.set(i,n),n+=i.length}),r}function JG(t){return t-=t>>1&1431655765,t=(t&858993459)+(t>>2&858993459),(t+(t>>4)&252645135)*16843009>>>24}function Fje(t,e){for(var r=(t[e+15]&127)<<7|t[e+14]>>1,n=t[e+14]&1,i=e+13;i>=e;--i)n=n*256+t[i];return(t[e+15]&128?-n:n)*Math.pow(10,r-6176)}function Lje(t,e,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,i=r/Math.pow(10,n-6176);t[e+15]|=n>>7,t[e+14]|=(n&127)<<1;for(var s=0;i>=1;++s,i/=256)t[e+s]=i&255;t[e+15]|=r>=0?0:128}function J1(t,e){var r=e?e[0]:0,n=t[r]&127;e:if(t[r++]>=128&&(n|=(t[r]&127)<<7,t[r++]<128||(n|=(t[r]&127)<<14,t[r++]<128)||(n|=(t[r]&127)<<21,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,28),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,35),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,42),++r,t[r++]<128)))break e;return e&&(e[0]=r),n}function jr(t){var e=new Uint8Array(7);e[0]=t&127;var r=1;e:if(t>127){if(e[r-1]|=128,e[r]=t>>7&127,++r,t<=16383||(e[r-1]|=128,e[r]=t>>14&127,++r,t<=2097151)||(e[r-1]|=128,e[r]=t>>21&127,++r,t<=268435455)||(e[r-1]|=128,e[r]=t/256>>>21&127,++r,t<=34359738367)||(e[r-1]|=128,e[r]=t/65536>>>21&127,++r,t<=4398046511103))break e;e[r-1]|=128,e[r]=t/16777216>>>21&127,++r}return e.slice(0,r)}function Yn(t){var e=0,r=t[e]&127;e:if(t[e++]>=128){if(r|=(t[e]&127)<<7,t[e++]<128||(r|=(t[e]&127)<<14,t[e++]<128)||(r|=(t[e]&127)<<21,t[e++]<128))break e;r|=(t[e]&127)<<28}return r}function Er(t){for(var e=[],r=[0];r[0]<t.length;){var n=r[0],i=J1(t,r),s=i&7;i=Math.floor(i/8);var a=0,o;if(i==0)break;switch(s){case 0:{for(var u=r[0];t[r[0]++]>=128;);o=t.slice(u,r[0])}break;case 5:a=4,o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 1:a=8,o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 2:a=J1(t,r),o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(i," at offset ").concat(n))}var c={data:o,type:s};e[i]==null?e[i]=[c]:e[i].push(c)}return e}function es(t){var e=[];return t.forEach(function(r,n){r.forEach(function(i){i.data&&(e.push(jr(n*8+i.type)),i.type==2&&e.push(jr(i.data.length)),e.push(i.data))})}),zf(e)}function bB(t,e){return t?.map(function(r){return e(r.data)})||[]}function bo(t){for(var e,r=[],n=[0];n[0]<t.length;){var i=J1(t,n),s=Er(t.slice(n[0],n[0]+i));n[0]+=i;var a={id:Yn(s[1][0].data),messages:[]};s[2].forEach(function(o){var u=Er(o.data),c=Yn(u[3][0].data);a.messages.push({meta:u,data:t.slice(n[0],n[0]+c)}),n[0]+=c}),(e=s[3])!=null&&e[0]&&(a.merge=Yn(s[3][0].data)>>>0>0),r.push(a)}return r}function V0(t){var e=[];return t.forEach(function(r){var n=[];n[1]=[{data:jr(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:jr(+!!r.merge),type:0}]);var i=[];r.messages.forEach(function(a){i.push(a.data),a.meta[3]=[{type:0,data:jr(a.data.length)}],n[2].push({data:es(a.meta),type:2})});var s=es(n);e.push(jr(s.length)),e.push(s),i.forEach(function(a){return e.push(a)})}),zf(e)}function Bje(t,e){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var r=[0],n=J1(e,r),i=[];r[0]<e.length;){var s=e[r[0]]&3;if(s==0){var a=e[r[0]++]>>2;if(a<60)++a;else{var o=a-59;a=e[r[0]],o>1&&(a|=e[r[0]+1]<<8),o>2&&(a|=e[r[0]+2]<<16),o>3&&(a|=e[r[0]+3]<<24),a>>>=0,a++,r[0]+=o}i.push(e.slice(r[0],r[0]+a)),r[0]+=a;continue}else{var u=0,c=0;if(s==1?(c=(e[r[0]]>>2&7)+4,u=(e[r[0]++]&224)<<3,u|=e[r[0]++]):(c=(e[r[0]++]>>2)+1,s==2?(u=e[r[0]]|e[r[0]+1]<<8,r[0]+=2):(u=(e[r[0]]|e[r[0]+1]<<8|e[r[0]+2]<<16|e[r[0]+3]<<24)>>>0,r[0]+=4)),i=[zf(i)],u==0)throw new Error("Invalid offset 0");if(u>i[0].length)throw new Error("Invalid offset beyond length");if(c>=u)for(i.push(i[0].slice(-u)),c-=u;c>=i[i.length-1].length;)i.push(i[i.length-1]),c-=i[i.length-1].length;i.push(i[0].slice(-u,-u+c))}}var f=zf(i);if(f.length!=n)throw new Error("Unexpected length: ".concat(f.length," != ").concat(n));return f}function Co(t){for(var e=[],r=0;r<t.length;){var n=t[r++],i=t[r]|t[r+1]<<8|t[r+2]<<16;r+=3,e.push(Bje(n,t.slice(r,r+i))),r+=i}if(r!==t.length)throw new Error("data is not a valid framed stream!");return zf(e)}function W0(t){for(var e=[],r=0;r<t.length;){var n=Math.min(t.length-r,268435455),i=new Uint8Array(4);e.push(i);var s=jr(n),a=s.length;e.push(s),n<=60?(a++,e.push(new Uint8Array([n-1<<2]))):n<=256?(a+=2,e.push(new Uint8Array([240,n-1&255]))):n<=65536?(a+=3,e.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(a+=4,e.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(a+=5,e.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),e.push(t.slice(r,r+n)),a+=n,i[0]=0,i[1]=a&255,i[2]=a>>8&255,i[3]=a>>16&255,r+=n}return zf(e)}function Vje(t,e,r,n){var i=Gg(t),s=i.getUint32(4,!0),a=(n>1?12:8)+JG(s&(n>1?3470:398))*4,o=-1,u=-1,c=NaN,f=new Date(2001,0,1);s&512&&(o=i.getUint32(a,!0),a+=4),a+=JG(s&(n>1?12288:4096))*4,s&16&&(u=i.getUint32(a,!0),a+=4),s&32&&(c=i.getFloat64(a,!0),a+=8),s&64&&(f.setTime(f.getTime()+i.getFloat64(a,!0)*1e3),a+=8);var g;switch(t[2]){case 0:break;case 2:g={t:"n",v:c};break;case 3:g={t:"s",v:e[u]};break;case 5:g={t:"d",v:f};break;case 6:g={t:"b",v:c>0};break;case 7:g={t:"n",v:c/86400};break;case 8:g={t:"e",v:0};break;case 9:if(o>-1)g={t:"s",v:r[o]};else if(u>-1)g={t:"s",v:e[u]};else if(!isNaN(c))g={t:"n",v:c};else throw new Error("Unsupported cell type ".concat(t.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(t.slice(0,4)))}return g}function Wje(t,e,r){var n=Gg(t),i=n.getUint32(8,!0),s=12,a=-1,o=-1,u=NaN,c=NaN,f=new Date(2001,0,1);i&1&&(u=Fje(t,s),s+=16),i&2&&(c=n.getFloat64(s,!0),s+=8),i&4&&(f.setTime(f.getTime()+n.getFloat64(s,!0)*1e3),s+=8),i&8&&(o=n.getUint32(s,!0),s+=4),i&16&&(a=n.getUint32(s,!0),s+=4);var g;switch(t[1]){case 0:break;case 2:g={t:"n",v:u};break;case 3:g={t:"s",v:e[o]};break;case 5:g={t:"d",v:f};break;case 6:g={t:"b",v:c>0};break;case 7:g={t:"n",v:c/86400};break;case 8:g={t:"e",v:0};break;case 9:if(a>-1)g={t:"s",v:r[a]};else throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(i&31," : ").concat(t.slice(0,4)));break;case 10:g={t:"n",v:u};break;default:throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(i&31," : ").concat(t.slice(0,4)))}return g}function EI(t,e){var r=new Uint8Array(32),n=Gg(r),i=12,s=0;switch(r[0]=5,t.t){case"n":r[1]=2,Lje(r,i,t.v),s|=1,i+=16;break;case"b":r[1]=6,n.setFloat64(i,t.v?1:0,!0),s|=2,i+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[1]=3,n.setUint32(i,e.indexOf(t.v),!0),s|=8,i+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(8,s,!0),r.slice(0,i)}function _I(t,e){var r=new Uint8Array(32),n=Gg(r),i=12,s=0;switch(r[0]=3,t.t){case"n":r[2]=2,n.setFloat64(i,t.v,!0),s|=32,i+=8;break;case"b":r[2]=6,n.setFloat64(i,t.v?1:0,!0),s|=32,i+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[2]=3,n.setUint32(i,e.indexOf(t.v),!0),s|=16,i+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(4,s,!0),r.slice(0,i)}function $je(t,e,r){switch(t[0]){case 0:case 1:case 2:case 3:return Vje(t,e,r,t[0]);case 5:return Wje(t,e,r);default:throw new Error("Unsupported payload version ".concat(t[0]))}}function ws(t){var e=Er(t);return J1(e[1][0].data)}function eq(t,e){var r=Er(e.data),n=Yn(r[1][0].data),i=r[3],s=[];return(i||[]).forEach(function(a){var o=Er(a.data),u=Yn(o[1][0].data)>>>0;switch(n){case 1:s[u]=uH(o[3][0].data);break;case 8:{var c=t[ws(o[9][0].data)][0],f=Er(c.data),g=t[ws(f[1][0].data)][0],m=Yn(g.meta[1][0].data);if(m!=2001)throw new Error("2000 unexpected reference to ".concat(m));var v=Er(g.data);s[u]=v[3].map(function(w){return uH(w.data)}).join("")}break}}),s}function Uje(t,e){var r,n,i,s,a,o,u,c,f,g,m,v,w,y,b=Er(t),x=Yn(b[1][0].data)>>>0,_=Yn(b[2][0].data)>>>0,T=((n=(r=b[8])==null?void 0:r[0])==null?void 0:n.data)&&Yn(b[8][0].data)>0||!1,D,P;if((s=(i=b[7])==null?void 0:i[0])!=null&&s.data&&e!=0)D=(o=(a=b[7])==null?void 0:a[0])==null?void 0:o.data,P=(c=(u=b[6])==null?void 0:u[0])==null?void 0:c.data;else if((g=(f=b[4])==null?void 0:f[0])!=null&&g.data&&e!=1)D=(v=(m=b[4])==null?void 0:m[0])==null?void 0:v.data,P=(y=(w=b[3])==null?void 0:w[0])==null?void 0:y.data;else throw"NUMBERS Tile missing ".concat(e," cell storage");for(var O=T?4:1,A=Gg(D),W=[],L=0;L<D.length/2;++L){var H=A.getUint16(L*2,!0);H<65535&&W.push([L,H])}if(W.length!=_)throw"Expected ".concat(_," cells, found ").concat(W.length);var J=[];for(L=0;L<W.length-1;++L)J[W[L][0]]=P.subarray(W[L][1]*O,W[L+1][1]*O);return W.length>=1&&(J[W[W.length-1][0]]=P.subarray(W[W.length-1][1]*O)),{R:x,cells:J}}function jje(t,e){var r,n=Er(e.data),i=(r=n?.[7])!=null&&r[0]?Yn(n[7][0].data)>>>0>0?1:0:-1,s=bB(n[5],function(a){return Uje(a,i)});return{nrows:Yn(n[4][0].data)>>>0,data:s.reduce(function(a,o){return a[o.R]||(a[o.R]=[]),o.cells.forEach(function(u,c){if(a[o.R][c])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(c));a[o.R][c]=u}),a},[])}}function Yje(t,e,r){var n,i=Er(e.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(Yn(i[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(i[6][0].data));if(s.e.c=(Yn(i[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(i[7][0].data));r["!ref"]=Ht(s);var a=Er(i[4][0].data),o=eq(t,t[ws(a[4][0].data)][0]),u=(n=a[17])!=null&&n[0]?eq(t,t[ws(a[17][0].data)][0]):[],c=Er(a[3][0].data),f=0;c[1].forEach(function(g){var m=Er(g.data),v=t[ws(m[2][0].data)][0],w=Yn(v.meta[1][0].data);if(w!=6002)throw new Error("6001 unexpected reference to ".concat(w));var y=jje(t,v);y.data.forEach(function(b,x){b.forEach(function(_,T){var D=Tt({r:f+x,c:T}),P=$je(_,o,u);P&&(r[D]=P)})}),f+=y.nrows})}function zje(t,e){var r=Er(e.data),n={"!ref":"A1"},i=t[ws(r[2][0].data)],s=Yn(i[0].meta[1][0].data);if(s!=6001)throw new Error("6000 unexpected reference to ".concat(s));return Yje(t,i[0],n),n}function Gje(t,e){var r,n=Er(e.data),i={name:(r=n[1])!=null&&r[0]?uH(n[1][0].data):"",sheets:[]},s=bB(n[2],ws);return s.forEach(function(a){t[a].forEach(function(o){var u=Yn(o.meta[1][0].data);u==6e3&&i.sheets.push(zje(t,o))})}),i}function qje(t,e){var r=MB(),n=Er(e.data),i=bB(n[1],ws);if(i.forEach(function(s){t[s].forEach(function(a){var o=Yn(a.meta[1][0].data);if(o==2){var u=Gje(t,a);u.sheets.forEach(function(c,f){AB(r,c,f==0?u.name:u.name+"_"+f,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function RI(t){var e,r,n,i,s={},a=[];if(t.FullPaths.forEach(function(u){if(u.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),t.FileIndex.forEach(function(u){if(u.name.match(/\.iwa$/)){var c;try{c=Co(u.content)}catch(g){return console.log("?? "+u.content.length+" "+(g.message||g))}var f;try{f=bo(c)}catch(g){return console.log("## "+(g.message||g))}f.forEach(function(g){s[g.id]=g.messages,a.push(g.id)})}}),!a.length)throw new Error("File has no messages");var o=((i=(n=(r=(e=s?.[1])==null?void 0:e[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:i[0].data)&&Yn(s[1][0].meta[1][0].data)==1&&s[1][0];if(o||a.forEach(function(u){s[u].forEach(function(c){var f=Yn(c.meta[1][0].data)>>>0;if(f==1)if(!o)o=c;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return qje(s,o)}function Kje(t,e,r){var n,i,s,a;if(!((n=t[6])!=null&&n[0])||!((i=t[7])!=null&&i[0]))throw"Mutation only works on post-BNC storages!";var o=((a=(s=t[8])==null?void 0:s[0])==null?void 0:a.data)&&Yn(t[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var u=0,c=Gg(t[7][0].data),f=0,g=[],m=Gg(t[4][0].data),v=0,w=[],y=0;y<e.length;++y){if(e[y]==null){c.setUint16(y*2,65535,!0),m.setUint16(y*2,65535);continue}c.setUint16(y*2,f,!0),m.setUint16(y*2,v,!0);var b,x;switch(typeof e[y]){case"string":b=EI({t:"s",v:e[y]},r),x=_I({t:"s",v:e[y]},r);break;case"number":b=EI({t:"n",v:e[y]},r),x=_I({t:"n",v:e[y]},r);break;case"boolean":b=EI({t:"b",v:e[y]},r),x=_I({t:"b",v:e[y]},r);break;default:throw new Error("Unsupported value "+e[y])}g.push(b),f+=b.length,w.push(x),v+=x.length,++u}for(t[2][0].data=jr(u);y<t[7][0].data.length/2;++y)c.setUint16(y*2,65535,!0),m.setUint16(y*2,65535,!0);return t[6][0].data=zf(g),t[3][0].data=zf(w),u}function Xje(t,e){if(!e||!e.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=t.Sheets[t.SheetNames[0]];t.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=Ks(r["!ref"]);n.s.r=n.s.c=0;var i=!1;n.e.c>9&&(i=!0,n.e.c=9),n.e.r>49&&(i=!0,n.e.r=49),i&&console.error("The Numbers writer is currently limited to ".concat(Ht(n)));var s=rR(r,{range:n,header:1}),a=["~Sh33tJ5~"];s.forEach(function(E){return E.forEach(function(R){typeof R=="string"&&a.push(R)})});var o={},u=[],c=vt.read(e.numbers,{type:"base64"});c.FileIndex.map(function(E,R){return[E,c.FullPaths[R]]}).forEach(function(E){var R=E[0],M=E[1];if(R.type==2&&R.name.match(/\.iwa/)){var F=R.content,Z=Co(F),te=bo(Z);te.forEach(function(fe){u.push(fe.id),o[fe.id]={deps:[],location:M,type:Yn(fe.messages[0].meta[1][0].data)}})}}),u.sort(function(E,R){return E-R});var f=u.filter(function(E){return E>1}).map(function(E){return[E,jr(E)]});c.FileIndex.map(function(E,R){return[E,c.FullPaths[R]]}).forEach(function(E){var R=E[0];if(E[1],!!R.name.match(/\.iwa/)){var M=bo(Co(R.content));M.forEach(function(F){F.messages.forEach(function(Z){f.forEach(function(te){F.messages.some(function(fe){return Yn(fe.meta[1][0].data)!=11006&&Hje(fe.data,te[1])})&&o[te[0]].deps.push(F.id)})})})}});for(var g=vt.find(c,o[1].location),m=bo(Co(g.content)),v,w=0;w<m.length;++w){var y=m[w];y.id==1&&(v=y)}var b=ws(Er(v.messages[0].data)[1][0].data);for(g=vt.find(c,o[b].location),m=bo(Co(g.content)),w=0;w<m.length;++w)y=m[w],y.id==b&&(v=y);for(b=ws(Er(v.messages[0].data)[2][0].data),g=vt.find(c,o[b].location),m=bo(Co(g.content)),w=0;w<m.length;++w)y=m[w],y.id==b&&(v=y);for(b=ws(Er(v.messages[0].data)[2][0].data),g=vt.find(c,o[b].location),m=bo(Co(g.content)),w=0;w<m.length;++w)y=m[w],y.id==b&&(v=y);var x=Er(v.messages[0].data);{x[6][0].data=jr(n.e.r+1),x[7][0].data=jr(n.e.c+1);var _=ws(x[46][0].data),T=vt.find(c,o[_].location),D=bo(Co(T.content));{for(var P=0;P<D.length&&D[P].id!=_;++P);if(D[P].id!=_)throw"Bad ColumnRowUIDMapArchive";var O=Er(D[P].messages[0].data);O[1]=[],O[2]=[],O[3]=[];for(var A=0;A<=n.e.c;++A){var W=[];W[1]=W[2]=[{type:0,data:jr(A+420690)}],O[1].push({type:2,data:es(W)}),O[2].push({type:0,data:jr(A)}),O[3].push({type:0,data:jr(A)})}O[4]=[],O[5]=[],O[6]=[];for(var L=0;L<=n.e.r;++L)W=[],W[1]=W[2]=[{type:0,data:jr(L+726270)}],O[4].push({type:2,data:es(W)}),O[5].push({type:0,data:jr(L)}),O[6].push({type:0,data:jr(L)});D[P].messages[0].data=es(O)}T.content=W0(V0(D)),T.size=T.content.length,delete x[46];var H=Er(x[4][0].data);{H[7][0].data=jr(n.e.r+1);var J=Er(H[1][0].data),G=ws(J[2][0].data);T=vt.find(c,o[G].location),D=bo(Co(T.content));{if(D[0].id!=G)throw"Bad HeaderStorageBucket";var ve=Er(D[0].messages[0].data);for(L=0;L<s.length;++L){var be=Er(ve[2][0].data);be[1][0].data=jr(L),be[4][0].data=jr(s[L].length),ve[2][L]={type:ve[2][0].type,data:es(be)}}D[0].messages[0].data=es(ve)}T.content=W0(V0(D)),T.size=T.content.length;var we=ws(H[2][0].data);T=vt.find(c,o[we].location),D=bo(Co(T.content));{if(D[0].id!=we)throw"Bad HeaderStorageBucket";for(ve=Er(D[0].messages[0].data),A=0;A<=n.e.c;++A)be=Er(ve[2][0].data),be[1][0].data=jr(A),be[4][0].data=jr(n.e.r+1),ve[2][A]={type:ve[2][0].type,data:es(be)};D[0].messages[0].data=es(ve)}T.content=W0(V0(D)),T.size=T.content.length;var ae=ws(H[4][0].data);(function(){for(var E=vt.find(c,o[ae].location),R=bo(Co(E.content)),M,F=0;F<R.length;++F){var Z=R[F];Z.id==ae&&(M=Z)}var te=Er(M.messages[0].data);{te[3]=[];var fe=[];a.forEach(function(k,ee){fe[1]=[{type:0,data:jr(ee)}],fe[2]=[{type:0,data:jr(1)}],fe[3]=[{type:2,data:Nje(k)}],te[3].push({type:2,data:es(fe)})})}M.messages[0].data=es(te);var I=V0(R),U=W0(I);E.content=U,E.size=E.content.length})();var le=Er(H[3][0].data);{var Te=le[1][0];delete le[2];var ce=Er(Te.data);{var K=ws(ce[2][0].data);(function(){for(var E=vt.find(c,o[K].location),R=bo(Co(E.content)),M,F=0;F<R.length;++F){var Z=R[F];Z.id==K&&(M=Z)}var te=Er(M.messages[0].data);{delete te[6],delete le[7];var fe=new Uint8Array(te[5][0].data);te[5]=[];for(var I=0,U=0;U<=n.e.r;++U){var k=Er(fe);I+=Kje(k,s[U],a),k[1][0].data=jr(U),te[5].push({data:es(k),type:2})}te[1]=[{type:0,data:jr(n.e.c+1)}],te[2]=[{type:0,data:jr(n.e.r+1)}],te[3]=[{type:0,data:jr(I)}],te[4]=[{type:0,data:jr(n.e.r+1)}]}M.messages[0].data=es(te);var ee=V0(R),oe=W0(ee);E.content=oe,E.size=E.content.length})()}Te.data=es(ce)}H[3][0].data=es(le)}x[4][0].data=es(H)}v.messages[0].data=es(x);var Se=V0(m),B=W0(Se);return g.content=B,g.size=g.content.length,c}function kne(t){return function(r){for(var n=0;n!=t.length;++n){var i=t[n];r[i[0]]===void 0&&(r[i[0]]=i[1]),i[2]==="n"&&(r[i[0]]=Number(r[i[0]]))}}}function CB(t){kne([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(t)}function xB(t){kne([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(t)}function Qje(t){return Zt.WS.indexOf(t)>-1?"sheet":t==Zt.CS?"chart":t==Zt.DS?"dialog":t==Zt.MS?"macro":t&&t.length?t:"sheet"}function Zje(t,e){if(!t)return 0;try{t=e.map(function(n){return n.id||(n.id=n.strRelID),[n.name,t["!id"][n.id].Target,Qje(t["!id"][n.id].Type)]})}catch{return null}return!t||t.length===0?null:t}function Jje(t,e,r,n,i,s,a,o,u,c,f,g){try{s[n]=a1(qa(t,r,!0),e);var m=yi(t,e),v;switch(o){case"sheet":v=_5e(m,e,i,u,s[n],c,f,g);break;case"chart":if(v=R5e(m,e,i,u,s[n],c,f,g),!v||!v["!drawel"])break;var w=Ay(v["!drawel"].Target,e),y=G1(w),b=d8e(qa(t,w,!0),a1(qa(t,y,!0),w)),x=Ay(b,w),_=G1(x);v=e5e(qa(t,x,!0),x,u,a1(qa(t,_,!0),x),c,v);break;case"macro":v=T5e(m,e,i,u,s[n],c,f,g);break;case"dialog":v=M5e(m,e,i,u,s[n],c,f,g);break;default:throw new Error("Unrecognized sheet type "+o)}a[n]=v;var T=[];s&&s[n]&&Gn(s[n]).forEach(function(D){var P="";if(s[n][D].Type==Zt.CMNT){P=Ay(s[n][D].Target,e);var O=D5e(yi(t,P,!0),P,u);if(!O||!O.length)return;BG(v,O,!1)}s[n][D].Type==Zt.TCMNT&&(P=Ay(s[n][D].Target,e),T=T.concat(m8e(yi(t,P,!0),u)))}),T&&T.length&&BG(v,T,!0,u.people||[])}catch(D){if(u.WTF)throw D}}function yo(t){return t.charAt(0)=="/"?t.slice(1):t}function Dne(t,e){if(fv(),e=e||{},CB(e),_o(t,"META-INF/manifest.xml")||_o(t,"objectdata.xml"))return XG(t,e);if(_o(t,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof RI<"u"){if(t.FileIndex)return RI(t);var r=vt.utils.cfb_new();return aG(t).forEach(function(be){Lt(r,be,p4e(t,be))}),RI(r)}throw new Error("Unsupported NUMBERS file")}if(!_o(t,"[Content_Types].xml"))throw _o(t,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):_o(t,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=aG(t),i=u3e(qa(t,"[Content_Types].xml")),s=!1,a,o;if(i.workbooks.length===0&&(o="xl/workbook.xml",yi(t,o,!0)&&i.workbooks.push(o)),i.workbooks.length===0){if(o="xl/workbook.bin",!yi(t,o,!0))throw new Error("Could not find workbook");i.workbooks.push(o),s=!0}i.workbooks[0].slice(-3)=="bin"&&(s=!0);var u={},c={};if(!e.bookSheets&&!e.bookProps){if(o1=[],i.sst)try{o1=k5e(yi(t,yo(i.sst)),i.sst,e)}catch(be){if(e.WTF)throw be}e.cellStyles&&i.themes.length&&(u=O5e(qa(t,i.themes[0].replace(/^\//,""),!0)||"",i.themes[0],e)),i.style&&(c=A5e(yi(t,yo(i.style)),i.style,u,e))}i.links.map(function(be){try{var we=a1(qa(t,G1(yo(be))),be);return I5e(yi(t,yo(be)),we,be,e)}catch{}});var f=E5e(yi(t,yo(i.workbooks[0])),i.workbooks[0],e),g={},m="";i.coreprops.length&&(m=yi(t,yo(i.coreprops[0]),!0),m&&(g=mre(m)),i.extprops.length!==0&&(m=yi(t,yo(i.extprops[0]),!0),m&&p3e(m,g,e)));var v={};(!e.bookSheets||e.bookProps)&&i.custprops.length!==0&&(m=qa(t,yo(i.custprops[0]),!0),m&&(v=w3e(m,e)));var w={};if((e.bookSheets||e.bookProps)&&(f.Sheets?a=f.Sheets.map(function(we){return we.name}):g.Worksheets&&g.SheetNames.length>0&&(a=g.SheetNames),e.bookProps&&(w.Props=g,w.Custprops=v),e.bookSheets&&typeof a<"u"&&(w.SheetNames=a),e.bookSheets?w.SheetNames:e.bookProps))return w;a={};var y={};e.bookDeps&&i.calcchain&&(y=P5e(yi(t,yo(i.calcchain)),i.calcchain));var b=0,x={},_,T;{var D=f.Sheets;g.Worksheets=D.length,g.SheetNames=[];for(var P=0;P!=D.length;++P)g.SheetNames[P]=D[P].name}var O=s?"bin":"xml",A=i.workbooks[0].lastIndexOf("/"),W=(i.workbooks[0].slice(0,A+1)+"_rels/"+i.workbooks[0].slice(A+1)+".rels").replace(/^\//,"");_o(t,W)||(W="xl/_rels/workbook."+O+".rels");var L=a1(qa(t,W,!0),W.replace(/_rels.*/,"s5s"));(i.metadata||[]).length>=1&&(e.xlmeta=N5e(yi(t,yo(i.metadata[0])),i.metadata[0],e)),(i.people||[]).length>=1&&(e.people=v8e(yi(t,yo(i.people[0])),e)),L&&(L=Zje(L,f.Sheets));var H=yi(t,"xl/worksheets/sheet.xml",!0)?1:0;e:for(b=0;b!=g.Worksheets;++b){var J="sheet";if(L&&L[b]?(_="xl/"+L[b][1].replace(/[\/]?xl\//,""),_o(t,_)||(_=L[b][1]),_o(t,_)||(_=W.replace(/_rels\/.*$/,"")+L[b][1]),J=L[b][2]):(_="xl/worksheets/sheet"+(b+1-H)+"."+O,_=_.replace(/sheet0\./,"sheet.")),T=_.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),e&&e.sheets!=null)switch(typeof e.sheets){case"number":if(b!=e.sheets)continue e;break;case"string":if(g.SheetNames[b].toLowerCase()!=e.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(e.sheets)){for(var G=!1,ve=0;ve!=e.sheets.length;++ve)typeof e.sheets[ve]=="number"&&e.sheets[ve]==b&&(G=1),typeof e.sheets[ve]=="string"&&e.sheets[ve].toLowerCase()==g.SheetNames[b].toLowerCase()&&(G=1);if(!G)continue e}}Jje(t,_,T,g.SheetNames[b],b,x,a,J,e,f,u,c)}return w={Directory:i,Workbook:f,Props:g,Custprops:v,Deps:y,Sheets:a,SheetNames:g.SheetNames,Strings:o1,Styles:c,Themes:u,SSF:rn(xt)},e&&e.bookFiles&&(t.files?(w.keys=n,w.files=t.files):(w.keys=[],w.files={},t.FullPaths.forEach(function(be,we){be=be.replace(/^Root Entry[\/]/,""),w.keys.push(be),w.files[be]=t.FileIndex[we]}))),e&&e.bookVBA&&(i.vba.length>0?w.vbaraw=yi(t,yo(i.vba[0]),!0):i.defaults&&i.defaults.bin===_8e&&(w.vbaraw=yi(t,"xl/vbaProject.bin",!0))),w}function e9e(t,e){var r=e||{},n="Workbook",i=vt.find(t,n);try{if(n="/!DataSpaces/Version",i=vt.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(HVe(i.content),n="/!DataSpaces/DataSpaceMap",i=vt.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=LVe(i.content);if(s.length!==1||s[0].comps.length!==1||s[0].comps[0].t!==0||s[0].name!=="StrongEncryptionDataSpace"||s[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",i=vt.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var a=BVe(i.content);if(a.length!=1||a[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",i=vt.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);WVe(i.content)}catch{}if(n="/EncryptionInfo",i=vt.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=$Ve(i.content);if(n="/EncryptedPackage",i=vt.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],i.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],i.content,r.password||"",r);throw new Error("File is password-protected")}function t9e(t,e){return e.bookType=="ods"?One(t,e):e.bookType=="numbers"?Xje(t,e):e.bookType=="xlsb"?r9e(t,e):Pne(t,e)}function r9e(t,e){op=1024,t&&!t.SSF&&(t.SSF=rn(xt)),t&&t.SSF&&(fv(),BS(t.SSF),e.revssf=MT(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,l1?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r=e.bookType=="xlsb"?"bin":"xml",n=ene.indexOf(e.bookType)>-1,i=oB();xB(e=e||{});var s=U3(),a="",o=0;if(e.cellXfs=[],nd(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),a="docProps/core.xml",Lt(s,a,pre(t.Props,e)),i.coreprops.push(a),zr(e.rels,2,a,Zt.CORE_PROPS),a="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var u=[],c=0;c<t.SheetNames.length;++c)(t.Workbook.Sheets[c]||{}).Hidden!=2&&u.push(t.SheetNames[c]);t.Props.SheetNames=u}for(t.Props.Worksheets=t.Props.SheetNames.length,Lt(s,a,yre(t.Props)),i.extprops.push(a),zr(e.rels,3,a,Zt.EXT_PROPS),t.Custprops!==t.Props&&Gn(t.Custprops||{}).length>0&&(a="docProps/custom.xml",Lt(s,a,Sre(t.Custprops)),i.custprops.push(a),zr(e.rels,4,a,Zt.CUST_PROPS)),o=1;o<=t.SheetNames.length;++o){var f={"!id":{}},g=t.Sheets[t.SheetNames[o-1]],m=(g||{})["!type"]||"sheet";switch(m){case"chart":default:a="xl/worksheets/sheet"+o+"."+r,Lt(s,a,F5e(o-1,a,e,t,f)),i.sheets.push(a),zr(e.wbrels,-1,"worksheets/sheet"+o+"."+r,Zt.WS[0])}if(g){var v=g["!comments"],w=!1,y="";v&&v.length>0&&(y="xl/comments"+o+"."+r,Lt(s,y,V5e(v,y)),i.comments.push(y),zr(f,-1,"../comments"+o+"."+r,Zt.CMNT),w=!0),g["!legacy"]&&w&&Lt(s,"xl/drawings/vmlDrawing"+o+".vml",Zre(o,g["!comments"])),delete g["!comments"],delete g["!legacy"]}f["!id"].rId1&&Lt(s,G1(a),yp(f))}return e.Strings!=null&&e.Strings.length>0&&(a="xl/sharedStrings."+r,Lt(s,a,B5e(e.Strings,a,e)),i.strs.push(a),zr(e.wbrels,-1,"sharedStrings."+r,Zt.SST)),a="xl/workbook."+r,Lt(s,a,H5e(t,a)),i.workbooks.push(a),zr(e.rels,1,a,Zt.WB),a="xl/theme/theme1.xml",Lt(s,a,dB(t.Themes,e)),i.themes.push(a),zr(e.wbrels,-1,"theme/theme1.xml",Zt.THEME),a="xl/styles."+r,Lt(s,a,L5e(t,a,e)),i.styles.push(a),zr(e.wbrels,-1,"styles."+r,Zt.STY),t.vbaraw&&n&&(a="xl/vbaProject.bin",Lt(s,a,t.vbaraw),i.vba.push(a),zr(e.wbrels,-1,"vbaProject.bin",Zt.VBA)),a="xl/metadata."+r,Lt(s,a,W5e(a)),i.metadata.push(a),zr(e.wbrels,-1,"metadata."+r,Zt.XLMETA),Lt(s,"[Content_Types].xml",dre(i,e)),Lt(s,"_rels/.rels",yp(e.rels)),Lt(s,"xl/_rels/workbook."+r+".rels",yp(e.wbrels)),delete e.revssf,delete e.ssf,s}function Pne(t,e){op=1024,t&&!t.SSF&&(t.SSF=rn(xt)),t&&t.SSF&&(fv(),BS(t.SSF),e.revssf=MT(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,l1?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r="xml",n=ene.indexOf(e.bookType)>-1,i=oB();xB(e=e||{});var s=U3(),a="",o=0;if(e.cellXfs=[],nd(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),a="docProps/core.xml",Lt(s,a,pre(t.Props,e)),i.coreprops.push(a),zr(e.rels,2,a,Zt.CORE_PROPS),a="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var u=[],c=0;c<t.SheetNames.length;++c)(t.Workbook.Sheets[c]||{}).Hidden!=2&&u.push(t.SheetNames[c]);t.Props.SheetNames=u}t.Props.Worksheets=t.Props.SheetNames.length,Lt(s,a,yre(t.Props)),i.extprops.push(a),zr(e.rels,3,a,Zt.EXT_PROPS),t.Custprops!==t.Props&&Gn(t.Custprops||{}).length>0&&(a="docProps/custom.xml",Lt(s,a,Sre(t.Custprops)),i.custprops.push(a),zr(e.rels,4,a,Zt.CUST_PROPS));var f=["SheetJ5"];for(e.tcid=0,o=1;o<=t.SheetNames.length;++o){var g={"!id":{}},m=t.Sheets[t.SheetNames[o-1]],v=(m||{})["!type"]||"sheet";switch(v){case"chart":default:a="xl/worksheets/sheet"+o+"."+r,Lt(s,a,hne(o-1,e,t,g)),i.sheets.push(a),zr(e.wbrels,-1,"worksheets/sheet"+o+"."+r,Zt.WS[0])}if(m){var w=m["!comments"],y=!1,b="";if(w&&w.length>0){var x=!1;w.forEach(function(_){_[1].forEach(function(T){T.T==!0&&(x=!0)})}),x&&(b="xl/threadedComments/threadedComment"+o+"."+r,Lt(s,b,p8e(w,f,e)),i.threadedcomments.push(b),zr(g,-1,"../threadedComments/threadedComment"+o+"."+r,Zt.TCMNT)),b="xl/comments"+o+"."+r,Lt(s,b,Jre(w)),i.comments.push(b),zr(g,-1,"../comments"+o+"."+r,Zt.CMNT),y=!0}m["!legacy"]&&y&&Lt(s,"xl/drawings/vmlDrawing"+o+".vml",Zre(o,m["!comments"])),delete m["!comments"],delete m["!legacy"]}g["!id"].rId1&&Lt(s,G1(a),yp(g))}return e.Strings!=null&&e.Strings.length>0&&(a="xl/sharedStrings."+r,Lt(s,a,Vre(e.Strings,e)),i.strs.push(a),zr(e.wbrels,-1,"sharedStrings."+r,Zt.SST)),a="xl/workbook."+r,Lt(s,a,vne(t)),i.workbooks.push(a),zr(e.rels,1,a,Zt.WB),a="xl/theme/theme1.xml",Lt(s,a,dB(t.Themes,e)),i.themes.push(a),zr(e.wbrels,-1,"theme/theme1.xml",Zt.THEME),a="xl/styles."+r,Lt(s,a,qre(t,e)),i.styles.push(a),zr(e.wbrels,-1,"styles."+r,Zt.STY),t.vbaraw&&n&&(a="xl/vbaProject.bin",Lt(s,a,t.vbaraw),i.vba.push(a),zr(e.wbrels,-1,"vbaProject.bin",Zt.VBA)),a="xl/metadata."+r,Lt(s,a,Qre()),i.metadata.push(a),zr(e.wbrels,-1,"metadata."+r,Zt.XLMETA),f.length>1&&(a="xl/persons/person.xml",Lt(s,a,w8e(f)),i.people.push(a),zr(e.wbrels,-1,"persons/person.xml",Zt.PEOPLE)),Lt(s,"[Content_Types].xml",dre(i,e)),Lt(s,"_rels/.rels",yp(e.rels)),Lt(s,"xl/_rels/workbook."+r+".rels",yp(e.wbrels)),delete e.revssf,delete e.ssf,s}function EB(t,e){var r="";switch((e||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":r=Za(t.slice(0,12));break;case"binary":r=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function n9e(t,e){return vt.find(t,"EncryptedPackage")?e9e(t,e):SB(t,e)}function i9e(t,e){var r,n=t,i=e||{};return i.type||(i.type=Gt&&Buffer.isBuffer(t)?"buffer":"base64"),r=zte(n,i),Dne(r,i)}function Ine(t,e){var r=0;e:for(;r<t.length;)switch(t.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return oH(t.slice(r),e);default:break e}return Bp.to_workbook(t,e)}function s9e(t,e){var r="",n=EB(t,e);switch(e.type){case"base64":r=Za(t);break;case"binary":r=t;break;case"buffer":r=t.toString("binary");break;case"array":r=Ug(t);break;default:throw new Error("Unrecognized type "+e.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=Zr(r)),e.type="binary",Ine(r,e)}function a9e(t,e){var r=t;return e.type=="base64"&&(r=Za(r)),r=gr.utils.decode(1200,r.slice(2),"str"),e.type="binary",Ine(r,e)}function o9e(t){return t.match(/[^\x00-\x7F]/)?ku(t):t}function TI(t,e,r,n){return n?(r.type="string",Bp.to_workbook(t,r)):Bp.to_workbook(e,r)}function tR(t,e){RT();var r=e||{};if(typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer)return tR(new Uint8Array(t),(r=rn(r),r.type="array",r));typeof Uint8Array<"u"&&t instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=t,i=[0,0,0,0],s=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),bp={},r.dateNF&&(bp.dateNF=r.dateNF),r.type||(r.type=Gt&&Buffer.isBuffer(t)?"buffer":"base64"),r.type=="file"&&(r.type=Gt?"buffer":"binary",n=l4e(t),typeof Uint8Array<"u"&&!Gt&&(r.type="array")),r.type=="string"&&(s=!0,r.type="binary",r.codepage=65001,n=o9e(t)),r.type=="array"&&typeof Uint8Array<"u"&&t instanceof Uint8Array&&typeof ArrayBuffer<"u"){var a=new ArrayBuffer(3),o=new Uint8Array(a);if(o.foo="bar",!o.foo)return r=rn(r),r.type="array",tR(B3(n),r)}switch((i=EB(n,r))[0]){case 208:if(i[1]===207&&i[2]===17&&i[3]===224&&i[4]===161&&i[5]===177&&i[6]===26&&i[7]===225)return n9e(vt.read(n,r),r);break;case 9:if(i[1]<=8)return SB(n,r);break;case 60:return oH(n,r);case 73:if(i[1]===73&&i[2]===42&&i[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(i[1]===68)return yVe(n,r);break;case 84:if(i[1]===65&&i[2]===66&&i[3]===76)return Lre.to_workbook(n,r);break;case 80:return i[1]===75&&i[2]<9&&i[3]<9?i9e(n,r):TI(t,n,r,s);case 239:return i[3]===60?oH(n,r):TI(t,n,r,s);case 255:if(i[1]===254)return a9e(n,r);if(i[1]===0&&i[2]===2&&i[3]===0)return Mg.to_workbook(n,r);break;case 0:if(i[1]===0&&(i[2]>=2&&i[3]===0||i[2]===0&&(i[3]===8||i[3]===9)))return Mg.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return aH.to_workbook(n,r);case 123:if(i[1]===92&&i[2]===114&&i[3]===116)return Yre.to_workbook(n,r);break;case 10:case 13:case 32:return s9e(n,r);case 137:if(i[1]===80&&i[2]===78&&i[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return wVe.indexOf(i[0])>-1&&i[2]<=12&&i[3]<=31?aH.to_workbook(n,r):TI(t,n,r,s)}function tq(t,e){var r=e||{};return r.type="file",tR(t,r)}function Nne(t,e){switch(e.type){case"base64":case"binary":break;case"buffer":case"array":e.type="";break;case"file":return VS(e.file,vt.write(t,{type:Gt?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");default:throw new Error("Unrecognized type "+e.type)}return vt.write(t,e)}function l9e(t,e){var r=rn(e||{}),n=t9e(t,r);return Hne(n,r)}function u9e(t,e){var r=rn(e||{}),n=Pne(t,r);return Hne(n,r)}function Hne(t,e){var r={},n=Gt?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(e.compression&&(r.compression="DEFLATE"),e.password)r.type=n;else switch(e.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+e.type)}var i=t.FullPaths?vt.write(t,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!e.compression}):t.generate(r);if(typeof Deno<"u"&&typeof i=="string"){if(e.type=="binary"||e.type=="base64")return i;i=new Uint8Array(LS(i))}return e.password&&typeof encrypt_agile<"u"?Nne(encrypt_agile(i,e.password),e):e.type==="file"?VS(e.file,i):e.type=="string"?Zr(i):i}function c9e(t,e){var r=e||{},n=dje(t,r);return Nne(n,r)}function fu(t,e,r){r||(r="");var n=r+t;switch(e.type){case"base64":return $1(ku(n));case"binary":return ku(n);case"string":return t;case"file":return VS(e.file,n,"utf8");case"buffer":return Gt?dh(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):fu(n,{type:"binary"}).split("").map(function(i){return i.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function h9e(t,e){switch(e.type){case"base64":return $1(t);case"binary":return t;case"string":return t;case"file":return VS(e.file,t,"binary");case"buffer":return Gt?dh(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function Zx(t,e){switch(e.type){case"string":case"base64":case"binary":for(var r="",n=0;n<t.length;++n)r+=String.fromCharCode(t[n]);return e.type=="base64"?$1(r):e.type=="string"?Zr(r):r;case"file":return VS(e.file,t);case"buffer":return t;default:throw new Error("Unrecognized type "+e.type)}}function _B(t,e){RT(),pne(t);var r=rn(e||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=_B(t,r);return r.type="array",LS(n)}return u9e(t,r)}function NT(t,e){RT(),pne(t);var r=rn(e||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=NT(t,r);return r.type="array",LS(n)}var i=0;if(r.sheet&&(typeof r.sheet=="number"?i=r.sheet:i=t.SheetNames.indexOf(r.sheet),!t.SheetNames[i]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return fu(aje(t,r),r);case"slk":case"sylk":return fu(Fre.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"htm":case"html":return fu(Rne(t.Sheets[t.SheetNames[i]],r),r);case"txt":return h9e(Bne(t.Sheets[t.SheetNames[i]],r),r);case"csv":return fu(TB(t.Sheets[t.SheetNames[i]],r),r,"\uFEFF");case"dif":return fu(Lre.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"dbf":return Zx(aH.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"prn":return fu(Bp.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"rtf":return fu(Yre.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"eth":return fu(Bre.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"fods":return fu(One(t,r),r);case"wk1":return Zx(Mg.sheet_to_wk1(t.Sheets[t.SheetNames[i]],r),r);case"wk3":return Zx(Mg.book_to_wk3(t,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),Zx(bne(t,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),c9e(t,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return l9e(t,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function RB(t){if(!t.bookType){var e={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=t.file.slice(t.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(t.bookType=r.slice(1)),t.bookType=e[t.bookType]||t.bookType}}function cH(t,e,r){var n=r||{};return n.type="file",n.file=e,RB(n),NT(t,n)}function f9e(t,e,r){var n=r||{};return n.type="file",n.file=e,RB(n),_B(t,n)}function d9e(t,e,r,n){var i=r||{};i.type="file",i.file=t,RB(i),i.type="buffer";var s=n;return s instanceof Function||(s=r),Mf.writeFile(t,NT(e,i),s)}function Fne(t,e,r,n,i,s,a,o){var u=jn(r),c=o.defval,f=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),g=!0,m=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(m,"__rowNum__",{value:r,enumerable:!1})}catch{m.__rowNum__=r}else m.__rowNum__=r;if(!a||t[r])for(var v=e.s.c;v<=e.e.c;++v){var w=a?t[r][v]:t[n[v]+u];if(w===void 0||w.t===void 0){if(c===void 0)continue;s[v]!=null&&(m[s[v]]=c);continue}var y=w.v;switch(w.t){case"z":if(y==null)break;continue;case"e":y=y==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+w.t)}if(s[v]!=null){if(y==null)if(w.t=="e"&&y===null)m[s[v]]=null;else if(c!==void 0)m[s[v]]=c;else if(f&&y===null)m[s[v]]=null;else continue;else m[s[v]]=f&&(w.t!=="n"||w.t==="n"&&o.rawNumbers!==!1)?y:Vu(w,y,o);y!=null&&(g=!1)}}return{row:m,isempty:g}}function rR(t,e){if(t==null||t["!ref"]==null)return[];var r={t:"n",v:0},n=0,i=1,s=[],a=0,o="",u={s:{r:0,c:0},e:{r:0,c:0}},c=e||{},f=c.range!=null?c.range:t["!ref"];switch(c.header===1?n=1:c.header==="A"?n=2:Array.isArray(c.header)?n=3:c.header==null&&(n=0),typeof f){case"string":u=ar(f);break;case"number":u=ar(t["!ref"]),u.s.r=f;break;default:u=f}n>0&&(i=0);var g=jn(u.s.r),m=[],v=[],w=0,y=0,b=Array.isArray(t),x=u.s.r,_=0,T={};b&&!t[x]&&(t[x]=[]);var D=c.skipHidden&&t["!cols"]||[],P=c.skipHidden&&t["!rows"]||[];for(_=u.s.c;_<=u.e.c;++_)if(!(D[_]||{}).hidden)switch(m[_]=mn(_),r=b?t[x][_]:t[m[_]+g],n){case 1:s[_]=_-u.s.c;break;case 2:s[_]=m[_];break;case 3:s[_]=c.header[_-u.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=a=Vu(r,null,c),y=T[a]||0,!y)T[a]=1;else{do o=a+"_"+y++;while(T[o]);T[a]=y,T[o]=1}s[_]=o}for(x=u.s.r+i;x<=u.e.r;++x)if(!(P[x]||{}).hidden){var O=Fne(t,u,x,m,n,s,b,c);(O.isempty===!1||(n===1?c.blankrows!==!1:c.blankrows))&&(v[w++]=O.row)}return v.length=w,v}var rq=/"/g;function Lne(t,e,r,n,i,s,a,o){for(var u=!0,c=[],f="",g=jn(r),m=e.s.c;m<=e.e.c;++m)if(n[m]){var v=o.dense?(t[r]||[])[m]:t[n[m]+g];if(v==null)f="";else if(v.v!=null){u=!1,f=""+(o.rawNumbers&&v.t=="n"?v.v:Vu(v,null,o));for(var w=0,y=0;w!==f.length;++w)if((y=f.charCodeAt(w))===i||y===s||y===34||o.forceQuotes){f='"'+f.replace(rq,'""')+'"';break}f=="ID"&&(f='"ID"')}else v.f!=null&&!v.F?(u=!1,f="="+v.f,f.indexOf(",")>=0&&(f='"'+f.replace(rq,'""')+'"')):f="";c.push(f)}return o.blankrows===!1&&u?null:c.join(a)}function TB(t,e){var r=[],n=e??{};if(t==null||t["!ref"]==null)return"";var i=ar(t["!ref"]),s=n.FS!==void 0?n.FS:",",a=s.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,u=o.charCodeAt(0),c=new RegExp((s=="|"?"\\|":s)+"+$"),f="",g=[];n.dense=Array.isArray(t);for(var m=n.skipHidden&&t["!cols"]||[],v=n.skipHidden&&t["!rows"]||[],w=i.s.c;w<=i.e.c;++w)(m[w]||{}).hidden||(g[w]=mn(w));for(var y=0,b=i.s.r;b<=i.e.r;++b)(v[b]||{}).hidden||(f=Lne(t,i,b,g,a,u,s,n),f!=null&&(n.strip&&(f=f.replace(c,"")),(f||n.blankrows!==!1)&&r.push((y++?o:"")+f)));return delete n.dense,r.join("")}function Bne(t,e){e||(e={}),e.FS="	",e.RS=`
`;var r=TB(t,e);if(typeof gr>"u"||e.type=="string")return r;var n=gr.utils.encode(1200,r,"str");return"ÿþ"+n}function g9e(t){var e="",r,n="";if(t==null||t["!ref"]==null)return[];var i=ar(t["!ref"]),s="",a=[],o,u=[],c=Array.isArray(t);for(o=i.s.c;o<=i.e.c;++o)a[o]=mn(o);for(var f=i.s.r;f<=i.e.r;++f)for(s=jn(f),o=i.s.c;o<=i.e.c;++o)if(e=a[o]+s,r=c?(t[f]||[])[o]:t[e],n="",r!==void 0){if(r.F!=null){if(e=r.F,!r.f)continue;n=r.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}u[u.length]=e+"="+n}return u}function Vne(t,e,r){var n=r||{},i=+!n.skipHeader,s=t||{},a=0,o=0;if(s&&n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var u=typeof n.origin=="string"?Dn(n.origin):n.origin;a=u.r,o=u.c}var c,f={s:{c:0,r:0},e:{c:o,r:a+e.length-1+i}};if(s["!ref"]){var g=ar(s["!ref"]);f.e.c=Math.max(f.e.c,g.e.c),f.e.r=Math.max(f.e.r,g.e.r),a==-1&&(a=g.e.r+1,f.e.r=a+e.length-1+i)}else a==-1&&(a=0,f.e.r=e.length-1+i);var m=n.header||[],v=0;e.forEach(function(y,b){Gn(y).forEach(function(x){(v=m.indexOf(x))==-1&&(m[v=m.length]=x);var _=y[x],T="z",D="",P=Tt({c:o+v,r:a+b+i});c=eS(s,P),_&&typeof _=="object"&&!(_ instanceof Date)?s[P]=_:(typeof _=="number"?T="n":typeof _=="boolean"?T="b":typeof _=="string"?T="s":_ instanceof Date?(T="d",n.cellDates||(T="n",_=Hi(_)),D=n.dateNF||xt[14]):_===null&&n.nullError&&(T="e",_=0),c?(c.t=T,c.v=_,delete c.w,delete c.R,D&&(c.z=D)):s[P]=c={t:T,v:_},D&&(c.z=D))})}),f.e.c=Math.max(f.e.c,o+m.length-1);var w=jn(a);if(i)for(v=0;v<m.length;++v)s[mn(v+o)+w]={t:"s",v:m[v]};return s["!ref"]=Ht(f),s}function m9e(t,e){return Vne(null,t,e)}function eS(t,e,r){if(typeof e=="string"){if(Array.isArray(t)){var n=Dn(e);return t[n.r]||(t[n.r]=[]),t[n.r][n.c]||(t[n.r][n.c]={t:"z"})}return t[e]||(t[e]={t:"z"})}return typeof e!="number"?eS(t,Tt(e)):eS(t,Tt({r:e,c:r||0}))}function p9e(t,e){if(typeof e=="number"){if(e>=0&&t.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var r=t.SheetNames.indexOf(e);if(r>-1)return r;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function MB(){return{SheetNames:[],Sheets:{}}}function AB(t,e,r,n){var i=1;if(!r)for(;i<=65535&&t.SheetNames.indexOf(r="Sheet"+i)!=-1;++i,r=void 0);if(!r||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&t.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);i=s&&+s[2]||0;var a=s&&s[1]||r;for(++i;i<=65535&&t.SheetNames.indexOf(r=a+i)!=-1;++i);}if(mne(r),t.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return t.SheetNames.push(r),t.Sheets[r]=e,r}function v9e(t,e,r){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var n=p9e(t,e);switch(t.Workbook.Sheets[n]||(t.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}t.Workbook.Sheets[n].Hidden=r}function w9e(t,e){return t.z=e,t}function Wne(t,e,r){return e?(t.l={Target:e},r&&(t.l.Tooltip=r)):delete t.l,t}function y9e(t,e,r){return Wne(t,"#"+e,r)}function S9e(t,e,r){t.c||(t.c=[]),t.c.push({t:e,a:r||"SheetJS"})}function b9e(t,e,r,n){for(var i=typeof e!="string"?e:ar(e),s=typeof e=="string"?e:Ht(e),a=i.s.r;a<=i.e.r;++a)for(var o=i.s.c;o<=i.e.c;++o){var u=eS(t,a,o);u.t="n",u.F=s,delete u.v,a==i.s.r&&o==i.s.c&&(u.f=r,n&&(u.D=!0))}return t}var IE={encode_col:mn,encode_row:jn,encode_cell:Tt,encode_range:Ht,decode_col:tB,decode_row:eB,split_cell:V4e,decode_cell:Dn,decode_range:Ks,format_cell:Vu,sheet_add_aoa:are,sheet_add_json:Vne,sheet_add_dom:Tne,aoa_to_sheet:gv,json_to_sheet:m9e,table_to_sheet:Mne,table_to_book:kje,sheet_to_csv:TB,sheet_to_txt:Bne,sheet_to_json:rR,sheet_to_html:Rne,sheet_to_formulae:g9e,sheet_to_row_object_array:rR,sheet_get_cell:eS,book_new:MB,book_append_sheet:AB,book_set_sheet_visibility:v9e,cell_set_number_format:w9e,cell_set_hyperlink:Wne,cell_set_internal_link:y9e,cell_add_comment:S9e,sheet_set_array_formula:b9e,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}},HT;function C9e(t){HT=t}function x9e(t,e){var r=HT(),n=e??{};if(t==null||t["!ref"]==null)return r.push(null),r;var i=ar(t["!ref"]),s=n.FS!==void 0?n.FS:",",a=s.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,u=o.charCodeAt(0),c=new RegExp((s=="|"?"\\|":s)+"+$"),f="",g=[];n.dense=Array.isArray(t);for(var m=n.skipHidden&&t["!cols"]||[],v=n.skipHidden&&t["!rows"]||[],w=i.s.c;w<=i.e.c;++w)(m[w]||{}).hidden||(g[w]=mn(w));var y=i.s.r,b=!1,x=0;return r._read=function(){if(!b)return b=!0,r.push("\uFEFF");for(;y<=i.e.r;)if(++y,!(v[y-1]||{}).hidden&&(f=Lne(t,i,y-1,g,a,u,s,n),f!=null&&(n.strip&&(f=f.replace(c,"")),f||n.blankrows!==!1)))return r.push((x++?o:"")+f);return r.push(null)},r}function E9e(t,e){var r=HT(),n=e||{},i=n.header!=null?n.header:xne,s=n.footer!=null?n.footer:Ene;r.push(i);var a=Ks(t["!ref"]);n.dense=Array.isArray(t),r.push(_ne(t,a,n));var o=a.s.r,u=!1;return r._read=function(){if(o>a.e.r)return u||(u=!0,r.push("</table>"+s)),r.push(null);for(;o<=a.e.r;){r.push(Cne(t,a,o,n)),++o;break}},r}function _9e(t,e){var r=HT({objectMode:!0});if(t==null||t["!ref"]==null)return r.push(null),r;var n={t:"n",v:0},i=0,s=1,a=[],o=0,u="",c={s:{r:0,c:0},e:{r:0,c:0}},f=e||{},g=f.range!=null?f.range:t["!ref"];switch(f.header===1?i=1:f.header==="A"?i=2:Array.isArray(f.header)&&(i=3),typeof g){case"string":c=ar(g);break;case"number":c=ar(t["!ref"]),c.s.r=g;break;default:c=g}i>0&&(s=0);var m=jn(c.s.r),v=[],w=0,y=Array.isArray(t),b=c.s.r,x=0,_={};y&&!t[b]&&(t[b]=[]);var T=f.skipHidden&&t["!cols"]||[],D=f.skipHidden&&t["!rows"]||[];for(x=c.s.c;x<=c.e.c;++x)if(!(T[x]||{}).hidden)switch(v[x]=mn(x),n=y?t[b][x]:t[v[x]+m],i){case 1:a[x]=x-c.s.c;break;case 2:a[x]=v[x];break;case 3:a[x]=f.header[x-c.s.c];break;default:if(n==null&&(n={w:"__EMPTY",t:"s"}),u=o=Vu(n,null,f),w=_[o]||0,!w)_[o]=1;else{do u=o+"_"+w++;while(_[u]);_[o]=w,_[u]=1}a[x]=u}return b=c.s.r+s,r._read=function(){for(;b<=c.e.r;)if(!(D[b-1]||{}).hidden){var P=Fne(t,c,b,v,i,a,y,f);if(++b,P.isempty===!1||(i===1?f.blankrows!==!1:f.blankrows)){r.push(P.row);return}}return r.push(null)},r}var R9e={to_json:_9e,to_html:E9e,to_csv:x9e,set_readable:C9e};const T9e=W1.version,OB=Object.freeze(Object.defineProperty({__proto__:null,CFB:vt,SSF:Vte,parse_xlscfb:SB,parse_zip:Dne,read:tR,readFile:tq,readFileSync:tq,set_cptable:kLe,set_fs:a4e,stream:R9e,utils:IE,version:T9e,write:NT,writeFile:cH,writeFileAsync:d9e,writeFileSync:cH,writeFileXLSX:f9e,writeXLSX:_B},Symbol.toStringTag,{value:"Module"})),M9e=()=>{const t=["업무구분","공급가액","차대번호","차명"],e=[["렌트","1000000","VIN123456789","소나타"]],r=IE.book_new(),n=IE.aoa_to_sheet([t,...e]);n["!cols"]=t.map(()=>({wch:15})),IE.book_append_sheet(r,n,"차량등록양식"),cH(r,"차량등록양식.xlsx")},nq=[{id:1,number:"12가3456"},{id:2,number:"34나7890"},{id:3,number:"56다1234"},{id:4,number:"78라5678"},{id:5,number:"90마4321"},{id:6,number:"11바8765"},{id:7,number:"22사2345"},{id:8,number:"33아6789"},{id:9,number:"44자1234"},{id:10,number:"55차5678"},{id:11,number:"66카4321"},{id:12,number:"77타8765"},{id:13,number:"88파2345"},{id:14,number:"99하6789"},{id:15,number:"00가1234"}],iq={plateId:"",businessType:"",price:"",vinNumber:"",carName:"",ownerName:"",idType:"business",idNumber:""},Jx=[{key:"index",name:"번호"},{key:"차량번호",name:"차량번호"},{key:"업무구분",name:"업무구분"},{key:"공급가액",name:"공급가액"},{key:"차대번호",name:"차대번호"},{key:"차명",name:"차명"},{key:"사용본거지",name:"사용본거지"}],sq=[{code:"렌트",name:"렌트"},{code:"리스",name:"리스"},{code:"개인",name:"개인"}],aq=["현대캐피탈 강남지점","현대캐피탈 강북중고지점","현대캐피탈 강서지점","현대캐피탈 광진지점","현대캐피탈 마포지점","KB캐피탈 강남지점","KB캐피탈 강북지점","KB캐피탈 강서지점","KB캐피탈 서울지점","KB캐피탈 생활금융부 집중화팀","메리츠캐피탈 본점","메리츠캐피탈 강남신차지점","메리츠캐피탈 서울지점"];function A9e(){const[t,e]=ie.useState("single"),[r,n]=ie.useState(null),[i,s]=ie.useState([]),[a,o]=ie.useState(!1),[u,c]=ie.useState(iq),[f,g]=ie.useState(0),[m,v]=ie.useState([]),[w,y]=ie.useState(!1),{user:b}=oh(),[x,_]=ie.useState(!1),T=Yo(),[D,P]=ie.useState(null),[O,A]=ie.useState(null),[W,L]=ie.useState([]),H=ie.useRef(null);if(ie.useEffect(()=>{b||_(!0)},[b,T]),!b||!b.username)return Y.jsx(Zg,{open:x});const J=async B=>{const E=B.target.files[0];n(E);const R=await RH(()=>Promise.resolve().then(()=>OB),void 0),M=new FileReader;M.onload=F=>{const Z=F.target.result,te=R.read(Z,{type:"binary"}),fe=te.SheetNames[0],I=te.Sheets[fe],k=R.utils.sheet_to_json(I,{header:0}).map((ee,oe)=>({index:oe+1,...ee}));L(k)},M.readAsArrayBuffer(E)},G=(B,E,R)=>{L(M=>M.map((F,Z)=>Z===B?{...F,[E]:R}:F))},ve=B=>{if(B.preventDefault(),!W.length){v(["업로드된 데이터가 없습니다."]),y(!0);return}g(W.length),L([]),n(null),o(!0)},be=()=>{L([]),n(null),H.current&&(H.current.value="")},we=B=>{const{name:E,value:R,type:M,checked:F}=B.target;c(Z=>({...Z,[E]:M==="checkbox"?F:R}))},ae=B=>{B.preventDefault(),console.log(u),c(iq),document.getElementById("registerForm").reset(),o(!0),A("")},le=B=>{B.preventDefault(),M9e(Jx.map(E=>E.name))},Te=B=>{P(B)},ce=B=>{D!==null&&G(D,"차량번호",B.number),P(null)},K=B=>{const E=B.target.value.replace(/[^0-9]/g,"");c(R=>({...R,price:E}))},Se=(B,E)=>{const R=E.replace(/[^0-9]/g,"");G(B,"공급가액",R)};return Y.jsxs("div",{className:"wrap",children:[Y.jsxs("div",{className:"register_box",children:[Y.jsx("h1",{className:"title",children:"자동차 신규 등록"}),Y.jsxs("div",{className:"register-tabs",children:[Y.jsx("button",{className:`tab-button ${t==="single"?"active":""}`,onClick:()=>e("single"),children:"개별 등록"}),Y.jsx("button",{className:`tab-button ${t==="bulk"?"active":""}`,onClick:()=>e("bulk"),children:"일괄 등록"})]}),t==="single"?Y.jsxs("form",{id:"registerForm",onSubmit:ae,children:[Y.jsx("div",{className:"plate-selector",onClick:()=>P(!0),children:Y.jsx("input",{name:"plateId",type:"text",readOnly:!0,placeholder:"차량번호를 선택하세요",value:O?O.number:"",className:"plate-input"})}),Y.jsx(WI,{isOpen:D,onClose:()=>P(!1),plates:nq,onSelect:B=>{A(B),c(E=>({...E,plateId:B.id}))},selectedPlateNumbers:O?[O.number]:[]}),Y.jsxs("select",{name:"businessType",value:u.businessType,onChange:we,required:!0,children:[Y.jsx("option",{value:"",children:"업무구분 선택"}),sq.map(B=>Y.jsx("option",{value:B.code,children:B.name},B.code))]}),Y.jsx("input",{type:"text",name:"price",placeholder:"공급가액",value:u.price?Number(u.price).toLocaleString():"",onChange:K,required:!0}),Y.jsx("input",{type:"text",name:"vinNumber",placeholder:"차대번호",value:u.vinNumber,onChange:we,required:!0}),Y.jsx("input",{type:"text",name:"carName",placeholder:"차명",value:u.carName,onChange:we,required:!0}),Y.jsxs("select",{name:"location",value:u.location||"",onChange:we,required:!0,className:"cell-select",children:[Y.jsx("option",{value:"",children:"사용본거지 선택"}),aq.map(B=>Y.jsx("option",{value:B,children:B},B))]}),Y.jsx("button",{type:"submit",children:"등록"})]}):Y.jsxs("div",{className:"bulk-register",children:[Y.jsxs("div",{className:"button-group-right file-upload-group",children:[Y.jsx("button",{onClick:le,className:"template-download",type:"button",children:"양식 다운로드"}),Y.jsx("input",{type:"file",accept:".xlsx,.xls",onChange:J,required:!0,ref:H,style:{display:r?"none":"block"}}),r&&Y.jsx("span",{className:"file-info",children:r.name}),r&&Y.jsx("button",{type:"button",className:"clear-file-btn",onClick:be,children:"삭제"})]}),Y.jsx("div",{className:"customer-results-table",style:{marginTop:20},children:Y.jsxs("table",{children:[Y.jsx("thead",{children:Y.jsx("tr",{children:Jx.map(B=>Y.jsx("th",{children:B.name},B.key))})}),Y.jsx("tbody",{children:W.length===0?Y.jsx("tr",{children:Y.jsx("td",{colSpan:Jx.length,className:"customer-no-data",children:"업로드된 데이터가 없습니다."})}):W.map((B,E)=>Y.jsx("tr",{children:Jx.map(R=>Y.jsx("td",{children:R.key==="index"?B.index:R.key==="차량번호"?Y.jsx("div",{className:"cell-plate",style:{cursor:"pointer"},onClick:()=>Te(E),children:B.차량번호||Y.jsx("span",{style:{color:"#bbb"},children:"선택"})}):R.key==="업무구분"?Y.jsxs("select",{value:B.업무구분||"",onChange:M=>G(E,"업무구분",M.target.value),className:"cell-select",children:[Y.jsx("option",{value:"",children:"선택"}),sq.map(M=>Y.jsx("option",{value:M.code,children:M.name},M.code))]}):R.key==="사용본거지"?Y.jsxs("select",{value:B.사용본거지||"",onChange:M=>G(E,"사용본거지",M.target.value),className:"cell-select",children:[Y.jsx("option",{value:"",children:"선택"}),aq.map(M=>Y.jsx("option",{value:M,children:M},M))]}):R.key==="공급가액"?Y.jsx("input",{type:"text",value:B.공급가액?Number(B.공급가액).toLocaleString():"",onChange:M=>Se(E,M.target.value),className:"cell-input"}):Y.jsx("input",{type:"text",value:B[R.key]||"",onChange:M=>G(E,R.key,M.target.value),className:"cell-input"})},R.key))},B.index))})]})}),Y.jsxs("div",{className:"button-group-right",children:[Y.jsx("button",{type:"button",className:"bulk-submit-button",onClick:ve,disabled:W.length===0,children:"일괄 등록"}),Y.jsx("button",{type:"button",className:"bulk-clear-button",onClick:be,children:"초기화"})]}),Y.jsx(WI,{isOpen:D!==null,onClose:()=>P(null),plates:nq.filter(B=>!W.some((E,R)=>E.차량번호===B.number&&R!==D)),onSelect:ce,selectedPlateNumbers:W.map(B=>B.차량번호).filter(Boolean)})]})]}),Y.jsx(pK,{isOpen:w,onClose:()=>y(!1),errors:m}),Y.jsxs(mK,{isOpen:a,onClose:()=>{o(!1),g(0)},children:[Y.jsx("h2",{children:"요청 완료"}),Y.jsxs("p",{children:[f,"대의 차량이 성공적으로 등록 요청되었습니다."]})]})]})}function O9e(){const t=Yo(),{user:e,logout:r}=oh(),[n,i]=ie.useState(!1);if(ie.useEffect(()=>{e||i(!0)},[e,t]),!e||!e.username)return Y.jsx(Zg,{open:n});const s=()=>{r(),t("/login")};return Y.jsx("div",{id:"mypage-container",children:Y.jsxs("div",{id:"mypage-content",children:[Y.jsxs("div",{id:"profile-section",children:[Y.jsx("img",{src:Mte,alt:"프로필",id:"profile-image"}),Y.jsxs("div",{id:"user-info",children:[Y.jsxs("div",{id:"user-id",children:["아이디: ",e.username]}),Y.jsxs("div",{id:"user-name",children:["이름: ",e.name]})]})]}),Y.jsx("button",{onClick:s,id:"logout-button",children:"로그아웃"})]})})}function $ne(t){var e,r,n="";if(typeof t=="string"||typeof t=="number")n+=t;else if(typeof t=="object")if(Array.isArray(t)){var i=t.length;for(e=0;e<i;e++)t[e]&&(r=$ne(t[e]))&&(n&&(n+=" "),n+=r)}else for(r in t)t[r]&&(n&&(n+=" "),n+=r);return n}function ss(){for(var t,e,r=0,n="",i=arguments.length;r<i;r++)(t=arguments[r])&&(e=$ne(t))&&(n&&(n+=" "),n+=e);return n}const Une=6048e5,k9e=864e5,FT=6e4,LT=36e5,D9e=1e3,oq=Symbol.for("constructDateFrom");function qr(t,e){return typeof t=="function"?t(e):t&&typeof t=="object"&&oq in t?t[oq](e):t instanceof Date?new t.constructor(e):new Date(e)}function gt(t,e){return qr(e||t,t)}function kl(t,e,r){const n=gt(t,r?.in);return isNaN(e)?qr(r?.in||t,NaN):(e&&n.setDate(n.getDate()+e),n)}function Hl(t,e,r){const n=gt(t,r?.in);if(isNaN(e))return qr(t,NaN);if(!e)return n;const i=n.getDate(),s=qr(t,n.getTime());s.setMonth(n.getMonth()+e+1,0);const a=s.getDate();return i>=a?s:(n.setFullYear(s.getFullYear(),s.getMonth(),i),n)}function jne(t,e,r){return qr(t,+gt(t)+e)}function P9e(t,e,r){return jne(t,e*LT)}let I9e={};function vm(){return I9e}function sh(t,e){const r=vm(),n=e?.weekStartsOn??e?.locale?.options?.weekStartsOn??r.weekStartsOn??r.locale?.options?.weekStartsOn??0,i=gt(t,e?.in),s=i.getDay(),a=(s<n?7:0)+s-n;return i.setDate(i.getDate()-a),i.setHours(0,0,0,0),i}function Wp(t,e){return sh(t,{...e,weekStartsOn:1})}function Yne(t,e){const r=gt(t,e?.in),n=r.getFullYear(),i=qr(r,0);i.setFullYear(n+1,0,4),i.setHours(0,0,0,0);const s=Wp(i),a=qr(r,0);a.setFullYear(n,0,4),a.setHours(0,0,0,0);const o=Wp(a);return r.getTime()>=s.getTime()?n+1:r.getTime()>=o.getTime()?n:n-1}function nR(t){const e=gt(t),r=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return r.setUTCFullYear(e.getFullYear()),+t-+r}function ph(t,...e){const r=qr.bind(null,e.find(n=>typeof n=="object"));return e.map(r)}function qg(t,e){const r=gt(t,e?.in);return r.setHours(0,0,0,0),r}function $p(t,e,r){const[n,i]=ph(r?.in,t,e),s=qg(n),a=qg(i),o=+s-nR(s),u=+a-nR(a);return Math.round((o-u)/k9e)}function N9e(t,e){const r=Yne(t,e),n=qr(t,0);return n.setFullYear(r,0,4),n.setHours(0,0,0,0),Wp(n)}function hH(t,e,r){const n=gt(t,r?.in);return n.setTime(n.getTime()+e*FT),n}function kB(t,e,r){return Hl(t,e*3,r)}function H9e(t,e,r){return jne(t,e*1e3)}function iR(t,e,r){return kl(t,e*7,r)}function Kc(t,e,r){return Hl(t,e*12,r)}function lq(t,e){let r,n=e?.in;return t.forEach(i=>{!n&&typeof i=="object"&&(n=qr.bind(null,i));const s=gt(i,n);(!r||r<s||isNaN(+s))&&(r=s)}),qr(n,r||NaN)}function uq(t,e){let r,n=e?.in;return t.forEach(i=>{!n&&typeof i=="object"&&(n=qr.bind(null,i));const s=gt(i,n);(!r||r>s||isNaN(+s))&&(r=s)}),qr(n,r||NaN)}function F9e(t,e,r){const[n,i]=ph(r?.in,t,e);return+qg(n)==+qg(i)}function Xc(t){return t instanceof Date||typeof t=="object"&&Object.prototype.toString.call(t)==="[object Date]"}function sR(t){return!(!Xc(t)&&typeof t!="number"||isNaN(+gt(t)))}function aR(t,e,r){const[n,i]=ph(r?.in,t,e),s=n.getFullYear()-i.getFullYear(),a=n.getMonth()-i.getMonth();return s*12+a}function Og(t,e){const r=gt(t,e?.in);return Math.trunc(r.getMonth()/3)+1}function oR(t,e,r){const[n,i]=ph(r?.in,t,e),s=n.getFullYear()-i.getFullYear(),a=Og(n)-Og(i);return s*4+a}function lR(t,e,r){const[n,i]=ph(r?.in,t,e);return n.getFullYear()-i.getFullYear()}function L9e(t,e,r){const[n,i]=ph(r?.in,t,e),s=cq(n,i),a=Math.abs($p(n,i));n.setDate(n.getDate()-s*a);const o=+(cq(n,i)===-s),u=s*(a-o);return u===0?0:u}function cq(t,e){const r=t.getFullYear()-e.getFullYear()||t.getMonth()-e.getMonth()||t.getDate()-e.getDate()||t.getHours()-e.getHours()||t.getMinutes()-e.getMinutes()||t.getSeconds()-e.getSeconds()||t.getMilliseconds()-e.getMilliseconds();return r<0?-1:r>0?1:r}function zne(t,e){const r=gt(t,e?.in);return r.setHours(23,59,59,999),r}function Gne(t,e){const r=gt(t,e?.in),n=r.getMonth();return r.setFullYear(r.getFullYear(),n+1,0),r.setHours(23,59,59,999),r}function fH(t,e){const r=gt(t,e?.in),n=r.getMonth(),i=n-n%3;return r.setMonth(i,1),r.setHours(0,0,0,0),r}function qne(t,e){const r=gt(t,e?.in);return r.setDate(1),r.setHours(0,0,0,0),r}function Kne(t,e){const r=gt(t,e?.in),n=r.getFullYear();return r.setFullYear(n+1,0,0),r.setHours(23,59,59,999),r}function BT(t,e){const r=gt(t,e?.in);return r.setFullYear(r.getFullYear(),0,1),r.setHours(0,0,0,0),r}function B9e(t,e){const r=vm(),n=r.weekStartsOn??r.locale?.options?.weekStartsOn??0,i=gt(t,e?.in),s=i.getDay(),a=(s<n?-7:0)+6-(s-n);return i.setDate(i.getDate()+a),i.setHours(23,59,59,999),i}const V9e={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},W9e=(t,e,r)=>{let n;const i=V9e[t];return typeof i=="string"?n=i:e===1?n=i.one:n=i.other.replace("{{count}}",e.toString()),r?.addSuffix?r.comparison&&r.comparison>0?"in "+n:n+" ago":n};function Cp(t){return(e={})=>{const r=e.width?String(e.width):t.defaultWidth;return t.formats[r]||t.formats[t.defaultWidth]}}const $9e={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},U9e={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},j9e={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},Y9e={date:Cp({formats:$9e,defaultWidth:"full"}),time:Cp({formats:U9e,defaultWidth:"full"}),dateTime:Cp({formats:j9e,defaultWidth:"full"})},z9e={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},G9e=(t,e,r,n)=>z9e[t];function Tu(t){return(e,r)=>{const n=r?.context?String(r.context):"standalone";let i;if(n==="formatting"&&t.formattingValues){const a=t.defaultFormattingWidth||t.defaultWidth,o=r?.width?String(r.width):a;i=t.formattingValues[o]||t.formattingValues[a]}else{const a=t.defaultWidth,o=r?.width?String(r.width):t.defaultWidth;i=t.values[o]||t.values[a]}const s=t.argumentCallback?t.argumentCallback(e):e;return i[s]}}const q9e={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},K9e={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},X9e={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},Q9e={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},Z9e={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},J9e={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},e7e=(t,e)=>{const r=Number(t),n=r%100;if(n>20||n<10)switch(n%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},t7e={ordinalNumber:e7e,era:Tu({values:q9e,defaultWidth:"wide"}),quarter:Tu({values:K9e,defaultWidth:"wide",argumentCallback:t=>t-1}),month:Tu({values:X9e,defaultWidth:"wide"}),day:Tu({values:Q9e,defaultWidth:"wide"}),dayPeriod:Tu({values:Z9e,defaultWidth:"wide",formattingValues:J9e,defaultFormattingWidth:"wide"})};function Mu(t){return(e,r={})=>{const n=r.width,i=n&&t.matchPatterns[n]||t.matchPatterns[t.defaultMatchWidth],s=e.match(i);if(!s)return null;const a=s[0],o=n&&t.parsePatterns[n]||t.parsePatterns[t.defaultParseWidth],u=Array.isArray(o)?n7e(o,g=>g.test(a)):r7e(o,g=>g.test(a));let c;c=t.valueCallback?t.valueCallback(u):u,c=r.valueCallback?r.valueCallback(c):c;const f=e.slice(a.length);return{value:c,rest:f}}}function r7e(t,e){for(const r in t)if(Object.prototype.hasOwnProperty.call(t,r)&&e(t[r]))return r}function n7e(t,e){for(let r=0;r<t.length;r++)if(e(t[r]))return r}function Xne(t){return(e,r={})=>{const n=e.match(t.matchPattern);if(!n)return null;const i=n[0],s=e.match(t.parsePattern);if(!s)return null;let a=t.valueCallback?t.valueCallback(s[0]):s[0];a=r.valueCallback?r.valueCallback(a):a;const o=e.slice(i.length);return{value:a,rest:o}}}const i7e=/^(\d+)(th|st|nd|rd)?/i,s7e=/\d+/i,a7e={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},o7e={any:[/^b/i,/^(a|c)/i]},l7e={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},u7e={any:[/1/i,/2/i,/3/i,/4/i]},c7e={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},h7e={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},f7e={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},d7e={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},g7e={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},m7e={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},p7e={ordinalNumber:Xne({matchPattern:i7e,parsePattern:s7e,valueCallback:t=>parseInt(t,10)}),era:Mu({matchPatterns:a7e,defaultMatchWidth:"wide",parsePatterns:o7e,defaultParseWidth:"any"}),quarter:Mu({matchPatterns:l7e,defaultMatchWidth:"wide",parsePatterns:u7e,defaultParseWidth:"any",valueCallback:t=>t+1}),month:Mu({matchPatterns:c7e,defaultMatchWidth:"wide",parsePatterns:h7e,defaultParseWidth:"any"}),day:Mu({matchPatterns:f7e,defaultMatchWidth:"wide",parsePatterns:d7e,defaultParseWidth:"any"}),dayPeriod:Mu({matchPatterns:g7e,defaultMatchWidth:"any",parsePatterns:m7e,defaultParseWidth:"any"})},Qne={code:"en-US",formatDistance:W9e,formatLong:Y9e,formatRelative:G9e,localize:t7e,match:p7e,options:{weekStartsOn:0,firstWeekContainsDate:1}};function v7e(t,e){const r=gt(t,e?.in);return $p(r,BT(r))+1}function DB(t,e){const r=gt(t,e?.in),n=+Wp(r)-+N9e(r);return Math.round(n/Une)+1}function PB(t,e){const r=gt(t,e?.in),n=r.getFullYear(),i=vm(),s=e?.firstWeekContainsDate??e?.locale?.options?.firstWeekContainsDate??i.firstWeekContainsDate??i.locale?.options?.firstWeekContainsDate??1,a=qr(e?.in||t,0);a.setFullYear(n+1,0,s),a.setHours(0,0,0,0);const o=sh(a,e),u=qr(e?.in||t,0);u.setFullYear(n,0,s),u.setHours(0,0,0,0);const c=sh(u,e);return+r>=+o?n+1:+r>=+c?n:n-1}function w7e(t,e){const r=vm(),n=e?.firstWeekContainsDate??e?.locale?.options?.firstWeekContainsDate??r.firstWeekContainsDate??r.locale?.options?.firstWeekContainsDate??1,i=PB(t,e),s=qr(e?.in||t,0);return s.setFullYear(i,0,n),s.setHours(0,0,0,0),sh(s,e)}function Zne(t,e){const r=gt(t,e?.in),n=+sh(r,e)-+w7e(r,e);return Math.round(n/Une)+1}function Yr(t,e){const r=t<0?"-":"",n=Math.abs(t).toString().padStart(e,"0");return r+n}const sf={y(t,e){const r=t.getFullYear(),n=r>0?r:1-r;return Yr(e==="yy"?n%100:n,e.length)},M(t,e){const r=t.getMonth();return e==="M"?String(r+1):Yr(r+1,2)},d(t,e){return Yr(t.getDate(),e.length)},a(t,e){const r=t.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return r.toUpperCase();case"aaa":return r;case"aaaaa":return r[0];case"aaaa":default:return r==="am"?"a.m.":"p.m."}},h(t,e){return Yr(t.getHours()%12||12,e.length)},H(t,e){return Yr(t.getHours(),e.length)},m(t,e){return Yr(t.getMinutes(),e.length)},s(t,e){return Yr(t.getSeconds(),e.length)},S(t,e){const r=e.length,n=t.getMilliseconds(),i=Math.trunc(n*Math.pow(10,r-3));return Yr(i,e.length)}},$0={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},hq={G:function(t,e,r){const n=t.getFullYear()>0?1:0;switch(e){case"G":case"GG":case"GGG":return r.era(n,{width:"abbreviated"});case"GGGGG":return r.era(n,{width:"narrow"});case"GGGG":default:return r.era(n,{width:"wide"})}},y:function(t,e,r){if(e==="yo"){const n=t.getFullYear(),i=n>0?n:1-n;return r.ordinalNumber(i,{unit:"year"})}return sf.y(t,e)},Y:function(t,e,r,n){const i=PB(t,n),s=i>0?i:1-i;if(e==="YY"){const a=s%100;return Yr(a,2)}return e==="Yo"?r.ordinalNumber(s,{unit:"year"}):Yr(s,e.length)},R:function(t,e){const r=Yne(t);return Yr(r,e.length)},u:function(t,e){const r=t.getFullYear();return Yr(r,e.length)},Q:function(t,e,r){const n=Math.ceil((t.getMonth()+1)/3);switch(e){case"Q":return String(n);case"QQ":return Yr(n,2);case"Qo":return r.ordinalNumber(n,{unit:"quarter"});case"QQQ":return r.quarter(n,{width:"abbreviated",context:"formatting"});case"QQQQQ":return r.quarter(n,{width:"narrow",context:"formatting"});case"QQQQ":default:return r.quarter(n,{width:"wide",context:"formatting"})}},q:function(t,e,r){const n=Math.ceil((t.getMonth()+1)/3);switch(e){case"q":return String(n);case"qq":return Yr(n,2);case"qo":return r.ordinalNumber(n,{unit:"quarter"});case"qqq":return r.quarter(n,{width:"abbreviated",context:"standalone"});case"qqqqq":return r.quarter(n,{width:"narrow",context:"standalone"});case"qqqq":default:return r.quarter(n,{width:"wide",context:"standalone"})}},M:function(t,e,r){const n=t.getMonth();switch(e){case"M":case"MM":return sf.M(t,e);case"Mo":return r.ordinalNumber(n+1,{unit:"month"});case"MMM":return r.month(n,{width:"abbreviated",context:"formatting"});case"MMMMM":return r.month(n,{width:"narrow",context:"formatting"});case"MMMM":default:return r.month(n,{width:"wide",context:"formatting"})}},L:function(t,e,r){const n=t.getMonth();switch(e){case"L":return String(n+1);case"LL":return Yr(n+1,2);case"Lo":return r.ordinalNumber(n+1,{unit:"month"});case"LLL":return r.month(n,{width:"abbreviated",context:"standalone"});case"LLLLL":return r.month(n,{width:"narrow",context:"standalone"});case"LLLL":default:return r.month(n,{width:"wide",context:"standalone"})}},w:function(t,e,r,n){const i=Zne(t,n);return e==="wo"?r.ordinalNumber(i,{unit:"week"}):Yr(i,e.length)},I:function(t,e,r){const n=DB(t);return e==="Io"?r.ordinalNumber(n,{unit:"week"}):Yr(n,e.length)},d:function(t,e,r){return e==="do"?r.ordinalNumber(t.getDate(),{unit:"date"}):sf.d(t,e)},D:function(t,e,r){const n=v7e(t);return e==="Do"?r.ordinalNumber(n,{unit:"dayOfYear"}):Yr(n,e.length)},E:function(t,e,r){const n=t.getDay();switch(e){case"E":case"EE":case"EEE":return r.day(n,{width:"abbreviated",context:"formatting"});case"EEEEE":return r.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(n,{width:"short",context:"formatting"});case"EEEE":default:return r.day(n,{width:"wide",context:"formatting"})}},e:function(t,e,r,n){const i=t.getDay(),s=(i-n.weekStartsOn+8)%7||7;switch(e){case"e":return String(s);case"ee":return Yr(s,2);case"eo":return r.ordinalNumber(s,{unit:"day"});case"eee":return r.day(i,{width:"abbreviated",context:"formatting"});case"eeeee":return r.day(i,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(i,{width:"short",context:"formatting"});case"eeee":default:return r.day(i,{width:"wide",context:"formatting"})}},c:function(t,e,r,n){const i=t.getDay(),s=(i-n.weekStartsOn+8)%7||7;switch(e){case"c":return String(s);case"cc":return Yr(s,e.length);case"co":return r.ordinalNumber(s,{unit:"day"});case"ccc":return r.day(i,{width:"abbreviated",context:"standalone"});case"ccccc":return r.day(i,{width:"narrow",context:"standalone"});case"cccccc":return r.day(i,{width:"short",context:"standalone"});case"cccc":default:return r.day(i,{width:"wide",context:"standalone"})}},i:function(t,e,r){const n=t.getDay(),i=n===0?7:n;switch(e){case"i":return String(i);case"ii":return Yr(i,e.length);case"io":return r.ordinalNumber(i,{unit:"day"});case"iii":return r.day(n,{width:"abbreviated",context:"formatting"});case"iiiii":return r.day(n,{width:"narrow",context:"formatting"});case"iiiiii":return r.day(n,{width:"short",context:"formatting"});case"iiii":default:return r.day(n,{width:"wide",context:"formatting"})}},a:function(t,e,r){const i=t.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return r.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"aaa":return r.dayPeriod(i,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return r.dayPeriod(i,{width:"narrow",context:"formatting"});case"aaaa":default:return r.dayPeriod(i,{width:"wide",context:"formatting"})}},b:function(t,e,r){const n=t.getHours();let i;switch(n===12?i=$0.noon:n===0?i=$0.midnight:i=n/12>=1?"pm":"am",e){case"b":case"bb":return r.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"bbb":return r.dayPeriod(i,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return r.dayPeriod(i,{width:"narrow",context:"formatting"});case"bbbb":default:return r.dayPeriod(i,{width:"wide",context:"formatting"})}},B:function(t,e,r){const n=t.getHours();let i;switch(n>=17?i=$0.evening:n>=12?i=$0.afternoon:n>=4?i=$0.morning:i=$0.night,e){case"B":case"BB":case"BBB":return r.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"BBBBB":return r.dayPeriod(i,{width:"narrow",context:"formatting"});case"BBBB":default:return r.dayPeriod(i,{width:"wide",context:"formatting"})}},h:function(t,e,r){if(e==="ho"){let n=t.getHours()%12;return n===0&&(n=12),r.ordinalNumber(n,{unit:"hour"})}return sf.h(t,e)},H:function(t,e,r){return e==="Ho"?r.ordinalNumber(t.getHours(),{unit:"hour"}):sf.H(t,e)},K:function(t,e,r){const n=t.getHours()%12;return e==="Ko"?r.ordinalNumber(n,{unit:"hour"}):Yr(n,e.length)},k:function(t,e,r){let n=t.getHours();return n===0&&(n=24),e==="ko"?r.ordinalNumber(n,{unit:"hour"}):Yr(n,e.length)},m:function(t,e,r){return e==="mo"?r.ordinalNumber(t.getMinutes(),{unit:"minute"}):sf.m(t,e)},s:function(t,e,r){return e==="so"?r.ordinalNumber(t.getSeconds(),{unit:"second"}):sf.s(t,e)},S:function(t,e){return sf.S(t,e)},X:function(t,e,r){const n=t.getTimezoneOffset();if(n===0)return"Z";switch(e){case"X":return dq(n);case"XXXX":case"XX":return cg(n);case"XXXXX":case"XXX":default:return cg(n,":")}},x:function(t,e,r){const n=t.getTimezoneOffset();switch(e){case"x":return dq(n);case"xxxx":case"xx":return cg(n);case"xxxxx":case"xxx":default:return cg(n,":")}},O:function(t,e,r){const n=t.getTimezoneOffset();switch(e){case"O":case"OO":case"OOO":return"GMT"+fq(n,":");case"OOOO":default:return"GMT"+cg(n,":")}},z:function(t,e,r){const n=t.getTimezoneOffset();switch(e){case"z":case"zz":case"zzz":return"GMT"+fq(n,":");case"zzzz":default:return"GMT"+cg(n,":")}},t:function(t,e,r){const n=Math.trunc(+t/1e3);return Yr(n,e.length)},T:function(t,e,r){return Yr(+t,e.length)}};function fq(t,e=""){const r=t>0?"-":"+",n=Math.abs(t),i=Math.trunc(n/60),s=n%60;return s===0?r+String(i):r+String(i)+e+Yr(s,2)}function dq(t,e){return t%60===0?(t>0?"-":"+")+Yr(Math.abs(t)/60,2):cg(t,e)}function cg(t,e=""){const r=t>0?"-":"+",n=Math.abs(t),i=Yr(Math.trunc(n/60),2),s=Yr(n%60,2);return r+i+e+s}const gq=(t,e)=>{switch(t){case"P":return e.date({width:"short"});case"PP":return e.date({width:"medium"});case"PPP":return e.date({width:"long"});case"PPPP":default:return e.date({width:"full"})}},Jne=(t,e)=>{switch(t){case"p":return e.time({width:"short"});case"pp":return e.time({width:"medium"});case"ppp":return e.time({width:"long"});case"pppp":default:return e.time({width:"full"})}},y7e=(t,e)=>{const r=t.match(/(P+)(p+)?/)||[],n=r[1],i=r[2];if(!i)return gq(t,e);let s;switch(n){case"P":s=e.dateTime({width:"short"});break;case"PP":s=e.dateTime({width:"medium"});break;case"PPP":s=e.dateTime({width:"long"});break;case"PPPP":default:s=e.dateTime({width:"full"});break}return s.replace("{{date}}",gq(n,e)).replace("{{time}}",Jne(i,e))},dH={p:Jne,P:y7e},S7e=/^D+$/,b7e=/^Y+$/,C7e=["D","DD","YY","YYYY"];function x7e(t){return S7e.test(t)}function E7e(t){return b7e.test(t)}function _7e(t,e,r){const n=R7e(t,e,r);if(console.warn(n),C7e.includes(t))throw new RangeError(n)}function R7e(t,e,r){const n=t[0]==="Y"?"years":"days of the month";return`Use \`${t.toLowerCase()}\` instead of \`${t}\` (in \`${e}\`) for formatting ${n} to the input \`${r}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const T7e=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,M7e=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,A7e=/^'([^]*?)'?$/,O7e=/''/g,k7e=/[a-zA-Z]/;function mq(t,e,r){const n=vm(),i=r?.locale??n.locale??Qne,s=r?.firstWeekContainsDate??r?.locale?.options?.firstWeekContainsDate??n.firstWeekContainsDate??n.locale?.options?.firstWeekContainsDate??1,a=r?.weekStartsOn??r?.locale?.options?.weekStartsOn??n.weekStartsOn??n.locale?.options?.weekStartsOn??0,o=gt(t,r?.in);if(!sR(o))throw new RangeError("Invalid time value");let u=e.match(M7e).map(f=>{const g=f[0];if(g==="p"||g==="P"){const m=dH[g];return m(f,i.formatLong)}return f}).join("").match(T7e).map(f=>{if(f==="''")return{isToken:!1,value:"'"};const g=f[0];if(g==="'")return{isToken:!1,value:D7e(f)};if(hq[g])return{isToken:!0,value:f};if(g.match(k7e))throw new RangeError("Format string contains an unescaped latin alphabet character `"+g+"`");return{isToken:!1,value:f}});i.localize.preprocessor&&(u=i.localize.preprocessor(o,u));const c={firstWeekContainsDate:s,weekStartsOn:a,locale:i};return u.map(f=>{if(!f.isToken)return f.value;const g=f.value;(!r?.useAdditionalWeekYearTokens&&E7e(g)||!r?.useAdditionalDayOfYearTokens&&x7e(g))&&_7e(g,e,String(t));const m=hq[g[0]];return m(o,g,i.localize,c)}).join("")}function D7e(t){const e=t.match(A7e);return e?e[1].replace(O7e,"'"):t}function pq(t,e){return gt(t,e?.in).getDate()}function P7e(t,e){return gt(t,e?.in).getDay()}function I7e(t,e){const r=gt(t,e?.in),n=r.getFullYear(),i=r.getMonth(),s=qr(r,0);return s.setFullYear(n,i+1,0),s.setHours(0,0,0,0),s.getDate()}function N7e(){return Object.assign({},vm())}function Qc(t,e){return gt(t,e?.in).getHours()}function H7e(t,e){const r=gt(t,e?.in).getDay();return r===0?7:r}function Zc(t,e){return gt(t,e?.in).getMinutes()}function Es(t,e){return gt(t,e?.in).getMonth()}function Nf(t){return gt(t).getSeconds()}function gH(t){return+gt(t)}function qt(t,e){return gt(t,e?.in).getFullYear()}function Gf(t,e){return+gt(t)>+gt(e)}function Kg(t,e){return+gt(t)<+gt(e)}function F7e(t,e){return+gt(t)==+gt(e)}function L7e(t,e){const r=B7e(e)?new e(0):qr(e,0);return r.setFullYear(t.getFullYear(),t.getMonth(),t.getDate()),r.setHours(t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()),r}function B7e(t){return typeof t=="function"&&t.prototype?.constructor===t}const V7e=10;class eie{subPriority=0;validate(e,r){return!0}}class W7e extends eie{constructor(e,r,n,i,s){super(),this.value=e,this.validateValue=r,this.setValue=n,this.priority=i,s&&(this.subPriority=s)}validate(e,r){return this.validateValue(e,this.value,r)}set(e,r,n){return this.setValue(e,r,this.value,n)}}class $7e extends eie{priority=V7e;subPriority=-1;constructor(e,r){super(),this.context=e||(n=>qr(r,n))}set(e,r){return r.timestampIsSet?e:qr(e,L7e(e,this.context))}}class Pr{run(e,r,n,i){const s=this.parse(e,r,n,i);return s?{setter:new W7e(s.value,this.validate,this.set,this.priority,this.subPriority),rest:s.rest}:null}validate(e,r,n){return!0}}class U7e extends Pr{priority=140;parse(e,r,n){switch(r){case"G":case"GG":case"GGG":return n.era(e,{width:"abbreviated"})||n.era(e,{width:"narrow"});case"GGGGG":return n.era(e,{width:"narrow"});case"GGGG":default:return n.era(e,{width:"wide"})||n.era(e,{width:"abbreviated"})||n.era(e,{width:"narrow"})}}set(e,r,n){return r.era=n,e.setFullYear(n,0,1),e.setHours(0,0,0,0),e}incompatibleTokens=["R","u","t","T"]}const ii={month:/^(1[0-2]|0?\d)/,date:/^(3[0-1]|[0-2]?\d)/,dayOfYear:/^(36[0-6]|3[0-5]\d|[0-2]?\d?\d)/,week:/^(5[0-3]|[0-4]?\d)/,hour23h:/^(2[0-3]|[0-1]?\d)/,hour24h:/^(2[0-4]|[0-1]?\d)/,hour11h:/^(1[0-1]|0?\d)/,hour12h:/^(1[0-2]|0?\d)/,minute:/^[0-5]?\d/,second:/^[0-5]?\d/,singleDigit:/^\d/,twoDigits:/^\d{1,2}/,threeDigits:/^\d{1,3}/,fourDigits:/^\d{1,4}/,anyDigitsSigned:/^-?\d+/,singleDigitSigned:/^-?\d/,twoDigitsSigned:/^-?\d{1,2}/,threeDigitsSigned:/^-?\d{1,3}/,fourDigitsSigned:/^-?\d{1,4}/},Au={basicOptionalMinutes:/^([+-])(\d{2})(\d{2})?|Z/,basic:/^([+-])(\d{2})(\d{2})|Z/,basicOptionalSeconds:/^([+-])(\d{2})(\d{2})((\d{2}))?|Z/,extended:/^([+-])(\d{2}):(\d{2})|Z/,extendedOptionalSeconds:/^([+-])(\d{2}):(\d{2})(:(\d{2}))?|Z/};function si(t,e){return t&&{value:e(t.value),rest:t.rest}}function kn(t,e){const r=e.match(t);return r?{value:parseInt(r[0],10),rest:e.slice(r[0].length)}:null}function Ou(t,e){const r=e.match(t);if(!r)return null;if(r[0]==="Z")return{value:0,rest:e.slice(1)};const n=r[1]==="+"?1:-1,i=r[2]?parseInt(r[2],10):0,s=r[3]?parseInt(r[3],10):0,a=r[5]?parseInt(r[5],10):0;return{value:n*(i*LT+s*FT+a*D9e),rest:e.slice(r[0].length)}}function tie(t){return kn(ii.anyDigitsSigned,t)}function qn(t,e){switch(t){case 1:return kn(ii.singleDigit,e);case 2:return kn(ii.twoDigits,e);case 3:return kn(ii.threeDigits,e);case 4:return kn(ii.fourDigits,e);default:return kn(new RegExp("^\\d{1,"+t+"}"),e)}}function uR(t,e){switch(t){case 1:return kn(ii.singleDigitSigned,e);case 2:return kn(ii.twoDigitsSigned,e);case 3:return kn(ii.threeDigitsSigned,e);case 4:return kn(ii.fourDigitsSigned,e);default:return kn(new RegExp("^-?\\d{1,"+t+"}"),e)}}function IB(t){switch(t){case"morning":return 4;case"evening":return 17;case"pm":case"noon":case"afternoon":return 12;case"am":case"midnight":case"night":default:return 0}}function rie(t,e){const r=e>0,n=r?e:1-e;let i;if(n<=50)i=t||100;else{const s=n+50,a=Math.trunc(s/100)*100,o=t>=s%100;i=t+a-(o?100:0)}return r?i:1-i}function nie(t){return t%400===0||t%4===0&&t%100!==0}class j7e extends Pr{priority=130;incompatibleTokens=["Y","R","u","w","I","i","e","c","t","T"];parse(e,r,n){const i=s=>({year:s,isTwoDigitYear:r==="yy"});switch(r){case"y":return si(qn(4,e),i);case"yo":return si(n.ordinalNumber(e,{unit:"year"}),i);default:return si(qn(r.length,e),i)}}validate(e,r){return r.isTwoDigitYear||r.year>0}set(e,r,n){const i=e.getFullYear();if(n.isTwoDigitYear){const a=rie(n.year,i);return e.setFullYear(a,0,1),e.setHours(0,0,0,0),e}const s=!("era"in r)||r.era===1?n.year:1-n.year;return e.setFullYear(s,0,1),e.setHours(0,0,0,0),e}}class Y7e extends Pr{priority=130;parse(e,r,n){const i=s=>({year:s,isTwoDigitYear:r==="YY"});switch(r){case"Y":return si(qn(4,e),i);case"Yo":return si(n.ordinalNumber(e,{unit:"year"}),i);default:return si(qn(r.length,e),i)}}validate(e,r){return r.isTwoDigitYear||r.year>0}set(e,r,n,i){const s=PB(e,i);if(n.isTwoDigitYear){const o=rie(n.year,s);return e.setFullYear(o,0,i.firstWeekContainsDate),e.setHours(0,0,0,0),sh(e,i)}const a=!("era"in r)||r.era===1?n.year:1-n.year;return e.setFullYear(a,0,i.firstWeekContainsDate),e.setHours(0,0,0,0),sh(e,i)}incompatibleTokens=["y","R","u","Q","q","M","L","I","d","D","i","t","T"]}class z7e extends Pr{priority=130;parse(e,r){return uR(r==="R"?4:r.length,e)}set(e,r,n){const i=qr(e,0);return i.setFullYear(n,0,4),i.setHours(0,0,0,0),Wp(i)}incompatibleTokens=["G","y","Y","u","Q","q","M","L","w","d","D","e","c","t","T"]}class G7e extends Pr{priority=130;parse(e,r){return uR(r==="u"?4:r.length,e)}set(e,r,n){return e.setFullYear(n,0,1),e.setHours(0,0,0,0),e}incompatibleTokens=["G","y","Y","R","w","I","i","e","c","t","T"]}class q7e extends Pr{priority=120;parse(e,r,n){switch(r){case"Q":case"QQ":return qn(r.length,e);case"Qo":return n.ordinalNumber(e,{unit:"quarter"});case"QQQ":return n.quarter(e,{width:"abbreviated",context:"formatting"})||n.quarter(e,{width:"narrow",context:"formatting"});case"QQQQQ":return n.quarter(e,{width:"narrow",context:"formatting"});case"QQQQ":default:return n.quarter(e,{width:"wide",context:"formatting"})||n.quarter(e,{width:"abbreviated",context:"formatting"})||n.quarter(e,{width:"narrow",context:"formatting"})}}validate(e,r){return r>=1&&r<=4}set(e,r,n){return e.setMonth((n-1)*3,1),e.setHours(0,0,0,0),e}incompatibleTokens=["Y","R","q","M","L","w","I","d","D","i","e","c","t","T"]}class K7e extends Pr{priority=120;parse(e,r,n){switch(r){case"q":case"qq":return qn(r.length,e);case"qo":return n.ordinalNumber(e,{unit:"quarter"});case"qqq":return n.quarter(e,{width:"abbreviated",context:"standalone"})||n.quarter(e,{width:"narrow",context:"standalone"});case"qqqqq":return n.quarter(e,{width:"narrow",context:"standalone"});case"qqqq":default:return n.quarter(e,{width:"wide",context:"standalone"})||n.quarter(e,{width:"abbreviated",context:"standalone"})||n.quarter(e,{width:"narrow",context:"standalone"})}}validate(e,r){return r>=1&&r<=4}set(e,r,n){return e.setMonth((n-1)*3,1),e.setHours(0,0,0,0),e}incompatibleTokens=["Y","R","Q","M","L","w","I","d","D","i","e","c","t","T"]}class X7e extends Pr{incompatibleTokens=["Y","R","q","Q","L","w","I","D","i","e","c","t","T"];priority=110;parse(e,r,n){const i=s=>s-1;switch(r){case"M":return si(kn(ii.month,e),i);case"MM":return si(qn(2,e),i);case"Mo":return si(n.ordinalNumber(e,{unit:"month"}),i);case"MMM":return n.month(e,{width:"abbreviated",context:"formatting"})||n.month(e,{width:"narrow",context:"formatting"});case"MMMMM":return n.month(e,{width:"narrow",context:"formatting"});case"MMMM":default:return n.month(e,{width:"wide",context:"formatting"})||n.month(e,{width:"abbreviated",context:"formatting"})||n.month(e,{width:"narrow",context:"formatting"})}}validate(e,r){return r>=0&&r<=11}set(e,r,n){return e.setMonth(n,1),e.setHours(0,0,0,0),e}}class Q7e extends Pr{priority=110;parse(e,r,n){const i=s=>s-1;switch(r){case"L":return si(kn(ii.month,e),i);case"LL":return si(qn(2,e),i);case"Lo":return si(n.ordinalNumber(e,{unit:"month"}),i);case"LLL":return n.month(e,{width:"abbreviated",context:"standalone"})||n.month(e,{width:"narrow",context:"standalone"});case"LLLLL":return n.month(e,{width:"narrow",context:"standalone"});case"LLLL":default:return n.month(e,{width:"wide",context:"standalone"})||n.month(e,{width:"abbreviated",context:"standalone"})||n.month(e,{width:"narrow",context:"standalone"})}}validate(e,r){return r>=0&&r<=11}set(e,r,n){return e.setMonth(n,1),e.setHours(0,0,0,0),e}incompatibleTokens=["Y","R","q","Q","M","w","I","D","i","e","c","t","T"]}function Z7e(t,e,r){const n=gt(t,r?.in),i=Zne(n,r)-e;return n.setDate(n.getDate()-i*7),gt(n,r?.in)}class J7e extends Pr{priority=100;parse(e,r,n){switch(r){case"w":return kn(ii.week,e);case"wo":return n.ordinalNumber(e,{unit:"week"});default:return qn(r.length,e)}}validate(e,r){return r>=1&&r<=53}set(e,r,n,i){return sh(Z7e(e,n,i),i)}incompatibleTokens=["y","R","u","q","Q","M","L","I","d","D","i","t","T"]}function eYe(t,e,r){const n=gt(t,r?.in),i=DB(n,r)-e;return n.setDate(n.getDate()-i*7),n}class tYe extends Pr{priority=100;parse(e,r,n){switch(r){case"I":return kn(ii.week,e);case"Io":return n.ordinalNumber(e,{unit:"week"});default:return qn(r.length,e)}}validate(e,r){return r>=1&&r<=53}set(e,r,n){return Wp(eYe(e,n))}incompatibleTokens=["y","Y","u","q","Q","M","L","w","d","D","e","c","t","T"]}const rYe=[31,28,31,30,31,30,31,31,30,31,30,31],nYe=[31,29,31,30,31,30,31,31,30,31,30,31];class iYe extends Pr{priority=90;subPriority=1;parse(e,r,n){switch(r){case"d":return kn(ii.date,e);case"do":return n.ordinalNumber(e,{unit:"date"});default:return qn(r.length,e)}}validate(e,r){const n=e.getFullYear(),i=nie(n),s=e.getMonth();return i?r>=1&&r<=nYe[s]:r>=1&&r<=rYe[s]}set(e,r,n){return e.setDate(n),e.setHours(0,0,0,0),e}incompatibleTokens=["Y","R","q","Q","w","I","D","i","e","c","t","T"]}class sYe extends Pr{priority=90;subpriority=1;parse(e,r,n){switch(r){case"D":case"DD":return kn(ii.dayOfYear,e);case"Do":return n.ordinalNumber(e,{unit:"date"});default:return qn(r.length,e)}}validate(e,r){const n=e.getFullYear();return nie(n)?r>=1&&r<=366:r>=1&&r<=365}set(e,r,n){return e.setMonth(0,n),e.setHours(0,0,0,0),e}incompatibleTokens=["Y","R","q","Q","M","L","w","I","d","E","i","e","c","t","T"]}function NB(t,e,r){const n=vm(),i=r?.weekStartsOn??r?.locale?.options?.weekStartsOn??n.weekStartsOn??n.locale?.options?.weekStartsOn??0,s=gt(t,r?.in),a=s.getDay(),u=(e%7+7)%7,c=7-i,f=e<0||e>6?e-(a+c)%7:(u+c)%7-(a+c)%7;return kl(s,f,r)}class aYe extends Pr{priority=90;parse(e,r,n){switch(r){case"E":case"EE":case"EEE":return n.day(e,{width:"abbreviated",context:"formatting"})||n.day(e,{width:"short",context:"formatting"})||n.day(e,{width:"narrow",context:"formatting"});case"EEEEE":return n.day(e,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(e,{width:"short",context:"formatting"})||n.day(e,{width:"narrow",context:"formatting"});case"EEEE":default:return n.day(e,{width:"wide",context:"formatting"})||n.day(e,{width:"abbreviated",context:"formatting"})||n.day(e,{width:"short",context:"formatting"})||n.day(e,{width:"narrow",context:"formatting"})}}validate(e,r){return r>=0&&r<=6}set(e,r,n,i){return e=NB(e,n,i),e.setHours(0,0,0,0),e}incompatibleTokens=["D","i","e","c","t","T"]}class oYe extends Pr{priority=90;parse(e,r,n,i){const s=a=>{const o=Math.floor((a-1)/7)*7;return(a+i.weekStartsOn+6)%7+o};switch(r){case"e":case"ee":return si(qn(r.length,e),s);case"eo":return si(n.ordinalNumber(e,{unit:"day"}),s);case"eee":return n.day(e,{width:"abbreviated",context:"formatting"})||n.day(e,{width:"short",context:"formatting"})||n.day(e,{width:"narrow",context:"formatting"});case"eeeee":return n.day(e,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(e,{width:"short",context:"formatting"})||n.day(e,{width:"narrow",context:"formatting"});case"eeee":default:return n.day(e,{width:"wide",context:"formatting"})||n.day(e,{width:"abbreviated",context:"formatting"})||n.day(e,{width:"short",context:"formatting"})||n.day(e,{width:"narrow",context:"formatting"})}}validate(e,r){return r>=0&&r<=6}set(e,r,n,i){return e=NB(e,n,i),e.setHours(0,0,0,0),e}incompatibleTokens=["y","R","u","q","Q","M","L","I","d","D","E","i","c","t","T"]}class lYe extends Pr{priority=90;parse(e,r,n,i){const s=a=>{const o=Math.floor((a-1)/7)*7;return(a+i.weekStartsOn+6)%7+o};switch(r){case"c":case"cc":return si(qn(r.length,e),s);case"co":return si(n.ordinalNumber(e,{unit:"day"}),s);case"ccc":return n.day(e,{width:"abbreviated",context:"standalone"})||n.day(e,{width:"short",context:"standalone"})||n.day(e,{width:"narrow",context:"standalone"});case"ccccc":return n.day(e,{width:"narrow",context:"standalone"});case"cccccc":return n.day(e,{width:"short",context:"standalone"})||n.day(e,{width:"narrow",context:"standalone"});case"cccc":default:return n.day(e,{width:"wide",context:"standalone"})||n.day(e,{width:"abbreviated",context:"standalone"})||n.day(e,{width:"short",context:"standalone"})||n.day(e,{width:"narrow",context:"standalone"})}}validate(e,r){return r>=0&&r<=6}set(e,r,n,i){return e=NB(e,n,i),e.setHours(0,0,0,0),e}incompatibleTokens=["y","R","u","q","Q","M","L","I","d","D","E","i","e","t","T"]}function uYe(t,e,r){const n=gt(t,r?.in),i=H7e(n,r),s=e-i;return kl(n,s,r)}class cYe extends Pr{priority=90;parse(e,r,n){const i=s=>s===0?7:s;switch(r){case"i":case"ii":return qn(r.length,e);case"io":return n.ordinalNumber(e,{unit:"day"});case"iii":return si(n.day(e,{width:"abbreviated",context:"formatting"})||n.day(e,{width:"short",context:"formatting"})||n.day(e,{width:"narrow",context:"formatting"}),i);case"iiiii":return si(n.day(e,{width:"narrow",context:"formatting"}),i);case"iiiiii":return si(n.day(e,{width:"short",context:"formatting"})||n.day(e,{width:"narrow",context:"formatting"}),i);case"iiii":default:return si(n.day(e,{width:"wide",context:"formatting"})||n.day(e,{width:"abbreviated",context:"formatting"})||n.day(e,{width:"short",context:"formatting"})||n.day(e,{width:"narrow",context:"formatting"}),i)}}validate(e,r){return r>=1&&r<=7}set(e,r,n){return e=uYe(e,n),e.setHours(0,0,0,0),e}incompatibleTokens=["y","Y","u","q","Q","M","L","w","d","D","E","e","c","t","T"]}class hYe extends Pr{priority=80;parse(e,r,n){switch(r){case"a":case"aa":case"aaa":return n.dayPeriod(e,{width:"abbreviated",context:"formatting"})||n.dayPeriod(e,{width:"narrow",context:"formatting"});case"aaaaa":return n.dayPeriod(e,{width:"narrow",context:"formatting"});case"aaaa":default:return n.dayPeriod(e,{width:"wide",context:"formatting"})||n.dayPeriod(e,{width:"abbreviated",context:"formatting"})||n.dayPeriod(e,{width:"narrow",context:"formatting"})}}set(e,r,n){return e.setHours(IB(n),0,0,0),e}incompatibleTokens=["b","B","H","k","t","T"]}class fYe extends Pr{priority=80;parse(e,r,n){switch(r){case"b":case"bb":case"bbb":return n.dayPeriod(e,{width:"abbreviated",context:"formatting"})||n.dayPeriod(e,{width:"narrow",context:"formatting"});case"bbbbb":return n.dayPeriod(e,{width:"narrow",context:"formatting"});case"bbbb":default:return n.dayPeriod(e,{width:"wide",context:"formatting"})||n.dayPeriod(e,{width:"abbreviated",context:"formatting"})||n.dayPeriod(e,{width:"narrow",context:"formatting"})}}set(e,r,n){return e.setHours(IB(n),0,0,0),e}incompatibleTokens=["a","B","H","k","t","T"]}class dYe extends Pr{priority=80;parse(e,r,n){switch(r){case"B":case"BB":case"BBB":return n.dayPeriod(e,{width:"abbreviated",context:"formatting"})||n.dayPeriod(e,{width:"narrow",context:"formatting"});case"BBBBB":return n.dayPeriod(e,{width:"narrow",context:"formatting"});case"BBBB":default:return n.dayPeriod(e,{width:"wide",context:"formatting"})||n.dayPeriod(e,{width:"abbreviated",context:"formatting"})||n.dayPeriod(e,{width:"narrow",context:"formatting"})}}set(e,r,n){return e.setHours(IB(n),0,0,0),e}incompatibleTokens=["a","b","t","T"]}class gYe extends Pr{priority=70;parse(e,r,n){switch(r){case"h":return kn(ii.hour12h,e);case"ho":return n.ordinalNumber(e,{unit:"hour"});default:return qn(r.length,e)}}validate(e,r){return r>=1&&r<=12}set(e,r,n){const i=e.getHours()>=12;return i&&n<12?e.setHours(n+12,0,0,0):!i&&n===12?e.setHours(0,0,0,0):e.setHours(n,0,0,0),e}incompatibleTokens=["H","K","k","t","T"]}class mYe extends Pr{priority=70;parse(e,r,n){switch(r){case"H":return kn(ii.hour23h,e);case"Ho":return n.ordinalNumber(e,{unit:"hour"});default:return qn(r.length,e)}}validate(e,r){return r>=0&&r<=23}set(e,r,n){return e.setHours(n,0,0,0),e}incompatibleTokens=["a","b","h","K","k","t","T"]}class pYe extends Pr{priority=70;parse(e,r,n){switch(r){case"K":return kn(ii.hour11h,e);case"Ko":return n.ordinalNumber(e,{unit:"hour"});default:return qn(r.length,e)}}validate(e,r){return r>=0&&r<=11}set(e,r,n){return e.getHours()>=12&&n<12?e.setHours(n+12,0,0,0):e.setHours(n,0,0,0),e}incompatibleTokens=["h","H","k","t","T"]}class vYe extends Pr{priority=70;parse(e,r,n){switch(r){case"k":return kn(ii.hour24h,e);case"ko":return n.ordinalNumber(e,{unit:"hour"});default:return qn(r.length,e)}}validate(e,r){return r>=1&&r<=24}set(e,r,n){const i=n<=24?n%24:n;return e.setHours(i,0,0,0),e}incompatibleTokens=["a","b","h","H","K","t","T"]}class wYe extends Pr{priority=60;parse(e,r,n){switch(r){case"m":return kn(ii.minute,e);case"mo":return n.ordinalNumber(e,{unit:"minute"});default:return qn(r.length,e)}}validate(e,r){return r>=0&&r<=59}set(e,r,n){return e.setMinutes(n,0,0),e}incompatibleTokens=["t","T"]}class yYe extends Pr{priority=50;parse(e,r,n){switch(r){case"s":return kn(ii.second,e);case"so":return n.ordinalNumber(e,{unit:"second"});default:return qn(r.length,e)}}validate(e,r){return r>=0&&r<=59}set(e,r,n){return e.setSeconds(n,0),e}incompatibleTokens=["t","T"]}class SYe extends Pr{priority=30;parse(e,r){const n=i=>Math.trunc(i*Math.pow(10,-r.length+3));return si(qn(r.length,e),n)}set(e,r,n){return e.setMilliseconds(n),e}incompatibleTokens=["t","T"]}class bYe extends Pr{priority=10;parse(e,r){switch(r){case"X":return Ou(Au.basicOptionalMinutes,e);case"XX":return Ou(Au.basic,e);case"XXXX":return Ou(Au.basicOptionalSeconds,e);case"XXXXX":return Ou(Au.extendedOptionalSeconds,e);case"XXX":default:return Ou(Au.extended,e)}}set(e,r,n){return r.timestampIsSet?e:qr(e,e.getTime()-nR(e)-n)}incompatibleTokens=["t","T","x"]}class CYe extends Pr{priority=10;parse(e,r){switch(r){case"x":return Ou(Au.basicOptionalMinutes,e);case"xx":return Ou(Au.basic,e);case"xxxx":return Ou(Au.basicOptionalSeconds,e);case"xxxxx":return Ou(Au.extendedOptionalSeconds,e);case"xxx":default:return Ou(Au.extended,e)}}set(e,r,n){return r.timestampIsSet?e:qr(e,e.getTime()-nR(e)-n)}incompatibleTokens=["t","T","X"]}class xYe extends Pr{priority=40;parse(e){return tie(e)}set(e,r,n){return[qr(e,n*1e3),{timestampIsSet:!0}]}incompatibleTokens="*"}class EYe extends Pr{priority=20;parse(e){return tie(e)}set(e,r,n){return[qr(e,n),{timestampIsSet:!0}]}incompatibleTokens="*"}const _Ye={G:new U7e,y:new j7e,Y:new Y7e,R:new z7e,u:new G7e,Q:new q7e,q:new K7e,M:new X7e,L:new Q7e,w:new J7e,I:new tYe,d:new iYe,D:new sYe,E:new aYe,e:new oYe,c:new lYe,i:new cYe,a:new hYe,b:new fYe,B:new dYe,h:new gYe,H:new mYe,K:new pYe,k:new vYe,m:new wYe,s:new yYe,S:new SYe,X:new bYe,x:new CYe,t:new xYe,T:new EYe},RYe=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,TYe=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,MYe=/^'([^]*?)'?$/,AYe=/''/g,OYe=/\S/,kYe=/[a-zA-Z]/;function DYe(t,e,r,n){const i=()=>qr(n?.in||r,NaN),s=N7e(),a=n?.locale??s.locale??Qne,o=n?.firstWeekContainsDate??n?.locale?.options?.firstWeekContainsDate??s.firstWeekContainsDate??s.locale?.options?.firstWeekContainsDate??1,u=n?.weekStartsOn??n?.locale?.options?.weekStartsOn??s.weekStartsOn??s.locale?.options?.weekStartsOn??0;if(!e)return t?i():gt(r,n?.in);const c={firstWeekContainsDate:o,weekStartsOn:u,locale:a},f=[new $7e(n?.in,r)],g=e.match(TYe).map(b=>{const x=b[0];if(x in dH){const _=dH[x];return _(b,a.formatLong)}return b}).join("").match(RYe),m=[];for(let b of g){const x=b[0],_=_Ye[x];if(_){const{incompatibleTokens:T}=_;if(Array.isArray(T)){const P=m.find(O=>T.includes(O.token)||O.token===x);if(P)throw new RangeError(`The format string mustn't contain \`${P.fullToken}\` and \`${b}\` at the same time`)}else if(_.incompatibleTokens==="*"&&m.length>0)throw new RangeError(`The format string mustn't contain \`${b}\` and any other token at the same time`);m.push({token:x,fullToken:b});const D=_.run(t,b,a.match,c);if(!D)return i();f.push(D.setter),t=D.rest}else{if(x.match(kYe))throw new RangeError("Format string contains an unescaped latin alphabet character `"+x+"`");if(b==="''"?b="'":x==="'"&&(b=PYe(b)),t.indexOf(b)===0)t=t.slice(b.length);else return i()}}if(t.length>0&&OYe.test(t))return i();const v=f.map(b=>b.priority).sort((b,x)=>x-b).filter((b,x,_)=>_.indexOf(b)===x).map(b=>f.filter(x=>x.priority===b).sort((x,_)=>_.subPriority-x.subPriority)).map(b=>b[0]);let w=gt(r,n?.in);if(isNaN(+w))return i();const y={};for(const b of v){if(!b.validate(w,c))return i();const x=b.set(w,y,c);Array.isArray(x)?(w=x[0],Object.assign(y,x[1])):w=x}return w}function PYe(t){return t.match(MYe)[1].replace(AYe,"'")}function IYe(t,e,r){const[n,i]=ph(r?.in,t,e);return n.getFullYear()===i.getFullYear()&&n.getMonth()===i.getMonth()}function NYe(t,e,r){const[n,i]=ph(r?.in,t,e);return+fH(n)==+fH(i)}function HYe(t,e,r){const[n,i]=ph(r?.in,t,e);return n.getFullYear()===i.getFullYear()}function tS(t,e,r){const n=+gt(t,r?.in),[i,s]=[+gt(e.start,r?.in),+gt(e.end,r?.in)].sort((a,o)=>a-o);return n>=i&&n<=s}function FYe(t,e,r){return kl(t,-1,r)}function LYe(t,e){const r=()=>qr(e?.in,NaN),i=$Ye(t);let s;if(i.date){const c=UYe(i.date,2);s=jYe(c.restDateString,c.year)}if(!s||isNaN(+s))return r();const a=+s;let o=0,u;if(i.time&&(o=YYe(i.time),isNaN(o)))return r();if(i.timezone){if(u=zYe(i.timezone),isNaN(u))return r()}else{const c=new Date(a+o),f=gt(0,e?.in);return f.setFullYear(c.getUTCFullYear(),c.getUTCMonth(),c.getUTCDate()),f.setHours(c.getUTCHours(),c.getUTCMinutes(),c.getUTCSeconds(),c.getUTCMilliseconds()),f}return gt(a+o+u,e?.in)}const eE={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},BYe=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,VYe=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,WYe=/^([+-])(\d{2})(?::?(\d{2}))?$/;function $Ye(t){const e={},r=t.split(eE.dateTimeDelimiter);let n;if(r.length>2)return e;if(/:/.test(r[0])?n=r[0]:(e.date=r[0],n=r[1],eE.timeZoneDelimiter.test(e.date)&&(e.date=t.split(eE.timeZoneDelimiter)[0],n=t.substr(e.date.length,t.length))),n){const i=eE.timezone.exec(n);i?(e.time=n.replace(i[1],""),e.timezone=i[1]):e.time=n}return e}function UYe(t,e){const r=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+e)+"})|(\\d{2}|[+-]\\d{"+(2+e)+"})$)"),n=t.match(r);if(!n)return{year:NaN,restDateString:""};const i=n[1]?parseInt(n[1]):null,s=n[2]?parseInt(n[2]):null;return{year:s===null?i:s*100,restDateString:t.slice((n[1]||n[2]).length)}}function jYe(t,e){if(e===null)return new Date(NaN);const r=t.match(BYe);if(!r)return new Date(NaN);const n=!!r[4],i=vy(r[1]),s=vy(r[2])-1,a=vy(r[3]),o=vy(r[4]),u=vy(r[5])-1;if(n)return QYe(e,o,u)?GYe(e,o,u):new Date(NaN);{const c=new Date(0);return!KYe(e,s,a)||!XYe(e,i)?new Date(NaN):(c.setUTCFullYear(e,s,Math.max(i,a)),c)}}function vy(t){return t?parseInt(t):1}function YYe(t){const e=t.match(VYe);if(!e)return NaN;const r=MI(e[1]),n=MI(e[2]),i=MI(e[3]);return ZYe(r,n,i)?r*LT+n*FT+i*1e3:NaN}function MI(t){return t&&parseFloat(t.replace(",","."))||0}function zYe(t){if(t==="Z")return 0;const e=t.match(WYe);if(!e)return 0;const r=e[1]==="+"?-1:1,n=parseInt(e[2]),i=e[3]&&parseInt(e[3])||0;return JYe(n,i)?r*(n*LT+i*FT):NaN}function GYe(t,e,r){const n=new Date(0);n.setUTCFullYear(t,0,4);const i=n.getUTCDay()||7,s=(e-1)*7+r+1-i;return n.setUTCDate(n.getUTCDate()+s),n}const qYe=[31,null,31,30,31,30,31,31,30,31,30,31];function iie(t){return t%400===0||t%4===0&&t%100!==0}function KYe(t,e,r){return e>=0&&e<=11&&r>=1&&r<=(qYe[e]||(iie(t)?29:28))}function XYe(t,e){return e>=1&&e<=(iie(t)?366:365)}function QYe(t,e,r){return e>=1&&e<=53&&r>=0&&r<=6}function ZYe(t,e,r){return t===24?e===0&&r===0:r>=0&&r<60&&e>=0&&e<60&&t>=0&&t<25}function JYe(t,e){return e>=0&&e<=59}function Io(t,e,r){const n=gt(t,r?.in),i=n.getFullYear(),s=n.getDate(),a=qr(t,0);a.setFullYear(i,e,15),a.setHours(0,0,0,0);const o=I7e(a);return n.setMonth(e,Math.min(s,o)),n}function NE(t,e,r){const n=gt(t,r?.in);return n.setHours(e),n}function HE(t,e,r){const n=gt(t,r?.in);return n.setMinutes(e),n}function J0(t,e,r){const n=gt(t,r?.in),i=Math.trunc(n.getMonth()/3)+1,s=e-i;return Io(n,n.getMonth()+s*3)}function FE(t,e,r){const n=gt(t,r?.in);return n.setSeconds(e),n}function yu(t,e,r){const n=gt(t,r?.in);return isNaN(+n)?qr(t,NaN):(n.setFullYear(e),n)}function kg(t,e,r){return Hl(t,-e,r)}function sie(t,e,r){return kB(t,-1,r)}function vq(t,e,r){return iR(t,-1,r)}function Up(t,e,r){return Kc(t,-e,r)}function VT(){return typeof window<"u"}function pv(t){return aie(t)?(t.nodeName||"").toLowerCase():"#document"}function Qa(t){var e;return(t==null||(e=t.ownerDocument)==null?void 0:e.defaultView)||window}function Zu(t){var e;return(e=(aie(t)?t.ownerDocument:t.document)||window.document)==null?void 0:e.documentElement}function aie(t){return VT()?t instanceof Node||t instanceof Qa(t).Node:!1}function zs(t){return VT()?t instanceof Element||t instanceof Qa(t).Element:!1}function Wu(t){return VT()?t instanceof HTMLElement||t instanceof Qa(t).HTMLElement:!1}function wq(t){return!VT()||typeof ShadowRoot>"u"?!1:t instanceof ShadowRoot||t instanceof Qa(t).ShadowRoot}const eze=new Set(["inline","contents"]);function GS(t){const{overflow:e,overflowX:r,overflowY:n,display:i}=jo(t);return/auto|scroll|overlay|hidden|clip/.test(e+n+r)&&!eze.has(i)}const tze=new Set(["table","td","th"]);function rze(t){return tze.has(pv(t))}const nze=[":popover-open",":modal"];function WT(t){return nze.some(e=>{try{return t.matches(e)}catch{return!1}})}const ize=["transform","translate","scale","rotate","perspective"],sze=["transform","translate","scale","rotate","perspective","filter"],aze=["paint","layout","strict","content"];function HB(t){const e=FB(),r=zs(t)?jo(t):t;return ize.some(n=>r[n]?r[n]!=="none":!1)||(r.containerType?r.containerType!=="normal":!1)||!e&&(r.backdropFilter?r.backdropFilter!=="none":!1)||!e&&(r.filter?r.filter!=="none":!1)||sze.some(n=>(r.willChange||"").includes(n))||aze.some(n=>(r.contain||"").includes(n))}function oze(t){let e=qf(t);for(;Wu(e)&&!jp(e);){if(HB(e))return e;if(WT(e))return null;e=qf(e)}return null}function FB(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const lze=new Set(["html","body","#document"]);function jp(t){return lze.has(pv(t))}function jo(t){return Qa(t).getComputedStyle(t)}function $T(t){return zs(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.scrollX,scrollTop:t.scrollY}}function qf(t){if(pv(t)==="html")return t;const e=t.assignedSlot||t.parentNode||wq(t)&&t.host||Zu(t);return wq(e)?e.host:e}function oie(t){const e=qf(t);return jp(e)?t.ownerDocument?t.ownerDocument.body:t.body:Wu(e)&&GS(e)?e:oie(e)}function rS(t,e,r){var n;e===void 0&&(e=[]),r===void 0&&(r=!0);const i=oie(t),s=i===((n=t.ownerDocument)==null?void 0:n.body),a=Qa(i);if(s){const o=mH(a);return e.concat(a,a.visualViewport||[],GS(i)?i:[],o&&r?rS(o):[])}return e.concat(i,rS(i,[],r))}function mH(t){return t.parent&&Object.getPrototypeOf(t.parent)?t.frameElement:null}const Yp=Math.min,Dg=Math.max,cR=Math.round,tE=Math.floor,Fu=t=>({x:t,y:t}),uze={left:"right",right:"left",bottom:"top",top:"bottom"},cze={start:"end",end:"start"};function hze(t,e,r){return Dg(t,Yp(e,r))}function UT(t,e){return typeof t=="function"?t(e):t}function zp(t){return t.split("-")[0]}function qS(t){return t.split("-")[1]}function fze(t){return t==="x"?"y":"x"}function LB(t){return t==="y"?"height":"width"}const dze=new Set(["top","bottom"]);function Cg(t){return dze.has(zp(t))?"y":"x"}function BB(t){return fze(Cg(t))}function gze(t,e,r){r===void 0&&(r=!1);const n=qS(t),i=BB(t),s=LB(i);let a=i==="x"?n===(r?"end":"start")?"right":"left":n==="start"?"bottom":"top";return e.reference[s]>e.floating[s]&&(a=hR(a)),[a,hR(a)]}function mze(t){const e=hR(t);return[pH(t),e,pH(e)]}function pH(t){return t.replace(/start|end/g,e=>cze[e])}const yq=["left","right"],Sq=["right","left"],pze=["top","bottom"],vze=["bottom","top"];function wze(t,e,r){switch(t){case"top":case"bottom":return r?e?Sq:yq:e?yq:Sq;case"left":case"right":return e?pze:vze;default:return[]}}function yze(t,e,r,n){const i=qS(t);let s=wze(zp(t),r==="start",n);return i&&(s=s.map(a=>a+"-"+i),e&&(s=s.concat(s.map(pH)))),s}function hR(t){return t.replace(/left|right|bottom|top/g,e=>uze[e])}function Sze(t){return{top:0,right:0,bottom:0,left:0,...t}}function lie(t){return typeof t!="number"?Sze(t):{top:t,right:t,bottom:t,left:t}}function fR(t){const{x:e,y:r,width:n,height:i}=t;return{width:n,height:i,top:r,left:e,right:e+n,bottom:r+i,x:e,y:r}}var bze=typeof document<"u",Cze=function(){},dR=bze?ie.useLayoutEffect:Cze;const xze={...$E},Eze=xze.useInsertionEffect,_ze=Eze||(t=>t());function Rze(t){const e=ie.useRef(()=>{});return _ze(()=>{e.current=t}),ie.useCallback(function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return e.current==null?void 0:e.current(...n)},[])}function bq(t,e,r){let{reference:n,floating:i}=t;const s=Cg(e),a=BB(e),o=LB(a),u=zp(e),c=s==="y",f=n.x+n.width/2-i.width/2,g=n.y+n.height/2-i.height/2,m=n[o]/2-i[o]/2;let v;switch(u){case"top":v={x:f,y:n.y-i.height};break;case"bottom":v={x:f,y:n.y+n.height};break;case"right":v={x:n.x+n.width,y:g};break;case"left":v={x:n.x-i.width,y:g};break;default:v={x:n.x,y:n.y}}switch(qS(e)){case"start":v[a]-=m*(r&&c?-1:1);break;case"end":v[a]+=m*(r&&c?-1:1);break}return v}const Tze=async(t,e,r)=>{const{placement:n="bottom",strategy:i="absolute",middleware:s=[],platform:a}=r,o=s.filter(Boolean),u=await(a.isRTL==null?void 0:a.isRTL(e));let c=await a.getElementRects({reference:t,floating:e,strategy:i}),{x:f,y:g}=bq(c,n,u),m=n,v={},w=0;for(let y=0;y<o.length;y++){const{name:b,fn:x}=o[y],{x:_,y:T,data:D,reset:P}=await x({x:f,y:g,initialPlacement:n,placement:m,strategy:i,middlewareData:v,rects:c,platform:a,elements:{reference:t,floating:e}});f=_??f,g=T??g,v={...v,[b]:{...v[b],...D}},P&&w<=50&&(w++,typeof P=="object"&&(P.placement&&(m=P.placement),P.rects&&(c=P.rects===!0?await a.getElementRects({reference:t,floating:e,strategy:i}):P.rects),{x:f,y:g}=bq(c,m,u)),y=-1)}return{x:f,y:g,placement:m,strategy:i,middlewareData:v}};async function Mze(t,e){var r;e===void 0&&(e={});const{x:n,y:i,platform:s,rects:a,elements:o,strategy:u}=t,{boundary:c="clippingAncestors",rootBoundary:f="viewport",elementContext:g="floating",altBoundary:m=!1,padding:v=0}=UT(e,t),w=lie(v),b=o[m?g==="floating"?"reference":"floating":g],x=fR(await s.getClippingRect({element:(r=await(s.isElement==null?void 0:s.isElement(b)))==null||r?b:b.contextElement||await(s.getDocumentElement==null?void 0:s.getDocumentElement(o.floating)),boundary:c,rootBoundary:f,strategy:u})),_=g==="floating"?{x:n,y:i,width:a.floating.width,height:a.floating.height}:a.reference,T=await(s.getOffsetParent==null?void 0:s.getOffsetParent(o.floating)),D=await(s.isElement==null?void 0:s.isElement(T))?await(s.getScale==null?void 0:s.getScale(T))||{x:1,y:1}:{x:1,y:1},P=fR(s.convertOffsetParentRelativeRectToViewportRelativeRect?await s.convertOffsetParentRelativeRectToViewportRelativeRect({elements:o,rect:_,offsetParent:T,strategy:u}):_);return{top:(x.top-P.top+w.top)/D.y,bottom:(P.bottom-x.bottom+w.bottom)/D.y,left:(x.left-P.left+w.left)/D.x,right:(P.right-x.right+w.right)/D.x}}const Aze=t=>({name:"arrow",options:t,async fn(e){const{x:r,y:n,placement:i,rects:s,platform:a,elements:o,middlewareData:u}=e,{element:c,padding:f=0}=UT(t,e)||{};if(c==null)return{};const g=lie(f),m={x:r,y:n},v=BB(i),w=LB(v),y=await a.getDimensions(c),b=v==="y",x=b?"top":"left",_=b?"bottom":"right",T=b?"clientHeight":"clientWidth",D=s.reference[w]+s.reference[v]-m[v]-s.floating[w],P=m[v]-s.reference[v],O=await(a.getOffsetParent==null?void 0:a.getOffsetParent(c));let A=O?O[T]:0;(!A||!await(a.isElement==null?void 0:a.isElement(O)))&&(A=o.floating[T]||s.floating[w]);const W=D/2-P/2,L=A/2-y[w]/2-1,H=Yp(g[x],L),J=Yp(g[_],L),G=H,ve=A-y[w]-J,be=A/2-y[w]/2+W,we=hze(G,be,ve),ae=!u.arrow&&qS(i)!=null&&be!==we&&s.reference[w]/2-(be<G?H:J)-y[w]/2<0,le=ae?be<G?be-G:be-ve:0;return{[v]:m[v]+le,data:{[v]:we,centerOffset:be-we-le,...ae&&{alignmentOffset:le}},reset:ae}}}),Oze=function(t){return t===void 0&&(t={}),{name:"flip",options:t,async fn(e){var r,n;const{placement:i,middlewareData:s,rects:a,initialPlacement:o,platform:u,elements:c}=e,{mainAxis:f=!0,crossAxis:g=!0,fallbackPlacements:m,fallbackStrategy:v="bestFit",fallbackAxisSideDirection:w="none",flipAlignment:y=!0,...b}=UT(t,e);if((r=s.arrow)!=null&&r.alignmentOffset)return{};const x=zp(i),_=Cg(o),T=zp(o)===o,D=await(u.isRTL==null?void 0:u.isRTL(c.floating)),P=m||(T||!y?[hR(o)]:mze(o)),O=w!=="none";!m&&O&&P.push(...yze(o,y,w,D));const A=[o,...P],W=await Mze(e,b),L=[];let H=((n=s.flip)==null?void 0:n.overflows)||[];if(f&&L.push(W[x]),g){const be=gze(i,a,D);L.push(W[be[0]],W[be[1]])}if(H=[...H,{placement:i,overflows:L}],!L.every(be=>be<=0)){var J,G;const be=(((J=s.flip)==null?void 0:J.index)||0)+1,we=A[be];if(we&&(!(g==="alignment"?_!==Cg(we):!1)||H.every(Te=>Cg(Te.placement)===_?Te.overflows[0]>0:!0)))return{data:{index:be,overflows:H},reset:{placement:we}};let ae=(G=H.filter(le=>le.overflows[0]<=0).sort((le,Te)=>le.overflows[1]-Te.overflows[1])[0])==null?void 0:G.placement;if(!ae)switch(v){case"bestFit":{var ve;const le=(ve=H.filter(Te=>{if(O){const ce=Cg(Te.placement);return ce===_||ce==="y"}return!0}).map(Te=>[Te.placement,Te.overflows.filter(ce=>ce>0).reduce((ce,K)=>ce+K,0)]).sort((Te,ce)=>Te[1]-ce[1])[0])==null?void 0:ve[0];le&&(ae=le);break}case"initialPlacement":ae=o;break}if(i!==ae)return{reset:{placement:ae}}}return{}}}},kze=new Set(["left","top"]);async function Dze(t,e){const{placement:r,platform:n,elements:i}=t,s=await(n.isRTL==null?void 0:n.isRTL(i.floating)),a=zp(r),o=qS(r),u=Cg(r)==="y",c=kze.has(a)?-1:1,f=s&&u?-1:1,g=UT(e,t);let{mainAxis:m,crossAxis:v,alignmentAxis:w}=typeof g=="number"?{mainAxis:g,crossAxis:0,alignmentAxis:null}:{mainAxis:g.mainAxis||0,crossAxis:g.crossAxis||0,alignmentAxis:g.alignmentAxis};return o&&typeof w=="number"&&(v=o==="end"?w*-1:w),u?{x:v*f,y:m*c}:{x:m*c,y:v*f}}const Pze=function(t){return t===void 0&&(t=0),{name:"offset",options:t,async fn(e){var r,n;const{x:i,y:s,placement:a,middlewareData:o}=e,u=await Dze(e,t);return a===((r=o.offset)==null?void 0:r.placement)&&(n=o.arrow)!=null&&n.alignmentOffset?{}:{x:i+u.x,y:s+u.y,data:{...u,placement:a}}}}};function uie(t){const e=jo(t);let r=parseFloat(e.width)||0,n=parseFloat(e.height)||0;const i=Wu(t),s=i?t.offsetWidth:r,a=i?t.offsetHeight:n,o=cR(r)!==s||cR(n)!==a;return o&&(r=s,n=a),{width:r,height:n,$:o}}function VB(t){return zs(t)?t:t.contextElement}function xp(t){const e=VB(t);if(!Wu(e))return Fu(1);const r=e.getBoundingClientRect(),{width:n,height:i,$:s}=uie(e);let a=(s?cR(r.width):r.width)/n,o=(s?cR(r.height):r.height)/i;return(!a||!Number.isFinite(a))&&(a=1),(!o||!Number.isFinite(o))&&(o=1),{x:a,y:o}}const Ize=Fu(0);function cie(t){const e=Qa(t);return!FB()||!e.visualViewport?Ize:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function Nze(t,e,r){return e===void 0&&(e=!1),!r||e&&r!==Qa(t)?!1:e}function Xg(t,e,r,n){e===void 0&&(e=!1),r===void 0&&(r=!1);const i=t.getBoundingClientRect(),s=VB(t);let a=Fu(1);e&&(n?zs(n)&&(a=xp(n)):a=xp(t));const o=Nze(s,r,n)?cie(s):Fu(0);let u=(i.left+o.x)/a.x,c=(i.top+o.y)/a.y,f=i.width/a.x,g=i.height/a.y;if(s){const m=Qa(s),v=n&&zs(n)?Qa(n):n;let w=m,y=mH(w);for(;y&&n&&v!==w;){const b=xp(y),x=y.getBoundingClientRect(),_=jo(y),T=x.left+(y.clientLeft+parseFloat(_.paddingLeft))*b.x,D=x.top+(y.clientTop+parseFloat(_.paddingTop))*b.y;u*=b.x,c*=b.y,f*=b.x,g*=b.y,u+=T,c+=D,w=Qa(y),y=mH(w)}}return fR({width:f,height:g,x:u,y:c})}function WB(t,e){const r=$T(t).scrollLeft;return e?e.left+r:Xg(Zu(t)).left+r}function hie(t,e,r){r===void 0&&(r=!1);const n=t.getBoundingClientRect(),i=n.left+e.scrollLeft-(r?0:WB(t,n)),s=n.top+e.scrollTop;return{x:i,y:s}}function Hze(t){let{elements:e,rect:r,offsetParent:n,strategy:i}=t;const s=i==="fixed",a=Zu(n),o=e?WT(e.floating):!1;if(n===a||o&&s)return r;let u={scrollLeft:0,scrollTop:0},c=Fu(1);const f=Fu(0),g=Wu(n);if((g||!g&&!s)&&((pv(n)!=="body"||GS(a))&&(u=$T(n)),Wu(n))){const v=Xg(n);c=xp(n),f.x=v.x+n.clientLeft,f.y=v.y+n.clientTop}const m=a&&!g&&!s?hie(a,u,!0):Fu(0);return{width:r.width*c.x,height:r.height*c.y,x:r.x*c.x-u.scrollLeft*c.x+f.x+m.x,y:r.y*c.y-u.scrollTop*c.y+f.y+m.y}}function Fze(t){return Array.from(t.getClientRects())}function Lze(t){const e=Zu(t),r=$T(t),n=t.ownerDocument.body,i=Dg(e.scrollWidth,e.clientWidth,n.scrollWidth,n.clientWidth),s=Dg(e.scrollHeight,e.clientHeight,n.scrollHeight,n.clientHeight);let a=-r.scrollLeft+WB(t);const o=-r.scrollTop;return jo(n).direction==="rtl"&&(a+=Dg(e.clientWidth,n.clientWidth)-i),{width:i,height:s,x:a,y:o}}function Bze(t,e){const r=Qa(t),n=Zu(t),i=r.visualViewport;let s=n.clientWidth,a=n.clientHeight,o=0,u=0;if(i){s=i.width,a=i.height;const c=FB();(!c||c&&e==="fixed")&&(o=i.offsetLeft,u=i.offsetTop)}return{width:s,height:a,x:o,y:u}}const Vze=new Set(["absolute","fixed"]);function Wze(t,e){const r=Xg(t,!0,e==="fixed"),n=r.top+t.clientTop,i=r.left+t.clientLeft,s=Wu(t)?xp(t):Fu(1),a=t.clientWidth*s.x,o=t.clientHeight*s.y,u=i*s.x,c=n*s.y;return{width:a,height:o,x:u,y:c}}function Cq(t,e,r){let n;if(e==="viewport")n=Bze(t,r);else if(e==="document")n=Lze(Zu(t));else if(zs(e))n=Wze(e,r);else{const i=cie(t);n={x:e.x-i.x,y:e.y-i.y,width:e.width,height:e.height}}return fR(n)}function fie(t,e){const r=qf(t);return r===e||!zs(r)||jp(r)?!1:jo(r).position==="fixed"||fie(r,e)}function $ze(t,e){const r=e.get(t);if(r)return r;let n=rS(t,[],!1).filter(o=>zs(o)&&pv(o)!=="body"),i=null;const s=jo(t).position==="fixed";let a=s?qf(t):t;for(;zs(a)&&!jp(a);){const o=jo(a),u=HB(a);!u&&o.position==="fixed"&&(i=null),(s?!u&&!i:!u&&o.position==="static"&&!!i&&Vze.has(i.position)||GS(a)&&!u&&fie(t,a))?n=n.filter(f=>f!==a):i=o,a=qf(a)}return e.set(t,n),n}function Uze(t){let{element:e,boundary:r,rootBoundary:n,strategy:i}=t;const a=[...r==="clippingAncestors"?WT(e)?[]:$ze(e,this._c):[].concat(r),n],o=a[0],u=a.reduce((c,f)=>{const g=Cq(e,f,i);return c.top=Dg(g.top,c.top),c.right=Yp(g.right,c.right),c.bottom=Yp(g.bottom,c.bottom),c.left=Dg(g.left,c.left),c},Cq(e,o,i));return{width:u.right-u.left,height:u.bottom-u.top,x:u.left,y:u.top}}function jze(t){const{width:e,height:r}=uie(t);return{width:e,height:r}}function Yze(t,e,r){const n=Wu(e),i=Zu(e),s=r==="fixed",a=Xg(t,!0,s,e);let o={scrollLeft:0,scrollTop:0};const u=Fu(0);function c(){u.x=WB(i)}if(n||!n&&!s)if((pv(e)!=="body"||GS(i))&&(o=$T(e)),n){const v=Xg(e,!0,s,e);u.x=v.x+e.clientLeft,u.y=v.y+e.clientTop}else i&&c();s&&!n&&i&&c();const f=i&&!n&&!s?hie(i,o):Fu(0),g=a.left+o.scrollLeft-u.x-f.x,m=a.top+o.scrollTop-u.y-f.y;return{x:g,y:m,width:a.width,height:a.height}}function AI(t){return jo(t).position==="static"}function xq(t,e){if(!Wu(t)||jo(t).position==="fixed")return null;if(e)return e(t);let r=t.offsetParent;return Zu(t)===r&&(r=r.ownerDocument.body),r}function die(t,e){const r=Qa(t);if(WT(t))return r;if(!Wu(t)){let i=qf(t);for(;i&&!jp(i);){if(zs(i)&&!AI(i))return i;i=qf(i)}return r}let n=xq(t,e);for(;n&&rze(n)&&AI(n);)n=xq(n,e);return n&&jp(n)&&AI(n)&&!HB(n)?r:n||oze(t)||r}const zze=async function(t){const e=this.getOffsetParent||die,r=this.getDimensions,n=await r(t.floating);return{reference:Yze(t.reference,await e(t.floating),t.strategy),floating:{x:0,y:0,width:n.width,height:n.height}}};function Gze(t){return jo(t).direction==="rtl"}const qze={convertOffsetParentRelativeRectToViewportRelativeRect:Hze,getDocumentElement:Zu,getClippingRect:Uze,getOffsetParent:die,getElementRects:zze,getClientRects:Fze,getDimensions:jze,getScale:xp,isElement:zs,isRTL:Gze};function gie(t,e){return t.x===e.x&&t.y===e.y&&t.width===e.width&&t.height===e.height}function Kze(t,e){let r=null,n;const i=Zu(t);function s(){var o;clearTimeout(n),(o=r)==null||o.disconnect(),r=null}function a(o,u){o===void 0&&(o=!1),u===void 0&&(u=1),s();const c=t.getBoundingClientRect(),{left:f,top:g,width:m,height:v}=c;if(o||e(),!m||!v)return;const w=tE(g),y=tE(i.clientWidth-(f+m)),b=tE(i.clientHeight-(g+v)),x=tE(f),T={rootMargin:-w+"px "+-y+"px "+-b+"px "+-x+"px",threshold:Dg(0,Yp(1,u))||1};let D=!0;function P(O){const A=O[0].intersectionRatio;if(A!==u){if(!D)return a();A?a(!1,A):n=setTimeout(()=>{a(!1,1e-7)},1e3)}A===1&&!gie(c,t.getBoundingClientRect())&&a(),D=!1}try{r=new IntersectionObserver(P,{...T,root:i.ownerDocument})}catch{r=new IntersectionObserver(P,T)}r.observe(t)}return a(!0),s}function Xze(t,e,r,n){n===void 0&&(n={});const{ancestorScroll:i=!0,ancestorResize:s=!0,elementResize:a=typeof ResizeObserver=="function",layoutShift:o=typeof IntersectionObserver=="function",animationFrame:u=!1}=n,c=VB(t),f=i||s?[...c?rS(c):[],...rS(e)]:[];f.forEach(x=>{i&&x.addEventListener("scroll",r,{passive:!0}),s&&x.addEventListener("resize",r)});const g=c&&o?Kze(c,r):null;let m=-1,v=null;a&&(v=new ResizeObserver(x=>{let[_]=x;_&&_.target===c&&v&&(v.unobserve(e),cancelAnimationFrame(m),m=requestAnimationFrame(()=>{var T;(T=v)==null||T.observe(e)})),r()}),c&&!u&&v.observe(c),v.observe(e));let w,y=u?Xg(t):null;u&&b();function b(){const x=Xg(t);y&&!gie(y,x)&&r(),y=x,w=requestAnimationFrame(b)}return r(),()=>{var x;f.forEach(_=>{i&&_.removeEventListener("scroll",r),s&&_.removeEventListener("resize",r)}),g?.(),(x=v)==null||x.disconnect(),v=null,u&&cancelAnimationFrame(w)}}const Qze=Pze,Zze=Oze,Eq=Aze,Jze=(t,e,r)=>{const n=new Map,i={platform:qze,...r},s={...i.platform,_c:n};return Tze(t,e,{...i,platform:s})};var eGe=typeof document<"u",tGe=function(){},LE=eGe?ie.useLayoutEffect:tGe;function gR(t,e){if(t===e)return!0;if(typeof t!=typeof e)return!1;if(typeof t=="function"&&t.toString()===e.toString())return!0;let r,n,i;if(t&&e&&typeof t=="object"){if(Array.isArray(t)){if(r=t.length,r!==e.length)return!1;for(n=r;n--!==0;)if(!gR(t[n],e[n]))return!1;return!0}if(i=Object.keys(t),r=i.length,r!==Object.keys(e).length)return!1;for(n=r;n--!==0;)if(!{}.hasOwnProperty.call(e,i[n]))return!1;for(n=r;n--!==0;){const s=i[n];if(!(s==="_owner"&&t.$$typeof)&&!gR(t[s],e[s]))return!1}return!0}return t!==t&&e!==e}function mie(t){return typeof window>"u"?1:(t.ownerDocument.defaultView||window).devicePixelRatio||1}function _q(t,e){const r=mie(t);return Math.round(e*r)/r}function OI(t){const e=ie.useRef(t);return LE(()=>{e.current=t}),e}function rGe(t){t===void 0&&(t={});const{placement:e="bottom",strategy:r="absolute",middleware:n=[],platform:i,elements:{reference:s,floating:a}={},transform:o=!0,whileElementsMounted:u,open:c}=t,[f,g]=ie.useState({x:0,y:0,strategy:r,placement:e,middlewareData:{},isPositioned:!1}),[m,v]=ie.useState(n);gR(m,n)||v(n);const[w,y]=ie.useState(null),[b,x]=ie.useState(null),_=ie.useCallback(Te=>{Te!==O.current&&(O.current=Te,y(Te))},[]),T=ie.useCallback(Te=>{Te!==A.current&&(A.current=Te,x(Te))},[]),D=s||w,P=a||b,O=ie.useRef(null),A=ie.useRef(null),W=ie.useRef(f),L=u!=null,H=OI(u),J=OI(i),G=OI(c),ve=ie.useCallback(()=>{if(!O.current||!A.current)return;const Te={placement:e,strategy:r,middleware:m};J.current&&(Te.platform=J.current),Jze(O.current,A.current,Te).then(ce=>{const K={...ce,isPositioned:G.current!==!1};be.current&&!gR(W.current,K)&&(W.current=K,fK.flushSync(()=>{g(K)}))})},[m,e,r,J,G]);LE(()=>{c===!1&&W.current.isPositioned&&(W.current.isPositioned=!1,g(Te=>({...Te,isPositioned:!1})))},[c]);const be=ie.useRef(!1);LE(()=>(be.current=!0,()=>{be.current=!1}),[]),LE(()=>{if(D&&(O.current=D),P&&(A.current=P),D&&P){if(H.current)return H.current(D,P,ve);ve()}},[D,P,ve,H,L]);const we=ie.useMemo(()=>({reference:O,floating:A,setReference:_,setFloating:T}),[_,T]),ae=ie.useMemo(()=>({reference:D,floating:P}),[D,P]),le=ie.useMemo(()=>{const Te={position:r,left:0,top:0};if(!ae.floating)return Te;const ce=_q(ae.floating,f.x),K=_q(ae.floating,f.y);return o?{...Te,transform:"translate("+ce+"px, "+K+"px)",...mie(ae.floating)>=1.5&&{willChange:"transform"}}:{position:r,left:ce,top:K}},[r,o,ae.floating,f.x,f.y]);return ie.useMemo(()=>({...f,update:ve,refs:we,elements:ae,floatingStyles:le}),[f,ve,we,ae,le])}const nGe=t=>{function e(r){return{}.hasOwnProperty.call(r,"current")}return{name:"arrow",options:t,fn(r){const{element:n,padding:i}=typeof t=="function"?t(r):t;return n&&e(n)?n.current!=null?Eq({element:n.current,padding:i}).fn(r):{}:n?Eq({element:n,padding:i}).fn(r):{}}}},iGe=(t,e)=>({...Qze(t),options:[t,e]}),sGe=(t,e)=>({...Zze(t),options:[t,e]}),aGe=(t,e)=>({...nGe(t),options:[t,e]}),oGe={...$E};let Rq=!1,lGe=0;const Tq=()=>"floating-ui-"+Math.random().toString(36).slice(2,6)+lGe++;function uGe(){const[t,e]=ie.useState(()=>Rq?Tq():void 0);return dR(()=>{t==null&&e(Tq())},[]),ie.useEffect(()=>{Rq=!0},[]),t}const cGe=oGe.useId,pie=cGe||uGe,hGe=ie.forwardRef(function(e,r){const{context:{placement:n,elements:{floating:i},middlewareData:{arrow:s,shift:a}},width:o=14,height:u=7,tipRadius:c=0,strokeWidth:f=0,staticOffset:g,stroke:m,d:v,style:{transform:w,...y}={},...b}=e,x=pie(),[_,T]=ie.useState(!1);if(dR(()=>{if(!i)return;jo(i).direction==="rtl"&&T(!0)},[i]),!i)return null;const[D,P]=n.split("-"),O=D==="top"||D==="bottom";let A=g;(O&&a!=null&&a.x||!O&&a!=null&&a.y)&&(A=null);const W=f*2,L=W/2,H=o/2*(c/-8+1),J=u/2*c/4,G=!!v,ve=A&&P==="end"?"bottom":"top";let be=A&&P==="end"?"right":"left";A&&_&&(be=P==="end"?"left":"right");const we=s?.x!=null?A||s.x:"",ae=s?.y!=null?A||s.y:"",le=v||"M0,0"+(" H"+o)+(" L"+(o-H)+","+(u-J))+(" Q"+o/2+","+u+" "+H+","+(u-J))+" Z",Te={top:G?"rotate(180deg)":"",left:G?"rotate(90deg)":"rotate(-90deg)",bottom:G?"":"rotate(180deg)",right:G?"rotate(-90deg)":"rotate(90deg)"}[D];return Y.jsxs("svg",{...b,"aria-hidden":!0,ref:r,width:G?o:o+W,height:o,viewBox:"0 0 "+o+" "+(u>o?u:o),style:{position:"absolute",pointerEvents:"none",[be]:we,[ve]:ae,[D]:O||G?"100%":"calc(100% - "+W/2+"px)",transform:[Te,w].filter(ce=>!!ce).join(" "),...y},children:[W>0&&Y.jsx("path",{clipPath:"url(#"+x+")",fill:"none",stroke:m,strokeWidth:W+(v?0:1),d:le}),Y.jsx("path",{stroke:W&&!v?b.fill:"none",d:le}),Y.jsx("clipPath",{id:x,children:Y.jsx("rect",{x:-L,y:L*(G?-1:1),width:o+W,height:o})})]})});function fGe(){const t=new Map;return{emit(e,r){var n;(n=t.get(e))==null||n.forEach(i=>i(r))},on(e,r){t.has(e)||t.set(e,new Set),t.get(e).add(r)},off(e,r){var n;(n=t.get(e))==null||n.delete(r)}}}const dGe=ie.createContext(null),gGe=ie.createContext(null),mGe=()=>{var t;return((t=ie.useContext(dGe))==null?void 0:t.id)||null},pGe=()=>ie.useContext(gGe);function vGe(t){const{open:e=!1,onOpenChange:r,elements:n}=t,i=pie(),s=ie.useRef({}),[a]=ie.useState(()=>fGe()),o=mGe()!=null,[u,c]=ie.useState(n.reference),f=Rze((v,w,y)=>{s.current.openEvent=v?w:void 0,a.emit("openchange",{open:v,event:w,reason:y,nested:o}),r?.(v,w,y)}),g=ie.useMemo(()=>({setPositionReference:c}),[]),m=ie.useMemo(()=>({reference:u||n.reference||null,floating:n.floating||null,domReference:n.reference}),[u,n.reference,n.floating]);return ie.useMemo(()=>({dataRef:s,open:e,onOpenChange:f,elements:m,events:a,floatingId:i,refs:g}),[e,f,m,a,i,g])}function wGe(t){t===void 0&&(t={});const{nodeId:e}=t,r=vGe({...t,elements:{reference:null,floating:null,...t.elements}}),n=t.rootContext||r,i=n.elements,[s,a]=ie.useState(null),[o,u]=ie.useState(null),f=i?.domReference||s,g=ie.useRef(null),m=pGe();dR(()=>{f&&(g.current=f)},[f]);const v=rGe({...t,elements:{...i,...o&&{reference:o}}}),w=ie.useCallback(T=>{const D=zs(T)?{getBoundingClientRect:()=>T.getBoundingClientRect(),getClientRects:()=>T.getClientRects(),contextElement:T}:T;u(D),v.refs.setReference(D)},[v.refs]),y=ie.useCallback(T=>{(zs(T)||T===null)&&(g.current=T,a(T)),(zs(v.refs.reference.current)||v.refs.reference.current===null||T!==null&&!zs(T))&&v.refs.setReference(T)},[v.refs]),b=ie.useMemo(()=>({...v.refs,setReference:y,setPositionReference:w,domReference:g}),[v.refs,y,w]),x=ie.useMemo(()=>({...v.elements,domReference:f}),[v.elements,f]),_=ie.useMemo(()=>({...v,...n,refs:b,elements:x,nodeId:e}),[v,b,x,e,n]);return dR(()=>{n.dataRef.current.floatingContext=_;const T=m?.nodesRef.current.find(D=>D.id===e);T&&(T.context=_)}),ie.useMemo(()=>({...v,context:_,refs:b,elements:x}),[v,b,x,_])}/*!
  react-datepicker v8.4.0
  https://github.com/Hacker0x01/react-datepicker
  Released under the MIT License.
*/var vH=function(e,r){return vH=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(n[s]=i[s])},vH(e,r)};function Gi(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");vH(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var Sr=function(){return Sr=Object.assign||function(r){for(var n,i=1,s=arguments.length;i<s;i++){n=arguments[i];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(r[a]=n[a])}return r},Sr.apply(this,arguments)};function Du(t,e,r){if(r||arguments.length===2)for(var n=0,i=e.length,s;n<i;n++)(s||!(n in e))&&(s||(s=Array.prototype.slice.call(e,0,n)),s[n]=e[n]);return t.concat(s||Array.prototype.slice.call(e))}var yGe=function(t){var e=t.showTimeSelectOnly,r=e===void 0?!1:e,n=t.showTime,i=n===void 0?!1:n,s=t.className,a=t.children,o=r?"Choose Time":"Choose Date".concat(i?" and Time":"");return Ie.createElement("div",{className:s,role:"dialog","aria-label":o,"aria-modal":"true"},a)},SGe=function(t,e){var r=ie.useRef(null),n=ie.useRef(t);n.current=t;var i=ie.useCallback(function(s){var a,o=s.composed&&s.composedPath&&s.composedPath().find(function(u){return u instanceof Node})||s.target;r.current&&!r.current.contains(o)&&(e&&o instanceof HTMLElement&&o.classList.contains(e)||(a=n.current)===null||a===void 0||a.call(n,s))},[e]);return ie.useEffect(function(){return document.addEventListener("mousedown",i),function(){document.removeEventListener("mousedown",i)}},[i]),r},jT=function(t){var e=t.children,r=t.onClickOutside,n=t.className,i=t.containerRef,s=t.style,a=t.ignoreClass,o=SGe(r,a);return Ie.createElement("div",{className:n,style:s,ref:function(u){o.current=u,i&&(i.current=u)}},e)},rt;(function(t){t.ArrowUp="ArrowUp",t.ArrowDown="ArrowDown",t.ArrowLeft="ArrowLeft",t.ArrowRight="ArrowRight",t.PageUp="PageUp",t.PageDown="PageDown",t.Home="Home",t.End="End",t.Enter="Enter",t.Space=" ",t.Tab="Tab",t.Escape="Escape",t.Backspace="Backspace",t.X="x"})(rt||(rt={}));function vie(){var t=typeof window<"u"?window:globalThis;return t}var KS=12;function Fr(t){if(t==null)return new Date;var e=typeof t=="string"?LYe(t):gt(t);return YT(e)?e:new Date}function kI(t,e,r,n,i){i===void 0&&(i=Fr());for(var s=Gp(r)||Gp($B()),a=Array.isArray(e)?e:[e],o=0,u=a;o<u.length;o++){var c=u[o],f=DYe(t,c,i,{locale:s});if(YT(f)&&(!n||t===bn(f,c,r)))return f}return null}function YT(t,e){return sR(t)&&!Kg(t,new Date("1/1/1800"))}function bn(t,e,r){if(r==="en")return mq(t,e,{useAdditionalWeekYearTokens:!0,useAdditionalDayOfYearTokens:!0});var n=r?Gp(r):void 0;return r&&!n&&console.warn('A locale object was not found for the provided string ["'.concat(r,'"].')),n=n||Gp($B()),mq(t,e,{locale:n,useAdditionalWeekYearTokens:!0,useAdditionalDayOfYearTokens:!0})}function Do(t,e){var r=e.dateFormat,n=e.locale,i=Array.isArray(r)&&r.length>0?r[0]:r;return t&&bn(t,i,n)||""}var wie=" - ";function bGe(t,e,r){if(!t)return"";var n=Do(t,r),i=e?Do(e,r):"";return"".concat(n).concat(wie).concat(i)}function CGe(t,e){if(!t?.length)return"";var r=t[0]?Do(t[0],e):"";if(t.length===1)return r;if(t.length===2&&t[1]){var n=Do(t[1],e);return"".concat(r,", ").concat(n)}var i=t.length-1;return"".concat(r," (+").concat(i,")")}function DI(t,e){var r=e.hour,n=r===void 0?0:r,i=e.minute,s=i===void 0?0:i,a=e.second,o=a===void 0?0:a;return NE(HE(FE(t,o),s),n)}function xGe(t){return DB(t)}function EGe(t,e){return bn(t,"ddd",e)}function BE(t){return qg(t)}function Hf(t,e,r){var n=Gp(e||$B());return sh(t,{locale:n,weekStartsOn:r})}function Jc(t){return qne(t)}function Oy(t){return BT(t)}function Mq(t){return fH(t)}function Aq(){return qg(Fr())}function Oq(t){return zne(t)}function _Ge(t){return B9e(t)}function RGe(t){return Gne(t)}function Cu(t,e){return t&&e?HYe(t,e):!t&&!e}function Us(t,e){return t&&e?IYe(t,e):!t&&!e}function mR(t,e){return t&&e?NYe(t,e):!t&&!e}function yr(t,e){return t&&e?F9e(t,e):!t&&!e}function xg(t,e){return t&&e?F7e(t,e):!t&&!e}function ky(t,e,r){var n,i=qg(e),s=zne(r);try{n=tS(t,{start:i,end:s})}catch{n=!1}return n}function $B(){var t=vie();return t.__localeId__}function Gp(t){if(typeof t=="string"){var e=vie();return e.__localeData__?e.__localeData__[t]:void 0}else return t}function TGe(t,e,r){return e(bn(t,"EEEE",r))}function MGe(t,e){return bn(t,"EEEEEE",e)}function AGe(t,e){return bn(t,"EEE",e)}function UB(t,e){return bn(Io(Fr(),t),"LLLL",e)}function yie(t,e){return bn(Io(Fr(),t),"LLL",e)}function OGe(t,e){return bn(J0(Fr(),t),"QQQ",e)}function Fo(t,e){var r=e===void 0?{}:e,n=r.minDate,i=r.maxDate,s=r.excludeDates,a=r.excludeDateIntervals,o=r.includeDates,u=r.includeDateIntervals,c=r.filterDate;return XS(t,{minDate:n,maxDate:i})||s&&s.some(function(f){return f instanceof Date?yr(t,f):yr(t,f.date)})||a&&a.some(function(f){var g=f.start,m=f.end;return tS(t,{start:g,end:m})})||o&&!o.some(function(f){return yr(t,f)})||u&&!u.some(function(f){var g=f.start,m=f.end;return tS(t,{start:g,end:m})})||c&&!c(Fr(t))||!1}function jB(t,e){var r=e===void 0?{}:e,n=r.excludeDates,i=r.excludeDateIntervals;return i&&i.length>0?i.some(function(s){var a=s.start,o=s.end;return tS(t,{start:a,end:o})}):n&&n.some(function(s){var a;return s instanceof Date?yr(t,s):yr(t,(a=s.date)!==null&&a!==void 0?a:new Date)})||!1}function Sie(t,e){var r=e===void 0?{}:e,n=r.minDate,i=r.maxDate,s=r.excludeDates,a=r.includeDates,o=r.filterDate;return XS(t,{minDate:n?qne(n):void 0,maxDate:i?Gne(i):void 0})||s?.some(function(u){return Us(t,u instanceof Date?u:u.date)})||a&&!a.some(function(u){return Us(t,u)})||o&&!o(Fr(t))||!1}function rE(t,e,r,n){var i=qt(t),s=Es(t),a=qt(e),o=Es(e),u=qt(n);return i===a&&i===u?s<=r&&r<=o:i<a?u===i&&s<=r||u===a&&o>=r||u<a&&u>i:!1}function kGe(t,e){var r=e===void 0?{}:e,n=r.minDate,i=r.maxDate,s=r.excludeDates,a=r.includeDates;return XS(t,{minDate:n,maxDate:i})||s&&s.some(function(o){return Us(o instanceof Date?o:o.date,t)})||a&&!a.some(function(o){return Us(o,t)})||!1}function nE(t,e){var r=e===void 0?{}:e,n=r.minDate,i=r.maxDate,s=r.excludeDates,a=r.includeDates,o=r.filterDate;return XS(t,{minDate:n,maxDate:i})||s?.some(function(u){return mR(t,u instanceof Date?u:u.date)})||a&&!a.some(function(u){return mR(t,u)})||o&&!o(Fr(t))||!1}function iE(t,e,r){if(!e||!r||!sR(e)||!sR(r))return!1;var n=qt(e),i=qt(r);return n<=t&&i>=t}function VE(t,e){var r=e===void 0?{}:e,n=r.minDate,i=r.maxDate,s=r.excludeDates,a=r.includeDates,o=r.filterDate,u=new Date(t,0,1);return XS(u,{minDate:n?BT(n):void 0,maxDate:i?Kne(i):void 0})||s?.some(function(c){return Cu(u,c instanceof Date?c:c.date)})||a&&!a.some(function(c){return Cu(u,c)})||o&&!o(Fr(u))||!1}function sE(t,e,r,n){var i=qt(t),s=Og(t),a=qt(e),o=Og(e),u=qt(n);return i===a&&i===u?s<=r&&r<=o:i<a?u===i&&s<=r||u===a&&o>=r||u<a&&u>i:!1}function XS(t,e){var r,n=e===void 0?{}:e,i=n.minDate,s=n.maxDate;return(r=i&&$p(t,i)<0||s&&$p(t,s)>0)!==null&&r!==void 0?r:!1}function kq(t,e){return e.some(function(r){return Qc(r)===Qc(t)&&Zc(r)===Zc(t)&&Nf(r)===Nf(t)})}function Dq(t,e){var r=e===void 0?{}:e,n=r.excludeTimes,i=r.includeTimes,s=r.filterTime;return n&&kq(t,n)||i&&!kq(t,i)||s&&!s(t)||!1}function Pq(t,e){var r=e.minTime,n=e.maxTime;if(!r||!n)throw new Error("Both minTime and maxTime props required");var i=Fr();i=NE(i,Qc(t)),i=HE(i,Zc(t)),i=FE(i,Nf(t));var s=Fr();s=NE(s,Qc(r)),s=HE(s,Zc(r)),s=FE(s,Nf(r));var a=Fr();a=NE(a,Qc(n)),a=HE(a,Zc(n)),a=FE(a,Nf(n));var o;try{o=!tS(i,{start:s,end:a})}catch{o=!1}return o}function Iq(t,e){var r=e===void 0?{}:e,n=r.minDate,i=r.includeDates,s=kg(t,1);return n&&aR(n,s)>0||i&&i.every(function(a){return aR(a,s)>0})||!1}function Nq(t,e){var r=e===void 0?{}:e,n=r.maxDate,i=r.includeDates,s=Hl(t,1);return n&&aR(s,n)>0||i&&i.every(function(a){return aR(s,a)>0})||!1}function DGe(t,e){var r=e===void 0?{}:e,n=r.minDate,i=r.includeDates,s=BT(t),a=sie(s);return n&&oR(n,a)>0||i&&i.every(function(o){return oR(o,a)>0})||!1}function PGe(t,e){var r=e===void 0?{}:e,n=r.maxDate,i=r.includeDates,s=Kne(t),a=kB(s,1);return n&&oR(a,n)>0||i&&i.every(function(o){return oR(a,o)>0})||!1}function Hq(t,e){var r=e===void 0?{}:e,n=r.minDate,i=r.includeDates,s=Up(t,1);return n&&lR(n,s)>0||i&&i.every(function(a){return lR(a,s)>0})||!1}function IGe(t,e){var r=e===void 0?{}:e,n=r.minDate,i=r.yearItemNumber,s=i===void 0?KS:i,a=Oy(Up(t,s)),o=Af(a,s).endPeriod,u=n&&qt(n);return u&&u>o||!1}function Fq(t,e){var r=e===void 0?{}:e,n=r.maxDate,i=r.includeDates,s=Kc(t,1);return n&&lR(s,n)>0||i&&i.every(function(a){return lR(s,a)>0})||!1}function NGe(t,e){var r=e===void 0?{}:e,n=r.maxDate,i=r.yearItemNumber,s=i===void 0?KS:i,a=Kc(t,s),o=Af(a,s).startPeriod,u=n&&qt(n);return u&&u<o||!1}function bie(t){var e=t.minDate,r=t.includeDates;if(r&&e){var n=r.filter(function(i){return $p(i,e)>=0});return uq(n)}else return r?uq(r):e}function Cie(t){var e=t.maxDate,r=t.includeDates;if(r&&e){var n=r.filter(function(i){return $p(i,e)<=0});return lq(n)}else return r?lq(r):e}function Lq(t,e){var r;t===void 0&&(t=[]),e===void 0&&(e="react-datepicker__day--highlighted");for(var n=new Map,i=0,s=t.length;i<s;i++){var a=t[i];if(Xc(a)){var o=bn(a,"MM.dd.yyyy"),u=n.get(o)||[];u.includes(e)||(u.push(e),n.set(o,u))}else if(typeof a=="object"){var c=Object.keys(a),f=(r=c[0])!==null&&r!==void 0?r:"",g=a[f];if(typeof f=="string"&&Array.isArray(g))for(var m=0,v=g.length;m<v;m++){var w=g[m];if(w){var o=bn(w,"MM.dd.yyyy"),u=n.get(o)||[];u.includes(f)||(u.push(f),n.set(o,u))}}}}return n}function HGe(t,e){return t.length!==e.length?!1:t.every(function(r,n){return r===e[n]})}function FGe(t,e){t===void 0&&(t=[]),e===void 0&&(e="react-datepicker__day--holidays");var r=new Map;return t.forEach(function(n){var i=n.date,s=n.holidayName;if(Xc(i)){var a=bn(i,"MM.dd.yyyy"),o=r.get(a)||{className:"",holidayNames:[]};if(!("className"in o&&o.className===e&&HGe(o.holidayNames,[s]))){o.className=e;var u=o.holidayNames;o.holidayNames=u?Du(Du([],u,!0),[s],!1):[s],r.set(a,o)}}}),r}function LGe(t,e,r,n,i){for(var s=i.length,a=[],o=0;o<s;o++){var u=t,c=i[o];c&&(u=P9e(u,Qc(c)),u=hH(u,Zc(c)),u=H9e(u,Nf(c)));var f=hH(t,(r+1)*n);Gf(u,e)&&Kg(u,f)&&c!=null&&a.push(c)}return a}function Bq(t){return t<10?"0".concat(t):"".concat(t)}function Af(t,e){e===void 0&&(e=KS);var r=Math.ceil(qt(t)/e)*e,n=r-(e-1);return{startPeriod:n,endPeriod:r}}function BGe(t){var e=new Date(t.getFullYear(),t.getMonth(),t.getDate()),r=new Date(t.getFullYear(),t.getMonth(),t.getDate(),24);return Math.round((+r-+e)/36e5)}function Vq(t){var e=t.getSeconds(),r=t.getMilliseconds();return gt(t.getTime()-e*1e3-r)}function VGe(t,e){return Vq(t).getTime()===Vq(e).getTime()}function Wq(t){if(!Xc(t))throw new Error("Invalid date");var e=new Date(t);return e.setHours(0,0,0,0),e}function $q(t,e){if(!Xc(t)||!Xc(e))throw new Error("Invalid date received");var r=Wq(t),n=Wq(e);return Kg(r,n)}function xie(t){return t.key===rt.Space}var WGe=function(t){Gi(e,t);function e(r){var n=t.call(this,r)||this;return n.inputRef=Ie.createRef(),n.onTimeChange=function(i){var s,a;n.setState({time:i});var o=n.props.date,u=o instanceof Date&&!isNaN(+o),c=u?o:new Date;if(i?.includes(":")){var f=i.split(":"),g=f[0],m=f[1];c.setHours(Number(g)),c.setMinutes(Number(m))}(a=(s=n.props).onChange)===null||a===void 0||a.call(s,c)},n.renderTimeInput=function(){var i=n.state.time,s=n.props,a=s.date,o=s.timeString,u=s.customTimeInput;return u?ie.cloneElement(u,{date:a,value:i,onChange:n.onTimeChange}):Ie.createElement("input",{type:"time",className:"react-datepicker-time__input",placeholder:"Time",name:"time-input",ref:n.inputRef,onClick:function(){var c;(c=n.inputRef.current)===null||c===void 0||c.focus()},required:!0,value:i,onChange:function(c){n.onTimeChange(c.target.value||o)}})},n.state={time:n.props.timeString},n}return e.getDerivedStateFromProps=function(r,n){return r.timeString!==n.time?{time:r.timeString}:null},e.prototype.render=function(){return Ie.createElement("div",{className:"react-datepicker__input-time-container"},Ie.createElement("div",{className:"react-datepicker-time__caption"},this.props.timeInputLabel),Ie.createElement("div",{className:"react-datepicker-time__input-container"},Ie.createElement("div",{className:"react-datepicker-time__input"},this.renderTimeInput())))},e}(ie.Component),$Ge=function(t){Gi(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.dayEl=ie.createRef(),r.handleClick=function(n){!r.isDisabled()&&r.props.onClick&&r.props.onClick(n)},r.handleMouseEnter=function(n){!r.isDisabled()&&r.props.onMouseEnter&&r.props.onMouseEnter(n)},r.handleOnKeyDown=function(n){var i,s,a=n.key;a===rt.Space&&(n.preventDefault(),n.key=rt.Enter),(s=(i=r.props).handleOnKeyDown)===null||s===void 0||s.call(i,n)},r.isSameDay=function(n){return yr(r.props.day,n)},r.isKeyboardSelected=function(){var n;if(r.props.disabledKeyboardNavigation)return!1;var i=r.props.selectsMultiple?(n=r.props.selectedDates)===null||n===void 0?void 0:n.some(function(a){return r.isSameDayOrWeek(a)}):r.isSameDayOrWeek(r.props.selected),s=r.props.preSelection&&r.isDisabled(r.props.preSelection);return!i&&r.isSameDayOrWeek(r.props.preSelection)&&!s},r.isDisabled=function(n){return n===void 0&&(n=r.props.day),Fo(n,{minDate:r.props.minDate,maxDate:r.props.maxDate,excludeDates:r.props.excludeDates,excludeDateIntervals:r.props.excludeDateIntervals,includeDateIntervals:r.props.includeDateIntervals,includeDates:r.props.includeDates,filterDate:r.props.filterDate})},r.isExcluded=function(){return jB(r.props.day,{excludeDates:r.props.excludeDates,excludeDateIntervals:r.props.excludeDateIntervals})},r.isStartOfWeek=function(){return yr(r.props.day,Hf(r.props.day,r.props.locale,r.props.calendarStartDay))},r.isSameWeek=function(n){return r.props.showWeekPicker&&yr(n,Hf(r.props.day,r.props.locale,r.props.calendarStartDay))},r.isSameDayOrWeek=function(n){return r.isSameDay(n)||r.isSameWeek(n)},r.getHighLightedClass=function(){var n=r.props,i=n.day,s=n.highlightDates;if(!s)return!1;var a=bn(i,"MM.dd.yyyy");return s.get(a)},r.getHolidaysClass=function(){var n,i=r.props,s=i.day,a=i.holidays;if(!a)return[void 0];var o=bn(s,"MM.dd.yyyy");return a.has(o)?[(n=a.get(o))===null||n===void 0?void 0:n.className]:[void 0]},r.isInRange=function(){var n=r.props,i=n.day,s=n.startDate,a=n.endDate;return!s||!a?!1:ky(i,s,a)},r.isInSelectingRange=function(){var n,i=r.props,s=i.day,a=i.selectsStart,o=i.selectsEnd,u=i.selectsRange,c=i.selectsDisabledDaysInRange,f=i.startDate,g=i.endDate,m=(n=r.props.selectingDate)!==null&&n!==void 0?n:r.props.preSelection;return!(a||o||u)||!m||!c&&r.isDisabled()?!1:a&&g&&(Kg(m,g)||xg(m,g))?ky(s,m,g):o&&f&&(Gf(m,f)||xg(m,f))||u&&f&&!g&&(Gf(m,f)||xg(m,f))?ky(s,f,m):!1},r.isSelectingRangeStart=function(){var n;if(!r.isInSelectingRange())return!1;var i=r.props,s=i.day,a=i.startDate,o=i.selectsStart,u=(n=r.props.selectingDate)!==null&&n!==void 0?n:r.props.preSelection;return o?yr(s,u):yr(s,a)},r.isSelectingRangeEnd=function(){var n;if(!r.isInSelectingRange())return!1;var i=r.props,s=i.day,a=i.endDate,o=i.selectsEnd,u=i.selectsRange,c=(n=r.props.selectingDate)!==null&&n!==void 0?n:r.props.preSelection;return o||u?yr(s,c):yr(s,a)},r.isRangeStart=function(){var n=r.props,i=n.day,s=n.startDate,a=n.endDate;return!s||!a?!1:yr(s,i)},r.isRangeEnd=function(){var n=r.props,i=n.day,s=n.startDate,a=n.endDate;return!s||!a?!1:yr(a,i)},r.isWeekend=function(){var n=P7e(r.props.day);return n===0||n===6},r.isAfterMonth=function(){return r.props.month!==void 0&&(r.props.month+1)%12===Es(r.props.day)},r.isBeforeMonth=function(){return r.props.month!==void 0&&(Es(r.props.day)+1)%12===r.props.month},r.isCurrentDay=function(){return r.isSameDay(Fr())},r.isSelected=function(){var n;return r.props.selectsMultiple?(n=r.props.selectedDates)===null||n===void 0?void 0:n.some(function(i){return r.isSameDayOrWeek(i)}):r.isSameDayOrWeek(r.props.selected)},r.getClassNames=function(n){var i=r.props.dayClassName?r.props.dayClassName(n):void 0;return ss("react-datepicker__day",i,"react-datepicker__day--"+EGe(r.props.day),{"react-datepicker__day--disabled":r.isDisabled(),"react-datepicker__day--excluded":r.isExcluded(),"react-datepicker__day--selected":r.isSelected(),"react-datepicker__day--keyboard-selected":r.isKeyboardSelected(),"react-datepicker__day--range-start":r.isRangeStart(),"react-datepicker__day--range-end":r.isRangeEnd(),"react-datepicker__day--in-range":r.isInRange(),"react-datepicker__day--in-selecting-range":r.isInSelectingRange(),"react-datepicker__day--selecting-range-start":r.isSelectingRangeStart(),"react-datepicker__day--selecting-range-end":r.isSelectingRangeEnd(),"react-datepicker__day--today":r.isCurrentDay(),"react-datepicker__day--weekend":r.isWeekend(),"react-datepicker__day--outside-month":r.isAfterMonth()||r.isBeforeMonth()},r.getHighLightedClass(),r.getHolidaysClass())},r.getAriaLabel=function(){var n=r.props,i=n.day,s=n.ariaLabelPrefixWhenEnabled,a=s===void 0?"Choose":s,o=n.ariaLabelPrefixWhenDisabled,u=o===void 0?"Not available":o,c=r.isDisabled()||r.isExcluded()?u:a;return"".concat(c," ").concat(bn(i,"PPPP",r.props.locale))},r.getTitle=function(){var n=r.props,i=n.day,s=n.holidays,a=s===void 0?new Map:s,o=n.excludeDates,u=bn(i,"MM.dd.yyyy"),c=[];return a.has(u)&&c.push.apply(c,a.get(u).holidayNames),r.isExcluded()&&c.push(o?.filter(function(f){return f instanceof Date?yr(f,i):yr(f?.date,i)}).map(function(f){if(!(f instanceof Date))return f?.message})),c.join(", ")},r.getTabIndex=function(){var n=r.props.selected,i=r.props.preSelection,s=!(r.props.showWeekPicker&&(r.props.showWeekNumber||!r.isStartOfWeek()))&&(r.isKeyboardSelected()||r.isSameDay(n)&&yr(i,n))?0:-1;return s},r.handleFocusDay=function(){var n;r.shouldFocusDay()&&((n=r.dayEl.current)===null||n===void 0||n.focus({preventScroll:!0}))},r.renderDayContents=function(){return r.props.monthShowsDuplicateDaysEnd&&r.isAfterMonth()||r.props.monthShowsDuplicateDaysStart&&r.isBeforeMonth()?null:r.props.renderDayContents?r.props.renderDayContents(pq(r.props.day),r.props.day):pq(r.props.day)},r.render=function(){return Ie.createElement("div",{ref:r.dayEl,className:r.getClassNames(r.props.day),onKeyDown:r.handleOnKeyDown,onClick:r.handleClick,onMouseEnter:r.props.usePointerEvent?void 0:r.handleMouseEnter,onPointerEnter:r.props.usePointerEvent?r.handleMouseEnter:void 0,tabIndex:r.getTabIndex(),"aria-label":r.getAriaLabel(),role:"option",title:r.getTitle(),"aria-disabled":r.isDisabled(),"aria-current":r.isCurrentDay()?"date":void 0,"aria-selected":r.isSelected()||r.isInRange()},r.renderDayContents(),r.getTitle()!==""&&Ie.createElement("span",{className:"overlay"},r.getTitle()))},r}return e.prototype.componentDidMount=function(){this.handleFocusDay()},e.prototype.componentDidUpdate=function(){this.handleFocusDay()},e.prototype.shouldFocusDay=function(){var r=!1;return this.getTabIndex()===0&&this.isSameDay(this.props.preSelection)&&((!document.activeElement||document.activeElement===document.body)&&(r=!0),this.props.inline&&!this.props.shouldFocusDayInline&&(r=!1),this.isDayActiveElement()&&(r=!0),this.isDuplicateDay()&&(r=!1)),r},e.prototype.isDayActiveElement=function(){var r,n,i;return((n=(r=this.props.containerRef)===null||r===void 0?void 0:r.current)===null||n===void 0?void 0:n.contains(document.activeElement))&&((i=document.activeElement)===null||i===void 0?void 0:i.classList.contains("react-datepicker__day"))},e.prototype.isDuplicateDay=function(){return this.props.monthShowsDuplicateDaysEnd&&this.isAfterMonth()||this.props.monthShowsDuplicateDaysStart&&this.isBeforeMonth()},e}(ie.Component),UGe=function(t){Gi(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.weekNumberEl=ie.createRef(),r.handleClick=function(n){r.props.onClick&&r.props.onClick(n)},r.handleOnKeyDown=function(n){var i,s,a=n.key;a===rt.Space&&(n.preventDefault(),n.key=rt.Enter),(s=(i=r.props).handleOnKeyDown)===null||s===void 0||s.call(i,n)},r.isKeyboardSelected=function(){return!r.props.disabledKeyboardNavigation&&!yr(r.props.date,r.props.selected)&&yr(r.props.date,r.props.preSelection)},r.getTabIndex=function(){return r.props.showWeekPicker&&r.props.showWeekNumber&&(r.isKeyboardSelected()||yr(r.props.date,r.props.selected)&&yr(r.props.preSelection,r.props.selected))?0:-1},r.handleFocusWeekNumber=function(n){var i=!1;r.getTabIndex()===0&&!n?.isInputFocused&&yr(r.props.date,r.props.preSelection)&&((!document.activeElement||document.activeElement===document.body)&&(i=!0),r.props.inline&&!r.props.shouldFocusDayInline&&(i=!1),r.props.containerRef&&r.props.containerRef.current&&r.props.containerRef.current.contains(document.activeElement)&&document.activeElement&&document.activeElement.classList.contains("react-datepicker__week-number")&&(i=!0)),i&&r.weekNumberEl.current&&r.weekNumberEl.current.focus({preventScroll:!0})},r}return Object.defineProperty(e,"defaultProps",{get:function(){return{ariaLabelPrefix:"week "}},enumerable:!1,configurable:!0}),e.prototype.componentDidMount=function(){this.handleFocusWeekNumber()},e.prototype.componentDidUpdate=function(r){this.handleFocusWeekNumber(r)},e.prototype.render=function(){var r=this.props,n=r.weekNumber,i=r.isWeekDisabled,s=r.ariaLabelPrefix,a=s===void 0?e.defaultProps.ariaLabelPrefix:s,o=r.onClick,u={"react-datepicker__week-number":!0,"react-datepicker__week-number--clickable":!!o&&!i,"react-datepicker__week-number--selected":!!o&&yr(this.props.date,this.props.selected)};return Ie.createElement("div",{ref:this.weekNumberEl,className:ss(u),"aria-label":"".concat(a," ").concat(this.props.weekNumber),onClick:this.handleClick,onKeyDown:this.handleOnKeyDown,tabIndex:this.getTabIndex()},n)},e}(ie.Component),jGe=function(t){Gi(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.isDisabled=function(n){return Fo(n,{minDate:r.props.minDate,maxDate:r.props.maxDate,excludeDates:r.props.excludeDates,excludeDateIntervals:r.props.excludeDateIntervals,includeDateIntervals:r.props.includeDateIntervals,includeDates:r.props.includeDates,filterDate:r.props.filterDate})},r.handleDayClick=function(n,i){r.props.onDayClick&&r.props.onDayClick(n,i)},r.handleDayMouseEnter=function(n){r.props.onDayMouseEnter&&r.props.onDayMouseEnter(n)},r.handleWeekClick=function(n,i,s){for(var a,o,u,c=new Date(n),f=0;f<7;f++){var g=new Date(n);g.setDate(g.getDate()+f);var m=!r.isDisabled(g);if(m){c=g;break}}typeof r.props.onWeekSelect=="function"&&r.props.onWeekSelect(c,i,s),r.props.showWeekPicker&&r.handleDayClick(c,s),((a=r.props.shouldCloseOnSelect)!==null&&a!==void 0?a:e.defaultProps.shouldCloseOnSelect)&&((u=(o=r.props).setOpen)===null||u===void 0||u.call(o,!1))},r.formatWeekNumber=function(n){return r.props.formatWeekNumber?r.props.formatWeekNumber(n):xGe(n)},r.isWeekDisabled=function(){for(var n=r.startOfWeek(),i=kl(n,6),s=new Date(n);s<=i;){if(!r.isDisabled(s))return!1;s=kl(s,1)}return!0},r.renderDays=function(){var n=r.startOfWeek(),i=[],s=r.formatWeekNumber(n);if(r.props.showWeekNumber){var a=r.props.onWeekSelect||r.props.showWeekPicker?r.handleWeekClick.bind(r,n,s):void 0;i.push(Ie.createElement(UGe,Sr({key:"W"},e.defaultProps,r.props,{weekNumber:s,isWeekDisabled:r.isWeekDisabled(),date:n,onClick:a})))}return i.concat([0,1,2,3,4,5,6].map(function(o){var u=kl(n,o);return Ie.createElement($Ge,Sr({},e.defaultProps,r.props,{ariaLabelPrefixWhenEnabled:r.props.chooseDayAriaLabelPrefix,ariaLabelPrefixWhenDisabled:r.props.disabledDayAriaLabelPrefix,key:u.valueOf(),day:u,onClick:r.handleDayClick.bind(r,u),onMouseEnter:r.handleDayMouseEnter.bind(r,u)}))}))},r.startOfWeek=function(){return Hf(r.props.day,r.props.locale,r.props.calendarStartDay)},r.isKeyboardSelected=function(){return!r.props.disabledKeyboardNavigation&&!yr(r.startOfWeek(),r.props.selected)&&yr(r.startOfWeek(),r.props.preSelection)},r}return Object.defineProperty(e,"defaultProps",{get:function(){return{shouldCloseOnSelect:!0}},enumerable:!1,configurable:!0}),e.prototype.render=function(){var r={"react-datepicker__week":!0,"react-datepicker__week--selected":yr(this.startOfWeek(),this.props.selected),"react-datepicker__week--keyboard-selected":this.isKeyboardSelected()};return Ie.createElement("div",{className:ss(r)},this.renderDays())},e}(ie.Component),wy,YGe=6,Ep={TWO_COLUMNS:"two_columns",THREE_COLUMNS:"three_columns",FOUR_COLUMNS:"four_columns"},PI=(wy={},wy[Ep.TWO_COLUMNS]={grid:[[0,1],[2,3],[4,5],[6,7],[8,9],[10,11]],verticalNavigationOffset:2},wy[Ep.THREE_COLUMNS]={grid:[[0,1,2],[3,4,5],[6,7,8],[9,10,11]],verticalNavigationOffset:3},wy[Ep.FOUR_COLUMNS]={grid:[[0,1,2,3],[4,5,6,7],[8,9,10,11]],verticalNavigationOffset:4},wy),aE=1;function Uq(t,e){return t?Ep.FOUR_COLUMNS:e?Ep.TWO_COLUMNS:Ep.THREE_COLUMNS}var zGe=function(t){Gi(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.MONTH_REFS=Du([],Array(12),!0).map(function(){return ie.createRef()}),r.QUARTER_REFS=Du([],Array(4),!0).map(function(){return ie.createRef()}),r.isDisabled=function(n){return Fo(n,{minDate:r.props.minDate,maxDate:r.props.maxDate,excludeDates:r.props.excludeDates,excludeDateIntervals:r.props.excludeDateIntervals,includeDateIntervals:r.props.includeDateIntervals,includeDates:r.props.includeDates,filterDate:r.props.filterDate})},r.isExcluded=function(n){return jB(n,{excludeDates:r.props.excludeDates,excludeDateIntervals:r.props.excludeDateIntervals})},r.handleDayClick=function(n,i){var s,a;(a=(s=r.props).onDayClick)===null||a===void 0||a.call(s,n,i,r.props.orderInDisplay)},r.handleDayMouseEnter=function(n){var i,s;(s=(i=r.props).onDayMouseEnter)===null||s===void 0||s.call(i,n)},r.handleMouseLeave=function(){var n,i;(i=(n=r.props).onMouseLeave)===null||i===void 0||i.call(n)},r.isRangeStartMonth=function(n){var i=r.props,s=i.day,a=i.startDate,o=i.endDate;return!a||!o?!1:Us(Io(s,n),a)},r.isRangeStartQuarter=function(n){var i=r.props,s=i.day,a=i.startDate,o=i.endDate;return!a||!o?!1:mR(J0(s,n),a)},r.isRangeEndMonth=function(n){var i=r.props,s=i.day,a=i.startDate,o=i.endDate;return!a||!o?!1:Us(Io(s,n),o)},r.isRangeEndQuarter=function(n){var i=r.props,s=i.day,a=i.startDate,o=i.endDate;return!a||!o?!1:mR(J0(s,n),o)},r.isInSelectingRangeMonth=function(n){var i,s=r.props,a=s.day,o=s.selectsStart,u=s.selectsEnd,c=s.selectsRange,f=s.startDate,g=s.endDate,m=(i=r.props.selectingDate)!==null&&i!==void 0?i:r.props.preSelection;return!(o||u||c)||!m?!1:o&&g?rE(m,g,n,a):u&&f||c&&f&&!g?rE(f,m,n,a):!1},r.isSelectingMonthRangeStart=function(n){var i;if(!r.isInSelectingRangeMonth(n))return!1;var s=r.props,a=s.day,o=s.startDate,u=s.selectsStart,c=Io(a,n),f=(i=r.props.selectingDate)!==null&&i!==void 0?i:r.props.preSelection;return u?Us(c,f):Us(c,o)},r.isSelectingMonthRangeEnd=function(n){var i;if(!r.isInSelectingRangeMonth(n))return!1;var s=r.props,a=s.day,o=s.endDate,u=s.selectsEnd,c=s.selectsRange,f=Io(a,n),g=(i=r.props.selectingDate)!==null&&i!==void 0?i:r.props.preSelection;return u||c?Us(f,g):Us(f,o)},r.isInSelectingRangeQuarter=function(n){var i,s=r.props,a=s.day,o=s.selectsStart,u=s.selectsEnd,c=s.selectsRange,f=s.startDate,g=s.endDate,m=(i=r.props.selectingDate)!==null&&i!==void 0?i:r.props.preSelection;return!(o||u||c)||!m?!1:o&&g?sE(m,g,n,a):u&&f||c&&f&&!g?sE(f,m,n,a):!1},r.isWeekInMonth=function(n){var i=r.props.day,s=kl(n,6);return Us(n,i)||Us(s,i)},r.isCurrentMonth=function(n,i){return qt(n)===qt(Fr())&&i===Es(Fr())},r.isCurrentQuarter=function(n,i){return qt(n)===qt(Fr())&&i===Og(Fr())},r.isSelectedMonth=function(n,i,s){return Es(s)===i&&qt(n)===qt(s)},r.isSelectMonthInList=function(n,i,s){return s.some(function(a){return r.isSelectedMonth(n,i,a)})},r.isSelectedQuarter=function(n,i,s){return Og(n)===i&&qt(n)===qt(s)},r.isMonthSelected=function(){var n=r.props,i=n.day,s=n.selected,a=n.selectedDates,o=n.selectsMultiple,u=Es(i);return o?a?.some(function(c){return r.isSelectedMonth(i,u,c)}):!!s&&r.isSelectedMonth(i,u,s)},r.renderWeeks=function(){for(var n=[],i=r.props.fixedHeight,s=0,a=!1,o=Hf(Jc(r.props.day),r.props.locale,r.props.calendarStartDay),u=function(w){return r.props.showWeekPicker?Hf(w,r.props.locale,r.props.calendarStartDay):r.props.preSelection},c=function(w){return r.props.showWeekPicker?Hf(w,r.props.locale,r.props.calendarStartDay):r.props.selected},f=r.props.selected?c(r.props.selected):void 0,g=r.props.preSelection?u(r.props.preSelection):void 0;n.push(Ie.createElement(jGe,Sr({},r.props,{ariaLabelPrefix:r.props.weekAriaLabelPrefix,key:s,day:o,month:Es(r.props.day),onDayClick:r.handleDayClick,onDayMouseEnter:r.handleDayMouseEnter,selected:f,preSelection:g,showWeekNumber:r.props.showWeekNumbers}))),!a;){s++,o=iR(o,1);var m=i&&s>=YGe,v=!i&&!r.isWeekInMonth(o);if(m||v)if(r.props.peekNextMonth)a=!0;else break}return n},r.onMonthClick=function(n,i){var s=r.isMonthDisabledForLabelDate(i),a=s.isDisabled,o=s.labelDate;a||r.handleDayClick(Jc(o),n)},r.onMonthMouseEnter=function(n){var i=r.isMonthDisabledForLabelDate(n),s=i.isDisabled,a=i.labelDate;s||r.handleDayMouseEnter(Jc(a))},r.handleMonthNavigation=function(n,i){var s,a,o,u;(a=(s=r.props).setPreSelection)===null||a===void 0||a.call(s,i),(u=(o=r.MONTH_REFS[n])===null||o===void 0?void 0:o.current)===null||u===void 0||u.focus()},r.handleKeyboardNavigation=function(n,i,s){var a,o=r.props,u=o.selected,c=o.preSelection,f=o.setPreSelection,g=o.minDate,m=o.maxDate,v=o.showFourColumnMonthYearPicker,w=o.showTwoColumnMonthYearPicker;if(c){var y=Uq(v,w),b=r.getVerticalOffset(y),x=(a=PI[y])===null||a===void 0?void 0:a.grid,_=function(A,W,L){var H,J,G=W,ve=L;switch(A){case rt.ArrowRight:G=Hl(W,aE),ve=L===11?0:L+aE;break;case rt.ArrowLeft:G=kg(W,aE),ve=L===0?11:L-aE;break;case rt.ArrowUp:G=kg(W,b),ve=!((H=x?.[0])===null||H===void 0)&&H.includes(L)?L+12-b:L-b;break;case rt.ArrowDown:G=Hl(W,b),ve=!((J=x?.[x.length-1])===null||J===void 0)&&J.includes(L)?L-12+b:L+b;break}return{newCalculatedDate:G,newCalculatedMonth:ve}},T=function(A,W,L){for(var H=40,J=A,G=!1,ve=0,be=_(J,W,L),we=be.newCalculatedDate,ae=be.newCalculatedMonth;!G;){if(ve>=H){we=W,ae=L;break}if(g&&we<g){J=rt.ArrowRight;var le=_(J,we,ae);we=le.newCalculatedDate,ae=le.newCalculatedMonth}if(m&&we>m){J=rt.ArrowLeft;var le=_(J,we,ae);we=le.newCalculatedDate,ae=le.newCalculatedMonth}if(kGe(we,r.props)){var le=_(J,we,ae);we=le.newCalculatedDate,ae=le.newCalculatedMonth}else G=!0;ve++}return{newCalculatedDate:we,newCalculatedMonth:ae}};if(i===rt.Enter){r.isMonthDisabled(s)||(r.onMonthClick(n,s),f?.(u));return}var D=T(i,c,s),P=D.newCalculatedDate,O=D.newCalculatedMonth;switch(i){case rt.ArrowRight:case rt.ArrowLeft:case rt.ArrowUp:case rt.ArrowDown:r.handleMonthNavigation(O,P);break}}},r.getVerticalOffset=function(n){var i,s;return(s=(i=PI[n])===null||i===void 0?void 0:i.verticalNavigationOffset)!==null&&s!==void 0?s:0},r.onMonthKeyDown=function(n,i){var s=r.props,a=s.disabledKeyboardNavigation,o=s.handleOnMonthKeyDown,u=n.key;u!==rt.Tab&&n.preventDefault(),a||r.handleKeyboardNavigation(n,u,i),o&&o(n)},r.onQuarterClick=function(n,i){var s=J0(r.props.day,i);nE(s,r.props)||r.handleDayClick(Mq(s),n)},r.onQuarterMouseEnter=function(n){var i=J0(r.props.day,n);nE(i,r.props)||r.handleDayMouseEnter(Mq(i))},r.handleQuarterNavigation=function(n,i){var s,a,o,u;r.isDisabled(i)||r.isExcluded(i)||((a=(s=r.props).setPreSelection)===null||a===void 0||a.call(s,i),(u=(o=r.QUARTER_REFS[n-1])===null||o===void 0?void 0:o.current)===null||u===void 0||u.focus())},r.onQuarterKeyDown=function(n,i){var s,a,o=n.key;if(!r.props.disabledKeyboardNavigation)switch(o){case rt.Enter:r.onQuarterClick(n,i),(a=(s=r.props).setPreSelection)===null||a===void 0||a.call(s,r.props.selected);break;case rt.ArrowRight:if(!r.props.preSelection)break;r.handleQuarterNavigation(i===4?1:i+1,kB(r.props.preSelection,1));break;case rt.ArrowLeft:if(!r.props.preSelection)break;r.handleQuarterNavigation(i===1?4:i-1,sie(r.props.preSelection));break}},r.isMonthDisabledForLabelDate=function(n){var i,s=r.props,a=s.day,o=s.minDate,u=s.maxDate,c=s.excludeDates,f=s.includeDates,g=Io(a,n);return{isDisabled:(i=(o||u||c||f)&&Sie(g,r.props))!==null&&i!==void 0?i:!1,labelDate:g}},r.isMonthDisabled=function(n){var i=r.isMonthDisabledForLabelDate(n).isDisabled;return i},r.getMonthClassNames=function(n){var i=r.props,s=i.day,a=i.startDate,o=i.endDate,u=i.preSelection,c=i.monthClassName,f=c?c(Io(s,n)):void 0,g=r.getSelection();return ss("react-datepicker__month-text","react-datepicker__month-".concat(n),f,{"react-datepicker__month-text--disabled":r.isMonthDisabled(n),"react-datepicker__month-text--selected":g?r.isSelectMonthInList(s,n,g):void 0,"react-datepicker__month-text--keyboard-selected":!r.props.disabledKeyboardNavigation&&u&&r.isSelectedMonth(s,n,u)&&!r.isMonthSelected()&&!r.isMonthDisabled(n),"react-datepicker__month-text--in-selecting-range":r.isInSelectingRangeMonth(n),"react-datepicker__month-text--in-range":a&&o?rE(a,o,n,s):void 0,"react-datepicker__month-text--range-start":r.isRangeStartMonth(n),"react-datepicker__month-text--range-end":r.isRangeEndMonth(n),"react-datepicker__month-text--selecting-range-start":r.isSelectingMonthRangeStart(n),"react-datepicker__month-text--selecting-range-end":r.isSelectingMonthRangeEnd(n),"react-datepicker__month-text--today":r.isCurrentMonth(s,n)})},r.getTabIndex=function(n){if(r.props.preSelection==null)return"-1";var i=Es(r.props.preSelection),s=r.isMonthDisabledForLabelDate(i).isDisabled,a=n===i&&!(s||r.props.disabledKeyboardNavigation)?"0":"-1";return a},r.getQuarterTabIndex=function(n){if(r.props.preSelection==null)return"-1";var i=Og(r.props.preSelection),s=nE(r.props.day,r.props),a=n===i&&!(s||r.props.disabledKeyboardNavigation)?"0":"-1";return a},r.getAriaLabel=function(n){var i=r.props,s=i.chooseDayAriaLabelPrefix,a=s===void 0?"Choose":s,o=i.disabledDayAriaLabelPrefix,u=o===void 0?"Not available":o,c=i.day,f=i.locale,g=Io(c,n),m=r.isDisabled(g)||r.isExcluded(g)?u:a;return"".concat(m," ").concat(bn(g,"MMMM yyyy",f))},r.getQuarterClassNames=function(n){var i=r.props,s=i.day,a=i.startDate,o=i.endDate,u=i.selected,c=i.minDate,f=i.maxDate,g=i.excludeDates,m=i.includeDates,v=i.filterDate,w=i.preSelection,y=i.disabledKeyboardNavigation,b=(c||f||g||m||v)&&nE(J0(s,n),r.props);return ss("react-datepicker__quarter-text","react-datepicker__quarter-".concat(n),{"react-datepicker__quarter-text--disabled":b,"react-datepicker__quarter-text--selected":u?r.isSelectedQuarter(s,n,u):void 0,"react-datepicker__quarter-text--keyboard-selected":!y&&w&&r.isSelectedQuarter(s,n,w)&&!b,"react-datepicker__quarter-text--in-selecting-range":r.isInSelectingRangeQuarter(n),"react-datepicker__quarter-text--in-range":a&&o?sE(a,o,n,s):void 0,"react-datepicker__quarter-text--range-start":r.isRangeStartQuarter(n),"react-datepicker__quarter-text--range-end":r.isRangeEndQuarter(n),"react-datepicker__quarter-text--today":r.isCurrentQuarter(s,n)})},r.getMonthContent=function(n){var i=r.props,s=i.showFullMonthYearPicker,a=i.renderMonthContent,o=i.locale,u=i.day,c=yie(n,o),f=UB(n,o);return a?a(n,c,f,u):s?f:c},r.getQuarterContent=function(n){var i,s=r.props,a=s.renderQuarterContent,o=s.locale,u=OGe(n,o);return(i=a?.(n,u))!==null&&i!==void 0?i:u},r.renderMonths=function(){var n,i=r.props,s=i.showTwoColumnMonthYearPicker,a=i.showFourColumnMonthYearPicker,o=i.day,u=i.selected,c=(n=PI[Uq(a,s)])===null||n===void 0?void 0:n.grid;return c?.map(function(f,g){return Ie.createElement("div",{className:"react-datepicker__month-wrapper",key:g},f.map(function(m,v){return Ie.createElement("div",{ref:r.MONTH_REFS[m],key:v,onClick:function(w){r.onMonthClick(w,m)},onKeyDown:function(w){xie(w)&&(w.preventDefault(),w.key=rt.Enter),r.onMonthKeyDown(w,m)},onMouseEnter:r.props.usePointerEvent?void 0:function(){return r.onMonthMouseEnter(m)},onPointerEnter:r.props.usePointerEvent?function(){return r.onMonthMouseEnter(m)}:void 0,tabIndex:Number(r.getTabIndex(m)),className:r.getMonthClassNames(m),"aria-disabled":r.isMonthDisabled(m),role:"option","aria-label":r.getAriaLabel(m),"aria-current":r.isCurrentMonth(o,m)?"date":void 0,"aria-selected":u?r.isSelectedMonth(o,m,u):void 0},r.getMonthContent(m))}))})},r.renderQuarters=function(){var n=r.props,i=n.day,s=n.selected,a=[1,2,3,4];return Ie.createElement("div",{className:"react-datepicker__quarter-wrapper"},a.map(function(o,u){return Ie.createElement("div",{key:u,ref:r.QUARTER_REFS[u],role:"option",onClick:function(c){r.onQuarterClick(c,o)},onKeyDown:function(c){r.onQuarterKeyDown(c,o)},onMouseEnter:r.props.usePointerEvent?void 0:function(){return r.onQuarterMouseEnter(o)},onPointerEnter:r.props.usePointerEvent?function(){return r.onQuarterMouseEnter(o)}:void 0,className:r.getQuarterClassNames(o),"aria-selected":s?r.isSelectedQuarter(i,o,s):void 0,tabIndex:Number(r.getQuarterTabIndex(o)),"aria-current":r.isCurrentQuarter(i,o)?"date":void 0},r.getQuarterContent(o))}))},r.getClassNames=function(){var n=r.props,i=n.selectingDate,s=n.selectsStart,a=n.selectsEnd,o=n.showMonthYearPicker,u=n.showQuarterYearPicker,c=n.showWeekPicker;return ss("react-datepicker__month",{"react-datepicker__month--selecting-range":i&&(s||a)},{"react-datepicker__monthPicker":o},{"react-datepicker__quarterPicker":u},{"react-datepicker__weekPicker":c})},r}return e.prototype.getSelection=function(){var r=this.props,n=r.selected,i=r.selectedDates,s=r.selectsMultiple;if(s)return i;if(n)return[n]},e.prototype.render=function(){var r=this.props,n=r.showMonthYearPicker,i=r.showQuarterYearPicker,s=r.day,a=r.ariaLabelPrefix,o=a===void 0?"Month ":a,u=o?o.trim()+" ":"";return Ie.createElement("div",{className:this.getClassNames(),onMouseLeave:this.props.usePointerEvent?void 0:this.handleMouseLeave,onPointerLeave:this.props.usePointerEvent?this.handleMouseLeave:void 0,"aria-label":"".concat(u).concat(bn(s,"MMMM, yyyy",this.props.locale)),role:"listbox"},n?this.renderMonths():i?this.renderQuarters():this.renderWeeks())},e}(ie.Component),GGe=function(t){Gi(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.isSelectedMonth=function(n){return r.props.month===n},r.renderOptions=function(){return r.props.monthNames.map(function(n,i){return Ie.createElement("div",{className:r.isSelectedMonth(i)?"react-datepicker__month-option react-datepicker__month-option--selected_month":"react-datepicker__month-option",key:n,onClick:r.onChange.bind(r,i),"aria-selected":r.isSelectedMonth(i)?"true":void 0},r.isSelectedMonth(i)?Ie.createElement("span",{className:"react-datepicker__month-option--selected"},"✓"):"",n)})},r.onChange=function(n){return r.props.onChange(n)},r.handleClickOutside=function(){return r.props.onCancel()},r}return e.prototype.render=function(){return Ie.createElement(jT,{className:"react-datepicker__month-dropdown",onClickOutside:this.handleClickOutside},this.renderOptions())},e}(ie.Component),qGe=function(t){Gi(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.state={dropdownVisible:!1},r.renderSelectOptions=function(n){return n.map(function(i,s){return Ie.createElement("option",{key:i,value:s},i)})},r.renderSelectMode=function(n){return Ie.createElement("select",{value:r.props.month,className:"react-datepicker__month-select",onChange:function(i){return r.onChange(parseInt(i.target.value))}},r.renderSelectOptions(n))},r.renderReadView=function(n,i){return Ie.createElement("div",{key:"read",style:{visibility:n?"visible":"hidden"},className:"react-datepicker__month-read-view",onClick:r.toggleDropdown},Ie.createElement("span",{className:"react-datepicker__month-read-view--down-arrow"}),Ie.createElement("span",{className:"react-datepicker__month-read-view--selected-month"},i[r.props.month]))},r.renderDropdown=function(n){return Ie.createElement(GGe,Sr({key:"dropdown"},r.props,{monthNames:n,onChange:r.onChange,onCancel:r.toggleDropdown}))},r.renderScrollMode=function(n){var i=r.state.dropdownVisible,s=[r.renderReadView(!i,n)];return i&&s.unshift(r.renderDropdown(n)),s},r.onChange=function(n){r.toggleDropdown(),n!==r.props.month&&r.props.onChange(n)},r.toggleDropdown=function(){return r.setState({dropdownVisible:!r.state.dropdownVisible})},r}return e.prototype.render=function(){var r=this,n=[0,1,2,3,4,5,6,7,8,9,10,11].map(this.props.useShortMonthInDropdown?function(s){return yie(s,r.props.locale)}:function(s){return UB(s,r.props.locale)}),i;switch(this.props.dropdownMode){case"scroll":i=this.renderScrollMode(n);break;case"select":i=this.renderSelectMode(n);break}return Ie.createElement("div",{className:"react-datepicker__month-dropdown-container react-datepicker__month-dropdown-container--".concat(this.props.dropdownMode)},i)},e}(ie.Component);function KGe(t,e){for(var r=[],n=Jc(t),i=Jc(e);!Gf(n,i);)r.push(Fr(n)),n=Hl(n,1);return r}var XGe=function(t){Gi(e,t);function e(r){var n=t.call(this,r)||this;return n.renderOptions=function(){return n.state.monthYearsList.map(function(i){var s=gH(i),a=Cu(n.props.date,i)&&Us(n.props.date,i);return Ie.createElement("div",{className:a?"react-datepicker__month-year-option--selected_month-year":"react-datepicker__month-year-option",key:s,onClick:n.onChange.bind(n,s),"aria-selected":a?"true":void 0},a?Ie.createElement("span",{className:"react-datepicker__month-year-option--selected"},"✓"):"",bn(i,n.props.dateFormat,n.props.locale))})},n.onChange=function(i){return n.props.onChange(i)},n.handleClickOutside=function(){n.props.onCancel()},n.state={monthYearsList:KGe(n.props.minDate,n.props.maxDate)},n}return e.prototype.render=function(){var r=ss({"react-datepicker__month-year-dropdown":!0,"react-datepicker__month-year-dropdown--scrollable":this.props.scrollableMonthYearDropdown});return Ie.createElement(jT,{className:r,onClickOutside:this.handleClickOutside},this.renderOptions())},e}(ie.Component),QGe=function(t){Gi(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.state={dropdownVisible:!1},r.renderSelectOptions=function(){for(var n=Jc(r.props.minDate),i=Jc(r.props.maxDate),s=[];!Gf(n,i);){var a=gH(n);s.push(Ie.createElement("option",{key:a,value:a},bn(n,r.props.dateFormat,r.props.locale))),n=Hl(n,1)}return s},r.onSelectChange=function(n){r.onChange(parseInt(n.target.value))},r.renderSelectMode=function(){return Ie.createElement("select",{value:gH(Jc(r.props.date)),className:"react-datepicker__month-year-select",onChange:r.onSelectChange},r.renderSelectOptions())},r.renderReadView=function(n){var i=bn(r.props.date,r.props.dateFormat,r.props.locale);return Ie.createElement("div",{key:"read",style:{visibility:n?"visible":"hidden"},className:"react-datepicker__month-year-read-view",onClick:r.toggleDropdown},Ie.createElement("span",{className:"react-datepicker__month-year-read-view--down-arrow"}),Ie.createElement("span",{className:"react-datepicker__month-year-read-view--selected-month-year"},i))},r.renderDropdown=function(){return Ie.createElement(XGe,Sr({key:"dropdown"},r.props,{onChange:r.onChange,onCancel:r.toggleDropdown}))},r.renderScrollMode=function(){var n=r.state.dropdownVisible,i=[r.renderReadView(!n)];return n&&i.unshift(r.renderDropdown()),i},r.onChange=function(n){r.toggleDropdown();var i=Fr(n);Cu(r.props.date,i)&&Us(r.props.date,i)||r.props.onChange(i)},r.toggleDropdown=function(){return r.setState({dropdownVisible:!r.state.dropdownVisible})},r}return e.prototype.render=function(){var r;switch(this.props.dropdownMode){case"scroll":r=this.renderScrollMode();break;case"select":r=this.renderSelectMode();break}return Ie.createElement("div",{className:"react-datepicker__month-year-dropdown-container react-datepicker__month-year-dropdown-container--".concat(this.props.dropdownMode)},r)},e}(ie.Component),ZGe=function(t){Gi(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.state={height:null},r.scrollToTheSelectedTime=function(){requestAnimationFrame(function(){var n,i,s;r.list&&(r.list.scrollTop=(s=r.centerLi&&e.calcCenterPosition(r.props.monthRef?r.props.monthRef.clientHeight-((i=(n=r.header)===null||n===void 0?void 0:n.clientHeight)!==null&&i!==void 0?i:0):r.list.clientHeight,r.centerLi))!==null&&s!==void 0?s:0)})},r.handleClick=function(n){var i,s;(r.props.minTime||r.props.maxTime)&&Pq(n,r.props)||(r.props.excludeTimes||r.props.includeTimes||r.props.filterTime)&&Dq(n,r.props)||(s=(i=r.props).onChange)===null||s===void 0||s.call(i,n)},r.isSelectedTime=function(n){return r.props.selected&&VGe(r.props.selected,n)},r.isDisabledTime=function(n){return(r.props.minTime||r.props.maxTime)&&Pq(n,r.props)||(r.props.excludeTimes||r.props.includeTimes||r.props.filterTime)&&Dq(n,r.props)},r.liClasses=function(n){var i,s=["react-datepicker__time-list-item",r.props.timeClassName?r.props.timeClassName(n):void 0];return r.isSelectedTime(n)&&s.push("react-datepicker__time-list-item--selected"),r.isDisabledTime(n)&&s.push("react-datepicker__time-list-item--disabled"),r.props.injectTimes&&(Qc(n)*3600+Zc(n)*60+Nf(n))%(((i=r.props.intervals)!==null&&i!==void 0?i:e.defaultProps.intervals)*60)!==0&&s.push("react-datepicker__time-list-item--injected"),s.join(" ")},r.handleOnKeyDown=function(n,i){var s,a;n.key===rt.Space&&(n.preventDefault(),n.key=rt.Enter),(n.key===rt.ArrowUp||n.key===rt.ArrowLeft)&&n.target instanceof HTMLElement&&n.target.previousSibling&&(n.preventDefault(),n.target.previousSibling instanceof HTMLElement&&n.target.previousSibling.focus()),(n.key===rt.ArrowDown||n.key===rt.ArrowRight)&&n.target instanceof HTMLElement&&n.target.nextSibling&&(n.preventDefault(),n.target.nextSibling instanceof HTMLElement&&n.target.nextSibling.focus()),n.key===rt.Enter&&r.handleClick(i),(a=(s=r.props).handleOnKeyDown)===null||a===void 0||a.call(s,n)},r.renderTimes=function(){for(var n,i=[],s=typeof r.props.format=="string"?r.props.format:"p",a=(n=r.props.intervals)!==null&&n!==void 0?n:e.defaultProps.intervals,o=r.props.selected||r.props.openToDate||Fr(),u=BE(o),c=r.props.injectTimes&&r.props.injectTimes.sort(function(b,x){return b.getTime()-x.getTime()}),f=60*BGe(o),g=f/a,m=0;m<g;m++){var v=hH(u,m*a);if(i.push(v),c){var w=LGe(u,v,m,a,c);i=i.concat(w)}}var y=i.reduce(function(b,x){return x.getTime()<=o.getTime()?x:b},i[0]);return i.map(function(b){return Ie.createElement("li",{key:b.valueOf(),onClick:r.handleClick.bind(r,b),className:r.liClasses(b),ref:function(x){b===y&&(r.centerLi=x)},onKeyDown:function(x){r.handleOnKeyDown(x,b)},tabIndex:b===y?0:-1,role:"option","aria-selected":r.isSelectedTime(b)?"true":void 0,"aria-disabled":r.isDisabledTime(b)?"true":void 0},bn(b,s,r.props.locale))})},r.renderTimeCaption=function(){return r.props.showTimeCaption===!1?Ie.createElement(Ie.Fragment,null):Ie.createElement("div",{className:"react-datepicker__header react-datepicker__header--time ".concat(r.props.showTimeSelectOnly?"react-datepicker__header--time--only":""),ref:function(n){r.header=n}},Ie.createElement("div",{className:"react-datepicker-time__header"},r.props.timeCaption))},r}return Object.defineProperty(e,"defaultProps",{get:function(){return{intervals:30,todayButton:null,timeCaption:"Time",showTimeCaption:!0}},enumerable:!1,configurable:!0}),e.prototype.componentDidMount=function(){this.scrollToTheSelectedTime(),this.observeDatePickerHeightChanges()},e.prototype.componentWillUnmount=function(){var r;(r=this.resizeObserver)===null||r===void 0||r.disconnect()},e.prototype.observeDatePickerHeightChanges=function(){var r=this,n=this.props.monthRef;this.updateContainerHeight(),n&&(this.resizeObserver=new ResizeObserver(function(){r.updateContainerHeight()}),this.resizeObserver.observe(n))},e.prototype.updateContainerHeight=function(){this.props.monthRef&&this.header&&this.setState({height:this.props.monthRef.clientHeight-this.header.clientHeight})},e.prototype.render=function(){var r=this,n,i=this.state.height;return Ie.createElement("div",{className:"react-datepicker__time-container ".concat(((n=this.props.todayButton)!==null&&n!==void 0?n:e.defaultProps.todayButton)?"react-datepicker__time-container--with-today-button":"")},this.renderTimeCaption(),Ie.createElement("div",{className:"react-datepicker__time"},Ie.createElement("div",{className:"react-datepicker__time-box"},Ie.createElement("ul",{className:"react-datepicker__time-list",ref:function(s){r.list=s},style:i?{height:i}:{},role:"listbox","aria-label":this.props.timeCaption},this.renderTimes()))))},e.calcCenterPosition=function(r,n){return n.offsetTop-(r/2-n.clientHeight/2)},e}(ie.Component),jq=3,JGe=function(t){Gi(e,t);function e(r){var n=t.call(this,r)||this;return n.YEAR_REFS=Du([],Array(n.props.yearItemNumber),!0).map(function(){return ie.createRef()}),n.isDisabled=function(i){return Fo(i,{minDate:n.props.minDate,maxDate:n.props.maxDate,excludeDates:n.props.excludeDates,includeDates:n.props.includeDates,filterDate:n.props.filterDate})},n.isExcluded=function(i){return jB(i,{excludeDates:n.props.excludeDates})},n.selectingDate=function(){var i;return(i=n.props.selectingDate)!==null&&i!==void 0?i:n.props.preSelection},n.updateFocusOnPaginate=function(i){var s=function(){var a,o;(o=(a=n.YEAR_REFS[i])===null||a===void 0?void 0:a.current)===null||o===void 0||o.focus()};window.requestAnimationFrame(s)},n.handleYearClick=function(i,s){n.props.onDayClick&&n.props.onDayClick(i,s)},n.handleYearNavigation=function(i,s){var a,o,u,c,f=n.props,g=f.date,m=f.yearItemNumber;if(!(g===void 0||m===void 0)){var v=Af(g,m).startPeriod;n.isDisabled(s)||n.isExcluded(s)||((o=(a=n.props).setPreSelection)===null||o===void 0||o.call(a,s),i-v<0?n.updateFocusOnPaginate(m-(v-i)):i-v>=m?n.updateFocusOnPaginate(Math.abs(m-(i-v))):(c=(u=n.YEAR_REFS[i-v])===null||u===void 0?void 0:u.current)===null||c===void 0||c.focus())}},n.isSameDay=function(i,s){return yr(i,s)},n.isCurrentYear=function(i){return i===qt(Fr())},n.isRangeStart=function(i){return n.props.startDate&&n.props.endDate&&Cu(yu(Fr(),i),n.props.startDate)},n.isRangeEnd=function(i){return n.props.startDate&&n.props.endDate&&Cu(yu(Fr(),i),n.props.endDate)},n.isInRange=function(i){return iE(i,n.props.startDate,n.props.endDate)},n.isInSelectingRange=function(i){var s=n.props,a=s.selectsStart,o=s.selectsEnd,u=s.selectsRange,c=s.startDate,f=s.endDate;return!(a||o||u)||!n.selectingDate()?!1:a&&f?iE(i,n.selectingDate(),f):o&&c||u&&c&&!f?iE(i,c,n.selectingDate()):!1},n.isSelectingRangeStart=function(i){var s;if(!n.isInSelectingRange(i))return!1;var a=n.props,o=a.startDate,u=a.selectsStart,c=yu(Fr(),i);return u?Cu(c,(s=n.selectingDate())!==null&&s!==void 0?s:null):Cu(c,o??null)},n.isSelectingRangeEnd=function(i){var s;if(!n.isInSelectingRange(i))return!1;var a=n.props,o=a.endDate,u=a.selectsEnd,c=a.selectsRange,f=yu(Fr(),i);return u||c?Cu(f,(s=n.selectingDate())!==null&&s!==void 0?s:null):Cu(f,o??null)},n.isKeyboardSelected=function(i){if(!(n.props.date===void 0||n.props.selected==null||n.props.preSelection==null)){var s=n.props,a=s.minDate,o=s.maxDate,u=s.excludeDates,c=s.includeDates,f=s.filterDate,g=Oy(yu(n.props.date,i)),m=(a||o||u||c||f)&&VE(i,n.props);return!n.props.disabledKeyboardNavigation&&!n.props.inline&&!yr(g,Oy(n.props.selected))&&yr(g,Oy(n.props.preSelection))&&!m}},n.isSelectedYear=function(i){var s=n.props,a=s.selectsMultiple,o=s.selected,u=s.selectedDates;return a?u?.some(function(c){return i===qt(c)}):!!o&&i===qt(o)},n.onYearClick=function(i,s){var a=n.props.date;a!==void 0&&n.handleYearClick(Oy(yu(a,s)),i)},n.onYearKeyDown=function(i,s){var a,o,u=i.key,c=n.props,f=c.date,g=c.yearItemNumber,m=c.handleOnKeyDown;if(u!==rt.Tab&&i.preventDefault(),!n.props.disabledKeyboardNavigation)switch(u){case rt.Enter:if(n.props.selected==null)break;n.onYearClick(i,s),(o=(a=n.props).setPreSelection)===null||o===void 0||o.call(a,n.props.selected);break;case rt.ArrowRight:if(n.props.preSelection==null)break;n.handleYearNavigation(s+1,Kc(n.props.preSelection,1));break;case rt.ArrowLeft:if(n.props.preSelection==null)break;n.handleYearNavigation(s-1,Up(n.props.preSelection,1));break;case rt.ArrowUp:{if(f===void 0||g===void 0||n.props.preSelection==null)break;var v=Af(f,g).startPeriod,w=jq,y=s-w;if(y<v){var b=g%w;s>=v&&s<v+b?w=b:w+=b,y=s-w}n.handleYearNavigation(y,Up(n.props.preSelection,w));break}case rt.ArrowDown:{if(f===void 0||g===void 0||n.props.preSelection==null)break;var x=Af(f,g).endPeriod,w=jq,y=s+w;if(y>x){var b=g%w;s<=x&&s>x-b?w=b:w+=b,y=s+w}n.handleYearNavigation(y,Kc(n.props.preSelection,w));break}}m&&m(i)},n.getYearClassNames=function(i){var s=n.props,a=s.date,o=s.minDate,u=s.maxDate,c=s.excludeDates,f=s.includeDates,g=s.filterDate,m=s.yearClassName;return ss("react-datepicker__year-text","react-datepicker__year-".concat(i),a?m?.(yu(a,i)):void 0,{"react-datepicker__year-text--selected":n.isSelectedYear(i),"react-datepicker__year-text--disabled":(o||u||c||f||g)&&VE(i,n.props),"react-datepicker__year-text--keyboard-selected":n.isKeyboardSelected(i),"react-datepicker__year-text--range-start":n.isRangeStart(i),"react-datepicker__year-text--range-end":n.isRangeEnd(i),"react-datepicker__year-text--in-range":n.isInRange(i),"react-datepicker__year-text--in-selecting-range":n.isInSelectingRange(i),"react-datepicker__year-text--selecting-range-start":n.isSelectingRangeStart(i),"react-datepicker__year-text--selecting-range-end":n.isSelectingRangeEnd(i),"react-datepicker__year-text--today":n.isCurrentYear(i)})},n.getYearTabIndex=function(i){if(n.props.disabledKeyboardNavigation||n.props.preSelection==null)return"-1";var s=qt(n.props.preSelection),a=VE(i,n.props);return i===s&&!a?"0":"-1"},n.getYearContent=function(i){return n.props.renderYearContent?n.props.renderYearContent(i):i},n}return e.prototype.render=function(){var r=this,n=[],i=this.props,s=i.date,a=i.yearItemNumber,o=i.onYearMouseEnter,u=i.onYearMouseLeave;if(s===void 0)return null;for(var c=Af(s,a),f=c.startPeriod,g=c.endPeriod,m=function(y){n.push(Ie.createElement("div",{ref:v.YEAR_REFS[y-f],onClick:function(b){r.onYearClick(b,y)},onKeyDown:function(b){xie(b)&&(b.preventDefault(),b.key=rt.Enter),r.onYearKeyDown(b,y)},tabIndex:Number(v.getYearTabIndex(y)),className:v.getYearClassNames(y),onMouseEnter:v.props.usePointerEvent?void 0:function(b){return o(b,y)},onPointerEnter:v.props.usePointerEvent?function(b){return o(b,y)}:void 0,onMouseLeave:v.props.usePointerEvent?void 0:function(b){return u(b,y)},onPointerLeave:v.props.usePointerEvent?function(b){return u(b,y)}:void 0,key:y,"aria-current":v.isCurrentYear(y)?"date":void 0},v.getYearContent(y)))},v=this,w=f;w<=g;w++)m(w);return Ie.createElement("div",{className:"react-datepicker__year"},Ie.createElement("div",{className:"react-datepicker__year-wrapper",onMouseLeave:this.props.usePointerEvent?void 0:this.props.clearSelectingDate,onPointerLeave:this.props.usePointerEvent?this.props.clearSelectingDate:void 0},n))},e}(ie.Component);function eqe(t,e,r,n){for(var i=[],s=0;s<2*e+1;s++){var a=t+e-s,o=!0;r&&(o=qt(r)<=a),n&&o&&(o=qt(n)>=a),o&&i.push(a)}return i}var tqe=function(t){Gi(e,t);function e(r){var n=t.call(this,r)||this;n.renderOptions=function(){var o=n.props.year,u=n.state.yearsList.map(function(g){return Ie.createElement("div",{className:o===g?"react-datepicker__year-option react-datepicker__year-option--selected_year":"react-datepicker__year-option",key:g,onClick:n.onChange.bind(n,g),"aria-selected":o===g?"true":void 0},o===g?Ie.createElement("span",{className:"react-datepicker__year-option--selected"},"✓"):"",g)}),c=n.props.minDate?qt(n.props.minDate):null,f=n.props.maxDate?qt(n.props.maxDate):null;return(!f||!n.state.yearsList.find(function(g){return g===f}))&&u.unshift(Ie.createElement("div",{className:"react-datepicker__year-option",key:"upcoming",onClick:n.incrementYears},Ie.createElement("a",{className:"react-datepicker__navigation react-datepicker__navigation--years react-datepicker__navigation--years-upcoming"}))),(!c||!n.state.yearsList.find(function(g){return g===c}))&&u.push(Ie.createElement("div",{className:"react-datepicker__year-option",key:"previous",onClick:n.decrementYears},Ie.createElement("a",{className:"react-datepicker__navigation react-datepicker__navigation--years react-datepicker__navigation--years-previous"}))),u},n.onChange=function(o){n.props.onChange(o)},n.handleClickOutside=function(){n.props.onCancel()},n.shiftYears=function(o){var u=n.state.yearsList.map(function(c){return c+o});n.setState({yearsList:u})},n.incrementYears=function(){return n.shiftYears(1)},n.decrementYears=function(){return n.shiftYears(-1)};var i=r.yearDropdownItemNumber,s=r.scrollableYearDropdown,a=i||(s?10:5);return n.state={yearsList:eqe(n.props.year,a,n.props.minDate,n.props.maxDate)},n.dropdownRef=ie.createRef(),n}return e.prototype.componentDidMount=function(){var r=this.dropdownRef.current;if(r){var n=r.children?Array.from(r.children):null,i=n?n.find(function(s){return s.ariaSelected}):null;r.scrollTop=i&&i instanceof HTMLElement?i.offsetTop+(i.clientHeight-r.clientHeight)/2:(r.scrollHeight-r.clientHeight)/2}},e.prototype.render=function(){var r=ss({"react-datepicker__year-dropdown":!0,"react-datepicker__year-dropdown--scrollable":this.props.scrollableYearDropdown});return Ie.createElement(jT,{className:r,containerRef:this.dropdownRef,onClickOutside:this.handleClickOutside},this.renderOptions())},e}(ie.Component),rqe=function(t){Gi(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.state={dropdownVisible:!1},r.renderSelectOptions=function(){for(var n=r.props.minDate?qt(r.props.minDate):1900,i=r.props.maxDate?qt(r.props.maxDate):2100,s=[],a=n;a<=i;a++)s.push(Ie.createElement("option",{key:a,value:a},a));return s},r.onSelectChange=function(n){r.onChange(parseInt(n.target.value))},r.renderSelectMode=function(){return Ie.createElement("select",{value:r.props.year,className:"react-datepicker__year-select",onChange:r.onSelectChange},r.renderSelectOptions())},r.renderReadView=function(n){return Ie.createElement("div",{key:"read",style:{visibility:n?"visible":"hidden"},className:"react-datepicker__year-read-view",onClick:function(i){return r.toggleDropdown(i)}},Ie.createElement("span",{className:"react-datepicker__year-read-view--down-arrow"}),Ie.createElement("span",{className:"react-datepicker__year-read-view--selected-year"},r.props.year))},r.renderDropdown=function(){return Ie.createElement(tqe,Sr({key:"dropdown"},r.props,{onChange:r.onChange,onCancel:r.toggleDropdown}))},r.renderScrollMode=function(){var n=r.state.dropdownVisible,i=[r.renderReadView(!n)];return n&&i.unshift(r.renderDropdown()),i},r.onChange=function(n){r.toggleDropdown(),n!==r.props.year&&r.props.onChange(n)},r.toggleDropdown=function(n){r.setState({dropdownVisible:!r.state.dropdownVisible},function(){r.props.adjustDateOnChange&&r.handleYearChange(r.props.date,n)})},r.handleYearChange=function(n,i){var s;(s=r.onSelect)===null||s===void 0||s.call(r,n,i),r.setOpen()},r.onSelect=function(n,i){var s,a;(a=(s=r.props).onSelect)===null||a===void 0||a.call(s,n,i)},r.setOpen=function(){var n,i;(i=(n=r.props).setOpen)===null||i===void 0||i.call(n,!0)},r}return e.prototype.render=function(){var r;switch(this.props.dropdownMode){case"scroll":r=this.renderScrollMode();break;case"select":r=this.renderSelectMode();break}return Ie.createElement("div",{className:"react-datepicker__year-dropdown-container react-datepicker__year-dropdown-container--".concat(this.props.dropdownMode)},r)},e}(ie.Component),nqe=["react-datepicker__year-select","react-datepicker__month-select","react-datepicker__month-year-select"],iqe=function(t){var e=(t.className||"").split(/\s+/);return nqe.some(function(r){return e.indexOf(r)>=0})},sqe=function(t){Gi(e,t);function e(r){var n=t.call(this,r)||this;return n.monthContainer=void 0,n.handleClickOutside=function(i){n.props.onClickOutside(i)},n.setClickOutsideRef=function(){return n.containerRef.current},n.handleDropdownFocus=function(i){var s,a;iqe(i.target)&&((a=(s=n.props).onDropdownFocus)===null||a===void 0||a.call(s,i))},n.getDateInView=function(){var i=n.props,s=i.preSelection,a=i.selected,o=i.openToDate,u=bie(n.props),c=Cie(n.props),f=Fr(),g=o||a||s;return g||(u&&Kg(f,u)?u:c&&Gf(f,c)?c:f)},n.increaseMonth=function(){n.setState(function(i){var s=i.date;return{date:Hl(s,1)}},function(){return n.handleMonthChange(n.state.date)})},n.decreaseMonth=function(){n.setState(function(i){var s=i.date;return{date:kg(s,1)}},function(){return n.handleMonthChange(n.state.date)})},n.handleDayClick=function(i,s,a){n.props.onSelect(i,s,a),n.props.setPreSelection&&n.props.setPreSelection(i)},n.handleDayMouseEnter=function(i){n.setState({selectingDate:i}),n.props.onDayMouseEnter&&n.props.onDayMouseEnter(i)},n.handleMonthMouseLeave=function(){n.setState({selectingDate:void 0}),n.props.onMonthMouseLeave&&n.props.onMonthMouseLeave()},n.handleYearMouseEnter=function(i,s){n.setState({selectingDate:yu(Fr(),s)}),n.props.onYearMouseEnter&&n.props.onYearMouseEnter(i,s)},n.handleYearMouseLeave=function(i,s){n.props.onYearMouseLeave&&n.props.onYearMouseLeave(i,s)},n.handleYearChange=function(i){var s,a,o,u;(a=(s=n.props).onYearChange)===null||a===void 0||a.call(s,i),n.setState({isRenderAriaLiveMessage:!0}),n.props.adjustDateOnChange&&(n.props.onSelect(i),(u=(o=n.props).setOpen)===null||u===void 0||u.call(o,!0)),n.props.setPreSelection&&n.props.setPreSelection(i)},n.getEnabledPreSelectionDateForMonth=function(i){if(!Fo(i,n.props))return i;for(var s=Jc(i),a=RGe(i),o=L9e(a,s),u=null,c=0;c<=o;c++){var f=kl(s,c);if(!Fo(f,n.props)){u=f;break}}return u},n.handleMonthChange=function(i){var s,a,o,u=(s=n.getEnabledPreSelectionDateForMonth(i))!==null&&s!==void 0?s:i;n.handleCustomMonthChange(u),n.props.adjustDateOnChange&&(n.props.onSelect(u),(o=(a=n.props).setOpen)===null||o===void 0||o.call(a,!0)),n.props.setPreSelection&&n.props.setPreSelection(u)},n.handleCustomMonthChange=function(i){var s,a;(a=(s=n.props).onMonthChange)===null||a===void 0||a.call(s,i),n.setState({isRenderAriaLiveMessage:!0})},n.handleMonthYearChange=function(i){n.handleYearChange(i),n.handleMonthChange(i)},n.changeYear=function(i){n.setState(function(s){var a=s.date;return{date:yu(a,Number(i))}},function(){return n.handleYearChange(n.state.date)})},n.changeMonth=function(i){n.setState(function(s){var a=s.date;return{date:Io(a,Number(i))}},function(){return n.handleMonthChange(n.state.date)})},n.changeMonthYear=function(i){n.setState(function(s){var a=s.date;return{date:yu(Io(a,Es(i)),qt(i))}},function(){return n.handleMonthYearChange(n.state.date)})},n.header=function(i){i===void 0&&(i=n.state.date);var s=Hf(i,n.props.locale,n.props.calendarStartDay),a=[];return n.props.showWeekNumbers&&a.push(Ie.createElement("div",{key:"W",className:"react-datepicker__day-name"},n.props.weekLabel||"#")),a.concat([0,1,2,3,4,5,6].map(function(o){var u=kl(s,o),c=n.formatWeekday(u,n.props.locale),f=n.props.weekDayClassName?n.props.weekDayClassName(u):void 0;return Ie.createElement("div",{key:o,"aria-label":bn(u,"EEEE",n.props.locale),className:ss("react-datepicker__day-name",f)},c)}))},n.formatWeekday=function(i,s){return n.props.formatWeekDay?TGe(i,n.props.formatWeekDay,s):n.props.useWeekdaysShort?AGe(i,s):MGe(i,s)},n.decreaseYear=function(){n.setState(function(i){var s,a=i.date;return{date:Up(a,n.props.showYearPicker?(s=n.props.yearItemNumber)!==null&&s!==void 0?s:e.defaultProps.yearItemNumber:1)}},function(){return n.handleYearChange(n.state.date)})},n.clearSelectingDate=function(){n.setState({selectingDate:void 0})},n.renderPreviousButton=function(){var i,s,a;if(!n.props.renderCustomHeader){var o=(i=n.props.monthsShown)!==null&&i!==void 0?i:e.defaultProps.monthsShown,u=n.props.showPreviousMonths?o-1:0,c=(s=n.props.monthSelectedIn)!==null&&s!==void 0?s:u,f=kg(n.state.date,c),g;switch(!0){case n.props.showMonthYearPicker:g=Hq(n.state.date,n.props);break;case n.props.showYearPicker:g=IGe(n.state.date,n.props);break;case n.props.showQuarterYearPicker:g=DGe(n.state.date,n.props);break;default:g=Iq(f,n.props);break}if(!(!((a=n.props.forceShowMonthNavigation)!==null&&a!==void 0?a:e.defaultProps.forceShowMonthNavigation)&&!n.props.showDisabledMonthNavigation&&g||n.props.showTimeSelectOnly)){var m=["react-datepicker__navigation-icon","react-datepicker__navigation-icon--previous"],v=["react-datepicker__navigation","react-datepicker__navigation--previous"],w=n.decreaseMonth;(n.props.showMonthYearPicker||n.props.showQuarterYearPicker||n.props.showYearPicker)&&(w=n.decreaseYear),g&&n.props.showDisabledMonthNavigation&&(v.push("react-datepicker__navigation--previous--disabled"),w=void 0);var y=n.props.showMonthYearPicker||n.props.showQuarterYearPicker||n.props.showYearPicker,b=n.props,x=b.previousMonthButtonLabel,_=x===void 0?e.defaultProps.previousMonthButtonLabel:x,T=b.previousYearButtonLabel,D=T===void 0?e.defaultProps.previousYearButtonLabel:T,P=n.props,O=P.previousMonthAriaLabel,A=O===void 0?typeof _=="string"?_:"Previous Month":O,W=P.previousYearAriaLabel,L=W===void 0?typeof D=="string"?D:"Previous Year":W;return Ie.createElement("button",{type:"button",className:v.join(" "),onClick:w,onKeyDown:n.props.handleOnKeyDown,"aria-label":y?L:A},Ie.createElement("span",{className:m.join(" ")},y?D:_))}}},n.increaseYear=function(){n.setState(function(i){var s,a=i.date;return{date:Kc(a,n.props.showYearPicker?(s=n.props.yearItemNumber)!==null&&s!==void 0?s:e.defaultProps.yearItemNumber:1)}},function(){return n.handleYearChange(n.state.date)})},n.renderNextButton=function(){var i;if(!n.props.renderCustomHeader){var s;switch(!0){case n.props.showMonthYearPicker:s=Fq(n.state.date,n.props);break;case n.props.showYearPicker:s=NGe(n.state.date,n.props);break;case n.props.showQuarterYearPicker:s=PGe(n.state.date,n.props);break;default:s=Nq(n.state.date,n.props);break}if(!(!((i=n.props.forceShowMonthNavigation)!==null&&i!==void 0?i:e.defaultProps.forceShowMonthNavigation)&&!n.props.showDisabledMonthNavigation&&s||n.props.showTimeSelectOnly)){var a=["react-datepicker__navigation","react-datepicker__navigation--next"],o=["react-datepicker__navigation-icon","react-datepicker__navigation-icon--next"];n.props.showTimeSelect&&a.push("react-datepicker__navigation--next--with-time"),n.props.todayButton&&a.push("react-datepicker__navigation--next--with-today-button");var u=n.increaseMonth;(n.props.showMonthYearPicker||n.props.showQuarterYearPicker||n.props.showYearPicker)&&(u=n.increaseYear),s&&n.props.showDisabledMonthNavigation&&(a.push("react-datepicker__navigation--next--disabled"),u=void 0);var c=n.props.showMonthYearPicker||n.props.showQuarterYearPicker||n.props.showYearPicker,f=n.props,g=f.nextMonthButtonLabel,m=g===void 0?e.defaultProps.nextMonthButtonLabel:g,v=f.nextYearButtonLabel,w=v===void 0?e.defaultProps.nextYearButtonLabel:v,y=n.props,b=y.nextMonthAriaLabel,x=b===void 0?typeof m=="string"?m:"Next Month":b,_=y.nextYearAriaLabel,T=_===void 0?typeof w=="string"?w:"Next Year":_;return Ie.createElement("button",{type:"button",className:a.join(" "),onClick:u,onKeyDown:n.props.handleOnKeyDown,"aria-label":c?T:x},Ie.createElement("span",{className:o.join(" ")},c?w:m))}}},n.renderCurrentMonth=function(i){i===void 0&&(i=n.state.date);var s=["react-datepicker__current-month"];return n.props.showYearDropdown&&s.push("react-datepicker__current-month--hasYearDropdown"),n.props.showMonthDropdown&&s.push("react-datepicker__current-month--hasMonthDropdown"),n.props.showMonthYearDropdown&&s.push("react-datepicker__current-month--hasMonthYearDropdown"),Ie.createElement("h2",{className:s.join(" ")},bn(i,n.props.dateFormat,n.props.locale))},n.renderYearDropdown=function(i){if(i===void 0&&(i=!1),!(!n.props.showYearDropdown||i))return Ie.createElement(rqe,Sr({},e.defaultProps,n.props,{date:n.state.date,onChange:n.changeYear,year:qt(n.state.date)}))},n.renderMonthDropdown=function(i){if(i===void 0&&(i=!1),!(!n.props.showMonthDropdown||i))return Ie.createElement(qGe,Sr({},e.defaultProps,n.props,{month:Es(n.state.date),onChange:n.changeMonth}))},n.renderMonthYearDropdown=function(i){if(i===void 0&&(i=!1),!(!n.props.showMonthYearDropdown||i))return Ie.createElement(QGe,Sr({},e.defaultProps,n.props,{date:n.state.date,onChange:n.changeMonthYear}))},n.handleTodayButtonClick=function(i){n.props.onSelect(Aq(),i),n.props.setPreSelection&&n.props.setPreSelection(Aq())},n.renderTodayButton=function(){if(!(!n.props.todayButton||n.props.showTimeSelectOnly))return Ie.createElement("div",{className:"react-datepicker__today-button",onClick:n.handleTodayButtonClick},n.props.todayButton)},n.renderDefaultHeader=function(i){var s=i.monthDate,a=i.i;return Ie.createElement("div",{className:"react-datepicker__header ".concat(n.props.showTimeSelect?"react-datepicker__header--has-time-select":"")},n.renderCurrentMonth(s),Ie.createElement("div",{className:"react-datepicker__header__dropdown react-datepicker__header__dropdown--".concat(n.props.dropdownMode),onFocus:n.handleDropdownFocus},n.renderMonthDropdown(a!==0),n.renderMonthYearDropdown(a!==0),n.renderYearDropdown(a!==0)),Ie.createElement("div",{className:"react-datepicker__day-names"},n.header(s)))},n.renderCustomHeader=function(i){var s,a,o=i.monthDate,u=i.i;if(n.props.showTimeSelect&&!n.state.monthContainer||n.props.showTimeSelectOnly)return null;var c=Iq(n.state.date,n.props),f=Nq(n.state.date,n.props),g=Hq(n.state.date,n.props),m=Fq(n.state.date,n.props),v=!n.props.showMonthYearPicker&&!n.props.showQuarterYearPicker&&!n.props.showYearPicker;return Ie.createElement("div",{className:"react-datepicker__header react-datepicker__header--custom",onFocus:n.props.onDropdownFocus},(a=(s=n.props).renderCustomHeader)===null||a===void 0?void 0:a.call(s,Sr(Sr({},n.state),{customHeaderCount:u,monthDate:o,changeMonth:n.changeMonth,changeYear:n.changeYear,decreaseMonth:n.decreaseMonth,increaseMonth:n.increaseMonth,decreaseYear:n.decreaseYear,increaseYear:n.increaseYear,prevMonthButtonDisabled:c,nextMonthButtonDisabled:f,prevYearButtonDisabled:g,nextYearButtonDisabled:m})),v&&Ie.createElement("div",{className:"react-datepicker__day-names"},n.header(o)))},n.renderYearHeader=function(i){var s=i.monthDate,a=n.props,o=a.showYearPicker,u=a.yearItemNumber,c=u===void 0?e.defaultProps.yearItemNumber:u,f=Af(s,c),g=f.startPeriod,m=f.endPeriod;return Ie.createElement("div",{className:"react-datepicker__header react-datepicker-year-header"},o?"".concat(g," - ").concat(m):qt(s))},n.renderHeader=function(i){var s=i.monthDate,a=i.i,o=a===void 0?0:a,u={monthDate:s,i:o};switch(!0){case n.props.renderCustomHeader!==void 0:return n.renderCustomHeader(u);case(n.props.showMonthYearPicker||n.props.showQuarterYearPicker||n.props.showYearPicker):return n.renderYearHeader(u);default:return n.renderDefaultHeader(u)}},n.renderMonths=function(){var i,s;if(!(n.props.showTimeSelectOnly||n.props.showYearPicker)){for(var a=[],o=(i=n.props.monthsShown)!==null&&i!==void 0?i:e.defaultProps.monthsShown,u=n.props.showPreviousMonths?o-1:0,c=n.props.showMonthYearPicker||n.props.showQuarterYearPicker?Kc(n.state.date,u):kg(n.state.date,u),f=(s=n.props.monthSelectedIn)!==null&&s!==void 0?s:u,g=0;g<o;++g){var m=g-f+u,v=n.props.showMonthYearPicker||n.props.showQuarterYearPicker?Kc(c,m):Hl(c,m),w="month-".concat(g),y=g<o-1,b=g>0;a.push(Ie.createElement("div",{key:w,ref:function(x){n.monthContainer=x??void 0},className:"react-datepicker__month-container"},n.renderHeader({monthDate:v,i:g}),Ie.createElement(zGe,Sr({},e.defaultProps,n.props,{containerRef:n.containerRef,ariaLabelPrefix:n.props.monthAriaLabelPrefix,day:v,onDayClick:n.handleDayClick,handleOnKeyDown:n.props.handleOnDayKeyDown,handleOnMonthKeyDown:n.props.handleOnKeyDown,onDayMouseEnter:n.handleDayMouseEnter,onMouseLeave:n.handleMonthMouseLeave,orderInDisplay:g,selectingDate:n.state.selectingDate,monthShowsDuplicateDaysEnd:y,monthShowsDuplicateDaysStart:b}))))}return a}},n.renderYears=function(){if(!n.props.showTimeSelectOnly&&n.props.showYearPicker)return Ie.createElement("div",{className:"react-datepicker__year--container"},n.renderHeader({monthDate:n.state.date}),Ie.createElement(JGe,Sr({},e.defaultProps,n.props,{selectingDate:n.state.selectingDate,date:n.state.date,onDayClick:n.handleDayClick,clearSelectingDate:n.clearSelectingDate,onYearMouseEnter:n.handleYearMouseEnter,onYearMouseLeave:n.handleYearMouseLeave})))},n.renderTimeSection=function(){if(n.props.showTimeSelect&&(n.state.monthContainer||n.props.showTimeSelectOnly))return Ie.createElement(ZGe,Sr({},e.defaultProps,n.props,{onChange:n.props.onTimeChange,format:n.props.timeFormat,intervals:n.props.timeIntervals,monthRef:n.state.monthContainer}))},n.renderInputTimeSection=function(){var i=n.props.selected?new Date(n.props.selected):void 0,s=i&&YT(i)&&!!n.props.selected,a=s?"".concat(Bq(i.getHours()),":").concat(Bq(i.getMinutes())):"";if(n.props.showTimeInput)return Ie.createElement(WGe,Sr({},e.defaultProps,n.props,{date:i,timeString:a,onChange:n.props.onTimeChange}))},n.renderAriaLiveRegion=function(){var i,s=Af(n.state.date,(i=n.props.yearItemNumber)!==null&&i!==void 0?i:e.defaultProps.yearItemNumber),a=s.startPeriod,o=s.endPeriod,u;return n.props.showYearPicker?u="".concat(a," - ").concat(o):n.props.showMonthYearPicker||n.props.showQuarterYearPicker?u=qt(n.state.date):u="".concat(UB(Es(n.state.date),n.props.locale)," ").concat(qt(n.state.date)),Ie.createElement("span",{role:"alert","aria-live":"polite",className:"react-datepicker__aria-live"},n.state.isRenderAriaLiveMessage&&u)},n.renderChildren=function(){if(n.props.children)return Ie.createElement("div",{className:"react-datepicker__children-container"},n.props.children)},n.containerRef=ie.createRef(),n.state={date:n.getDateInView(),selectingDate:void 0,monthContainer:void 0,isRenderAriaLiveMessage:!1},n}return Object.defineProperty(e,"defaultProps",{get:function(){return{monthsShown:1,forceShowMonthNavigation:!1,timeCaption:"Time",previousYearButtonLabel:"Previous Year",nextYearButtonLabel:"Next Year",previousMonthButtonLabel:"Previous Month",nextMonthButtonLabel:"Next Month",yearItemNumber:KS}},enumerable:!1,configurable:!0}),e.prototype.componentDidMount=function(){var r=this;this.props.showTimeSelect&&(this.assignMonthContainer=function(){r.setState({monthContainer:r.monthContainer})}())},e.prototype.componentDidUpdate=function(r){var n=this;if(this.props.preSelection&&(!yr(this.props.preSelection,r.preSelection)||this.props.monthSelectedIn!==r.monthSelectedIn)){var i=!Us(this.state.date,this.props.preSelection);this.setState({date:this.props.preSelection},function(){return i&&n.handleCustomMonthChange(n.state.date)})}else this.props.openToDate&&!yr(this.props.openToDate,r.openToDate)&&this.setState({date:this.props.openToDate})},e.prototype.render=function(){var r=this.props.container||yGe;return Ie.createElement(jT,{onClickOutside:this.handleClickOutside,style:{display:"contents"},ignoreClass:this.props.outsideClickIgnoreClass},Ie.createElement("div",{style:{display:"contents"},ref:this.containerRef},Ie.createElement(r,{className:ss("react-datepicker",this.props.className,{"react-datepicker--time-only":this.props.showTimeSelectOnly}),showTime:this.props.showTimeSelect||this.props.showTimeInput,showTimeSelectOnly:this.props.showTimeSelectOnly},this.renderAriaLiveRegion(),this.renderPreviousButton(),this.renderNextButton(),this.renderMonths(),this.renderYears(),this.renderTodayButton(),this.renderTimeSection(),this.renderInputTimeSection(),this.renderChildren())))},e}(ie.Component),aqe=function(t){var e=t.icon,r=t.className,n=r===void 0?"":r,i=t.onClick,s="react-datepicker__calendar-icon";if(typeof e=="string")return Ie.createElement("i",{className:"".concat(s," ").concat(e," ").concat(n),"aria-hidden":"true",onClick:i});if(Ie.isValidElement(e)){var a=e;return Ie.cloneElement(a,{className:"".concat(a.props.className||""," ").concat(s," ").concat(n),onClick:function(o){typeof a.props.onClick=="function"&&a.props.onClick(o),typeof i=="function"&&i(o)}})}return Ie.createElement("svg",{className:"".concat(s," ").concat(n),xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512",onClick:i},Ie.createElement("path",{d:"M96 32V64H48C21.5 64 0 85.5 0 112v48H448V112c0-26.5-21.5-48-48-48H352V32c0-17.7-14.3-32-32-32s-32 14.3-32 32V64H160V32c0-17.7-14.3-32-32-32S96 14.3 96 32zM448 192H0V464c0 26.5 21.5 48 48 48H400c26.5 0 48-21.5 48-48V192z"}))},Eie=function(t){Gi(e,t);function e(r){var n=t.call(this,r)||this;return n.portalRoot=null,n.el=document.createElement("div"),n}return e.prototype.componentDidMount=function(){this.portalRoot=(this.props.portalHost||document).getElementById(this.props.portalId),this.portalRoot||(this.portalRoot=document.createElement("div"),this.portalRoot.setAttribute("id",this.props.portalId),(this.props.portalHost||document.body).appendChild(this.portalRoot)),this.portalRoot.appendChild(this.el)},e.prototype.componentWillUnmount=function(){this.portalRoot&&this.portalRoot.removeChild(this.el)},e.prototype.render=function(){return _H.createPortal(this.props.children,this.el)},e}(ie.Component),oqe="[tabindex], a, button, input, select, textarea",lqe=function(t){return(t instanceof HTMLAnchorElement||!t.disabled)&&t.tabIndex!==-1},_ie=function(t){Gi(e,t);function e(r){var n=t.call(this,r)||this;return n.getTabChildren=function(){var i;return Array.prototype.slice.call((i=n.tabLoopRef.current)===null||i===void 0?void 0:i.querySelectorAll(oqe),1,-1).filter(lqe)},n.handleFocusStart=function(){var i=n.getTabChildren();i&&i.length>1&&i[i.length-1].focus()},n.handleFocusEnd=function(){var i=n.getTabChildren();i&&i.length>1&&i[0].focus()},n.tabLoopRef=ie.createRef(),n}return e.prototype.render=function(){var r;return((r=this.props.enableTabLoop)!==null&&r!==void 0?r:e.defaultProps.enableTabLoop)?Ie.createElement("div",{className:"react-datepicker__tab-loop",ref:this.tabLoopRef},Ie.createElement("div",{className:"react-datepicker__tab-loop__start",tabIndex:0,onFocus:this.handleFocusStart}),this.props.children,Ie.createElement("div",{className:"react-datepicker__tab-loop__end",tabIndex:0,onFocus:this.handleFocusEnd})):this.props.children},e.defaultProps={enableTabLoop:!0},e}(ie.Component);function uqe(t){var e=function(r){var n,i=typeof r.hidePopper=="boolean"?r.hidePopper:!0,s=ie.useRef(null),a=wGe(Sr({open:!i,whileElementsMounted:Xze,placement:r.popperPlacement,middleware:Du([sGe({padding:15}),iGe(10),aGe({element:s})],(n=r.popperModifiers)!==null&&n!==void 0?n:[],!0)},r.popperProps)),o=Sr(Sr({},r),{hidePopper:i,popperProps:Sr(Sr({},a),{arrowRef:s})});return Ie.createElement(t,Sr({},o))};return e}var cqe=function(t){Gi(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return Object.defineProperty(e,"defaultProps",{get:function(){return{hidePopper:!0}},enumerable:!1,configurable:!0}),e.prototype.render=function(){var r=this.props,n=r.className,i=r.wrapperClassName,s=r.hidePopper,a=s===void 0?e.defaultProps.hidePopper:s,o=r.popperComponent,u=r.targetComponent,c=r.enableTabLoop,f=r.popperOnKeyDown,g=r.portalId,m=r.portalHost,v=r.popperProps,w=r.showArrow,y=void 0;if(!a){var b=ss("react-datepicker-popper",n);y=Ie.createElement(_ie,{enableTabLoop:c},Ie.createElement("div",{ref:v.refs.setFloating,style:v.floatingStyles,className:b,"data-placement":v.placement,onKeyDown:f},o,w&&Ie.createElement(hGe,{ref:v.arrowRef,context:v.context,fill:"currentColor",strokeWidth:1,height:8,width:16,style:{transform:"translateY(-1px)"},className:"react-datepicker__triangle"})))}this.props.popperContainer&&(y=ie.createElement(this.props.popperContainer,{},y)),g&&!a&&(y=Ie.createElement(Eie,{portalId:g,portalHost:m},y));var x=ss("react-datepicker-wrapper",i);return Ie.createElement(Ie.Fragment,null,Ie.createElement("div",{ref:v.refs.setReference,className:x},u),y)},e}(ie.Component),hqe=uqe(cqe),Yq="react-datepicker-ignore-onclickoutside";function fqe(t,e){return t&&e?Es(t)!==Es(e)||qt(t)!==qt(e):t!==e}var II="Date input not valid.",pR=function(t){Gi(e,t);function e(r){var n=t.call(this,r)||this;return n.calendar=null,n.input=null,n.getPreSelection=function(){return n.props.openToDate?n.props.openToDate:n.props.selectsEnd&&n.props.startDate?n.props.startDate:n.props.selectsStart&&n.props.endDate?n.props.endDate:Fr()},n.modifyHolidays=function(){var i;return(i=n.props.holidays)===null||i===void 0?void 0:i.reduce(function(s,a){var o=new Date(a.date);return YT(o)?Du(Du([],s,!0),[Sr(Sr({},a),{date:o})],!1):s},[])},n.calcInitialState=function(){var i,s=n.getPreSelection(),a=bie(n.props),o=Cie(n.props),u=a&&Kg(s,BE(a))?a:o&&Gf(s,Oq(o))?o:s;return{open:n.props.startOpen||!1,preventFocus:!1,inputValue:null,preSelection:(i=n.props.selectsRange?n.props.startDate:n.props.selected)!==null&&i!==void 0?i:u,highlightDates:Lq(n.props.highlightDates),focused:!1,shouldFocusDayInline:!1,isRenderAriaLiveMessage:!1,wasHidden:!1}},n.resetHiddenStatus=function(){n.setState(Sr(Sr({},n.state),{wasHidden:!1}))},n.setHiddenStatus=function(){n.setState(Sr(Sr({},n.state),{wasHidden:!0}))},n.setHiddenStateOnVisibilityHidden=function(){document.visibilityState==="hidden"&&n.setHiddenStatus()},n.clearPreventFocusTimeout=function(){n.preventFocusTimeout&&clearTimeout(n.preventFocusTimeout)},n.setFocus=function(){var i,s;(s=(i=n.input)===null||i===void 0?void 0:i.focus)===null||s===void 0||s.call(i,{preventScroll:!0})},n.setBlur=function(){var i,s;(s=(i=n.input)===null||i===void 0?void 0:i.blur)===null||s===void 0||s.call(i),n.cancelFocusInput()},n.deferBlur=function(){requestAnimationFrame(function(){n.setBlur()})},n.setOpen=function(i,s){s===void 0&&(s=!1),n.setState({open:i,preSelection:i&&n.state.open?n.state.preSelection:n.calcInitialState().preSelection,lastPreSelectChange:NI},function(){i||n.setState(function(a){return{focused:s?a.focused:!1}},function(){!s&&n.deferBlur(),n.setState({inputValue:null})})})},n.inputOk=function(){return Xc(n.state.preSelection)},n.isCalendarOpen=function(){return n.props.open===void 0?n.state.open&&!n.props.disabled&&!n.props.readOnly:n.props.open},n.handleFocus=function(i){var s,a,o=n.state.wasHidden,u=o?n.state.open:!0;o&&n.resetHiddenStatus(),n.state.preventFocus||((a=(s=n.props).onFocus)===null||a===void 0||a.call(s,i),u&&!n.props.preventOpenOnFocus&&!n.props.readOnly&&n.setOpen(!0)),n.setState({focused:!0})},n.sendFocusBackToInput=function(){n.preventFocusTimeout&&n.clearPreventFocusTimeout(),n.setState({preventFocus:!0},function(){n.preventFocusTimeout=setTimeout(function(){n.setFocus(),n.setState({preventFocus:!1})})})},n.cancelFocusInput=function(){clearTimeout(n.inputFocusTimeout),n.inputFocusTimeout=void 0},n.deferFocusInput=function(){n.cancelFocusInput(),n.inputFocusTimeout=setTimeout(function(){return n.setFocus()},1)},n.handleDropdownFocus=function(){n.cancelFocusInput()},n.handleBlur=function(i){var s,a;(!n.state.open||n.props.withPortal||n.props.showTimeInput)&&((a=(s=n.props).onBlur)===null||a===void 0||a.call(s,i)),n.state.open&&n.props.open===!1&&n.setOpen(!1),n.setState({focused:!1})},n.handleCalendarClickOutside=function(i){var s,a;n.props.inline||n.setOpen(!1),(a=(s=n.props).onClickOutside)===null||a===void 0||a.call(s,i),n.props.withPortal&&i.preventDefault()},n.handleChange=function(){for(var i,s,a,o,u,c=[],f=0;f<arguments.length;f++)c[f]=arguments[f];var g=c[0];if(!(n.props.onChangeRaw&&(n.props.onChangeRaw.apply(n,c),!g||typeof g.isDefaultPrevented!="function"||g.isDefaultPrevented()))){n.setState({inputValue:g?.target instanceof HTMLInputElement?g.target.value:null,lastPreSelectChange:dqe});var m=n.props,v=m.selectsRange,w=m.startDate,y=m.endDate,b=(i=n.props.dateFormat)!==null&&i!==void 0?i:e.defaultProps.dateFormat,x=(s=n.props.strictParsing)!==null&&s!==void 0?s:e.defaultProps.strictParsing,_=g?.target instanceof HTMLInputElement?g.target.value:"";if(v){var T=_.split(b.includes("-")?wie:"-",2).map(function(J){return J.trim()}),D=T[0],P=T[1],O=kI(D??"",b,n.props.locale,x),A=kI(P??"",b,n.props.locale,x),W=w?.getTime()!==O?.getTime(),L=y?.getTime()!==A?.getTime();if(!W&&!L||O&&Fo(O,n.props)||A&&Fo(A,n.props))return;(o=(a=n.props).onChange)===null||o===void 0||o.call(a,[O,A],g)}else{var H=kI(_,b,n.props.locale,x,(u=n.props.selected)!==null&&u!==void 0?u:void 0);(H||!_)&&n.setSelected(H,g,!0)}}},n.handleSelect=function(i,s,a){if(!n.props.readOnly){if(n.props.shouldCloseOnSelect&&!n.props.showTimeSelect&&n.sendFocusBackToInput(),n.props.onChangeRaw&&n.props.onChangeRaw(s),n.setSelected(i,s,!1,a),n.props.showDateSelect&&n.setState({isRenderAriaLiveMessage:!0}),!n.props.shouldCloseOnSelect||n.props.showTimeSelect)n.setPreSelection(i);else if(!n.props.inline){n.props.selectsRange||n.setOpen(!1);var o=n.props,u=o.startDate,c=o.endDate;u&&!c&&(n.props.swapRange||!$q(i,u))&&n.setOpen(!1)}}},n.setSelected=function(i,s,a,o){var u,c,f=i;if(n.props.showYearPicker){if(f!==null&&VE(qt(f),n.props))return}else if(n.props.showMonthYearPicker){if(f!==null&&Sie(f,n.props))return}else if(f!==null&&Fo(f,n.props))return;var g=n.props,m=g.onChange,v=g.selectsRange,w=g.startDate,y=g.endDate,b=g.selectsMultiple,x=g.selectedDates,_=g.minTime,T=g.swapRange;if(!xg(n.props.selected,f)||n.props.allowSameDay||v||b)if(f!==null&&(n.props.selected&&(!a||!n.props.showTimeSelect&&!n.props.showTimeSelectOnly&&!n.props.showTimeInput)&&(f=DI(f,{hour:Qc(n.props.selected),minute:Zc(n.props.selected),second:Nf(n.props.selected)})),!a&&(n.props.showTimeSelect||n.props.showTimeSelectOnly)&&_&&(f=DI(f,{hour:_.getHours(),minute:_.getMinutes(),second:_.getSeconds()})),n.props.inline||n.setState({preSelection:f}),n.props.focusSelectedMonth||n.setState({monthSelectedIn:o})),v){var D=!w&&!y,P=w&&!y,O=w&&y;D?m?.([f,null],s):P&&(f===null?m?.([null,null],s):$q(f,w)?m?.(T?[f,w]:[f,null],s):m?.([w,f],s)),O&&m?.([f,null],s)}else if(b){if(f!==null)if(!x?.length)m?.([f],s);else{var A=x.some(function(L){return yr(L,f)});if(A){var W=x.filter(function(L){return!yr(L,f)});m?.(W,s)}else m?.(Du(Du([],x,!0),[f],!1),s)}}else m?.(f,s);a||((c=(u=n.props).onSelect)===null||c===void 0||c.call(u,f,s),n.setState({inputValue:null}))},n.setPreSelection=function(i){if(!n.props.readOnly){var s=Xc(n.props.minDate),a=Xc(n.props.maxDate),o=!0;if(i){var u=BE(i);if(s&&a)o=ky(i,n.props.minDate,n.props.maxDate);else if(s){var c=BE(n.props.minDate);o=Gf(i,c)||xg(u,c)}else if(a){var f=Oq(n.props.maxDate);o=Kg(i,f)||xg(u,f)}}o&&n.setState({preSelection:i})}},n.toggleCalendar=function(){n.setOpen(!n.state.open)},n.handleTimeChange=function(i){var s,a;if(!(n.props.selectsRange||n.props.selectsMultiple)){var o=n.props.selected?n.props.selected:n.getPreSelection(),u=n.props.selected?i:DI(o,{hour:Qc(i),minute:Zc(i)});n.setState({preSelection:u}),(a=(s=n.props).onChange)===null||a===void 0||a.call(s,u),n.props.shouldCloseOnSelect&&!n.props.showTimeInput&&(n.sendFocusBackToInput(),n.setOpen(!1)),n.props.showTimeInput&&n.setOpen(!0),(n.props.showTimeSelectOnly||n.props.showTimeSelect)&&n.setState({isRenderAriaLiveMessage:!0}),n.setState({inputValue:null})}},n.onInputClick=function(){var i,s;!n.props.disabled&&!n.props.readOnly&&n.setOpen(!0),(s=(i=n.props).onInputClick)===null||s===void 0||s.call(i)},n.onInputKeyDown=function(i){var s,a,o,u,c,f;(a=(s=n.props).onKeyDown)===null||a===void 0||a.call(s,i);var g=i.key;if(!n.state.open&&!n.props.inline&&!n.props.preventOpenOnFocus){(g===rt.ArrowDown||g===rt.ArrowUp||g===rt.Enter)&&((o=n.onInputClick)===null||o===void 0||o.call(n));return}if(n.state.open){if(g===rt.ArrowDown||g===rt.ArrowUp){i.preventDefault();var m=n.props.showTimeSelectOnly?".react-datepicker__time-list-item[tabindex='0']":n.props.showWeekPicker&&n.props.showWeekNumbers?'.react-datepicker__week-number[tabindex="0"]':n.props.showFullMonthYearPicker||n.props.showMonthYearPicker?'.react-datepicker__month-text[tabindex="0"]':'.react-datepicker__day[tabindex="0"]',v=((u=n.calendar)===null||u===void 0?void 0:u.containerRef.current)instanceof Element&&n.calendar.containerRef.current.querySelector(m);v instanceof HTMLElement&&v.focus({preventScroll:!0});return}var w=Fr(n.state.preSelection);g===rt.Enter?(i.preventDefault(),i.target.blur(),n.inputOk()&&n.state.lastPreSelectChange===NI?(n.handleSelect(w,i),!n.props.shouldCloseOnSelect&&n.setPreSelection(w)):n.setOpen(!1)):g===rt.Escape?(i.preventDefault(),i.target.blur(),n.sendFocusBackToInput(),n.setOpen(!1)):g===rt.Tab&&n.setOpen(!1),n.inputOk()||(f=(c=n.props).onInputError)===null||f===void 0||f.call(c,{code:1,msg:II})}},n.onPortalKeyDown=function(i){var s=i.key;s===rt.Escape&&(i.preventDefault(),n.setState({preventFocus:!0},function(){n.setOpen(!1),setTimeout(function(){n.setFocus(),n.setState({preventFocus:!1})})}))},n.onDayKeyDown=function(i){var s,a,o,u,c,f,g=n.props,m=g.minDate,v=g.maxDate,w=g.disabledKeyboardNavigation,y=g.showWeekPicker,b=g.shouldCloseOnSelect,x=g.locale,_=g.calendarStartDay,T=g.adjustDateOnChange,D=g.inline;if((a=(s=n.props).onKeyDown)===null||a===void 0||a.call(s,i),!w){var P=i.key,O=i.shiftKey,A=Fr(n.state.preSelection),W=function(we,ae){var le=ae;switch(we){case rt.ArrowRight:le=y?iR(ae,1):kl(ae,1);break;case rt.ArrowLeft:le=y?vq(ae):FYe(ae);break;case rt.ArrowUp:le=vq(ae);break;case rt.ArrowDown:le=iR(ae,1);break;case rt.PageUp:le=O?Up(ae,1):kg(ae,1);break;case rt.PageDown:le=O?Kc(ae,1):Hl(ae,1);break;case rt.Home:le=Hf(ae,x,_);break;case rt.End:le=_Ge(ae);break}return le},L=function(we,ae){for(var le=40,Te=we,ce=!1,K=0,Se=W(we,ae);!ce;){if(K>=le){Se=ae;break}m&&Se<m&&(Te=rt.ArrowRight,Se=Fo(m,n.props)?W(Te,Se):m),v&&Se>v&&(Te=rt.ArrowLeft,Se=Fo(v,n.props)?W(Te,Se):v),Fo(Se,n.props)?((Te===rt.PageUp||Te===rt.Home)&&(Te=rt.ArrowRight),(Te===rt.PageDown||Te===rt.End)&&(Te=rt.ArrowLeft),Se=W(Te,Se)):ce=!0,K++}return Se};if(P===rt.Enter){i.preventDefault(),n.handleSelect(A,i),!b&&n.setPreSelection(A);return}else if(P===rt.Escape){i.preventDefault(),n.setOpen(!1),n.inputOk()||(u=(o=n.props).onInputError)===null||u===void 0||u.call(o,{code:1,msg:II});return}var H=null;switch(P){case rt.ArrowLeft:case rt.ArrowRight:case rt.ArrowUp:case rt.ArrowDown:case rt.PageUp:case rt.PageDown:case rt.Home:case rt.End:H=L(P,A);break}if(!H){(f=(c=n.props).onInputError)===null||f===void 0||f.call(c,{code:1,msg:II});return}if(i.preventDefault(),n.setState({lastPreSelectChange:NI}),T&&n.setSelected(H),n.setPreSelection(H),D){var J=Es(A),G=Es(H),ve=qt(A),be=qt(H);J!==G||ve!==be?n.setState({shouldFocusDayInline:!0}):n.setState({shouldFocusDayInline:!1})}}},n.onPopperKeyDown=function(i){var s=i.key;s===rt.Escape&&(i.preventDefault(),n.sendFocusBackToInput(),n.setOpen(!1))},n.onClearClick=function(i){i&&i.preventDefault&&i.preventDefault(),n.sendFocusBackToInput();var s=n.props,a=s.selectsRange,o=s.onChange;o?.(a?[null,null]:null,i),n.setState({inputValue:null})},n.clear=function(){n.onClearClick()},n.onScroll=function(i){typeof n.props.closeOnScroll=="boolean"&&n.props.closeOnScroll?(i.target===document||i.target===document.documentElement||i.target===document.body)&&n.setOpen(!1):typeof n.props.closeOnScroll=="function"&&n.props.closeOnScroll(i)&&n.setOpen(!1)},n.renderCalendar=function(){var i,s;return!n.props.inline&&!n.isCalendarOpen()?null:Ie.createElement(sqe,Sr({showMonthYearDropdown:void 0,ref:function(a){n.calendar=a}},n.props,n.state,{setOpen:n.setOpen,dateFormat:(i=n.props.dateFormatCalendar)!==null&&i!==void 0?i:e.defaultProps.dateFormatCalendar,onSelect:n.handleSelect,onClickOutside:n.handleCalendarClickOutside,holidays:FGe(n.modifyHolidays()),outsideClickIgnoreClass:Yq,onDropdownFocus:n.handleDropdownFocus,onTimeChange:n.handleTimeChange,className:n.props.calendarClassName,container:n.props.calendarContainer,handleOnKeyDown:n.props.onKeyDown,handleOnDayKeyDown:n.onDayKeyDown,setPreSelection:n.setPreSelection,dropdownMode:(s=n.props.dropdownMode)!==null&&s!==void 0?s:e.defaultProps.dropdownMode}),n.props.children)},n.renderAriaLiveRegion=function(){var i=n.props,s=i.dateFormat,a=s===void 0?e.defaultProps.dateFormat:s,o=i.locale,u=n.props.showTimeInput||n.props.showTimeSelect,c=u?"PPPPp":"PPPP",f;return n.props.selectsRange?f="Selected start date: ".concat(Do(n.props.startDate,{dateFormat:c,locale:o}),". ").concat(n.props.endDate?"End date: "+Do(n.props.endDate,{dateFormat:c,locale:o}):""):n.props.showTimeSelectOnly?f="Selected time: ".concat(Do(n.props.selected,{dateFormat:a,locale:o})):n.props.showYearPicker?f="Selected year: ".concat(Do(n.props.selected,{dateFormat:"yyyy",locale:o})):n.props.showMonthYearPicker?f="Selected month: ".concat(Do(n.props.selected,{dateFormat:"MMMM yyyy",locale:o})):n.props.showQuarterYearPicker?f="Selected quarter: ".concat(Do(n.props.selected,{dateFormat:"yyyy, QQQ",locale:o})):f="Selected date: ".concat(Do(n.props.selected,{dateFormat:c,locale:o})),Ie.createElement("span",{role:"alert","aria-live":"polite",className:"react-datepicker__aria-live"},f)},n.renderDateInput=function(){var i,s,a,o=ss(n.props.className,(i={},i[Yq]=n.state.open,i)),u=n.props.customInput||Ie.createElement("input",{type:"text"}),c=n.props.customInputRef||"ref",f=n.props,g=f.dateFormat,m=g===void 0?e.defaultProps.dateFormat:g,v=f.locale,w=typeof n.props.value=="string"?n.props.value:typeof n.state.inputValue=="string"?n.state.inputValue:n.props.selectsRange?bGe(n.props.startDate,n.props.endDate,{dateFormat:m,locale:v}):n.props.selectsMultiple?CGe((a=n.props.selectedDates)!==null&&a!==void 0?a:[],{dateFormat:m,locale:v}):Do(n.props.selected,{dateFormat:m,locale:v});return ie.cloneElement(u,(s={},s[c]=function(y){n.input=y},s.value=w,s.onBlur=n.handleBlur,s.onChange=n.handleChange,s.onClick=n.onInputClick,s.onFocus=n.handleFocus,s.onKeyDown=n.onInputKeyDown,s.id=n.props.id,s.name=n.props.name,s.form=n.props.form,s.autoFocus=n.props.autoFocus,s.placeholder=n.props.placeholderText,s.disabled=n.props.disabled,s.autoComplete=n.props.autoComplete,s.className=ss(u.props.className,o),s.title=n.props.title,s.readOnly=n.props.readOnly,s.required=n.props.required,s.tabIndex=n.props.tabIndex,s["aria-describedby"]=n.props.ariaDescribedBy,s["aria-invalid"]=n.props.ariaInvalid,s["aria-labelledby"]=n.props.ariaLabelledBy,s["aria-required"]=n.props.ariaRequired,s))},n.renderClearButton=function(){var i=n.props,s=i.isClearable,a=i.disabled,o=i.selected,u=i.startDate,c=i.endDate,f=i.clearButtonTitle,g=i.clearButtonClassName,m=g===void 0?"":g,v=i.ariaLabelClose,w=v===void 0?"Close":v,y=i.selectedDates,b=i.readOnly;return s&&!b&&(o!=null||u!=null||c!=null||y?.length)?Ie.createElement("button",{type:"button",className:ss("react-datepicker__close-icon",m,{"react-datepicker__close-icon--disabled":a}),disabled:a,"aria-label":w,onClick:n.onClearClick,title:f,tabIndex:-1}):null},n.state=n.calcInitialState(),n.preventFocusTimeout=void 0,n}return Object.defineProperty(e,"defaultProps",{get:function(){return{allowSameDay:!1,dateFormat:"MM/dd/yyyy",dateFormatCalendar:"LLLL yyyy",disabled:!1,disabledKeyboardNavigation:!1,dropdownMode:"scroll",preventOpenOnFocus:!1,monthsShown:1,readOnly:!1,withPortal:!1,selectsDisabledDaysInRange:!1,shouldCloseOnSelect:!0,showTimeSelect:!1,showTimeInput:!1,showPreviousMonths:!1,showMonthYearPicker:!1,showFullMonthYearPicker:!1,showTwoColumnMonthYearPicker:!1,showFourColumnMonthYearPicker:!1,showYearPicker:!1,showQuarterYearPicker:!1,showWeekPicker:!1,strictParsing:!1,swapRange:!1,timeIntervals:30,timeCaption:"Time",previousMonthAriaLabel:"Previous Month",previousMonthButtonLabel:"Previous Month",nextMonthAriaLabel:"Next Month",nextMonthButtonLabel:"Next Month",previousYearAriaLabel:"Previous Year",previousYearButtonLabel:"Previous Year",nextYearAriaLabel:"Next Year",nextYearButtonLabel:"Next Year",timeInputLabel:"Time",enableTabLoop:!0,yearItemNumber:KS,focusSelectedMonth:!1,showPopperArrow:!0,excludeScrollbar:!0,customTimeInput:null,calendarStartDay:void 0,toggleCalendarOnIconClick:!1,usePointerEvent:!1}},enumerable:!1,configurable:!0}),e.prototype.componentDidMount=function(){window.addEventListener("scroll",this.onScroll,!0),document.addEventListener("visibilitychange",this.setHiddenStateOnVisibilityHidden)},e.prototype.componentDidUpdate=function(r,n){var i,s,a,o;r.inline&&fqe(r.selected,this.props.selected)&&this.setPreSelection(this.props.selected),this.state.monthSelectedIn!==void 0&&r.monthsShown!==this.props.monthsShown&&this.setState({monthSelectedIn:0}),r.highlightDates!==this.props.highlightDates&&this.setState({highlightDates:Lq(this.props.highlightDates)}),!n.focused&&!xg(r.selected,this.props.selected)&&this.setState({inputValue:null}),n.open!==this.state.open&&(n.open===!1&&this.state.open===!0&&((s=(i=this.props).onCalendarOpen)===null||s===void 0||s.call(i)),n.open===!0&&this.state.open===!1&&((o=(a=this.props).onCalendarClose)===null||o===void 0||o.call(a)))},e.prototype.componentWillUnmount=function(){this.clearPreventFocusTimeout(),window.removeEventListener("scroll",this.onScroll,!0),document.removeEventListener("visibilitychange",this.setHiddenStateOnVisibilityHidden)},e.prototype.renderInputContainer=function(){var r=this.props,n=r.showIcon,i=r.icon,s=r.calendarIconClassname,a=r.calendarIconClassName,o=r.toggleCalendarOnIconClick,u=this.state.open;return s&&console.warn("calendarIconClassname props is deprecated. should use calendarIconClassName props."),Ie.createElement("div",{className:"react-datepicker__input-container".concat(n?" react-datepicker__view-calendar-icon":"")},n&&Ie.createElement(aqe,Sr({icon:i,className:ss(a,!a&&s,u&&"react-datepicker-ignore-onclickoutside")},o?{onClick:this.toggleCalendar}:null)),this.state.isRenderAriaLiveMessage&&this.renderAriaLiveRegion(),this.renderDateInput(),this.renderClearButton())},e.prototype.render=function(){var r=this.renderCalendar();if(this.props.inline)return r;if(this.props.withPortal){var n=this.state.open?Ie.createElement(_ie,{enableTabLoop:this.props.enableTabLoop},Ie.createElement("div",{className:"react-datepicker__portal",tabIndex:-1,onKeyDown:this.onPortalKeyDown},r)):null;return this.state.open&&this.props.portalId&&(n=Ie.createElement(Eie,Sr({portalId:this.props.portalId},this.props),n)),Ie.createElement("div",null,this.renderInputContainer(),n)}return Ie.createElement(hqe,Sr({},this.props,{className:this.props.popperClassName,hidePopper:!this.isCalendarOpen(),targetComponent:this.renderInputContainer(),popperComponent:r,popperOnKeyDown:this.onPopperKeyDown,showArrow:this.props.showPopperArrow}))},e}(ie.Component),dqe="input",NI="navigate";function gqe({status:t,onClose:e}){if(!t)return null;const r=n=>{n.target.className==="modal-overlay"&&e()};return Y.jsx("div",{className:"modal-overlay",onClick:r,children:Y.jsxs("div",{className:"modal-content detail-modal",children:[Y.jsxs("div",{className:"modal-header",children:[Y.jsx("h3",{children:"차량 상세 정보"}),Y.jsx("button",{className:"modal-close-button",onClick:e,"aria-label":"닫기",children:"×"})]}),Y.jsx("div",{className:"modal-body",children:Y.jsx("table",{className:"detail-table",children:Y.jsxs("tbody",{children:[Y.jsxs("tr",{children:[Y.jsx("th",{children:"번호판"}),Y.jsx("td",{children:t.plateNumber})]}),Y.jsxs("tr",{children:[Y.jsx("th",{children:"업무구분"}),Y.jsx("td",{children:Rie(t.businessType)})]}),Y.jsxs("tr",{children:[Y.jsx("th",{children:"공급가액"}),Y.jsxs("td",{children:[Number(t.price).toLocaleString(),"원"]})]}),Y.jsxs("tr",{children:[Y.jsx("th",{children:"차대번호"}),Y.jsx("td",{children:t.vinNumber})]}),Y.jsxs("tr",{children:[Y.jsx("th",{children:"차명"}),Y.jsx("td",{children:t.carName})]}),Y.jsxs("tr",{children:[Y.jsx("th",{children:"소유자명"}),Y.jsx("td",{children:t.ownerName})]})]})})})]})})}const zq=[{plateNumber:"123가4567",company:"현대자동차",status:"요청",registeredAt:"2025-08-06",expiresAt:"2025-07-25"},{plateNumber:"234나5678",company:"기아자동차",status:"대기",registeredAt:"2025-08-06",expiresAt:"2025-04-26"},{plateNumber:"567다8901",company:"현대자동차",status:"완료",registeredAt:"2025-08-06",expiresAt:"2025-04-24"},{plateNumber:"789라2345",company:"르노코리아",status:"요청",registeredAt:"2025-08-06",expiresAt:"2025-04-27"},{plateNumber:"345마6789",company:"기아자동차",status:"완료",registeredAt:"2025-08-06",expiresAt:"2025-04-23"},{plateNumber:"678바1234",company:"르노코리아",status:"대기",registeredAt:"2025-08-06",expiresAt:"2025-04-28"},{plateNumber:"901사3456",company:"현대자동차",status:"대기",registeredAt:"2025-08-06",expiresAt:"2025-04-29"},{plateNumber:"234아5678",company:"기아자동차",status:"요청",registeredAt:"2025-08-06",expiresAt:"2025-04-30"},{plateNumber:"567자8901",company:"르노코리아",status:"완료",registeredAt:"2025-08-06",expiresAt:"2025-04-22"},{plateNumber:"890차2345",company:"현대자동차",status:"요청",registeredAt:"2025-08-06",expiresAt:"2025-04-31"},{plateNumber:"123카6789",company:"기아자동차",status:"대기",registeredAt:"2025-08-06",expiresAt:"2025-05-01"},{plateNumber:"456타1234",company:"르노코리아",status:"완료",registeredAt:"2025-08-06",expiresAt:"2025-05-02"},{plateNumber:"789파3456",company:"현대자동차",status:"요청",registeredAt:"2025-08-06",expiresAt:"2025-05-03"},{plateNumber:"012하5678",company:"기아자동차",status:"대기",registeredAt:"2025-08-06",expiresAt:"2025-05-04"},{plateNumber:"345호8901",company:"르노코리아",status:"완료",registeredAt:"2025-08-06",expiresAt:"2025-05-05"},{plateNumber:"678주2345",company:"현대자동차",status:"요청",registeredAt:"2025-08-06",expiresAt:"2025-05-06"},{plateNumber:"901유6789",company:"기아자동차",status:"대기",registeredAt:"2025-08-06",expiresAt:"2025-05-07"},{plateNumber:"234이1234",company:"르노코리아",status:"완료",registeredAt:"2025-08-06",expiresAt:"2025-05-08"},{plateNumber:"567진3456",company:"현대자동차",status:"요청",registeredAt:"2025-08-06",expiresAt:"2025-05-09"},{plateNumber:"890김6789",company:"기아자동차",status:"대기",registeredAt:"2025-08-06",expiresAt:"2025-05-10"},{plateNumber:"123박1234",company:"르노코리아",status:"완료",registeredAt:"2025-08-06",expiresAt:"2025-05-11"},{plateNumber:"456최3456",company:"현대자동차",status:"요청",registeredAt:"2025-08-06",expiresAt:"2025-05-12"},{plateNumber:"789이6789",company:"기아자동차",status:"대기",registeredAt:"2025-08-06",expiresAt:"2025-05-13"},{plateNumber:"012김1234",company:"르노코리아",status:"완료",registeredAt:"2025-08-06",expiresAt:"2025-05-14"},{plateNumber:"345박3456",company:"현대자동차",status:"요청",registeredAt:"2025-08-06",expiresAt:"2025-05-15"},{plateNumber:"678최6789",company:"기아자동차",status:"대기",registeredAt:"2025-08-06",expiresAt:"2025-05-16"},{plateNumber:"901이1234",company:"르노코리아",status:"완료",registeredAt:"2025-08-06",expiresAt:"2025-05-17"},{plateNumber:"234김3456",company:"현대자동차",status:"요청",registeredAt:"2025-08-06",expiresAt:"2025-05-18"},{plateNumber:"567박6789",company:"기아자동차",status:"대기",registeredAt:"2025-08-06",expiresAt:"2025-05-19"},{plateNumber:"890최1234",company:"르노코리아",status:"완료",registeredAt:"2025-08-06",expiresAt:"2025-05-20"},{plateNumber:"123이3456",company:"현대자동차",status:"요청",registeredAt:"2025-08-06",expiresAt:"2025-05-21"},{plateNumber:"456김6789",company:"기아자동차",status:"대기",registeredAt:"2025-08-06",expiresAt:"2025-05-22"},{plateNumber:"789박1234",company:"르노코리아",status:"완료",registeredAt:"2025-08-06",expiresAt:"2025-05-23"},{plateNumber:"012최3456",company:"현대자동차",status:"요청",registeredAt:"2025-08-06",expiresAt:"2025-05-24"},{plateNumber:"345이6789",company:"기아자동차",status:"대기",registeredAt:"2025-08-06",expiresAt:"2025-05-25"},{plateNumber:"678김1234",company:"르노코리아",status:"완료",registeredAt:"2025-08-06",expiresAt:"2025-05-26"}],mqe=[{id:1,plateNumber:"12가 3456",ownerName:"홍길동",businessType:"01",price:"30000000",vinNumber:"KMHXX00XXXX000001",carName:"그랜저",status:"승인 대기",requestDate:"2025-08-06",coOwner:{name:"김영희",idNumber:"820101-2******"}},{id:2,plateNumber:"34나 7890",ownerName:"김철수",businessType:"02",price:"25000000",vinNumber:"KMHXX00XXXX000002",carName:"아반떼",status:"승인 완료",requestDate:"2025-08-06"},{id:3,plateNumber:"56다 1234",ownerName:"이영희",businessType:"03",price:"45000000",vinNumber:"KMHXX00XXXX000003",carName:"제네시스 G80",status:"요청",requestDate:"2025-08-06"},{id:4,plateNumber:"78라 5678",ownerName:"박민수",businessType:"01",price:"35000000",vinNumber:"KMHXX00XXXX000004",carName:"싼타페",status:"승인 대기",requestDate:"2025-08-06"},{id:5,plateNumber:"90마 9012",ownerName:"정수민",businessType:"02",price:"28000000",vinNumber:"KMHXX00XXXX000005",carName:"투싼",status:"승인 완료",requestDate:"2025-08-06",coOwner:{name:"정대현",idNumber:"880505-1******"}},{id:6,plateNumber:"12바 3456",ownerName:"최지훈",businessType:"03",price:"40000000",vinNumber:"KMHXX00XXXX000006",carName:"K5",status:"요청",requestDate:"2025-08-06"},{id:7,plateNumber:"34사 7890",ownerName:"이수정",businessType:"01",price:"32000000",vinNumber:"KMHXX00XXXX000007",carName:"소나타",status:"승인 대기",requestDate:"2025-08-06"},{id:8,plateNumber:"56아 1234",ownerName:"박준영",businessType:"02",price:"27000000",vinNumber:"KMHXX00XXXX000008",carName:"코나",status:"승인 완료",requestDate:"2025-08-06"},{id:9,plateNumber:"78자 5678",ownerName:"김하늘",businessType:"03",price:"36000000",vinNumber:"KMHXX00XXXX000009",carName:"아이오닉 5",status:"요청",requestDate:"2025-08-06"},{id:10,plateNumber:"90차 9012",ownerName:"이민호",businessType:"01",price:"33000000",vinNumber:"KMHXX00XXXX000010",carName:"팰리세이드",status:"승인 대기",requestDate:"2025-08-06"},{id:11,plateNumber:"12카 3456",ownerName:"정유진",businessType:"02",price:"29000000",vinNumber:"KMHXX00",carName:"벨로스터",status:"요청",requestDate:"2025-08-06"},{id:12,plateNumber:"34타 7890",ownerName:"박서준",businessType:"03",price:"41000000",vinNumber:"KMHXX00XXXX000011",carName:"그랜저 IG",status:"승인 완료",requestDate:"2025-08-06"},{id:13,plateNumber:"56파 1234",ownerName:"이채영",businessType:"01",price:"37000000",vinNumber:"KMHXX00XXXX000012",carName:"싼타페 TM",status:"요청",requestDate:"2025-08-06"},{id:14,plateNumber:"78하 5678",ownerName:"김지수",businessType:"02",price:"30000000",vinNumber:"KMHXX00XXXX000013",carName:"아반떼 AD",status:"승인 대기",requestDate:"2025-08-06"},{id:15,plateNumber:"90호 9012",ownerName:"박지민",businessType:"03",price:"44000000",vinNumber:"KMHXX00XXXX000014",carName:"제네시스 G70",status:"승인 완료",requestDate:"2025-08-06"},{id:16,plateNumber:"12주 3456",ownerName:"이서현",businessType:"01",price:"34000000",vinNumber:"KMHXX00XXXX000015",carName:"K7",status:"요청",requestDate:"2025-08-06"},{id:17,plateNumber:"34유 7890",ownerName:"정민재",businessType:"02",price:"28000000",vinNumber:"KMHXX00XXXX000016",carName:"코나 EV",status:"승인 대기",requestDate:"2025-08-06"},{id:18,plateNumber:"56이 1234",ownerName:"박상현",businessType:"03",price:"42000000",vinNumber:"KMHXX00XXXX000017",carName:"아이오닉 6",status:"요청",requestDate:"2025-08-06"},{id:19,plateNumber:"78진 5678",ownerName:"김지영",businessType:"01",price:"35000000",vinNumber:"KMHXX00XXXX000018",carName:"소나타 DN8",status:"승인 완료",requestDate:"2025-08-06"}],pqe={"01":"렌트","02":"리스","03":"개인"},Rie=t=>pqe[t]||"",vqe=[{id:"all",name:"전체"},{id:"요청",name:"요청"},{id:"승인 대기",name:"대기"},{id:"승인 완료",name:"승인"}],wqe=({onSelect:t,onClose:e})=>{const r=n=>{const i=new Date;return i.setDate(i.getDate()-n),i};return Y.jsxs("div",{className:"quick-date-selector",children:[Y.jsx("button",{onClick:()=>t(new Date,new Date),children:"당일"}),Y.jsx("button",{onClick:()=>t(r(3),new Date),children:"3일전"}),Y.jsx("button",{onClick:()=>t(r(7),new Date),children:"7일전"}),Y.jsx("button",{onClick:()=>t(r(30),new Date),children:"1개월전"}),Y.jsx("button",{onClick:()=>t(r(990),new Date),children:"3개월전"})]})};function yqe(){const[t,e]=ie.useState({ownerName:"",plateNumber:"",startDate:new Date,endDate:new Date,statusTab:"all"}),[r,n]=ie.useState(null),[i,s]=ie.useState(!1),{user:a}=oh(),[o,u]=ie.useState(!1),c=Yo();if(ie.useEffect(()=>{a||u(!0)},[a,c]),!a||!a.username)return Y.jsx(Zg,{open:o});const f=v=>{v.preventDefault(),console.log("Search params:",t)},g=(v,w)=>{e({...t,startDate:v,endDate:w}),s(!1)},m=mqe.filter(v=>{const w=v.ownerName.includes(t.ownerName),y=v.plateNumber.includes(t.plateNumber),b=t.statusTab==="all"||v.status.includes(t.statusTab),x=new Date(v.requestDate),_=x>=t.startDate.setHours(0,0,0,0)&&x<=t.endDate.setHours(23,59,59,999);return w&&y&&b&&_});return Y.jsxs("div",{className:"customer-container",children:[Y.jsxs("div",{className:"customer-content",children:[Y.jsx("h1",{className:"customer-title",children:"자동차 신규 등록 상태"}),Y.jsx("div",{className:"customer-search-filters",children:Y.jsxs("div",{className:"customer-search-row",children:[Y.jsx("input",{type:"text",placeholder:"소유자명",value:t.ownerName,onChange:v=>e({...t,ownerName:v.target.value}),className:"customer-search-input"}),Y.jsx("input",{type:"text",placeholder:"차량번호",value:t.plateNumber,onChange:v=>e({...t,plateNumber:v.target.value}),className:"customer-search-input"}),Y.jsxs("div",{className:"customer-date-picker-wrapper",children:[Y.jsx(pR,{selected:t.startDate,onChange:v=>e({...t,startDate:v}),selectsStart:!0,startDate:t.startDate,endDate:t.endDate,dateFormat:"yyyy-MM-dd",className:"customer-date-picker",showMonthYearDropdown:!0}),Y.jsx("span",{className:"customer-date-separator",children:"~"}),Y.jsx(pR,{selected:t.endDate,onChange:v=>e({...t,endDate:v}),selectsEnd:!0,startDate:t.startDate,endDate:t.endDate,minDate:t.startDate,dateFormat:"yyyy-MM-dd",className:"customer-date-picker",showMonthYearDropdown:!0}),Y.jsx("button",{className:"customer-date-select-button",onClick:()=>s(!i),children:"날짜선택"}),i&&Y.jsx(wqe,{onSelect:g,onClose:()=>s(!1)})]}),Y.jsx("button",{onClick:f,className:"customer-search-button",children:"검색"})]})}),Y.jsx("div",{className:"customer-status-tabs",children:vqe.map(v=>Y.jsx("button",{className:`customer-tab-button ${t.statusTab===v.id?"active":""}`,onClick:()=>e({...t,statusTab:v.id}),children:v.name},v.id))}),Y.jsx("div",{className:"customer-results-table",children:Y.jsxs("table",{children:[Y.jsx("thead",{children:Y.jsxs("tr",{children:[Y.jsx("th",{children:"번호"}),Y.jsx("th",{children:"차량번호"}),Y.jsx("th",{children:"소유자"}),Y.jsx("th",{children:"차명"}),Y.jsx("th",{children:"업무구분"}),Y.jsx("th",{children:"차대번호"}),Y.jsx("th",{children:"가격(원)"}),Y.jsx("th",{children:"상태"}),Y.jsx("th",{children:"신청일시"})]})}),Y.jsx("tbody",{children:m.length===0?Y.jsx("tr",{children:Y.jsx("td",{colSpan:"9",className:"customer-no-data",children:"검색 결과가 없습니다."})}):m.map((v,w)=>Y.jsxs("tr",{onClick:()=>n(v),className:"customer-clickable",children:[Y.jsx("td",{children:w+1}),Y.jsx("td",{children:v.plateNumber}),Y.jsx("td",{children:v.ownerName}),Y.jsx("td",{children:v.carName}),Y.jsx("td",{children:Rie(v.businessType)}),Y.jsx("td",{children:v.vinNumber}),Y.jsx("td",{children:Number(v.price).toLocaleString()}),Y.jsx("td",{children:v.status}),Y.jsx("td",{children:v.requestDate})]},v.id))})]})})]}),r&&Y.jsx(gqe,{status:r,onClose:()=>n(null)})]})}const Sqe=[{path:"/autoplus/plate/add",label:"차량번호 등록"},{path:"/autoplus/plates",label:"차량번호 목록"},{path:"/autoplus/plate/status",label:"차량번호 신규 등록 상태"}],bqe=[{path:"/customer/plate/register",label:"자동차 신규 등록"},{path:"/customer/plate/status",label:"자동차 신규 등록 상태"}],Cqe=[{path:"/customer/plate/status",label:"차량 등록 상태"}];function xqe(){const[t,e]=ie.useState(!0),r=Uu(),n=Yo(),{user:i,logout:s}=oh(),o=(()=>{switch(i?.company){case"AUTOPLUS":return Sqe;case"CARBANG":return Cqe;default:return bqe}})(),u=()=>{s?.(),n("/login")};return Y.jsxs("div",{className:`sidebar ${t?"expanded":""}`,children:[Y.jsxs("div",{className:"sidebar-header",children:[t?i?.company||"Customer":i?.company?.[0]||"C",Y.jsx("button",{style:{marginLeft:"auto",background:"none",border:"none",fontSize:"18px",cursor:"pointer",color:"#2c3e50"},onClick:()=>e(c=>!c),"aria-label":"사이드바 토글",children:t?"◀":"▶"})]}),Y.jsx("nav",{className:"sidebar-nav",children:o.map(c=>Y.jsx(EH,{to:c.path,className:`sidebar-link ${r.pathname===c.path?"active":""}`,children:t?c.label:"•"},c.path))}),Y.jsx("div",{className:"sidebar-footer",children:Y.jsx("button",{className:"logout-btn",onClick:u,children:t?"로그아웃":"⎋"})})]})}const Eqe={lessThanXSeconds:{one:"1초 미만",other:"{{count}}초 미만"},xSeconds:{one:"1초",other:"{{count}}초"},halfAMinute:"30초",lessThanXMinutes:{one:"1분 미만",other:"{{count}}분 미만"},xMinutes:{one:"1분",other:"{{count}}분"},aboutXHours:{one:"약 1시간",other:"약 {{count}}시간"},xHours:{one:"1시간",other:"{{count}}시간"},xDays:{one:"1일",other:"{{count}}일"},aboutXWeeks:{one:"약 1주",other:"약 {{count}}주"},xWeeks:{one:"1주",other:"{{count}}주"},aboutXMonths:{one:"약 1개월",other:"약 {{count}}개월"},xMonths:{one:"1개월",other:"{{count}}개월"},aboutXYears:{one:"약 1년",other:"약 {{count}}년"},xYears:{one:"1년",other:"{{count}}년"},overXYears:{one:"1년 이상",other:"{{count}}년 이상"},almostXYears:{one:"거의 1년",other:"거의 {{count}}년"}},_qe=(t,e,r)=>{let n;const i=Eqe[t];return typeof i=="string"?n=i:e===1?n=i.one:n=i.other.replace("{{count}}",e.toString()),r?.addSuffix?r.comparison&&r.comparison>0?n+" 후":n+" 전":n},Rqe={full:"y년 M월 d일 EEEE",long:"y년 M월 d일",medium:"y.MM.dd",short:"y.MM.dd"},Tqe={full:"a H시 mm분 ss초 zzzz",long:"a H:mm:ss z",medium:"HH:mm:ss",short:"HH:mm"},Mqe={full:"{{date}} {{time}}",long:"{{date}} {{time}}",medium:"{{date}} {{time}}",short:"{{date}} {{time}}"},Aqe={date:Cp({formats:Rqe,defaultWidth:"full"}),time:Cp({formats:Tqe,defaultWidth:"full"}),dateTime:Cp({formats:Mqe,defaultWidth:"full"})},Oqe={lastWeek:"'지난' eeee p",yesterday:"'어제' p",today:"'오늘' p",tomorrow:"'내일' p",nextWeek:"'다음' eeee p",other:"P"},kqe=(t,e,r,n)=>Oqe[t],Dqe={narrow:["BC","AD"],abbreviated:["BC","AD"],wide:["기원전","서기"]},Pqe={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1분기","2분기","3분기","4분기"]},Iqe={narrow:["1","2","3","4","5","6","7","8","9","10","11","12"],abbreviated:["1월","2월","3월","4월","5월","6월","7월","8월","9월","10월","11월","12월"],wide:["1월","2월","3월","4월","5월","6월","7월","8월","9월","10월","11월","12월"]},Nqe={narrow:["일","월","화","수","목","금","토"],short:["일","월","화","수","목","금","토"],abbreviated:["일","월","화","수","목","금","토"],wide:["일요일","월요일","화요일","수요일","목요일","금요일","토요일"]},Hqe={narrow:{am:"오전",pm:"오후",midnight:"자정",noon:"정오",morning:"아침",afternoon:"오후",evening:"저녁",night:"밤"},abbreviated:{am:"오전",pm:"오후",midnight:"자정",noon:"정오",morning:"아침",afternoon:"오후",evening:"저녁",night:"밤"},wide:{am:"오전",pm:"오후",midnight:"자정",noon:"정오",morning:"아침",afternoon:"오후",evening:"저녁",night:"밤"}},Fqe={narrow:{am:"오전",pm:"오후",midnight:"자정",noon:"정오",morning:"아침",afternoon:"오후",evening:"저녁",night:"밤"},abbreviated:{am:"오전",pm:"오후",midnight:"자정",noon:"정오",morning:"아침",afternoon:"오후",evening:"저녁",night:"밤"},wide:{am:"오전",pm:"오후",midnight:"자정",noon:"정오",morning:"아침",afternoon:"오후",evening:"저녁",night:"밤"}},Lqe=(t,e)=>{const r=Number(t);switch(String(e?.unit)){case"minute":case"second":return String(r);case"date":return r+"일";default:return r+"번째"}},Bqe={ordinalNumber:Lqe,era:Tu({values:Dqe,defaultWidth:"wide"}),quarter:Tu({values:Pqe,defaultWidth:"wide",argumentCallback:t=>t-1}),month:Tu({values:Iqe,defaultWidth:"wide"}),day:Tu({values:Nqe,defaultWidth:"wide"}),dayPeriod:Tu({values:Hqe,defaultWidth:"wide",formattingValues:Fqe,defaultFormattingWidth:"wide"})},Vqe=/^(\d+)(일|번째)?/i,Wqe=/\d+/i,$qe={narrow:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(기원전|서기)/i},Uqe={any:[/^(bc|기원전)/i,/^(ad|서기)/i]},jqe={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234]사?분기/i},Yqe={any:[/1/i,/2/i,/3/i,/4/i]},zqe={narrow:/^(1[012]|[123456789])/,abbreviated:/^(1[012]|[123456789])월/i,wide:/^(1[012]|[123456789])월/i},Gqe={any:[/^1월?$/,/^2/,/^3/,/^4/,/^5/,/^6/,/^7/,/^8/,/^9/,/^10/,/^11/,/^12/]},qqe={narrow:/^[일월화수목금토]/,short:/^[일월화수목금토]/,abbreviated:/^[일월화수목금토]/,wide:/^[일월화수목금토]요일/},Kqe={any:[/^일/,/^월/,/^화/,/^수/,/^목/,/^금/,/^토/]},Xqe={any:/^(am|pm|오전|오후|자정|정오|아침|저녁|밤)/i},Qqe={any:{am:/^(am|오전)/i,pm:/^(pm|오후)/i,midnight:/^자정/i,noon:/^정오/i,morning:/^아침/i,afternoon:/^오후/i,evening:/^저녁/i,night:/^밤/i}},Zqe={ordinalNumber:Xne({matchPattern:Vqe,parsePattern:Wqe,valueCallback:t=>parseInt(t,10)}),era:Mu({matchPatterns:$qe,defaultMatchWidth:"wide",parsePatterns:Uqe,defaultParseWidth:"any"}),quarter:Mu({matchPatterns:jqe,defaultMatchWidth:"wide",parsePatterns:Yqe,defaultParseWidth:"any",valueCallback:t=>t+1}),month:Mu({matchPatterns:zqe,defaultMatchWidth:"wide",parsePatterns:Gqe,defaultParseWidth:"any"}),day:Mu({matchPatterns:qqe,defaultMatchWidth:"wide",parsePatterns:Kqe,defaultParseWidth:"any"}),dayPeriod:Mu({matchPatterns:Xqe,defaultMatchWidth:"any",parsePatterns:Qqe,defaultParseWidth:"any"})},Gq={code:"ko",formatDistance:_qe,formatLong:Aqe,formatRelative:kqe,localize:Bqe,match:Zqe,options:{weekStartsOn:0,firstWeekContainsDate:1}},Jqe=[{id:"all",label:"전체"},{id:"requested",label:"요청"},{id:"pending",label:"대기"},{id:"completed",label:"완료"}],eKe=({onSelect:t})=>{const e=r=>{const n=new Date;return n.setDate(n.getDate()-r),n};return Y.jsxs("div",{className:"quick-date-selector",children:[Y.jsx("button",{onClick:()=>t(new Date,new Date),children:"당일"}),Y.jsx("button",{onClick:()=>t(e(3),new Date),children:"3일전"}),Y.jsx("button",{onClick:()=>t(e(7),new Date),children:"7일전"}),Y.jsx("button",{onClick:()=>t(e(30),new Date),children:"1개월전"}),Y.jsx("button",{onClick:()=>t(e(990),new Date),children:"3개월전"})]})};function tKe(){const[t,e]=ie.useState(""),[r,n]=ie.useState(""),[i,s]=ie.useState(new Date),[a,o]=ie.useState(new Date),[u,c]=ie.useState("all"),[f,g]=ie.useState(zq),[m,v]=ie.useState(!1),{user:w}=oh(),y=Yo(),[b,x]=ie.useState(!1);if(ie.useEffect(()=>{w||x(!0)},[w,y]),!w||!w.username)return Y.jsx(Zg,{open:b});const _=[{id:1,name:"현대자동차"},{id:2,name:"기아자동차"},{id:3,name:"르노코리아"}],T=O=>{O.preventDefault(),g(zq)},D=f.filter(O=>{const A=u==="all"||u==="requested"&&O.status==="요청"||u==="pending"&&O.status==="대기"||u==="completed"&&O.status==="완료",W=!r||O.company===_.find(G=>G.id===parseInt(r))?.name,L=!t||O.plateNumber.toLowerCase().includes(t.toLowerCase()),H=new Date(O.registeredAt),J=H>=i.setHours(0,0,0,0)&&H<=a.setHours(23,59,59,999);return A&&W&&L&&J}),P=(O,A)=>{s(O),o(A),v(!1)};return Y.jsx("div",{id:"plate-status-container",children:Y.jsxs("div",{id:"plate-status-content",children:[Y.jsx("h1",{id:"plate-status-title",children:"차량번호 신규 등록 상태"}),Y.jsx("div",{id:"search-filters",children:Y.jsxs("div",{className:"search-row",children:[Y.jsx("input",{type:"text",placeholder:"차량번호 번호 검색",value:t,onChange:O=>e(O.target.value),className:"search-input"}),Y.jsxs("select",{value:r,onChange:O=>n(O.target.value),className:"company-select",children:[Y.jsx("option",{value:"",children:"고객사 선택"}),_.map(O=>Y.jsx("option",{value:O.id,children:O.name},O.id))]}),Y.jsxs("div",{className:"date-picker-wrapper",children:[Y.jsx(pR,{selected:i,onChange:O=>s(O),selectsStart:!0,startDate:i,endDate:a,dateFormat:"yyyy-MM-dd",locale:Gq,className:"date-picker"}),Y.jsx("span",{className:"date-separator",children:"~"}),Y.jsx(pR,{selected:a,onChange:O=>o(O),selectsEnd:!0,startDate:i,endDate:a,minDate:i,dateFormat:"yyyy-MM-dd",locale:Gq,className:"date-picker"}),Y.jsx("button",{className:"date-select-button",onClick:()=>v(!m),children:"날짜선택"}),m&&Y.jsx(eKe,{onSelect:P,onClose:()=>v(!1)})]}),Y.jsx("button",{onClick:T,className:"search-button",children:"검색"})]})}),Y.jsx("div",{id:"status-tabs",children:Jqe.map(O=>Y.jsx("button",{className:`tab-button ${u===O.id?"active":""}`,onClick:()=>c(O.id),children:O.label},O.id))}),Y.jsx("div",{id:"results-table",children:Y.jsxs("table",{children:[Y.jsx("thead",{children:Y.jsxs("tr",{children:[Y.jsx("th",{children:"차량번호"}),Y.jsx("th",{children:"고객사"}),Y.jsx("th",{children:"상태"}),Y.jsx("th",{children:"접수일시"}),Y.jsx("th",{children:"등록일시"})]})}),Y.jsx("tbody",{children:D.map((O,A)=>Y.jsxs("tr",{children:[Y.jsx("td",{children:O.plateNumber}),Y.jsx("td",{children:O.company}),Y.jsx("td",{children:O.status}),Y.jsx("td",{children:O.expiresAt}),Y.jsx("td",{children:O.registeredAt})]},A))})]})})]})})}function rKe(){const t=Uu(),e=["/autoplus/login","/customer/login","/","/login"].includes(t.pathname);return Y.jsxs(Y.Fragment,{children:[!e&&Y.jsx(xqe,{}),Y.jsx("div",{style:{marginLeft:e?0:180},children:Y.jsxs(Ioe,{children:[Y.jsx(lu,{path:"/",element:Y.jsx(dle,{})}),Y.jsx(lu,{path:"/login",element:Y.jsx(TLe,{})}),Y.jsx(lu,{path:"/autoplus/plates",element:Y.jsx(Sle,{})}),Y.jsx(lu,{path:"/autoplus/plate/add",element:Y.jsx(xLe,{})}),Y.jsx(lu,{path:"/autoplus/mypage",element:Y.jsx(ELe,{})}),Y.jsx(lu,{path:"/autoplus/plate/status",element:Y.jsx(tKe,{})}),Y.jsx(lu,{path:"/customer/plate/register",element:Y.jsx(A9e,{})}),Y.jsx(lu,{path:"/customer/mypage",element:Y.jsx(O9e,{})}),Y.jsx(lu,{path:"/customer/plate/status",element:Y.jsx(yqe,{})})]})})]})}$ae.createRoot(document.getElementById("root")).render(Y.jsx(ie.StrictMode,{children:Y.jsx(nle,{children:Y.jsx(wle,{children:Y.jsx(rKe,{})})})}))});export default nKe();
